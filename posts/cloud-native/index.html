<!doctype html><html lang=zh dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="zh"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç† &#183; Lab on Mercury</title><meta name=title content="é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç† &#183; Lab on Mercury"><meta name=description content="Lab on Mercury"><link rel=canonical href=/posts/cloud-native/><link type=text/css rel=stylesheet href=/css/main.bundle.min.32ddf7dee8011260365c3436dd92254eeda3ec27bea2822527e6cb67f6ede1ff17904557445f0f6747a03b5aa59bbf754e43fc9b0c77b1cd957ef7061fd0c6d2.css integrity="sha512-Mt333ugBEmA2XDQ23ZIlTu2j7Ce+ooIlJ+bLZ/bt4f8XkEVXRF8PZ0egO1qlm791TkP8mwx3sc2VfvcGH9DG0g=="><script type=text/javascript src=/js/appearance.min.badab316c9287a5a42a843e4eb45da65bb3d194a5a0f5fa4a3e516160e67df0b8c65f4f19a8e146436e29d583699e6cb41d6bbe99e05e1dbaa877763bad9f8e2.js integrity="sha512-utqzFskoelpCqEPk60XaZbs9GUpaD1+ko+UWFg5n3wuMZfTxmo4UZDbinVg2mebLQda76Z4F4duqh3djutn44g=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.b607eb5ea0f48ef635db6a1c024a35eeff4529157e49461941aac333a158a1f71cae4e530d45ac010598695f823dbe38a63142757e37c2d7b74a309d7296f681.js integrity="sha512-tgfrXqD0jvY122ocAko17v9FKRV+SUYZQarDM6FYofccrk5TDUWsAQWYaV+CPb44pjFCdX43wte3SjCdcpb2gQ==" data-copy=Copy data-copied=Copied></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†"><meta property="og:description" content="ç²¾å¯†è€Œå¤æ‚ã€‚"><meta property="og:type" content="article"><meta property="og:url" content="/posts/cloud-native/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-09-10T09:27:59+00:00"><meta property="article:modified_time" content="2021-09-10T09:27:59+00:00"><meta property="og:site_name" content="Lab on Mercury"><meta name=twitter:card content="summary"><meta name=twitter:title content="é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†"><meta name=twitter:description content="ç²¾å¯†è€Œå¤æ‚ã€‚"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","headline":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","abstract":"\u003cp\u003eç²¾å¯†è€Œå¤æ‚ã€‚\u003c\/p\u003e","inLanguage":"zh","url":"\/posts\/cloud-native\/","author":{"@type":"Person","name":"Mercury"},"copyrightYear":"2021","dateCreated":"2021-09-10T09:27:59\u002b00:00","datePublished":"2021-09-10T09:27:59\u002b00:00","dateModified":"2021-09-10T09:27:59\u002b00:00","keywords":["Docker","Kubernetes","ARM"],"mainEntityOfPage":"true","wordCount":"1016"}]</script><meta name=author content="Mercury"><link href=mailto:signormercurio@gmail.com rel=me><link href=https://github.com/SignorMercurio rel=me><link href=https://t.me/m9r_at_tG rel=me></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0" href=#main-content><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold sm:py-10 text-neutral-900 dark:text-neutral print:hidden"><nav class="flex justify-between"><div><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentcolor" d="M112.1 454.3c0 6.297 1.816 12.44 5.284 17.69l17.14 25.69c5.25 7.875 17.17 14.28 26.64 14.28h61.67c9.438.0 21.36-6.401 26.61-14.28l17.08-25.68c2.938-4.438 5.348-12.37 5.348-17.7L272 415.1H112L112.1 454.3zM191.4.0132C89.44.3257 16 82.97 16 175.1c0 44.38 16.44 84.84 43.56 115.8 16.53 18.84 42.34 58.23 52.22 91.45.0313.25.0938.5166.125.7823h160.2c.0313-.2656.0938-.5166.125-.7823 9.875-33.22 35.69-72.61 52.22-91.45C351.6 260.8 368 220.4 368 175.1 368 78.61 288.9-.2837 191.4.0132zM192 96.01c-44.13.0-80 35.89-80 79.1.0 9.69-7.2 16.89-16 16.89S80 184.8 80 176c0-61.76 50.25-111.1 112-111.1 8.844.0 16 7.159 16 16S200.8 96.01 192 96.01z"/></svg></span><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>Lab on Mercury</a></div><ul class="flex flex-col list-none ltr:text-right rtl:text-left sm:flex-row"><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/posts/ title=Posts>æ–‡ç« </a></li><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/categories/ title=Categories>åˆ†ç±»</a></li><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=Tags>æ ‡ç­¾</a></li><li class="ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><button id=search-button class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button></li></ul></nav></header><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header class=max-w-prose><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>Lab on Mercury</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>Posts</a><span class="px-1 text-primary-500">/</span></li><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/cloud-native/>é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2021-09-10 09:27:59 +0000 UTC">2021-09-10</time><span class="px-2 text-primary-500">&#183;</span><span>1016 å­—</span><span class="px-2 text-primary-500">&#183;</span><span title=é¢„è®¡é˜…è¯»>5 åˆ†é’Ÿ</span></div><div class="my-1 text-xs text-neutral-500 dark:text-neutral-400"><a href=/categories/%E4%BA%91/ class="px-1 py-[1px] border rounded-md border-neutral-200 dark:border-neutral-600 hover:border-primary-300 hover:text-primary-700 dark:hover:border-primary-600 dark:hover:text-primary-400">äº‘</a>
<a href=/tags/docker/ class="px-1 py-[1px] border rounded-md border-neutral-200 dark:border-neutral-600 hover:border-primary-300 hover:text-primary-700 dark:hover:border-primary-600 dark:hover:text-primary-400">Docker</a>
<a href=/tags/kubernetes/ class="px-1 py-[1px] border rounded-md border-neutral-200 dark:border-neutral-600 hover:border-primary-300 hover:text-primary-700 dark:hover:border-primary-600 dark:hover:text-primary-400">Kubernetes</a>
<a href=/tags/arm/ class="px-1 py-[1px] border rounded-md border-neutral-200 dark:border-neutral-600 hover:border-primary-300 hover:text-primary-700 dark:hover:border-primary-600 dark:hover:text-primary-400">ARM</a></div></div></header><section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert"><div class="order-first px-0 lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8 lg:order-last"><div class="ltr:pl-5 rtl:pr-5 toc lg:sticky lg:top-10 print:hidden"><details open class="mt-0 sideNav rounded-lg rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 lg:mt-3"><summary class="block sticky top-0 py-1 text-lg font-semibold cursor-pointer rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 text-neutral-800 dark:text-neutral-100 lg:hidden bg-neutral-100 dark:bg-neutral-700">Table of Contents</summary><div class="py-2 pr-2 border-dotted ltr:border-l rtl:border-r rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 border-neutral-300 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#å®¹å™¨>å®¹å™¨</a><ul><li><a href=#namespace>Namespace</a></li><li><a href=#cgroups>Cgroups</a><ul><li><a href=#-é™åˆ¶è¿›ç¨‹ä½¿ç”¨çš„-cpu-èµ„æº>ğŸŒ° é™åˆ¶è¿›ç¨‹ä½¿ç”¨çš„ CPU èµ„æº</a></li></ul></li><li><a href=#unionfs>UnionFS</a></li></ul></li><li><a href=#serverless>Serverless</a><ul><li><a href=#faas>FaaS</a><ul><li><a href=#å¼¹æ€§ä¼¸ç¼©>å¼¹æ€§ä¼¸ç¼©</a></li><li><a href=#å†·å¯åŠ¨>å†·å¯åŠ¨</a></li><li><a href=#è¯­è¨€æ— å…³æ€§>è¯­è¨€æ— å…³æ€§</a></li><li><a href=#æ•°æ®åº“>æ•°æ®åº“ï¼Ÿ</a></li></ul></li><li><a href=#baas>BaaS</a></li><li><a href=#ç¼ºç‚¹>ç¼ºç‚¹</a></li></ul></li><li><a href=#kubernetes>Kubernetes</a><ul><li><a href=#æ¶æ„>æ¶æ„</a></li><li><a href=#å®‰è£…>å®‰è£…</a><ul><li><a href=#å®‰è£…-k8s-é›†ç¾¤>å®‰è£… K8s é›†ç¾¤</a></li><li><a href=#å®‰è£…-kubectl>å®‰è£… kubectl</a></li></ul></li><li><a href=#å®è·µ>å®è·µ</a></li></ul></li><li><a href=#service-mesh>Service Mesh</a><ul><li><a href=#istio-å®‰è£…>Istio å®‰è£…</a></li><li><a href=#åº”ç”¨éƒ¨ç½²>åº”ç”¨éƒ¨ç½²</a></li><li><a href=#é€šè¿‡-ingress-ç½‘å…³è®©åº”ç”¨èƒ½å¤Ÿä»å¤–éƒ¨è®¿é—®>é€šè¿‡ Ingress ç½‘å…³è®©åº”ç”¨èƒ½å¤Ÿä»å¤–éƒ¨è®¿é—®</a></li><li><a href=#é€šè¿‡-kiali-æŸ¥çœ‹å›¾å½¢åŒ–ç•Œé¢>é€šè¿‡ Kiali æŸ¥çœ‹å›¾å½¢åŒ–ç•Œé¢</a></li></ul></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose"><figure><img class="my-0 rounded-md" src=0.png alt=featuredImage></figure><p>ç²¾å¯†è€Œå¤æ‚ã€‚</p><h2 id=å®¹å™¨ class="relative group">å®¹å™¨ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%ae%b9%e5%99%a8 aria-label=é”šç‚¹>#</a></span></h2><h3 id=namespace class="relative group">Namespace <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#namespace aria-label=é”šç‚¹>#</a></span></h3><p>Linux é‡‡ç”¨ Namespace æŠ€æœ¯è¿›è¡Œèµ„æºéš”ç¦»ï¼Œå¯ä»¥ä¸ºä¸åŒè¿›ç¨‹åˆ†é…ä¸åŒçš„ Namespaceï¼Œæœ‰ç‚¹ç±»ä¼¼æ²™ç®±çš„æ¦‚å¿µã€‚åœ¨ Linux è¿›ç¨‹çš„æ•°æ®ç»“æ„ä¸­ï¼Œ<code>nsproxy</code> ç»“æ„ä½“è´Ÿè´£ç®¡ç† Namespaceï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>struct</span> <span class=n>nsproxy</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>atomic_t</span>             <span class=n>count</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>struct</span> <span class=n>uts_namespace</span> <span class=o>*</span><span class=n>uts_ns</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>struct</span> <span class=n>ipc_namespace</span> <span class=o>*</span><span class=n>ipc_ns</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>struct</span> <span class=n>mnt_namespace</span> <span class=o>*</span><span class=n>mnt_ns</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>struct</span> <span class=n>pid_namespace</span> <span class=o>*</span><span class=n>pid_ns_for_children</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>struct</span> <span class=n>net</span>           <span class=o>*</span><span class=n>net_ns</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>é»˜è®¤æƒ…å†µä¸‹çˆ¶å­è¿›ç¨‹å…±äº« Namespaceï¼Œä½†ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ <code>clone</code>ã€<code>setns</code>ã€<code>unshare</code> ç­‰æ–¹æ³•æ‰‹åŠ¨æŒ‡å®šå’Œä¿®æ”¹ Namespaceã€‚</p><p>ä»¥ä¸Šé¢ç»“æ„ä½“çš„ <code>pid_namespace</code> ä¸ºä¾‹ï¼Œä¸¤ä¸ªä¸åŒçš„ PID Namespace ä¸‹çš„è¿›ç¨‹ä¹‹é—´æ˜¯äº’ä¸å½±å“çš„ã€‚ç±»ä¼¼çš„ï¼Œç½‘ç»œã€æ–‡ä»¶ç³»ç»Ÿã€ç”¨æˆ·ã€æŒ‚è½½ç‚¹ç­‰çš„ Namespace ä¹‹é—´ä¹ŸåŒç†ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼ŒDocker å®é™…ä¸Šå°±æ˜¯å¯¹ Namespace çš„ä¸€æ¬¡å°è£…ï¼Œå› æ­¤åœ¨å®¿ä¸»æœºä¸Šè°ƒè¯• Docker å†…éƒ¨ç¨‹åºæ—¶ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ© Namespace çš„å‘½ä»¤è¡Œå·¥å…·ã€‚å…ˆè·å–å¯¹åº”å®¹å™¨çš„ PIDï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ docker inspect <span class=o>[</span>docker id<span class=o>]</span> <span class=p>|</span> grep pid
</span></span></code></pre></div><p>å†ç”¨ <code>nsenter</code> è¿›å…¥å¯¹åº”çš„ Namespaceï¼Œä¾‹å¦‚è¿›å…¥ç½‘ç»œ Namespace ä½¿ç”¨ <code>-n</code>ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ nsenter -t <span class=o>[</span>pid<span class=o>]</span> -n <span class=o>[</span>cmd<span class=o>]</span>
</span></span></code></pre></div><h3 id=cgroups class="relative group">Cgroups <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#cgroups aria-label=é”šç‚¹>#</a></span></h3><p>Cgroups å¯¹è¿›ç¨‹ä½¿ç”¨çš„è®¡ç®—èµ„æºè¿›è¡Œç®¡æ§ï¼Œå¯¹ä¸åŒç±»å‹çš„èµ„æºé‡‡ç”¨ä¸åŒå­ç³»ç»Ÿï¼Œå¹¶åœ¨å­ç³»ç»Ÿä¸­é‡‡ç”¨å±‚çº§æ ‘ç»“æ„ï¼ˆ<code>/sys/fs/cgroup</code>ï¼‰ã€‚</p><h4 id=-é™åˆ¶è¿›ç¨‹ä½¿ç”¨çš„-cpu-èµ„æº class="relative group">ğŸŒ° é™åˆ¶è¿›ç¨‹ä½¿ç”¨çš„ CPU èµ„æº <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#-%e9%99%90%e5%88%b6%e8%bf%9b%e7%a8%8b%e4%bd%bf%e7%94%a8%e7%9a%84-cpu-%e8%b5%84%e6%ba%90 aria-label=é”šç‚¹>#</a></span></h4><p>é¦–å…ˆè¿›å…¥ cpu å­ç³»ç»Ÿï¼Œå°†è¿›ç¨‹åŠ å…¥ cgroupï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ <span class=nb>cd</span> /sys/fs/cgroup/cpu
</span></span><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=o>[</span>pid<span class=o>]</span> &gt; cgroup.procs
</span></span></code></pre></div><p>éšåå…³æ³¨ <code>cpu.cfs_quota_us</code> å’Œ <code>cpu.cfs_period_us</code>ï¼Œä¸¤è€…çš„æ¯”å€¼å³è¿›ç¨‹èƒ½å ç”¨ CPU èµ„æºçš„æœ€é«˜æ¯”ä¾‹ï¼Œé»˜è®¤å€¼ä¸º <code>-1</code>ï¼ˆæ— é™åˆ¶ï¼‰ å’Œ <code>100000</code>ã€‚</p><p>ä¾‹å¦‚ï¼Œè®¾ç½®æœ€å¤šå ç”¨ 25% CPU èµ„æºï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=m>25000</span> &gt; cpu.cfs_quota_us
</span></span></code></pre></div><h3 id=unionfs class="relative group">UnionFS <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#unionfs aria-label=é”šç‚¹>#</a></span></h3><p>é¡¾åæ€ä¹‰ï¼ŒUnionFS å¯ä»¥å¯¹æ–‡ä»¶ç³»ç»Ÿ â€œå–å¹¶é›†â€ï¼Œä¹Ÿå°±æ˜¯å°†ä¸åŒç›®å½•æŒ‚è½½åˆ°åŒä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸‹ã€‚</p><p>ç»å…¸çš„ Linux ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨ bootfs ä¸­çš„ BootLoader å¼•å¯¼åŠ è½½ Kernel åˆ°å†…å­˜ä¸­ï¼Œç„¶å <code>umount</code> æ‰ bootfsã€‚Kernel åŠ è½½å®Œæˆåï¼Œå°±ä¼šä½¿ç”¨æˆ‘ä»¬ç†Ÿæ‚‰çš„ rootfs æ–‡ä»¶ç³»ç»Ÿã€‚å¯åŠ¨æ—¶å…ˆå°† rootfs è®¾ä¸º readonly è¿›è¡Œæ£€æŸ¥ï¼Œéšåå†è®¾ä¸º readwrite ä¾›ä½¿ç”¨ã€‚</p><p>è€Œåœ¨ Docker å¯åŠ¨æ—¶ï¼Œæ£€æŸ¥å®Œ readonly çš„ rootfs åä¼šå† union mount ä¸€ä¸ª readwrite çš„æ–‡ä»¶ç³»ç»Ÿï¼Œç§°ä¸ºä¸€ä¸ª FS å±‚ã€‚åç»­ä¼šç»§ç»­æ·»åŠ  readwrite çš„ FS å±‚ï¼Œæ¯æ¬¡æ·»åŠ æ—¶å°†å½“å‰æœ€é¡¶å±‚çš„ FS å±‚è®¾ä¸º readonlyã€‚è¿™å®é™…ä¸Šå°±æ˜¯ <code>docker build</code> æ ¹æ® Dockerfile ä¸­æ¯ä¸€è¡Œçš„æŒ‡ä»¤å †å  FS å±‚çš„è¿‡ç¨‹ã€‚</p><p>é‚£ä¹ˆå¦‚æœè¦ä¿®æ”¹ä¸‹å±‚ readonly FS å±‚çš„æ–‡ä»¶æ€ä¹ˆåŠå‘¢ï¼Ÿåªéœ€è¦ Copy-on-Writeï¼Œå°†æ–‡ä»¶å¤åˆ¶åˆ°å¯å†™çš„é¡¶å±‚å¹¶ä¿®æ”¹å³å¯ã€‚è¿™æ ·èƒ½æˆåŠŸæ˜¯å› ä¸º Docker é‡‡ç”¨çš„ OverlayFS åœ¨åˆå¹¶ä¸Šä¸‹å±‚åŒåæ–‡ä»¶æ—¶ï¼Œä¼˜å…ˆé€‰æ‹©ä¸Šå±‚æ–‡ä»¶ã€‚</p><p>æœ€åï¼ŒFS å±‚å¯ä»¥åœ¨ä¸åŒé•œåƒä¹‹é—´å¤ç”¨ï¼ŒèŠ‚çœé•œåƒæ„å»ºæ—¶é—´å’Œç¡¬ç›˜å ç”¨ã€‚</p><h2 id=serverless class="relative group">Serverless <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#serverless aria-label=é”šç‚¹>#</a></span></h2><h3 id=faas class="relative group">FaaS <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#faas aria-label=é”šç‚¹>#</a></span></h3><p>Serverless å¹¶ä¸æ˜¯æŒ‡ä¸éœ€è¦æœåŠ¡å™¨ï¼Œè€Œæ˜¯æŒ‡å¯¹æœåŠ¡å™¨è¿ç»´çš„æç«¯æŠ½è±¡ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ç¨‹åºè®¾è®¡é¢†åŸŸå‘ç”Ÿçš„æŠ½è±¡ï¼Œéƒ½æ˜¯ä¸ºäº†é™ä½å¼€å‘éš¾åº¦å’Œæˆæœ¬ã€è®©å¼€å‘è€…æ›´ä¸“æ³¨äºçœŸæ­£æœ‰ä»·å€¼çš„å·¥ä½œã€‚å› æ­¤ï¼ŒServerless ä¸»è¦æ˜¯é’ˆå¯¹åç«¯è¿ç»´è¿›è¡Œçš„ä¸€ç§ä¼˜åŒ–ã€‚</p><p>Serverless é¦–å…ˆæå‡ºçš„æ¦‚å¿µæ˜¯å‡½æ•°å³æœåŠ¡ FaaSï¼Œå¤§ä½“å¯ä»¥åˆ†æˆå‡½æ•°ä»£ç ã€å‡½æ•°æœåŠ¡ã€è§¦å‘å™¨ä¸‰ä¸ªéƒ¨åˆ†ã€‚</p><ul><li>è§¦å‘å™¨æ¥æ”¶ç”¨æˆ·è¯·æ±‚å¹¶é€šçŸ¥å‡½æ•°æœåŠ¡ã€‚å®é™…ä¸Šæ˜¯å¯¹è´Ÿè½½å‡è¡¡ã€åå‘ä»£ç†ç­‰ä¸­é—´ä»¶å·¥ä½œçš„æŠ½è±¡</li><li>å‡½æ•°æœåŠ¡æ”¶åˆ°æ¶ˆæ¯åï¼Œæ£€æŸ¥æ˜¯å¦æœ‰å¯ç”¨çš„å‡½æ•°å®ä¾‹ï¼Œæ²¡æœ‰åˆ™é€šè¿‡å‡½æ•°ä»£ç æ¥åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„å‡½æ•°å®ä¾‹ï¼›æœ€åå°†ç”¨æˆ·è¯·æ±‚ä½œä¸ºå‡½æ•°å‚æ•°ï¼Œæ‰§è¡Œå‡½æ•°ï¼Œè¿”å›çš„ç»“æœå°†åŸè·¯è¿”å›ã€‚å®é™…ä¸Šæ˜¯å¯¹ä»£ç è¿è¡Œç¯å¢ƒçš„æŠ½è±¡</li><li>å‡½æ•°ä»£ç ä¸€èˆ¬åœ¨ git ä¹‹ç±»çš„ç‰ˆæœ¬æ§åˆ¶ä»“åº“ã€‚å®é™…ä¸Šæ˜¯å¯¹ä»£ç ä¸Šä¼ å’Œéƒ¨ç½²çš„æŠ½è±¡</li></ul><h4 id=å¼¹æ€§ä¼¸ç¼© class="relative group">å¼¹æ€§ä¼¸ç¼© <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%bc%b9%e6%80%a7%e4%bc%b8%e7%bc%a9 aria-label=é”šç‚¹>#</a></span></h4><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒFaaS èƒ½æ ¹æ®ç›®å‰è´Ÿè½½å¯¹å ç”¨èµ„æºè¿›è¡Œå¼¹æ€§ä¼¸ç¼©ï¼Œæ— è´Ÿè½½æ—¶ç”šè‡³å¯ä»¥ä¸å ç”¨èµ„æºã€‚è¿™èƒ½å¤Ÿå¾ˆå¤§ç¨‹åº¦ä¸Šæå‡èµ„æºåˆ©ç”¨ç‡ã€‚</p><h4 id=å†·å¯åŠ¨ class="relative group">å†·å¯åŠ¨ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%86%b7%e5%90%af%e5%8a%a8 aria-label=é”šç‚¹>#</a></span></h4><p>å†·å¯åŠ¨å’Œçƒ­å¯åŠ¨ç›¸åï¼Œä»ä¸€ä¸ªæœªåˆå§‹åŒ–çš„æœåŠ¡å¼€å§‹ï¼Œç›´åˆ°å‡½æ•°å®ä¾‹æ‰§è¡Œå®Œæ¯•ç»“æŸã€‚ç”±äºå¯èƒ½æ¶‰åŠæ¯”è¾ƒç¹ççš„åˆå§‹åŒ–å·¥ä½œï¼Œä¼ ç»ŸæœåŠ¡ä¹Ÿè®¸èƒ½å¤Ÿåœ¨çƒ­å¯åŠ¨ä¸Šè¾¾åˆ°å¾ˆå¿«çš„é€Ÿåº¦ï¼Œä½†åœ¨å†·å¯åŠ¨ä¸Šä¸è¡Œã€‚</p><p>FaaS åˆ™é€šè¿‡å®¹å™¨ã€è¿è¡Œç¯å¢ƒã€ä»£ç ä¸‰è€…åˆ†å±‚å¹¶åˆ†åˆ«ç¼“å­˜ï¼Œè·å¾—äº†è¾ƒå¿«çš„å†·å¯åŠ¨é€Ÿåº¦ï¼Œä¸€èˆ¬å¤§çº¦åœ¨å‡ ç™¾æ¯«ç§’å†…ã€‚æ˜¾ç„¶ï¼Œè¿™æ˜¯ç‰ºç‰²äº†ç”¨æˆ·å¯¹åº•å±‚ç¯å¢ƒçš„å¯æ§æ€§æ¢æ¥çš„ã€‚</p><h4 id=è¯­è¨€æ— å…³æ€§ class="relative group">è¯­è¨€æ— å…³æ€§ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e8%af%ad%e8%a8%80%e6%97%a0%e5%85%b3%e6%80%a7 aria-label=é”šç‚¹>#</a></span></h4><p>FaaS å¯ä»¥æ›¿æ¢ä¼ ç»Ÿå‰åç«¯åˆ†ç¦»å¼€å‘ä¸­çš„åç«¯æœåŠ¡ã€å¯ä»¥ç”¨æ¥è¯·æ±‚å…¬å¼€çš„ Web APIã€æ›´é‡è¦çš„æ˜¯å¯ä»¥å’Œå…¶ä»–äº‘æœåŠ¡å•†æä¾›çš„æœåŠ¡è¿›è¡Œè”åŠ¨ã€‚ç”±äºå‰ç«¯åªåœ¨æ„æœ€åè¿”å›çš„æ•°æ®ï¼Œæˆ‘ä»¬çš„å‡½æ•°æœåŠ¡å®Œå…¨å¯ä»¥æ··åˆé‡‡ç”¨å¤šç§ä¸åŒçš„è¯­è¨€æ¥ç¼–å†™ï¼Œä»¥é€‚åº”ä¸åŒçš„éœ€æ±‚ã€‚</p><h4 id=æ•°æ®åº“ class="relative group">æ•°æ®åº“ï¼Ÿ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e6%95%b0%e6%8d%ae%e5%ba%93 aria-label=é”šç‚¹>#</a></span></h4><p>FaaS ä¸­çš„å‡½æ•°å®ä¾‹éƒ½æ´»ä¸äº†å¤ªä¹…ï¼Œæœ‰çš„æ‰§è¡Œå®Œå°±è¢«é”€æ¯äº†ï¼Œè€Œæœ‰çš„å¯èƒ½èƒ½åœ¨å†…å­˜ä¸­å¤šå¾…ä¸€ä¼šå„¿ï¼Œä½†äº‘æœåŠ¡å•†ç»è¿‡ä¸€å°æ®µæ—¶é—´åä»ä¼šé”€æ¯å®ƒä»¬ï¼Œè¿™æ˜¯å› ä¸º FaaS éœ€è¦å¼¹æ€§ä¼¸ç¼©ï¼Œå®ƒçš„æ ¸å¿ƒæ˜¯æ— çŠ¶æ€çš„å‡½æ•°ï¼ˆå°±åƒ HTTP åè®®æ˜¯æ— çŠ¶æ€çš„ä¸€æ ·ï¼‰ã€‚</p><p>è¿™å°±ç»™æ•°æ®æŒä¹…åŒ–å¸¦æ¥äº†é—®é¢˜ï¼Œæ¯”å¦‚æ•°æ®åº“å°±ä¸èƒ½æ”¾åœ¨ FaaS çš„ä¸»è¿›ç¨‹ä¸­ã€‚ä½†æŠŠæ•°æ®åº“å•ç‹¬æ‹¿å‡ºæ¥ï¼Œå†é€šè¿‡ä¸€ä¸ªè¿›ç¨‹å»è¿æ¥å¹¶è®¿é—®å®ƒï¼Œè¿™æ ·åˆä¼šæ˜¾è‘—å¢åŠ å†·å¯åŠ¨çš„æ—¶é—´ã€‚</p><p>è§£å†³åŠæ³•å°±æ˜¯ä¸å†è¿æ¥æ•°æ®åº“ï¼Œè€Œæ˜¯é€šè¿‡ RESTful API è®¿é—®æ•°æ®åº“ã€‚è¿™é‡Œçš„ RESTful API å®é™…ä¸Šå°±æ˜¯ä¸€ç§åç«¯å³æœåŠ¡ BaaS äº†ï¼Œå®ƒæä¾›äº†è®¿é—®åç«¯æ•°æ®åº“çš„æ¥å£ï¼Œä½¿å¾— FaaS ä¸å†éœ€è¦è€ƒè™‘æ•°æ®æŒä¹…åŒ–çš„é—®é¢˜ã€‚</p><h3 id=baas class="relative group">BaaS <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#baas aria-label=é”šç‚¹>#</a></span></h3><p>åç«¯ BaaS åŒ–ä¸ºäº†é™ä½è¿ç»´æˆæœ¬ï¼Œå¾€å¾€ä¼šå°†å¤æ‚ä¸šåŠ¡é€»è¾‘æ‹†åˆ†æˆå•ä¸€èŒè´£çš„å¾®æœåŠ¡ï¼Œå½¢æˆå¾®æœåŠ¡æ¶æ„ã€‚è¿™å°±è¦æ±‚å„å¾®æœåŠ¡ä¹‹é—´ç›¸å¯¹ç‹¬ç«‹ï¼Œæ„å‘³ç€æ¯ä¸ªæœåŠ¡çš„æ•°æ®åº“ä¹Ÿéœ€è¦è§£è€¦åˆã€‚å¯¹è¿™ç±»åˆ†å¸ƒå¼æ•°æ®åº“è€Œè¨€ï¼Œæœ€é‡è¦çš„å°±æ˜¯è§£å†³æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œä¾‹å¦‚é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—æˆ–æ˜¯ Raft åè®®ç­‰ã€‚</p><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒFaaS å’Œ BaaS çš„åº•å±‚å®é™…ä¸Šä½¿ç”¨å®¹å™¨æŠ€æœ¯å®ç°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°ç”¨ Kubernetes æ­å»ºè‡ªå·±çš„ Serverless å¹³å°ï¼ˆè§åæ–‡ Kubernetes éƒ¨åˆ†ï¼‰ã€‚</p><h3 id=ç¼ºç‚¹ class="relative group">ç¼ºç‚¹ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e7%bc%ba%e7%82%b9 aria-label=é”šç‚¹>#</a></span></h3><ul><li>æŠ€æœ¯å°šä¸æˆç†Ÿï¼Œè®¸å¤šäº‘æœåŠ¡å•†æä¾›çš„ Serverless æœåŠ¡å­˜åœ¨ä¸å°‘ bug</li><li>Serverless å¹³å°å¯¹å¼€å‘è€…æ¥è¯´æ˜¯ä¸ªé»‘ç›’å­ï¼Œæƒ³åœ¨ä¸Šé¢è°ƒè¯•ä»£ç ã€æ’æŸ¥é—®é¢˜ï¼Œéœ€è¦ä»˜å‡ºæå¤§æˆæœ¬</li><li>åŒç†ï¼ŒServerless å¹³å°ä¸Šçš„è¿è¡Œæ—¶ç¯å¢ƒåªæ”¯æŒéƒ¨åˆ†å®šåˆ¶</li><li>æ¯æ¬¡éƒ¨ç½²ä»£ç éƒ½éœ€è¦å‹ç¼©ä»£ç åä¸Šä¼ ï¼Œè¾ƒç¹ç</li><li>äº‘æœåŠ¡å•†æä¾›çš„ç”Ÿæ€ï¼ˆå¦‚ä»£ç è°ƒè¯•å·¥å…·ï¼‰éƒ½æ˜¯å°é—­çš„ï¼Œå½¢æˆ Vendor-lockï¼›è¿™ä¸€ç‚¹å¯èƒ½å¯ä»¥é€šè¿‡ Serverlessã€Midway FaaS ç­‰æ¡†æ¶è§£å†³</li></ul><h2 id=kubernetes class="relative group">Kubernetes <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#kubernetes aria-label=é”šç‚¹>#</a></span></h2><h3 id=æ¶æ„ class="relative group">æ¶æ„ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e6%9e%b6%e6%9e%84 aria-label=é”šç‚¹>#</a></span></h3><p>K8s ç”¨æ¥ç®¡ç†å®¹å™¨é›†ç¾¤ï¼Œå®ƒçš„å¥½å¤„åœ¨ <a href=https://kubernetes.io/zh/docs/concepts/overview/what-is-kubernetes/#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-kubernetes-%E5%AE%83%E8%83%BD%E5%81%9A%E4%BB%80%E4%B9%88>å®˜æ–¹æ–‡æ¡£</a> é‡Œå·²ç»å†™å¾—å¾ˆæ¸…æ¥šäº†ï¼Œè€Œå®ƒçš„åŸç†å¤§è‡´å¯ä»¥æ¦‚æ‹¬ä¸ºä¸€å¼ æ¶æ„å›¾ï¼š</p><p><figure><img class="my-0 rounded-md" srcset="/posts/cloud-native/1_hued1020629345cb53483dcc09b77e00f3_49545_330x0_resize_box_3.png 330w,
/posts/cloud-native/1_hued1020629345cb53483dcc09b77e00f3_49545_660x0_resize_box_3.png 660w,
/posts/cloud-native/1_hued1020629345cb53483dcc09b77e00f3_49545_1024x0_resize_box_3.png 1024w,
/posts/cloud-native/1_hued1020629345cb53483dcc09b77e00f3_49545_1320x0_resize_box_3.png 2x" src=/posts/cloud-native/1_hued1020629345cb53483dcc09b77e00f3_49545_660x0_resize_box_3.png alt="å›¾ 1ï½œK8s æ¶æ„"></figure></p><p>é€šè¿‡ CLI å·¥å…· kubectlï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®åˆ°è¿è¡Œåœ¨ K8s Master Node ä¸Šçš„ API Serverï¼Œä¹Ÿæ˜¯æ•´ä¸ªé›†ç¾¤çš„æ ¸å¿ƒã€‚Node å®é™…ä¸Šæ˜¯å¯¹è®¡ç®—èµ„æºçš„ä¸€ç§æŠ½è±¡ï¼Œæ¯ä¸ª Node ä¸Šè¿è¡Œä¸€ä¸ªæˆ–å¤šä¸ª Podï¼Œå³åº”ç”¨å®ä¾‹ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ª Pod ä¸Šæ¨èè¿è¡Œä¸€ä¸ªå®¹å™¨ã€‚</p><p>åœ¨ Master Node ä¸Šè¿˜æœ‰é”®å€¼æ•°æ®åº“ etcdã€ç›‘è§† Pod çš„è°ƒåº¦å™¨ Schedulerã€ä¸åŒç±»å‹çš„æ§åˆ¶å™¨ Controller Manager ä»¥åŠè¿æ¥äº‘æœåŠ¡å‚å•† API çš„ Cloud Controller Managerã€‚</p><p>è€Œåœ¨æ™®é€š Node ä¸Šåˆ™è¿è¡Œäº†ä¸€ä¸ª kubeletï¼Œè´Ÿè´£é€šçŸ¥ API Server å®¹å™¨è¿è¡ŒçŠ¶æ€ã€‚æ­¤å¤–ï¼Œä¸ºäº†è®©å¤–ç•Œèƒ½å¤Ÿè®¿é—®åˆ°å®¹å™¨è¿è¡Œçš„æœåŠ¡ï¼Œéœ€è¦ç”¨ K8s Service é€šè¿‡ kube-proxy æš´éœ²è¯¥æœåŠ¡ã€‚</p><p>æœ€åï¼Œä¸åŒçš„ K8s é›†ç¾¤ä¹‹é—´é€šè¿‡ Namespace éš”ç¦»ï¼Œæ³¨æ„è¿™å’Œä¸Šæ–‡å†™å®¹å™¨æŠ€æœ¯æ—¶æåˆ°çš„ Linux Namespace å¹¶éåŒä¸€æ¦‚å¿µï¼Œå°½ç®¡æ€æƒ³æ˜¯ç›¸ä¼¼çš„ã€‚</p><h3 id=å®‰è£… class="relative group">å®‰è£… <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%ae%89%e8%a3%85 aria-label=é”šç‚¹>#</a></span></h3><p>K8s çš„å®‰è£…ä»¤äººæƒŠè®¶åœ°ç®€å•ã€‚å°±åƒæˆ‘ä»¬åœ¨æ¶æ„å›¾ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œå®‰è£… K8s ä¸»è¦åˆ†ä¸ºå®‰è£… kubectl å’Œ å®‰è£… K8s é›†ç¾¤ä¸¤ä¸ªæ­¥éª¤ã€‚</p><h4 id=å®‰è£…-k8s-é›†ç¾¤ class="relative group">å®‰è£… K8s é›†ç¾¤ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%ae%89%e8%a3%85-k8s-%e9%9b%86%e7%be%a4 aria-label=é”šç‚¹>#</a></span></h4><p>ç¬¬ä¸€ç§æ–¹å¼æ˜¯é€šè¿‡ Docker Desktop å®‰è£…ã€‚å®é™…ä¸Š Docker Desktop è‡ªå¸¦äº† K8sï¼ˆä¸æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œä½†ä¹Ÿæ¯”è¾ƒæ–°ï¼‰ï¼Œåœ¨è®¾ç½®é‡Œå‹¾é€‰å³å¯ã€‚</p><p>ç¬¬äºŒç§æ–¹å¼æ˜¯é€šè¿‡ kubeadmã€minikubeã€kind ç­‰å·¥å…·å®‰è£…ï¼Œæ— è®ºå“ªç§æ–¹å¼éƒ½æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œä»¥ minikube ä¸ºä¾‹ã€‚</p><blockquote><p>minikube å†…ç½®äº† kubectlï¼Œæ‰€ä»¥ä¹‹åå¯ä»¥é€‰æ‹©ä¸å¦å¤–å®‰è£… kubectlã€‚</p></blockquote><p>æŒ‰ç…§ <a href=https://minikube.sigs.k8s.io/docs/start/>å®˜æ–¹æ–‡æ¡£</a>ï¼Œç›´æ¥ <code>install</code> äºŒè¿›åˆ¶æ–‡ä»¶å³å¯ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-darwin-amd64
</span></span><span class=line><span class=cl>$ sudo install minikube-darwin-amd64 /usr/local/bin/minikube
</span></span></code></pre></div><h4 id=å®‰è£…-kubectl class="relative group">å®‰è£… kubectl <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%ae%89%e8%a3%85-kubectl aria-label=é”šç‚¹>#</a></span></h4><p><code>brew install kubectl</code>ï¼Œæ²¡äº†ã€‚</p><p>ç„¶è€Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œkubectl ç‰ˆæœ¬å’Œ K8s é›†ç¾¤ç‰ˆæœ¬ä¹‹é—´ç›¸å·®ä¸èƒ½è¶…è¿‡ <em>0.0.2</em>ï¼Œå¦åˆ™å®¹æ˜“å‡ºç°ä¸å…¼å®¹çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨ Docker Desktop å®‰è£…çš„ 1.21.4 ç‰ˆæœ¬çš„é›†ç¾¤ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨å®‰è£…ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ curl -LO <span class=s2>&#34;https://dl.k8s.io/release/v1.21.4/bin/darwin/arm64/kubectl&#34;</span>
</span></span><span class=line><span class=cl>$ chmod +x ./kubectl
</span></span><span class=line><span class=cl>$ sudo mv ./kubectl /usr/local/bin/kubectl
</span></span><span class=line><span class=cl>$ sudo chown root: /usr/local/bin/kubectl
</span></span></code></pre></div><h3 id=å®è·µ class="relative group">å®è·µ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%ae%9e%e8%b7%b5 aria-label=é”šç‚¹>#</a></span></h3><p>é¦–å…ˆè®¾ç½®å¥½åˆ«åï¼Œæ–¹ä¾¿åç»­æ“ä½œï¼ˆè¿™é‡Œç›´æ¥ä½¿ç”¨äº† minikube å†…ç½®çš„ kubectlï¼‰ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>k</span><span class=o>=</span><span class=s2>&#34;minikube kubectl --&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>dps</span><span class=o>=</span><span class=s2>&#34;docker ps -a&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>dr</span><span class=o>=</span><span class=s2>&#34;docker rm -f&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>dil</span><span class=o>=</span><span class=s2>&#34;docker image ls&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>dir</span><span class=o>=</span><span class=s2>&#34;docker image rm&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>ds</span><span class=o>=</span><span class=s2>&#34;docker start&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>dx</span><span class=o>=</span><span class=s2>&#34;docker exec -it&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>mk</span><span class=o>=</span><span class=s2>&#34;minikube&#34;</span>
</span></span></code></pre></div><p>å¯åŠ¨ minikubeï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ mk start
</span></span></code></pre></div><p>éƒ¨ç½²åº”ç”¨å¹¶æ£€æŸ¥ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ k create deploy echo-server --image<span class=o>=</span>k8s.gcr.io/echoserver-arm:1.8
</span></span><span class=line><span class=cl>$ k get deploy
</span></span><span class=line><span class=cl><span class=c1># result:</span>
</span></span><span class=line><span class=cl>NAME          READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span class=line><span class=cl>echo-server   1/1     <span class=m>1</span>            <span class=m>1</span>           1m
</span></span></code></pre></div><p>å› ä¸ºæ˜¯ M1 èŠ¯ç‰‡ï¼Œæ‰€ä»¥ç”¨çš„ ARM é•œåƒã€‚</p><p>æ£€æŸ¥ Pod æƒ…å†µï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ k get po
</span></span><span class=line><span class=cl><span class=c1># result:</span>
</span></span><span class=line><span class=cl>NAME                          READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>echo-server-9f4db688c-r288r   1/1     Running   <span class=m>0</span>          <span class=m>89</span>
</span></span></code></pre></div><p>æš´éœ²æœåŠ¡å¹¶æ£€æŸ¥ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ k expose deploy echo-server --type<span class=o>=</span>LoadBalancer --port<span class=o>=</span><span class=m>8080</span>
</span></span><span class=line><span class=cl>$ k get svc
</span></span><span class=line><span class=cl><span class=c1># result:</span>
</span></span><span class=line><span class=cl>NAME          TYPE           CLUSTER-IP       EXTERNAL-IP   PORT<span class=o>(</span>S<span class=o>)</span>          AGE
</span></span><span class=line><span class=cl>echo-server   LoadBalancer   10.111.217.237   &lt;pending&gt;     8080:31389/TCP   1m
</span></span><span class=line><span class=cl>kubernetes    ClusterIP      10.96.0.1        &lt;none&gt;        443/TCP          100m
</span></span></code></pre></div><p>è¿™é‡Œæš´éœ²äº†ä¸€ä¸ª LoadBalancer ç±»å‹çš„æœåŠ¡ï¼Œä¹Ÿå¯ä»¥æ¢æˆ NodePort ç±»å‹æœåŠ¡ã€‚8080 æ˜¯æˆ‘ä»¬çš„ echoserver å®¹å™¨å†…çš„æœåŠ¡ç«¯å£ã€‚</p><p>æ­¤å¤–ï¼Œå¯ä»¥å‘ç°è¿˜æœ‰ä¸€ä¸ª <code>kubernetes</code> æœåŠ¡ï¼Œè¿™å°±æ˜¯ K8s é›†ç¾¤çš„ API Serverã€‚</p><p>ä¸ºäº†è®¿é—®æš´éœ²çš„æœåŠ¡ï¼Œå¯ä»¥æ‰‹åŠ¨ç«¯å£è½¬å‘ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ minikube è‡ªåŠ¨è®¿é—®ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ mk service echo-server
</span></span></code></pre></div><p>æ³¨æ„åˆ°ä¸Šé¢ <code>echo-server</code> çš„ <code>EXTERNAL-IP</code> è¿˜åœ¨ç­‰å¾…åˆ†é…ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨ <code>mk tunnel</code> å»ºç«‹éš§é“ä»è€Œåˆ†é…å¤–éƒ¨è®¿é—®çš„ IPã€‚</p><p>ä¸Šè¿°ä¿¡æ¯ä¹Ÿå¯ä»¥é€šè¿‡ Dashboard å›¾å½¢åŒ–ç•Œé¢æŸ¥çœ‹ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ mk dashboard
</span></span></code></pre></div><p>æœ‰è¶£çš„æ˜¯ï¼ŒK8s æœåŠ¡ä¹Ÿæ˜¯ç”± K8s è‡ªå·±ç®¡ç†çš„ï¼Œå®ƒè¿è¡Œåœ¨ <code>kube-system</code> çš„ Namespace ä¸­ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ k get po,svc -n kube-system
</span></span><span class=line><span class=cl><span class=c1># result:</span>
</span></span><span class=line><span class=cl>NAME                                   READY   STATUS    RESTARTS       AGE
</span></span><span class=line><span class=cl>pod/coredns-78fcd69978-xlh28           1/1     Running   <span class=m>0</span>              141m
</span></span><span class=line><span class=cl>pod/etcd-minikube                      1/1     Running   <span class=m>0</span>              142m
</span></span><span class=line><span class=cl>pod/kube-apiserver-minikube            1/1     Running   <span class=m>0</span>              142m
</span></span><span class=line><span class=cl>pod/kube-controller-manager-minikube   1/1     Running   <span class=m>0</span>              142m
</span></span><span class=line><span class=cl>pod/kube-proxy-gblfw                   1/1     Running   <span class=m>0</span>              141m
</span></span><span class=line><span class=cl>pod/kube-scheduler-minikube            1/1     Running   <span class=m>0</span>              142m
</span></span><span class=line><span class=cl>pod/storage-provisioner                1/1     Running   <span class=m>1</span> <span class=o>(</span>141m ago<span class=o>)</span>   142m
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME               TYPE        CLUSTER-IP   EXTERNAL-IP   PORT<span class=o>(</span>S<span class=o>)</span>                  AGE
</span></span><span class=line><span class=cl>service/kube-dns   ClusterIP   10.96.0.10   &lt;none&gt;        53/UDP,53/TCP,9153/TCP   142m
</span></span></code></pre></div><p>å¯¹äºå…¶ä»–å¹³å°ï¼Œ<code>kubectl</code> å‘½ä»¤ä¸å˜ï¼Œæ›¿æ¢ä¸Šè¿° <code>mk</code> ç›¸å…³å‘½ä»¤å³å¯ã€‚</p><h2 id=service-mesh class="relative group">Service Mesh <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#service-mesh aria-label=é”šç‚¹>#</a></span></h2><p>å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œå¾®æœåŠ¡ä¹‹é—´å¿…é¡»è¦é€šä¿¡ï¼Œå¯¼è‡´å¾®æœåŠ¡é€šä¿¡ç›¸å…³ä»£ç å’Œä¸šåŠ¡ä»£ç çš„å¼ºè€¦åˆã€‚Service Mesh æ­£æ˜¯ä¸ºäº†æŠ½ç¦»å‡ºå¾®æœåŠ¡é€šä¿¡çš„é€»è¾‘ï¼Œè®©å¼€å‘è€…ä¸“æ³¨äºä¸šåŠ¡ä»£ç ç¼–å†™ã€‚å®ƒåœ¨æ•°æ®é¢æ¿ä¸­é€šè¿‡ Sidecar åŠ«æŒå¾®æœåŠ¡ Pod çš„æµé‡ï¼Œä»è€Œæ¥ç®¡äº†æ•´ä¸ªç½‘ç»œé€šä¿¡çš„åŠŸèƒ½ã€‚</p><h3 id=istio-å®‰è£… class="relative group">Istio å®‰è£… <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#istio-%e5%ae%89%e8%a3%85 aria-label=é”šç‚¹>#</a></span></h3><p>Kubernetes é‡‡ç”¨ Istio ä½œä¸º Server Meshï¼Œé¦–å…ˆä¸‹è½½å¹¶å®‰è£…ï¼Œå®‰è£…å‰è®°å¾—ç»™ Docker Desktop æˆ– minikube åˆ†é… 8 - 16 G å†…å­˜ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ curl -L https://istio.io/downloadIstio <span class=p>|</span> sh -
</span></span><span class=line><span class=cl>$ mv istio-1.11.2/bin/istioctl /usr/local/bin
</span></span><span class=line><span class=cl>$ istioctl install --set <span class=nv>profile</span><span class=o>=</span>demo -y
</span></span></code></pre></div><p>ä»¤äººç—›å¿ƒçš„æ˜¯ï¼ŒIstio å®˜æ–¹ <a href=https://github.com/istio/istio/issues/30829>å¹¶ä¸æ”¯æŒ</a>ã€ä¹Ÿ <a href=https://github.com/istio/istio/issues/29596>ä¸æ‰“ç®—æ”¯æŒ</a> ARM æ¶æ„ï¼Œå› æ­¤åœ¨ M1 ä¸‹å®‰è£…æ—¶ä¸èƒ½ç›´æ¥ä½¿ç”¨æœ€åä¸€è¡Œå‘½ä»¤è‡ªåŠ¨åŒ–å®‰è£…ï¼Œè€Œéœ€è¦å€ŸåŠ© <a href=https://github.com/querycap/istio>è¿™ä¸ªç¤¾åŒºç‰ˆé•œåƒ</a>ï¼Œè‡ªå·±ç¼–å†™ Operator è¿›è¡Œå®‰è£…ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>install.istio.io/v1alpha1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>IstioOperator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>istio-system</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>arm-istiocontrolplane</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hub</span><span class=p>:</span><span class=w> </span><span class=l>docker.io/querycapistio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>profile</span><span class=p>:</span><span class=w> </span><span class=l>demo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>components</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pilot</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>k8s</span><span class=p>:</span><span class=w> </span><span class=c># each components have to set this</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>affinity</span><span class=p>:</span><span class=w> </span><span class=cp>&amp;affinity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>nodeAffinity</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>preferredDuringSchedulingIgnoredDuringExecution</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=nt>preference</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>matchExpressions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>beta.kubernetes.io/arch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                      </span><span class=nt>operator</span><span class=p>:</span><span class=w> </span><span class=l>In</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                      </span><span class=nt>values</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span>- <span class=l>arm64</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span>- <span class=l>amd64</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>weight</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>requiredDuringSchedulingIgnoredDuringExecution</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>nodeSelectorTerms</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span>- <span class=nt>matchExpressions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>beta.kubernetes.io/arch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                      </span><span class=nt>operator</span><span class=p>:</span><span class=w> </span><span class=l>In</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                      </span><span class=nt>values</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span>- <span class=l>arm64</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span>- <span class=l>amd64</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>egressGateways</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>istio-egressgateway</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>k8s</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>affinity</span><span class=p>:</span><span class=w> </span><span class=cp>*affinity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ingressGateways</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>istio-ingressgateway</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>k8s</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>affinity</span><span class=p>:</span><span class=w> </span><span class=cp>*affinity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span></code></pre></div><p>å°†è¿™ä¸ª Operator ä¿å­˜ä¸º <code>install-istio.yml</code>ï¼Œéšå <code>istioctl install -f ./install-istio.yml</code> å®Œæˆå®‰è£…ã€‚</p><h3 id=åº”ç”¨éƒ¨ç½² class="relative group">åº”ç”¨éƒ¨ç½² <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%ba%94%e7%94%a8%e9%83%a8%e7%bd%b2 aria-label=é”šç‚¹>#</a></span></h3><p>å®‰è£…å®Œæˆåï¼Œè®°å¾—å¼€å¯ Sidecar æ³¨å…¥æ¥åŠ«æŒæµé‡ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ k label ns default istio-injection<span class=o>=</span>enabled
</span></span></code></pre></div><p>éšåå³å¯éƒ¨ç½²åº”ç”¨å¹¶æŸ¥çœ‹çŠ¶æ€ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ k apply -f samples/bookinfo/platform/kube/bookinfo.yaml
</span></span><span class=line><span class=cl>$ k get po
</span></span><span class=line><span class=cl><span class=c1># result:</span>
</span></span><span class=line><span class=cl>NAME                              READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>details-v1-79f774bdb9-ns6gl       2/2     Running   <span class=m>0</span>          76s
</span></span><span class=line><span class=cl>productpage-v1-6b746f74dc-qp7mg   2/2     Running   <span class=m>0</span>          76s
</span></span><span class=line><span class=cl>ratings-v1-b6994bb9-mflsk         2/2     Running   <span class=m>0</span>          76s
</span></span><span class=line><span class=cl>reviews-v1-545db77b95-24tsl       2/2     Running   <span class=m>0</span>          76s
</span></span><span class=line><span class=cl>reviews-v2-7bf8c9648f-b8bq4       2/2     Running   <span class=m>0</span>          76s
</span></span><span class=line><span class=cl>reviews-v3-84779c7bbc-hxkxg       2/2     Running   <span class=m>0</span>          76s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ k get svc
</span></span><span class=line><span class=cl><span class=c1># result:</span>
</span></span><span class=line><span class=cl>NAME          TYPE        CLUSTER-IP       EXTERNAL-IP   PORT<span class=o>(</span>S<span class=o>)</span>    AGE
</span></span><span class=line><span class=cl>details       ClusterIP   10.102.117.210   &lt;none&gt;        9080/TCP   105s
</span></span><span class=line><span class=cl>kubernetes    ClusterIP   10.96.0.1        &lt;none&gt;        443/TCP    27m
</span></span><span class=line><span class=cl>productpage   ClusterIP   10.101.203.214   &lt;none&gt;        9080/TCP   105s
</span></span><span class=line><span class=cl>ratings       ClusterIP   10.105.60.88     &lt;none&gt;        9080/TCP   105s
</span></span><span class=line><span class=cl>reviews       ClusterIP   10.100.137.99    &lt;none&gt;        9080/TCP   105s
</span></span></code></pre></div><p>æœ€åï¼Œæ£€æŸ¥å®é™…åº”ç”¨æ˜¯å¦æ­£å¸¸è¿è¡Œï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ k <span class=nb>exec</span> <span class=s2>&#34;</span><span class=k>$(</span>k get po -l <span class=nv>app</span><span class=o>=</span>ratings -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.items[0].metadata.name}&#39;</span><span class=k>)</span><span class=s2>&#34;</span> -c ratings -- curl -sS productpage:9080/productpage <span class=p>|</span> grep -o <span class=s2>&#34;&lt;title&gt;.*&lt;/title&gt;&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># result:</span>
</span></span><span class=line><span class=cl>&lt;title&gt;Simple Bookstore App&lt;/title&gt;
</span></span></code></pre></div><p>ä¸Šè¿°å‘½ä»¤çš„æ„æ€æ˜¯ï¼šåœ¨ ratings å¯¹åº”çš„ pod ä¸­çš„ ratings å®¹å™¨é‡Œè¿è¡Œ <code>curl -sS productpage:9080/productpage</code> å‘èµ·è¯·æ±‚ï¼Œå¹¶åœ¨è¿”å›çš„ html ä¸­æŸ¥æ‰¾æ ‡é¢˜ã€‚éœ€è¦è¿™ä¹ˆå¤æ‚æ˜¯å› ä¸ºæ­¤æ—¶æˆ‘ä»¬çš„æœåŠ¡è¿˜æ²¡æœ‰å¤–éƒ¨ IPï¼Œåªèƒ½åœ¨é›†ç¾¤å†…éƒ¨è®¿é—®ã€‚</p><h3 id=é€šè¿‡-ingress-ç½‘å…³è®©åº”ç”¨èƒ½å¤Ÿä»å¤–éƒ¨è®¿é—® class="relative group">é€šè¿‡ Ingress ç½‘å…³è®©åº”ç”¨èƒ½å¤Ÿä»å¤–éƒ¨è®¿é—® <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e9%80%9a%e8%bf%87-ingress-%e7%bd%91%e5%85%b3%e8%ae%a9%e5%ba%94%e7%94%a8%e8%83%bd%e5%a4%9f%e4%bb%8e%e5%a4%96%e9%83%a8%e8%ae%bf%e9%97%ae aria-label=é”šç‚¹>#</a></span></h3><p>é¦–å…ˆéƒ¨ç½²å¥½è®¾ç½®äº†ç½‘å…³çš„åº”ç”¨å¹¶æ£€æŸ¥ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ k apply -f samples/bookinfo/networking/bookinfo-gateway.yaml
</span></span><span class=line><span class=cl>$ istioctl analyze
</span></span></code></pre></div><p>è·å–ä¸»æœºã€http2 ç«¯å£å’Œ https ç«¯å£ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ <span class=nb>export</span> <span class=nv>INGRESS_HOST</span><span class=o>=</span><span class=k>$(</span>k -n istio-system get svc istio-ingressgateway -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.status.loadBalancer.ingress[0].ip}&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>$ <span class=nb>export</span> <span class=nv>INGRESS_PORT</span><span class=o>=</span><span class=k>$(</span>k -n istio-system get svc istio-ingressgateway -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.spec.ports[?(@.name==&#34;http2&#34;)].port}&#39;</span><span class=k>)</span>
</span></span></code></pre></div><p>å¦‚æœè®¾ç½®å®Œå <code>$INGRESS_HOST</code> ä¸ºç©ºï¼Œè¯´æ˜ LoadBalancer æ­¤æ—¶çš„åœ°å€ä¸ºä¸»æœºåè€Œä¸æ˜¯ IPï¼Œåªéœ€è¦ä¿®æ”¹ä¸€ä¸‹è®¾ç½®å³å¯ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ <span class=nb>export</span> <span class=nv>INGRESS_HOST</span><span class=o>=</span><span class=k>$(</span>k -n istio-system get svc istio-ingressgateway -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.status.loadBalancer.ingress[0].hostname}&#39;</span><span class=k>)</span>
</span></span></code></pre></div><p>éšåè®¿é—® <code>http://$INGRESS_HOST:$INGRESS_PORT</code> å³å¯ã€‚</p><h3 id=é€šè¿‡-kiali-æŸ¥çœ‹å›¾å½¢åŒ–ç•Œé¢ class="relative group">é€šè¿‡ Kiali æŸ¥çœ‹å›¾å½¢åŒ–ç•Œé¢ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e9%80%9a%e8%bf%87-kiali-%e6%9f%a5%e7%9c%8b%e5%9b%be%e5%bd%a2%e5%8c%96%e7%95%8c%e9%9d%a2 aria-label=é”šç‚¹>#</a></span></h3><p>å®‰è£… Kialiã€Prometheusã€Grafanaã€Jarger ç­‰æ’ä»¶ï¼Œæ£€æŸ¥éƒ¨ç½²çŠ¶æ€ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ k apply -f samples/addons/
</span></span><span class=line><span class=cl>$ k rollout status deploy kiali -n istio-system
</span></span></code></pre></div><p>éšåå°±å¯ä»¥æŸ¥çœ‹å›¾å½¢åŒ–ç•Œé¢äº†ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ istioctl dashboard kiali
</span></span></code></pre></div><p>ç¼–å†™è„šæœ¬äº§ç”Ÿæµé‡ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=k>for</span> i in <span class=k>$(</span>seq <span class=m>1</span> 100<span class=k>)</span><span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  curl -s -o /dev/null <span class=s2>&#34;http://localhost/productpage&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></div><p>æœ€åå°±å¯ä»¥çœ‹åˆ°æ•´ä¸ª Service Mesh çš„æ¶æ„ã€ä»¥åŠç½‘ç»œè¯·æ±‚æ•°æ®æµäº†ï¼Œéå¸¸æ¸…æ™°ã€‚</p></div></section><footer class="pt-8 max-w-prose print:hidden"><div class=flex><img class="w-24 h-24 !mt-0 !mb-0 ltr:mr-4 rtl:ml-4 rounded-full" width=96 height=96 alt=Mercury src=/my_avatar_huffcabec77dc887387e1e045311cbdc8b_49733_192x192_fill_box_smart1_3.png><div class=place-self-center><div class="text-[0.6rem] leading-3 text-neutral-500 dark:text-neutral-400 uppercase">ä½œè€…</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Mercury</div><div class="text-sm text-neutral-700 dark:text-neutral-400">A student</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:signormercurio@gmail.com target=_blank aria-label=Email rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/SignorMercurio target=_blank aria-label=Github rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://t.me/m9r_at_tG target=_blank aria-label=Telegram rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg></span></a></div></div></div></div><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group" href=/posts/gcp/><span class="mr-3 ltr:inline rtl:hidden text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 ltr:hidden rtl:inline text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2021-09-23 10:03:42 +0000 UTC">2021-09-23</time></span></span></a></span>
<span><a class="flex text-right group" href=/posts/go-error/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">è¿·é€”çŸ¥è¿”ï¼šGo Error å¤„ç†</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2021-09-08 08:50:13 +0000 UTC">2021-09-08</time></span></span>
<span class="ml-3 ltr:inline rtl:hidden text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 ltr:hidden rtl:inline text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer><script src=//unpkg.com/valine/dist/Valine.min.js></script><div id=vcomments class="mt-8 max-w-prose print:hidden"></div><script>new Valine({el:"#vcomments",appId:"RkxCznUcvfzFBgfMiMr0BAfd-gzGzoHsz",appKey:"sw2sEPOl4haCAXKUFYiBFMrR",avatar:"robohash",requiredFields:["nick"]})</script></article><div class="absolute top-[100vh] ltr:right-0 rtl:left-0 w-12 pointer-events-none bottom-0"><a href=#the-top class="w-12 h-12 sticky pointer-events-auto top-[calc(100vh-5.5rem)] bg-neutral/50 dark:bg-neutral-800/50 backdrop-blur rounded-full text-xl flex items-center justify-center text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer class="py-10 print:hidden"><nav class="pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=https://creativecommons.org/licenses/by-nc/4.0/ title>CC BY-NC 4.0</a></li></ul></nav><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2022
Mercury</p><p class="text-xs text-neutral-500 dark:text-neutral-400">ç”± <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://git.io/hugo-congo target=_blank rel="noopener noreferrer">Congo</a> å¼ºåŠ›é©±åŠ¨</p></div><div class="text-sm cursor-pointer text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-14 rtl:ml-14"><button id=appearance-switcher class="w-12 h-12" type=button title=åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼>
<span class="inline dark:hidden"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></span><span class="hidden dark:inline"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></span></button></div></div></footer><div id=search-wrapper class="fixed inset-0 z-50 flex flex-col p-4 sm:p-6 md:p-[10vh] lg:p-[12vh] w-screen h-screen cursor-default bg-neutral-500/50 backdrop-blur-sm dark:bg-neutral-900/50 invisible" data-url><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg border-neutral-200 top-20 bg-neutral dark:bg-neutral-800 dark:border-neutral-700"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-transparent focus:outline-2" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>