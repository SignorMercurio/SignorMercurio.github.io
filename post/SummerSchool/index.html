<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>ECNU X 启明星辰 网络安全暑期学校记录 - Lab on Mercury</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Lab on Mercury"><meta name="msapplication-TileImage" content="/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Lab on Mercury"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="7.22-7.26"><meta property="og:type" content="blog"><meta property="og:title" content="ECNU X 启明星辰 网络安全暑期学校记录"><meta property="og:url" content="https://signormercurio.me/post/SummerSchool/"><meta property="og:site_name" content="Lab on Mercury"><meta property="og:description" content="7.22-7.26"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://signormercurio.me/img/og_image.png"><meta property="article:published_time" content="2019-07-23T06:39:19.000Z"><meta property="article:author" content="Mercury"><meta property="article:tag" content="SQLi"><meta property="article:tag" content="反序列化"><meta property="article:tag" content="总结"><meta property="article:tag" content="Hash"><meta property="article:tag" content="Kali"><meta property="article:tag" content="js"><meta property="article:tag" content="伪协议"><meta property="article:tag" content="变量覆盖"><meta property="article:tag" content="条件竞争"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://signormercurio.me/post/SummerSchool/"},"headline":"Lab on Mercury","image":["https://signormercurio.me/img/og_image.png"],"datePublished":"2019-07-23T06:39:19.000Z","author":{"@type":"Person","name":"Mercury"},"description":"7.22-7.26"}</script><link rel="canonical" href="https://signormercurio.me/post/SummerSchool/"><link rel="alternate" href="/atom.xml" title="Lab on Mercury" type="application/atom+xml"><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.2.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/favicon.png" alt="Lab on Mercury" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-07-23T06:39:19.000Z" title="2019-07-23T06:39:19.000Z">2019-07-23</time></span><span class="level-item"><a class="link-muted" href="/categories/%E5%AE%89%E5%85%A8/">安全</a><span> / </span><a class="link-muted" href="/categories/%E5%AE%89%E5%85%A8/Web/">Web</a></span><span class="level-item">14 minutes read (About 2144 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">ECNU X 启明星辰 网络安全暑期学校记录</h1><div class="content"><p>7.22-7.26</p>
<a id="more"></a>

<h1 id="Day1-amp-Day2"><a href="#Day1-amp-Day2" class="headerlink" title="Day1 &amp; Day2"></a>Day1 &amp; Day2</h1><p>概念介绍和比较基本的漏洞利用。</p>
<h2 id="可能需要补的东西"><a href="#可能需要补的东西" class="headerlink" title="可能需要补的东西"></a>可能需要补的东西</h2><ul>
<li>协议&amp;路由相关知识：TCP/IP卷一，CCNA/CCNP学习指导</li>
<li>安全技能证书</li>
<li>PHP代码审计工具</li>
<li>PHP</li>
<li>SQL</li>
<li>工具的使用</li>
<li>……</li>
</ul>
<h2 id="CVE-2019-0708"><a href="#CVE-2019-0708" class="headerlink" title="CVE-2019-0708"></a>CVE-2019-0708</h2><p>获取脚本：<a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/46946">https://www.exploit-db.com/exploits/46946</a>，命名为<code>poc.py</code>。</p>
<p>在Win7靶机上开启3389端口（<code>计算机</code>-&gt;<code>属性</code>-&gt;<code>远程设置</code>-&gt;<code>允许所有...</code>），并通过<code>ipconfig</code>查看IP。</p>
<p>最后终端运行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python poc.py 靶机IP 靶机位数</span><br></pre></td></tr></table></figure>
<p>其中靶机IP为上面获得的IP，靶机位数为32或64。</p>
<blockquote>
<p>其余CVE利用过程都基于MSF，比较套路。</p>
</blockquote>
<h1 id="Day3"><a href="#Day3" class="headerlink" title="Day3"></a>Day3</h1><p>Web方向。</p>
<h2 id="Level4"><a href="#Level4" class="headerlink" title="Level4"></a>Level4</h2><p>扫后台发现存在备份文件<code>index.php.bak</code>，得PHP代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ERROR_REPORTING(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_GET[<span class="string">&#x27;ver&#x27;</span>])==PHP_VERSION)&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>($_GET[<span class="string">&#x27;ver&#x27;</span>]==PHP_VERSION)&#123;</span><br><span class="line">		$key = <span class="string">&quot;**********&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>burp抓包发现返回头中有<code>X-Powered-By: PHP/5.4.41</code>，那么把<code>ver=5.4.41</code>作为参数通过<code>GET</code>请求发送即可。</p>
<h2 id="Level5"><a href="#Level5" class="headerlink" title="Level5"></a>Level5</h2><p>F12在注释中发现存在<code>password.txt</code>，查看发现是一个字典，放到Intruder里跑出密码为<code>Nsf0cuS</code>，然后登录。不过前端有js限制了密码长度，修改js即可，或者也可以直接Burp发包。</p>
<p>登陆成功后，在Set-Cookie字段中发现<code>newpage=MjkwYmNhNzBjN2RhZTkzZGI2NjQ0ZmEwMGI5ZDgzYjkucGhw;</code>，base64解码得<code>290bca70c7dae93db6644fa00b9d83b9.php</code>，访问。</p>
<p>在留言板界面任意留言并抓包，发现存在一个<code>isLogin=0</code>的Cookie和<code>userlevel=guest</code>的参数，分别修改为<code>1</code>和<code>root</code>即可。</p>
<h2 id="Level6"><a href="#Level6" class="headerlink" title="Level6"></a>Level6</h2><p><code>240610708</code>和<code>QNKCDZO</code>的MD5值相同。</p>
<h2 id="Level7"><a href="#Level7" class="headerlink" title="Level7"></a>Level7</h2><p>根据加密函数写解密程序<code>decode.php</code>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params">$s</span>) </span>&#123;</span><br><span class="line">  $_ = base64_decode(strrev(str_rot13($s)));</span><br><span class="line">  $_o = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="keyword">for</span> ($_0 = <span class="number">0</span>; $_0 &lt; strlen($_); ++$_0) &#123;</span><br><span class="line">    $_c = substr($_, $_0, <span class="number">1</span>);</span><br><span class="line">    $__ = ord($_c) - <span class="number">1</span>;</span><br><span class="line">    $_c = chr($__);</span><br><span class="line">    $_o .= $_c;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> strrev($_o);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> decode($_GET[<span class="string">&#x27;str&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后本机开个服务器（我的是8082端口），<code>decode.php</code>放在<code>www</code>目录里，访问<code>http://localhost:8082/decode.php?str=pJovuTsWOUrtIJZtcKZ2OJMzEJZyMTLdIas</code>即可。</p>
<h2 id="Level8"><a href="#Level8" class="headerlink" title="Level8"></a>Level8</h2><p><code>check.js</code>是packer加密，直接去掉<code>eval</code>放控制台跑一下得到js源码。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">_f = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> f = <span class="built_in">document</span>.createElement(<span class="string">&quot;form&quot;</span>);</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&#x27;login&#x27;</span>).appendChild(f);</span><br><span class="line">  f.name = <span class="string">&quot;login&quot;</span>;</span><br><span class="line">  <span class="keyword">return</span> f</span><br><span class="line">&#125;();</span><br><span class="line">_uname = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> uname = <span class="built_in">document</span>.createElement(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">  uname.type = <span class="string">&quot;text&quot;</span>;</span><br><span class="line">  uname.id = <span class="string">&quot;uname&quot;</span>;</span><br><span class="line">  uname.value = <span class="string">&#x27;Input Username&#x27;</span>;</span><br><span class="line">  uname.style.margin = <span class="string">&quot;0px 0px 0px 60px&quot;</span>;</span><br><span class="line">  _f.appendChild(uname);</span><br><span class="line">  uname.onfocus = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.value == <span class="string">&#x27;Input Username&#x27;</span>) <span class="built_in">this</span>.value = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;;</span><br><span class="line">  uname.onblur = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.value == <span class="string">&#x27;&#x27;</span>) <span class="built_in">this</span>.value = <span class="string">&#x27;Input Username&#x27;</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> uname</span><br><span class="line">&#125;();</span><br><span class="line">_br = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> br = <span class="built_in">document</span>.createElement(<span class="string">&quot;br&quot;</span>);</span><br><span class="line">  _f.appendChild(br);</span><br><span class="line">  br = <span class="built_in">document</span>.createElement(<span class="string">&quot;br&quot;</span>);</span><br><span class="line">  _f.appendChild(br);</span><br><span class="line">  <span class="keyword">return</span> br</span><br><span class="line">&#125;();</span><br><span class="line">_upass = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> upass = <span class="built_in">document</span>.createElement(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">  upass.type = <span class="string">&quot;password&quot;</span>;</span><br><span class="line">  upass.id = <span class="string">&quot;upass&quot;</span>;</span><br><span class="line">  upass.value = <span class="string">&#x27;Input Password&#x27;</span>;</span><br><span class="line">  upass.style.margin = <span class="string">&quot;0px 0px 0px 60px&quot;</span>;</span><br><span class="line">  _f.appendChild(upass);</span><br><span class="line">  upass.onfocus = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.value == <span class="string">&#x27;Input Password&#x27;</span>) <span class="built_in">this</span>.value = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;;</span><br><span class="line">  upass.onblur = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.value == <span class="string">&#x27;&#x27;</span>) <span class="built_in">this</span>.value = <span class="string">&#x27;Input Password&#x27;</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> upass</span><br><span class="line">&#125;();</span><br><span class="line">_btn = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> btn = <span class="built_in">document</span>.createElement(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">  _f.appendChild(btn);</span><br><span class="line">  btn.type = <span class="string">&quot;button&quot;</span>;</span><br><span class="line">  btn.value = <span class="string">&quot;login&quot;</span>;</span><br><span class="line">  btn.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    uname = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;uname&#x27;</span>).value;</span><br><span class="line">    upass = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;upass&#x27;</span>).value;</span><br><span class="line">    <span class="keyword">if</span> (uname == <span class="string">&quot;&quot;</span>) alert(<span class="string">&#x27;Please Input Username!&#x27;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (upass == <span class="string">&quot;&quot;</span>) alert(<span class="string">&#x27;Please Input Password!&#x27;</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">eval</span>(<span class="built_in">unescape</span>(<span class="string">&quot;var%20strKey1%20%3D%20%22JaVa3C41ptIsAGo0DStAff%22%3B%0Avar%20strKey2%20%3D%20%22CaNUknOWThIsK3y%22%3B%0Avar%20strKey3%20%3D%20String.fromCharCode%2871%2C%2048%2C%20111%2C%20100%2C%2033%29%3B%0Aif%20%28uname%20%3D%3D%20%28strKey3%20+%20%28%28%28strKey1.toLowerCase%28%29%29.substring%280%2C%20strKey1.indexOf%28%220%22%29%29%20+%20strKey2.substring%282%2C%206%29%29.toUpperCase%28%29%29.substring%280%2C%2015%29%29%29%20%7B%0A%20%20%20%20var%20strKey4%20%3D%20%27Java_Scr1pt_Pa4sW0rd_K3y_H3re%27%3B%0A%20%20%20%20if%20%28upass%20%3D%3D%20%28strKey4.substring%28strKey4.indexOf%28%271%27%2C%205%29%2C%20strKey4.length%20-%20strKey4.indexOf%28%27_%27%29%20+%205%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20alert%28%27Login%20Success%21%27%29%3B%0A%20%20%20%20%20%20%20%20document.getElementById%28%27key%27%29.innerHTML%20%3D%20unescape%28%22%253Cfont%2520color%253D%2522%2523000%2522%253Ea2V5X0NoM2NrXy50eHQ%3D%253C/font%253E%22%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20alert%28%27Password%20Error%21%27%29%3B%0A%20%20%20%20%7D%0A%7D%20else%20%7B%0A%20%20%20%20alert%28%27Login%20Failed%21%27%29%3B%0A%7D&quot;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure>


<p>只有最后一个<code>else</code>里的代码比较重要，去掉<code>eval</code>运行得：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> strKey1 = <span class="string">&quot;JaVa3C41ptIsAGo0DStAff&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> strKey2 = <span class="string">&quot;CaNUknOWThIsK3y&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> strKey3 = <span class="built_in">String</span>.fromCharCode(<span class="number">71</span>, <span class="number">48</span>, <span class="number">111</span>, <span class="number">100</span>, <span class="number">33</span>);</span><br><span class="line"><span class="keyword">if</span> (uname == (strKey3 + (((strKey1.toLowerCase()).substring(<span class="number">0</span>, strKey1.indexOf(<span class="string">&quot;0&quot;</span>)) + strKey2.substring(<span class="number">2</span>, <span class="number">6</span>)).toUpperCase()).substring(<span class="number">0</span>, <span class="number">15</span>))) &#123;</span><br><span class="line">    <span class="keyword">var</span> strKey4 = <span class="string">&#x27;Java_Scr1pt_Pa4sW0rd_K3y_H3re&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (upass == (strKey4.substring(strKey4.indexOf(<span class="string">&#x27;1&#x27;</span>, <span class="number">5</span>), strKey4.length - strKey4.indexOf(<span class="string">&#x27;_&#x27;</span>) + <span class="number">5</span>))) &#123;</span><br><span class="line">        alert(<span class="string">&#x27;Login Success!&#x27;</span>);</span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">&#x27;key&#x27;</span>).innerHTML = <span class="built_in">unescape</span>(<span class="string">&quot;%3Cfont%20color%3D%22%23000%22%3Ea2V5X0NoM2NrXy50eHQ=%3C/font%3E&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        alert(<span class="string">&#x27;Password Error!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    alert(<span class="string">&#x27;Login Failed!&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>依次运行：<br>1.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> strKey1 = <span class="string">&quot;JaVa3C41ptIsAGo0DStAff&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> strKey2 = <span class="string">&quot;CaNUknOWThIsK3y&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> strKey3 = <span class="built_in">String</span>.fromCharCode(<span class="number">71</span>, <span class="number">48</span>, <span class="number">111</span>, <span class="number">100</span>, <span class="number">33</span>);</span><br><span class="line"><span class="keyword">var</span> strKey4 = <span class="string">&#x27;Java_Scr1pt_Pa4sW0rd_K3y_H3re&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>2.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strKey3 + (((strKey1.toLowerCase()).substring(<span class="number">0</span>, strKey1.indexOf(<span class="string">&quot;0&quot;</span>)) + strKey2.substring(<span class="number">2</span>, <span class="number">6</span>)).toUpperCase()).substring(<span class="number">0</span>, <span class="number">15</span>)</span><br></pre></td></tr></table></figure>

<p>3.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strKey4.substring(strKey4.indexOf(<span class="string">&#x27;1&#x27;</span>, <span class="number">5</span>), strKey4.length - strKey4.indexOf(<span class="string">&#x27;_&#x27;</span>) + <span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<p>得到用户名<code>G0od!JAVA3C41PTISAGO</code>和密码<code>1pt_Pa4sW0rd_K3y_H3re</code>，不过不用登录，因为<code>key</code>也可以直接得到。运行<code>unescape(&quot;%3Cfont%20color%3D%22%23000%22%3Ea2V5X0NoM2NrXy50eHQ=%3C/font%3E&quot;)</code>，得到：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">&quot;#000&quot;</span>&gt;</span>a2V5X0NoM2NrXy50eHQ=<span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>base64解码得<code>key_Ch3ck_.txt</code>，打开发现里面只有<code>Ch3ck_Au7h.php</code>，但是打开发现只显示<code>Your username error!</code>。因此我们POST刚才得到的用户名和密码。</p>
<h2 id="Level10"><a href="#Level10" class="headerlink" title="Level10"></a>Level10</h2><p>提示LFI，并且html表单中有一个<code>file</code>参数，因此考虑用PHP伪协议，输入框中输入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;index.php</span><br></pre></td></tr></table></figure>

<p>flag直接写死在源码中了。。</p>
<h2 id="Level11"><a href="#Level11" class="headerlink" title="Level11"></a>Level11</h2><p>存在备份文件<code>index.php.swp</code>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clear</span>(<span class="params">$string</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//这是过滤函数哦~</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$userInfo = @unserialize($_REQUEST[<span class="string">&#x27;userInfo&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">$query = <span class="string">&#x27;SELECT * FROM users WHERE id = \&#x27;&#x27;</span>.clear($userInfo[<span class="string">&#x27;id&#x27;</span>]).<span class="string">&#x27;\&#x27; AND password = \&#x27;&#x27;</span>.clear($userInfo[<span class="string">&#x27;pass&#x27;</span>]).<span class="string">&#x27;\&#x27;;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">$result = mysql_query($query);</span><br><span class="line"><span class="keyword">if</span>(!$result || mysql_num_rows($result) &lt; <span class="number">1</span>)&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&#x27;Invalid password!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$row = mysql_fetch_assoc($result);</span><br><span class="line"><span class="keyword">foreach</span>($row <span class="keyword">as</span> $key =&gt; $value)&#123;</span><br><span class="line">	$userInfo[$key] = $value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$oldPass = @$_REQUEST[<span class="string">&#x27;oldPass&#x27;</span>];</span><br><span class="line">$newPass = @$_REQUEST[<span class="string">&#x27;newPass&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>($oldPass == $userInfo[<span class="string">&#x27;password&#x27;</span>])&#123;</span><br><span class="line">	$userInfo[<span class="string">&#x27;password&#x27;</span>] = $newPass;</span><br><span class="line">	$query = <span class="string">&#x27;UPDATE users SET pass = \&#x27;&#x27;</span>.clear($newPass).<span class="string">&#x27;\&#x27; WHERE id = \&#x27;&#x27;</span>.clear($userInfo[<span class="string">&#x27;id&#x27;</span>]).<span class="string">&#x27;\&#x27;;&#x27;</span>;</span><br><span class="line">	mysql_query($query);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;Password Changed Success.&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;Invalid old password entered.&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>首先对<code>userInfo</code>进行反序列化，随后要求两个参数<code>oldPass</code>和<code>newPass</code>，后者随意设置，前者很容易得到。在Cookie中发现<code>pass=OTA0OGM1MGUwOTJmM2IyZWRlYzM5NTFiZjdiZGFlNTA%3D; id=3</code>，进行base64解码和md5解密后得到<code>oldPass=20151231</code>。</p>
<p>最后就是在payload中构造一个序列化的userInfo数组，payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">changepassword.php?userInfo&#x3D;a:2:&#123;s:2:&quot;id&quot;;i:1;s:4:&quot;pass&quot;;s:8:&quot;20151231&quot;;&#125;&amp;oldPass&#x3D;20151231&amp;newPass&#x3D;11111111</span><br></pre></td></tr></table></figure>

<h2 id="Level12"><a href="#Level12" class="headerlink" title="Level12"></a>Level12</h2><p>备份文件<code>index.php.</code>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#GOAL: get password from admin;</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;DB_config_inc.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">dvwaDatabaseConnect();</span><br><span class="line"></span><br><span class="line">$_CONFIG[<span class="string">&#x27;Security&#x27;</span>]=<span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//if register globals = on, undo var overwrites</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="keyword">array</span>(<span class="string">&#x27;_GET&#x27;</span>,<span class="string">&#x27;_POST&#x27;</span>,<span class="string">&#x27;_REQUEST&#x27;</span>,<span class="string">&#x27;_COOKIE&#x27;</span>) <span class="keyword">as</span> $method)&#123;</span><br><span class="line">     <span class="keyword">foreach</span>($$method <span class="keyword">as</span> $key=&gt;$value)&#123;</span><br><span class="line">          <span class="keyword">unset</span>($$key);</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clear</span>(<span class="params">$string</span>)</span>&#123;</span><br><span class="line">	<span class="comment">//filter function here</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username = <span class="keyword">isset</span>($_POST[<span class="string">&#x27;username&#x27;</span>]) ? clear($_POST[<span class="string">&#x27;username&#x27;</span>]) : <span class="keyword">die</span>(<span class="string">&#x27;Please enter in a username.&#x27;</span>);</span><br><span class="line">$password = <span class="keyword">isset</span>($_POST[<span class="string">&#x27;password&#x27;</span>]) ? clear($_POST[<span class="string">&#x27;password&#x27;</span>]) : <span class="keyword">die</span>(<span class="string">&#x27;Please enter in a password.&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_CONFIG[<span class="string">&#x27;Security&#x27;</span>])&#123;</span><br><span class="line">     $username=preg_replace(<span class="string">&#x27;#[^a-z0-9_-]#i&#x27;</span>,<span class="string">&#x27;&#x27;</span>,$username);</span><br><span class="line">     $password=preg_replace(<span class="string">&#x27;#[^a-z0-9_-]#i&#x27;</span>,<span class="string">&#x27;&#x27;</span>,$password);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (is_array($username))&#123;</span><br><span class="line">	<span class="keyword">foreach</span> ($username <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">		$username[$key] = $value;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$query=<span class="string">&#x27;SELECT * FROM users WHERE user=\&#x27;&#x27;</span>.$username[<span class="number">0</span>].<span class="string">&#x27;\&#x27; AND password=\&#x27;&#x27;</span>.$password.<span class="string">&#x27;\&#x27;;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">$result=mysql_query($query);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($result &amp;&amp; mysql_num_rows($result) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">	<span class="keyword">echo</span>(<span class="string">&#x27;flag:&#123;*********&#125;&#x27;</span>);</span><br><span class="line">	<span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">echo</span>(<span class="string">&quot;&lt;script&gt;alert(\&quot;Invalid password!\&quot;)&lt;/script&gt;&quot;</span>);</span><br><span class="line">	<span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>


<p>如果<code>$_CONFIG[&#39;security&#39;]</code>为<code>true</code>，那么我们无法传入<code>username</code>和<code>password</code>，因此需要覆盖<code>$_CONFIG</code>。随后就是注入了，payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;&#39;&amp;password&#x3D;||1&#x3D;1#&amp;Submit&#x3D;%E6%8F%90%E4%BA%A4&amp;_CONFIG&#x3D;aaa</span><br></pre></td></tr></table></figure>

<h2 id="Level13"><a href="#Level13" class="headerlink" title="Level13"></a>Level13</h2><p>经测试，只有<code>php5</code>后缀的文件可以上传成功，但是经过一段很短的延时后又会被删掉。所以需要写两个脚本，一个上传一个下载同时进行，最后发现下载下来的刚才上传的文件里包含flag。</p>
<h1 id="Day4-amp-Day5"><a href="#Day4-amp-Day5" class="headerlink" title="Day4 &amp; Day5"></a>Day4 &amp; Day5</h1><p>练习赛，没来得及记录具体writeup，靠回忆整理一点工具的使用。</p>
<h2 id="John破解DES"><a href="#John破解DES" class="headerlink" title="John破解DES"></a>John破解DES</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">john des.txt</span><br><span class="line">john --show des.txt</span><br></pre></td></tr></table></figure>

<h2 id="John破解Windows管理员密码"><a href="#John破解Windows管理员密码" class="headerlink" title="John破解Windows管理员密码"></a>John破解Windows管理员密码</h2><p>注：Windows下散列函数为NTLM。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john --format=NT sam.txt</span><br></pre></td></tr></table></figure>

<h2 id="Python库Steganography命令行使用"><a href="#Python库Steganography命令行使用" class="headerlink" title="Python库Steganography命令行使用"></a>Python库Steganography命令行使用</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">steganography -e input.jpg output.jpg <span class="string">&#x27;flag&#123;..&#125;&#x27;</span></span><br><span class="line">steganography -d stego.png</span><br></pre></td></tr></table></figure>

<h2 id="F5-Steganography使用"><a href="#F5-Steganography使用" class="headerlink" title="F5-Steganography使用"></a>F5-Steganography使用</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java Extract stego.jpg -p 123456</span><br></pre></td></tr></table></figure>

<h2 id="steghide使用"><a href="#steghide使用" class="headerlink" title="steghide使用"></a>steghide使用</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">steghide embed -cf picture.jpg -ef secret.txt</span><br><span class="line">steghide extract -sf picture.jpg</span><br></pre></td></tr></table></figure>

<h2 id="图片隐写压缩包-图片"><a href="#图片隐写压缩包-图片" class="headerlink" title="图片隐写压缩包/图片"></a>图片隐写压缩包/图片</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">copy</span> /b <span class="number">1</span>.jpg+<span class="number">1</span>.zip new.jpg</span><br><span class="line"><span class="built_in">copy</span> /b <span class="number">2</span>.jpg+<span class="number">3</span>.jpg <span class="number">23</span>.jpg</span><br></pre></td></tr></table></figure>

<h2 id="RSA-已知p-q-e"><a href="#RSA-已知p-q-e" class="headerlink" title="RSA-已知p,q,e"></a>RSA-已知p,q,e</h2><p>如果只知道n且n位数不大，可以在线分解得p,q。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = ...</span><br><span class="line">q = ...</span><br><span class="line">e = ...</span><br><span class="line">c = ... <span class="comment"># c = pow(m, e, p*q)</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, (p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, p*q)</span><br></pre></td></tr></table></figure>

<h2 id="Misc-未知领域"><a href="#Misc-未知领域" class="headerlink" title="Misc-未知领域"></a>Misc-未知领域</h2><p>例如对于流量包，vmdk文件，apk文件等等不熟悉的文件的分析，部分简单题可以通过文本编辑器打开并搜索字符串。对于损坏的流量包尤为有效。</p>
<h2 id="哈希还原"><a href="#哈希还原" class="headerlink" title="哈希还原"></a>哈希还原</h2><p>给定明文范围和哈希前十个字符，求明文与哈希值。简陋的php版本：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$str = <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>;</span><br><span class="line">$len = strlen($str);</span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $len<span class="number">-1</span>; ++$i) &#123;</span><br><span class="line">  <span class="keyword">for</span>($j = <span class="number">0</span>; $j &lt; $len<span class="number">-1</span>; ++$j) &#123;</span><br><span class="line">    <span class="keyword">for</span>($k = <span class="number">0</span>; $k &lt; $len<span class="number">-1</span>; ++$k) &#123;</span><br><span class="line">      <span class="keyword">for</span>($l = <span class="number">0</span>; $l &lt; $len<span class="number">-1</span>; ++$l) &#123;</span><br><span class="line">        $ret = md5($str[$i].$str[$j].$str[$k].$str[$l]);</span><br><span class="line">        <span class="keyword">if</span>(substr($ret, <span class="number">0</span>, <span class="number">10</span>) == <span class="string">&#x27;c2979c7124&#x27;</span>) &#123;</span><br><span class="line">          <span class="keyword">echo</span> $ret;</span><br><span class="line">          <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>比较舒服的python版本：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">key = <span class="string">&#x27;c2979c7124&#x27;</span></span><br><span class="line"><span class="built_in">dir</span> = <span class="string">&#x27;1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line">dir_list = itertools.product(<span class="built_in">dir</span>, repeat=<span class="number">4</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dir_list:</span><br><span class="line">	res = hashlib.md5(<span class="string">&#x27;&#x27;</span>.join(i)).hexdigest()</span><br><span class="line">	<span class="keyword">if</span> res[<span class="number">0</span>:<span class="number">10</span>] == key:</span><br><span class="line">		<span class="built_in">print</span> i</span><br><span class="line">		<span class="built_in">print</span> res</span><br></pre></td></tr></table></figure>

<h2 id="SQL注入流量包分析"><a href="#SQL注入流量包分析" class="headerlink" title="SQL注入流量包分析"></a>SQL注入流量包分析</h2><ol>
<li>过滤出http数据包。</li>
<li>定位关键的注入数据包所在的区间，观察注入语句判断是否是盲注。</li>
<li>非盲注：关注响应信息，直接在响应信息中得到flag。</li>
<li>盲注：关注注入语句，导出HTTP对象到txt并写脚本分析出flag。</li>
</ol>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>暑期学校主要还是面向零基础的同学，因此能学到的东西不算太多。接下来应该会重点学习各类工具的使用。</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>ECNU X 启明星辰 网络安全暑期学校记录</p><p><a href="https://signormercurio.me/post/SummerSchool/">https://signormercurio.me/post/SummerSchool/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Mercury</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2019-07-23</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="" rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/SQLi/">SQLi</a><a class="link-muted mr-2" rel="tag" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">反序列化</a><a class="link-muted mr-2" rel="tag" href="/tags/%E6%80%BB%E7%BB%93/">总结</a><a class="link-muted mr-2" rel="tag" href="/tags/Hash/">Hash</a><a class="link-muted mr-2" rel="tag" href="/tags/Kali/">Kali</a><a class="link-muted mr-2" rel="tag" href="/tags/js/">js</a><a class="link-muted mr-2" rel="tag" href="/tags/%E4%BC%AA%E5%8D%8F%E8%AE%AE/">伪协议</a><a class="link-muted mr-2" rel="tag" href="/tags/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/">变量覆盖</a><a class="link-muted mr-2" rel="tag" href="/tags/%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89/">条件竞争</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/post/ShiYanBaWeb/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">实验吧 Web 练习</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/post/BeefMSF/"><span class="level-item">Beef 加载 Metasploit 插件 &amp; Metasploit 连接 PostgreSQL</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="content" id="valine-thread"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script>new Valine({
            el: '#valine-thread' ,
            appId: "RkxCznUcvfzFBgfMiMr0BAfd-gzGzoHsz",
            appKey: "sw2sEPOl4haCAXKUFYiBFMrR",
            placeholder: "Leave comments here...",
            avatar: "mm",
            
            meta: ["nick","mail","link"],
            pageSize: 10,
            lang: "en",
            visitor: true,
            highlight: true,
            
            
            
            
            
            requiredFields: ["nick","mail"],
        });</script></div></div></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Day1-amp-Day2"><span class="level-left"><span class="level-item">1</span><span class="level-item">Day1 &amp; Day2</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#可能需要补的东西"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">可能需要补的东西</span></span></a></li><li><a class="level is-mobile" href="#CVE-2019-0708"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">CVE-2019-0708</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Day3"><span class="level-left"><span class="level-item">2</span><span class="level-item">Day3</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Level4"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">Level4</span></span></a></li><li><a class="level is-mobile" href="#Level5"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">Level5</span></span></a></li><li><a class="level is-mobile" href="#Level6"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">Level6</span></span></a></li><li><a class="level is-mobile" href="#Level7"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">Level7</span></span></a></li><li><a class="level is-mobile" href="#Level8"><span class="level-left"><span class="level-item">2.5</span><span class="level-item">Level8</span></span></a></li><li><a class="level is-mobile" href="#Level10"><span class="level-left"><span class="level-item">2.6</span><span class="level-item">Level10</span></span></a></li><li><a class="level is-mobile" href="#Level11"><span class="level-left"><span class="level-item">2.7</span><span class="level-item">Level11</span></span></a></li><li><a class="level is-mobile" href="#Level12"><span class="level-left"><span class="level-item">2.8</span><span class="level-item">Level12</span></span></a></li><li><a class="level is-mobile" href="#Level13"><span class="level-left"><span class="level-item">2.9</span><span class="level-item">Level13</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Day4-amp-Day5"><span class="level-left"><span class="level-item">3</span><span class="level-item">Day4 &amp; Day5</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#John破解DES"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">John破解DES</span></span></a></li><li><a class="level is-mobile" href="#John破解Windows管理员密码"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">John破解Windows管理员密码</span></span></a></li><li><a class="level is-mobile" href="#Python库Steganography命令行使用"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">Python库Steganography命令行使用</span></span></a></li><li><a class="level is-mobile" href="#F5-Steganography使用"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">F5-Steganography使用</span></span></a></li><li><a class="level is-mobile" href="#steghide使用"><span class="level-left"><span class="level-item">3.5</span><span class="level-item">steghide使用</span></span></a></li><li><a class="level is-mobile" href="#图片隐写压缩包-图片"><span class="level-left"><span class="level-item">3.6</span><span class="level-item">图片隐写压缩包/图片</span></span></a></li><li><a class="level is-mobile" href="#RSA-已知p-q-e"><span class="level-left"><span class="level-item">3.7</span><span class="level-item">RSA-已知p,q,e</span></span></a></li><li><a class="level is-mobile" href="#Misc-未知领域"><span class="level-left"><span class="level-item">3.8</span><span class="level-item">Misc-未知领域</span></span></a></li><li><a class="level is-mobile" href="#哈希还原"><span class="level-left"><span class="level-item">3.9</span><span class="level-item">哈希还原</span></span></a></li><li><a class="level is-mobile" href="#SQL注入流量包分析"><span class="level-left"><span class="level-item">3.10</span><span class="level-item">SQL注入流量包分析</span></span></a></li></ul></li><li><a class="level is-mobile" href="#总结"><span class="level-left"><span class="level-item">4</span><span class="level-item">总结</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-10-10T15:31:41.000Z">2021-10-10</time></p><p class="title"><a href="/post/Kubernetes/">Kubernetes 笔记</a></p><p class="categories"><a href="/categories/%E6%8E%A2%E7%B4%A2/">探索</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-10-05T14:24:56.000Z">2021-10-05</time></p><p class="title"><a href="/post/Intro2Crypto/">密码学笔记</a></p><p class="categories"><a href="/categories/%E5%AE%89%E5%85%A8/">安全</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-25T17:44:35.000Z">2021-09-25</time></p><p class="title"><a href="/post/Dockerfile2GKE/">从 Dockerfile 到 GKE：再探 GitHub Actions</a></p><p class="categories"><a href="/categories/%E6%8E%A2%E7%B4%A2/">探索</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-23T09:03:42.000Z">2021-09-23</time></p><p class="title"><a href="/post/GCP/">Google Cloud Platform 基础</a></p><p class="categories"><a href="/categories/%E6%8E%A2%E7%B4%A2/">探索</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-10T08:27:59.000Z">2021-09-10</time></p><p class="title"><a href="/post/Container/">云原生技术原理</a></p><p class="categories"><a href="/categories/%E6%8E%A2%E7%B4%A2/">探索</a></p></div></article></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/favicon.png" alt="Lab on Mercury" height="28"></a><p class="is-size-7"><span>&copy; 2021 Mercury</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load", function () {
            outdatedBrowser({
                bgColor: '#f25648',
                color: '#ffffff',
                lowerThan: 'object-fit' // display on IE11 or below
            });
        });</script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>